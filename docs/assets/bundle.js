(function(){const I=document.createElement("link").relList;if(I&&I.supports&&I.supports("modulepreload"))return;for(const G of document.querySelectorAll('link[rel="modulepreload"]'))F(G);new MutationObserver(G=>{for(const te of G)if(te.type==="childList")for(const ae of te.addedNodes)ae.tagName==="LINK"&&ae.rel==="modulepreload"&&F(ae)}).observe(document,{childList:!0,subtree:!0});function L(G){const te={};return G.integrity&&(te.integrity=G.integrity),G.referrerPolicy&&(te.referrerPolicy=G.referrerPolicy),G.crossOrigin==="use-credentials"?te.credentials="include":G.crossOrigin==="anonymous"?te.credentials="omit":te.credentials="same-origin",te}function F(G){if(G.ep)return;G.ep=!0;const te=L(G);fetch(G.href,te)}})();function go(){}function Tb(T){return T()}function F1(){return Object.create(null)}function Ld(T){T.forEach(Tb)}function af(T){return typeof T=="function"}function Yu(T,I){return T!=T?I==I:T!==I||T&&typeof T=="object"||typeof T=="function"}function Xx(T){return Object.keys(T).length===0}function xb(T,...I){if(T==null)return go;const L=T.subscribe(...I);return L.unsubscribe?()=>L.unsubscribe():L}function B1(T,I,L){T.$$.on_destroy.push(xb(I,L))}function U1(T,I,L){return T.set(L),I}const Jx=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function ra(T,I){T.appendChild(I)}function Bu(T,I,L){T.insertBefore(I,L||null)}function Cd(T){T.parentNode&&T.parentNode.removeChild(T)}function Qx(T,I){for(let L=0;L<T.length;L+=1)T[L]&&T[L].d(I)}function Ja(T){return document.createElement(T)}function k1(T){return document.createElementNS("http://www.w3.org/2000/svg",T)}function vb(T){return document.createTextNode(T)}function xn(){return vb(" ")}function dh(T,I,L,F){return T.addEventListener(I,L,F),()=>T.removeEventListener(I,L,F)}function ba(T,I,L){L==null?T.removeAttribute(I):T.getAttribute(I)!==L&&T.setAttribute(I,L)}function ev(T){return Array.from(T.childNodes)}function z1(T,I,L,F){L==null?T.style.removeProperty(I):T.style.setProperty(I,L,F?"important":"")}function Fm(T,I,L){T.classList[L?"add":"remove"](I)}let Uu;function Fu(T){Uu=T}function tv(){if(!Uu)throw new Error("Function called outside component initialization");return Uu}function Eb(T){tv().$$.on_mount.push(T)}const Ad=[],H1=[];let Id=[];const Y1=[],iv=Promise.resolve();let _h=!1;function av(){_h||(_h=!0,iv.then(Ab))}function uh(T){Id.push(T)}const eh=new Set;let vd=0;function Ab(){if(vd!==0)return;const T=Uu;do{try{for(;vd<Ad.length;){const I=Ad[vd];vd++,Fu(I),ov(I.$$)}}catch(I){throw Ad.length=0,vd=0,I}for(Fu(null),Ad.length=0,vd=0;H1.length;)H1.pop()();for(let I=0;I<Id.length;I+=1){const L=Id[I];eh.has(L)||(eh.add(L),L())}Id.length=0}while(Ad.length);for(;Y1.length;)Y1.pop()();_h=!1,eh.clear(),Fu(T)}function ov(T){if(T.fragment!==null){T.update(),Ld(T.before_update);const I=T.dirty;T.dirty=[-1],T.fragment&&T.fragment.p(T.ctx,I),T.after_update.forEach(uh)}}function nv(T){const I=[],L=[];Id.forEach(F=>T.indexOf(F)===-1?I.push(F):L.push(F)),L.forEach(F=>F()),Id=I}const Hm=new Set;let sv;function Gm(T,I){T&&T.i&&(Hm.delete(T),T.i(I))}function ch(T,I,L,F){if(T&&T.o){if(Hm.has(T))return;Hm.add(T),sv.c.push(()=>{Hm.delete(T),F&&(L&&T.d(1),F())}),T.o(I)}else F&&F()}function mh(T){T&&T.c()}function Vm(T,I,L,F){const{fragment:G,after_update:te}=T.$$;G&&G.m(I,L),F||uh(()=>{const ae=T.$$.on_mount.map(Tb).filter(af);T.$$.on_destroy?T.$$.on_destroy.push(...ae):Ld(ae),T.$$.on_mount=[]}),te.forEach(uh)}function jm(T,I){const L=T.$$;L.fragment!==null&&(nv(L.after_update),Ld(L.on_destroy),L.fragment&&L.fragment.d(I),L.on_destroy=L.fragment=null,L.ctx=[])}function lv(T,I){T.$$.dirty[0]===-1&&(Ad.push(T),av(),T.$$.dirty.fill(0)),T.$$.dirty[I/31|0]|=1<<I%31}function of(T,I,L,F,G,te,ae,s=[-1]){const oe=Uu;Fu(T);const he=T.$$={fragment:null,ctx:[],props:te,update:go,not_equal:G,bound:F1(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(I.context||(oe?oe.$$.context:[])),callbacks:F1(),dirty:s,skip_bound:!1,root:I.target||oe.$$.root};ae&&ae(he.root);let ve=!1;if(he.ctx=L?L(T,I.props||{},(Ye,Ce,...lt)=>{const Ke=lt.length?lt[0]:Ce;return he.ctx&&G(he.ctx[Ye],he.ctx[Ye]=Ke)&&(!he.skip_bound&&he.bound[Ye]&&he.bound[Ye](Ke),ve&&lv(T,Ye)),Ce}):[],he.update(),ve=!0,Ld(he.before_update),he.fragment=F?F(he.ctx):!1,I.target){if(I.hydrate){const Ye=ev(I.target);he.fragment&&he.fragment.l(Ye),Ye.forEach(Cd)}else he.fragment&&he.fragment.c();I.intro&&Gm(T.$$.fragment),Vm(T,I.target,I.anchor,I.customElement),Ab()}Fu(oe)}class nf{$destroy(){jm(this,1),this.$destroy=go}$on(I,L){if(!af(L))return go;const F=this.$$.callbacks[I]||(this.$$.callbacks[I]=[]);return F.push(L),()=>{const G=F.indexOf(L);G!==-1&&F.splice(G,1)}}$set(I){this.$$set&&!Xx(I)&&(this.$$.skip_bound=!0,this.$$set(I),this.$$.skip_bound=!1)}}var vn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function sf(T){return T&&T.__esModule&&Object.prototype.hasOwnProperty.call(T,"default")?T.default:T}function rv(T){if(T.__esModule)return T;var I=T.default;if(typeof I=="function"){var L=function F(){return this instanceof F?Reflect.construct(I,arguments,this.constructor):I.apply(this,arguments)};L.prototype=I.prototype}else L={};return Object.defineProperty(L,"__esModule",{value:!0}),Object.keys(T).forEach(function(F){var G=Object.getOwnPropertyDescriptor(T,F);Object.defineProperty(L,F,G.get?G:{enumerable:!0,get:function(){return T[F]}})}),L}var dv="Expected a function",G1=0/0,_v="[object Symbol]",uv=/^\s+|\s+$/g,cv=/^[-+]0x[0-9a-f]+$/i,mv=/^0b[01]+$/i,fv=/^0o[0-7]+$/i,pv=parseInt,hv=typeof vn=="object"&&vn&&vn.Object===Object&&vn,gv=typeof self=="object"&&self&&self.Object===Object&&self,yv=hv||gv||Function("return this")(),bv=Object.prototype,Tv=bv.toString,xv=Math.max,vv=Math.min,th=function(){return yv.Date.now()};function Ev(T,I,L){var F,G,te,ae,s,oe,he=0,ve=!1,Ye=!1,Ce=!0;if(typeof T!="function")throw new TypeError(dv);I=V1(I)||0,fh(L)&&(ve=!!L.leading,Ye="maxWait"in L,te=Ye?xv(V1(L.maxWait)||0,I):te,Ce="trailing"in L?!!L.trailing:Ce);function lt(Oi){var va=F,qe=G;return F=G=void 0,he=Oi,ae=T.apply(qe,va),ae}function Ke(Oi){return he=Oi,s=setTimeout(ut,I),ve?lt(Oi):ae}function Nt(Oi){var va=Oi-oe,qe=Oi-he,yo=I-va;return Ye?vv(yo,te-qe):yo}function Oe(Oi){var va=Oi-oe,qe=Oi-he;return oe===void 0||va>=I||va<0||Ye&&qe>=te}function ut(){var Oi=th();if(Oe(Oi))return bt(Oi);s=setTimeout(ut,Nt(Oi))}function bt(Oi){return s=void 0,Ce&&F?lt(Oi):(F=G=void 0,ae)}function Mt(){s!==void 0&&clearTimeout(s),he=0,F=oe=G=s=void 0}function Fi(){return s===void 0?ae:bt(th())}function ai(){var Oi=th(),va=Oe(Oi);if(F=arguments,G=this,oe=Oi,va){if(s===void 0)return Ke(oe);if(Ye)return s=setTimeout(ut,I),lt(oe)}return s===void 0&&(s=setTimeout(ut,I)),ae}return ai.cancel=Mt,ai.flush=Fi,ai}function fh(T){var I=typeof T;return!!T&&(I=="object"||I=="function")}function Av(T){return!!T&&typeof T=="object"}function Iv(T){return typeof T=="symbol"||Av(T)&&Tv.call(T)==_v}function V1(T){if(typeof T=="number")return T;if(Iv(T))return G1;if(fh(T)){var I=typeof T.valueOf=="function"?T.valueOf():T;T=fh(I)?I+"":I}if(typeof T!="string")return T===0?T:+T;T=T.replace(uv,"");var L=mv.test(T);return L||fv.test(T)?pv(T.slice(2),L?2:8):cv.test(T)?G1:+T}var Ib=Ev;const j1=sf(Ib),Ed=[];function Ov(T,I){return{subscribe:xh(T,I).subscribe}}function xh(T,I=go){let L;const F=new Set;function G(s){if(Yu(T,s)&&(T=s,L)){const oe=!Ed.length;for(const he of F)he[1](),Ed.push(he,T);if(oe){for(let he=0;he<Ed.length;he+=2)Ed[he][0](Ed[he+1]);Ed.length=0}}}function te(s){G(s(T))}function ae(s,oe=go){const he=[s,oe];return F.add(he),F.size===1&&(L=I(G)||go),s(T),()=>{F.delete(he),F.size===0&&L&&(L(),L=null)}}return{set:G,update:te,subscribe:ae}}function Ob(T,I,L){const F=!Array.isArray(T),G=F?[T]:T,te=I.length<2;return Ov(L,ae=>{let s=!1;const oe=[];let he=0,ve=go;const Ye=()=>{if(he)return;ve();const lt=I(F?oe[0]:oe,ae);te?ae(lt):ve=af(lt)?lt:go},Ce=G.map((lt,Ke)=>xb(lt,Nt=>{oe[Ke]=Nt,he&=~(1<<Ke),s&&Ye()},()=>{he|=1<<Ke}));return s=!0,Ye(),function(){Ld(Ce),ve(),s=!1}})}const Km=xh(window.innerWidth),K1=xh(window.innerHeight);Ob(Km,T=>T<=560);Ob(Km,T=>T>1200);const{window:Sv}=Jx;function Rv(T){let I,L;return{c:go,m(F,G){I||(L=dh(Sv,"resize",function(){af(j1(T[1],T[0]))&&j1(T[1],T[0]).apply(this,arguments)}),I=!0)},p(F,[G]){T=F},i:go,o:go,d(F){I=!1,L()}}}function Cv(T,I,L){let F,G;B1(T,K1,s=>L(2,F=s)),B1(T,Km,s=>L(3,G=s));let{debounceDur:te=100}=I;const ae=()=>{U1(Km,G=window.innerWidth,G),U1(K1,F=window.innerHeight,F)};return Eb(()=>{ae()}),T.$$set=s=>{"debounceDur"in s&&L(0,te=s.debounceDur)},[te,ae]}class wv extends nf{constructor(I){super(),of(this,I,Cv,Rv,Yu,{debounceDur:0})}}var Sb={exports:{}};(function(T,I){(function(L,F){T.exports=F()})(vn,function(){var L,F,G;function te(s,oe){if(!L)L=oe;else if(!F)F=oe;else{var he="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+L+")(sharedChunk); ("+F+")(sharedChunk); self.onerror = null;",ve={};L(ve),G=oe(ve),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(G.workerUrl=window.URL.createObjectURL(new Blob([he],{type:"text/javascript"})))}}te(["exports"],function(s){var oe="3.3.0";let he;const ve={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(he==null){const t=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{he={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):t}catch{he=t}}return he},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!ve.API_URL)return null;try{const t=new URL(ve.API_URL);return t.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":t.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"};function Ye(t){return ve.API_URL_REGEX.test(t)}function Ce(t){return t.indexOf("mapbox:")===0}function lt(t){return ve.API_CDN_URL_REGEX.test(t)}function Ke(t){return ve.API_SPRITE_REGEX.test(t)}function Nt(t){return ve.API_STYLE_REGEX.test(t)&&!Ke(t)}const Oe={create:"create",load:"load",fullLoad:"fullLoad"};function ut(t){const e=t.name.split("?")[0];return lt(e)&&e.includes("mapbox-gl.js")?"javascript":lt(e)&&e.includes("mapbox-gl.css")?"css":function(i){return ve.API_FONTS_REGEX.test(i)}(e)?"fontRange":Ke(e)?"sprite":Nt(e)?"style":function(i){return ve.API_TILEJSON_REGEX.test(i)}(e)?"tilejson":"other"}function bt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Mt=Fi;function Fi(t,e,i,o){this.cx=3*t,this.bx=3*(i-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(o-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=i,this.p2y=o}Fi.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(e===void 0&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var i=t,o=0;o<8;o++){var l=this.sampleCurveX(i)-t;if(Math.abs(l)<e)return i;var r=this.sampleCurveDerivativeX(i);if(Math.abs(r)<1e-6)break;i-=l/r}var u=0,m=1;for(i=t,o=0;o<20&&(l=this.sampleCurveX(i),!(Math.abs(l-t)<e));o++)t>l?u=i:m=i,i=.5*(m-u)+u;return i},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}};var ai=bt(Mt),Oi=va;function va(t,e){this.x=t,this.y=e}va.prototype={clone:function(){return new va(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),i=Math.sin(t),o=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=o,this},_rotateAround:function(t,e){var i=Math.cos(t),o=Math.sin(t),l=e.y+o*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-o*(this.y-e.y),this.y=l,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},va.convert=function(t){return t instanceof va?t:Array.isArray(t)?new va(t[0],t[1]):t};var qe=bt(Oi);const yo=Math.PI/180,En=180/Math.PI;function Ot(t){return t*yo}function na(t){return t*En}const ka=[[0,0],[1,0],[1,1],[0,1]];function ot(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,i=e*t;return 4*(t<.5?i:3*(t-e)+i-.75)}function Qa(t,e,i,o){const l=new ai(t,e,i,o);return function(r){return l.solve(r)}}const Ea=Qa(.25,.1,.25,1);function Vt(t,e,i){return Math.min(i,Math.max(e,t))}function Lo(t,e,i){return(i=Vt((i-t)/(e-t),0,1))*i*(3-2*i)}function Na(t,e,i){const o=i-e,l=((t-e)%o+o)%o+e;return l===e?i:l}function No(t,e,i){if(!t.length)return i(null,[]);let o=t.length;const l=new Array(t.length);let r=null;t.forEach((u,m)=>{e(u,(p,h)=>{p&&(r=p),l[m]=h,--o==0&&i(r,l)})})}function za(t,...e){for(const i of e)for(const o in i)t[o]=i[o];return t}let Zn=1;function Es(){return Zn++}function pl(){return function t(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function hl(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function gl(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function Xn(t,e){t.forEach(i=>{e[i]&&(e[i]=e[i].bind(e))})}function Qo(t,e){return t.indexOf(e,t.length-e.length)!==-1}function Ha(t,e,i){const o={};for(const l in t)o[l]=e.call(i||this,t[l],l,t);return o}function bo(t,e,i){const o={};for(const l in t)e.call(i||this,t[l],l,t)&&(o[l]=t[l]);return o}function uo(t){return Array.isArray(t)?t.map(uo):typeof t=="object"&&t?Ha(t,uo):t}const yr={};function ta(t){yr[t]||(typeof console<"u"&&console.warn(t),yr[t]=!0)}function To(t,e,i){return(i.y-t.y)*(e.x-t.x)>(e.y-t.y)*(i.x-t.x)}function Jn(t){let e=0;for(let i,o,l=0,r=t.length,u=r-1;l<r;u=l++)i=t[l],o=t[u],e+=(o.x-i.x)*(i.y+o.y);return e}function en([t,e,i]){const o=Ot(e+90),l=Ot(i);return{x:t*Math.cos(o)*Math.sin(l),y:t*Math.sin(o)*Math.sin(l),z:t*Math.cos(l),azimuthal:e,polar:i}}function Ko(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Qn(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,o,l,r)=>{const u=l||r;return e[o]=!u||u.toLowerCase(),""}),e["max-age"]){const i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e}let _a,As,Is,xo,tn,An,Me=null;function j(t){try{const e=self[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function Q(t,e){return[t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]]}function de(t,e,i,o){for(;e<i;){const l=e+i>>1;t[l]<o?e=l+1:i=l}return e}function we(t,e,i,o){for(;e<i;){const l=e+i>>1;t[l]<=o?e=l+1:i=l}return e}function Fe(){return _a==null&&(_a=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),_a}const Ge={now:()=>xo!==void 0?xo:performance.now(),setNow(t){xo=t},restoreNow(){xo=void 0},frame(t){const e=requestAnimationFrame(t);return{cancel:()=>cancelAnimationFrame(e)}},getImageData(t,e=0){const{width:i,height:o}=t;tn||(tn=document.createElement("canvas"));const l=tn.getContext("2d",{willReadFrequently:!0});if(!l)throw new Error("failed to create canvas 2d context");return(i>tn.width||o>tn.height)&&(tn.width=i,tn.height=o),l.clearRect(-e,-e,i+2*e,o+2*e),l.drawImage(t,0,0,i,o),l.getImageData(-e,-e,i+2*e,o+2*e)},resolveURL:t=>(As||(As=document.createElement("a")),As.href=t,As.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Is==null&&(Is=window.matchMedia("(prefers-reduced-motion: reduce)")),Is.matches)},hasCanvasFingerprintNoise(){if(An!==void 0)return An;if(!Fe())return An=!1,!1;const t=new OffscreenCanvas(85,1),e=t.getContext("2d",{willReadFrequently:!0});let i=0;for(let l=0;l<t.width;++l)e.fillStyle=`rgba(${i++},${i++},${i++}, 255)`,e.fillRect(l,0,1,1);const o=e.getImageData(0,0,t.width,t.height);i=0;for(let l=0;l<o.data.length;++l)if(l%4!=3&&i++!==o.data[l])return An=!0,!0;return An=!1,!1}},gt="mapbox-tiles";let Pe=500,Tt=50,ct,vt;function Xt(){try{return caches}catch{}}function Ci(){const t=Xt();t&&!ct&&(ct=t.open(gt))}function Hi(t){const e=t.indexOf("?");if(e<0)return t;const i=["language","worldview"],o=new URLSearchParams,l=new URLSearchParams(t.slice(e));for(const r of i){const u=l.get(r);u&&o.set(r,u)}return`${t.slice(0,e)}?${o.toString()}`}function wi(t,e){const i=t.indexOf("?");if(i<0)return`${t}?${new URLSearchParams(e).toString()}`;const o=new URLSearchParams(t.slice(i));for(const l in e)o.set(l,e[l]);return`${t.slice(0,i)}?${o.toString()}`}let Ai=1/0;const Ti={supported:!1,testSupport:function(t){!Aa&&Bi&&(zi?Ga(t):Si=t)}};let Si,Bi,Aa=!1,zi=!1;const Ka=typeof self<"u"?self:{};function Ga(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,Bi),t.isContextLost())return;Ti.supported=!0}catch{}t.deleteTexture(e),Aa=!0}Ka.document&&(Bi=Ka.document.createElement("img"),Bi.onload=function(){Si&&Ga(Si),Si=null,zi=!0},Bi.onerror=function(){Aa=!0,Si=null},Bi.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const eo={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(eo);class fa extends Error{constructor(e,i,o){i===401&&Ye(o)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=i,this.url=o}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ua=Ko()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,Re=function(t,e){if(!(/^file:/.test(i=t.url)||/^file:/.test(ua())&&!/^\w+:/.test(i))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(o,l){const r=new AbortController,u=new Request(o.url,{method:o.method||"GET",body:o.body,credentials:o.credentials,headers:o.headers,referrer:ua(),referrerPolicy:o.referrerPolicy,signal:r.signal});let m=!1,p=!1;const h=(y=u.url).indexOf("sku=")>0&&Ye(y);var y;o.type==="json"&&u.headers.set("Accept","application/json");const x=(S,C,w)=>{if(p)return;if(S&&S.message!=="SecurityError"&&ta(S.toString()),C&&w)return E(C);const W=Date.now();fetch(u).then(D=>{if(D.ok){const Y=h?D.clone():null;return E(D,Y,W)}return l(new fa(D.statusText,D.status,o.url))}).catch(D=>{D.name!=="AbortError"&&l(new Error(`${D.message} ${o.url}`))})},E=(S,C,w)=>{(o.type==="arrayBuffer"?S.arrayBuffer():o.type==="json"?S.json():S.text()).then(W=>{p||(C&&w&&function(D,Y,q){if(Ci(),!ct)return;const K=Qn(Y.headers.get("Cache-Control")||"");if(K["no-store"])return;const ee={status:Y.status,statusText:Y.statusText,headers:new Headers};Y.headers.forEach((_e,me)=>ee.headers.set(me,_e)),K["max-age"]&&ee.headers.set("Expires",new Date(q+1e3*K["max-age"]).toUTCString());const J=ee.headers.get("Expires");if(!J||new Date(J).getTime()-q<42e4)return;let se=Hi(D.url);if(Y.status===206){const _e=D.headers.get("Range");if(!_e)return;ee.status=200,se=wi(se,{range:_e})}(function(_e,me){if(vt===void 0)try{new Response(new ReadableStream),vt=!0}catch{vt=!1}vt?me(_e.body):_e.blob().then(me)})(Y,_e=>{const me=new Response(_e,ee);Ci(),ct&&ct.then(be=>be.put(se,me)).catch(be=>ta(be.message))})}(u,C,w),m=!0,l(null,W,S.headers.get("Cache-Control"),S.headers.get("Expires")))}).catch(W=>{p||l(new Error(W.message))})};return h?function(S,C){if(Ci(),!ct)return C(null);ct.then(w=>{let W=Hi(S.url);const D=S.headers.get("Range");D&&(W=wi(W,{range:D})),w.match(W).then(Y=>{const q=function(K){if(!K)return!1;const ee=new Date(K.headers.get("Expires")||0),J=Qn(K.headers.get("Cache-Control")||"");return ee>Date.now()&&!J["no-cache"]}(Y);w.delete(W),q&&w.put(W,Y.clone()),C(null,Y,q)}).catch(C)}).catch(C)}(u,x):x(null,null),{cancel:()=>{p=!0,m||r.abort()}}}(t,e);if(Ko()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var i;return function(o,l){const r=new XMLHttpRequest;r.open(o.method||"GET",o.url,!0),o.type==="arrayBuffer"&&(r.responseType="arraybuffer");for(const u in o.headers)r.setRequestHeader(u,o.headers[u]);return o.type==="json"&&(r.responseType="text",r.setRequestHeader("Accept","application/json")),r.withCredentials=o.credentials==="include",r.onerror=()=>{l(new Error(r.statusText))},r.onload=()=>{if((r.status>=200&&r.status<300||r.status===0)&&r.response!==null){let u=r.response;if(o.type==="json")try{u=JSON.parse(r.response)}catch(m){return l(m)}l(null,u,r.getResponseHeader("Cache-Control"),r.getResponseHeader("Expires"))}else l(new fa(r.statusText,r.status,o.url))},r.send(o.body),{cancel:()=>r.abort()}}(t,e)},Le=function(t,e){return Re(za(t,{type:"arrayBuffer"}),e)};function Ve(t){const e=document.createElement("a");return e.href=t,e.protocol===location.protocol&&e.host===location.host}const et="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Ze,at;Ze=[],at=0;const nt=function(t,e){if(Ti.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),at>=ve.MAX_PARALLEL_IMAGE_REQUESTS){const r={requestParameters:t,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return Ze.push(r),r}at++;let i=!1;const o=()=>{if(!i)for(i=!0,at--;Ze.length&&at<ve.MAX_PARALLEL_IMAGE_REQUESTS;){const r=Ze.shift(),{requestParameters:u,callback:m,cancelled:p}=r;p||(r.cancel=nt(u,m).cancel)}},l=Le(t,(r,u,m,p)=>{o(),r?e(r):u&&(self.createImageBitmap?function(h,y){const x=new Blob([new Uint8Array(h)],{type:"image/png"});createImageBitmap(x).then(E=>{y(null,E)}).catch(E=>{y(new Error(`Could not load image because of ${E.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(u,(h,y)=>e(h,y,m,p)):function(h,y){const x=new Image;x.onload=()=>{y(null,x),URL.revokeObjectURL(x.src),x.onload=null,requestAnimationFrame(()=>{x.src=et})},x.onerror=()=>y(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const E=new Blob([new Uint8Array(h)],{type:"image/png"});x.src=h.byteLength?URL.createObjectURL(E):et}(u,(h,y)=>e(h,y,m,p)))});return{cancel:()=>{l.cancel(),o()}}},Je="01",rt="NO_ACCESS_TOKEN",tt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Dt(t){const e=t.match(tt);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function ni(t){const e=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${e}`}const It="mapbox.eventData";function Pi(t){if(!t)return null;const e=t.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(atob(e[1]).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Vi{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const i=Pi(ve.ACCESS_TOKEN);let o="";return o=i&&i.u?btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,(l,r)=>String.fromCharCode(+("0x"+r)))):ve.ACCESS_TOKEN||"",e?`${It}.${e}:${o}`:`${It}:${o}`}fetchEventData(){const e=j("localStorage"),i=this.getStorageKey(),o=this.getStorageKey("uuid");if(e)try{const l=localStorage.getItem(i);l&&(this.eventData=JSON.parse(l));const r=localStorage.getItem(o);r&&(this.anonId=r)}catch{ta("Unable to read from LocalStorage")}}saveEventData(){const e=j("localStorage"),i=this.getStorageKey(),o=this.getStorageKey("uuid"),l=this.anonId;if(e&&l)try{localStorage.setItem(o,l),Object.keys(this.eventData).length>=1&&localStorage.setItem(i,JSON.stringify(this.eventData))}catch{ta("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,i,o,l){if(!ve.EVENTS_URL)return;const r=Dt(ve.EVENTS_URL);r.params.push(`access_token=${l||ve.ACCESS_TOKEN||""}`);const u={event:this.type,created:new Date(e).toISOString()},m=i?za(u,i):u,p={url:ni(r),headers:{"Content-Type":"text/plain"},body:JSON.stringify([m])};this.pendingRequest=function(h,y){return Re(za(h,{method:"POST"}),y)}(p,h=>{this.pendingRequest=null,o(h),this.saveEventData(),this.processRequests(l)})}queueRequest(e,i){this.queue.push(e),this.processRequests(i)}}const Mi=new class extends Vi{constructor(t){super("appUserTurnstile"),this._customAccessToken=t}postTurnstileEvent(t,e){ve.EVENTS_URL&&ve.ACCESS_TOKEN&&Array.isArray(t)&&t.some(i=>Ce(i)||Ye(i))&&this.queueRequest(Date.now(),e)}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=Pi(ve.ACCESS_TOKEN),i=e?e.u:ve.ACCESS_TOKEN;let o=i!==this.eventData.tokenU;gl(this.anonId)||(this.anonId=pl(),o=!0);const l=this.queue.shift();if(this.eventData.lastSuccess){const r=new Date(this.eventData.lastSuccess),u=new Date(l),m=(l-this.eventData.lastSuccess)/864e5;o=o||m>=1||m<-1||r.getDate()!==u.getDate()}else o=!0;o?this.postEvent(l,{sdkIdentifier:"mapbox-gl-js",sdkVersion:oe,skuId:Je,"enabled.telemetry":!1,userId:this.anonId},r=>{r||(this.eventData.lastSuccess=l,this.eventData.tokenU=i)},t):this.processRequests()}},pa=Mi.postTurnstileEvent.bind(Mi),Wa=new class extends Vi{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,e,i,o){this.skuToken=e,this.errorCb=o,ve.EVENTS_URL&&(i||ve.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},i):this.errorCb(new Error(rt)))}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),gl(this.anonId)||(this.anonId=pl()),this.postEvent(i,{sdkIdentifier:"mapbox-gl-js",sdkVersion:oe,skuId:Je,skuToken:this.skuToken,userId:this.anonId},o=>{o?this.errorCb(o):e&&(this.success[e]=!0)},t))}remove(){this.errorCb=null}},yi=Wa.postMapLoadEvent.bind(Wa),co=new class extends Vi{constructor(){super("gljs.performance")}postPerformanceEvent(t,e){ve.EVENTS_URL&&(t||ve.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},t)}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:e,performanceData:i}=this.queue.shift(),o=function(l){const r=performance.getEntriesByType("resource"),u=performance.getEntriesByType("mark"),m=function(S){const C={};if(S){for(const w in S)if(w!=="other")for(const W of S[w]){const D=`${w}ResolveRangeMin`,Y=`${w}ResolveRangeMax`,q=`${w}RequestCount`,K=`${w}RequestCachedCount`;C[D]=Math.min(C[D]||1/0,W.startTime),C[Y]=Math.max(C[Y]||-1/0,W.responseEnd);const ee=J=>{C[J]===void 0&&(C[J]=0),++C[J]};W.transferSize!==void 0&&W.transferSize===0&&ee(K),ee(q)}}return C}(function(S,C){const w={};if(S)for(const W of S){const D=C(W);w[D]===void 0&&(w[D]=[]),w[D].push(W)}return w}(r,ut)),p=window.devicePixelRatio,h=navigator.connection||navigator.mozConnection||navigator.webkitConnection,y=h?h.effectiveType:void 0,x={counters:[],metadata:[],attributes:[]},E=(S,C,w)=>{w!=null&&S.push({name:C,value:w.toString()})};for(const S in m)E(x.counters,S,m[S]);if(l.interactionRange[0]!==1/0&&l.interactionRange[1]!==-1/0&&(E(x.counters,"interactionRangeMin",l.interactionRange[0]),E(x.counters,"interactionRangeMax",l.interactionRange[1])),u)for(const S of Object.keys(Oe)){const C=Oe[S],w=u.find(W=>W.name===C);w&&E(x.counters,C,w.startTime)}return E(x.counters,"visibilityHidden",l.visibilityHidden),E(x.attributes,"style",function(S){if(S)for(const C of S){const w=C.name.split("?")[0];if(Nt(w)){const W=w.split("/").slice(-2);if(W.length===2)return`mapbox://styles/${W[0]}/${W[1]}`}}}(r)),E(x.attributes,"terrainEnabled",l.terrainEnabled?"true":"false"),E(x.attributes,"fogEnabled",l.fogEnabled?"true":"false"),E(x.attributes,"projection",l.projection),E(x.attributes,"zoom",l.zoom),E(x.metadata,"devicePixelRatio",p),E(x.metadata,"connectionEffectiveType",y),E(x.metadata,"navigatorUserAgent",navigator.userAgent),E(x.metadata,"screenWidth",window.screen.width),E(x.metadata,"screenHeight",window.screen.height),E(x.metadata,"windowWidth",window.innerWidth),E(x.metadata,"windowHeight",window.innerHeight),E(x.metadata,"mapWidth",l.width/p),E(x.metadata,"mapHeight",l.height/p),E(x.metadata,"webglRenderer",l.renderer),E(x.metadata,"webglVendor",l.vendor),E(x.metadata,"sdkVersion",oe),E(x.metadata,"sdkIdentifier","mapbox-gl-js"),x}(i);for(const l of o.metadata);for(const l of o.counters);for(const l of o.attributes);this.postEvent(e,o,()=>{},t)}},Wo=co.postPerformanceEvent.bind(co),Ma=new class extends Vi{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,e,i,o){if(!ve.API_URL||!ve.SESSION_PATH)return;const l=Dt(ve.API_URL+ve.SESSION_PATH);l.params.push(`sku=${e||""}`),l.params.push(`access_token=${o||ve.ACCESS_TOKEN||""}`);const r={url:ni(l),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(u,m){return Re(za(u,{method:"GET"}),m)}(r,u=>{this.pendingRequest=null,i(u),this.saveEventData(),this.processRequests(o)})}getSessionAPI(t,e,i,o){this.skuToken=e,this.errorCb=o,ve.SESSION_PATH&&ve.API_URL&&(i||ve.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},i):this.errorCb(new Error(rt)))}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||this.getSession(i,this.skuToken,o=>{o?this.errorCb(o):e&&(this.success[e]=!0)},t)}remove(){this.errorCb=null}},yl=Ma.getSessionAPI.bind(Ma),In=new Set;function Os(t,e,i){i[t]&&i[t].indexOf(e)!==-1||(i[t]=i[t]||[],i[t].push(e))}function Wd(t,e,i){if(i&&i[t]){const o=i[t].indexOf(e);o!==-1&&i[t].splice(o,1)}}class es{constructor(e,i={}){za(this,i),this.type=e}}class Md extends es{constructor(e,i={}){super("error",za({error:e},i))}}class Ss{on(e,i){return this._listeners=this._listeners||{},Os(e,i,this._listeners),this}off(e,i){return Wd(e,i,this._listeners),Wd(e,i,this._oneTimeListeners),this}once(e,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},Os(e,i,this._oneTimeListeners),this):new Promise(o=>this.once(e,o))}fire(e,i){typeof e=="string"&&(e=new es(e,i||{}));const o=e.type;if(this.listens(o)){e.target=this;const l=this._listeners&&this._listeners[o]?this._listeners[o].slice():[];for(const m of l)m.call(this,e);const r=this._oneTimeListeners&&this._oneTimeListeners[o]?this._oneTimeListeners[o].slice():[];for(const m of r)Wd(o,m,this._oneTimeListeners),m.call(this,e);const u=this._eventedParent;u&&(za(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),u.fire(e))}else e instanceof Md&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,i){return this._eventedParent=e,this._eventedParentData=i,this}}s.y=void 0;var Vu={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function br(t){return(t=Math.round(t))<0?0:t>255?255:t}function Dd(t){return br(t[t.length-1]==="%"?parseFloat(t)/100*255:parseInt(t))}function Tr(t){return(e=t[t.length-1]==="%"?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function Fd(t,e,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?t+(e-t)*i*6:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}try{s.y={}.parseCSSColor=function(t){var e,i=t.replace(/ /g,"").toLowerCase();if(i in Vu)return Vu[i].slice();if(i[0]==="#")return i.length===4?(e=parseInt(i.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:i.length===7&&(e=parseInt(i.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var o=i.indexOf("("),l=i.indexOf(")");if(o!==-1&&l+1===i.length){var r=i.substr(0,o),u=i.substr(o+1,l-(o+1)).split(","),m=1;switch(r){case"rgba":if(u.length!==4)return null;m=Tr(u.pop());case"rgb":return u.length!==3?null:[Dd(u[0]),Dd(u[1]),Dd(u[2]),m];case"hsla":if(u.length!==4)return null;m=Tr(u.pop());case"hsl":if(u.length!==3)return null;var p=(parseFloat(u[0])%360+360)%360/360,h=Tr(u[1]),y=Tr(u[2]),x=y<=.5?y*(h+1):y+h-y*h,E=2*y-x;return[br(255*Fd(E,x,p+1/3)),br(255*Fd(E,x,p)),br(255*Fd(E,x,p-1/3)),m];default:return null}}return null}}catch{}class to{constructor(e,i,o,l=1){this.r=e,this.g=i,this.b=o,this.a=l}static parse(e){if(!e)return;if(e instanceof to)return e;if(typeof e!="string")return;const i=s.y(e);return i?new to(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3]):void 0}toString(){const[e,i,o,l]=this.toArray();return`rgba(${Math.round(e)},${Math.round(i)},${Math.round(o)},${l})`}toArray(){const{r:e,g:i,b:o,a:l}=this;return l===0?[0,0,0,0]:[255*e/l,255*i/l,255*o/l,l]}toArray01(){const{r:e,g:i,b:o,a:l}=this;return l===0?[0,0,0,0]:[e/l,i/l,o/l,l]}toArray01Scaled(e){const{r:i,g:o,b:l,a:r}=this;return r===0?[0,0,0]:[i/r*e,o/r*e,l/r*e]}toArray01PremultipliedAlpha(){const{r:e,g:i,b:o,a:l}=this;return[e,i,o,l]}toArray01Linear(){const{r:e,g:i,b:o,a:l}=this;return l===0?[0,0,0,0]:[Math.pow(e/l,2.2),Math.pow(i/l,2.2),Math.pow(o/l,2.2),l]}}to.black=new to(0,0,0,1),to.white=new to(1,1,1,1),to.transparent=new to(0,0,0,0),to.red=new to(1,0,0,1),to.blue=new to(0,0,1,1);var ca=to;function si(t,e,i){return t*(1-i)+e*i}function ju(t,e,i){return t.map((o,l)=>si(o,e[l],i))}var xr=Object.freeze({__proto__:null,array:ju,color:function(t,e,i){return new ca(si(t.r,e.r,i),si(t.g,e.g,i),si(t.b,e.b,i),si(t.a,e.a,i))},number:si});function Bd(t,...e){for(const i of e)for(const o in i)t[o]=i[o];return t}class df extends Error{constructor(e,i){super(i),this.message=i,this.key=e}}var qo=df;class Ud{constructor(e,i=[]){this.parent=e,this.bindings={};for(const[o,l]of i)this.bindings[o]=l}concat(e){return new Ud(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var _f=Ud;const Rs={kind:"null"},_t={kind:"number"},xi={kind:"string"},vi={kind:"boolean"},vo={kind:"color"},Cs={kind:"object"},ui={kind:"value"},vr={kind:"collator"},ws={kind:"formatted"},bl={kind:"resolvedImage"};function io(t,e){return{kind:"array",itemType:t,N:e}}function la(t){if(t.kind==="array"){const e=la(t.itemType);return typeof t.N=="number"?`array<${e}, ${t.N}>`:t.itemType.kind==="value"?"array":`array<${e}>`}return t.kind}const wt=[Rs,_t,xi,vi,vo,ws,Cs,io(ui),bl];function ts(t,e){if(e.kind==="error")return null;if(t.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!ts(t.itemType,e.itemType))&&(typeof t.N!="number"||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if(t.kind==="value"){for(const i of wt)if(!ts(i,e))return null}}return`Expected ${la(t)} but found ${la(e)} instead.`}function Bt(t,e){return e.some(i=>i.kind===t.kind)}function On(t,e){return e.some(i=>i==="null"?t===null:i==="array"?Array.isArray(t):i==="object"?t&&!Array.isArray(t)&&typeof t=="object":i===typeof t)}class Jt{constructor(e,i,o){this.sensitivity=e?i?"variant":"case":i?"accent":"base",this.locale=o,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,i){return this.collator.compare(e,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ps{constructor(e,i,o,l,r){this.text=e.normalize?e.normalize():e,this.image=i,this.scale=o,this.fontStack=l,this.textColor=r}}class Da{constructor(e){this.sections=e}static fromString(e){return new Da([new Ps(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.namePrimary.length!==0)}static factory(e){return e instanceof Da?e:Da.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const i of this.sections){if(i.image){e.push(["image",i.image.namePrimary]);continue}e.push(i.text);const o={};i.fontStack&&(o["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(o["font-scale"]=i.scale),i.textColor&&(o["text-color"]=["rgba"].concat(i.textColor.toArray())),e.push(o)}return e}}class Pt{constructor(e){this.namePrimary=e.namePrimary,e.nameSecondary&&(this.nameSecondary=e.nameSecondary),this.available=e.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(e,i){return e?new Pt({namePrimary:e,nameSecondary:i,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function Ku(t,e,i,o){return typeof t=="number"&&t>=0&&t<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof i=="number"&&i>=0&&i<=255?o===void 0||typeof o=="number"&&o>=0&&o<=1?null:`Invalid rgba value [${[t,e,i,o].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof o=="number"?[t,e,i,o]:[t,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function is(t){if(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||t instanceof ca||t instanceof Jt||t instanceof Da||t instanceof Pt)return!0;if(Array.isArray(t)){for(const e of t)if(!is(e))return!1;return!0}if(typeof t=="object"){for(const e in t)if(!is(t[e]))return!1;return!0}return!1}function ha(t){if(t===null)return Rs;if(typeof t=="string")return xi;if(typeof t=="boolean")return vi;if(typeof t=="number")return _t;if(t instanceof ca)return vo;if(t instanceof Jt)return vr;if(t instanceof Da)return ws;if(t instanceof Pt)return bl;if(Array.isArray(t)){const e=t.length;let i;for(const o of t){const l=ha(o);if(i){if(i===l)continue;i=ui;break}i=l}return io(i||ui,e)}return Cs}function Eo(t){const e=typeof t;return t===null?"":e==="string"||e==="number"||e==="boolean"?String(t):t instanceof ca||t instanceof Da||t instanceof Pt?t.toString():JSON.stringify(t)}class Sn{constructor(e,i){this.type=e,this.value=i}static parse(e,i){if(e.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!is(e[1]))return i.error("invalid value");const o=e[1];let l=ha(o);const r=i.expectedType;return l.kind!=="array"||l.N!==0||!r||r.kind!=="array"||typeof r.N=="number"&&r.N!==0||(l=r),new Sn(l,o)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof ca?["rgba"].concat(this.value.toArray()):this.value instanceof Da?this.value.serialize():this.value}}var an=Sn,ga=class{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}};const kd={string:xi,number:_t,boolean:vi,object:Cs};class zd{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let o,l=1;const r=e[0];if(r==="array"){let m,p;if(e.length>2){const h=e[1];if(typeof h!="string"||!(h in kd)||h==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);m=kd[h],l++}else m=ui;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return i.error('The length argument to "array" must be a positive integer literal',2);p=e[2],l++}o=io(m,p)}else o=kd[r];const u=[];for(;l<e.length;l++){const m=i.parse(e[l],l,ui);if(!m)return null;u.push(m)}return new zd(o,u)}evaluate(e){for(let i=0;i<this.args.length;i++){const o=this.args[i].evaluate(e);if(!ts(this.type,ha(o)))return o;if(i===this.args.length-1)throw new ga(`Expected value to be of type ${la(this.type)}, but found ${la(ha(o))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,i=[e.kind];if(e.kind==="array"){const o=e.itemType;if(o.kind==="string"||o.kind==="number"||o.kind==="boolean"){i.push(o.kind);const l=e.N;(typeof l=="number"||this.args.length>1)&&i.push(l)}}return i.concat(this.args.map(o=>o.serialize()))}}var on=zd;class Ls{constructor(e){this.type=ws,this.sections=e}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const o=e[1];if(!Array.isArray(o)&&typeof o=="object")return i.error("First argument must be an image or text section.");const l=[];let r=!1;for(let u=1;u<=e.length-1;++u){const m=e[u];if(r&&typeof m=="object"&&!Array.isArray(m)){r=!1;let p=null;if(m["font-scale"]&&(p=i.parse(m["font-scale"],1,_t),!p))return null;let h=null;if(m["text-font"]&&(h=i.parse(m["text-font"],1,io(xi)),!h))return null;let y=null;if(m["text-color"]&&(y=i.parse(m["text-color"],1,vo),!y))return null;const x=l[l.length-1];x.scale=p,x.font=h,x.textColor=y}else{const p=i.parse(e[u],1,ui);if(!p)return null;const h=p.type.kind;if(h!=="string"&&h!=="value"&&h!=="null"&&h!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");r=!0,l.push({content:p,scale:null,font:null,textColor:null})}}return new Ls(l)}evaluate(e){return new Da(this.sections.map(i=>{const o=i.content.evaluate(e);return ha(o)===bl?new Ps("",o,null,null,null):new Ps(Eo(o),null,i.scale?i.scale.evaluate(e):null,i.font?i.font.evaluate(e).join(","):null,i.textColor?i.textColor.evaluate(e):null)}))}eachChild(e){for(const i of this.sections)e(i.content),i.scale&&e(i.scale),i.font&&e(i.font),i.textColor&&e(i.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const i of this.sections){e.push(i.content.serialize());const o={};i.scale&&(o["font-scale"]=i.scale.serialize()),i.font&&(o["text-font"]=i.font.serialize()),i.textColor&&(o["text-color"]=i.textColor.serialize()),e.push(o)}return e}}class as{constructor(e,i){this.type=bl,this.inputPrimary=e,this.inputSecondary=i}static parse(e,i){if(e.length<2)return i.error("Expected two or more arguments.");const o=i.parse(e[1],1,xi);if(!o)return i.error("No image name provided.");if(e.length===2)return new as(o);const l=i.parse(e[2],1,xi);return l?new as(o,l):i.error("Secondary image variant is not a string.")}evaluate(e){const i=Pt.fromString(this.inputPrimary.evaluate(e),this.inputSecondary?this.inputSecondary.evaluate(e):void 0);return i&&e.availableImages&&(i.available=e.availableImages.indexOf(i.namePrimary)>-1,i.nameSecondary&&i.available&&e.availableImages&&(i.available=e.availableImages.indexOf(i.nameSecondary)>-1)),i}eachChild(e){e(this.inputPrimary),this.inputSecondary&&e(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function Ns(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":t===null?"null":typeof t}const Mo={"to-boolean":vi,"to-color":vo,"to-number":_t,"to-string":xi};class Er{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const o=e[0],l=[];let r=Rs;if(o==="to-array"){if(!Array.isArray(e[1]))return null;const u=e[1].length;if(i.expectedType){if(i.expectedType.kind!=="array")return i.error(`Expected ${i.expectedType.kind} but found array.`);r=io(i.expectedType.itemType,u)}else{if(!(u>0&&is(e[1][0])))return null;r=io(ha(e[1][0]),u)}for(let m=0;m<u;m++){const p=e[1][m];let h;if(Ns(p)==="array")h=i.parse(p,void 0,r.itemType);else{const y=Ns(p);if(y!==r.itemType.kind)return i.error(`Expected ${r.itemType.kind} but found ${y}.`);h=i.registry.literal.parse(["literal",p===void 0?null:p],i)}if(!h)return null;l.push(h)}}else{if((o==="to-boolean"||o==="to-string")&&e.length!==2)return i.error("Expected one argument.");r=Mo[o];for(let u=1;u<e.length;u++){const m=i.parse(e[u],u,ui);if(!m)return null;l.push(m)}}return new Er(r,l)}evaluate(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){let i,o;for(const l of this.args){if(i=l.evaluate(e),o=null,i instanceof ca)return i;if(typeof i=="string"){const r=e.parseColor(i);if(r)return r}else if(Array.isArray(i)&&(o=i.length<3||i.length>4?`Invalid rbga value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:Ku(i[0],i[1],i[2],i[3]),!o))return new ca(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new ga(o||`Could not parse color from value '${typeof i=="string"?i:String(JSON.stringify(i))}'`)}if(this.type.kind==="number"){let i=null;for(const o of this.args){if(i=o.evaluate(e),i===null)return 0;const l=Number(i);if(!isNaN(l))return l}throw new ga(`Could not convert ${JSON.stringify(i)} to number.`)}return this.type.kind==="formatted"?Da.fromString(Eo(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Pt.fromString(Eo(this.args[0].evaluate(e))):this.type.kind==="array"?this.args.map(i=>i.evaluate(e)):Eo(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Ls([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new as(this.args[0]).serialize();const e=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(i=>{e.push(i.serialize())}),e}}var nn=Er;const Tl=["Unknown","Point","LineString","Polygon"];var qu=class{constructor(t,e){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=t,this.options=e}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Tl[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(t){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:i,y:o}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(i*e-t[0])+this.featureDistanceData.bearing[1]*(o*e-t[1])}return 0}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=ca.parse(t)),e}getConfig(t){return this.options?this.options.get(t):null}};class os{constructor(e,i,o,l,r){this.name=e,this.type=i,this._evaluate=o,this.args=l,this._overloadIndex=r}evaluate(e){if(!this._evaluate){const i=os.definitions[this.name];this._evaluate=Array.isArray(i)?i[2]:i.overloads[this._overloadIndex][1]}return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,i){const o=e[0],l=os.definitions[o];if(!l)return i.error(`Unknown expression "${o}". If you wanted a literal array, use ["literal", [...]].`,0);const r=Array.isArray(l)?l[0]:l.type,u=Array.isArray(l)?[[l[1],l[2]]]:l.overloads,m=[];let p=null,h=-1;for(const[y,x]of u){if(Array.isArray(y)&&y.length!==e.length-1)continue;m.push(y),h++,p=new tc(i.registry,i.path,null,i.scope,void 0,i._scope,i.options);const E=[];let S=!1;for(let C=1;C<e.length;C++){const w=e[C],W=Array.isArray(y)?y[C-1]:y.type,D=p.parse(w,1+E.length,W);if(!D){S=!0;break}E.push(D)}if(!S)if(Array.isArray(y)&&y.length!==E.length)p.error(`Expected ${y.length} arguments, but found ${E.length} instead.`);else{for(let C=0;C<E.length;C++){const w=Array.isArray(y)?y[C]:y.type,W=E[C];p.concat(C+1).checkSubtype(w,W.type)}if(p.errors.length===0)return new os(o,r,x,E,h)}}if(m.length===1)i.errors.push(...p.errors);else{const y=(m.length?m:u.map(([E])=>E)).map($u).join(" | "),x=[];for(let E=1;E<e.length;E++){const S=i.parse(e[E],1+x.length);if(!S)return null;x.push(la(S.type))}i.error(`Expected arguments of type ${y}, but found (${x.join(", ")}) instead.`)}return null}static register(e,i){os.definitions=i;for(const o in i)e[o]=os}}function $u(t){return Array.isArray(t)?`(${t.map(la).join(", ")})`:`(${la(t.type)}...)`}var ri=os;class xl{constructor(e,i,o){this.type=vr,this.locale=o,this.caseSensitive=e,this.diacriticSensitive=i}static parse(e,i){if(e.length!==2)return i.error("Expected one argument.");const o=e[1];if(typeof o!="object"||Array.isArray(o))return i.error("Collator options argument must be an object.");const l=i.parse(o["case-sensitive"]!==void 0&&o["case-sensitive"],1,vi);if(!l)return null;const r=i.parse(o["diacritic-sensitive"]!==void 0&&o["diacritic-sensitive"],1,vi);if(!r)return null;let u=null;return o.locale&&(u=i.parse(o.locale,1,xi),!u)?null:new xl(l,r,u)}evaluate(e){return new Jt(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}var Hd={exports:{}};Hd.exports=function(){function t(o,l,r,u,m){for(;u>r;){if(u-r>600){var p=u-r+1,h=l-r+1,y=Math.log(p),x=.5*Math.exp(2*y/3),E=.5*Math.sqrt(y*x*(p-x)/p)*(h-p/2<0?-1:1);t(o,l,Math.max(r,Math.floor(l-h*x/p+E)),Math.min(u,Math.floor(l+(p-h)*x/p+E)),m)}var S=o[l],C=r,w=u;for(e(o,r,l),m(o[u],S)>0&&e(o,r,u);C<w;){for(e(o,C,w),C++,w--;m(o[C],S)<0;)C++;for(;m(o[w],S)>0;)w--}m(o[r],S)===0?e(o,r,w):e(o,++w,u),w<=l&&(r=w+1),l<=w&&(u=w-1)}}function e(o,l,r){var u=o[l];o[l]=o[r],o[r]=u}function i(o,l){return o<l?-1:o>l?1:0}return function(o,l,r,u,m){t(o,l,r||0,u||o.length-1,m||i)}}();var uf=bt(Hd.exports);function cf(t){let e=0;for(let i,o,l=0,r=t.length,u=r-1;l<r;u=l++)i=t[l],o=t[u],e+=(o.x-i.x)*(i.y+o.y);return e}function Rn(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function Cn(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function Ar(t,e,i){const o=t[0]-e[0],l=t[1]-e[1],r=t[0]-i[0],u=t[1]-i[1];return o*u-r*l==0&&o*r<=0&&l*u<=0}function Ws(t,e,i=!1){let o=!1;for(let m=0,p=e.length;m<p;m++){const h=e[m];for(let y=0,x=h.length,E=x-1;y<x;E=y++){const S=h[E],C=h[y];if(Ar(t,S,C))return i;(r=S)[1]>(l=t)[1]!=(u=C)[1]>l[1]&&l[0]<(u[0]-r[0])*(l[1]-r[1])/(u[1]-r[1])+r[0]&&(o=!o)}}var l,r,u;return o}function Yd(t,e,i,o){const l=o[0]-i[0],r=o[1]-i[1],u=(t[0]-i[0])*r-l*(t[1]-i[1]),m=(e[0]-i[0])*r-l*(e[1]-i[1]);return u>0&&m<0||u<0&&m>0}function sn(t,e,i,o){return(l=[o[0]-i[0],o[1]-i[1]])[0]*(r=[e[0]-t[0],e[1]-t[1]])[1]-l[1]*r[0]!=0&&!(!Yd(t,e,i,o)||!Yd(i,o,t,e));var l,r}const wn=8192;function vl(t,e){const i=(180+t[0])/360,o=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,l=Math.pow(2,e.z);return[Math.round(i*l*wn),Math.round(o*l*wn)]}function Gd(t,e){for(let i=0;i<e.length;i++)if(Ws(t,e[i]))return!0;return!1}function Vd(t,e,i){for(const o of i)for(let l=0,r=o.length,u=r-1;l<r;u=l++)if(sn(t,e,o[u],o[l]))return!0;return!1}function Ao(t,e){for(let i=0;i<t.length;++i)if(!Ws(t[i],e))return!1;for(let i=0;i<t.length-1;++i)if(Vd(t[i],t[i+1],e))return!1;return!0}function Zu(t,e){for(let i=0;i<e.length;i++)if(Ao(t,e[i]))return!0;return!1}function jd(t,e,i){const o=[];for(let l=0;l<t.length;l++){const r=[];for(let u=0;u<t[l].length;u++){const m=vl(t[l][u],i);Rn(e,m),r.push(m)}o.push(r)}return o}function Kd(t,e,i){const o=[];for(let l=0;l<t.length;l++){const r=jd(t[l],e,i);o.push(r)}return o}function qd(t,e,i,o){if(t[0]<i[0]||t[0]>i[2]){const l=.5*o;let r=t[0]-i[0]>l?-o:i[0]-t[0]>l?o:0;r===0&&(r=t[0]-i[2]>l?-o:i[2]-t[0]>l?o:0),t[0]+=r}Rn(e,t)}function $d(t,e,i,o){const l=Math.pow(2,o.z)*wn,r=[o.x*wn,o.y*wn],u=[];if(!t)return u;for(const m of t)for(const p of m){const h=[p.x+r[0],p.y+r[1]];qd(h,e,i,l),u.push(h)}return u}function Zd(t,e,i,o){const l=Math.pow(2,o.z)*wn,r=[o.x*wn,o.y*wn],u=[];if(!t)return u;for(const p of t){const h=[];for(const y of p){const x=[y.x+r[0],y.y+r[1]];Rn(e,x),h.push(x)}u.push(h)}if(e[2]-e[0]<=l/2){(m=e)[0]=m[1]=1/0,m[2]=m[3]=-1/0;for(const p of u)for(const h of p)qd(h,e,i,l)}var m;return u}class Ms{constructor(e,i){this.type=vi,this.geojson=e,this.geometries=i}static parse(e,i){if(e.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(is(e[1])){const o=e[1];if(o.type==="FeatureCollection")for(let l=0;l<o.features.length;++l){const r=o.features[l].geometry.type;if(r==="Polygon"||r==="MultiPolygon")return new Ms(o,o.features[l].geometry)}else if(o.type==="Feature"){const l=o.geometry.type;if(l==="Polygon"||l==="MultiPolygon")return new Ms(o,o.geometry)}else if(o.type==="Polygon"||o.type==="MultiPolygon")return new Ms(o,o)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(i,o){const l=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],u=i.canonicalID();if(!u)return!1;if(o.type==="Polygon"){const m=jd(o.coordinates,r,u),p=$d(i.geometry(),l,r,u);if(!Cn(l,r))return!1;for(const h of p)if(!Ws(h,m))return!1}if(o.type==="MultiPolygon"){const m=Kd(o.coordinates,r,u),p=$d(i.geometry(),l,r,u);if(!Cn(l,r))return!1;for(const h of p)if(!Gd(h,m))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(i,o){const l=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],u=i.canonicalID();if(!u)return!1;if(o.type==="Polygon"){const m=jd(o.coordinates,r,u),p=Zd(i.geometry(),l,r,u);if(!Cn(l,r))return!1;for(const h of p)if(!Ao(h,m))return!1}if(o.type==="MultiPolygon"){const m=Kd(o.coordinates,r,u),p=Zd(i.geometry(),l,r,u);if(!Cn(l,r))return!1;for(const h of p)if(!Zu(h,m))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Ir=Ms,El={exports:{}};El.exports=function(){var t={kilometers:1,miles:.621371192237334,nauticalmiles:.5399568034557235,meters:1e3,metres:1e3,yards:1093.6132983377079,feet:3280.839895013123,inches:39370.078740157485},e=1/298.257223563,i=e*(2-e),o=Math.PI/180,l=function(h,y){if(h===void 0)throw new Error("No latitude given.");if(y&&!t[y])throw new Error("Unknown unit "+y+". Use one of: "+Object.keys(t).join(", "));var x=6378.137*o*(y?t[y]:1),E=Math.cos(h*o),S=1/(1-i*(1-E*E)),C=Math.sqrt(S);this.kx=x*C*E,this.ky=x*C*S*(1-i)},r={units:{configurable:!0}};function u(h,y){return h[0]===y[0]&&h[1]===y[1]}function m(h,y,x){var E=p(y[0]-h[0]);return[h[0]+E*x,h[1]+(y[1]-h[1])*x]}function p(h){for(;h<-180;)h+=360;for(;h>180;)h-=360;return h}return l.fromTile=function(h,y,x){var E=Math.PI*(1-2*(h+.5)/Math.pow(2,y)),S=Math.atan(.5*(Math.exp(E)-Math.exp(-E)))/o;return new l(S,x)},r.units.get=function(){return t},l.prototype.distance=function(h,y){var x=p(h[0]-y[0])*this.kx,E=(h[1]-y[1])*this.ky;return Math.sqrt(x*x+E*E)},l.prototype.bearing=function(h,y){var x=p(y[0]-h[0])*this.kx;return Math.atan2(x,(y[1]-h[1])*this.ky)/o},l.prototype.destination=function(h,y,x){var E=x*o;return this.offset(h,Math.sin(E)*y,Math.cos(E)*y)},l.prototype.offset=function(h,y,x){return[h[0]+y/this.kx,h[1]+x/this.ky]},l.prototype.lineDistance=function(h){for(var y=0,x=0;x<h.length-1;x++)y+=this.distance(h[x],h[x+1]);return y},l.prototype.area=function(h){for(var y=0,x=0;x<h.length;x++)for(var E=h[x],S=0,C=E.length,w=C-1;S<C;w=S++)y+=p(E[S][0]-E[w][0])*(E[S][1]+E[w][1])*(x?-1:1);return Math.abs(y)/2*this.kx*this.ky},l.prototype.along=function(h,y){var x=0;if(y<=0)return h[0];for(var E=0;E<h.length-1;E++){var S=h[E],C=h[E+1],w=this.distance(S,C);if((x+=w)>y)return m(S,C,(y-(x-w))/w)}return h[h.length-1]},l.prototype.pointToSegmentDistance=function(h,y,x){var E=y[0],S=y[1],C=p(x[0]-E)*this.kx,w=(x[1]-S)*this.ky,W=0;return C===0&&w===0||((W=(p(h[0]-E)*this.kx*C+(h[1]-S)*this.ky*w)/(C*C+w*w))>1?(E=x[0],S=x[1]):W>0&&(E+=C/this.kx*W,S+=w/this.ky*W)),C=p(h[0]-E)*this.kx,w=(h[1]-S)*this.ky,Math.sqrt(C*C+w*w)},l.prototype.pointOnLine=function(h,y){for(var x,E,S,C,w=1/0,W=0;W<h.length-1;W++){var D=h[W][0],Y=h[W][1],q=p(h[W+1][0]-D)*this.kx,K=(h[W+1][1]-Y)*this.ky,ee=0;q===0&&K===0||((ee=(p(y[0]-D)*this.kx*q+(y[1]-Y)*this.ky*K)/(q*q+K*K))>1?(D=h[W+1][0],Y=h[W+1][1]):ee>0&&(D+=q/this.kx*ee,Y+=K/this.ky*ee));var J=(q=p(y[0]-D)*this.kx)*q+(K=(y[1]-Y)*this.ky)*K;J<w&&(w=J,x=D,E=Y,S=W,C=ee)}return{point:[x,E],index:S,t:Math.max(0,Math.min(1,C))}},l.prototype.lineSlice=function(h,y,x){var E=this.pointOnLine(x,h),S=this.pointOnLine(x,y);if(E.index>S.index||E.index===S.index&&E.t>S.t){var C=E;E=S,S=C}var w=[E.point],W=E.index+1,D=S.index;!u(x[W],w[0])&&W<=D&&w.push(x[W]);for(var Y=W+1;Y<=D;Y++)w.push(x[Y]);return u(x[D],S.point)||w.push(S.point),w},l.prototype.lineSliceAlong=function(h,y,x){for(var E=0,S=[],C=0;C<x.length-1;C++){var w=x[C],W=x[C+1],D=this.distance(w,W);if((E+=D)>h&&S.length===0&&S.push(m(w,W,(h-(E-D))/D)),E>=y)return S.push(m(w,W,(y-(E-D))/D)),S;E>h&&S.push(W)}return S},l.prototype.bufferPoint=function(h,y){var x=y/this.ky,E=y/this.kx;return[h[0]-E,h[1]-x,h[0]+E,h[1]+x]},l.prototype.bufferBBox=function(h,y){var x=y/this.ky,E=y/this.kx;return[h[0]-E,h[1]-x,h[2]+E,h[3]+x]},l.prototype.insideBBox=function(h,y){return p(h[0]-y[0])>=0&&p(h[0]-y[2])<=0&&h[1]>=y[1]&&h[1]<=y[3]},Object.defineProperties(l,r),l}();var Pn=bt(El.exports),Xd={exports:{}};Xd.exports=function(){var t=function(i,o){if(i===void 0&&(i=[]),o===void 0&&(o=e),this.data=i,this.length=this.data.length,this.compare=o,this.length>0)for(var l=(this.length>>1)-1;l>=0;l--)this._down(l)};function e(i,o){return i<o?-1:i>o?1:0}return t.prototype.push=function(i){this.data.push(i),this.length++,this._up(this.length-1)},t.prototype.pop=function(){if(this.length!==0){var i=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),i}},t.prototype.peek=function(){return this.data[0]},t.prototype._up=function(i){for(var o=this.data,l=this.compare,r=o[i];i>0;){var u=i-1>>1,m=o[u];if(l(r,m)>=0)break;o[i]=m,i=u}o[i]=r},t.prototype._down=function(i){for(var o=this.data,l=this.compare,r=this.length>>1,u=o[i];i<r;){var m=1+(i<<1),p=o[m],h=m+1;if(h<this.length&&l(o[h],p)<0&&(m=h,p=o[h]),l(p,u)>=0)break;o[i]=p,i=m}o[i]=u},t}();var Io=bt(Xd.exports),st=8192;function Or(t,e){return e.dist-t.dist}const Jd=100,Al=50;function Qd(t){const e=[1/0,1/0,-1/0,-1/0];if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}function Ln(t){return t[1]-t[0]+1}function Do(t,e){const i=t[1]>=t[0]&&t[1]<e;return i||console.warn("Distance Expression: Index is out of range"),i}function e_(t,e){if(t[0]>t[1])return[null,null];const i=Ln(t);if(e){if(i===2)return[t,null];const o=Math.floor(i/2);return[[t[0],t[0]+o],[t[0]+o,t[1]]]}{if(i===1)return[t,null];const o=Math.floor(i/2)-1;return[[t[0],t[0]+o],[t[0]+o+1,t[1]]]}}function ns(t,e){const i=[1/0,1/0,-1/0,-1/0];if(!Do(e,t.length))return i;for(let o=e[0];o<=e[1];++o)Rn(i,t[o]);return i}function Sr(t){const e=[1/0,1/0,-1/0,-1/0];for(let i=0;i<t.length;++i)for(let o=0;o<t[i].length;++o)Rn(e,t[i][o]);return e}function ss(t,e,i){if(Qd(t)||Qd(e))return NaN;let o=0,l=0;return t[2]<e[0]&&(o=e[0]-t[2]),t[0]>e[2]&&(o=t[0]-e[2]),t[1]>e[3]&&(l=t[1]-e[3]),t[3]<e[1]&&(l=e[1]-t[3]),i.distance([0,0],[o,l])}function t_(t){return 360*t-180}function mf(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function Ds(t,e){const i=Math.pow(2,e.z),o=(t.y/st+e.y)/i;return[t_((t.x/st+e.x)/i),mf(o)]}function ff(t,e){const i=[];for(let o=0;o<t.length;++o)i.push(Ds(t[o],e));return i}function Xu(t,e,i){const o=i.pointOnLine(e,t).point;return i.distance(t,o)}function Ju(t,e,i,o,l){const r=i.slice(o[0],o[1]+1);let u=1/0;for(let m=e[0];m<=e[1];++m)if((u=Math.min(u,Xu(t[m],r,l)))===0)return 0;return u}function i_(t,e,i,o,l){const r=Math.min(l.pointToSegmentDistance(t,i,o),l.pointToSegmentDistance(e,i,o)),u=Math.min(l.pointToSegmentDistance(i,t,e),l.pointToSegmentDistance(o,t,e));return Math.min(r,u)}function pf(t,e,i,o,l){if(!Do(e,t.length)||!Do(o,i.length))return NaN;let r=1/0;for(let u=e[0];u<e[1];++u)for(let m=o[0];m<o[1];++m){if(sn(t[u],t[u+1],i[m],i[m+1]))return 0;r=Math.min(r,i_(t[u],t[u+1],i[m],i[m+1],l))}return r}function hf(t,e,i,o,l){if(!Do(e,t.length)||!Do(o,i.length))return NaN;let r=1/0;for(let u=e[0];u<=e[1];++u)for(let m=o[0];m<=o[1];++m)if((r=Math.min(r,l.distance(t[u],i[m])))===0)return r;return r}function gf(t,e,i){if(Ws(t,e,!0))return 0;let o=1/0;for(const l of e){const r=l.length;if(r<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(l[0]!==l[r-1]&&(o=Math.min(o,i.pointToSegmentDistance(t,l[r-1],l[0])))===0||(o=Math.min(o,Xu(t,l,i)))===0)return o}return o}function Qu(t,e,i,o){if(!Do(e,t.length))return NaN;for(let r=e[0];r<=e[1];++r)if(Ws(t[r],i,!0))return 0;let l=1/0;for(let r=e[0];r<e[1];++r)for(const u of i)for(let m=0,p=u.length,h=p-1;m<p;h=m++){if(sn(t[r],t[r+1],u[h],u[m]))return 0;l=Math.min(l,i_(t[r],t[r+1],u[h],u[m],o))}return l}function Il(t,e){for(const i of t)for(let o=0;o<=i.length-1;++o)if(Ws(i[o],e,!0))return!0;return!1}function yf(t,e,i,o=1/0){const l=Sr(t),r=Sr(e);if(o!==1/0&&ss(l,r,i)>=o)return o;if(Cn(l,r)){if(Il(t,e))return 0}else if(Il(e,t))return 0;let u=o;for(const m of t)for(let p=0,h=m.length,y=h-1;p<h;y=p++)for(const x of e)for(let E=0,S=x.length,C=S-1;E<S;C=E++){if(sn(m[y],m[p],x[C],x[E]))return 0;u=Math.min(u,i_(m[y],m[p],x[C],x[E],i))}return u}function Rr(t,e,i,o,l,r,u){if(r===null||u===null)return;const m=ss(ns(o,r),ns(l,u),i);m<e&&t.push({dist:m,range1:r,range2:u})}function a_(t,e,i,o,l=1/0){let r=Math.min(o.distance(t[0],i[0][0]),l);if(r===0)return r;const u=new Io([{dist:0,range1:[0,t.length-1],range2:[0,0]}],Or),m=e?Al:Jd,p=Sr(i);for(;u.length;){const h=u.pop();if(h.dist>=r)continue;const y=h.range1;if(Ln(y)<=m){if(!Do(y,t.length))return NaN;if(e){const x=Qu(t,y,i,o);if((r=Math.min(r,x))===0)return r}else for(let x=y[0];x<=y[1];++x){const E=gf(t[x],i,o);if((r=Math.min(r,E))===0)return r}}else{const x=e_(y,e);if(x[0]!==null){const E=ss(ns(t,x[0]),p,o);E<r&&u.push({dist:E,range1:x[0],range2:[0,0]})}if(x[1]!==null){const E=ss(ns(t,x[1]),p,o);E<r&&u.push({dist:E,range1:x[1],range2:[0,0]})}}}return r}function ec(t,e,i,o,l,r=1/0){let u=Math.min(r,l.distance(t[0],i[0]));if(u===0)return u;const m=new Io([{dist:0,range1:[0,t.length-1],range2:[0,i.length-1]}],Or),p=e?Al:Jd,h=o?Al:Jd;for(;m.length;){const y=m.pop();if(y.dist>=u)continue;const x=y.range1,E=y.range2;if(Ln(x)<=p&&Ln(E)<=h){if(!Do(x,t.length)||!Do(E,i.length))return NaN;if(e&&o?u=Math.min(u,pf(t,x,i,E,l)):e||o?e&&!o?u=Math.min(u,Ju(i,E,t,x,l)):!e&&o&&(u=Math.min(u,Ju(t,x,i,E,l))):u=Math.min(u,hf(t,x,i,E,l)),u===0)return u}else{const S=e_(x,e),C=e_(E,o);Rr(m,u,l,t,i,S[0],C[0]),Rr(m,u,l,t,i,S[0],C[1]),Rr(m,u,l,t,i,S[1],C[0]),Rr(m,u,l,t,i,S[1],C[1])}}return u}function o_(t,e,i,o,l=1/0){let r=l;const u=ns(t,[0,t.length-1]);for(const m of i)if(!(r!==1/0&&ss(u,ns(m,[0,m.length-1]),o)>=r)&&(r=Math.min(r,ec(t,e,m,!0,o,r)),r===0))return r;return r}function Cr(t,e,i,o,l=1/0){let r=l;const u=ns(t,[0,t.length-1]);for(const m of i){if(r!==1/0&&ss(u,Sr(m),o)>=r)continue;const p=a_(t,e,m,o,r);if(isNaN(p))return p;if((r=Math.min(r,p))===0)return r}return r}function n_(t){return t==="Point"||t==="MultiPoint"||t==="LineString"||t==="MultiLineString"||t==="Polygon"||t==="MultiPolygon"}class ls{constructor(e,i){this.type=_t,this.geojson=e,this.geometries=i}static parse(e,i){if(e.length!==2)return i.error(`'distance' expression requires either one argument, but found ' ${e.length-1} instead.`);if(is(e[1])){const o=e[1];if(o.type==="FeatureCollection"){for(let l=0;l<o.features.length;++l)if(n_(o.features[l].geometry.type))return new ls(o,o.features[l].geometry)}else if(o.type==="Feature"){if(n_(o.geometry.type))return new ls(o,o.geometry)}else if(n_(o.type))return new ls(o,o)}return i.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(e){const i=e.geometry(),o=e.canonicalID();if(i!=null&&o!=null){if(e.geometryType()==="Point")return function(l,r,u){const m=[];for(const h of l)for(const y of h)m.push(Ds(y,r));const p=new Pn(m[0][1],"meters");return u.type==="Point"||u.type==="MultiPoint"||u.type==="LineString"?ec(m,!1,u.type==="Point"?[u.coordinates]:u.coordinates,u.type==="LineString",p):u.type==="MultiLineString"?o_(m,!1,u.coordinates,p):u.type==="Polygon"||u.type==="MultiPolygon"?Cr(m,!1,u.type==="Polygon"?[u.coordinates]:u.coordinates,p):null}(i,o,this.geometries);if(e.geometryType()==="LineString")return function(l,r,u){const m=[];for(const h of l){const y=[];for(const x of h)y.push(Ds(x,r));m.push(y)}const p=new Pn(m[0][0][1],"meters");if(u.type==="Point"||u.type==="MultiPoint"||u.type==="LineString")return o_(u.type==="Point"?[u.coordinates]:u.coordinates,u.type==="LineString",m,p);if(u.type==="MultiLineString"){let h=1/0;for(let y=0;y<u.coordinates.length;y++){const x=o_(u.coordinates[y],!0,m,p,h);if(isNaN(x))return x;if((h=Math.min(h,x))===0)return h}return h}if(u.type==="Polygon"||u.type==="MultiPolygon"){let h=1/0;for(let y=0;y<m.length;y++){const x=Cr(m[y],!0,u.type==="Polygon"?[u.coordinates]:u.coordinates,p,h);if(isNaN(x))return x;if((h=Math.min(h,x))===0)return h}return h}return null}(i,o,this.geometries);if(e.geometryType()==="Polygon")return function(l,r,u){const m=[];for(const h of function(y,x){const E=y.length;if(E<=1)return[y];const S=[];let C,w;for(let W=0;W<E;W++){const D=cf(y[W]);D!==0&&(y[W].area=Math.abs(D),w===void 0&&(w=D<0),w===D<0?(C&&S.push(C),C=[y[W]]):C.push(y[W]))}return C&&S.push(C),S}(l)){const y=[];for(let x=0;x<h.length;++x)y.push(ff(h[x],r));m.push(y)}const p=new Pn(m[0][0][0][1],"meters");if(u.type==="Point"||u.type==="MultiPoint"||u.type==="LineString")return Cr(u.type==="Point"?[u.coordinates]:u.coordinates,u.type==="LineString",m,p);if(u.type==="MultiLineString"){let h=1/0;for(let y=0;y<u.coordinates.length;y++){const x=Cr(u.coordinates[y],!0,m,p,h);if(isNaN(x))return x;if((h=Math.min(h,x))===0)return h}return h}return u.type==="Polygon"||u.type==="MultiPolygon"?function(h,y,x){let E=1/0;for(const S of h)for(const C of y){const w=yf(S,C,x,E);if(isNaN(w))return w;if((E=Math.min(E,w))===0)return E}return E}(u.type==="Polygon"?[u.coordinates]:u.coordinates,m,p):null}(i,o,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}var wr=ls;function Ol(t,e){switch(t){case"string":return Eo(e);case"number":return+e;case"boolean":return!!e;case"color":return ca.parse(e);case"formatted":return Da.fromString(Eo(e));case"resolvedImage":return Pt.fromString(Eo(e))}return e}function s_(t,e,i,o){return o!==void 0&&(t=o*Math.round(t/o)),e!==void 0&&t<e&&(t=e),i!==void 0&&t>i&&(t=i),t}class Sl{constructor(e,i,o){this.type=e,this.key=i,this.scope=o}static parse(e,i){let o=i.expectedType;if(o==null&&(o=ui),e.length<2||e.length>3)return i.error("Invalid number of arguments for 'config' expression.");const l=i.parse(e[1],1);if(!(l instanceof an))return i.error("Key name of 'config' expression must be a string literal.");if(e.length>=3){const r=i.parse(e[2],2);return r instanceof an?new Sl(o,Eo(l.value),Eo(r.value)):i.error("Scope of 'config' expression must be a string literal.")}return new Sl(o,Eo(l.value))}evaluate(e){const i=[this.key,this.scope,e.scope].filter(Boolean).join(""),o=e.getConfig(i);if(!o)return null;const{type:l,value:r,values:u,minValue:m,maxValue:p,stepValue:h}=o,y=o.default.evaluate(e);let x=y;if(r){const E=e.scope;e.scope=(E||"").split("").slice(1).join(""),x=r.evaluate(e),e.scope=E}return l&&(x=Ol(l,x)),x===void 0||m===void 0&&p===void 0&&h===void 0||(typeof x=="number"?x=s_(x,m,p,h):Array.isArray(x)&&(x=x.map(E=>typeof E=="number"?s_(E,m,p,h):E))),r!==void 0&&x!==void 0&&u&&!u.includes(x)&&(x=y,l&&(x=Ol(l,x))),(l&&l!==this.type||x!==void 0&&ha(x)!==this.type)&&(x=Ol(this.type.kind,x)),x}eachChild(){}outputDefined(){return!1}serialize(){const e=["config",this.key];return this.scope&&e.concat(this.key),e}}var Fs=Sl;function Bs(t){if(t instanceof ri&&(t.name==="get"&&t.args.length===1||t.name==="feature-state"||t.name==="has"&&t.args.length===1||t.name==="properties"||t.name==="geometry-type"||t.name==="id"||/^filter-/.test(t.name))||t instanceof Ir||t instanceof wr)return!1;let e=!0;return t.eachChild(i=>{e&&!Bs(i)&&(e=!1)}),e}function Rl(t){if(t instanceof ri&&t.name==="feature-state")return!1;let e=!0;return t.eachChild(i=>{e&&!Rl(i)&&(e=!1)}),e}function Cl(t){if(t instanceof Fs)return!1;let e=!0;return t.eachChild(i=>{e&&!Cl(i)&&(e=!1)}),e}function Fa(t,e){if(t instanceof ri&&e.indexOf(t.name)>=0)return!1;let i=!0;return t.eachChild(o=>{i&&!Fa(o,e)&&(i=!1)}),i}class Nn{constructor(e,i){this.type=i.type,this.name=e,this.boundExpression=i}static parse(e,i){if(e.length!==2||typeof e[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const o=e[1];return i.scope.has(o)?new Nn(o,i.scope.get(o)):i.error(`Unknown variable "${o}". Make sure "${o}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var qa=Nn;class l_{constructor(e,i=[],o,l=new _f,r=[],u,m){this.registry=e,this.path=i,this.key=i.map(p=>`[${p}]`).join(""),this.scope=l,this.errors=r,this.expectedType=o,this._scope=u,this.options=m}parse(e,i,o,l,r={}){return i||o?this.concat(i,o,l)._parse(e,r):this._parse(e,r)}_parse(e,i){function o(l,r,u){return u==="assert"?new on(r,[l]):u==="coerce"?new nn(r,[l]):l}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const l=typeof e[0]=="string"?this.registry[e[0]]:void 0;if(l){let r=l.parse(e,this);if(!r)return null;if(this.expectedType){const u=this.expectedType,m=r.type;if(u.kind!=="string"&&u.kind!=="number"&&u.kind!=="boolean"&&u.kind!=="object"&&u.kind!=="array"||m.kind!=="value")if(u.kind!=="color"&&u.kind!=="formatted"&&u.kind!=="resolvedImage"||m.kind!=="value"&&m.kind!=="string"){if(this.checkSubtype(u,m))return null}else r=o(r,u,i.typeAnnotation||"coerce");else r=o(r,u,i.typeAnnotation||"assert")}if(!(r instanceof an)&&r.type.kind!=="resolvedImage"&&r_(r)){const u=new qu(this._scope,this.options);try{r=new an(r.type,r.evaluate(u))}catch(m){return this.error(m.message),null}}return r}return nn.parse(["to-array",e],this)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,i,o){const l=typeof e=="number"?this.path.concat(e):this.path,r=o?this.scope.concat(o):this.scope;return new l_(this.registry,l,i||null,r,this.errors,this._scope,this.options)}error(e,...i){const o=`${this.key}${i.map(l=>`[${l}]`).join("")}`;this.errors.push(new qo(o,e))}checkSubtype(e,i){const o=ts(e,i);return o&&this.error(o),o}}var tc=l_;function r_(t){if(t instanceof qa)return r_(t.boundExpression);if(t instanceof ri&&t.name==="error"||t instanceof xl||t instanceof Ir||t instanceof wr||t instanceof Fs)return!1;const e=t instanceof nn||t instanceof on;let i=!0;return t.eachChild(o=>{i=e?i&&r_(o):i&&o instanceof an}),!!i&&Bs(t)&&Fa(t,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function rs(t,e){const i=t.length-1;let o,l,r=0,u=i,m=0;for(;r<=u;)if(m=Math.floor((r+u)/2),o=t[m],l=t[m+1],o<=e){if(m===i||e<l)return m;r=m+1}else{if(!(o>e))throw new ga("Input is not a number.");u=m-1}return 0}class Pr{constructor(e,i,o){this.type=e,this.input=i,this.labels=[],this.outputs=[];for(const[l,r]of o)this.labels.push(l),this.outputs.push(r)}static parse(e,i){if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");const o=i.parse(e[1],1,_t);if(!o)return null;const l=[];let r=null;i.expectedType&&i.expectedType.kind!=="value"&&(r=i.expectedType);for(let u=1;u<e.length;u+=2){const m=u===1?-1/0:e[u],p=e[u+1],h=u,y=u+1;if(typeof m!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',h);if(l.length&&l[l.length-1][0]>=m)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',h);const x=i.parse(p,y,r);if(!x)return null;r=r||x.type,l.push([m,x])}return new Pr(r,o,l)}evaluate(e){const i=this.labels,o=this.outputs;if(i.length===1)return o[0].evaluate(e);const l=this.input.evaluate(e);if(l<=i[0])return o[0].evaluate(e);const r=i.length;return l>=i[r-1]?o[r-1].evaluate(e):o[rs(i,l)].evaluate(e)}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let i=0;i<this.labels.length;i++)i>0&&e.push(this.labels[i]),e.push(this.outputs[i].serialize());return e}}var wl=Pr;const ic=.95047,Wn=1.08883,ac=4/29,Us=6/29,d_=3*Us*Us,oc=Us*Us*Us,bf=Math.PI/180,Fo=180/Math.PI;function Lr(t){return t>oc?Math.pow(t,1/3):t/d_+ac}function Nr(t){return t>Us?t*t*t:d_*(t-ac)}function Wr(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Mr(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function __(t){const e=Mr(t.r),i=Mr(t.g),o=Mr(t.b),l=Lr((.4124564*e+.3575761*i+.1804375*o)/ic),r=Lr((.2126729*e+.7151522*i+.072175*o)/1);return{l:116*r-16,a:500*(l-r),b:200*(r-Lr((.0193339*e+.119192*i+.9503041*o)/Wn)),alpha:t.a}}function u_(t){let e=(t.l+16)/116,i=isNaN(t.a)?e:e+t.a/500,o=isNaN(t.b)?e:e-t.b/200;return e=1*Nr(e),i=ic*Nr(i),o=Wn*Nr(o),new ca(Wr(3.2404542*i-1.5371385*e-.4985314*o),Wr(-.969266*i+1.8760108*e+.041556*o),Wr(.0556434*i-.2040259*e+1.0572252*o),t.alpha)}function nc(t,e,i){const o=e-t;return t+i*(o>180||o<-180?o-360*Math.round(o/360):o)}const ks={forward:__,reverse:u_,interpolate:function(t,e,i){return{l:si(t.l,e.l,i),a:si(t.a,e.a,i),b:si(t.b,e.b,i),alpha:si(t.alpha,e.alpha,i)}}},zs={forward:function(t){const{l:e,a:i,b:o}=__(t),l=Math.atan2(o,i)*Fo;return{h:l<0?l+360:l,c:Math.sqrt(i*i+o*o),l:e,alpha:t.a}},reverse:function(t){const e=t.h*bf,i=t.c;return u_({l:t.l,a:Math.cos(e)*i,b:Math.sin(e)*i,alpha:t.alpha})},interpolate:function(t,e,i){return{h:nc(t.h,e.h,i),c:si(t.c,e.c,i),l:si(t.l,e.l,i),alpha:si(t.alpha,e.alpha,i)}}};var c_=Object.freeze({__proto__:null,hcl:zs,lab:ks});class Pl{constructor(e,i,o,l,r){this.type=e,this.operator=i,this.interpolation=o,this.input=l,this.labels=[],this.outputs=[];for(const[u,m]of r)this.labels.push(u),this.outputs.push(m)}static interpolationFactor(e,i,o,l){let r=0;if(e.name==="exponential")r=Hs(i,e.base,o,l);else if(e.name==="linear")r=Hs(i,1,o,l);else if(e.name==="cubic-bezier"){const u=e.controlPoints;r=new ai(u[0],u[1],u[2],u[3]).solve(Hs(i,1,o,l))}return r}static parse(e,i){let[o,l,r,...u]=e;if(!Array.isArray(l)||l.length===0)return i.error("Expected an interpolation type expression.",1);if(l[0]==="linear")l={name:"linear"};else if(l[0]==="exponential"){const h=l[1];if(typeof h!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);l={name:"exponential",base:h}}else{if(l[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(l[0])}`,1,0);{const h=l.slice(1);if(h.length!==4||h.some(y=>typeof y!="number"||y<0||y>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);l={name:"cubic-bezier",controlPoints:h}}}if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(r=i.parse(r,2,_t),!r)return null;const m=[];let p=null;o==="interpolate-hcl"||o==="interpolate-lab"?p=vo:i.expectedType&&i.expectedType.kind!=="value"&&(p=i.expectedType);for(let h=0;h<u.length;h+=2){const y=u[h],x=u[h+1],E=h+3,S=h+4;if(typeof y!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',E);if(m.length&&m[m.length-1][0]>=y)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',E);const C=i.parse(x,S,p);if(!C)return null;p=p||C.type,m.push([y,C])}return p.kind==="number"||p.kind==="color"||p.kind==="array"&&p.itemType.kind==="number"&&typeof p.N=="number"?new Pl(p,o,l,r,m):i.error(`Type ${la(p)} is not interpolatable.`)}evaluate(e){const i=this.labels,o=this.outputs;if(i.length===1)return o[0].evaluate(e);const l=this.input.evaluate(e);if(l<=i[0])return o[0].evaluate(e);const r=i.length;if(l>=i[r-1])return o[r-1].evaluate(e);const u=rs(i,l),m=Pl.interpolationFactor(this.interpolation,l,i[u],i[u+1]),p=o[u].evaluate(e),h=o[u+1].evaluate(e);return this.operator==="interpolate"?xr[this.type.kind.toLowerCase()](p,h,m):this.operator==="interpolate-hcl"?zs.reverse(zs.interpolate(zs.forward(p),zs.forward(h),m)):ks.reverse(ks.interpolate(ks.forward(p),ks.forward(h),m))}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const i=[this.operator,e,this.input.serialize()];for(let o=0;o<this.labels.length;o++)i.push(this.labels[o],this.outputs[o].serialize());return i}}function Hs(t,e,i,o){const l=o-i,r=t-i;return l===0?0:e===1?r/l:(Math.pow(e,r)-1)/(Math.pow(e,l)-1)}var mo=Pl;class Ys{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expectected at least one argument.");let o=null;const l=i.expectedType;l&&l.kind!=="value"&&(o=l);const r=[];for(const m of e.slice(1)){const p=i.parse(m,1+r.length,o,void 0,{typeAnnotation:"omit"});if(!p)return null;o=o||p.type,r.push(p)}const u=l&&r.some(m=>ts(l,m.type));return new Ys(u?ui:o,r)}evaluate(e){let i,o=null,l=0;for(const r of this.args){if(l++,o=r.evaluate(e),o&&o instanceof Pt&&!o.available&&(i||(i=o),o=null,l===this.args.length))return i;if(o!==null)break}return o}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(i=>{e.push(i.serialize())}),e}}var m_=Ys;class Dr{constructor(e,i){this.type=i.type,this.bindings=[].concat(e),this.result=i}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const i of this.bindings)e(i[1]);e(this.result)}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const o=[];for(let r=1;r<e.length-1;r+=2){const u=e[r];if(typeof u!="string")return i.error(`Expected string, but found ${typeof u} instead.`,r);if(/[^a-zA-Z0-9_]/.test(u))return i.error("Variable names must contain only alphanumeric characters or '_'.",r);const m=i.parse(e[r+1],r+1);if(!m)return null;o.push([u,m])}const l=i.parse(e[e.length-1],e.length-1,i.expectedType,o);return l?new Dr(o,l):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[i,o]of this.bindings)e.push(i,o.serialize());return e.push(this.result.serialize()),e}}var f_=Dr;class Mn{constructor(e,i,o){this.type=e,this.index=i,this.input=o}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const o=i.parse(e[1],1,_t),l=i.parse(e[2],2,io(i.expectedType||ui));return o&&l?new Mn(l.type.itemType,o,l):null}evaluate(e){const i=this.index.evaluate(e),o=this.input.evaluate(e);if(i<0)throw new ga(`Array index out of bounds: ${i} < 0.`);if(i>=o.length)throw new ga(`Array index out of bounds: ${i} > ${o.length-1}.`);if(i!==Math.floor(i))throw new ga(`Array index must be an integer, but found ${i} instead.`);return o[i]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var ci=Mn;class p_{constructor(e,i){this.type=vi,this.needle=e,this.haystack=i}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const o=i.parse(e[1],1,ui),l=i.parse(e[2],2,ui);return o&&l?Bt(o.type,[vi,xi,_t,Rs,ui])?new p_(o,l):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${la(o.type)} instead`):null}evaluate(e){const i=this.needle.evaluate(e),o=this.haystack.evaluate(e);if(o==null)return!1;if(!On(i,["boolean","string","number","null"]))throw new ga(`Expected first argument to be of type boolean, string, number or null, but found ${la(ha(i))} instead.`);if(!On(o,["string","array"]))throw new ga(`Expected second argument to be of type array or string, but found ${la(ha(o))} instead.`);return o.indexOf(i)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Tf=p_;class Fr{constructor(e,i,o){this.type=_t,this.needle=e,this.haystack=i,this.fromIndex=o}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const o=i.parse(e[1],1,ui),l=i.parse(e[2],2,ui);if(!o||!l)return null;if(!Bt(o.type,[vi,xi,_t,Rs,ui]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${la(o.type)} instead`);if(e.length===4){const r=i.parse(e[3],3,_t);return r?new Fr(o,l,r):null}return new Fr(o,l)}evaluate(e){const i=this.needle.evaluate(e),o=this.haystack.evaluate(e);if(!On(i,["boolean","string","number","null"]))throw new ga(`Expected first argument to be of type boolean, string, number or null, but found ${la(ha(i))} instead.`);if(!On(o,["string","array"]))throw new ga(`Expected second argument to be of type array or string, but found ${la(ha(o))} instead.`);if(this.fromIndex){const l=this.fromIndex.evaluate(e);return o.indexOf(i,l)}return o.indexOf(i)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var sc=Fr;class h_{constructor(e,i,o,l,r,u){this.inputType=e,this.type=i,this.input=o,this.cases=l,this.outputs=r,this.otherwise=u}static parse(e,i){if(e.length<5)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return i.error("Expected an even number of arguments.");let o,l;i.expectedType&&i.expectedType.kind!=="value"&&(l=i.expectedType);const r={},u=[];for(let h=2;h<e.length-1;h+=2){let y=e[h];const x=e[h+1];Array.isArray(y)||(y=[y]);const E=i.concat(h);if(y.length===0)return E.error("Expected at least one branch label.");for(const C of y){if(typeof C!="number"&&typeof C!="string")return E.error("Branch labels must be numbers or strings.");if(typeof C=="number"&&Math.abs(C)>Number.MAX_SAFE_INTEGER)return E.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof C=="number"&&Math.floor(C)!==C)return E.error("Numeric branch labels must be integer values.");if(o){if(E.checkSubtype(o,ha(C)))return null}else o=ha(C);if(r[String(C)]!==void 0)return E.error("Branch labels must be unique.");r[String(C)]=u.length}const S=i.parse(x,h,l);if(!S)return null;l=l||S.type,u.push(S)}const m=i.parse(e[1],1,ui);if(!m)return null;const p=i.parse(e[e.length-1],e.length-1,l);return p?m.type.kind!=="value"&&i.concat(1).checkSubtype(o,m.type)?null:new h_(o,l,m,r,u,p):null}evaluate(e){const i=this.input.evaluate(e);return(ha(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],i=Object.keys(this.cases).sort(),o=[],l={};for(const u of i){const m=l[this.cases[u]];m===void 0?(l[this.cases[u]]=o.length,o.push([this.cases[u],[u]])):o[m][1].push(u)}const r=u=>this.inputType.kind==="number"?Number(u):u;for(const[u,m]of o)e.push(m.length===1?r(m[0]):m.map(r)),e.push(this.outputs[u].serialize());return e.push(this.otherwise.serialize()),e}}var lc=h_;class Br{constructor(e,i,o){this.type=e,this.branches=i,this.otherwise=o}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return i.error("Expected an odd number of arguments.");let o;i.expectedType&&i.expectedType.kind!=="value"&&(o=i.expectedType);const l=[];for(let u=1;u<e.length-1;u+=2){const m=i.parse(e[u],u,vi);if(!m)return null;const p=i.parse(e[u+1],u+1,o);if(!p)return null;l.push([m,p]),o=o||p.type}const r=i.parse(e[e.length-1],e.length-1,o);return r?new Br(o,l,r):null}evaluate(e){for(const[i,o]of this.branches)if(i.evaluate(e))return o.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[i,o]of this.branches)e(i),e(o);e(this.otherwise)}outputDefined(){return this.branches.every(([e,i])=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(i=>{e.push(i.serialize())}),e}}var rc=Br;class Ll{constructor(e,i,o,l){this.type=e,this.input=i,this.beginIndex=o,this.endIndex=l}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const o=i.parse(e[1],1,ui),l=i.parse(e[2],2,_t);if(!o||!l)return null;if(!Bt(o.type,[io(ui),xi,ui]))return i.error(`Expected first argument to be of type array or string, but found ${la(o.type)} instead`);if(e.length===4){const r=i.parse(e[3],3,_t);return r?new Ll(o.type,o,l,r):null}return new Ll(o.type,o,l)}evaluate(e){const i=this.input.evaluate(e),o=this.beginIndex.evaluate(e);if(!On(i,["string","array"]))throw new ga(`Expected first argument to be of type array or string, but found ${la(ha(i))} instead.`);if(this.endIndex){const l=this.endIndex.evaluate(e);return i.slice(o,l)}return i.slice(o)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Gs=Ll;function g_(t,e){return t==="=="||t==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function y_(t,e,i,o){return o.compare(e,i)===0}function Vs(t,e,i){const o=t!=="=="&&t!=="!=";return class Rb{constructor(r,u,m){this.type=vi,this.lhs=r,this.rhs=u,this.collator=m,this.hasUntypedArgument=r.type.kind==="value"||u.type.kind==="value"}static parse(r,u){if(r.length!==3&&r.length!==4)return u.error("Expected two or three arguments.");const m=r[0];let p=u.parse(r[1],1,ui);if(!p)return null;if(!g_(m,p.type))return u.concat(1).error(`"${m}" comparisons are not supported for type '${la(p.type)}'.`);let h=u.parse(r[2],2,ui);if(!h)return null;if(!g_(m,h.type))return u.concat(2).error(`"${m}" comparisons are not supported for type '${la(h.type)}'.`);if(p.type.kind!==h.type.kind&&p.type.kind!=="value"&&h.type.kind!=="value")return u.error(`Cannot compare types '${la(p.type)}' and '${la(h.type)}'.`);o&&(p.type.kind==="value"&&h.type.kind!=="value"?p=new on(h.type,[p]):p.type.kind!=="value"&&h.type.kind==="value"&&(h=new on(p.type,[h])));let y=null;if(r.length===4){if(p.type.kind!=="string"&&h.type.kind!=="string"&&p.type.kind!=="value"&&h.type.kind!=="value")return u.error("Cannot use collator to compare non-string types.");if(y=u.parse(r[3],3,vr),!y)return null}return new Rb(p,h,y)}evaluate(r){const u=this.lhs.evaluate(r),m=this.rhs.evaluate(r);if(o&&this.hasUntypedArgument){const p=ha(u),h=ha(m);if(p.kind!==h.kind||p.kind!=="string"&&p.kind!=="number")throw new ga(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${p.kind}, ${h.kind}) instead.`)}if(this.collator&&!o&&this.hasUntypedArgument){const p=ha(u),h=ha(m);if(p.kind!=="string"||h.kind!=="string")return e(r,u,m)}return this.collator?i(r,u,m,this.collator.evaluate(r)):e(r,u,m)}eachChild(r){r(this.lhs),r(this.rhs),this.collator&&r(this.collator)}outputDefined(){return!0}serialize(){const r=[t];return this.eachChild(u=>{r.push(u.serialize())}),r}}}const b_=Vs("==",function(t,e,i){return e===i},y_),T_=Vs("!=",function(t,e,i){return e!==i},function(t,e,i,o){return!y_(0,e,i,o)}),xf=Vs("<",function(t,e,i){return e<i},function(t,e,i,o){return o.compare(e,i)<0}),vf=Vs(">",function(t,e,i){return e>i},function(t,e,i,o){return o.compare(e,i)>0}),dc=Vs("<=",function(t,e,i){return e<=i},function(t,e,i,o){return o.compare(e,i)<=0}),Ef=Vs(">=",function(t,e,i){return e>=i},function(t,e,i,o){return o.compare(e,i)>=0});class x_{constructor(e,i,o,l,r,u){this.type=xi,this.number=e,this.locale=i,this.currency=o,this.unit=l,this.minFractionDigits=r,this.maxFractionDigits=u}static parse(e,i){if(e.length!==3)return i.error("Expected two arguments.");const o=i.parse(e[1],1,_t);if(!o)return null;const l=e[2];if(typeof l!="object"||Array.isArray(l))return i.error("NumberFormat options argument must be an object.");let r=null;if(l.locale&&(r=i.parse(l.locale,1,xi),!r))return null;let u=null;if(l.currency&&(u=i.parse(l.currency,1,xi),!u))return null;let m=null;if(l.unit&&(m=i.parse(l.unit,1,xi),!m))return null;let p=null;if(l["min-fraction-digits"]&&(p=i.parse(l["min-fraction-digits"],1,_t),!p))return null;let h=null;return l["max-fraction-digits"]&&(h=i.parse(l["max-fraction-digits"],1,_t),!h)?null:new x_(o,r,u,m,p,h)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class v_{constructor(e){this.type=_t,this.input=e}static parse(e,i){if(e.length!==2)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const o=i.parse(e[1],1);return o?o.type.kind!=="array"&&o.type.kind!=="string"&&o.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${la(o.type)} instead.`):new v_(o):null}evaluate(e){const i=this.input.evaluate(e);if(typeof i=="string"||Array.isArray(i))return i.length;throw new ga(`Expected value to be of type string or array, but found ${la(ha(i))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(i=>{e.push(i.serialize())}),e}}function _c(t){return function(){t=1831565813+(t|=0)|0;let e=Math.imul(t^t>>>15,1|t);return e=e+Math.imul(e^e>>>7,61|e)^e,((e^e>>>14)>>>0)/4294967296}}const E_={"==":b_,"!=":T_,">":vf,"<":xf,">=":Ef,"<=":dc,array:on,at:ci,boolean:on,case:rc,coalesce:m_,collator:xl,format:Ls,image:as,in:Tf,"index-of":sc,interpolate:mo,"interpolate-hcl":mo,"interpolate-lab":mo,length:v_,let:f_,literal:an,match:lc,number:on,"number-format":x_,object:on,slice:Gs,step:wl,string:on,"to-boolean":nn,"to-color":nn,"to-number":nn,"to-string":nn,var:qa,within:Ir,distance:wr,config:Fs};function A_(t,[e,i,o,l]){e=e.evaluate(t),i=i.evaluate(t),o=o.evaluate(t);const r=l?l.evaluate(t):1,u=Ku(e,i,o,r);if(u)throw new ga(u);return new ca(e/255*r,i/255*r,o/255*r,r)}function uc(t,[e,i,o,l]){e=e.evaluate(t),i=i.evaluate(t),o=o.evaluate(t);const r=l?l.evaluate(t):1,u=function(h,y,x,E){return typeof h=="number"&&h>=0&&h<=360?typeof y=="number"&&y>=0&&y<=100&&typeof x=="number"&&x>=0&&x<=100?E===void 0||typeof E=="number"&&E>=0&&E<=1?null:`Invalid hsla value [${[h,y,x,E].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof E=="number"?[h,y,x,E]:[h,y,x]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof E=="number"?[h,y,x,E]:[h,y,x]).join(", ")}]: 'h' must be between 0 and 360.`}(e,i,o,r);if(u)throw new ga(u);const m=`hsla(${e}, ${i}%, ${o}%, ${r})`,p=ca.parse(m);if(!p)throw new ga(`Failed to parse HSLA color: ${m}`);return p}function I_(t,e){return t in e}function O_(t,e){const i=e[t];return i===void 0?null:i}function ds(t){return{type:t}}ri.register(E_,{error:[{kind:"error"},[xi],(t,[e])=>{throw new ga(e.evaluate(t))}],typeof:[xi,[ui],(t,[e])=>la(ha(e.evaluate(t)))],"to-rgba":[io(_t,4),[vo],(t,[e])=>e.evaluate(t).toArray()],rgb:[vo,[_t,_t,_t],A_],rgba:[vo,[_t,_t,_t,_t],A_],hsl:[vo,[_t,_t,_t],uc],hsla:[vo,[_t,_t,_t,_t],uc],has:{type:vi,overloads:[[[xi],(t,[e])=>I_(e.evaluate(t),t.properties())],[[xi,Cs],(t,[e,i])=>I_(e.evaluate(t),i.evaluate(t))]]},get:{type:ui,overloads:[[[xi],(t,[e])=>O_(e.evaluate(t),t.properties())],[[xi,Cs],(t,[e,i])=>O_(e.evaluate(t),i.evaluate(t))]]},"feature-state":[ui,[xi],(t,[e])=>O_(e.evaluate(t),t.featureState||{})],properties:[Cs,[],t=>t.properties()],"geometry-type":[xi,[],t=>t.geometryType()],id:[ui,[],t=>t.id()],zoom:[_t,[],t=>t.globals.zoom],pitch:[_t,[],t=>t.globals.pitch||0],"distance-from-center":[_t,[],t=>t.distanceFromCenter()],"measure-light":[_t,[xi],(t,[e])=>t.measureLight(e.evaluate(t))],"heatmap-density":[_t,[],t=>t.globals.heatmapDensity||0],"line-progress":[_t,[],t=>t.globals.lineProgress||0],"raster-value":[_t,[],t=>t.globals.rasterValue||0],"raster-particle-speed":[_t,[],t=>t.globals.rasterParticleSpeed||0],"sky-radial-progress":[_t,[],t=>t.globals.skyRadialProgress||0],accumulated:[ui,[],t=>t.globals.accumulated===void 0?null:t.globals.accumulated],"+":[_t,ds(_t),(t,e)=>{let i=0;for(const o of e)i+=o.evaluate(t);return i}],"*":[_t,ds(_t),(t,e)=>{let i=1;for(const o of e)i*=o.evaluate(t);return i}],"-":{type:_t,overloads:[[[_t,_t],(t,[e,i])=>e.evaluate(t)-i.evaluate(t)],[[_t],(t,[e])=>-e.evaluate(t)]]},"/":[_t,[_t,_t],(t,[e,i])=>e.evaluate(t)/i.evaluate(t)],"%":[_t,[_t,_t],(t,[e,i])=>e.evaluate(t)%i.evaluate(t)],ln2:[_t,[],()=>Math.LN2],pi:[_t,[],()=>Math.PI],e:[_t,[],()=>Math.E],"^":[_t,[_t,_t],(t,[e,i])=>Math.pow(e.evaluate(t),i.evaluate(t))],sqrt:[_t,[_t],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[_t,[_t],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[_t,[_t],(t,[e])=>Math.log(e.evaluate(t))],log2:[_t,[_t],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[_t,[_t],(t,[e])=>Math.sin(e.evaluate(t))],cos:[_t,[_t],(t,[e])=>Math.cos(e.evaluate(t))],tan:[_t,[_t],(t,[e])=>Math.tan(e.evaluate(t))],asin:[_t,[_t],(t,[e])=>Math.asin(e.evaluate(t))],acos:[_t,[_t],(t,[e])=>Math.acos(e.evaluate(t))],atan:[_t,[_t],(t,[e])=>Math.atan(e.evaluate(t))],min:[_t,ds(_t),(t,e)=>Math.min(...e.map(i=>i.evaluate(t)))],max:[_t,ds(_t),(t,e)=>Math.max(...e.map(i=>i.evaluate(t)))],abs:[_t,[_t],(t,[e])=>Math.abs(e.evaluate(t))],round:[_t,[_t],(t,[e])=>{const i=e.evaluate(t);return i<0?-Math.round(-i):Math.round(i)}],floor:[_t,[_t],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[_t,[_t],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[vi,[xi,ui],(t,[e,i])=>t.properties()[e.value]===i.value],"filter-id-==":[vi,[ui],(t,[e])=>t.id()===e.value],"filter-type-==":[vi,[xi],(t,[e])=>t.geometryType()===e.value],"filter-<":[vi,[xi,ui],(t,[e,i])=>{const o=t.properties()[e.value],l=i.value;return typeof o==typeof l&&o<l}],"filter-id-<":[vi,[ui],(t,[e])=>{const i=t.id(),o=e.value;return typeof i==typeof o&&i<o}],"filter->":[vi,[xi,ui],(t,[e,i])=>{const o=t.properties()[e.value],l=i.value;return typeof o==typeof l&&o>l}],"filter-id->":[vi,[ui],(t,[e])=>{const i=t.id(),o=e.value;return typeof i==typeof o&&i>o}],"filter-<=":[vi,[xi,ui],(t,[e,i])=>{const o=t.properties()[e.value],l=i.value;return typeof o==typeof l&&o<=l}],"filter-id-<=":[vi,[ui],(t,[e])=>{const i=t.id(),o=e.value;return typeof i==typeof o&&i<=o}],"filter->=":[vi,[xi,ui],(t,[e,i])=>{const o=t.properties()[e.value],l=i.value;return typeof o==typeof l&&o>=l}],"filter-id->=":[vi,[ui],(t,[e])=>{const i=t.id(),o=e.value;return typeof i==typeof o&&i>=o}],"filter-has":[vi,[ui],(t,[e])=>e.value in t.properties()],"filter-has-id":[vi,[],t=>t.id()!==null&&t.id()!==void 0],"filter-type-in":[vi,[io(xi)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[vi,[io(ui)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[vi,[xi,io(ui)],(t,[e,i])=>i.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[vi,[xi,io(ui)],(t,[e,i])=>function(o,l,r,u){for(;r<=u;){const m=r+u>>1;if(l[m]===o)return!0;l[m]>o?u=m-1:r=m+1}return!1}(t.properties()[e.value],i.value,0,i.value.length-1)],all:{type:vi,overloads:[[[vi,vi],(t,[e,i])=>e.evaluate(t)&&i.evaluate(t)],[ds(vi),(t,e)=>{for(const i of e)if(!i.evaluate(t))return!1;return!0}]]},any:{type:vi,overloads:[[[vi,vi],(t,[e,i])=>e.evaluate(t)||i.evaluate(t)],[ds(vi),(t,e)=>{for(const i of e)if(i.evaluate(t))return!0;return!1}]]},"!":[vi,[vi],(t,[e])=>!e.evaluate(t)],"is-supported-script":[vi,[xi],(t,[e])=>{const i=t.globals&&t.globals.isSupportedScript;return!i||i(e.evaluate(t))}],upcase:[xi,[xi],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[xi,[xi],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[xi,ds(ui),(t,e)=>e.map(i=>Eo(i.evaluate(t))).join("")],"resolved-locale":[xi,[vr],(t,[e])=>e.evaluate(t).resolvedLocale()],random:[_t,[_t,_t,ui],(t,e)=>{const[i,o,l]=e.map(u=>u.evaluate(t));if(i>o||i===o)return i;let r;if(typeof l=="string")r=function(u){let m=0;if(u.length===0)return m;for(let p=0;p<u.length;p++)m=(m<<5)-m+u.charCodeAt(p),m|=0;return m}(l);else{if(typeof l!="number")throw new ga(`Invalid seed input: ${l}`);r=l}return i+_c(r)()*(o-i)}]});var js=E_;function S_(t){return{result:"success",value:t}}function _s(t){return{result:"error",value:t}}function cc(t,e){return!!t&&!!t.parameters&&t.parameters.indexOf(e)>-1}function Ur(t){return t["property-type"]==="data-driven"}function R_(t){return cc(t.expression,"measure-light")}function mc(t){return cc(t.expression,"zoom")}function C_(t){return!!t.expression&&t.expression.interpolated}function kr(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function fc(t){return t}function w_(t,e){const i=e.type==="color",o=t.stops&&typeof t.stops[0][0]=="object",l=o||!(o||t.property!==void 0),r=t.type||(C_(e)?"exponential":"interval");if(i&&((t=Bd({},t)).stops&&(t.stops=t.stops.map(h=>[h[0],ca.parse(h[1])])),t.default=ca.parse(t.default?t.default:e.default)),t.colorSpace&&t.colorSpace!=="rgb"&&!c_[t.colorSpace])throw new Error(`Unknown color space: ${t.colorSpace}`);let u,m,p;if(r==="exponential")u=pc;else if(r==="interval")u=If;else if(r==="categorical"){u=Af,m=Object.create(null);for(const h of t.stops)m[h[0]]=h[1];p=typeof t.stops[0][0]}else{if(r!=="identity")throw new Error(`Unknown function type "${r}"`);u=hc}if(o){const h={},y=[];for(let S=0;S<t.stops.length;S++){const C=t.stops[S],w=C[0].zoom;h[w]===void 0&&(h[w]={zoom:w,type:t.type,property:t.property,default:t.default,stops:[]},y.push(w)),h[w].stops.push([C[0].value,C[1]])}const x=[];for(const S of y)x.push([h[S].zoom,w_(h[S],e)]);const E={name:"linear"};return{kind:"composite",interpolationType:E,interpolationFactor:mo.interpolationFactor.bind(void 0,E),zoomStops:x.map(S=>S[0]),evaluate:({zoom:S},C)=>pc({stops:x,base:t.base},e,S).evaluate(S,C)}}if(l){const h=r==="exponential"?{name:"exponential",base:t.base!==void 0?t.base:1}:null;return{kind:"camera",interpolationType:h,interpolationFactor:mo.interpolationFactor.bind(void 0,h),zoomStops:t.stops.map(y=>y[0]),evaluate:({zoom:y})=>u(t,e,y,m,p)}}return{kind:"source",evaluate(h,y){const x=y&&y.properties?y.properties[t.property]:void 0;return x===void 0?Nl(t.default,e.default):u(t,e,x,m,p)}}}function Nl(t,e,i){return t!==void 0?t:e!==void 0?e:i!==void 0?i:void 0}function Af(t,e,i,o,l){return Nl(typeof i===l?o[i]:void 0,t.default,e.default)}function If(t,e,i){if(Ns(i)!=="number")return Nl(t.default,e.default);const o=t.stops.length;if(o===1||i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[o-1][0])return t.stops[o-1][1];const l=rs(t.stops.map(r=>r[0]),i);return t.stops[l][1]}function pc(t,e,i){const o=t.base!==void 0?t.base:1;if(Ns(i)!=="number")return Nl(t.default,e.default);const l=t.stops.length;if(l===1||i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[l-1][0])return t.stops[l-1][1];const r=rs(t.stops.map(y=>y[0]),i),u=function(y,x,E,S){const C=S-E,w=y-E;return C===0?0:x===1?w/C:(Math.pow(x,w)-1)/(Math.pow(x,C)-1)}(i,o,t.stops[r][0],t.stops[r+1][0]),m=t.stops[r][1],p=t.stops[r+1][1];let h=xr[e.type]||fc;if(t.colorSpace&&t.colorSpace!=="rgb"){const y=c_[t.colorSpace];h=(x,E)=>y.reverse(y.interpolate(y.forward(x),y.forward(E),u))}return typeof m.evaluate=="function"?{evaluate(...y){const x=m.evaluate.apply(void 0,y),E=p.evaluate.apply(void 0,y);if(x!==void 0&&E!==void 0)return h(x,E,u)}}:h(m,p,u)}function hc(t,e,i){return e.type==="color"?i=ca.parse(i):e.type==="formatted"?i=Da.fromString(i.toString()):e.type==="resolvedImage"?i=Pt.fromString(i.toString()):Ns(i)===e.type||e.type==="enum"&&e.values[i]||(i=void 0),Nl(i,t.default,e.default)}class zr{constructor(e,i,o,l){this.expression=e,this._warningHistory={},this._evaluator=new qu(o,l),this._defaultValue=i?function(r){return r.type==="color"&&(kr(r.default)||Array.isArray(r.default))?new ca(0,0,0,0):r.type==="color"?ca.parse(r.default)||null:r.default===void 0?null:r.default}(i):null,this._enumValues=i&&i.type==="enum"?i.values:null}evaluateWithoutErrorHandling(e,i,o,l,r,u,m,p){return this._evaluator.globals=e,this._evaluator.feature=i,this._evaluator.featureState=o,this._evaluator.canonical=l||null,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=u,this._evaluator.featureTileCoord=m||null,this._evaluator.featureDistanceData=p||null,this.expression.evaluate(this._evaluator)}evaluate(e,i,o,l,r,u,m,p){this._evaluator.globals=e,this._evaluator.feature=i||null,this._evaluator.featureState=o||null,this._evaluator.canonical=l||null,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=u||null,this._evaluator.featureTileCoord=m||null,this._evaluator.featureDistanceData=p||null;try{const h=this.expression.evaluate(this._evaluator);if(h==null||typeof h=="number"&&h!=h)return this._defaultValue;if(this._enumValues&&!(h in this._enumValues))throw new ga(`Expected value to be one of ${Object.keys(this._enumValues).map(y=>JSON.stringify(y)).join(", ")}, but found ${JSON.stringify(h)} instead.`);return h}catch(h){return this._warningHistory[h.message]||(this._warningHistory[h.message]=!0,typeof console<"u"&&console.warn(h.message)),this._defaultValue}}}function Wl(t){return Array.isArray(t)&&t.length>0&&typeof t[0]=="string"&&t[0]in js}function Hr(t,e,i,o){const l=new tc(js,[],e?function(u){const m={color:vo,string:xi,number:_t,enum:xi,boolean:vi,formatted:ws,resolvedImage:bl};return u.type==="array"?io(m[u.value]||ui,u.length):m[u.type]}(e):void 0,void 0,void 0,i,o),r=l.parse(t,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return r?S_(new zr(r,e,i,o)):_s(l.errors)}class P_{constructor(e,i,o){this.kind=e,this._styleExpression=i,this.isLightConstant=o,this.isStateDependent=e!=="constant"&&!Rl(i.expression),this.isConfigDependent=!Cl(i.expression)}evaluateWithoutErrorHandling(e,i,o,l,r,u){return this._styleExpression.evaluateWithoutErrorHandling(e,i,o,l,r,u)}evaluate(e,i,o,l,r,u){return this._styleExpression.evaluate(e,i,o,l,r,u)}}class Ml{constructor(e,i,o,l,r){this.kind=e,this.zoomStops=o,this._styleExpression=i,this.isStateDependent=e!=="camera"&&!Rl(i.expression),this.isLightConstant=r,this.isConfigDependent=!Cl(i.expression),this.interpolationType=l}evaluateWithoutErrorHandling(e,i,o,l,r,u){return this._styleExpression.evaluateWithoutErrorHandling(e,i,o,l,r,u)}evaluate(e,i,o,l,r,u){return this._styleExpression.evaluate(e,i,o,l,r,u)}interpolationFactor(e,i,o){return this.interpolationType?mo.interpolationFactor(this.interpolationType,e,i,o):0}}function Yr(t,e,i,o){if((t=Hr(t,e,i,o)).result==="error")return t;const l=t.value.expression,r=Bs(l);if(!r&&!Ur(e))return _s([new qo("","data expressions not supported")]);const u=Fa(l,["zoom","pitch","distance-from-center"]);if(!u&&!mc(e))return _s([new qo("","zoom expressions not supported")]);const m=Fa(l,["measure-light"]);if(!m&&!R_(e))return _s([new qo("","measure-light expression not supported")]);const p=e.expression&&e.expression.relaxZoomRestriction,h=Fl(l);return h||u||p?h instanceof qo?_s([h]):h instanceof mo&&!C_(e)?_s([new qo("",'"interpolate" expressions cannot be used with this property')]):S_(h?new Ml(r?"camera":"composite",t.value,h.labels,h instanceof mo?h.interpolation:void 0,m):new P_(r?"constant":"source",t.value,m)):_s([new qo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Dl{constructor(e,i){this._parameters=e,this._specification=i,Bd(this,w_(this._parameters,this._specification))}static deserialize(e){return new Dl(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Fl(t){let e=null;if(t instanceof f_)e=Fl(t.result);else if(t instanceof m_){for(const i of t.args)if(e=Fl(i),e)break}else(t instanceof wl||t instanceof mo)&&t.input instanceof ri&&t.input.name==="zoom"&&(e=t);return e instanceof qo||t.eachChild(i=>{const o=Fl(i);o instanceof qo?e=o:e&&o&&e!==o&&(e=new qo("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}var Of=Uo,Bo=3;function Uo(t,e,i){var o=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var l=new Int32Array(this.arrayBuffer);t=l[0],this.d=(e=l[1])+2*(i=l[2]);for(var r=0;r<this.d*this.d;r++){var u=l[Bo+r],m=l[Bo+r+1];o.push(u===m?null:l.subarray(u,m))}var p=l[Bo+o.length+1];this.keys=l.subarray(l[Bo+o.length],p),this.bboxes=l.subarray(p),this.insert=this._insertReadonly}else{this.d=e+2*i;for(var h=0;h<this.d*this.d;h++)o.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=i,this.scale=e/t,this.uid=0;var y=i/e*t;this.min=-y,this.max=t+y}Uo.prototype.insert=function(t,e,i,o,l){this._forEachCell(e,i,o,l,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(o),this.bboxes.push(l)},Uo.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Uo.prototype._insertCell=function(t,e,i,o,l,r){this.cells[l].push(r)},Uo.prototype.query=function(t,e,i,o,l){var r=this.min,u=this.max;if(t<=r&&e<=r&&u<=i&&u<=o&&!l)return Array.prototype.slice.call(this.keys);var m=[];return this._forEachCell(t,e,i,o,this._queryCell,m,{},l),m},Uo.prototype._queryCell=function(t,e,i,o,l,r,u,m){var p=this.cells[l];if(p!==null)for(var h=this.keys,y=this.bboxes,x=0;x<p.length;x++){var E=p[x];if(u[E]===void 0){var S=4*E;(m?m(y[S+0],y[S+1],y[S+2],y[S+3]):t<=y[S+2]&&e<=y[S+3]&&i>=y[S+0]&&o>=y[S+1])?(u[E]=!0,r.push(h[E])):u[E]=!1}}},Uo.prototype._forEachCell=function(t,e,i,o,l,r,u,m){for(var p=this._convertToCellCoord(t),h=this._convertToCellCoord(e),y=this._convertToCellCoord(i),x=this._convertToCellCoord(o),E=p;E<=y;E++)for(var S=h;S<=x;S++){var C=this.d*S+E;if((!m||m(this._convertFromCellCoord(E),this._convertFromCellCoord(S),this._convertFromCellCoord(E+1),this._convertFromCellCoord(S+1)))&&l.call(this,t,e,i,o,C,r,u,m))return}},Uo.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},Uo.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},Uo.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=Bo+this.cells.length+1+1,i=0,o=0;o<this.cells.length;o++)i+=this.cells[o].length;var l=new Int32Array(e+i+this.keys.length+this.bboxes.length);l[0]=this.extent,l[1]=this.n,l[2]=this.padding;for(var r=e,u=0;u<t.length;u++){var m=t[u];l[Bo+u]=r,l.set(m,r),r+=m.length}return l[Bo+t.length]=r,l.set(this.keys,r),l[Bo+t.length+1]=r+=this.keys.length,l.set(this.bboxes,r),r+=this.bboxes.length,l.buffer};var ln=bt(Of);const Bl={};function mt(t,e,i={}){Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),Bl[e]={klass:t,omit:i.omit||[]}}mt(Object,"Object"),ln.serialize=function(t,e){const i=t.toArrayBuffer();return e&&e.add(i),{buffer:i}},ln.deserialize=function(t){return new ln(t.buffer)},Object.defineProperty(ln,"name",{value:"Grid"}),mt(ln,"Grid"),mt(ca,"Color"),mt(Error,"Error"),mt(Da,"Formatted"),mt(Ps,"FormattedSection"),mt(fa,"AJAXError"),mt(Pt,"ResolvedImage"),mt(Dl,"StylePropertyFunction"),mt(zr,"StyleExpression",{omit:["_evaluator"]}),mt(Ml,"ZoomDependentExpression"),mt(P_,"ZoomConstantExpression"),mt(ri,"CompoundExpression",{omit:["_evaluate"]});for(const t in js)Bl[js[t]._classRegistryKey]||mt(js[t],`Expression${t}`);function gc(t){return t&&typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||t.constructor&&t.constructor.name==="ArrayBuffer")}function Gr(t){return self.ImageBitmap&&t instanceof ImageBitmap}function Dn(t,e){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(gc(t)||Gr(t))return e&&e.add(t),t;if(ArrayBuffer.isView(t)){const i=t;return e&&e.add(i.buffer),i}if(t instanceof ImageData)return e&&e.add(t.data.buffer),t;if(Array.isArray(t)){const i=[];for(const o of t)i.push(Dn(o,e));return i}if(t instanceof Map){const i={$name:"Map"};for(const[o,l]of t.entries())i[o]=Dn(l);return i}if(typeof t=="object"){const i=t.constructor,o=i._classRegistryKey;if(!o)throw new Error(`can't serialize object of unregistered class ${o}`);const l=i.serialize?i.serialize(t,e):{};if(!i.serialize){for(const r in t)t.hasOwnProperty(r)&&(Bl[o].omit.indexOf(r)>=0||(l[r]=Dn(t[r],e)));t instanceof Error&&(l.message=t.message)}if(l.$name)throw new Error("$name property is reserved for worker serialization logic.");return o!=="Object"&&(l.$name=o),l}throw new Error("can't serialize object of type "+typeof t)}function us(t){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||gc(t)||Gr(t)||ArrayBuffer.isView(t)||t instanceof ImageData)return t;if(Array.isArray(t))return t.map(us);if(typeof t=="object"){const e=t.$name||"Object";if(e==="Map"){const l=new Map;for(const r of Object.keys(t))r!=="$name"&&l.set(r,us(t[r]));return l}const{klass:i}=Bl[e];if(!i)throw new Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(t);const o=Object.create(i.prototype);for(const l of Object.keys(t))l!=="$name"&&(o[l]=us(t[l]));return o}throw new Error("can't deserialize object of type "+typeof t)}const yt={"Latin-1 Supplement":t=>t>=128&&t<=255,Arabic:t=>t>=1536&&t<=1791,"Arabic Supplement":t=>t>=1872&&t<=1919,"Arabic Extended-A":t=>t>=2208&&t<=2303,"Hangul Jamo":t=>t>=4352&&t<=4607,"Unified Canadian Aboriginal Syllabics":t=>t>=5120&&t<=5759,Khmer:t=>t>=6016&&t<=6143,"Unified Canadian Aboriginal Syllabics Extended":t=>t>=6320&&t<=6399,"General Punctuation":t=>t>=8192&&t<=8303,"Letterlike Symbols":t=>t>=8448&&t<=8527,"Number Forms":t=>t>=8528&&t<=8591,"Miscellaneous Technical":t=>t>=8960&&t<=9215,"Control Pictures":t=>t>=9216&&t<=9279,"Optical Character Recognition":t=>t>=9280&&t<=9311,"Enclosed Alphanumerics":t=>t>=9312&&t<=9471,"Geometric Shapes":t=>t>=9632&&t<=9727,"Miscellaneous Symbols":t=>t>=9728&&t<=9983,"Miscellaneous Symbols and Arrows":t=>t>=11008&&t<=11263,"CJK Radicals Supplement":t=>t>=11904&&t<=12031,"Kangxi Radicals":t=>t>=12032&&t<=12255,"Ideographic Description Characters":t=>t>=12272&&t<=12287,"CJK Symbols and Punctuation":t=>t>=12288&&t<=12351,Hiragana:t=>t>=12352&&t<=12447,Katakana:t=>t>=12448&&t<=12543,Bopomofo:t=>t>=12544&&t<=12591,"Hangul Compatibility Jamo":t=>t>=12592&&t<=12687,Kanbun:t=>t>=12688&&t<=12703,"Bopomofo Extended":t=>t>=12704&&t<=12735,"CJK Strokes":t=>t>=12736&&t<=12783,"Katakana Phonetic Extensions":t=>t>=12784&&t<=12799,"Enclosed CJK Letters and Months":t=>t>=12800&&t<=13055,"CJK Compatibility":t=>t>=13056&&t<=13311,"CJK Unified Ideographs Extension A":t=>t>=13312&&t<=19903,"Yijing Hexagram Symbols":t=>t>=19904&&t<=19967,"CJK Unified Ideographs":t=>t>=19968&&t<=40959,"Yi Syllables":t=>t>=40960&&t<=42127,"Yi Radicals":t=>t>=42128&&t<=42191,"Hangul Jamo Extended-A":t=>t>=43360&&t<=43391,"Hangul Syllables":t=>t>=44032&&t<=55215,"Hangul Jamo Extended-B":t=>t>=55216&&t<=55295,"Private Use Area":t=>t>=57344&&t<=63743,"CJK Compatibility Ideographs":t=>t>=63744&&t<=64255,"Arabic Presentation Forms-A":t=>t>=64336&&t<=65023,"Vertical Forms":t=>t>=65040&&t<=65055,"CJK Compatibility Forms":t=>t>=65072&&t<=65103,"Small Form Variants":t=>t>=65104&&t<=65135,"Arabic Presentation Forms-B":t=>t>=65136&&t<=65279,"Halfwidth and Fullwidth Forms":t=>t>=65280&&t<=65519,"CJK Unified Ideographs Extension B":t=>t>=131072&&t<=173791};function Fn(t){for(const e of t)if(L_(e.charCodeAt(0)))return!0;return!1}function Sf(t){for(const e of t)if(!Rf(e.charCodeAt(0)))return!1;return!0}function Rf(t){return!(yt.Arabic(t)||yt["Arabic Supplement"](t)||yt["Arabic Extended-A"](t)||yt["Arabic Presentation Forms-A"](t)||yt["Arabic Presentation Forms-B"](t))}function L_(t){return!(t!==746&&t!==747&&(t<4352||!(yt["Bopomofo Extended"](t)||yt.Bopomofo(t)||yt["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||yt["CJK Compatibility Ideographs"](t)||yt["CJK Compatibility"](t)||yt["CJK Radicals Supplement"](t)||yt["CJK Strokes"](t)||!(!yt["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||t===12336)||yt["CJK Unified Ideographs Extension A"](t)||yt["CJK Unified Ideographs"](t)||yt["Enclosed CJK Letters and Months"](t)||yt["Hangul Compatibility Jamo"](t)||yt["Hangul Jamo Extended-A"](t)||yt["Hangul Jamo Extended-B"](t)||yt["Hangul Jamo"](t)||yt["Hangul Syllables"](t)||yt.Hiragana(t)||yt["Ideographic Description Characters"](t)||yt.Kanbun(t)||yt["Kangxi Radicals"](t)||yt["Katakana Phonetic Extensions"](t)||yt.Katakana(t)&&t!==12540||!(!yt["Halfwidth and Fullwidth Forms"](t)||t===65288||t===65289||t===65293||t>=65306&&t<=65310||t===65339||t===65341||t===65343||t>=65371&&t<=65503||t===65507||t>=65512&&t<=65519)||!(!yt["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||yt["Unified Canadian Aboriginal Syllabics"](t)||yt["Unified Canadian Aboriginal Syllabics Extended"](t)||yt["Vertical Forms"](t)||yt["Yijing Hexagram Symbols"](t)||yt["Yi Syllables"](t)||yt["Yi Radicals"](t))))}function yc(t){return!(L_(t)||function(e){return!!(yt["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||yt["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||yt["Letterlike Symbols"](e)||yt["Number Forms"](e)||yt["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||yt["Control Pictures"](e)&&e!==9251||yt["Optical Character Recognition"](e)||yt["Enclosed Alphanumerics"](e)||yt["Geometric Shapes"](e)||yt["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||yt["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||yt["CJK Symbols and Punctuation"](e)||yt.Katakana(e)||yt["Private Use Area"](e)||yt["CJK Compatibility Forms"](e)||yt["Small Form Variants"](e)||yt["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(t))}function bc(t){return t>=1424&&t<=2303||yt["Arabic Presentation Forms-A"](t)||yt["Arabic Presentation Forms-B"](t)}function Tc(t,e){return!(!e&&bc(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||yt.Khmer(t))}function N_(t){for(const e of t)if(bc(e.charCodeAt(0)))return!0;return!1}const W_="deferred",M_="loading",D_="loaded";let F_=null,ao="unavailable",Bn=null;const xc=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(ao="error"),F_&&F_(t)};function B_(){U_.fire(new es("pluginStateChange",{pluginStatus:ao,pluginURL:Bn}))}const U_=new Ss,Un=function(){return ao},k_=function(){if(ao!==W_||!Bn)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ao=M_,B_(),Bn&&Le({url:Bn},t=>{t?xc(t):(ao=D_,B_())})},fo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ao===D_||fo.applyArabicShaping!=null,isLoading:()=>ao===M_,setState(t){ao=t.pluginStatus,Bn=t.pluginURL},isParsed:()=>fo.applyArabicShaping!=null&&fo.processBidirectionalText!=null&&fo.processStyledBidirectionalText!=null,getPluginURL:()=>Bn};class qi{constructor(e,i){this.zoom=e,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.transition=i.transition,this.pitch=i.pitch,this.brightness=i.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(e){return function(i,o){for(const l of i)if(!Tc(l.charCodeAt(0),o))return!1;return!0}(e,fo.isLoaded())}}class Vr{constructor(e,i,o,l){this.property=e,this.value=i,this.expression=function(r,u,m,p){if(kr(r))return new Dl(r,u);if(Wl(r)||Array.isArray(r)&&r.length>0){const h=Yr(r,u,m,p);if(h.result==="error")throw new Error(h.value.map(y=>`${y.key}: ${y.message}`).join(", "));return h.value}{let h=r;return typeof r=="string"&&u.type==="color"&&(h=ca.parse(r)),{kind:"constant",isConfigDependent:!1,evaluate:()=>h}}}(i===void 0?e.specification.default:i,e.specification,o,l)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,i,o){return this.property.possiblyEvaluate(this,e,i,o)}}class z_{constructor(e,i,o){this.property=e,this.value=new Vr(e,void 0,i,o)}transitioned(e,i){return new H_(this.property,this.value,i,za({},e.transition,this.transition),e.now)}untransitioned(){return new H_(this.property,this.value,null,{},0)}}class rn{constructor(e,i,o){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues),this._scope=i,this._options=o,this.isConfigDependent=!1}getValue(e){return uo(this._values[e].value.value)}setValue(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new z_(this._values[e].property,this._scope,this._options)),this._values[e].value=new Vr(this._values[e].property,i===null?void 0:uo(i),this._scope,this._options),this.isConfigDependent=this.isConfigDependent||this._values[e].value.expression.isConfigDependent}setTransitionOrValue(e,i){i&&(this._options=i);const o=this._properties.properties;if(e)for(const l in e){const r=e[l];if(Qo(l,"-transition")){const u=l.slice(0,-11);o[u]&&this.setTransition(u,r)}else o[l]&&this.setValue(l,r)}}getTransition(e){return uo(this._values[e].transition)}setTransition(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new z_(this._values[e].property)),this._values[e].transition=uo(i)||void 0}serialize(){const e={};for(const i of Object.keys(this._values)){const o=this.getValue(i);o!==void 0&&(e[i]=o);const l=this.getTransition(i);l!==void 0&&(e[`${i}-transition`]=l)}return e}transitioned(e,i){const o=new cs(this._properties);for(const l of Object.keys(this._values))o._values[l]=this._values[l].transitioned(e,i._values[l]);return o}untransitioned(){const e=new cs(this._properties);for(const i of Object.keys(this._values))e._values[i]=this._values[i].untransitioned();return e}}class H_{constructor(e,i,o,l,r){const u=l.delay||0,m=l.duration||0;r=r||0,this.property=e,this.value=i,this.begin=r+u,this.end=this.begin+m,e.specification.transition&&(l.delay||l.duration)&&(this.prior=o)}possiblyEvaluate(e,i,o){const l=e.now||0,r=this.value.possiblyEvaluate(e,i,o),u=this.prior;if(u){if(l>this.end)return this.prior=null,r;if(this.value.isDataDriven())return this.prior=null,r;if(l<this.begin)return u.possiblyEvaluate(e,i,o);{const m=(l-this.begin)/(this.end-this.begin);return this.property.interpolate(u.possiblyEvaluate(e,i,o),r,ot(m))}}return r}}class cs{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,i,o){const l=new Ul(this._properties);for(const r of Object.keys(this._values))l._values[r]=this._values[r].possiblyEvaluate(e,i,o);return l}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Cf{constructor(e,i,o){this._properties=e,this._values=Object.create(e.defaultPropertyValues),this._scope=i,this._options=o,this.isConfigDependent=!1}getValue(e){return uo(this._values[e].value)}setValue(e,i){this._values[e]=new Vr(this._values[e].property,i===null?void 0:uo(i),this._scope,this._options),this.isConfigDependent=this.isConfigDependent||this._values[e].expression.isConfigDependent}serialize(){const e={};for(const i of Object.keys(this._values)){const o=this.getValue(i);o!==void 0&&(e[i]=o)}return e}possiblyEvaluate(e,i,o){const l=new Ul(this._properties);for(const r of Object.keys(this._values))l._values[r]=this._values[r].possiblyEvaluate(e,i,o);return l}}class Ks{constructor(e,i,o){this.property=e,this.value=i,this.parameters=o}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,i,o,l){return this.property.evaluate(this.value,this.parameters,e,i,o,l)}}class Ul{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Xe{constructor(e){this.specification=e}possiblyEvaluate(e,i){return e.expression.evaluate(i)}interpolate(e,i,o){const l=xr[this.specification.type];return l?l(e,i,o):e}}class Rt{constructor(e,i){this.specification=e,this.overrides=i}possiblyEvaluate(e,i,o,l){return new Ks(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(i,null,{},o,l)}:e.expression,i)}interpolate(e,i,o){if(e.value.kind!=="constant"||i.value.kind!=="constant")return e;if(e.value.value===void 0||i.value.value===void 0)return new Ks(this,{kind:"constant",value:void 0},e.parameters);const l=xr[this.specification.type];return l?new Ks(this,{kind:"constant",value:l(e.value.value,i.value.value,o)},e.parameters):e}evaluate(e,i,o,l,r,u){return e.kind==="constant"?e.value:e.evaluate(i,o,l,r,u)}}class ms{constructor(e){this.specification=e}possiblyEvaluate(e,i,o,l){return!!e.expression.evaluate(i,null,{},o,l)}interpolate(){return!1}}class $i{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const i=new qi(0,{});for(const o in e){const l=e[o];l.specification.overridable&&this.overridableProperties.push(o);const r=this.defaultPropertyValues[o]=new Vr(l,void 0),u=this.defaultTransitionablePropertyValues[o]=new z_(l);this.defaultTransitioningPropertyValues[o]=u.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=r.possiblyEvaluate(i)}}}function kl(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function zl(t){if(Array.isArray(t))return t.map(zl);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const i in t)e[i]=zl(t[i]);return e}return kl(t)}mt(Rt,"DataDrivenProperty"),mt(Xe,"DataConstantProperty"),mt(ms,"ColorRampProperty");var ge=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"expression":{},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Y_(t){if(t===!0||t===!1)return!0;if(!Array.isArray(t)||t.length===0)return!1;switch(t[0]){case"has":return t.length>=2&&t[1]!=="$id"&&t[1]!=="$type";case"in":return t.length>=3&&(typeof t[1]!="string"||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return t.length!==3||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!Y_(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function po(t,e="fill"){if(t==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Y_(t)||(t=Hl(t));const i=t;let o=!0;try{o=function(h){if(!qs(h))return h;let y=zl(h);return G_(y),y=vc(y),y}(i)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(i,null,2)}
        `)}const l=ge[`filter_${e}`],r=Hr(o,l);let u=null;if(r.result==="error")throw new Error(r.value.map(h=>`${h.key}: ${h.message}`).join(", "));u=(h,y,x)=>r.value.evaluate(h,y,{},x);let m=null,p=null;if(o!==i){const h=Hr(i,l);if(h.result==="error")throw new Error(h.value.map(y=>`${y.key}: ${y.message}`).join(", "));m=(y,x,E,S,C)=>h.value.evaluate(y,x,{},E,void 0,void 0,S,C),p=!Bs(h.value.expression)}return{filter:u,dynamicFilter:m||void 0,needGeometry:Ec(o),needFeature:!!p}}function vc(t){if(!Array.isArray(t))return t;const e=function(i){if(wf.has(i[0])){for(let o=1;o<i.length;o++)if(qs(i[o]))return!0}return i}(t);return e===!0?e:e.map(i=>vc(i))}function G_(t){let e=!1;const i=[];if(t[0]==="case"){for(let o=1;o<t.length-1;o+=2)e=e||qs(t[o]),i.push(t[o+1]);i.push(t[t.length-1])}else if(t[0]==="match"){e=e||qs(t[1]);for(let o=2;o<t.length-1;o+=2)i.push(t[o+1]);i.push(t[t.length-1])}else if(t[0]==="step"){e=e||qs(t[1]);for(let o=1;o<t.length-1;o+=2)i.push(t[o+1])}e&&(t.length=0,t.push("any",...i));for(let o=1;o<t.length;o++)G_(t[o])}function qs(t){if(!Array.isArray(t))return!1;if((e=t[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let i=1;i<t.length;i++)if(qs(t[i]))return!0;return!1}const wf=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Pf(t,e){return t<e?-1:t>e?1:0}function Ec(t){if(!Array.isArray(t))return!1;if(t[0]==="within"||t[0]==="distance")return!0;for(let e=1;e<t.length;e++)if(Ec(t[e]))return!0;return!1}function Hl(t){if(!t)return!0;const e=t[0];return t.length<=1?e!=="any":e==="=="?Yl(t[1],t[2],"=="):e==="!="?Gl(Yl(t[1],t[2],"==")):e==="<"||e===">"||e==="<="||e===">="?Yl(t[1],t[2],e):e==="any"?(i=t.slice(1),["any"].concat(i.map(Hl))):e==="all"?["all"].concat(t.slice(1).map(Hl)):e==="none"?["all"].concat(t.slice(1).map(Hl).map(Gl)):e==="in"?V_(t[1],t.slice(2)):e==="!in"?Gl(V_(t[1],t.slice(2))):e==="has"?Ac(t[1]):e!=="!has"||Gl(Ac(t[1]));var i}function Yl(t,e,i){switch(t){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,t,e]}}function V_(t,e){if(e.length===0)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(i=>typeof i!=typeof e[0])?["filter-in-large",t,["literal",e.sort(Pf)]]:["filter-in-small",t,["literal",e]]}}function Ac(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Gl(t){return["!",t]}const jr="";function j_(t,e){return e?`${t}${jr}${e}`:t}const Vl="-transition";class oo extends Ss{constructor(e,i,o,l){if(super(),this.id=e.id,this.fqid=j_(this.id,o),this.type=e.type,this.scope=o,this.options=l,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.isConfigDependent=!1,e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&e.type!=="slot"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),e.slot&&(this.slot=e.slot),i.layout&&(this._unevaluatedLayout=new Cf(i.layout,this.scope,l),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent),i.paint)){this._transitionablePaint=new rn(i.paint,this.scope,l);for(const r in e.paint)this.setPaintProperty(r,e.paint[r]);for(const r in e.layout)this.setLayoutProperty(r,e.layout[r]);this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ul(i.paint)}}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,i){if(this.type==="custom"&&e==="visibility")return void(this.visibility=i);const o=this._unevaluatedLayout;o._properties.properties[e]&&(o.setValue(e,i),this.isConfigDependent=this.isConfigDependent||o.isConfigDependent,e==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(e){return Qo(e,Vl)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,i){const o=this._transitionablePaint,l=o._properties.properties;if(Qo(e,Vl)){const x=e.slice(0,-11);return l[x]&&o.setTransition(x,i||void 0),!1}if(!l[e])return!1;const r=o._values[e],u=r.value.isDataDriven(),m=r.value;o.setValue(e,i),this.isConfigDependent=this.isConfigDependent||o.isConfigDependent,this._handleSpecialPaintPropertyUpdate(e);const p=o._values[e].value,h=p.isDataDriven(),y=Qo(e,"pattern")||e==="line-dasharray";return h||u||y||this._handleOverridablePaintPropertyUpdate(e,m,p)}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getDefaultProgramParams(e,i){return null}_handleOverridablePaintPropertyUpdate(e,i,o){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,i){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,i)}serialize(){return bo({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(e,i)=>!(e===void 0||i==="layout"&&!Object.keys(e).length||i==="paint"&&!Object.keys(e).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const e in this.paint._values){const i=this.paint.get(e);if(i instanceof Ks&&Ur(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=po(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(e){this._stats&&(e.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}}const Lf={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Kr{constructor(e,i){this._structArray=e,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Yi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,i){return e._trim(),i&&(e.isTransferred=!0,i.add(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const i=Object.create(this.prototype);return i.arrayBuffer=e.arrayBuffer,i.length=e.length,i.capacity=e.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...e){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...e){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Ii(t,e=1){let i=0,o=0;return{members:t.map(l=>{const r=Lf[l.type].BYTES_PER_ELEMENT,u=i=jl(i,Math.max(e,r)),m=l.components||1;return o=Math.max(o,r),i+=r*m,{name:l.name,type:l.type,components:m,offset:u}}),size:jl(i,Math.max(o,e)),alignment:e}}function jl(t,e){return Math.ceil(t/e)*e}class ko extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i){const o=this.length;return this.resize(o+1),this.emplace(o,e,i)}emplace(e,i,o){const l=2*e;return this.int16[l+0]=i,this.int16[l+1]=o,e}}ko.prototype.bytesPerElement=4,mt(ko,"StructArrayLayout2i4");class $a extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o){const l=this.length;return this.resize(l+1),this.emplace(l,e,i,o)}emplace(e,i,o,l){const r=3*e;return this.int16[r+0]=i,this.int16[r+1]=o,this.int16[r+2]=l,e}}$a.prototype.bytesPerElement=6,mt($a,"StructArrayLayout3i6");class dn extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o,l){const r=this.length;return this.resize(r+1),this.emplace(r,e,i,o,l)}emplace(e,i,o,l,r){const u=4*e;return this.int16[u+0]=i,this.int16[u+1]=o,this.int16[u+2]=l,this.int16[u+3]=r,e}}dn.prototype.bytesPerElement=8,mt(dn,"StructArrayLayout4i8");class K_ extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o,l,r){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,o,l,r)}emplace(e,i,o,l,r,u){const m=5*e;return this.int16[m+0]=i,this.int16[m+1]=o,this.int16[m+2]=l,this.int16[m+3]=r,this.int16[m+4]=u,e}}K_.prototype.bytesPerElement=10,mt(K_,"StructArrayLayout5i10");class q_ extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,l,r,u,m){const p=this.length;return this.resize(p+1),this.emplace(p,e,i,o,l,r,u,m)}emplace(e,i,o,l,r,u,m,p){const h=6*e,y=12*e,x=3*e;return this.int16[h+0]=i,this.int16[h+1]=o,this.uint8[y+4]=l,this.uint8[y+5]=r,this.uint8[y+6]=u,this.uint8[y+7]=m,this.float32[x+2]=p,e}}q_.prototype.bytesPerElement=12,mt(q_,"StructArrayLayout2i4ub1f12");class kn extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,l){const r=this.length;return this.resize(r+1),this.emplace(r,e,i,o,l)}emplace(e,i,o,l,r){const u=4*e;return this.float32[u+0]=i,this.float32[u+1]=o,this.float32[u+2]=l,this.float32[u+3]=r,e}}kn.prototype.bytesPerElement=16,mt(kn,"StructArrayLayout4f16");class zn extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,l,r){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,o,l,r)}emplace(e,i,o,l,r,u){const m=6*e,p=3*e;return this.uint16[m+0]=i,this.uint16[m+1]=o,this.uint16[m+2]=l,this.uint16[m+3]=r,this.float32[p+2]=u,e}}zn.prototype.bytesPerElement=12,mt(zn,"StructArrayLayout4ui1f12");class $s extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o,l){const r=this.length;return this.resize(r+1),this.emplace(r,e,i,o,l)}emplace(e,i,o,l,r){const u=4*e;return this.uint16[u+0]=i,this.uint16[u+1]=o,this.uint16[u+2]=l,this.uint16[u+3]=r,e}}$s.prototype.bytesPerElement=8,mt($s,"StructArrayLayout4ui8");class qr extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o,l,r,u){const m=this.length;return this.resize(m+1),this.emplace(m,e,i,o,l,r,u)}emplace(e,i,o,l,r,u,m){const p=6*e;return this.int16[p+0]=i,this.int16[p+1]=o,this.int16[p+2]=l,this.int16[p+3]=r,this.int16[p+4]=u,this.int16[p+5]=m,e}}qr.prototype.bytesPerElement=12,mt(qr,"StructArrayLayout6i12");class Kl extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o,l,r,u,m,p,h,y,x,E){const S=this.length;return this.resize(S+1),this.emplace(S,e,i,o,l,r,u,m,p,h,y,x,E)}emplace(e,i,o,l,r,u,m,p,h,y,x,E,S){const C=12*e;return this.int16[C+0]=i,this.int16[C+1]=o,this.int16[C+2]=l,this.int16[C+3]=r,this.uint16[C+4]=u,this.uint16[C+5]=m,this.uint16[C+6]=p,this.uint16[C+7]=h,this.int16[C+8]=y,this.int16[C+9]=x,this.int16[C+10]=E,this.int16[C+11]=S,e}}Kl.prototype.bytesPerElement=24,mt(Kl,"StructArrayLayout4i4ui4i24");class $_ extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,l,r,u){const m=this.length;return this.resize(m+1),this.emplace(m,e,i,o,l,r,u)}emplace(e,i,o,l,r,u,m){const p=10*e,h=5*e;return this.int16[p+0]=i,this.int16[p+1]=o,this.int16[p+2]=l,this.float32[h+2]=r,this.float32[h+3]=u,this.float32[h+4]=m,e}}$_.prototype.bytesPerElement=20,mt($_,"StructArrayLayout3i3f20");class Z_ extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint32[1*e+0]=i,e}}Z_.prototype.bytesPerElement=4,mt(Z_,"StructArrayLayout1ul4");class $o extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i){const o=this.length;return this.resize(o+1),this.emplace(o,e,i)}emplace(e,i,o){const l=2*e;return this.uint16[l+0]=i,this.uint16[l+1]=o,e}}$o.prototype.bytesPerElement=4,mt($o,"StructArrayLayout2ui4");class X_ extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o,l,r,u,m,p,h,y,x,E,S){const C=this.length;return this.resize(C+1),this.emplace(C,e,i,o,l,r,u,m,p,h,y,x,E,S)}emplace(e,i,o,l,r,u,m,p,h,y,x,E,S,C){const w=20*e,W=10*e;return this.int16[w+0]=i,this.int16[w+1]=o,this.int16[w+2]=l,this.int16[w+3]=r,this.int16[w+4]=u,this.float32[W+3]=m,this.float32[W+4]=p,this.float32[W+5]=h,this.float32[W+6]=y,this.int16[w+14]=x,this.uint32[W+8]=E,this.uint16[w+18]=S,this.uint16[w+19]=C,e}}X_.prototype.bytesPerElement=40,mt(X_,"StructArrayLayout5i4f1i1ul2ui40");class ql extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o,l,r,u,m){const p=this.length;return this.resize(p+1),this.emplace(p,e,i,o,l,r,u,m)}emplace(e,i,o,l,r,u,m,p){const h=8*e;return this.int16[h+0]=i,this.int16[h+1]=o,this.int16[h+2]=l,this.int16[h+4]=r,this.int16[h+5]=u,this.int16[h+6]=m,this.int16[h+7]=p,e}}ql.prototype.bytesPerElement=16,mt(ql,"StructArrayLayout3i2i2i16");class $r extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o,l,r){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,o,l,r)}emplace(e,i,o,l,r,u){const m=4*e,p=8*e;return this.float32[m+0]=i,this.float32[m+1]=o,this.float32[m+2]=l,this.int16[p+6]=r,this.int16[p+7]=u,e}}$r.prototype.bytesPerElement=16,mt($r,"StructArrayLayout2f1f2i16");class J_ extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,l){const r=this.length;return this.resize(r+1),this.emplace(r,e,i,o,l)}emplace(e,i,o,l,r){const u=12*e,m=3*e;return this.uint8[u+0]=i,this.uint8[u+1]=o,this.float32[m+1]=l,this.float32[m+2]=r,e}}J_.prototype.bytesPerElement=12,mt(J_,"StructArrayLayout2ub2f12");class Ia extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o){const l=this.length;return this.resize(l+1),this.emplace(l,e,i,o)}emplace(e,i,o,l){const r=3*e;return this.uint16[r+0]=i,this.uint16[r+1]=o,this.uint16[r+2]=l,e}}Ia.prototype.bytesPerElement=6,mt(Ia,"StructArrayLayout3ui6");class Zs extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,o,l,r,u,m,p,h,y,x,E,S,C,w,W,D,Y,q,K,ee){const J=this.length;return this.resize(J+1),this.emplace(J,e,i,o,l,r,u,m,p,h,y,x,E,S,C,w,W,D,Y,q,K,ee)}emplace(e,i,o,l,r,u,m,p,h,y,x,E,S,C,w,W,D,Y,q,K,ee,J){const se=30*e,_e=15*e,me=60*e;return this.int16[se+0]=i,this.int16[se+1]=o,this.int16[se+2]=l,this.float32[_e+2]=r,this.float32[_e+3]=u,this.uint16[se+8]=m,this.uint16[se+9]=p,this.uint32[_e+5]=h,this.uint32[_e+6]=y,this.uint32[_e+7]=x,this.uint16[se+16]=E,this.uint16[se+17]=S,this.uint16[se+18]=C,this.float32[_e+10]=w,this.float32[_e+11]=W,this.uint8[me+48]=D,this.uint8[me+49]=Y,this.uint8[me+50]=q,this.uint32[_e+13]=K,this.int16[se+28]=ee,this.uint8[me+58]=J,e}}Zs.prototype.bytesPerElement=60,mt(Zs,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Zr extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,o,l,r,u,m,p,h,y,x,E,S,C,w,W,D,Y,q,K,ee,J,se,_e,me,be,fe,Se,De,Ae,We,xe){const Ne=this.length;return this.resize(Ne+1),this.emplace(Ne,e,i,o,l,r,u,m,p,h,y,x,E,S,C,w,W,D,Y,q,K,ee,J,se,_e,me,be,fe,Se,De,Ae,We,xe)}emplace(e,i,o,l,r,u,m,p,h,y,x,E,S,C,w,W,D,Y,q,K,ee,J,se,_e,me,be,fe,Se,De,Ae,We,xe,Ne){const Qe=20*e,Be=40*e,pt=80*e;return this.float32[Qe+0]=i,this.float32[Qe+1]=o,this.int16[Be+4]=l,this.int16[Be+5]=r,this.int16[Be+6]=u,this.int16[Be+7]=m,this.int16[Be+8]=p,this.int16[Be+9]=h,this.int16[Be+10]=y,this.int16[Be+11]=x,this.int16[Be+12]=E,this.uint16[Be+13]=S,this.uint16[Be+14]=C,this.uint16[Be+15]=w,this.uint16[Be+16]=W,this.uint16[Be+17]=D,this.uint16[Be+18]=Y,this.uint16[Be+19]=q,this.uint16[Be+20]=K,this.uint16[Be+21]=ee,this.uint16[Be+22]=J,this.uint16[Be+23]=se,this.uint16[Be+24]=_e,this.uint16[Be+25]=me,this.uint16[Be+26]=be,this.uint16[Be+27]=fe,this.uint32[Qe+14]=Se,this.float32[Qe+15]=De,this.float32[Qe+16]=Ae,this.float32[Qe+17]=We,this.float32[Qe+18]=xe,this.uint8[pt+76]=Ne,e}}Zr.prototype.bytesPerElement=80,mt(Zr,"StructArrayLayout2f9i15ui1ul4f1ub80");class $l extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.float32[1*e+0]=i,e}}$l.prototype.bytesPerElement=4,mt($l,"StructArrayLayout1f4");class Hn extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,l,r){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,o,l,r)}emplace(e,i,o,l,r,u){const m=5*e;return this.float32[m+0]=i,this.float32[m+1]=o,this.float32[m+2]=l,this.float32[m+3]=r,this.float32[m+4]=u,e}}Hn.prototype.bytesPerElement=20,mt(Hn,"StructArrayLayout5f20");class Q_ extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,l,r,u,m){const p=this.length;return this.resize(p+1),this.emplace(p,e,i,o,l,r,u,m)}emplace(e,i,o,l,r,u,m,p){const h=7*e;return this.float32[h+0]=i,this.float32[h+1]=o,this.float32[h+2]=l,this.float32[h+3]=r,this.float32[h+4]=u,this.float32[h+5]=m,this.float32[h+6]=p,e}}Q_.prototype.bytesPerElement=28,mt(Q_,"StructArrayLayout7f28");class Zl extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o,l){const r=this.length;return this.resize(r+1),this.emplace(r,e,i,o,l)}emplace(e,i,o,l,r){const u=6*e;return this.uint32[3*e+0]=i,this.uint16[u+2]=o,this.uint16[u+3]=l,this.uint16[u+4]=r,e}}Zl.prototype.bytesPerElement=12,mt(Zl,"StructArrayLayout1ul3ui12");class eu extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint16[1*e+0]=i,e}}eu.prototype.bytesPerElement=2,mt(eu,"StructArrayLayout1ui2");class fs extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o){const l=this.length;return this.resize(l+1),this.emplace(l,e,i,o)}emplace(e,i,o,l){const r=3*e;return this.float32[r+0]=i,this.float32[r+1]=o,this.float32[r+2]=l,e}}fs.prototype.bytesPerElement=12,mt(fs,"StructArrayLayout3f12");class Xl extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i){const o=this.length;return this.resize(o+1),this.emplace(o,e,i)}emplace(e,i,o){const l=2*e;return this.float32[l+0]=i,this.float32[l+1]=o,e}}Xl.prototype.bytesPerElement=8,mt(Xl,"StructArrayLayout2f8");class tu extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,l,r,u,m,p,h,y,x,E,S,C,w,W){const D=this.length;return this.resize(D+1),this.emplace(D,e,i,o,l,r,u,m,p,h,y,x,E,S,C,w,W)}emplace(e,i,o,l,r,u,m,p,h,y,x,E,S,C,w,W,D){const Y=16*e;return this.float32[Y+0]=i,this.float32[Y+1]=o,this.float32[Y+2]=l,this.float32[Y+3]=r,this.float32[Y+4]=u,this.float32[Y+5]=m,this.float32[Y+6]=p,this.float32[Y+7]=h,this.float32[Y+8]=y,this.float32[Y+9]=x,this.float32[Y+10]=E,this.float32[Y+11]=S,this.float32[Y+12]=C,this.float32[Y+13]=w,this.float32[Y+14]=W,this.float32[Y+15]=D,e}}tu.prototype.bytesPerElement=64,mt(tu,"StructArrayLayout16f64");class Jl extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,l,r,u,m){const p=this.length;return this.resize(p+1),this.emplace(p,e,i,o,l,r,u,m)}emplace(e,i,o,l,r,u,m,p){const h=10*e,y=5*e;return this.uint16[h+0]=i,this.uint16[h+1]=o,this.uint16[h+2]=l,this.uint16[h+3]=r,this.float32[y+2]=u,this.float32[y+3]=m,this.float32[y+4]=p,e}}Jl.prototype.bytesPerElement=20,mt(Jl,"StructArrayLayout4ui3f20");class iu extends Yi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint8[1*e+0]=i,e}}iu.prototype.bytesPerElement=1,mt(iu,"StructArrayLayout1ub1");class Ic extends Kr{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Ic.prototype.size=40;class Oc extends X_{get(e){return new Ic(this,e)}}mt(Oc,"CollisionBoxArray");class Sc extends Kr{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}Sc.prototype.size=60;class Rc extends Zs{get(e){return new Sc(this,e)}}mt(Rc,"PlacedSymbolArray");class Cc extends Kr{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(e){this._structArray.uint32[this._pos4+14]=e}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(e){this._structArray.float32[this._pos4+18]=e}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}Cc.prototype.size=80;class wc extends Zr{get(e){return new Cc(this,e)}}mt(wc,"SymbolInstanceArray");class Pc extends $l{getoffsetX(e){return this.float32[1*e+0]}}mt(Pc,"GlyphOffsetArray");class Ql extends ko{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}mt(Ql,"SymbolLineVertexArray");class Lc extends Kr{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Lc.prototype.size=12;class Nc extends Zl{get(e){return new Lc(this,e)}}mt(Nc,"FeatureIndexArray");class er extends $o{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}mt(er,"FillExtrusionCentroidArray");const Nf=Ii([{name:"a_pos",components:2,type:"Int16"}],4),Wc=Ii([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ia{constructor(e=[]){this.segments=e}_prepareSegment(e,i,o,l){let r=this.segments[this.segments.length-1];return e>ia.MAX_VERTEX_ARRAY_LENGTH&&ta(`Max vertices per segment is ${ia.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!r||r.vertexLength+e>ia.MAX_VERTEX_ARRAY_LENGTH||r.sortKey!==l)&&(r={vertexOffset:i,primitiveOffset:o,vertexLength:0,primitiveLength:0},l!==void 0&&(r.sortKey=l),this.segments.push(r)),r}prepareSegment(e,i,o,l){return this._prepareSegment(e,i.length,o.length,l)}get(){return this.segments}destroy(){for(const e of this.segments)for(const i in e.vaos)e.vaos[i].destroy()}static simpleSegment(e,i,o,l){return new ia([{vertexOffset:e,primitiveOffset:i,vertexLength:o,primitiveLength:l,vaos:{},sortKey:0}])}}function au(t,e){return 256*(t=Vt(Math.floor(t),0,255))+Vt(Math.floor(e),0,255)}ia.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,mt(ia,"SegmentVector");const Mc=Ii([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Dc=Ii([{name:"a_dash",components:4,type:"Uint16"}]);var tr={exports:{}},Xr={exports:{}};(function(t){t.exports=function(e,i){var o,l,r,u,m,p,h,y;for(l=e.length-(o=3&e.length),r=i,m=3432918353,p=461845907,y=0;y<l;)h=255&e.charCodeAt(y)|(255&e.charCodeAt(++y))<<8|(255&e.charCodeAt(++y))<<16|(255&e.charCodeAt(++y))<<24,++y,r=27492+(65535&(u=5*(65535&(r=(r^=h=(65535&(h=(h=(65535&h)*m+(((h>>>16)*m&65535)<<16)&4294967295)<<15|h>>>17))*p+(((h>>>16)*p&65535)<<16)&4294967295)<<13|r>>>19))+((5*(r>>>16)&65535)<<16)&4294967295))+((58964+(u>>>16)&65535)<<16);switch(h=0,o){case 3:h^=(255&e.charCodeAt(y+2))<<16;case 2:h^=(255&e.charCodeAt(y+1))<<8;case 1:r^=h=(65535&(h=(h=(65535&(h^=255&e.charCodeAt(y)))*m+(((h>>>16)*m&65535)<<16)&4294967295)<<15|h>>>17))*p+(((h>>>16)*p&65535)<<16)&4294967295}return r^=e.length,r=2246822507*(65535&(r^=r>>>16))+((2246822507*(r>>>16)&65535)<<16)&4294967295,r=3266489909*(65535&(r^=r>>>13))+((3266489909*(r>>>16)&65535)<<16)&4294967295,(r^=r>>>16)>>>0}})(Xr);var ou=Xr.exports,Fc={exports:{}};(function(t){t.exports=function(e,i){for(var o,l=e.length,r=i^l,u=0;l>=4;)o=1540483477*(65535&(o=255&e.charCodeAt(u)|(255&e.charCodeAt(++u))<<8|(255&e.charCodeAt(++u))<<16|(255&e.charCodeAt(++u))<<24))+((1540483477*(o>>>16)&65535)<<16),r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16)^(o=1540483477*(65535&(o^=o>>>24))+((1540483477*(o>>>16)&65535)<<16)),l-=4,++u;switch(l){case 3:r^=(255&e.charCodeAt(u+2))<<16;case 2:r^=(255&e.charCodeAt(u+1))<<8;case 1:r=1540483477*(65535&(r^=255&e.charCodeAt(u)))+((1540483477*(r>>>16)&65535)<<16)}return r=1540483477*(65535&(r^=r>>>13))+((1540483477*(r>>>16)&65535)<<16),(r^=r>>>15)>>>0}})(Fc);var Bc=ou,Uc=Fc.exports;tr.exports=Bc,tr.exports.murmur3=Bc,tr.exports.murmur2=Uc;var nu=bt(tr.exports);class ir{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(e,i,o,l){this.ids.push(kc(e)),this.positions.push(i,o,l)}eachPosition(e,i){const o=kc(e);let l=0,r=this.ids.length-1;for(;l<r;){const u=l+r>>1;this.ids[u]>=o?r=u:l=u+1}for(;this.ids[l]===o;)i(this.positions[3*l],this.positions[3*l+1],this.positions[3*l+2]),l++}static serialize(e,i){const o=new Float64Array(e.ids),l=new Uint32Array(e.positions);return su(o,l,0,o.length-1),i&&(i.add(o.buffer),i.add(l.buffer)),{ids:o,positions:l}}static deserialize(e){const i=new ir;let o;i.ids=e.ids,i.positions=e.positions;for(const l of i.ids)l!==o&&i.uniqueIds.push(l),o=l;return i.indexed=!0,i}}function kc(t){const e=+t;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:nu(String(t))}function su(t,e,i,o){for(;i<o;){const l=t[i+o>>1];let r=i-1,u=o+1;for(;;){do r++;while(t[r]<l);do u--;while(t[u]>l);if(r>=u)break;Jr(t,r,u),Jr(e,3*r,3*u),Jr(e,3*r+1,3*u+1),Jr(e,3*r+2,3*u+2)}u-i<o-u?(su(t,e,i,u),i=u+1):(su(t,e,u+1,o),o=u)}}function Jr(t,e,i){const o=t[e];t[e]=t[i],t[i]=o}mt(ir,"FeaturePositionMap");class _n{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,i){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,i),this.initialized=!0),!!this.location}}class Qr extends _n{constructor(e){super(e),this.current=0}set(e,i,o){this.fetchUniformLocation(e,i)&&this.current!==o&&(this.current=o,this.gl.uniform1i(this.location,o))}}class Va extends _n{constructor(e){super(e),this.current=0}set(e,i,o){this.fetchUniformLocation(e,i)&&this.current!==o&&(this.current=o,this.gl.uniform1f(this.location,o))}}class Yn extends _n{constructor(e){super(e),this.current=[0,0]}set(e,i,o){this.fetchUniformLocation(e,i)&&(o[0]===this.current[0]&&o[1]===this.current[1]||(this.current=o,this.gl.uniform2f(this.location,o[0],o[1])))}}class zc extends _n{constructor(e){super(e),this.current=[0,0,0]}set(e,i,o){this.fetchUniformLocation(e,i)&&(o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]||(this.current=o,this.gl.uniform3f(this.location,o[0],o[1],o[2])))}}class d extends _n{constructor(e){super(e),this.current=[0,0,0,0]}set(e,i,o){this.fetchUniformLocation(e,i)&&(o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]&&o[3]===this.current[3]||(this.current=o,this.gl.uniform4f(this.location,o[0],o[1],o[2],o[3])))}}class a extends _n{constructor(e){super(e),this.current=ca.transparent}set(e,i,o){this.fetchUniformLocation(e,i)&&(o.r===this.current.r&&o.g===this.current.g&&o.b===this.current.b&&o.a===this.current.a||(this.current=o,this.gl.uniform4f(this.location,o.r,o.g,o.b,o.a)))}}const n=new Float32Array(16);class _ extends _n{constructor(e){super(e),this.current=n}set(e,i,o){if(this.fetchUniformLocation(e,i)){if(o[12]!==this.current[12]||o[0]!==this.current[0])return this.current=o,void this.gl.uniformMatrix4fv(this.location,!1,o);for(let l=1;l<16;l++)if(o[l]!==this.current[l]){this.current=o,this.gl.uniformMatrix4fv(this.location,!1,o);break}}}}const c=new Float32Array(9),f=new Float32Array(4);class g extends _n{constructor(e){super(e),this.current=f}set(e,i,o){if(this.fetchUniformLocation(e,i)){for(let l=0;l<4;l++)if(o[l]!==this.current[l]){this.current=o,this.gl.uniformMatrix2fv(this.location,!1,o);break}}}}function b(t){return[au(255*t.r,255*t.g),au(255*t.b,255*t.a)]}class v{constructor(e,i,o){this.value=e,this.uniformNames=i.map(l=>`u_${l}`),this.type=o}setUniform(e,i,o,l,r){i.set(e,r,l.constantOr(this.value))}getBinding(e,i){return this.type==="color"?new a(e):new Va(e)}}class A{constructor(e,i){this.uniformNames=i.map(o=>`u_${o}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,i,o,l,r){const u=r==="u_pattern"||r==="u_dash"?this.pattern:r==="u_pixel_ratio"?this.pixelRatio:null;u&&i.set(e,r,u)}getBinding(e,i){return i==="u_pattern"||i==="u_dash"?new d(e):new Va(e)}}class O{constructor(e,i,o,l){this.expression=e,this.type=o,this.maxValue=0,this.paintVertexAttributes=i.map(r=>({name:`a_${r}`,type:"Float32",components:o==="color"?2:1,offset:0})),this.paintVertexArray=new l}populatePaintArray(e,i,o,l,r,u,m){const p=this.paintVertexArray.length,h=this.expression.evaluate(new qi(0,{brightness:u}),i,{},r,l,m);this.paintVertexArray.resize(e),this._setPaintValue(p,e,h)}updatePaintArray(e,i,o,l,r,u,m){const p=this.expression.evaluate({zoom:0,brightness:m},o,l,void 0,r);this._setPaintValue(e,i,p)}_setPaintValue(e,i,o){if(this.type==="color"){const l=b(o);for(let r=e;r<i;r++)this.paintVertexArray.emplace(r,l[0],l[1])}else{for(let l=e;l<i;l++)this.paintVertexArray.emplace(l,o);this.maxValue=Math.max(this.maxValue,Math.abs(o))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class R{constructor(e,i,o,l,r,u){this.expression=e,this.uniformNames=i.map(m=>`u_${m}_t`),this.type=o,this.useIntegerZoom=l,this.zoom=r,this.maxValue=0,this.paintVertexAttributes=i.map(m=>({name:`a_${m}`,type:"Float32",components:o==="color"?4:2,offset:0})),this.paintVertexArray=new u}populatePaintArray(e,i,o,l,r,u,m){const p=this.expression.evaluate(new qi(this.zoom,{brightness:u}),i,{},r,l,m),h=this.expression.evaluate(new qi(this.zoom+1,{brightness:u}),i,{},r,l,m),y=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(y,e,p,h)}updatePaintArray(e,i,o,l,r,u,m){const p=this.expression.evaluate({zoom:this.zoom,brightness:m},o,l,void 0,r),h=this.expression.evaluate({zoom:this.zoom+1,brightness:m},o,l,void 0,r);this._setPaintValue(e,i,p,h)}_setPaintValue(e,i,o,l){if(this.type==="color"){const r=b(o),u=b(l);for(let m=e;m<i;m++)this.paintVertexArray.emplace(m,r[0],r[1],u[0],u[1])}else{for(let r=e;r<i;r++)this.paintVertexArray.emplace(r,o,l);this.maxValue=Math.max(this.maxValue,Math.abs(o),Math.abs(l))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,i,o,l,r){const u=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,m=Vt(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);i.set(e,r,m)}getBinding(e,i){return new Va(e)}}class P{constructor(e,i,o,l,r){this.expression=e,this.layerId=r,this.paintVertexAttributes=(o==="array"?Dc:Mc).members;for(let u=0;u<i.length;++u);this.paintVertexArray=new l}populatePaintArray(e,i,o){const l=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(l,e,i.patterns&&i.patterns[this.layerId],o)}updatePaintArray(e,i,o,l,r,u,m){this._setPaintValues(e,i,o.patterns&&o.patterns[this.layerId],u)}_setPaintValues(e,i,o,l){if(!l||!o)return;const r=l[o];if(!r)return;const{tl:u,br:m,pixelRatio:p}=r;for(let h=e;h<i;h++)this.paintVertexArray.emplace(h,u[0],u[1],m[0],m[1],p)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class N{constructor(e,i,o=()=>!0){this.binders={},this._buffers=[];const l=[];for(const r in e.paint._values){const u=e.paint.get(r);if(!o(r)||!(u instanceof Ks&&Ur(u.property.specification)))continue;const m=k(r,e.type),p=u.value,h=u.property.specification.type,y=!!u.property.useIntegerZoom,x=r==="line-dasharray"||r.endsWith("pattern"),E=r==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(p.kind!=="constant"||E)if(p.kind==="source"||E||x){const S=$(r,h,"source");this.binders[r]=x?new P(p,m,h,S,e.id):new O(p,m,h,S),l.push(`/a_${r}`)}else{const S=$(r,h,"composite");this.binders[r]=new R(p,m,h,y,i,S),l.push(`/z_${r}`)}else this.binders[r]=x?new A(p.value,m):new v(p.value,m,h),l.push(`/u_${r}`)}this.cacheKey=l.sort().join("")}getMaxValue(e){const i=this.binders[e];return i instanceof O||i instanceof R?i.maxValue:0}populatePaintArrays(e,i,o,l,r,u,m){for(const p in this.binders){const h=this.binders[p];(h instanceof O||h instanceof R||h instanceof P)&&h.populatePaintArray(e,i,o,l,r,u,m)}}setConstantPatternPositions(e){for(const i in this.binders){const o=this.binders[i];o instanceof A&&o.setConstantPatternPositions(e)}}updatePaintArrays(e,i,o,l,r,u,m,p){let h=!1;const y=Object.keys(e),x=y.length!==0,E=x?y:i.uniqueIds;for(const S in this.binders){const C=this.binders[S];if((C instanceof O||C instanceof R||C instanceof P)&&(C.expression.isStateDependent===!0||C.expression.isLightConstant===!1)){const w=r.paint.get(S);C.expression=w.value;for(const W of E){const D=e[W.toString()];i.eachPosition(W,(Y,q,K)=>{const ee=l.feature(Y);C.updatePaintArray(q,K,ee,D,u,m,p)})}if(!x)for(const W of o.uniqueIds){const D=e[W.toString()];o.eachPosition(W,(Y,q,K)=>{const ee=l.feature(Y);C.updatePaintArray(q,K,ee,D,u,m,p)})}h=!0}}return h}defines(){const e=[];for(const i in this.binders){const o=this.binders[i];(o instanceof v||o instanceof A)&&e.push(...o.uniformNames.map(l=>`#define HAS_UNIFORM_${l}`))}return e}getBinderAttributes(){const e=[];for(const i in this.binders){const o=this.binders[i];if(o instanceof O||o instanceof R||o instanceof P)for(let l=0;l<o.paintVertexAttributes.length;l++)e.push(o.paintVertexAttributes[l].name)}return e}getBinderUniforms(){const e=[];for(const i in this.binders){const o=this.binders[i];if(o instanceof v||o instanceof A||o instanceof R)for(const l of o.uniformNames)e.push(l)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const i=[];for(const o in this.binders){const l=this.binders[o];if(l instanceof v||l instanceof A||l instanceof R)for(const r of l.uniformNames)i.push({name:r,property:o,binding:l.getBinding(e,r)})}return i}setUniforms(e,i,o,l,r){for(const{name:u,property:m,binding:p}of o)this.binders[m].setUniform(e,p,r,l.get(m),u)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const i=this.binders[e];(i instanceof O||i instanceof R||i instanceof P)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}}upload(e){for(const i in this.binders){const o=this.binders[i];(o instanceof O||o instanceof R||o instanceof P)&&o.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const i=this.binders[e];(i instanceof O||i instanceof R||i instanceof P)&&i.destroy()}}}class U{constructor(e,i,o=()=>!0){this.programConfigurations={};for(const l of e)this.programConfigurations[l.id]=new N(l,i,o);this.needsUpload=!1,this._featureMap=new ir,this._featureMapWithoutIds=new ir,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(e,i,o,l,r,u,m,p){for(const h in this.programConfigurations)this.programConfigurations[h].populatePaintArrays(e,i,l,r,u,m,p);i.id!==void 0?this._featureMap.add(i.id,o,this._bufferOffset,e):(this._featureMapWithoutIds.add(this._idlessCounter,o,this._bufferOffset,e),this._idlessCounter+=1),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,i,o,l,r,u){for(const m of o)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(e,this._featureMap,this._featureMapWithoutIds,i,m,l,r,u||0)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const B={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function k(t,e){return B[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}const M={"line-pattern":{source:zn,composite:zn},"fill-pattern":{source:zn,composite:zn},"fill-extrusion-pattern":{source:zn,composite:zn},"line-dasharray":{source:$s,composite:$s}},H={color:{source:Xl,composite:kn},number:{source:$l,composite:Xl}};function $(t,e,i){const o=M[t];return o&&o[i]||H[e][i]}mt(v,"ConstantBinder"),mt(A,"PatternConstantBinder"),mt(O,"SourceExpressionBinder"),mt(P,"PatternCompositeBinder"),mt(R,"CompositeExpressionBinder"),mt(N,"ProgramConfiguration",{omit:["_buffers"]}),mt(U,"ProgramConfigurationSet");const V=st/Math.PI/2,Z=5,z=6,X=16383,ie=64,ne=[ie,32,16],re=-V,ye=V;function ue(t,e,i,o=V){return i=Ot(i),[t*Math.sin(i)*o,-e*o,t*Math.cos(i)*o]}function Ie(t,e,i){return ue(Math.cos(Ot(t)),Math.sin(Ot(t)),e,i)}const Ee=63710088e-1,Ue=2*Math.PI*Ee;class ce{constructor(e,i){if(isNaN(e)||isNaN(i))throw new Error(`Invalid LngLat object: (${e}, ${i})`);if(this.lng=+e,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ce(Na(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const i=Math.PI/180,o=this.lat*i,l=e.lat*i,r=Math.sin(o)*Math.sin(l)+Math.cos(o)*Math.cos(l)*Math.cos((e.lng-this.lng)*i);return Ee*Math.acos(Math.min(r,1))}toBounds(e=0){const i=360*e/40075017,o=i/Math.cos(Math.PI/180*this.lat);return new Te({lng:this.lng-o,lat:this.lat-i},{lng:this.lng+o,lat:this.lat+i})}toEcef(e){return Ie(this.lat,this.lng,V+e*V/Ee)}static convert(e){if(e instanceof ce)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new ce(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new ce(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Te{constructor(e,i){e&&(i?this.setSouthWest(e).setNorthEast(i):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof ce?new ce(e.lng,e.lat):ce.convert(e),this}setSouthWest(e){return this._sw=e instanceof ce?new ce(e.lng,e.lat):ce.convert(e),this}extend(e){const i=this._sw,o=this._ne;let l,r;if(e instanceof ce)l=e,r=e;else{if(!(e instanceof Te))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Te.convert(e)):this.extend(ce.convert(e)):typeof e=="object"&&e!==null&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(ce.convert(e)):this;if(l=e._sw,r=e._ne,!l||!r)return this}return i||o?(i.lng=Math.min(l.lng,i.lng),i.lat=Math.min(l.lat,i.lat),o.lng=Math.max(r.lng,o.lng),o.lat=Math.max(r.lat,o.lat)):(this._sw=new ce(l.lng,l.lat),this._ne=new ce(r.lng,r.lat)),this}getCenter(){return new ce((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new ce(this.getWest(),this.getNorth())}getSouthEast(){return new ce(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:i,lat:o}=ce.convert(e);let l=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(l=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=o&&o<=this._ne.lat&&l}static convert(e){return!e||e instanceof Te?e:new Te(e)}}var le={};(function(t,e){(function(i){function o(r,u,m){var p=l(256*r,256*(u=Math.pow(2,m)-u-1),m),h=l(256*(r+1),256*(u+1),m);return p[0]+","+p[1]+","+h[0]+","+h[1]}function l(r,u,m){var p=2*Math.PI*6378137/256/Math.pow(2,m);return[r*p-2*Math.PI*6378137/2,u*p-2*Math.PI*6378137/2]}i.getURL=function(r,u,m,p,h,y){return y=y||{},r+"?"+["bbox="+o(m,p,h),"format="+(y.format||"image/png"),"service="+(y.service||"WMS"),"version="+(y.version||"1.1.1"),"request="+(y.request||"GetMap"),"srs="+(y.srs||"EPSG:3857"),"width="+(y.width||256),"height="+(y.height||256),"layers="+u].join("&")},i.getTileBBox=o,i.getMercCoords=l,Object.defineProperty(i,"__esModule",{value:!0})})(e)})(0,le);var pe=le;class ke{constructor(e,i,o){this.z=e,this.x=i,this.y=o,this.key=it(0,e,e,i,o)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,i){const o=pe.getTileBBox(this.x,this.y,this.z),l=function(r,u,m){let p,h="";for(let y=r;y>0;y--)p=1<<y-1,h+=(u&p?1:0)+(m&p?2:0);return h}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(i==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",l).replace("{bbox-epsg-3857}",o)}toString(){return`${this.z}/${this.x}/${this.y}`}}class $e{constructor(e,i){this.wrap=e,this.canonical=i,this.key=it(e,i.z,i.z,i.x,i.y)}}class je{constructor(e,i,o,l,r){this.overscaledZ=e,this.wrap=i,this.canonical=new ke(o,+l,+r),this.key=i===0&&e===o?this.canonical.key:it(i,e,o,l,r)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const i=this.canonical.z-e;return e>this.canonical.z?new je(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new je(e,this.wrap,e,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(e,i=!0){if(this.overscaledZ===e&&i)return this.key;if(e>this.canonical.z)return it(this.wrap*+i,e,this.canonical.z,this.canonical.x,this.canonical.y);{const o=this.canonical.z-e;return it(this.wrap*+i,e,e,this.canonical.x>>o,this.canonical.y>>o)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const i=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.z<this.canonical.z&&e.canonical.x===this.canonical.x>>i&&e.canonical.y===this.canonical.y>>i}children(e){if(this.overscaledZ>=e)return[new je(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,o=2*this.canonical.x,l=2*this.canonical.y;return[new je(i,this.wrap,i,o,l),new je(i,this.wrap,i,o+1,l),new je(i,this.wrap,i,o,l+1),new je(i,this.wrap,i,o+1,l+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new je(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new je(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new $e(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function it(t,e,i,o,l){const r=1<<Math.min(i,22);let u=r*(l%r)+o%r;return t&&i<22&&(u+=r*r*((t<0?-2*t-1:2*t)%(1<<2*(22-i)))),16*(32*u+i)+(e-i)}const ht=[t=>{let e=t.canonical.x-1,i=t.wrap;return e<0&&(e=(1<<t.canonical.z)-1,i--),new je(t.overscaledZ,i,t.canonical.z,e,t.canonical.y)},t=>{let e=t.canonical.x+1,i=t.wrap;return e===1<<t.canonical.z&&(e=0,i++),new je(t.overscaledZ,i,t.canonical.z,e,t.canonical.y)},t=>new je(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,(t.canonical.y===0?1<<t.canonical.z:t.canonical.y)-1),t=>new je(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y===(1<<t.canonical.z)-1?0:t.canonical.y+1)];mt(ke,"CanonicalTileID"),mt(je,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const St=0,xt=25.5;function At(t){return Ue*Math.cos(t*Math.PI/180)}function jt(t){return(180+t)/360}function Ft(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function zt(t,e){return t/At(e)}function kt(t){return 360*t-180}function di(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function Wi(t,e){return t*At(di(e))}const ei=85.051129;function Zi(t){return Math.cos(Ot(Vt(t,-ei,ei)))}function ti(t,e){const i=Vt(e,St,xt),o=Math.pow(2,i);return Zi(t)*Ue/(512*o)}function fi(t){return 1/Math.cos(t*Math.PI/180)}function ii(t,e=0){const i=Math.exp(Math.PI*(1-(t.y+e/st)/(1<<t.z)*2));return 80150034*i/(i*i+1)/st/(1<<t.z)}class mi{constructor(e,i,o=0){this.x=+e,this.y=+i,this.z=+o}static fromLngLat(e,i=0){const o=ce.convert(e);return new mi(jt(o.lng),Ft(o.lat),zt(i,o.lat))}toLngLat(){return new ce(kt(this.x),di(this.y))}toAltitude(){return Wi(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Ue*fi(di(this.y))}}function Ui(t,e,i,o,l,r,u,m,p){const h=(e+o)/2,y=(i+l)/2,x=new qe(h,y);m(x),function(E,S,C,w,W,D){const Y=C-W,q=w-D;return Math.abs((w-S)*Y-(C-E)*q)/Math.hypot(Y,q)}(x.x,x.y,r.x,r.y,u.x,u.y)>=p?(Ui(t,e,i,h,y,r,x,m,p),Ui(t,h,y,o,l,x,u,m,p)):t.push(u)}function bi(t,e,i){let o=t[0],l=o.x,r=o.y;e(o);const u=[o];for(let m=1;m<t.length;m++){const p=t[m],{x:h,y}=p;e(p),Ui(u,l,r,h,y,o,p,e,i),l=h,r=y,o=p}return u}function Oa(t,e,i,o){if(o(e,i)){const l=e.add(i)._mult(.5);Oa(t,e,l,o),Oa(t,l,i,o)}else t.push(i)}function Ba(t,e){let i=t[0];const o=[i];for(let l=1;l<t.length;l++){const r=t[l];Oa(o,i,r,e),i=r}return o}const no=Math.pow(2,14)-1,Zo=-no-1;function so(t,e){const i=Math.round(t.x*e),o=Math.round(t.y*e);return t.x=Vt(i,Zo,no),t.y=Vt(o,Zo,no),(i<t.x||i>t.x+1||o<t.y||o>t.y+1)&&ta("Geometry exceeds allowed extent, reduce your vector tile buffer size"),t}function Sa(t,e,i){const o=t.loadGeometry(),l=t.extent,r=st/l;if(e&&i&&i.projection.isReprojectedInTileSpace){const u=1<<e.z,{scale:m,x:p,y:h,projection:y}=i,x=E=>{const S=kt((e.x+E.x/l)/u),C=di((e.y+E.y/l)/u),w=y.project(S,C);E.x=(w.x*m-p)*l,E.y=(w.y*m-h)*l};for(let E=0;E<o.length;E++)if(t.type!==1)o[E]=bi(o[E],x,1);else{const S=[];for(const C of o[E])C.x<0||C.x>=l||C.y<0||C.y>=l||(x(C),S.push(C));o[E]=S}}for(const u of o)for(const m of u)so(m,r);return o}function ya(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?Sa(t):[]}}function ja(t,e,i,o,l){t.emplaceBack(2*e+(o+1)/2,2*i+(l+1)/2)}function Za(t,e,i){t.emplaceBack(e.x,e.y,e.z,i[0]*16384,i[1]*16384,i[2]*16384)}class lo{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new ko,this.indexArray=new Ia,this.segments=new ia,this.programConfigurations=new U(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,o,l){const r=this.layers[0],u=[];let m=null;r.type==="circle"&&(m=r.layout.get("circle-sort-key"));for(const{feature:h,id:y,index:x,sourceLayerIndex:E}of e){const S=this.layers[0]._featureFilter.needGeometry,C=ya(h,S);if(!this.layers[0]._featureFilter.filter(new qi(this.zoom),C,o))continue;const w=m?m.evaluate(C,{},o):void 0,W={id:y,properties:h.properties,type:h.type,sourceLayerIndex:E,index:x,geometry:S?C.geometry:Sa(h,o,l),patterns:{},sortKey:w};u.push(W)}m&&u.sort((h,y)=>h.sortKey-y.sortKey);let p=null;l.projection.name==="globe"&&(this.globeExtVertexArray=new qr,p=l.projection);for(const h of u){const{geometry:y,index:x,sourceLayerIndex:E}=h,S=e[x].feature;this.addFeature(h,y,x,i.availableImages,o,p,i.brightness),i.featureIndex.insert(S,y,x,E,this.index)}}update(e,i,o,l,r){const u=Object.keys(e).length!==0;u&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,i,u?this.stateDependentLayers:this.layers,o,l,r)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Nf.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Wc.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,i,o,l,r,u,m){for(const p of i)for(const h of p){const y=h.x,x=h.y;if(y<0||y>=st||x<0||x>=st)continue;if(u){const C=u.projectTilePoint(y,x,r),w=u.upVector(r,y,x),W=this.globeExtVertexArray;Za(W,C,w),Za(W,C,w),Za(W,C,w),Za(W,C,w)}const E=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),S=E.vertexLength;ja(this.layoutVertexArray,y,x,-1,-1),ja(this.layoutVertexArray,y,x,1,-1),ja(this.layoutVertexArray,y,x,1,1),ja(this.layoutVertexArray,y,x,-1,1),this.indexArray.emplaceBack(S,S+1,S+2),this.indexArray.emplaceBack(S,S+2,S+3),E.vertexLength+=4,E.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,{},l,r,m)}}function Xo(t,e){for(let i=0;i<t.length;i++)if(un(e,t[i]))return!0;for(let i=0;i<e.length;i++)if(un(t,e[i]))return!0;return!!or(t,e)}function Gn(t,e,i){return!!un(t,e)||!!nr(e,t,i)}function ps(t,e){if(t.length===1)return ed(e,t[0]);for(let i=0;i<e.length;i++){const o=e[i];for(let l=0;l<o.length;l++)if(un(t,o[l]))return!0}for(let i=0;i<t.length;i++)if(ed(e,t[i]))return!0;for(let i=0;i<e.length;i++)if(or(t,e[i]))return!0;return!1}function ar(t,e,i){if(t.length>1){if(or(t,e))return!0;for(let o=0;o<e.length;o++)if(nr(e[o],t,i))return!0}for(let o=0;o<t.length;o++)if(nr(t[o],e,i))return!0;return!1}function or(t,e){if(t.length===0||e.length===0)return!1;for(let i=0;i<t.length-1;i++){const o=t[i],l=t[i+1];for(let r=0;r<e.length-1;r++)if(lu(o,l,e[r],e[r+1]))return!0}return!1}function lu(t,e,i,o){return To(t,i,o)!==To(e,i,o)&&To(t,e,i)!==To(t,e,o)}function nr(t,e,i){const o=i*i;if(e.length===1)return t.distSqr(e[0])<o;for(let l=1;l<e.length;l++)if(Xs(t,e[l-1],e[l])<o)return!0;return!1}function Xs(t,e,i){const o=e.distSqr(i);if(o===0)return t.distSqr(e);const l=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/o;return t.distSqr(l<0?e:l>1?i:i.sub(e)._mult(l)._add(e))}function ed(t,e){let i,o,l,r=!1;for(let u=0;u<t.length;u++){i=t[u];for(let m=0,p=i.length-1;m<i.length;p=m++)o=i[m],l=i[p],o.y>e.y!=l.y>e.y&&e.x<(l.x-o.x)*(e.y-o.y)/(l.y-o.y)+o.x&&(r=!r)}return r}function un(t,e){let i=!1;for(let o=0,l=t.length-1;o<t.length;l=o++){const r=t[o],u=t[l];r.y>e.y!=u.y>e.y&&e.x<(u.x-r.x)*(e.y-r.y)/(u.y-r.y)+r.x&&(i=!i)}return i}function Ph(t,e,i,o,l){for(const u of t)if(e<=u.x&&i<=u.y&&o>=u.x&&l>=u.y)return!0;const r=[new qe(e,i),new qe(e,l),new qe(o,l),new qe(o,i)];if(t.length>2){for(const u of r)if(un(t,u))return!0}for(let u=0;u<t.length-1;u++)if(xT(t[u],t[u+1],r))return!0;return!1}function xT(t,e,i){const o=i[0],l=i[2];if(t.x<o.x&&e.x<o.x||t.x>l.x&&e.x>l.x||t.y<o.y&&e.y<o.y||t.y>l.y&&e.y>l.y)return!1;const r=To(t,e,i[0]);return r!==To(t,e,i[1])||r!==To(t,e,i[2])||r!==To(t,e,i[3])}function td(t,e,i,o,l,r){let u=e.y-t.y,m=t.x-e.x;if(r=r||0){const p=u*u+m*m;if(p===0)return!0;const h=Math.sqrt(p);u/=h,m/=h}return!((i.x-t.x)*u+(i.y-t.y)*m-r<0||(o.x-t.x)*u+(o.y-t.y)*m-r<0||(l.x-t.x)*u+(l.y-t.y)*m-r<0)}function Wf(t,e,i,o,l,r,u){return!(td(t,e,o,l,r,u)||td(e,i,o,l,r,u)||td(i,t,o,l,r,u)||td(o,l,t,e,i,u)||td(l,r,t,e,i,u)||td(r,o,t,e,i,u))}function id(t,e,i){const o=e.paint.get(t).value;return o.kind==="constant"?o.value:i.programConfigurations.get(e.id).getMaxValue(t)}function Hc(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Lh(t,e,i,o,l){if(!e[0]&&!e[1])return t;const r=qe.convert(e)._mult(l);i==="viewport"&&r._rotate(-o);const u=[];for(let m=0;m<t.length;m++)u.push(t[m].sub(r));return u}function Nh(t,e,i,o){const l=qe.convert(t)._mult(o);return e==="viewport"&&l._rotate(-i),l}mt(lo,"CircleBucket",{omit:["layers"]});const vT=new $i({"circle-sort-key":new Rt(ge.layout_circle["circle-sort-key"]),visibility:new Xe(ge.layout_circle.visibility)});var ET={paint:new $i({"circle-radius":new Rt(ge.paint_circle["circle-radius"]),"circle-color":new Rt(ge.paint_circle["circle-color"]),"circle-blur":new Rt(ge.paint_circle["circle-blur"]),"circle-opacity":new Rt(ge.paint_circle["circle-opacity"]),"circle-translate":new Xe(ge.paint_circle["circle-translate"]),"circle-translate-anchor":new Xe(ge.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Xe(ge.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Xe(ge.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Rt(ge.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Rt(ge.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Rt(ge.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Xe(ge.paint_circle["circle-emissive-strength"])}),layout:vT},Ra={},Ca={};Object.defineProperty(Ca,"__esModule",{value:!0}),Ca.setMatrixArrayType=function(t){Ca.ARRAY_TYPE=Mh=t},Ca.toRadian=function(t){return t*IT},Ca.equals=function(t,e){return Math.abs(t-e)<=Wh*Math.max(1,Math.abs(t),Math.abs(e))},Ca.RANDOM=Ca.ARRAY_TYPE=Ca.EPSILON=void 0;var Wh=1e-6;Ca.EPSILON=Wh;var Mh=typeof Float32Array<"u"?Float32Array:Array;Ca.ARRAY_TYPE=Mh;var AT=Math.random;Ca.RANDOM=AT;var IT=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Xi={};function Mf(t){return Mf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mf(t)}Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.create=function(){var t=new Js.ARRAY_TYPE(4);return Js.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},Xi.clone=function(t){var e=new Js.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},Xi.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},Xi.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},Xi.fromValues=function(t,e,i,o){var l=new Js.ARRAY_TYPE(4);return l[0]=t,l[1]=e,l[2]=i,l[3]=o,l},Xi.set=function(t,e,i,o,l){return t[0]=e,t[1]=i,t[2]=o,t[3]=l,t},Xi.transpose=function(t,e){if(t===e){var i=e[1];t[1]=e[2],t[2]=i}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},Xi.invert=function(t,e){var i=e[0],o=e[1],l=e[2],r=e[3],u=i*r-l*o;return u?(t[0]=r*(u=1/u),t[1]=-o*u,t[2]=-l*u,t[3]=i*u,t):null},Xi.adjoint=function(t,e){var i=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=i,t},Xi.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},Xi.multiply=Fh,Xi.rotate=function(t,e,i){var o=e[0],l=e[1],r=e[2],u=e[3],m=Math.sin(i),p=Math.cos(i);return t[0]=o*p+r*m,t[1]=l*p+u*m,t[2]=o*-m+r*p,t[3]=l*-m+u*p,t},Xi.scale=function(t,e,i){var o=e[1],l=e[2],r=e[3],u=i[0],m=i[1];return t[0]=e[0]*u,t[1]=o*u,t[2]=l*m,t[3]=r*m,t},Xi.fromRotation=function(t,e){var i=Math.sin(e),o=Math.cos(e);return t[0]=o,t[1]=i,t[2]=-i,t[3]=o,t},Xi.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},Xi.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},Xi.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},Xi.LDU=function(t,e,i,o){return t[2]=o[2]/o[0],i[0]=o[0],i[1]=o[1],i[3]=o[3]-t[2]*i[1],[t,e,i]},Xi.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t},Xi.subtract=Bh,Xi.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},Xi.equals=function(t,e){var i=t[0],o=t[1],l=t[2],r=t[3],u=e[0],m=e[1],p=e[2],h=e[3];return Math.abs(i-u)<=Js.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-m)<=Js.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(l-p)<=Js.EPSILON*Math.max(1,Math.abs(l),Math.abs(p))&&Math.abs(r-h)<=Js.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))},Xi.multiplyScalar=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t},Xi.multiplyScalarAndAdd=function(t,e,i,o){return t[0]=e[0]+i[0]*o,t[1]=e[1]+i[1]*o,t[2]=e[2]+i[2]*o,t[3]=e[3]+i[3]*o,t},Xi.sub=Xi.mul=void 0;var Js=function(t,e){if(t&&t.__esModule)return t;if(t===null||Mf(t)!=="object"&&typeof t!="function")return{default:t};var i=Dh(void 0);if(i&&i.has(t))return i.get(t);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)){var u=l?Object.getOwnPropertyDescriptor(t,r):null;u&&(u.get||u.set)?Object.defineProperty(o,r,u):o[r]=t[r]}return o.default=t,i&&i.set(t,o),o}(Ca);function Dh(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(Dh=function(o){return o?i:e})(t)}function Fh(t,e,i){var o=e[0],l=e[1],r=e[2],u=e[3],m=i[0],p=i[1],h=i[2],y=i[3];return t[0]=o*m+r*p,t[1]=l*m+u*p,t[2]=o*h+r*y,t[3]=l*h+u*y,t}function Bh(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t}Xi.mul=Fh,Xi.sub=Bh;var Qi={};function Df(t){return Df=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Df(t)}Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.create=function(){var t=new Vn.ARRAY_TYPE(6);return Vn.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t},Qi.clone=function(t){var e=new Vn.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},Qi.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},Qi.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},Qi.fromValues=function(t,e,i,o,l,r){var u=new Vn.ARRAY_TYPE(6);return u[0]=t,u[1]=e,u[2]=i,u[3]=o,u[4]=l,u[5]=r,u},Qi.set=function(t,e,i,o,l,r,u){return t[0]=e,t[1]=i,t[2]=o,t[3]=l,t[4]=r,t[5]=u,t},Qi.invert=function(t,e){var i=e[0],o=e[1],l=e[2],r=e[3],u=e[4],m=e[5],p=i*r-o*l;return p?(t[0]=r*(p=1/p),t[1]=-o*p,t[2]=-l*p,t[3]=i*p,t[4]=(l*m-r*u)*p,t[5]=(o*u-i*m)*p,t):null},Qi.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},Qi.multiply=kh,Qi.rotate=function(t,e,i){var o=e[0],l=e[1],r=e[2],u=e[3],m=e[4],p=e[5],h=Math.sin(i),y=Math.cos(i);return t[0]=o*y+r*h,t[1]=l*y+u*h,t[2]=o*-h+r*y,t[3]=l*-h+u*y,t[4]=m,t[5]=p,t},Qi.scale=function(t,e,i){var o=e[1],l=e[2],r=e[3],u=e[4],m=e[5],p=i[0],h=i[1];return t[0]=e[0]*p,t[1]=o*p,t[2]=l*h,t[3]=r*h,t[4]=u,t[5]=m,t},Qi.translate=function(t,e,i){var o=e[0],l=e[1],r=e[2],u=e[3],m=e[4],p=e[5],h=i[0],y=i[1];return t[0]=o,t[1]=l,t[2]=r,t[3]=u,t[4]=o*h+r*y+m,t[5]=l*h+u*y+p,t},Qi.fromRotation=function(t,e){var i=Math.sin(e),o=Math.cos(e);return t[0]=o,t[1]=i,t[2]=-i,t[3]=o,t[4]=0,t[5]=0,t},Qi.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},Qi.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},Qi.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},Qi.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)},Qi.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t},Qi.subtract=zh,Qi.multiplyScalar=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t},Qi.multiplyScalarAndAdd=function(t,e,i,o){return t[0]=e[0]+i[0]*o,t[1]=e[1]+i[1]*o,t[2]=e[2]+i[2]*o,t[3]=e[3]+i[3]*o,t[4]=e[4]+i[4]*o,t[5]=e[5]+i[5]*o,t},Qi.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},Qi.equals=function(t,e){var i=t[0],o=t[1],l=t[2],r=t[3],u=t[4],m=t[5],p=e[0],h=e[1],y=e[2],x=e[3],E=e[4],S=e[5];return Math.abs(i-p)<=Vn.EPSILON*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(o-h)<=Vn.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(l-y)<=Vn.EPSILON*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(r-x)<=Vn.EPSILON*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(u-E)<=Vn.EPSILON*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(m-S)<=Vn.EPSILON*Math.max(1,Math.abs(m),Math.abs(S))},Qi.sub=Qi.mul=void 0;var Vn=function(t,e){if(t&&t.__esModule)return t;if(t===null||Df(t)!=="object"&&typeof t!="function")return{default:t};var i=Uh(void 0);if(i&&i.has(t))return i.get(t);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)){var u=l?Object.getOwnPropertyDescriptor(t,r):null;u&&(u.get||u.set)?Object.defineProperty(o,r,u):o[r]=t[r]}return o.default=t,i&&i.set(t,o),o}(Ca);function Uh(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(Uh=function(o){return o?i:e})(t)}function kh(t,e,i){var o=e[0],l=e[1],r=e[2],u=e[3],m=e[4],p=e[5],h=i[0],y=i[1],x=i[2],E=i[3],S=i[4],C=i[5];return t[0]=o*h+r*y,t[1]=l*h+u*y,t[2]=o*x+r*E,t[3]=l*x+u*E,t[4]=o*S+r*C+m,t[5]=l*S+u*C+p,t}function zh(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t}Qi.mul=kh,Qi.sub=zh;var Li={};function Ff(t){return Ff=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ff(t)}Object.defineProperty(Li,"__esModule",{value:!0}),Li.create=function(){var t=new zo.ARRAY_TYPE(9);return zo.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},Li.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},Li.clone=function(t){var e=new zo.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},Li.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},Li.fromValues=function(t,e,i,o,l,r,u,m,p){var h=new zo.ARRAY_TYPE(9);return h[0]=t,h[1]=e,h[2]=i,h[3]=o,h[4]=l,h[5]=r,h[6]=u,h[7]=m,h[8]=p,h},Li.set=function(t,e,i,o,l,r,u,m,p,h){return t[0]=e,t[1]=i,t[2]=o,t[3]=l,t[4]=r,t[5]=u,t[6]=m,t[7]=p,t[8]=h,t},Li.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},Li.transpose=function(t,e){if(t===e){var i=e[1],o=e[2],l=e[5];t[1]=e[3],t[2]=e[6],t[3]=i,t[5]=e[7],t[6]=o,t[7]=l}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},Li.invert=function(t,e){var i=e[0],o=e[1],l=e[2],r=e[3],u=e[4],m=e[5],p=e[6],h=e[7],y=e[8],x=y*u-m*h,E=-y*r+m*p,S=h*r-u*p,C=i*x+o*E+l*S;return C?(t[0]=x*(C=1/C),t[1]=(-y*o+l*h)*C,t[2]=(m*o-l*u)*C,t[3]=E*C,t[4]=(y*i-l*p)*C,t[5]=(-m*i+l*r)*C,t[6]=S*C,t[7]=(-h*i+o*p)*C,t[8]=(u*i-o*r)*C,t):null},Li.adjoint=function(t,e){var i=e[0],o=e[1],l=e[2],r=e[3],u=e[4],m=e[5],p=e[6],h=e[7],y=e[8];return t[0]=u*y-m*h,t[1]=l*h-o*y,t[2]=o*m-l*u,t[3]=m*p-r*y,t[4]=i*y-l*p,t[5]=l*r-i*m,t[6]=r*h-u*p,t[7]=o*p-i*h,t[8]=i*u-o*r,t},Li.determinant=function(t){var e=t[3],i=t[4],o=t[5],l=t[6],r=t[7],u=t[8];return t[0]*(u*i-o*r)+t[1]*(-u*e+o*l)+t[2]*(r*e-i*l)},Li.multiply=Yh,Li.translate=function(t,e,i){var o=e[0],l=e[1],r=e[2],u=e[3],m=e[4],p=e[5],h=e[6],y=e[7],x=e[8],E=i[0],S=i[1];return t[0]=o,t[1]=l,t[2]=r,t[3]=u,t[4]=m,t[5]=p,t[6]=E*o+S*u+h,t[7]=E*l+S*m+y,t[8]=E*r+S*p+x,t},Li.rotate=function(t,e,i){var o=e[0],l=e[1],r=e[2],u=e[3],m=e[4],p=e[5],h=e[6],y=e[7],x=e[8],E=Math.sin(i),S=Math.cos(i);return t[0]=S*o+E*u,t[1]=S*l+E*m,t[2]=S*r+E*p,t[3]=S*u-E*o,t[4]=S*m-E*l,t[5]=S*p-E*r,t[6]=h,t[7]=y,t[8]=x,t},Li.scale=function(t,e,i){var o=i[0],l=i[1];return t[0]=o*e[0],t[1]=o*e[1],t[2]=o*e[2],t[3]=l*e[3],t[4]=l*e[4],t[5]=l*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},Li.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},Li.fromRotation=function(t,e){var i=Math.sin(e),o=Math.cos(e);return t[0]=o,t[1]=i,t[2]=0,t[3]=-i,t[4]=o,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},Li.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},Li.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},Li.fromQuat=function(t,e){var i=e[0],o=e[1],l=e[2],r=e[3],u=i+i,m=o+o,p=l+l,h=i*u,y=o*u,x=o*m,E=l*u,S=l*m,C=l*p,w=r*u,W=r*m,D=r*p;return t[0]=1-x-C,t[3]=y-D,t[6]=E+W,t[1]=y+D,t[4]=1-h-C,t[7]=S-w,t[2]=E-W,t[5]=S+w,t[8]=1-h-x,t},Li.normalFromMat4=function(t,e){var i=e[0],o=e[1],l=e[2],r=e[3],u=e[4],m=e[5],p=e[6],h=e[7],y=e[8],x=e[9],E=e[10],S=e[11],C=e[12],w=e[13],W=e[14],D=e[15],Y=i*m-o*u,q=i*p-l*u,K=i*h-r*u,ee=o*p-l*m,J=o*h-r*m,se=l*h-r*p,_e=y*w-x*C,me=y*W-E*C,be=y*D-S*C,fe=x*W-E*w,Se=x*D-S*w,De=E*D-S*W,Ae=Y*De-q*Se+K*fe+ee*be-J*me+se*_e;return Ae?(t[0]=(m*De-p*Se+h*fe)*(Ae=1/Ae),t[1]=(p*be-u*De-h*me)*Ae,t[2]=(u*Se-m*be+h*_e)*Ae,t[3]=(l*Se-o*De-r*fe)*Ae,t[4]=(i*De-l*be+r*me)*Ae,t[5]=(o*be-i*Se-r*_e)*Ae,t[6]=(w*se-W*J+D*ee)*Ae,t[7]=(W*K-C*se-D*q)*Ae,t[8]=(C*J-w*K+D*Y)*Ae,t):null},Li.projection=function(t,e,i){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/i,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},Li.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},Li.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},Li.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t},Li.subtract=Gh,Li.multiplyScalar=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t},Li.multiplyScalarAndAdd=function(t,e,i,o){return t[0]=e[0]+i[0]*o,t[1]=e[1]+i[1]*o,t[2]=e[2]+i[2]*o,t[3]=e[3]+i[3]*o,t[4]=e[4]+i[4]*o,t[5]=e[5]+i[5]*o,t[6]=e[6]+i[6]*o,t[7]=e[7]+i[7]*o,t[8]=e[8]+i[8]*o,t},Li.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},Li.equals=function(t,e){var i=t[0],o=t[1],l=t[2],r=t[3],u=t[4],m=t[5],p=t[6],h=t[7],y=t[8],x=e[0],E=e[1],S=e[2],C=e[3],w=e[4],W=e[5],D=e[6],Y=e[7],q=e[8];return Math.abs(i-x)<=zo.EPSILON*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(o-E)<=zo.EPSILON*Math.max(1,Math.abs(o),Math.abs(E))&&Math.abs(l-S)<=zo.EPSILON*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(r-C)<=zo.EPSILON*Math.max(1,Math.abs(r),Math.abs(C))&&Math.abs(u-w)<=zo.EPSILON*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(m-W)<=zo.EPSILON*Math.max(1,Math.abs(m),Math.abs(W))&&Math.abs(p-D)<=zo.EPSILON*Math.max(1,Math.abs(p),Math.abs(D))&&Math.abs(h-Y)<=zo.EPSILON*Math.max(1,Math.abs(h),Math.abs(Y))&&Math.abs(y-q)<=zo.EPSILON*Math.max(1,Math.abs(y),Math.abs(q))},Li.sub=Li.mul=void 0;var zo=function(t,e){if(t&&t.__esModule)return t;if(t===null||Ff(t)!=="object"&&typeof t!="function")return{default:t};var i=Hh(void 0);if(i&&i.has(t))return i.get(t);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)){var u=l?Object.getOwnPropertyDescriptor(t,r):null;u&&(u.get||u.set)?Object.defineProperty(o,r,u):o[r]=t[r]}return o.default=t,i&&i.set(t,o),o}(Ca);function Hh(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(Hh=function(o){return o?i:e})(t)}function Yh(t,e,i){var o=e[0],l=e[1],r=e[2],u=e[3],m=e[4],p=e[5],h=e[6],y=e[7],x=e[8],E=i[0],S=i[1],C=i[2],w=i[3],W=i[4],D=i[5],Y=i[6],q=i[7],K=i[8];return t[0]=E*o+S*u+C*h,t[1]=E*l+S*m+C*y,t[2]=E*r+S*p+C*x,t[3]=w*o+W*u+D*h,t[4]=w*l+W*m+D*y,t[5]=w*r+W*p+D*x,t[6]=Y*o+q*u+K*h,t[7]=Y*l+q*m+K*y,t[8]=Y*r+q*p+K*x,t}function Gh(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t}Li.mul=Yh,Li.sub=Gh;var qt={};function Bf(t){return Bf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bf(t)}Object.defineProperty(qt,"__esModule",{value:!0}),qt.create=function(){var t=new sa.ARRAY_TYPE(16);return sa.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},qt.clone=function(t){var e=new sa.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},qt.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},qt.fromValues=function(t,e,i,o,l,r,u,m,p,h,y,x,E,S,C,w){var W=new sa.ARRAY_TYPE(16);return W[0]=t,W[1]=e,W[2]=i,W[3]=o,W[4]=l,W[5]=r,W[6]=u,W[7]=m,W[8]=p,W[9]=h,W[10]=y,W[11]=x,W[12]=E,W[13]=S,W[14]=C,W[15]=w,W},qt.set=function(t,e,i,o,l,r,u,m,p,h,y,x,E,S,C,w,W){return t[0]=e,t[1]=i,t[2]=o,t[3]=l,t[4]=r,t[5]=u,t[6]=m,t[7]=p,t[8]=h,t[9]=y,t[10]=x,t[11]=E,t[12]=S,t[13]=C,t[14]=w,t[15]=W,t},qt.identity=jh,qt.transpose=function(t,e){if(t===e){var i=e[1],o=e[2],l=e[3],r=e[6],u=e[7],m=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=o,t[9]=r,t[11]=e[14],t[12]=l,t[13]=u,t[14]=m}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},qt.invert=function(t,e){var i=e[0],o=e[1],l=e[2],r=e[3],u=e[4],m=e[5],p=e[6],h=e[7],y=e[8],x=e[9],E=e[10],S=e[11],C=e[12],w=e[13],W=e[14],D=e[15],Y=i*m-o*u,q=i*p-l*u,K=i*h-r*u,ee=o*p-l*m,J=o*h-r*m,se=l*h-r*p,_e=y*w-x*C,me=y*W-E*C,be=y*D-S*C,fe=x*W-E*w,Se=x*D-S*w,De=E*D-S*W,Ae=Y*De-q*Se+K*fe+ee*be-J*me+se*_e;return Ae?(t[0]=(m*De-p*Se+h*fe)*(Ae=1/Ae),t[1]=(l*Se-o*De-r*fe)*Ae,t[2]=(w*se-W*J+D*ee)*Ae,t[3]=(E*J-x*se-S*ee)*Ae,t[4]=(p*be-u*De-h*me)*Ae,t[5]=(i*De-l*be+r*me)*Ae,t[6]=(W*K-C*se-D*q)*Ae,t[7]=(y*se-E*K+S*q)*Ae,t[8]=(u*Se-m*be+h*_e)*Ae,t[9]=(o*be-i*Se-r*_e)*Ae,t[10]=(C*J-w*K+D*Y)*Ae,t[11]=(x*K-y*J-S*Y)*Ae,t[12]=(m*me-u*fe-p*_e)*Ae,t[13]=(i*fe-o*me+l*_e)*Ae,t[14]=(w*q-C*ee-W*Y)*Ae,t[15]=(y*ee-x*q+E*Y)*Ae,t):null},qt.adjoint=function(t,e){var i=e[0],o=e[1],l=e[2],r=e[3],u=e[4],m=e[5],p=e[6],h=e[7],y=e[8],x=e[9],E=e[10],S=e[11],C=e[12],w=e[13],W=e[14],D=e[15];return t[0]=m*(E*D-S*W)-x*(p*D-h*W)+w*(p*S-h*E),t[1]=-(o*(E*D-S*W)-x*(l*D-r*W)+w*(l*S-r*E)),t[2]=o*(p*D-h*W)-m*(l*D-r*W)+w*(l*h-r*p),t[3]=-(o*(p*S-h*E)-m*(l*S-r*E)+x*(l*h-r*p)),t[4]=-(u*(E*D-S*W)-y*(p*D-h*W)+C*(p*S-h*E)),t[5]=i*(E*D-S*W)-y*(l*D-r*W)+C*(l*S-r*E),t[6]=-(i*(p*D-h*W)-u*(l*D-r*W)+C*(l*h-r*p)),t[7]=i*(p*S-h*E)-u*(l*S-r*E)+y*(l*h-r*p),t[8]=u*(x*D-S*w)-y*(m*D-h*w)+C*(m*S-h*x),t[9]=-(i*(x*D-S*w)-y*(o*D-r*w)+C*(o*S-r*x)),t[10]=i*(m*D-h*w)-u*(o*D-r*w)+C*(o*h-r*m),t[11]=-(i*(m*S-h*x)-u*(o*S-r*x)+y*(o*h-r*m)),t[12]=-(u*(x*W-E*w)-y*(m*W-p*w)+C*(m*E-p*x)),t[13]=i*(x*W-E*w)-y*(o*W-l*w)+C*(o*E-l*x),t[14]=-(i*(m*W-p*w)-u*(o*W-l*w)+C*(o*p-l*m)),t[15]=i*(m*E-p*x)-u*(o*E-l*x)+y*(o*p-l*m),t},qt.determinant=function(t){var e=t[0],i=t[1],o=t[2],l=t[3],r=t[4],u=t[5],m=t[6],p=t[7],h=t[8],y=t[9],x=t[10],E=t[11],S=t[12],C=t[13],w=t[14],W=t[15];return(e*u-i*r)*(x*W-E*w)-(e*m-o*r)*(y*W-E*C)+(e*p-l*r)*(y*w-x*C)+(i*m-o*u)*(h*W-E*S)-(i*p-l*u)*(h*w-x*S)+(o*p-l*m)*(h*C-y*S)},qt.multiply=Kh,qt.translate=function(t,e,i){var o,l,r,u,m,p,h,y,x,E,S,C,w=i[0],W=i[1],D=i[2];return e===t?(t[12]=e[0]*w+e[4]*W+e[8]*D+e[12],t[13]=e[1]*w+e[5]*W+e[9]*D+e[13],t[14]=e[2]*w+e[6]*W+e[10]*D+e[14],t[15]=e[3]*w+e[7]*W+e[11]*D+e[15]):(l=e[1],r=e[2],u=e[3],m=e[4],p=e[5],h=e[6],y=e[7],x=e[8],E=e[9],S=e[10],C=e[11],t[0]=o=e[0],t[1]=l,t[2]=r,t[3]=u,t[4]=m,t[5]=p,t[6]=h,t[7]=y,t[8]=x,t[9]=E,t[10]=S,t[11]=C,t[12]=o*w+m*W+x*D+e[12],t[13]=l*w+p*W+E*D+e[13],t[14]=r*w+h*W+S*D+e[14],t[15]=u*w+y*W+C*D+e[15]),t},qt.scale=function(t,e,i){var o=i[0],l=i[1],r=i[2];return t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t[3]=e[3]*o,t[4]=e[4]*l,t[5]=e[5]*l,t[6]=e[6]*l,t[7]=e[7]*l,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},qt.rotate=function(t,e,i,o){var l,r,u,m,p,h,y,x,E,S,C,w,W,D,Y,q,K,ee,J,se,_e,me,be,fe,Se=o[0],De=o[1],Ae=o[2],We=Math.hypot(Se,De,Ae);return We<sa.EPSILON?null:(Se*=We=1/We,De*=We,Ae*=We,l=Math.sin(i),r=Math.cos(i),p=e[1],h=e[2],y=e[3],E=e[5],S=e[6],C=e[7],W=e[9],D=e[10],Y=e[11],q=Se*Se*(u=1-r)+r,J=Se*De*u-Ae*l,se=De*De*u+r,_e=Ae*De*u+Se*l,me=Se*Ae*u+De*l,be=De*Ae*u-Se*l,fe=Ae*Ae*u+r,t[0]=(m=e[0])*q+(x=e[4])*(K=De*Se*u+Ae*l)+(w=e[8])*(ee=Ae*Se*u-De*l),t[1]=p*q+E*K+W*ee,t[2]=h*q+S*K+D*ee,t[3]=y*q+C*K+Y*ee,t[4]=m*J+x*se+w*_e,t[5]=p*J+E*se+W*_e,t[6]=h*J+S*se+D*_e,t[7]=y*J+C*se+Y*_e,t[8]=m*me+x*be+w*fe,t[9]=p*me+E*be+W*fe,t[10]=h*me+S*be+D*fe,t[11]=y*me+C*be+Y*fe,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},qt.rotateX=function(t,e,i){var o=Math.sin(i),l=Math.cos(i),r=e[4],u=e[5],m=e[6],p=e[7],h=e[8],y=e[9],x=e[10],E=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=r*l+h*o,t[5]=u*l+y*o,t[6]=m*l+x*o,t[7]=p*l+E*o,t[8]=h*l-r*o,t[9]=y*l-u*o,t[10]=x*l-m*o,t[11]=E*l-p*o,t},qt.rotateY=function(t,e,i){var o=Math.sin(i),l=Math.cos(i),r=e[0],u=e[1],m=e[2],p=e[3],h=e[8],y=e[9],x=e[10],E=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=r*l-h*o,t[1]=u*l-y*o,t[2]=m*l-x*o,t[3]=p*l-E*o,t[8]=r*o+h*l,t[9]=u*o+y*l,t[10]=m*o+x*l,t[11]=p*o+E*l,t},qt.rotateZ=function(t,e,i){var o=Math.sin(i),l=Math.cos(i),r=e[0],u=e[1],m=e[2],p=e[3],h=e[4],y=e[5],x=e[6],E=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=r*l+h*o,t[1]=u*l+y*o,t[2]=m*l+x*o,t[3]=p*l+E*o,t[4]=h*l-r*o,t[5]=y*l-u*o,t[6]=x*l-m*o,t[7]=E*l-p*o,t},qt.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},qt.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},qt.fromRotation=function(t,e,i){var o,l,r,u=i[0],m=i[1],p=i[2],h=Math.hypot(u,m,p);return h<sa.EPSILON?null:(u*=h=1/h,m*=h,p*=h,o=Math.sin(e),l=Math.cos(e),t[0]=u*u*(r=1-l)+l,t[1]=m*u*r+p*o,t[2]=p*u*r-m*o,t[3]=0,t[4]=u*m*r-p*o,t[5]=m*m*r+l,t[6]=p*m*r+u*o,t[7]=0,t[8]=u*p*r+m*o,t[9]=m*p*r-u*o,t[10]=p*p*r+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},qt.fromXRotation=function(t,e){var i=Math.sin(e),o=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=i,t[7]=0,t[8]=0,t[9]=-i,t[10]=o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},qt.fromYRotation=function(t,e){var i=Math.sin(e),o=Math.cos(e);return t[0]=o,t[1]=0,t[2]=-i,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=i,t[9]=0,t[10]=o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},qt.fromZRotation=function(t,e){var i=Math.sin(e),o=Math.cos(e);return t[0]=o,t[1]=i,t[2]=0,t[3]=0,t[4]=-i,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},qt.fromRotationTranslation=qh,qt.fromQuat2=function(t,e){var i=new sa.ARRAY_TYPE(3),o=-e[0],l=-e[1],r=-e[2],u=e[3],m=e[4],p=e[5],h=e[6],y=e[7],x=o*o+l*l+r*r+u*u;return x>0?(i[0]=2*(m*u+y*o+p*r-h*l)/x,i[1]=2*(p*u+y*l+h*o-m*r)/x,i[2]=2*(h*u+y*r+m*l-p*o)/x):(i[0]=2*(m*u+y*o+p*r-h*l),i[1]=2*(p*u+y*l+h*o-m*r),i[2]=2*(h*u+y*r+m*l-p*o)),qh(t,e,i),t},qt.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},qt.getScaling=$h,qt.getRotation=function(t,e){var i=new sa.ARRAY_TYPE(3);$h(i,e);var o=1/i[0],l=1/i[1],r=1/i[2],u=e[0]*o,m=e[1]*l,p=e[2]*r,h=e[4]*o,y=e[5]*l,x=e[6]*r,E=e[8]*o,S=e[9]*l,C=e[10]*r,w=u+y+C,W=0;return w>0?(W=2*Math.sqrt(w+1),t[3]=.25*W,t[0]=(x-S)/W,t[1]=(E-p)/W,t[2]=(m-h)/W):u>y&&u>C?(W=2*Math.sqrt(1+u-y-C),t[3]=(x-S)/W,t[0]=.25*W,t[1]=(m+h)/W,t[2]=(E+p)/W):y>C?(W=2*Math.sqrt(1+y-u-C),t[3]=(E-p)/W,t[0]=(m+h)/W,t[1]=.25*W,t[2]=(x+S)/W):(W=2*Math.sqrt(1+C-u-y),t[3]=(m-h)/W,t[0]=(E+p)/W,t[1]=(x+S)/W,t[2]=.25*W),t},qt.fromRotationTranslationScale=function(t,e,i,o){var l=e[0],r=e[1],u=e[2],m=e[3],p=l+l,h=r+r,y=u+u,x=l*p,E=l*h,S=l*y,C=r*h,w=r*y,W=u*y,D=m*p,Y=m*h,q=m*y,K=o[0],ee=o[1],J=o[2];return t[0]=(1-(C+W))*K,t[1]=(E+q)*K,t[2]=(S-Y)*K,t[3]=0,t[4]=(E-q)*ee,t[5]=(1-(x+W))*ee,t[6]=(w+D)*ee,t[7]=0,t[8]=(S+Y)*J,t[9]=(w-D)*J,t[10]=(1-(x+C))*J,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t},qt.fromRotationTranslationScaleOrigin=function(t,e,i,o,l){var r=e[0],u=e[1],m=e[2],p=e[3],h=r+r,y=u+u,x=m+m,E=r*h,S=r*y,C=r*x,w=u*y,W=u*x,D=m*x,Y=p*h,q=p*y,K=p*x,ee=o[0],J=o[1],se=o[2],_e=l[0],me=l[1],be=l[2],fe=(1-(w+D))*ee,Se=(S+K)*ee,De=(C-q)*ee,Ae=(S-K)*J,We=(1-(E+D))*J,xe=(W+Y)*J,Ne=(C+q)*se,Qe=(W-Y)*se,Be=(1-(E+w))*se;return t[0]=fe,t[1]=Se,t[2]=De,t[3]=0,t[4]=Ae,t[5]=We,t[6]=xe,t[7]=0,t[8]=Ne,t[9]=Qe,t[10]=Be,t[11]=0,t[12]=i[0]+_e-(fe*_e+Ae*me+Ne*be),t[13]=i[1]+me-(Se*_e+We*me+Qe*be),t[14]=i[2]+be-(De*_e+xe*me+Be*be),t[15]=1,t},qt.fromQuat=function(t,e){var i=e[0],o=e[1],l=e[2],r=e[3],u=i+i,m=o+o,p=l+l,h=i*u,y=o*u,x=o*m,E=l*u,S=l*m,C=l*p,w=r*u,W=r*m,D=r*p;return t[0]=1-x-C,t[1]=y+D,t[2]=E-W,t[3]=0,t[4]=y-D,t[5]=1-h-C,t[6]=S+w,t[7]=0,t[8]=E+W,t[9]=S-w,t[10]=1-h-x,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},qt.frustum=function(t,e,i,o,l,r,u){var m=1/(i-e),p=1/(l-o),h=1/(r-u);return t[0]=2*r*m,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*r*p,t[6]=0,t[7]=0,t[8]=(i+e)*m,t[9]=(l+o)*p,t[10]=(u+r)*h,t[11]=-1,t[12]=0,t[13]=0,t[14]=u*r*2*h,t[15]=0,t},qt.perspectiveNO=Zh,qt.perspectiveZO=function(t,e,i,o,l){var r,u=1/Math.tan(e/2);return t[0]=u/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,l!=null&&l!==1/0?(t[10]=l*(r=1/(o-l)),t[14]=l*o*r):(t[10]=-1,t[14]=-o),t},qt.perspectiveFromFieldOfView=function(t,e,i,o){var l=Math.tan(e.upDegrees*Math.PI/180),r=Math.tan(e.downDegrees*Math.PI/180),u=Math.tan(e.leftDegrees*Math.PI/180),m=Math.tan(e.rightDegrees*Math.PI/180),p=2/(u+m),h=2/(l+r);return t[0]=p,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=h,t[6]=0,t[7]=0,t[8]=-(u-m)*p*.5,t[9]=(l-r)*h*.5,t[10]=o/(i-o),t[11]=-1,t[12]=0,t[13]=0,t[14]=o*i/(i-o),t[15]=0,t},qt.orthoNO=Xh,qt.orthoZO=function(t,e,i,o,l,r,u){var m=1/(e-i),p=1/(o-l),h=1/(r-u);return t[0]=-2*m,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*p,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=h,t[11]=0,t[12]=(e+i)*m,t[13]=(l+o)*p,t[14]=r*h,t[15]=1,t},qt.lookAt=function(t,e,i,o){var l,r,u,m,p,h,y,x,E,S,C=e[0],w=e[1],W=e[2],D=o[0],Y=o[1],q=o[2],K=i[0],ee=i[1],J=i[2];return Math.abs(C-K)<sa.EPSILON&&Math.abs(w-ee)<sa.EPSILON&&Math.abs(W-J)<sa.EPSILON?jh(t):(y=C-K,x=w-ee,E=W-J,l=Y*(E*=S=1/Math.hypot(y,x,E))-q*(x*=S),r=q*(y*=S)-D*E,u=D*x-Y*y,(S=Math.hypot(l,r,u))?(l*=S=1/S,r*=S,u*=S):(l=0,r=0,u=0),m=x*u-E*r,p=E*l-y*u,h=y*r-x*l,(S=Math.hypot(m,p,h))?(m*=S=1/S,p*=S,h*=S):(m=0,p=0,h=0),t[0]=l,t[1]=m,t[2]=y,t[3]=0,t[4]=r,t[5]=p,t[6]=x,t[7]=0,t[8]=u,t[9]=h,t[10]=E,t[11]=0,t[12]=-(l*C+r*w+u*W),t[13]=-(m*C+p*w+h*W),t[14]=-(y*C+x*w+E*W),t[15]=1,t)},qt.targetTo=function(t,e,i,o){var l=e[0],r=e[1],u=e[2],m=o[0],p=o[1],h=o[2],y=l-i[0],x=r-i[1],E=u-i[2],S=y*y+x*x+E*E;S>0&&(y*=S=1/Math.sqrt(S),x*=S,E*=S);var C=p*E-h*x,w=h*y-m*E,W=m*x-p*y;return(S=C*C+w*w+W*W)>0&&(C*=S=1/Math.sqrt(S),w*=S,W*=S),t[0]=C,t[1]=w,t[2]=W,t[3]=0,t[4]=x*W-E*w,t[5]=E*C-y*W,t[6]=y*w-x*C,t[7]=0,t[8]=y,t[9]=x,t[10]=E,t[11]=0,t[12]=l,t[13]=r,t[14]=u,t[15]=1,t},qt.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},qt.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},qt.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t[9]=e[9]+i[9],t[10]=e[10]+i[10],t[11]=e[11]+i[11],t[12]=e[12]+i[12],t[13]=e[13]+i[13],t[14]=e[14]+i[14],t[15]=e[15]+i[15],t},qt.subtract=Jh,qt.multiplyScalar=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12]*i,t[13]=e[13]*i,t[14]=e[14]*i,t[15]=e[15]*i,t},qt.multiplyScalarAndAdd=function(t,e,i,o){return t[0]=e[0]+i[0]*o,t[1]=e[1]+i[1]*o,t[2]=e[2]+i[2]*o,t[3]=e[3]+i[3]*o,t[4]=e[4]+i[4]*o,t[5]=e[5]+i[5]*o,t[6]=e[6]+i[6]*o,t[7]=e[7]+i[7]*o,t[8]=e[8]+i[8]*o,t[9]=e[9]+i[9]*o,t[10]=e[10]+i[10]*o,t[11]=e[11]+i[11]*o,t[12]=e[12]+i[12]*o,t[13]=e[13]+i[13]*o,t[14]=e[14]+i[14]*o,t[15]=e[15]+i[15]*o,t},qt.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},qt.equals=function(t,e){var i=t[0],o=t[1],l=t[2],r=t[3],u=t[4],m=t[5],p=t[6],h=t[7],y=t[8],x=t[9],E=t[10],S=t[11],C=t[12],w=t[13],W=t[14],D=t[15],Y=e[0],q=e[1],K=e[2],ee=e[3],J=e[4],se=e[5],_e=e[6],me=e[7],be=e[8],fe=e[9],Se=e[10],De=e[11],Ae=e[12],We=e[13],xe=e[14],Ne=e[15];return Math.abs(i-Y)<=sa.EPSILON*Math.max(1,Math.abs(i),Math.abs(Y))&&Math.abs(o-q)<=sa.EPSILON*Math.max(1,Math.abs(o),Math.abs(q))&&Math.abs(l-K)<=sa.EPSILON*Math.max(1,Math.abs(l),Math.abs(K))&&Math.abs(r-ee)<=sa.EPSILON*Math.max(1,Math.abs(r),Math.abs(ee))&&Math.abs(u-J)<=sa.EPSILON*Math.max(1,Math.abs(u),Math.abs(J))&&Math.abs(m-se)<=sa.EPSILON*Math.max(1,Math.abs(m),Math.abs(se))&&Math.abs(p-_e)<=sa.EPSILON*Math.max(1,Math.abs(p),Math.abs(_e))&&Math.abs(h-me)<=sa.EPSILON*Math.max(1,Math.abs(h),Math.abs(me))&&Math.abs(y-be)<=sa.EPSILON*Math.max(1,Math.abs(y),Math.abs(be))&&Math.abs(x-fe)<=sa.EPSILON*Math.max(1,Math.abs(x),Math.abs(fe))&&Math.abs(E-Se)<=sa.EPSILON*Math.max(1,Math.abs(E),Math.abs(Se))&&Math.abs(S-De)<=sa.EPSILON*Math.max(1,Math.abs(S),Math.abs(De))&&Math.abs(C-Ae)<=sa.EPSILON*Math.max(1,Math.abs(C),Math.abs(Ae))&&Math.abs(w-We)<=sa.EPSILON*Math.max(1,Math.abs(w),Math.abs(We))&&Math.abs(W-xe)<=sa.EPSILON*Math.max(1,Math.abs(W),Math.abs(xe))&&Math.abs(D-Ne)<=sa.EPSILON*Math.max(1,Math.abs(D),Math.abs(Ne))},qt.sub=qt.mul=qt.ortho=qt.perspective=void 0;var sa=function(t,e){if(t&&t.__esModule)return t;if(t===null||Bf(t)!=="object"&&typeof t!="function")return{default:t};var i=Vh(void 0);if(i&&i.has(t))return i.get(t);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)){var u=l?Object.getOwnPropertyDescriptor(t,r):null;u&&(u.get||u.set)?Object.defineProperty(o,r,u):o[r]=t[r]}return o.default=t,i&&i.set(t,o),o}(Ca);function Vh(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(Vh=function(o){return o?i:e})(t)}function jh(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Kh(t,e,i){var o=e[0],l=e[1],r=e[2],u=e[3],m=e[4],p=e[5],h=e[6],y=e[7],x=e[8],E=e[9],S=e[10],C=e[11],w=e[12],W=e[13],D=e[14],Y=e[15],q=i[0],K=i[1],ee=i[2],J=i[3];return t[0]=q*o+K*m+ee*x+J*w,t[1]=q*l+K*p+ee*E+J*W,t[2]=q*r+K*h+ee*S+J*D,t[3]=q*u+K*y+ee*C+J*Y,t[4]=(q=i[4])*o+(K=i[5])*m+(ee=i[6])*x+(J=i[7])*w,t[5]=q*l+K*p+ee*E+J*W,t[6]=q*r+K*h+ee*S+J*D,t[7]=q*u+K*y+ee*C+J*Y,t[8]=(q=i[8])*o+(K=i[9])*m+(ee=i[10])*x+(J=i[11])*w,t[9]=q*l+K*p+ee*E+J*W,t[10]=q*r+K*h+ee*S+J*D,t[11]=q*u+K*y+ee*C+J*Y,t[12]=(q=i[12])*o+(K=i[13])*m+(ee=i[14])*x+(J=i[15])*w,t[13]=q*l+K*p+ee*E+J*W,t[14]=q*r+K*h+ee*S+J*D,t[15]=q*u+K*y+ee*C+J*Y,t}function qh(t,e,i){var o=e[0],l=e[1],r=e[2],u=e[3],m=o+o,p=l+l,h=r+r,y=o*m,x=o*p,E=o*h,S=l*p,C=l*h,w=r*h,W=u*m,D=u*p,Y=u*h;return t[0]=1-(S+w),t[1]=x+Y,t[2]=E-D,t[3]=0,t[4]=x-Y,t[5]=1-(y+w),t[6]=C+W,t[7]=0,t[8]=E+D,t[9]=C-W,t[10]=1-(y+S),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}function $h(t,e){var i=e[4],o=e[5],l=e[6],r=e[8],u=e[9],m=e[10];return t[0]=Math.hypot(e[0],e[1],e[2]),t[1]=Math.hypot(i,o,l),t[2]=Math.hypot(r,u,m),t}function Zh(t,e,i,o,l){var r,u=1/Math.tan(e/2);return t[0]=u/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,l!=null&&l!==1/0?(t[10]=(l+o)*(r=1/(o-l)),t[14]=2*l*o*r):(t[10]=-1,t[14]=-2*o),t}function Xh(t,e,i,o,l,r,u){var m=1/(e-i),p=1/(o-l),h=1/(r-u);return t[0]=-2*m,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*p,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(e+i)*m,t[13]=(l+o)*p,t[14]=(u+r)*h,t[15]=1,t}function Jh(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t[9]=e[9]-i[9],t[10]=e[10]-i[10],t[11]=e[11]-i[11],t[12]=e[12]-i[12],t[13]=e[13]-i[13],t[14]=e[14]-i[14],t[15]=e[15]-i[15],t}qt.perspective=Zh,qt.ortho=Xh,qt.mul=Kh,qt.sub=Jh;var Yt={},Kt={};function Uf(t){return Uf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uf(t)}Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.create=eg,Kt.clone=function(t){var e=new hs.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},Kt.length=tg,Kt.fromValues=function(t,e,i){var o=new hs.ARRAY_TYPE(3);return o[0]=t,o[1]=e,o[2]=i,o},Kt.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},Kt.set=function(t,e,i,o){return t[0]=e,t[1]=i,t[2]=o,t},Kt.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t},Kt.subtract=ig,Kt.multiply=ag,Kt.divide=og,Kt.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},Kt.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},Kt.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t},Kt.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t},Kt.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},Kt.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t},Kt.scaleAndAdd=function(t,e,i,o){return t[0]=e[0]+i[0]*o,t[1]=e[1]+i[1]*o,t[2]=e[2]+i[2]*o,t},Kt.distance=ng,Kt.squaredDistance=sg,Kt.squaredLength=lg,Kt.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},Kt.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},Kt.normalize=function(t,e){var i=e[0],o=e[1],l=e[2],r=i*i+o*o+l*l;return r>0&&(r=1/Math.sqrt(r)),t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},Kt.dot=rg,Kt.cross=function(t,e,i){var o=e[0],l=e[1],r=e[2],u=i[0],m=i[1],p=i[2];return t[0]=l*p-r*m,t[1]=r*u-o*p,t[2]=o*m-l*u,t},Kt.lerp=function(t,e,i,o){var l=e[0],r=e[1],u=e[2];return t[0]=l+o*(i[0]-l),t[1]=r+o*(i[1]-r),t[2]=u+o*(i[2]-u),t},Kt.hermite=function(t,e,i,o,l,r){var u=r*r,m=u*(2*r-3)+1,p=u*(r-2)+r,h=u*(r-1),y=u*(3-2*r);return t[0]=e[0]*m+i[0]*p+o[0]*h+l[0]*y,t[1]=e[1]*m+i[1]*p+o[1]*h+l[1]*y,t[2]=e[2]*m+i[2]*p+o[2]*h+l[2]*y,t},Kt.bezier=function(t,e,i,o,l,r){var u=1-r,m=u*u,p=r*r,h=m*u,y=3*r*m,x=3*p*u,E=p*r;return t[0]=e[0]*h+i[0]*y+o[0]*x+l[0]*E,t[1]=e[1]*h+i[1]*y+o[1]*x+l[1]*E,t[2]=e[2]*h+i[2]*y+o[2]*x+l[2]*E,t},Kt.random=function(t,e){e=e||1;var i=2*hs.RANDOM()*Math.PI,o=2*hs.RANDOM()-1,l=Math.sqrt(1-o*o)*e;return t[0]=Math.cos(i)*l,t[1]=Math.sin(i)*l,t[2]=o*e,t},Kt.transformMat4=function(t,e,i){var o=e[0],l=e[1],r=e[2],u=i[3]*o+i[7]*l+i[11]*r+i[15];return t[0]=(i[0]*o+i[4]*l+i[8]*r+i[12])/(u=u||1),t[1]=(i[1]*o+i[5]*l+i[9]*r+i[13])/u,t[2]=(i[2]*o+i[6]*l+i[10]*r+i[14])/u,t},Kt.transformMat3=function(t,e,i){var o=e[0],l=e[1],r=e[2];return t[0]=o*i[0]+l*i[3]+r*i[6],t[1]=o*i[1]+l*i[4]+r*i[7],t[2]=o*i[2]+l*i[5]+r*i[8],t},Kt.transformQuat=function(t,e,i){var o=i[0],l=i[1],r=i[2],u=e[0],m=e[1],p=e[2],h=l*p-r*m,y=r*u-o*p,x=o*m-l*u,E=l*x-r*y,S=r*h-o*x,C=o*y-l*h,w=2*i[3];return y*=w,x*=w,S*=2,C*=2,t[0]=u+(h*=w)+(E*=2),t[1]=m+y+S,t[2]=p+x+C,t},Kt.rotateX=function(t,e,i,o){var l=[],r=[];return l[0]=e[0]-i[0],l[1]=e[1]-i[1],l[2]=e[2]-i[2],r[0]=l[0],r[1]=l[1]*Math.cos(o)-l[2]*Math.sin(o),r[2]=l[1]*Math.sin(o)+l[2]*Math.cos(o),t[0]=r[0]+i[0],t[1]=r[1]+i[1],t[2]=r[2]+i[2],t},Kt.rotateY=function(t,e,i,o){var l=[],r=[];return l[0]=e[0]-i[0],l[1]=e[1]-i[1],l[2]=e[2]-i[2],r[0]=l[2]*Math.sin(o)+l[0]*Math.cos(o),r[1]=l[1],r[2]=l[2]*Math.cos(o)-l[0]*Math.sin(o),t[0]=r[0]+i[0],t[1]=r[1]+i[1],t[2]=r[2]+i[2],t},Kt.rotateZ=function(t,e,i,o){var l=[],r=[];return l[0]=e[0]-i[0],l[1]=e[1]-i[1],l[2]=e[2]-i[2],r[0]=l[0]*Math.cos(o)-l[1]*Math.sin(o),r[1]=l[0]*Math.sin(o)+l[1]*Math.cos(o),r[2]=l[2],t[0]=r[0]+i[0],t[1]=r[1]+i[1],t[2]=r[2]+i[2],t},Kt.angle=function(t,e){var i=t[0],o=t[1],l=t[2],r=e[0],u=e[1],m=e[2],p=Math.sqrt(i*i+o*o+l*l)*Math.sqrt(r*r+u*u+m*m),h=p&&rg(t,e)/p;return Math.acos(Math.min(Math.max(h,-1),1))},Kt.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t},Kt.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},Kt.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},Kt.equals=function(t,e){var i=t[0],o=t[1],l=t[2],r=e[0],u=e[1],m=e[2];return Math.abs(i-r)<=hs.EPSILON*Math.max(1,Math.abs(i),Math.abs(r))&&Math.abs(o-u)<=hs.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))&&Math.abs(l-m)<=hs.EPSILON*Math.max(1,Math.abs(l),Math.abs(m))},Kt.forEach=Kt.sqrLen=Kt.len=Kt.sqrDist=Kt.dist=Kt.div=Kt.mul=Kt.sub=void 0;var hs=function(t,e){if(t&&t.__esModule)return t;if(t===null||Uf(t)!=="object"&&typeof t!="function")return{default:t};var i=Qh(void 0);if(i&&i.has(t))return i.get(t);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)){var u=l?Object.getOwnPropertyDescriptor(t,r):null;u&&(u.get||u.set)?Object.defineProperty(o,r,u):o[r]=t[r]}return o.default=t,i&&i.set(t,o),o}(Ca);function Qh(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(Qh=function(o){return o?i:e})(t)}function eg(){var t=new hs.ARRAY_TYPE(3);return hs.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function tg(t){return Math.hypot(t[0],t[1],t[2])}function ig(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}function ag(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t}function og(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t}function ng(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2])}function sg(t,e){var i=e[0]-t[0],o=e[1]-t[1],l=e[2]-t[2];return i*i+o*o+l*l}function lg(t){var e=t[0],i=t[1],o=t[2];return e*e+i*i+o*o}function rg(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}Kt.sub=ig,Kt.mul=ag,Kt.div=og,Kt.dist=ng,Kt.sqrDist=sg,Kt.len=tg,Kt.sqrLen=lg;var gs,OT=(gs=eg(),function(t,e,i,o,l,r){var u,m;for(e||(e=3),i||(i=0),m=o?Math.min(o*e+i,t.length):t.length,u=i;u<m;u+=e)gs[0]=t[u],gs[1]=t[u+1],gs[2]=t[u+2],l(gs,gs,r),t[u]=gs[0],t[u+1]=gs[1],t[u+2]=gs[2];return t});Kt.forEach=OT;var oi={};function kf(t){return kf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kf(t)}Object.defineProperty(oi,"__esModule",{value:!0}),oi.create=_g,oi.clone=function(t){var e=new Jo.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},oi.fromValues=function(t,e,i,o){var l=new Jo.ARRAY_TYPE(4);return l[0]=t,l[1]=e,l[2]=i,l[3]=o,l},oi.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},oi.set=function(t,e,i,o,l){return t[0]=e,t[1]=i,t[2]=o,t[3]=l,t},oi.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t},oi.subtract=ug,oi.multiply=cg,oi.divide=mg,oi.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},oi.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},oi.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t[3]=Math.min(e[3],i[3]),t},oi.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t[3]=Math.max(e[3],i[3]),t},oi.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},oi.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t},oi.scaleAndAdd=function(t,e,i,o){return t[0]=e[0]+i[0]*o,t[1]=e[1]+i[1]*o,t[2]=e[2]+i[2]*o,t[3]=e[3]+i[3]*o,t},oi.distance=fg,oi.squaredDistance=pg,oi.length=hg,oi.squaredLength=gg,oi.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},oi.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},oi.normalize=function(t,e){var i=e[0],o=e[1],l=e[2],r=e[3],u=i*i+o*o+l*l+r*r;return u>0&&(u=1/Math.sqrt(u)),t[0]=i*u,t[1]=o*u,t[2]=l*u,t[3]=r*u,t},oi.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},oi.cross=function(t,e,i,o){var l=i[0]*o[1]-i[1]*o[0],r=i[0]*o[2]-i[2]*o[0],u=i[0]*o[3]-i[3]*o[0],m=i[1]*o[2]-i[2]*o[1],p=i[1]*o[3]-i[3]*o[1],h=i[2]*o[3]-i[3]*o[2],y=e[0],x=e[1],E=e[2],S=e[3];return t[0]=x*h-E*p+S*m,t[1]=-y*h+E*u-S*r,t[2]=y*p-x*u+S*l,t[3]=-y*m+x*r-E*l,t},oi.lerp=function(t,e,i,o){var l=e[0],r=e[1],u=e[2],m=e[3];return t[0]=l+o*(i[0]-l),t[1]=r+o*(i[1]-r),t[2]=u+o*(i[2]-u),t[3]=m+o*(i[3]-m),t},oi.random=function(t,e){var i,o,l,r,u,m;e=e||1;do u=(i=2*Jo.RANDOM()-1)*i+(o=2*Jo.RANDOM()-1)*o;while(u>=1);do m=(l=2*Jo.RANDOM()-1)*l+(r=2*Jo.RANDOM()-1)*r;while(m>=1);var p=Math.sqrt((1-u)/m);return t[0]=e*i,t[1]=e*o,t[2]=e*l*p,t[3]=e*r*p,t},oi.transformMat4=function(t,e,i){var o=e[0],l=e[1],r=e[2],u=e[3];return t[0]=i[0]*o+i[4]*l+i[8]*r+i[12]*u,t[1]=i[1]*o+i[5]*l+i[9]*r+i[13]*u,t[2]=i[2]*o+i[6]*l+i[10]*r+i[14]*u,t[3]=i[3]*o+i[7]*l+i[11]*r+i[15]*u,t},oi.transformQuat=function(t,e,i){var o=e[0],l=e[1],r=e[2],u=i[0],m=i[1],p=i[2],h=i[3],y=h*o+m*r-p*l,x=h*l+p*o-u*r,E=h*r+u*l-m*o,S=-u*o-m*l-p*r;return t[0]=y*h+S*-u+x*-p-E*-m,t[1]=x*h+S*-m+E*-u-y*-p,t[2]=E*h+S*-p+y*-m-x*-u,t[3]=e[3],t},oi.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},oi.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},oi.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},oi.equals=function(t,e){var i=t[0],o=t[1],l=t[2],r=t[3],u=e[0],m=e[1],p=e[2],h=e[3];return Math.abs(i-u)<=Jo.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-m)<=Jo.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(l-p)<=Jo.EPSILON*Math.max(1,Math.abs(l),Math.abs(p))&&Math.abs(r-h)<=Jo.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))},oi.forEach=oi.sqrLen=oi.len=oi.sqrDist=oi.dist=oi.div=oi.mul=oi.sub=void 0;var Jo=function(t,e){if(t&&t.__esModule)return t;if(t===null||kf(t)!=="object"&&typeof t!="function")return{default:t};var i=dg(void 0);if(i&&i.has(t))return i.get(t);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)){var u=l?Object.getOwnPropertyDescriptor(t,r):null;u&&(u.get||u.set)?Object.defineProperty(o,r,u):o[r]=t[r]}return o.default=t,i&&i.set(t,o),o}(Ca);function dg(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(dg=function(o){return o?i:e})(t)}function _g(){var t=new Jo.ARRAY_TYPE(4);return Jo.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function ug(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t}function cg(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],t}function mg(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t[3]=e[3]/i[3],t}function fg(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2],e[3]-t[3])}function pg(t,e){var i=e[0]-t[0],o=e[1]-t[1],l=e[2]-t[2],r=e[3]-t[3];return i*i+o*o+l*l+r*r}function hg(t){return Math.hypot(t[0],t[1],t[2],t[3])}function gg(t){var e=t[0],i=t[1],o=t[2],l=t[3];return e*e+i*i+o*o+l*l}oi.sub=ug,oi.mul=cg,oi.div=mg,oi.dist=fg,oi.sqrDist=pg,oi.len=hg,oi.sqrLen=gg;var ST=function(){var t=_g();return function(e,i,o,l,r,u){var m,p;for(i||(i=4),o||(o=0),p=l?Math.min(l*i+o,e.length):e.length,m=o;m<p;m+=i)t[0]=e[m],t[1]=e[m+1],t[2]=e[m+2],t[3]=e[m+3],r(t,t,u),e[m]=t[0],e[m+1]=t[1],e[m+2]=t[2],e[m+3]=t[3];return e}}();function zf(t){return zf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zf(t)}oi.forEach=ST,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.create=Hf,Yt.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},Yt.setAxisAngle=bg,Yt.getAxisAngle=function(t,e){var i=2*Math.acos(e[3]),o=Math.sin(i/2);return o>sr.EPSILON?(t[0]=e[0]/o,t[1]=e[1]/o,t[2]=e[2]/o):(t[0]=1,t[1]=0,t[2]=0),i},Yt.getAngle=function(t,e){var i=Ig(t,e);return Math.acos(2*i*i-1)},Yt.multiply=Tg,Yt.rotateX=function(t,e,i){i*=.5;var o=e[0],l=e[1],r=e[2],u=e[3],m=Math.sin(i),p=Math.cos(i);return t[0]=o*p+u*m,t[1]=l*p+r*m,t[2]=r*p-l*m,t[3]=u*p-o*m,t},Yt.rotateY=function(t,e,i){i*=.5;var o=e[0],l=e[1],r=e[2],u=e[3],m=Math.sin(i),p=Math.cos(i);return t[0]=o*p-r*m,t[1]=l*p+u*m,t[2]=r*p+o*m,t[3]=u*p-l*m,t},Yt.rotateZ=function(t,e,i){i*=.5;var o=e[0],l=e[1],r=e[2],u=e[3],m=Math.sin(i),p=Math.cos(i);return t[0]=o*p+l*m,t[1]=l*p-o*m,t[2]=r*p+u*m,t[3]=u*p-r*m,t},Yt.calculateW=function(t,e){var i=e[0],o=e[1],l=e[2];return t[0]=i,t[1]=o,t[2]=l,t[3]=Math.sqrt(Math.abs(1-i*i-o*o-l*l)),t},Yt.exp=xg,Yt.ln=vg,Yt.pow=function(t,e,i){return vg(t,e),Ag(t,t,i),xg(t,t),t},Yt.slerp=Gc,Yt.random=function(t){var e=sr.RANDOM(),i=sr.RANDOM(),o=sr.RANDOM(),l=Math.sqrt(1-e),r=Math.sqrt(e);return t[0]=l*Math.sin(2*Math.PI*i),t[1]=l*Math.cos(2*Math.PI*i),t[2]=r*Math.sin(2*Math.PI*o),t[3]=r*Math.cos(2*Math.PI*o),t},Yt.invert=function(t,e){var i=e[0],o=e[1],l=e[2],r=e[3],u=i*i+o*o+l*l+r*r,m=u?1/u:0;return t[0]=-i*m,t[1]=-o*m,t[2]=-l*m,t[3]=r*m,t},Yt.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},Yt.fromMat3=Eg,Yt.fromEuler=function(t,e,i,o){var l=.5*Math.PI/180;e*=l,i*=l,o*=l;var r=Math.sin(e),u=Math.cos(e),m=Math.sin(i),p=Math.cos(i),h=Math.sin(o),y=Math.cos(o);return t[0]=r*p*y-u*m*h,t[1]=u*m*y+r*p*h,t[2]=u*p*h-r*m*y,t[3]=u*p*y+r*m*h,t},Yt.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},Yt.setAxes=Yt.sqlerp=Yt.rotationTo=Yt.equals=Yt.exactEquals=Yt.normalize=Yt.sqrLen=Yt.squaredLength=Yt.len=Yt.length=Yt.lerp=Yt.dot=Yt.scale=Yt.mul=Yt.add=Yt.set=Yt.copy=Yt.fromValues=Yt.clone=void 0;var sr=Yc(Ca),RT=Yc(Li),ys=Yc(Kt),Ho=Yc(oi);function yg(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(yg=function(o){return o?i:e})(t)}function Yc(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||zf(t)!=="object"&&typeof t!="function")return{default:t};var i=yg(e);if(i&&i.has(t))return i.get(t);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)){var u=l?Object.getOwnPropertyDescriptor(t,r):null;u&&(u.get||u.set)?Object.defineProperty(o,r,u):o[r]=t[r]}return o.default=t,i&&i.set(t,o),o}function Hf(){var t=new sr.ARRAY_TYPE(4);return sr.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function bg(t,e,i){i*=.5;var o=Math.sin(i);return t[0]=o*e[0],t[1]=o*e[1],t[2]=o*e[2],t[3]=Math.cos(i),t}function Tg(t,e,i){var o=e[0],l=e[1],r=e[2],u=e[3],m=i[0],p=i[1],h=i[2],y=i[3];return t[0]=o*y+u*m+l*h-r*p,t[1]=l*y+u*p+r*m-o*h,t[2]=r*y+u*h+o*p-l*m,t[3]=u*y-o*m-l*p-r*h,t}function xg(t,e){var i=e[0],o=e[1],l=e[2],r=e[3],u=Math.sqrt(i*i+o*o+l*l),m=Math.exp(r),p=u>0?m*Math.sin(u)/u:0;return t[0]=i*p,t[1]=o*p,t[2]=l*p,t[3]=m*Math.cos(u),t}function vg(t,e){var i=e[0],o=e[1],l=e[2],r=e[3],u=Math.sqrt(i*i+o*o+l*l),m=u>0?Math.atan2(u,r)/u:0;return t[0]=i*m,t[1]=o*m,t[2]=l*m,t[3]=.5*Math.log(i*i+o*o+l*l+r*r),t}function Gc(t,e,i,o){var l,r,u,m,p,h=e[0],y=e[1],x=e[2],E=e[3],S=i[0],C=i[1],w=i[2],W=i[3];return(r=h*S+y*C+x*w+E*W)<0&&(r=-r,S=-S,C=-C,w=-w,W=-W),1-r>sr.EPSILON?(l=Math.acos(r),u=Math.sin(l),m=Math.sin((1-o)*l)/u,p=Math.sin(o*l)/u):(m=1-o,p=o),t[0]=m*h+p*S,t[1]=m*y+p*C,t[2]=m*x+p*w,t[3]=m*E+p*W,t}function Eg(t,e){var i,o=e[0]+e[4]+e[8];if(o>0)i=Math.sqrt(o+1),t[3]=.5*i,t[0]=(e[5]-e[7])*(i=.5/i),t[1]=(e[6]-e[2])*i,t[2]=(e[1]-e[3])*i;else{var l=0;e[4]>e[0]&&(l=1),e[8]>e[3*l+l]&&(l=2);var r=(l+1)%3,u=(l+2)%3;i=Math.sqrt(e[3*l+l]-e[3*r+r]-e[3*u+u]+1),t[l]=.5*i,t[3]=(e[3*r+u]-e[3*u+r])*(i=.5/i),t[r]=(e[3*r+l]+e[3*l+r])*i,t[u]=(e[3*u+l]+e[3*l+u])*i}return t}Yt.clone=Ho.clone,Yt.fromValues=Ho.fromValues,Yt.copy=Ho.copy,Yt.set=Ho.set,Yt.add=Ho.add,Yt.mul=Tg;var Ag=Ho.scale;Yt.scale=Ag;var Ig=Ho.dot;Yt.dot=Ig,Yt.lerp=Ho.lerp;var Og=Ho.length;Yt.length=Og,Yt.len=Og;var Sg=Ho.squaredLength;Yt.squaredLength=Sg,Yt.sqrLen=Sg;var Yf=Ho.normalize;Yt.normalize=Yf,Yt.exactEquals=Ho.exactEquals,Yt.equals=Ho.equals;var cn,Rg,Cg,CT=(cn=ys.create(),Rg=ys.fromValues(1,0,0),Cg=ys.fromValues(0,1,0),function(t,e,i){var o=ys.dot(e,i);return o<-.999999?(ys.cross(cn,Rg,e),ys.len(cn)<1e-6&&ys.cross(cn,Cg,e),ys.normalize(cn,cn),bg(t,cn,Math.PI),t):o>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(ys.cross(cn,e,i),t[0]=cn[0],t[1]=cn[1],t[2]=cn[2],t[3]=1+o,Yf(t,t))});Yt.rotationTo=CT;var Gf,Vf,wT=(Gf=Hf(),Vf=Hf(),function(t,e,i,o,l,r){return Gc(Gf,e,l,r),Gc(Vf,i,o,r),Gc(t,Gf,Vf,2*r*(1-r)),t});Yt.sqlerp=wT;var mn,PT=(mn=RT.create(),function(t,e,i,o){return mn[0]=i[0],mn[3]=i[1],mn[6]=i[2],mn[1]=o[0],mn[4]=o[1],mn[7]=o[2],mn[2]=-e[0],mn[5]=-e[1],mn[8]=-e[2],Yf(t,Eg(t,mn))});Yt.setAxes=PT;var _i={};function jf(t){return jf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jf(t)}Object.defineProperty(_i,"__esModule",{value:!0}),_i.create=function(){var t=new ho.ARRAY_TYPE(8);return ho.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t},_i.clone=function(t){var e=new ho.ARRAY_TYPE(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e},_i.fromValues=function(t,e,i,o,l,r,u,m){var p=new ho.ARRAY_TYPE(8);return p[0]=t,p[1]=e,p[2]=i,p[3]=o,p[4]=l,p[5]=r,p[6]=u,p[7]=m,p},_i.fromRotationTranslationValues=function(t,e,i,o,l,r,u){var m=new ho.ARRAY_TYPE(8);m[0]=t,m[1]=e,m[2]=i,m[3]=o;var p=.5*l,h=.5*r,y=.5*u;return m[4]=p*o+h*i-y*e,m[5]=h*o+y*t-p*i,m[6]=y*o+p*e-h*t,m[7]=-p*t-h*e-y*i,m},_i.fromRotationTranslation=Lg,_i.fromTranslation=function(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t},_i.fromRotation=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},_i.fromMat4=function(t,e){var i=bs.create();wg.getRotation(i,e);var o=new ho.ARRAY_TYPE(3);return wg.getTranslation(o,e),Lg(t,i,o),t},_i.copy=Ng,_i.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},_i.set=function(t,e,i,o,l,r,u,m,p){return t[0]=e,t[1]=i,t[2]=o,t[3]=l,t[4]=r,t[5]=u,t[6]=m,t[7]=p,t},_i.getDual=function(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t},_i.setDual=function(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t},_i.getTranslation=function(t,e){var i=e[4],o=e[5],l=e[6],r=e[7],u=-e[0],m=-e[1],p=-e[2],h=e[3];return t[0]=2*(i*h+r*u+o*p-l*m),t[1]=2*(o*h+r*m+l*u-i*p),t[2]=2*(l*h+r*p+i*m-o*u),t},_i.translate=function(t,e,i){var o=e[0],l=e[1],r=e[2],u=e[3],m=.5*i[0],p=.5*i[1],h=.5*i[2],y=e[4],x=e[5],E=e[6],S=e[7];return t[0]=o,t[1]=l,t[2]=r,t[3]=u,t[4]=u*m+l*h-r*p+y,t[5]=u*p+r*m-o*h+x,t[6]=u*h+o*p-l*m+E,t[7]=-o*m-l*p-r*h+S,t},_i.rotateX=function(t,e,i){var o=-e[0],l=-e[1],r=-e[2],u=e[3],m=e[4],p=e[5],h=e[6],y=e[7],x=m*u+y*o+p*r-h*l,E=p*u+y*l+h*o-m*r,S=h*u+y*r+m*l-p*o,C=y*u-m*o-p*l-h*r;return bs.rotateX(t,e,i),t[4]=x*(u=t[3])+C*(o=t[0])+E*(r=t[2])-S*(l=t[1]),t[5]=E*u+C*l+S*o-x*r,t[6]=S*u+C*r+x*l-E*o,t[7]=C*u-x*o-E*l-S*r,t},_i.rotateY=function(t,e,i){var o=-e[0],l=-e[1],r=-e[2],u=e[3],m=e[4],p=e[5],h=e[6],y=e[7],x=m*u+y*o+p*r-h*l,E=p*u+y*l+h*o-m*r,S=h*u+y*r+m*l-p*o,C=y*u-m*o-p*l-h*r;return bs.rotateY(t,e,i),t[4]=x*(u=t[3])+C*(o=t[0])+E*(r=t[2])-S*(l=t[1]),t[5]=E*u+C*l+S*o-x*r,t[6]=S*u+C*r+x*l-E*o,t[7]=C*u-x*o-E*l-S*r,t},_i.rotateZ=function(t,e,i){var o=-e[0],l=-e[1],r=-e[2],u=e[3],m=e[4],p=e[5],h=e[6],y=e[7],x=m*u+y*o+p*r-h*l,E=p*u+y*l+h*o-m*r,S=h*u+y*r+m*l-p*o,C=y*u-m*o-p*l-h*r;return bs.rotateZ(t,e,i),t[4]=x*(u=t[3])+C*(o=t[0])+E*(r=t[2])-S*(l=t[1]),t[5]=E*u+C*l+S*o-x*r,t[6]=S*u+C*r+x*l-E*o,t[7]=C*u-x*o-E*l-S*r,t},_i.rotateByQuatAppend=function(t,e,i){var o=i[0],l=i[1],r=i[2],u=i[3],m=e[0],p=e[1],h=e[2],y=e[3];return t[0]=m*u+y*o+p*r-h*l,t[1]=p*u+y*l+h*o-m*r,t[2]=h*u+y*r+m*l-p*o,t[3]=y*u-m*o-p*l-h*r,t[4]=(m=e[4])*u+(y=e[7])*o+(p=e[5])*r-(h=e[6])*l,t[5]=p*u+y*l+h*o-m*r,t[6]=h*u+y*r+m*l-p*o,t[7]=y*u-m*o-p*l-h*r,t},_i.rotateByQuatPrepend=function(t,e,i){var o=e[0],l=e[1],r=e[2],u=e[3],m=i[0],p=i[1],h=i[2],y=i[3];return t[0]=o*y+u*m+l*h-r*p,t[1]=l*y+u*p+r*m-o*h,t[2]=r*y+u*h+o*p-l*m,t[3]=u*y-o*m-l*p-r*h,t[4]=o*(y=i[7])+u*(m=i[4])+l*(h=i[6])-r*(p=i[5]),t[5]=l*y+u*p+r*m-o*h,t[6]=r*y+u*h+o*p-l*m,t[7]=u*y-o*m-l*p-r*h,t},_i.rotateAroundAxis=function(t,e,i,o){if(Math.abs(o)<ho.EPSILON)return Ng(t,e);var l=Math.hypot(i[0],i[1],i[2]);o*=.5;var r=Math.sin(o),u=r*i[0]/l,m=r*i[1]/l,p=r*i[2]/l,h=Math.cos(o),y=e[0],x=e[1],E=e[2],S=e[3];t[0]=y*h+S*u+x*p-E*m,t[1]=x*h+S*m+E*u-y*p,t[2]=E*h+S*p+y*m-x*u,t[3]=S*h-y*u-x*m-E*p;var C=e[4],w=e[5],W=e[6],D=e[7];return t[4]=C*h+D*u+w*p-W*m,t[5]=w*h+D*m+W*u-C*p,t[6]=W*h+D*p+C*m-w*u,t[7]=D*h-C*u-w*m-W*p,t},_i.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t},_i.multiply=Wg,_i.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t},_i.lerp=function(t,e,i,o){var l=1-o;return Mg(e,i)<0&&(o=-o),t[0]=e[0]*l+i[0]*o,t[1]=e[1]*l+i[1]*o,t[2]=e[2]*l+i[2]*o,t[3]=e[3]*l+i[3]*o,t[4]=e[4]*l+i[4]*o,t[5]=e[5]*l+i[5]*o,t[6]=e[6]*l+i[6]*o,t[7]=e[7]*l+i[7]*o,t},_i.invert=function(t,e){var i=Vc(e);return t[0]=-e[0]/i,t[1]=-e[1]/i,t[2]=-e[2]/i,t[3]=e[3]/i,t[4]=-e[4]/i,t[5]=-e[5]/i,t[6]=-e[6]/i,t[7]=e[7]/i,t},_i.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t},_i.normalize=function(t,e){var i=Vc(e);if(i>0){i=Math.sqrt(i);var o=e[0]/i,l=e[1]/i,r=e[2]/i,u=e[3]/i,m=e[4],p=e[5],h=e[6],y=e[7],x=o*m+l*p+r*h+u*y;t[0]=o,t[1]=l,t[2]=r,t[3]=u,t[4]=(m-o*x)/i,t[5]=(p-l*x)/i,t[6]=(h-r*x)/i,t[7]=(y-u*x)/i}return t},_i.str=function(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"},_i.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]},_i.equals=function(t,e){var i=t[0],o=t[1],l=t[2],r=t[3],u=t[4],m=t[5],p=t[6],h=t[7],y=e[0],x=e[1],E=e[2],S=e[3],C=e[4],w=e[5],W=e[6],D=e[7];return Math.abs(i-y)<=ho.EPSILON*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(o-x)<=ho.EPSILON*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(l-E)<=ho.EPSILON*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(r-S)<=ho.EPSILON*Math.max(1,Math.abs(r),Math.abs(S))&&Math.abs(u-C)<=ho.EPSILON*Math.max(1,Math.abs(u),Math.abs(C))&&Math.abs(m-w)<=ho.EPSILON*Math.max(1,Math.abs(m),Math.abs(w))&&Math.abs(p-W)<=ho.EPSILON*Math.max(1,Math.abs(p),Math.abs(W))&&Math.abs(h-D)<=ho.EPSILON*Math.max(1,Math.abs(h),Math.abs(D))},_i.sqrLen=_i.squaredLength=_i.len=_i.length=_i.dot=_i.mul=_i.setReal=_i.getReal=void 0;var ho=Kf(Ca),bs=Kf(Yt),wg=Kf(qt);function Pg(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(Pg=function(o){return o?i:e})(t)}function Kf(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||jf(t)!=="object"&&typeof t!="function")return{default:t};var i=Pg(e);if(i&&i.has(t))return i.get(t);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)){var u=l?Object.getOwnPropertyDescriptor(t,r):null;u&&(u.get||u.set)?Object.defineProperty(o,r,u):o[r]=t[r]}return o.default=t,i&&i.set(t,o),o}function Lg(t,e,i){var o=.5*i[0],l=.5*i[1],r=.5*i[2],u=e[0],m=e[1],p=e[2],h=e[3];return t[0]=u,t[1]=m,t[2]=p,t[3]=h,t[4]=o*h+l*p-r*m,t[5]=l*h+r*u-o*p,t[6]=r*h+o*m-l*u,t[7]=-o*u-l*m-r*p,t}function Ng(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function Wg(t,e,i){var o=e[0],l=e[1],r=e[2],u=e[3],m=i[4],p=i[5],h=i[6],y=i[7],x=e[4],E=e[5],S=e[6],C=e[7],w=i[0],W=i[1],D=i[2],Y=i[3];return t[0]=o*Y+u*w+l*D-r*W,t[1]=l*Y+u*W+r*w-o*D,t[2]=r*Y+u*D+o*W-l*w,t[3]=u*Y-o*w-l*W-r*D,t[4]=o*y+u*m+l*h-r*p+x*Y+C*w+E*D-S*W,t[5]=l*y+u*p+r*m-o*h+E*Y+C*W+S*w-x*D,t[6]=r*y+u*h+o*p-l*m+S*Y+C*D+x*W-E*w,t[7]=u*y-o*m-l*p-r*h+C*Y-x*w-E*W-S*D,t}_i.getReal=bs.copy,_i.setReal=bs.copy,_i.mul=Wg;var Mg=bs.dot;_i.dot=Mg;var Dg=bs.length;_i.length=Dg,_i.len=Dg;var Vc=bs.squaredLength;_i.squaredLength=Vc,_i.sqrLen=Vc;var Qt={};function qf(t){return qf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qf(t)}Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.create=Bg,Qt.clone=function(t){var e=new lr.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},Qt.fromValues=function(t,e){var i=new lr.ARRAY_TYPE(2);return i[0]=t,i[1]=e,i},Qt.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},Qt.set=function(t,e,i){return t[0]=e,t[1]=i,t},Qt.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t},Qt.subtract=Ug,Qt.multiply=kg,Qt.divide=zg,Qt.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},Qt.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},Qt.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t},Qt.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t},Qt.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},Qt.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t},Qt.scaleAndAdd=function(t,e,i,o){return t[0]=e[0]+i[0]*o,t[1]=e[1]+i[1]*o,t},Qt.distance=Hg,Qt.squaredDistance=Yg,Qt.length=Gg,Qt.squaredLength=Vg,Qt.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},Qt.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},Qt.normalize=function(t,e){var i=e[0],o=e[1],l=i*i+o*o;return l>0&&(l=1/Math.sqrt(l)),t[0]=e[0]*l,t[1]=e[1]*l,t},Qt.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},Qt.cross=function(t,e,i){var o=e[0]*i[1]-e[1]*i[0];return t[0]=t[1]=0,t[2]=o,t},Qt.lerp=function(t,e,i,o){var l=e[0],r=e[1];return t[0]=l+o*(i[0]-l),t[1]=r+o*(i[1]-r),t},Qt.random=function(t,e){e=e||1;var i=2*lr.RANDOM()*Math.PI;return t[0]=Math.cos(i)*e,t[1]=Math.sin(i)*e,t},Qt.transformMat2=function(t,e,i){var o=e[0],l=e[1];return t[0]=i[0]*o+i[2]*l,t[1]=i[1]*o+i[3]*l,t},Qt.transformMat2d=function(t,e,i){var o=e[0],l=e[1];return t[0]=i[0]*o+i[2]*l+i[4],t[1]=i[1]*o+i[3]*l+i[5],t},Qt.transformMat3=function(t,e,i){var o=e[0],l=e[1];return t[0]=i[0]*o+i[3]*l+i[6],t[1]=i[1]*o+i[4]*l+i[7],t},Qt.transformMat4=function(t,e,i){var o=e[0],l=e[1];return t[0]=i[0]*o+i[4]*l+i[12],t[1]=i[1]*o+i[5]*l+i[13],t},Qt.rotate=function(t,e,i,o){var l=e[0]-i[0],r=e[1]-i[1],u=Math.sin(o),m=Math.cos(o);return t[0]=l*m-r*u+i[0],t[1]=l*u+r*m+i[1],t},Qt.angle=function(t,e){var i=t[0],o=t[1],l=e[0],r=e[1],u=Math.sqrt(i*i+o*o)*Math.sqrt(l*l+r*r);return Math.acos(Math.min(Math.max(u&&(i*l+o*r)/u,-1),1))},Qt.zero=function(t){return t[0]=0,t[1]=0,t},Qt.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},Qt.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},Qt.equals=function(t,e){var i=t[0],o=t[1],l=e[0],r=e[1];return Math.abs(i-l)<=lr.EPSILON*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-r)<=lr.EPSILON*Math.max(1,Math.abs(o),Math.abs(r))},Qt.forEach=Qt.sqrLen=Qt.sqrDist=Qt.dist=Qt.div=Qt.mul=Qt.sub=Qt.len=void 0;var lr=function(t,e){if(t&&t.__esModule)return t;if(t===null||qf(t)!=="object"&&typeof t!="function")return{default:t};var i=Fg(void 0);if(i&&i.has(t))return i.get(t);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)){var u=l?Object.getOwnPropertyDescriptor(t,r):null;u&&(u.get||u.set)?Object.defineProperty(o,r,u):o[r]=t[r]}return o.default=t,i&&i.set(t,o),o}(Ca);function Fg(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(Fg=function(o){return o?i:e})(t)}function Bg(){var t=new lr.ARRAY_TYPE(2);return lr.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0),t}function Ug(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t}function kg(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t}function zg(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t}function Hg(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1])}function Yg(t,e){var i=e[0]-t[0],o=e[1]-t[1];return i*i+o*o}function Gg(t){return Math.hypot(t[0],t[1])}function Vg(t){var e=t[0],i=t[1];return e*e+i*i}Qt.len=Gg,Qt.sub=Ug,Qt.mul=kg,Qt.div=zg,Qt.dist=Hg,Qt.sqrDist=Yg,Qt.sqrLen=Vg;var LT=function(){var t=Bg();return function(e,i,o,l,r,u){var m,p;for(i||(i=2),o||(o=0),p=l?Math.min(l*i+o,e.length):e.length,m=o;m<p;m+=i)t[0]=e[m],t[1]=e[m+1],r(t,t,u),e[m]=t[0],e[m+1]=t[1];return e}}();function $f(t){return $f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$f(t)}Qt.forEach=LT,Object.defineProperty(Ra,"__esModule",{value:!0}),s.a7=Ra.vec4=s.N=Ra.vec3=Ra.vec2=Ra.quat2=s.bi=Ra.quat=s.a6=Ra.mat4=s.co=Ra.mat3=Ra.mat2d=s.b4=Ra.mat2=Ra.glMatrix=void 0;var NT=jn(Ca);Ra.glMatrix=NT;var WT=jn(Xi);s.b4=Ra.mat2=WT;var MT=jn(Qi);Ra.mat2d=MT;var DT=jn(Li);s.co=Ra.mat3=DT;var FT=jn(qt);s.a6=Ra.mat4=FT;var BT=jn(Yt);s.bi=Ra.quat=BT;var UT=jn(_i);Ra.quat2=UT;var kT=jn(Qt);Ra.vec2=kT;var zT=jn(Kt);s.N=Ra.vec3=zT;var HT=jn(oi);function jg(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(jg=function(o){return o?i:e})(t)}function jn(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||$f(t)!=="object"&&typeof t!="function")return{default:t};var i=jg(e);if(i&&i.has(t))return i.get(t);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)){var u=l?Object.getOwnPropertyDescriptor(t,r):null;u&&(u.get||u.set)?Object.defineProperty(o,r,u):o[r]=t[r]}return o.default=t,i&&i.set(t,o),o}s.a7=Ra.vec4=HT;class Zf{constructor(e,i){this.pos=e,this.dir=i}intersectsPlane(e,i,o){const l=s.N.dot(i,this.dir);if(Math.abs(l)<1e-6)return!1;const r=((e[0]-this.pos[0])*i[0]+(e[1]-this.pos[1])*i[1]+(e[2]-this.pos[2])*i[2])/l;return o[0]=this.pos[0]+this.dir[0]*r,o[1]=this.pos[1]+this.dir[1]*r,o[2]=this.pos[2]+this.dir[2]*r,!0}closestPointOnSphere(e,i,o){if(s.N.equals(this.pos,e)||i===0)return o[0]=o[1]=o[2]=0,!1;const[l,r,u]=this.dir,m=this.pos[0]-e[0],p=this.pos[1]-e[1],h=this.pos[2]-e[2],y=l*l+r*r+u*u,x=2*(m*l+p*r+h*u),E=x*x-4*y*(m*m+p*p+h*h-i*i);if(E<0){const S=Math.max(-x/2,0),C=m+l*S,w=p+r*S,W=h+u*S,D=Math.hypot(C,w,W);return o[0]=C*i/D,o[1]=w*i/D,o[2]=W*i/D,!1}{const S=(-x-Math.sqrt(E))/(2*y);if(S<0){const C=Math.hypot(m,p,h);return o[0]=m*i/C,o[1]=p*i/C,o[2]=h*i/C,!1}return o[0]=m+l*S,o[1]=p+r*S,o[2]=h+u*S,!0}}}class Xf{constructor(e,i,o,l,r){this.TL=e,this.TR=i,this.BR=o,this.BL=l,this.horizon=r}static fromInvProjectionMatrix(e,i,o){const l=[-1,1,1],r=[1,1,1],u=[1,-1,1],m=[-1,-1,1],p=s.N.transformMat4(l,l,e),h=s.N.transformMat4(r,r,e),y=s.N.transformMat4(u,u,e),x=s.N.transformMat4(m,m,e);return new Xf(p,h,y,x,i/o)}}function ru(t,e,i){let o=1/0,l=-1/0;const r=[];for(const u of t){s.N.sub(r,u,e);const m=s.N.dot(r,i);o=Math.min(o,m),l=Math.max(l,m)}return[o,l]}function Kg(t,e){let i=!0;for(let o=0;o<t.planes.length;o++){const l=t.planes[o];let r=0;for(let u=0;u<e.length;u++)r+=s.N.dot(l,e[u])+l[3]>=0;if(r===0)return 0;r!==e.length&&(i=!1)}return i?2:1}function qg(t,e){for(const i of t.projections){const o=ru(e,t.points[0],i.axis);if(i.projection[1]<o[0]||i.projection[0]>o[1])return 0}return 1}function $g(t,e){let i=0;const o=[0,0,0,0];for(let l=0;l<t.length;l++)o[0]=t[l][0],o[1]=t[l][1],o[2]=t[l][2],o[3]=1,s.a7.dot(o,e)>=0&&i++;return i}class Jf{constructor(e,i){this.points=e||new Array(8).fill([0,0,0]),this.planes=i||new Array(6).fill([0,0,0,0]),this.bounds=ea.fromPoints(this.points),this.projections=[],this.frustumEdges=[s.N.sub([],this.points[2],this.points[3]),s.N.sub([],this.points[0],this.points[3]),s.N.sub([],this.points[4],this.points[0]),s.N.sub([],this.points[5],this.points[1]),s.N.sub([],this.points[6],this.points[2]),s.N.sub([],this.points[7],this.points[3])];for(const o of this.frustumEdges){const l=[0,-o[2],o[1]],r=[o[2],0,-o[0]];this.projections.push({axis:l,projection:ru(this.points,this.points[0],l)}),this.projections.push({axis:r,projection:ru(this.points,this.points[0],r)})}}static fromInvProjectionMatrix(e,i,o,l){const r=Math.pow(2,o),u=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(h=>{const y=s.a7.transformMat4([],h,e),x=1/y[3]/i*r;return s.a7.mul(y,y,[x,x,l?1/y[3]:x,x])}),m=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(h=>{const y=s.N.sub([],u[h[0]],u[h[1]]),x=s.N.sub([],u[h[2]],u[h[1]]),E=s.N.normalize([],s.N.cross([],y,x)),S=-s.N.dot(E,u[h[1]]);return E.concat(S)}),p=[];for(let h=0;h<u.length;h++)p.push([u[h][0],u[h][1],u[h][2]]);return new Jf(p,m)}intersectsPrecise(e,i,o){for(let l=0;l<i.length;l++)if(!$g(e,i[l]))return 0;for(let l=0;l<this.planes.length;l++)if(!$g(e,this.planes[l]))return 0;for(const l of o)for(const r of this.frustumEdges){const u=s.N.cross([],l,r),m=s.N.length(u);if(m===0)continue;s.N.scale(u,u,1/m);const p=ru(this.points,this.points[0],u),h=ru(e,this.points[0],u);if(p[0]>h[1]||h[0]>p[1])return 0}return 1}}class ea{static fromPoints(e){const i=[1/0,1/0,1/0],o=[-1/0,-1/0,-1/0];for(const l of e)s.N.min(i,i,l),s.N.max(o,o,l);return new ea(i,o)}static fromTileIdAndHeight(e,i,o){const l=1<<e.canonical.z,r=e.canonical.x,u=e.canonical.y;return new ea([r/l,u/l,i],[(r+1)/l,(u+1)/l,o])}static applyTransform(e,i){const o=e.getCorners();for(let l=0;l<o.length;++l)s.N.transformMat4(o[l],o[l],i);return ea.fromPoints(o)}static projectAabbCorners(e,i){const o=e.getCorners();for(let l=0;l<o.length;++l)s.N.transformMat4(o[l],o[l],i);return o}constructor(e,i){this.min=e,this.max=i,this.center=s.N.scale([],s.N.add([],this.min,this.max),.5)}quadrant(e){const i=[e%2==0,e<2],o=s.N.clone(this.min),l=s.N.clone(this.max);for(let r=0;r<i.length;r++)o[r]=i[r]?this.min[r]:this.center[r],l[r]=i[r]?this.center[r]:this.max[r];return l[2]=this.max[2],new ea(o,l)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,i=this.max;return[[e[0],e[1],e[2]],[i[0],e[1],e[2]],[i[0],i[1],e[2]],[e[0],i[1],e[2]],[e[0],e[1],i[2]],[i[0],e[1],i[2]],[i[0],i[1],i[2]],[e[0],i[1],i[2]]]}intersects(e){return this.intersectsAabb(e.bounds)?Kg(e,this.getCorners()):0}intersectsFlat(e){return this.intersectsAabb(e.bounds)?Kg(e,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(e,i){return i||this.intersects(e)?qg(e,this.getCorners()):0}intersectsPreciseFlat(e,i){return i||this.intersectsFlat(e)?qg(e,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(e){for(let i=0;i<3;++i)if(this.min[i]>e.max[i]||e.min[i]>this.max[i])return!1;return!0}intersectsAabbXY(e){return!(this.min[0]>e.max[0]||e.min[0]>this.max[0]||this.min[1]>e.max[1]||e.min[1]>this.max[1])}encapsulate(e){for(let i=0;i<3;i++)this.min[i]=Math.min(this.min[i],e.min[i]),this.max[i]=Math.max(this.max[i],e.max[i])}encapsulatePoint(e){for(let i=0;i<3;i++)this.min[i]=Math.min(this.min[i],e[i]),this.max[i]=Math.max(this.max[i],e[i])}closestPoint(e){return[Math.max(Math.min(this.max[0],e[0]),this.min[0]),Math.max(Math.min(this.max[1],e[1]),this.min[1]),Math.max(Math.min(this.max[2],e[2]),this.min[2])]}}mt(ea,"Aabb");const YT=Ii([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:jc}=YT,GT=Ii([{name:"a_pos_3",components:3,type:"Int16"}]);var Zg=Ii([{name:"a_pos",type:"Int16",components:2}]);function Kc(t){return t*V/Ee}const VT=[new ea([re,re,re],[ye,ye,ye]),new ea([re,re,re],[0,0,ye]),new ea([0,re,re],[ye,0,ye]),new ea([re,0,re],[0,ye,ye]),new ea([0,0,re],[ye,ye,ye])];function Xg(t,e,i,o=!0){const l=s.N.scale([],t._camera.position,t.worldSize),r=[e,i,1,1];s.a7.transformMat4(r,r,t.pixelMatrixInverse),s.a7.scale(r,r,1/r[3]);const u=s.N.sub([],r,l),m=s.N.normalize([],u),p=t.globeMatrix,h=[p[12],p[13],p[14]],y=s.N.sub([],h,l),x=s.N.length(y),E=s.N.normalize([],y),S=t.worldSize/(2*Math.PI),C=s.N.dot(E,m),w=Math.asin(S/x);if(w<Math.acos(C)){if(!o)return null;const fe=[],Se=[];s.N.scale(fe,m,x/C),s.N.normalize(Se,s.N.sub(Se,fe,y)),s.N.normalize(m,s.N.add(m,y,s.N.scale(m,Se,Math.tan(w)*x)))}const W=[];new Zf(l,m).closestPointOnSphere(h,S,W);const D=s.N.normalize([],Q(p,0)),Y=s.N.normalize([],Q(p,1)),q=s.N.normalize([],Q(p,2)),K=s.N.dot(D,W),ee=s.N.dot(Y,W),J=s.N.dot(q,W),se=na(Math.asin(-ee/S));let _e=na(Math.atan2(K,J));_e=t.center.lng+function(fe,Se){const De=(Se-fe+180)%360-180;return De<-180?De+360:De}(t.center.lng,_e);const me=jt(_e),be=Vt(Ft(se),0,1);return new mi(me,be)}class jT{constructor(e,i,o){this.a=s.N.sub([],e,o),this.b=s.N.sub([],i,o),this.center=o;const l=s.N.normalize([],this.a),r=s.N.normalize([],this.b);this.angle=Math.acos(s.N.dot(l,r))}}function Qf(t,e){if(t.angle===0)return null;let i;return i=t.a[e]===0?1/t.angle*.5*Math.PI:1/t.angle*Math.atan(t.b[e]/t.a[e]/Math.sin(t.angle)-1/Math.tan(t.angle)),i<0||i>1?null:function(o,l,r,u){const m=Math.sin(r);return o*(Math.sin((1-u)*r)/m)+l*(Math.sin(u*r)/m)}(t.a[e],t.b[e],t.angle,Vt(i,0,1))+t.center[e]}function Kn(t){if(t.z<=1)return VT[t.z+2*t.y+t.x];const e=ep(qc(t));return ea.fromPoints(e)}function Ts(t,e,i){return s.N.scale(t,t,1-i),s.N.scaleAndAdd(t,t,e,i)}function Jg(t,e,i){for(const o of t)s.N.transformMat4(o,o,e),s.N.scale(o,o,i)}function Qg(t,e,i,o){const l=e/t.worldSize,r=t.globeMatrix;if(i.z<=1){const me=Kn(i).getCorners();return Jg(me,r,l),ea.fromPoints(me)}const u=qc(i,o),m=ep(u,V+Kc(t._tileCoverLift));Jg(m,r,l);const p=Number.MAX_VALUE,h=[-p,-p,-p],y=[p,p,p];if(u.contains(t.center)){for(const fe of m)s.N.min(y,y,fe),s.N.max(h,h,fe);h[2]=0;const me=t.point,be=[me.x*l,me.y*l,0];return s.N.min(y,y,be),s.N.max(h,h,be),new ea(y,h)}if(t._tileCoverLift>0){for(const me of m)s.N.min(y,y,me),s.N.max(h,h,me);return new ea(y,h)}const x=[r[12]*l,r[13]*l,r[14]*l],E=u.getCenter(),S=Vt(t.center.lat,-ei,ei),C=Vt(E.lat,-ei,ei),w=jt(t.center.lng),W=Ft(S);let D=w-jt(E.lng);const Y=W-Ft(C);D>.5?D-=1:D<-.5&&(D+=1);let q=0;if(Math.abs(D)>Math.abs(Y))q=D>=0?1:3;else{q=Y>=0?0:2;const me=[r[4]*l,r[5]*l,r[6]*l],be=-Math.sin(Ot(Y>=0?u.getSouth():u.getNorth()))*V;s.N.scaleAndAdd(x,x,me,be)}const K=m[q],ee=m[(q+1)%4],J=new jT(K,ee,x),se=[Qf(J,0)||K[0],Qf(J,1)||K[1],Qf(J,2)||K[2]],_e=Qs(t.zoom);if(_e>0){const me=function({x:fe,y:Se,z:De},Ae,We,xe,Ne){const Qe=1/(1<<De);let Be=fe*Qe,pt=Be+Qe,dt=Se*Qe,ze=dt+Qe,Lt=0;const Et=(Be+pt)/2-xe;return Et>.5?Lt=-1:Et<-.5&&(Lt=1),Be=((Be+Lt)*Ae-(xe*=Ae))*We+xe,pt=((pt+Lt)*Ae-xe)*We+xe,dt=(dt*Ae-(Ne*=Ae))*We+Ne,ze=(ze*Ae-Ne)*We+Ne,[[Be,ze,0],[pt,ze,0],[pt,dt,0],[Be,dt,0]]}(i,e,t._pixelsPerMercatorPixel,w,W);for(let fe=0;fe<m.length;fe++)Ts(m[fe],me[fe],_e);const be=s.N.add([],me[q],me[(q+1)%4]);s.N.scale(be,be,.5),Ts(se,be,_e)}for(const me of m)s.N.min(y,y,me),s.N.max(h,h,me);return y[2]=Math.min(K[2],ee[2]),s.N.min(y,y,se),s.N.max(h,h,se),new ea(y,h)}function qc({x:t,y:e,z:i},o=!1){const l=1/(1<<i),r=new ce(kt(t*l),e===(1<<i)-1&&o?-90:di((e+1)*l)),u=new ce(kt((t+1)*l),e===0&&o?90:di(e*l));return new Te(r,u)}function ep(t,e=V){const i=Ot(t.getNorth()),o=Ot(t.getSouth()),l=Math.cos(i),r=Math.cos(o),u=Math.sin(i),m=Math.sin(o),p=t.getWest(),h=t.getEast();return[ue(r,m,p,e),ue(r,m,h,e),ue(l,u,h,e),ue(l,u,p,e)]}function du(t,e,i,o){const l=1<<i.z,r=(t/st+i.x)/l;return Ie(di((e/st+i.y)/l),kt(r),o)}function $c({min:t,max:e}){return X/Math.max(e[0]-t[0],e[1]-t[1],e[2]-t[2])}const ey=new Float64Array(16);function Zc(t){const e=$c(t),i=s.a6.fromScaling(ey,[e,e,e]);return s.a6.translate(i,i,s.N.negate([],t.min))}function tp(t){const e=s.a6.fromTranslation(ey,t.min),i=1/$c(t);return s.a6.scale(e,e,[i,i,i])}function ip(t){const e=st/(2*Math.PI);return t/(2*Math.PI)/e}function ty(t,e){return st/(512*Math.pow(2,t))*$c(Kn(e))}function iy(t,e,i,o,l){const r=ip(i),u=[t,e,-i/(2*Math.PI)],m=s.a6.identity(new Float64Array(16));return s.a6.translate(m,m,u),s.a6.scale(m,m,[r,r,r]),s.a6.rotateX(m,m,Ot(-l)),s.a6.rotateY(m,m,Ot(-o)),m}function Qs(t){return Lo(Z,z,t)}function ay(t,e){const i=Ie(e.lat,e.lng),o=function(r){const u=Ie(r._center.lat,r._center.lng),m=s.N.fromValues(0,1,0);let p=s.N.cross([],m,u);const h=s.a6.fromRotation([],-r.angle,u);p=s.N.transformMat4(p,p,h),s.a6.fromRotation(h,-r._pitch,p);const y=s.N.normalize([],u);return s.N.scale(y,y,Kc(r.cameraToCenterDistance/r.pixelsPerMeter)),s.N.transformMat4(y,y,h),s.N.add([],u,y)}(t),l=s.N.subtract([],o,i);return s.N.angle(l,i)}function ap(t,e){return ay(t,e)>Math.PI/2*1.01}const oy=Ot(85),KT=Math.cos(oy),qT=Math.sin(oy),$T=s.a6.create(),ny=t=>{const e=[];return t.paint.get("circle-pitch-alignment")==="map"&&e.push("PITCH_WITH_MAP"),t.paint.get("circle-pitch-scale")==="map"&&e.push("SCALE_WITH_MAP"),e};function sy(t,e,i,o,l,r,u,m,p){if(r&&t.queryGeometry.isAboveHorizon)return!1;r&&(p*=t.pixelToTileUnitsFactor);const h=t.tileID.canonical,y=i.projection.upVectorScale(h,i.center.lat,i.worldSize).metersToTile;for(const x of e)for(const E of x){const S=E.add(m),C=l&&i.elevation?i.elevation.exaggeration()*l.getElevationAt(S.x,S.y,!0):0,w=i.projection.projectTilePoint(S.x,S.y,h);if(C>0){const q=i.projection.upVector(h,S.x,S.y);w.x+=q[0]*y*C,w.y+=q[1]*y*C,w.z+=q[2]*y*C}const W=r?S:ZT(w.x,w.y,w.z,o),D=r?t.tilespaceRays.map(q=>JT(q,C)):t.queryGeometry.screenGeometry,Y=s.a7.transformMat4([],[w.x,w.y,w.z,1],o);if(!u&&r?p*=Y[3]/i.cameraToCenterDistance:u&&!r&&(p*=i.cameraToCenterDistance/Y[3]),r){const q=di((E.y/st+h.y)/(1<<h.z));p/=i.projection.pixelsPerMeter(q,1)/zt(1,q)}if(Gn(D,W,p))return!0}return!1}function ZT(t,e,i,o){const l=s.a7.transformMat4([],[t,e,i,1],o);return new qe(l[0]/l[3],l[1]/l[3])}const ly=s.N.fromValues(0,0,0),XT=s.N.fromValues(0,0,1);function JT(t,e){const i=s.N.create();return ly[2]=e,t.intersectsPlane(ly,XT,i),new qe(i[0],i[1])}class ry extends lo{}function dy(t,{width:e,height:i},o,l){if(l){if(l instanceof Uint8ClampedArray)l=new Uint8Array(l.buffer);else if(l.length!==e*i*o)throw new RangeError("mismatched image size")}else l=new Uint8Array(e*i*o);return t.width=e,t.height=i,t.data=l,t}function _y(t,e,i){const{width:o,height:l}=e;o===t.width&&l===t.height||(op(t,e,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,o),height:Math.min(t.height,l)},i),t.width=o,t.height=l,t.data=e.data)}function op(t,e,i,o,l,r,u){if(l.width===0||l.height===0)return e;if(l.width>t.width||l.height>t.height||i.x>t.width-l.width||i.y>t.height-l.height)throw new RangeError("out of range source coordinates for image copy");if(l.width>e.width||l.height>e.height||o.x>e.width-l.width||o.y>e.height-l.height)throw new RangeError("out of range destination coordinates for image copy");const m=t.data,p=e.data,h=r===4&&u;for(let y=0;y<l.height;y++){const x=((i.y+y)*t.width+i.x)*r,E=((o.y+y)*e.width+o.x)*r;if(h)for(let S=0;S<l.width;S++){const C=x+S*r+3,w=E+S*r;p[w+0]=255,p[w+1]=255,p[w+2]=255,p[w+3]=m[C]}else for(let S=0;S<l.width*r;S++)p[E+S]=m[x+S]}return e}mt(ry,"HeatmapBucket",{omit:["layers"]});class el{constructor(e,i){dy(this,e,1,i)}resize(e){_y(this,new el(e),1)}clone(){return new el({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,o,l,r){op(e,i,o,l,r,1)}}class Yo{constructor(e,i){dy(this,e,4,i)}resize(e){_y(this,new Yo(e),4)}replace(e,i){i?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Yo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,o,l,r,u){op(e,i,o,l,r,4,u)}}class uy{constructor(e,i){this.width=e.width,this.height=e.height,this.data=i instanceof Uint8Array?new Float32Array(i.buffer):i}}mt(el,"AlphaImage"),mt(Yo,"RGBAImage");const QT=new $i({visibility:new Xe(ge.layout_heatmap.visibility)});var e2={paint:new $i({"heatmap-radius":new Rt(ge.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Rt(ge.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Xe(ge.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ms(ge.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Xe(ge.paint_heatmap["heatmap-opacity"])}),layout:QT};function _u(t){const e={},i=t.resolution||256,o=t.clips?t.clips.length:1,l=t.image||new Yo({width:i,height:o}),r=(u,m,p)=>{e[t.evaluationKey]=p;const h=t.expression.evaluate(e);h&&(l.data[u+m+0]=Math.floor(255*h.r/h.a),l.data[u+m+1]=Math.floor(255*h.g/h.a),l.data[u+m+2]=Math.floor(255*h.b/h.a),l.data[u+m+3]=Math.floor(255*h.a))};if(t.clips)for(let u=0,m=0;u<o;++u,m+=4*i)for(let p=0,h=0;p<i;p++,h+=4){const y=p/(i-1),{start:x,end:E}=t.clips[u];r(m,h,x*(1-y)+E*y)}else for(let u=0,m=0;u<i;u++,m+=4)r(0,m,u/(i-1));return l}const t2=new $i({visibility:new Xe(ge.layout_hillshade.visibility)});var i2={paint:new $i({"hillshade-illumination-direction":new Xe(ge.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Xe(ge.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Xe(ge.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Xe(ge.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Xe(ge.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Xe(ge.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Xe(ge.paint_hillshade["hillshade-emissive-strength"])}),layout:t2};const a2=Ii([{name:"a_pos",components:2,type:"Int16"}],4),{members:o2}=a2;var np={exports:{}};function Xc(t,e,i){i=i||2;var o,l,r,u,m,p,h,y=e&&e.length,x=y?e[0]*i:t.length,E=cy(t,0,x,i,!0),S=[];if(!E||E.next===E.prev)return S;if(y&&(E=function(w,W,D,Y){var q,K,ee,J=[];for(q=0,K=W.length;q<K;q++)(ee=cy(w,W[q]*Y,q<K-1?W[q+1]*Y:w.length,Y,!1))===ee.next&&(ee.steiner=!0),J.push(c2(ee));for(J.sort(d2),q=0;q<J.length;q++)D=_2(J[q],D);return D}(t,e,E,i)),t.length>80*i){o=r=t[0],l=u=t[1];for(var C=i;C<x;C+=i)(m=t[C])<o&&(o=m),(p=t[C+1])<l&&(l=p),m>r&&(r=m),p>u&&(u=p);h=(h=Math.max(r-o,u-l))!==0?32767/h:0}return uu(E,S,i,o,l,h,0),S}function cy(t,e,i,o,l){var r,u;if(l===rp(t,e,i,o)>0)for(r=e;r<i;r+=o)u=py(r,t[r],t[r+1],u);else for(r=i-o;r>=e;r-=o)u=py(r,t[r],t[r+1],u);return u&&Jc(u,u.next)&&(mu(u),u=u.next),u}function rr(t,e){if(!t)return t;e||(e=t);var i,o=t;do if(i=!1,o.steiner||!Jc(o,o.next)&&Ta(o.prev,o,o.next)!==0)o=o.next;else{if(mu(o),(o=e=o.prev)===o.next)break;i=!0}while(i||o!==e);return e}function uu(t,e,i,o,l,r,u){if(t){!u&&r&&function(y,x,E,S){var C=y;do C.z===0&&(C.z=sp(C.x,C.y,x,E,S)),C.prevZ=C.prev,C.nextZ=C.next,C=C.next;while(C!==y);C.prevZ.nextZ=null,C.prevZ=null,function(w){var W,D,Y,q,K,ee,J,se,_e=1;do{for(D=w,w=null,K=null,ee=0;D;){for(ee++,Y=D,J=0,W=0;W<_e&&(J++,Y=Y.nextZ);W++);for(se=_e;J>0||se>0&&Y;)J!==0&&(se===0||!Y||D.z<=Y.z)?(q=D,D=D.nextZ,J--):(q=Y,Y=Y.nextZ,se--),K?K.nextZ=q:w=q,q.prevZ=K,K=q;D=Y}K.nextZ=null,_e*=2}while(ee>1)}(C)}(t,o,l,r);for(var m,p,h=t;t.prev!==t.next;)if(m=t.prev,p=t.next,r?s2(t,o,l,r):n2(t))e.push(m.i/i|0),e.push(t.i/i|0),e.push(p.i/i|0),mu(t),t=p.next,h=p.next;else if((t=p)===h){u?u===1?uu(t=l2(rr(t),e,i),e,i,o,l,r,2):u===2&&r2(t,e,i,o,l,r):uu(rr(t),e,i,o,l,r,1);break}}}function n2(t){var e=t.prev,i=t,o=t.next;if(Ta(e,i,o)>=0)return!1;for(var l=e.x,r=i.x,u=o.x,m=e.y,p=i.y,h=o.y,y=l<r?l<u?l:u:r<u?r:u,x=m<p?m<h?m:h:p<h?p:h,E=l>r?l>u?l:u:r>u?r:u,S=m>p?m>h?m:h:p>h?p:h,C=o.next;C!==e;){if(C.x>=y&&C.x<=E&&C.y>=x&&C.y<=S&&ad(l,m,r,p,u,h,C.x,C.y)&&Ta(C.prev,C,C.next)>=0)return!1;C=C.next}return!0}function s2(t,e,i,o){var l=t.prev,r=t,u=t.next;if(Ta(l,r,u)>=0)return!1;for(var m=l.x,p=r.x,h=u.x,y=l.y,x=r.y,E=u.y,S=m<p?m<h?m:h:p<h?p:h,C=y<x?y<E?y:E:x<E?x:E,w=m>p?m>h?m:h:p>h?p:h,W=y>x?y>E?y:E:x>E?x:E,D=sp(S,C,e,i,o),Y=sp(w,W,e,i,o),q=t.prevZ,K=t.nextZ;q&&q.z>=D&&K&&K.z<=Y;){if(q.x>=S&&q.x<=w&&q.y>=C&&q.y<=W&&q!==l&&q!==u&&ad(m,y,p,x,h,E,q.x,q.y)&&Ta(q.prev,q,q.next)>=0||(q=q.prevZ,K.x>=S&&K.x<=w&&K.y>=C&&K.y<=W&&K!==l&&K!==u&&ad(m,y,p,x,h,E,K.x,K.y)&&Ta(K.prev,K,K.next)>=0))return!1;K=K.nextZ}for(;q&&q.z>=D;){if(q.x>=S&&q.x<=w&&q.y>=C&&q.y<=W&&q!==l&&q!==u&&ad(m,y,p,x,h,E,q.x,q.y)&&Ta(q.prev,q,q.next)>=0)return!1;q=q.prevZ}for(;K&&K.z<=Y;){if(K.x>=S&&K.x<=w&&K.y>=C&&K.y<=W&&K!==l&&K!==u&&ad(m,y,p,x,h,E,K.x,K.y)&&Ta(K.prev,K,K.next)>=0)return!1;K=K.nextZ}return!0}function l2(t,e,i){var o=t;do{var l=o.prev,r=o.next.next;!Jc(l,r)&&my(l,o,o.next,r)&&cu(l,r)&&cu(r,l)&&(e.push(l.i/i|0),e.push(o.i/i|0),e.push(r.i/i|0),mu(o),mu(o.next),o=t=r),o=o.next}while(o!==t);return rr(o)}function r2(t,e,i,o,l,r){var u=t;do{for(var m=u.next.next;m!==u.prev;){if(u.i!==m.i&&m2(u,m)){var p=fy(u,m);return u=rr(u,u.next),p=rr(p,p.next),uu(u,e,i,o,l,r,0),void uu(p,e,i,o,l,r,0)}m=m.next}u=u.next}while(u!==t)}function d2(t,e){return t.x-e.x}function _2(t,e){var i=function(l,r){var u,m=r,p=l.x,h=l.y,y=-1/0;do{if(h<=m.y&&h>=m.next.y&&m.next.y!==m.y){var x=m.x+(h-m.y)*(m.next.x-m.x)/(m.next.y-m.y);if(x<=p&&x>y&&(y=x,u=m.x<m.next.x?m:m.next,x===p))return u}m=m.next}while(m!==r);if(!u)return null;var E,S=u,C=u.x,w=u.y,W=1/0;m=u;do p>=m.x&&m.x>=C&&p!==m.x&&ad(h<w?p:y,h,C,w,h<w?y:p,h,m.x,m.y)&&(E=Math.abs(h-m.y)/(p-m.x),cu(m,l)&&(E<W||E===W&&(m.x>u.x||m.x===u.x&&u2(u,m)))&&(u=m,W=E)),m=m.next;while(m!==S);return u}(t,e);if(!i)return e;var o=fy(i,t);return rr(o,o.next),rr(i,i.next)}function u2(t,e){return Ta(t.prev,t,e.prev)<0&&Ta(e.next,t,t.next)<0}function sp(t,e,i,o,l){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*l|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-o)*l|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function c2(t){var e=t,i=t;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==t);return i}function ad(t,e,i,o,l,r,u,m){return(l-u)*(e-m)>=(t-u)*(r-m)&&(t-u)*(o-m)>=(i-u)*(e-m)&&(i-u)*(r-m)>=(l-u)*(o-m)}function m2(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(i,o){var l=i;do{if(l.i!==i.i&&l.next.i!==i.i&&l.i!==o.i&&l.next.i!==o.i&&my(l,l.next,i,o))return!0;l=l.next}while(l!==i);return!1}(t,e)&&(cu(t,e)&&cu(e,t)&&function(i,o){var l=i,r=!1,u=(i.x+o.x)/2,m=(i.y+o.y)/2;do l.y>m!=l.next.y>m&&l.next.y!==l.y&&u<(l.next.x-l.x)*(m-l.y)/(l.next.y-l.y)+l.x&&(r=!r),l=l.next;while(l!==i);return r}(t,e)&&(Ta(t.prev,t,e.prev)||Ta(t,e.prev,e))||Jc(t,e)&&Ta(t.prev,t,t.next)>0&&Ta(e.prev,e,e.next)>0)}function Ta(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function Jc(t,e){return t.x===e.x&&t.y===e.y}function my(t,e,i,o){var l=em(Ta(t,e,i)),r=em(Ta(t,e,o)),u=em(Ta(i,o,t)),m=em(Ta(i,o,e));return l!==r&&u!==m||!(l!==0||!Qc(t,i,e))||!(r!==0||!Qc(t,o,e))||!(u!==0||!Qc(i,t,o))||!(m!==0||!Qc(i,e,o))}function Qc(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function em(t){return t>0?1:t<0?-1:0}function cu(t,e){return Ta(t.prev,t,t.next)<0?Ta(t,e,t.next)>=0&&Ta(t,t.prev,e)>=0:Ta(t,e,t.prev)<0||Ta(t,t.next,e)<0}function fy(t,e){var i=new lp(t.i,t.x,t.y),o=new lp(e.i,e.x,e.y),l=t.next,r=e.prev;return t.next=e,e.prev=t,i.next=l,l.prev=i,o.next=i,i.prev=o,r.next=o,o.prev=r,o}function py(t,e,i,o){var l=new lp(t,e,i);return o?(l.next=o.next,l.prev=o,o.next.prev=l,o.next=l):(l.prev=l,l.next=l),l}function mu(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function lp(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function rp(t,e,i,o){for(var l=0,r=e,u=i-o;r<i;r+=o)l+=(t[u]-t[r])*(t[r+1]+t[u+1]),u=r;return l}np.exports=Xc,np.exports.default=Xc,Xc.deviation=function(t,e,i,o){var l=e&&e.length,r=Math.abs(rp(t,0,l?e[0]*i:t.length,i));if(l)for(var u=0,m=e.length;u<m;u++)r-=Math.abs(rp(t,e[u]*i,u<m-1?e[u+1]*i:t.length,i));var p=0;for(u=0;u<o.length;u+=3){var h=o[u]*i,y=o[u+1]*i,x=o[u+2]*i;p+=Math.abs((t[h]-t[x])*(t[y+1]-t[h+1])-(t[h]-t[y])*(t[x+1]-t[h+1]))}return r===0&&p===0?0:Math.abs((p-r)/r)},Xc.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},o=0,l=0;l<t.length;l++){for(var r=0;r<t[l].length;r++)for(var u=0;u<e;u++)i.vertices.push(t[l][r][u]);l>0&&i.holes.push(o+=t[l-1].length)}return i};var tm=bt(np.exports);function dp(t,e){const i=t.length;if(i<=1)return[t];const o=[];let l,r;for(let u=0;u<i;u++){const m=Jn(t[u]);m!==0&&(t[u].area=Math.abs(m),r===void 0&&(r=m<0),r===m<0?(l&&o.push(l),l=[t[u]]):l.push(t[u]))}if(l&&o.push(l),e>1)for(let u=0;u<o.length;u++)o[u].length<=e||(uf(o[u],e,1,o[u].length-1,f2),o[u]=o[u].slice(0,e));return o}function f2(t,e){return e.area-t.area}function _p(t,e,i){const o=i.patternDependencies;let l=!1;for(const r of e){const u=r.paint.get(`${t}-pattern`);u.isConstant()||(l=!0);const m=u.constantOr(null);m&&(l=!0,o[m]=!0)}return l}function up(t,e,i,o,l){const r=l.patternDependencies;for(const u of e){const m=u.paint.get(`${t}-pattern`).value;if(m.kind!=="constant"){let p=m.evaluate({zoom:o},i,{},l.availableImages);p=p&&p.name?p.name:p,r[p]=!0,i.patterns[u.id]=p}}return i}class cp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ko,this.indexArray=new Ia,this.indexArray2=new $o,this.programConfigurations=new U(e.layers,e.zoom),this.segments=new ia,this.segments2=new ia,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.projection=e.projection}populate(e,i,o,l){this.hasPattern=_p("fill",this.layers,i);const r=this.layers[0].layout.get("fill-sort-key"),u=[];for(const{feature:m,id:p,index:h,sourceLayerIndex:y}of e){const x=this.layers[0]._featureFilter.needGeometry,E=ya(m,x);if(!this.layers[0]._featureFilter.filter(new qi(this.zoom),E,o))continue;const S=r?r.evaluate(E,{},o,i.availableImages):void 0,C={id:p,properties:m.properties,type:m.type,sourceLayerIndex:y,index:h,geometry:x?E.geometry:Sa(m,o,l),patterns:{},sortKey:S};u.push(C)}r&&u.sort((m,p)=>m.sortKey-p.sortKey);for(const m of u){const{geometry:p,index:h,sourceLayerIndex:y}=m;if(this.hasPattern){const x=up("fill",this.layers,m,this.zoom,i);this.patternFeatures.push(x)}else this.addFeature(m,p,h,o,{},i.availableImages,i.brightness);i.featureIndex.insert(e[h].feature,p,h,y,this.index)}}update(e,i,o,l,r){const u=Object.keys(e).length!==0;u&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,i,u?this.stateDependentLayers:this.layers,o,l,r)}addFeatures(e,i,o,l,r,u){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,i,o,l,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,o2),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,i,o,l,r,u=[],m){for(const p of dp(i,500)){let h=0;for(const w of p)h+=w.length;const y=this.segments.prepareSegment(h,this.layoutVertexArray,this.indexArray),x=y.vertexLength,E=[],S=[];for(const w of p){if(w.length===0)continue;w!==p[0]&&S.push(E.length/2);const W=this.segments2.prepareSegment(w.length,this.layoutVertexArray,this.indexArray2),D=W.vertexLength;this.layoutVertexArray.emplaceBack(w[0].x,w[0].y),this.indexArray2.emplaceBack(D+w.length-1,D),E.push(w[0].x),E.push(w[0].y);for(let Y=1;Y<w.length;Y++)this.layoutVertexArray.emplaceBack(w[Y].x,w[Y].y),this.indexArray2.emplaceBack(D+Y-1,D+Y),E.push(w[Y].x),E.push(w[Y].y);W.vertexLength+=w.length,W.primitiveLength+=w.length}const C=tm(E,S);for(let w=0;w<C.length;w+=3)this.indexArray.emplaceBack(x+C[w],x+C[w+1],x+C[w+2]);y.vertexLength+=h,y.primitiveLength+=C.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,r,u,l,m)}}mt(cp,"FillBucket",{omit:["layers","patternFeatures"]});const p2=new $i({"fill-sort-key":new Rt(ge.layout_fill["fill-sort-key"]),visibility:new Xe(ge.layout_fill.visibility)});var h2={paint:new $i({"fill-antialias":new Xe(ge.paint_fill["fill-antialias"]),"fill-opacity":new Rt(ge.paint_fill["fill-opacity"]),"fill-color":new Rt(ge.paint_fill["fill-color"]),"fill-outline-color":new Rt(ge.paint_fill["fill-outline-color"]),"fill-translate":new Xe(ge.paint_fill["fill-translate"]),"fill-translate-anchor":new Xe(ge.paint_fill["fill-translate-anchor"]),"fill-pattern":new Rt(ge.paint_fill["fill-pattern"]),"fill-emissive-strength":new Xe(ge.paint_fill["fill-emissive-strength"])}),layout:p2};const g2=Ii([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),y2=Ii([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),b2=Ii([{name:"a_centroid_pos",components:2,type:"Uint16"}]),T2=Ii([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),x2=Ii([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:v2}=g2;var im={},E2=Oi,hy=od;function od(t,e,i,o,l){this.properties={},this.extent=i,this.type=0,this._pbf=t,this._geometry=-1,this._keys=o,this._values=l,t.readFields(A2,this,e)}function A2(t,e,i){t==1?e.id=i.readVarint():t==2?function(o,l){for(var r=o.readVarint()+o.pos;o.pos<r;){var u=l._keys[o.readVarint()],m=l._values[o.readVarint()];l.properties[u]=m}}(i,e):t==3?e.type=i.readVarint():t==4&&(e._geometry=i.pos)}function I2(t){for(var e,i,o=0,l=0,r=t.length,u=r-1;l<r;u=l++)o+=((i=t[u]).x-(e=t[l]).x)*(e.y+i.y);return o}od.types=["Unknown","Point","LineString","Polygon"],od.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,i=t.readVarint()+t.pos,o=1,l=0,r=0,u=0,m=[];t.pos<i;){if(l<=0){var p=t.readVarint();o=7&p,l=p>>3}if(l--,o===1||o===2)r+=t.readSVarint(),u+=t.readSVarint(),o===1&&(e&&m.push(e),e=[]),e.push(new E2(r,u));else{if(o!==7)throw new Error("unknown command "+o);e&&e.push(e[0].clone())}}return e&&m.push(e),m},od.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,i=1,o=0,l=0,r=0,u=1/0,m=-1/0,p=1/0,h=-1/0;t.pos<e;){if(o<=0){var y=t.readVarint();i=7&y,o=y>>3}if(o--,i===1||i===2)(l+=t.readSVarint())<u&&(u=l),l>m&&(m=l),(r+=t.readSVarint())<p&&(p=r),r>h&&(h=r);else if(i!==7)throw new Error("unknown command "+i)}return[u,p,m,h]},od.prototype.toGeoJSON=function(t,e,i){var o,l,r=this.extent*Math.pow(2,i),u=this.extent*t,m=this.extent*e,p=this.loadGeometry(),h=od.types[this.type];function y(S){for(var C=0;C<S.length;C++){var w=S[C];S[C]=[360*(w.x+u)/r-180,360/Math.PI*Math.atan(Math.exp((180-360*(w.y+m)/r)*Math.PI/180))-90]}}switch(this.type){case 1:var x=[];for(o=0;o<p.length;o++)x[o]=p[o][0];y(p=x);break;case 2:for(o=0;o<p.length;o++)y(p[o]);break;case 3:for(p=function(S){var C=S.length;if(C<=1)return[S];for(var w,W,D=[],Y=0;Y<C;Y++){var q=I2(S[Y]);q!==0&&(W===void 0&&(W=q<0),W===q<0?(w&&D.push(w),w=[S[Y]]):w.push(S[Y]))}return w&&D.push(w),D}(p),o=0;o<p.length;o++)for(l=0;l<p[o].length;l++)y(p[o][l])}p.length===1?p=p[0]:h="Multi"+h;var E={type:"Feature",geometry:{type:h,coordinates:p},properties:this.properties};return"id"in this&&(E.id=this.id),E};var O2=hy,gy=yy;function yy(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(S2,this,e),this.length=this._features.length}function S2(t,e,i){t===15?e.version=i.readVarint():t===1?e.name=i.readString():t===5?e.extent=i.readVarint():t===2?e._features.push(i.pos):t===3?e._keys.push(i.readString()):t===4&&e._values.push(function(o){for(var l=null,r=o.readVarint()+o.pos;o.pos<r;){var u=o.readVarint()>>3;l=u===1?o.readString():u===2?o.readFloat():u===3?o.readDouble():u===4?o.readVarint64():u===5?o.readVarint():u===6?o.readSVarint():u===7?o.readBoolean():null}return l}(i))}yy.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new O2(this._pbf,e,this.extent,this._keys,this._values)};var R2=gy;function C2(t,e,i){if(t===3){var o=new R2(i,i.readVarint()+i.pos);o.length&&(e[o.name]=o)}}var mp=im.VectorTile=function(t,e){this.layers=t.readFields(C2,{},e)},am=im.VectorTileFeature=hy;function om(t,e,i,o){const l=[],r=o===0?(u,m,p,h,y,x)=>{u.push(new qe(x,p+(x-m)/(h-m)*(y-p)))}:(u,m,p,h,y,x)=>{u.push(new qe(m+(x-p)/(y-p)*(h-m),x))};for(const u of t){const m=[];for(const p of u){if(p.length<=2)continue;const h=[];for(let E=0;E<p.length-1;E++){const S=p[E].x,C=p[E].y,w=p[E+1].x,W=p[E+1].y,D=o===0?S:C,Y=o===0?w:W;D<e?Y>e&&r(h,S,C,w,W,e):D>i?Y<i&&r(h,S,C,w,W,i):h.push(p[E]),Y<e&&D>=e&&r(h,S,C,w,W,e),Y>i&&D<=i&&r(h,S,C,w,W,i)}let y=p[p.length-1];const x=o===0?y.x:y.y;x>=e&&x<=i&&h.push(y),h.length&&(y=h[h.length-1],h[0].x===y.x&&h[0].y===y.y||h.push(h[0]),m.push(h))}m.length&&l.push(m)}return l}function nm(t,e){return t.x-e.x||t.y-e.y}function by(t,e){return nm(t.min,e.min)===0&&nm(t.max,e.max)===0}function Ty(t,e){return!(t.min.x>e.max.x||t.max.x<e.min.x||t.min.y>e.max.y||t.max.y<e.min.y)}function xy(t,e,i){const o=1/st,l=1/(1<<i.canonical.z),r=(e.x*o+i.canonical.x)*l+i.wrap,u=(e.y*o+i.canonical.y)*l;return{min:new qe((t.x*o+i.canonical.x)*l+i.wrap,(t.y*o+i.canonical.y)*l),max:new qe(r,u)}}function w2(t,e,i){const o=1<<i.canonical.z,l=((e.x-i.wrap)*o-i.canonical.x)*st,r=(e.y*o-i.canonical.y)*st;return{min:new qe(((t.x-i.wrap)*o-i.canonical.x)*st,(t.y*o-i.canonical.y)*st),max:new qe(l,r)}}function vy(t,e,i,o,l,r,u){const m=t.indices,p=t.vertices,h=[];for(let y=o;y<o+l;y+=3){const x=e[i[y+0]+r],E=e[i[y+1]+r],S=e[i[y+2]+r],C=Math.min(x.x,E.x,S.x),w=Math.max(x.x,E.x,S.x),W=Math.min(x.y,E.y,S.y),D=Math.max(x.y,E.y,S.y);h.length=0,t.grid.query(new qe(C,W),new qe(w,D),h);for(let Y=0;Y<h.length;Y++){const q=h[Y];if(Wf(p[m[3*q+0]],p[m[3*q+1]],p[m[3*q+2]],x,E,S,u))return!0}}return!1}function Ey(t,e,i,o){if(!t||!i)return!1;let l=t.vertices;if(!e.canonical.equals(o.canonical)||e.wrap!==o.wrap){if(i.vertices.length<t.vertices.length)return Ey(i,o,t,e);const r=e.canonical,u=o.canonical,m=Math.pow(2,u.z-r.z);l=t.vertices.map(p=>new qe(p.x*r.x*st*m-u.x*st,p.y*r.y*st*m-u.y*st))}return vy(i,l,t.indices,0,t.indices.length,0,0)}im.VectorTileLayer=gy;class Ay{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,i){const o=this.toIdx(e,i);return{min:this.minimums[o],max:this.maximums[o]}}isLeaf(e,i){return this.leaves[this.toIdx(e,i)]}toIdx(e,i){return i*this.size+e}}function Iy(t,e,i,o){let l=0,r=Number.MAX_VALUE;for(let u=0;u<3;u++)if(Math.abs(o[u])<1e-15){if(i[u]<t[u]||i[u]>e[u])return null}else{const m=1/o[u];let p=(t[u]-i[u])*m,h=(e[u]-i[u])*m;if(p>h){const y=p;p=h,h=y}if(p>l&&(l=p),h<r&&(r=h),l>r)return null}return l}function Oy(t,e,i,o,l,r,u,m,p,h,y){const x=o-t,E=l-e,S=r-i,C=u-t,w=m-e,W=p-i,D=y[1]*W-y[2]*w,Y=y[2]*C-y[0]*W,q=y[0]*w-y[1]*C,K=x*D+E*Y+S*q;if(Math.abs(K)<1e-15)return null;const ee=1/K,J=h[0]-t,se=h[1]-e,_e=h[2]-i,me=(J*D+se*Y+_e*q)*ee;if(me<0||me>1)return null;const be=se*S-_e*E,fe=_e*x-J*S,Se=J*E-se*x,De=(y[0]*be+y[1]*fe+y[2]*Se)*ee;return De<0||me+De>1?null:(C*be+w*fe+W*Se)*ee}function Sy(t,e,i){return(t-e)/(i-e)}function Ry(t,e,i,o,l,r,u,m,p){const h=1<<i,y=r-o,x=u-l,E=(t+1)/h*y+o,S=(e+0)/h*x+l,C=(e+1)/h*x+l;m[0]=(t+0)/h*y+o,m[1]=S,p[0]=E,p[1]=C}class Cy{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const i=function(r){const u=Math.ceil(Math.log2(r.dim/8)),m=[];let p=Math.ceil(Math.pow(2,u));const h=1/p,y=(S,C,w,W,D)=>{const Y=W?1:0,q=(S+1)*w-Y,K=C*w,ee=(C+1)*w-Y;D[0]=S*w,D[1]=K,D[2]=q,D[3]=ee};let x=new Ay(p);const E=[];for(let S=0;S<p*p;S++){y(S%p,Math.floor(S/p),h,!1,E);const C=tl(E[0],E[1],r),w=tl(E[2],E[1],r),W=tl(E[2],E[3],r),D=tl(E[0],E[3],r);x.minimums.push(Math.min(C,w,W,D)),x.maximums.push(Math.max(C,w,W,D)),x.leaves.push(1)}for(m.push(x),p/=2;p>=1;p/=2){const S=m[m.length-1];x=new Ay(p);for(let C=0;C<p*p;C++){y(C%p,Math.floor(C/p),2,!0,E);const w=S.getElevation(E[0],E[1]),W=S.getElevation(E[2],E[1]),D=S.getElevation(E[2],E[3]),Y=S.getElevation(E[0],E[3]),q=S.isLeaf(E[0],E[1]),K=S.isLeaf(E[2],E[1]),ee=S.isLeaf(E[2],E[3]),J=S.isLeaf(E[0],E[3]),se=Math.min(w.min,W.min,D.min,Y.min),_e=Math.max(w.max,W.max,D.max,Y.max),me=q&&K&&ee&&J;x.maximums.push(_e),x.minimums.push(se),x.leaves.push(_e-se<=5&&me?1:0)}m.push(x)}return m}(this.dem),o=i.length-1,l=i[o];this._addNode(l.minimums[0],l.maximums[0],l.leaves[0]),this._construct(i,0,0,o,0)}raycastRoot(e,i,o,l,r,u,m=1){return Iy([e,i,-100],[o,l,this.maximums[0]*m],r,u)}raycast(e,i,o,l,r,u,m=1){if(!this.nodeCount)return null;const p=this.raycastRoot(e,i,o,l,r,u,m);if(p==null)return null;const h=[],y=[],x=[],E=[],S=[{idx:0,t:p,nodex:0,nodey:0,depth:0}];for(;S.length>0;){const{idx:C,t:w,nodex:W,nodey:D,depth:Y}=S.pop();if(this.leaves[C]){Ry(W,D,Y,e,i,o,l,x,E);const K=1<<Y,ee=(W+0)/K,J=(W+1)/K,se=(D+0)/K,_e=(D+1)/K,me=tl(ee,se,this.dem)*m,be=tl(J,se,this.dem)*m,fe=tl(J,_e,this.dem)*m,Se=tl(ee,_e,this.dem)*m,De=Oy(x[0],x[1],me,E[0],x[1],be,E[0],E[1],fe,r,u),Ae=Oy(E[0],E[1],fe,x[0],E[1],Se,x[0],x[1],me,r,u),We=Math.min(De!==null?De:Number.MAX_VALUE,Ae!==null?Ae:Number.MAX_VALUE);if(We!==Number.MAX_VALUE)return We;{const xe=s.N.scaleAndAdd([],r,u,w);if(wy(me,be,Se,fe,Sy(xe[0],x[0],E[0]),Sy(xe[1],x[1],E[1]))>=xe[2])return w}continue}let q=0;for(let K=0;K<this._siblingOffset.length;K++){Ry((W<<1)+this._siblingOffset[K][0],(D<<1)+this._siblingOffset[K][1],Y+1,e,i,o,l,x,E),x[2]=-100,E[2]=this.maximums[this.childOffsets[C]+K]*m;const ee=Iy(x,E,r,u);if(ee!=null){const J=ee;h[K]=J;let se=!1;for(let _e=0;_e<q&&!se;_e++)J>=h[y[_e]]&&(y.splice(_e,0,K),se=!0);se||(y[q]=K),q++}}for(let K=0;K<q;K++){const ee=y[K];S.push({idx:this.childOffsets[C]+ee,t:h[ee],nodex:(W<<1)+this._siblingOffset[ee][0],nodey:(D<<1)+this._siblingOffset[ee][1],depth:Y+1})}}return null}_addNode(e,i,o){return this.minimums.push(e),this.maximums.push(i),this.leaves.push(o),this.childOffsets.push(0),this.nodeCount++}_construct(e,i,o,l,r){if(e[l].isLeaf(i,o)===1)return;this.childOffsets[r]||(this.childOffsets[r]=this.nodeCount);const u=l-1,m=e[u];let p=0,h=0;for(let y=0;y<this._siblingOffset.length;y++){const x=2*i+this._siblingOffset[y][0],E=2*o+this._siblingOffset[y][1],S=m.getElevation(x,E),C=m.isLeaf(x,E),w=this._addNode(S.min,S.max,C);C&&(p|=1<<y),h||(h=w)}for(let y=0;y<this._siblingOffset.length;y++)p&1<<y||this._construct(e,2*i+this._siblingOffset[y][0],2*o+this._siblingOffset[y][1],u,h+y)}}function wy(t,e,i,o,l,r){return si(si(t,i,r),si(e,o,r),l)}function tl(t,e,i){const o=i.dim,l=Vt(t*o-.5,0,o-1),r=Vt(e*o-.5,0,o-1),u=Math.floor(l),m=Math.floor(r),p=Math.min(u+1,o-1),h=Math.min(m+1,o-1);return wy(i.get(u,m),i.get(p,m),i.get(u,h),i.get(p,h),l-u,r-m)}const P2={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function L2(t,e,i){return(256*t*256+256*e+i)/10-1e4}function N2(t,e,i){return 256*t+e+i/256-32768}class sm{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,i,o,l=!1){if(this.uid=e,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(o&&o!=="mapbox"&&o!=="terrarium")return ta(`"${o}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=i.height;const r=this.dim=i.height-2,u=new Uint32Array(i.data.buffer);if(this.pixels=new Uint8Array(i.data.buffer),this.floatView=new Float32Array(i.data.buffer),this.borderReady=l,this._modifiedForSources={},!l){for(let p=0;p<r;p++)u[this._idx(-1,p)]=u[this._idx(0,p)],u[this._idx(r,p)]=u[this._idx(r-1,p)],u[this._idx(p,-1)]=u[this._idx(p,0)],u[this._idx(p,r)]=u[this._idx(p,r-1)];u[this._idx(-1,-1)]=u[this._idx(0,0)],u[this._idx(r,-1)]=u[this._idx(r-1,0)],u[this._idx(-1,r)]=u[this._idx(0,r-1)],u[this._idx(r,r)]=u[this._idx(r-1,r-1)]}const m=o==="terrarium"?N2:L2;for(let p=0;p<u.length;++p){const h=4*p;this.floatView[p]=m(this.pixels[h],this.pixels[h+1],this.pixels[h+2])}this._timestamp=Ge.now()}_buildQuadTree(){this._tree=new Cy(this)}get(e,i,o=!1){o&&(e=Vt(e,-1,this.dim),i=Vt(i,-1,this.dim));const l=this._idx(e,i);return this.floatView[l]}set(e,i,o){const l=this._idx(e,i),r=this.floatView[l];return this.floatView[l]=o,o-r}static getUnpackVector(e){return P2[e]}_idx(e,i){if(e<-1||e>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(e+1)}static pack(e,i){const o=[0,0,0,0],l=sm.getUnpackVector(i);let r=Math.floor((e+l[3])/l[2]);return o[2]=r%256,r=Math.floor(r/256),o[1]=r%256,r=Math.floor(r/256),o[0]=r,o}getPixels(){return new uy({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,i,o){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let l=i*this.dim,r=i*this.dim+this.dim,u=o*this.dim,m=o*this.dim+this.dim;switch(i){case-1:l=r-1;break;case 1:r=l+1}switch(o){case-1:u=m-1;break;case 1:m=u+1}const p=-i*this.dim,h=-o*this.dim;for(let y=u;y<m;y++)for(let x=l;x<r;x++){const E=4*this._idx(x,y),S=4*this._idx(x+p,y+h);this.pixels[E+0]=e.pixels[S+0],this.pixels[E+1]=e.pixels[S+1],this.pixels[E+2]=e.pixels[S+2],this.pixels[E+3]=e.pixels[S+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}mt(sm,"DEMData"),mt(Cy,"DemMinMaxQuadTree",{omit:["dem"]});class nd{constructor(e,i,o){this._demTile=e,this._dem=this._demTile.dem,this._scale=i,this._offset=o}static create(e,i,o){const l=o||e.findDEMTileFor(i);if(!l||!l.dem)return;const r=l.dem,u=l.tileID,m=1<<i.canonical.z-u.canonical.z;return new nd(l,r.dim/st/m,[(i.canonical.x/m-u.canonical.x)*r.dim,(i.canonical.y/m-u.canonical.y)*r.dim])}tileCoordToPixel(e,i){const o=i*this._scale+this._offset[1],l=Math.floor(e*this._scale+this._offset[0]),r=Math.floor(o);return new qe(l,r)}getElevationAt(e,i,o,l){const r=e*this._scale+this._offset[0],u=i*this._scale+this._offset[1],m=Math.floor(r),p=Math.floor(u),h=this._dem;return l=!!l,o?si(si(h.get(m,p,l),h.get(m,p+1,l),u-p),si(h.get(m+1,p,l),h.get(m+1,p+1,l),u-p),r-m):h.get(m,p,l)}getElevationAtPixel(e,i,o){return this._dem.get(e,i,!!o)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*zt(1,e)*this._dem.stride}}const W2=am.types,M2=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius"],D2=["fill-extrusion-flood-light-ground-radius"],F2=Math.pow(2,13),B2=Math.pow(2,15)-1,Py=new qe(0,1),il=2147483648;function fu(t,e,i,o,l,r,u,m){t.emplaceBack((e<<1)+u,(i<<1)+r,(Math.floor(o*F2)<<1)+l,Math.round(m))}function lm(t,e,i,o,l,r){t.emplaceBack(e.x,e.y,(i.x<<1)+o,(i.y<<1)+l,r)}function pu(t,e,i){t.emplaceBack(e.x,e.y,e.z,i[0]*16384,i[1]*16384,i[2]*16384)}class Ly{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class Ny{constructor(){this.centroidXY=new qe(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new qe(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new qe(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new qe(this.max.x-this.min.x,this.max.y-this.min.y)}}class Wy{constructor(){this.acc=new qe(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(e,i){e.min.x===Number.MAX_VALUE&&(e.min.x=e.max.x=i.x,e.min.y=e.max.y=i.y)}appendEdge(e,i,o){this.accCount++,this.acc._add(i);let l=!!this.borders;i.x<e.min.x?(e.min.x=i.x,l=!0):i.x>e.max.x&&(e.max.x=i.x,l=!0),i.y<e.min.y?(e.min.y=i.y,l=!0):i.y>e.max.y&&(e.max.y=i.y,l=!0),((i.x===0||i.x===st)&&i.x===o.x)!=((i.y===0||i.y===st)&&i.y===o.y)&&this.processBorderOverlap(i,o),l&&this.checkBorderIntersection(i,o)}checkBorderIntersection(e,i){i.x<0!=e.x<0&&this.addBorderIntersection(0,si(i.y,e.y,(0-i.x)/(e.x-i.x))),i.x>st!=e.x>st&&this.addBorderIntersection(1,si(i.y,e.y,(st-i.x)/(e.x-i.x))),i.y<0!=e.y<0&&this.addBorderIntersection(2,si(i.x,e.x,(0-i.y)/(e.y-i.y))),i.y>st!=e.y>st&&this.addBorderIntersection(3,si(i.x,e.x,(st-i.y)/(e.y-i.y)))}addBorderIntersection(e,i){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const o=this.borders[e];i<o[0]&&(o[0]=i),i>o[1]&&(o[1]=i)}processBorderOverlap(e,i){if(e.x===i.x){if(e.y===i.y)return;const o=e.x===0?0:1;this.addBorderIntersection(o,i.y),this.addBorderIntersection(o,e.y)}else{const o=e.y===0?2:3;this.addBorderIntersection(o,i.x),this.addBorderIntersection(o,e.x)}}centroid(){return this.accCount===0?new qe(0,0):new qe(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((e,i)=>e+ +(i[0]!==Number.MAX_VALUE),0):0}}function My(t,e){const i=t.add(e)._unit(),o=Vt(t.x*i.x+t.y*i.y,-1,1);var l,r,u;return l=Math.acos(o),Math.min(4,Math.max(-4,Math.tan(l)))/4*B2*((r=t).x*(u=e).y-r.y*u.x<0?-1:1)}const U2=[t=>t.x<0,t=>t.x>st,t=>t.y<0,t=>t.y>st];function k2(t,e,i,o){const l=[4];if(o===0)return l;i._mult(o);const r=t.sub(i),u=e.sub(i),m=[t,e,r,u];for(let p=0;p<4;p++)for(const h of m)if(U2[p](h)){l.push(p);break}return l}class Dy{constructor(e){this.vertexArray=new K_,this.indexArray=new Ia,this.programConfigurations=new U(e.layers,e.zoom,i=>D2.includes(i)),this._segments=new ia,this.hiddenByLandmarkVertexArray=new iu,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new ia}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(e,i,o,l=!1){const r=e.length;if(r>2){let u=Math.max(0,this._segments.get().length-1);const m=this._segments._prepareSegment(4*r,this.vertexArray.length,2*this._segmentToGroundQuads[u].length);let p;u!==this._segments.get().length-1&&(u++,this._segmentToGroundQuads[u]=[],this._segmentToRegionTriCounts[u]=[0,0,0,0,0]);{const h=e[0],y=e[1];p=My(h.sub(e[r-1])._perp()._unit(),y.sub(h)._perp()._unit())}for(let h=0;h<r;h++){const y=h===r-1?0:h+1,x=e[h],E=e[y],S=e[y===r-1?0:y+1],C=E.sub(x)._perp()._unit(),w=My(C,S.sub(E)._perp()._unit()),W=p,D=w;if(fp(x,E,i)||l&&Uy(x,i)&&Uy(E,i)){p=w;continue}const Y=m.vertexLength;lm(this.vertexArray,x,E,1,1,W),lm(this.vertexArray,x,E,1,0,W),lm(this.vertexArray,x,E,0,1,D),lm(this.vertexArray,x,E,0,0,D),m.vertexLength+=4;const q=k2(x,E,C,o);for(const K of q)this._segmentToGroundQuads[u].push({id:Y,region:K}),this._segmentToRegionTriCounts[u][K]+=2,m.primitiveLength+=2;p=w}}}prepareBorderSegments(){if(!this.hasData())return;const e=this._segments.get(),i=e.length;for(let o=0;o<i;o++)this._segmentToGroundQuads[o].sort((l,r)=>l.region-r.region);for(let o=0;o<i;o++){const l=this._segmentToGroundQuads[o],r=e[o],u=this._segmentToRegionTriCounts[o];u.reduce((p,h)=>p+h,0);let m=0;for(let p=0;p<=4;p++){const h=u[p];if(h!==0){let y=this.regionSegments[p];y||(y=this.regionSegments[p]=new ia);const x={vertexOffset:r.vertexOffset,primitiveOffset:r.primitiveOffset+m,vertexLength:r.vertexLength,primitiveLength:h};y.get().push(x)}m+=h}for(let p=0;p<l.length;p++){const h=l[p].id;this.indexArray.emplaceBack(h,h+1,h+3),this.indexArray.emplaceBack(h,h+3,h+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(e,i,o,l,r,u){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,e,i,o,l,r,u)}upload(e){this.hasData()&&(this.vertexBuffer=e.createVertexBuffer(this.vertexArray,y2.members),this.indexBuffer=e.createIndexBuffer(this.indexArray))}uploadPaintProperties(e){this.hasData()&&this.programConfigurations.upload(e)}update(e,i,o,l,r,u){this.hasData()&&this.programConfigurations.updatePaintArrays(e,i,o,l,r,u)}updateHiddenByLandmark(e){if(!this.hasData())return;const i=e.groundVertexCount+e.groundVertexArrayOffset;if(e.groundVertexCount===0)return;const o=e.flags&il?1:0;for(let l=e.groundVertexArrayOffset;l<i;++l)this.hiddenByLandmarkVertexArray.emplace(l,o);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(e){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=e.createVertexBuffer(this.hiddenByLandmarkVertexArray,T2.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let e=0;e<=4;e++){const i=this.regionSegments[e];i&&i.destroy()}}}}class rm{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Ia,this.footprintVertices=new ko,this.footprintSegments=[],this.layoutVertexArray=new dn,this.centroidVertexArray=new er,this.indexArray=new Ia,this.programConfigurations=new U(e.layers,e.zoom,i=>M2.includes(i)),this.segments=new ia,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.groundEffect=new Dy(e),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}populate(e,i,o,l){this.features=[],this.hasPattern=_p("fill-extrusion",this.layers,i),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=ii(o),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:r,id:u,index:m,sourceLayerIndex:p}of e){const h=this.layers[0]._featureFilter.needGeometry,y=ya(r,h);if(!this.layers[0]._featureFilter.filter(new qi(this.zoom),y,o))continue;const x={id:u,sourceLayerIndex:p,index:m,geometry:h?y.geometry:Sa(r,o,l),properties:r.properties,type:r.type,patterns:{}},E=this.layoutVertexArray.length;this.hasPattern?this.features.push(up("fill-extrusion",this.layers,x,this.zoom,i)):this.addFeature(x,x.geometry,m,o,{},i.availableImages,l,i.brightness),i.featureIndex.insert(r,x.geometry,m,p,this.index,E)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(e,i,o,l,r,u){for(const m of this.features){const{geometry:p}=m;this.addFeature(m,p,m.index,i,o,l,r,u)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(e,i,o,l,r){const u=Object.keys(e).length!==0;if(u&&!this.stateDependentLayers.length)return;const m=u?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(e,i,m,o,l,r),this.groundEffect.update(e,i,m,o,l,r)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,v2),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,x2.members,!0)),this.groundEffect.upload(e)),this.groundEffect.uploadPaintProperties(e),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.groundEffect.uploadHiddenByLandmark(e),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,b2.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,i,o,l,r,u,m,p){const h=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(e,{})/this.tileToMeter,y=[new qe(0,0),new qe(st,st)],x=m.projection,E=x.name==="globe",S=W2[e.type]==="Polygon",C=new Wy;C.centroidDataIndex=this.centroidData.length;const w=new Ny,W=this.layers[0].paint.get("fill-extrusion-base").evaluate(e,{},l)<=0,D=this.layers[0].paint.get("fill-extrusion-height").evaluate(e,{},l);w.height=D,w.vertexArrayOffset=this.layoutVertexArray.length,w.groundVertexArrayOffset=this.groundEffect.vertexArray.length,E&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new qr);const Y=dp(i,500);for(let _e=Y.length-1;_e>=0;_e--){const me=Y[_e];(me.length===0||(q=me[0]).every(be=>be.x<=0)||q.every(be=>be.x>=st)||q.every(be=>be.y<=0)||q.every(be=>be.y>=st))&&Y.splice(_e,1)}var q;let K;if(E)K=Yy(Y,y,l);else{K=[];for(const _e of Y)K.push({polygon:_e,bounds:y})}const ee=S?this.edgeRadius:0,J=ee>0&&this.zoom<17,se=(_e,me)=>{if(_e.length===0)return!1;const be=_e[_e.length-1];return me.x===be.x&&me.y===be.y};for(const{polygon:_e,bounds:me}of K){let be=0,fe=0;for(const We of _e)S&&!We[0].equals(We[We.length-1])&&We.push(We[0]),fe+=S?We.length-1:We.length;const Se=this.segments.prepareSegment((S?5:4)*fe,this.layoutVertexArray,this.indexArray);w.footprintSegIdx<0&&(w.footprintSegIdx=this.footprintSegments.length),w.polygonSegIdx<0&&(w.polygonSegIdx=this.polygonSegments.length);const De={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Ae=new Ly;if(Ae.vertexOffset=this.footprintVertices.length,Ae.indexOffset=3*this.footprintIndices.length,Ae.ringIndices=[],S){const We=[],xe=[];be=Se.vertexLength;for(let Qe=0;Qe<_e.length;Qe++){const Be=_e[Qe];Be.length&&Qe!==0&&xe.push(We.length/2);const pt=[];let dt,ze;dt=Be[1].sub(Be[0])._perp()._unit(),Ae.ringIndices.push(Be.length-1);for(let Lt=1;Lt<Be.length;Lt++){const Et=Be[Lt],ft=Be[Lt===Be.length-1?1:Lt+1],He=Et.clone();if(ee){ze=ft.sub(Et)._perp()._unit();const Ct=dt.add(ze)._unit(),$t=ee*Math.min(4,1/(dt.x*Ct.x+dt.y*Ct.y));He.x+=$t*Ct.x,He.y+=$t*Ct.y,He.x=Math.round(He.x),He.y=Math.round(He.y),dt=ze}!W||ee!==0&&!J||se(pt,He)||pt.push(He),fu(this.layoutVertexArray,He.x,He.y,0,0,1,1,0),Se.vertexLength++,this.footprintVertices.emplaceBack(Et.x,Et.y),We.push(Et.x,Et.y),E&&pu(this.layoutVertexExtArray,x.projectTilePoint(He.x,He.y,l),x.upVector(l,He.x,He.y))}W&&(ee===0||J)&&(pt.length!==0&&se(pt,pt[0])&&pt.pop(),this.groundEffect.addData(pt,me,h))}const Ne=tm(We,xe);for(let Qe=0;Qe<Ne.length;Qe+=3)this.footprintIndices.emplaceBack(Ae.vertexOffset+Ne[Qe+0],Ae.vertexOffset+Ne[Qe+1],Ae.vertexOffset+Ne[Qe+2]),this.indexArray.emplaceBack(be+Ne[Qe],be+Ne[Qe+2],be+Ne[Qe+1]),Se.primitiveLength++;Ae.indexCount+=Ne.length,Ae.vertexCount+=this.footprintVertices.length-Ae.vertexOffset}for(let We=0;We<_e.length;We++){const xe=_e[We];C.startRing(w,xe[0]);let Ne=xe.length>4&&ky(xe[xe.length-2],xe[0],xe[1]),Qe=ee?z2(xe[xe.length-2],xe[0],xe[1],ee):0;const Be=[];let pt,dt,ze;dt=xe[1].sub(xe[0])._perp()._unit();let Lt=!0;for(let Et=1,ft=0;Et<xe.length;Et++){let He=xe[Et-1],Ct=xe[Et];const $t=xe[Et===xe.length-1?1:Et+1];if(C.appendEdge(w,Ct,He),fp(Ct,He,me)){ee&&(dt=$t.sub(Ct)._perp()._unit(),Lt=!Lt);continue}const Wt=Ct.sub(He)._perp(),Zt=Wt.x/(Math.abs(Wt.x)+Math.abs(Wt.y)),Ut=Wt.y>0?1:0,li=He.dist(Ct);if(ft+li>32768&&(ft=0),ee){ze=$t.sub(Ct)._perp()._unit();let gi=By(He,Ct,$t,Fy(dt,ze),ee);isNaN(gi)&&(gi=0);const Ei=Ct.sub(He)._unit();He=He.add(Ei.mult(Qe))._round(),Ct=Ct.add(Ei.mult(-gi))._round(),Qe=gi,dt=ze,W&&this.zoom>=17&&(se(Be,He)||Be.push(He),se(Be,Ct)||Be.push(Ct))}const Ht=Se.vertexLength,Ni=xe.length>4&&ky(He,Ct,$t);let pi=zy(ft,Ne,Lt);if(fu(this.layoutVertexArray,He.x,He.y,Zt,Ut,0,0,pi),fu(this.layoutVertexArray,He.x,He.y,Zt,Ut,0,1,pi),ft+=li,pi=zy(ft,Ni,!Lt),Ne=Ni,fu(this.layoutVertexArray,Ct.x,Ct.y,Zt,Ut,0,0,pi),fu(this.layoutVertexArray,Ct.x,Ct.y,Zt,Ut,0,1,pi),Se.vertexLength+=4,this.indexArray.emplaceBack(Ht+0,Ht+1,Ht+2),this.indexArray.emplaceBack(Ht+1,Ht+3,Ht+2),Se.primitiveLength+=2,ee){const gi=be+(Et===1?xe.length-2:Et-2),Ei=Et===1?be:gi+1;if(this.indexArray.emplaceBack(Ht+1,gi,Ht+3),this.indexArray.emplaceBack(gi,Ei,Ht+3),Se.primitiveLength+=2,pt===void 0&&(pt=Ht),!fp($t,xe[Et],me)){const hi=Et===xe.length-1?pt:Se.vertexLength;this.indexArray.emplaceBack(Ht+2,Ht+3,hi),this.indexArray.emplaceBack(Ht+3,hi+1,hi),this.indexArray.emplaceBack(Ht+3,Ei,hi+1),Se.primitiveLength+=3}Lt=!Lt}if(E){const gi=this.layoutVertexExtArray,Ei=x.projectTilePoint(He.x,He.y,l),hi=x.projectTilePoint(Ct.x,Ct.y,l),Ki=x.upVector(l,He.x,He.y),Ri=x.upVector(l,Ct.x,Ct.y);pu(gi,Ei,Ki),pu(gi,Ei,Ki),pu(gi,hi,Ri),pu(gi,hi,Ri)}}S&&(be+=xe.length-1),W&&ee&&this.zoom>=17&&(Be.length!==0&&se(Be,Be[0])&&Be.pop(),this.groundEffect.addData(Be,me,h,ee>0))}this.footprintSegments.push(Ae),De.triangleCount=this.indexArray.length-De.triangleArrayOffset,this.polygonSegments.push(De),++w.footprintSegLen,++w.polygonSegLen}if(w.vertexCount=this.layoutVertexArray.length-w.vertexArrayOffset,w.groundVertexCount=this.groundEffect.vertexArray.length-w.groundVertexArrayOffset,w.vertexCount!==0){if(w.centroidXY=C.borders?Py:this.encodeCentroid(C,w),this.centroidData.push(w),C.borders){this.featuresOnBorder.push(C);const _e=this.featuresOnBorder.length-1;for(let me=0;me<C.borders.length;me++)C.borders[me][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[me].push(_e)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,r,u,l,p),this.groundEffect.addPaintPropertiesData(e,o,r,u,l,p),this.maxHeight=Math.max(this.maxHeight,D)}}sortBorders(){for(let e=0;e<this.borderFeatureIndices.length;e++)this.borderFeatureIndices[e].sort((i,o)=>this.featuresOnBorder[i].borders[e][0]-this.featuresOnBorder[o].borders[e][0])}splitToSubtiles(){const e=[];for(let m=0;m<this.centroidData.length;m++){const p=this.centroidData[m],h=+(p.min.y+p.max.y>st),y=2*h+(+(p.min.x+p.max.x>st)^h);for(let x=0;x<p.polygonSegLen;x++){const E=p.polygonSegIdx+x;e.push({centroidIdx:m,subtile:y,polygonSegmentIdx:E,triangleSegmentIdx:this.polygonSegments[E].triangleSegIdx})}}const i=new Ia;e.sort((m,p)=>m.triangleSegmentIdx===p.triangleSegmentIdx?m.subtile-p.subtile:m.triangleSegmentIdx-p.triangleSegmentIdx);let o=0,l=0,r=0;for(const m of e){if(m.triangleSegmentIdx!==o)break;r++}const u=e.length;for(;l!==e.length;){o=e[l].triangleSegmentIdx;let m=0,p=l,h=l;for(let y=p;y<r&&e[y].subtile===m;y++)h++;for(;p!==r;){const y=e[p];m=y.subtile;const x=this.centroidData[y.centroidIdx].min.clone(),E=this.centroidData[y.centroidIdx].max.clone(),S={vertexOffset:this.segments.segments[o].vertexOffset,primitiveOffset:i.length,vertexLength:this.segments.segments[o].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let C=p;C<h;C++){const w=e[C],W=this.polygonSegments[w.polygonSegmentIdx],D=this.centroidData[w.centroidIdx].min,Y=this.centroidData[w.centroidIdx].max,q=this.indexArray.uint16;for(let K=W.triangleArrayOffset;K<W.triangleArrayOffset+W.triangleCount;K++)i.emplaceBack(q[3*K],q[3*K+1],q[3*K+2]);S.primitiveLength+=W.triangleCount,x.x=Math.min(x.x,D.x),x.y=Math.min(x.y,D.y),E.x=Math.max(E.x,Y.x),E.y=Math.max(E.y,Y.y)}S.primitiveLength>0&&this.triangleSubSegments.push({segment:S,min:x,max:E}),p=h;for(let C=p;C<r&&e[C].subtile===e[p].subtile;C++)h++}l=r;for(let y=l;y<u&&e[y].triangleSegmentIdx===e[l].triangleSegmentIdx;y++)r++}i._trim(),this.indexArray=i}getVisibleSegments(e,i,o){let l=0,r=0;const u=1<<e.canonical.z;if(i){const w=i.getMinMaxForTile(e);w&&(l=w.min,r=w.max)}r+=this.maxHeight;const m=e.toUnwrapped();let p;const h=[m.canonical.x/u+m.wrap,m.canonical.y/u],y=[(m.canonical.x+1)/u+m.wrap,(m.canonical.y+1)/u],x=new ia,E=(w,W,D)=>[w[0]*(1-D[0])+W[0]*D[0],w[1]*(1-D[1])+W[1]*D[1]],S=[],C=[];for(const w of this.triangleSubSegments){S[0]=w.min.x/st,S[1]=w.min.y/st,C[0]=w.max.x/st,C[1]=w.max.y/st;const W=E(h,y,S),D=E(h,y,C);if(new ea([W[0],W[1],l],[D[0],D[1],r]).intersectsPrecise(o)===0){p&&(x.segments.push(p),p=void 0);continue}const Y=w.segment;p&&p.vertexOffset!==Y.vertexOffset&&(x.segments.push(p),p=void 0),p?(p.vertexLength+=Y.vertexLength,p.primitiveLength+=Y.primitiveLength):p={vertexOffset:Y.vertexOffset,primitiveLength:Y.primitiveLength,vertexLength:Y.vertexLength,primitiveOffset:Y.primitiveOffset,sortKey:void 0,vaos:{}}}return p&&x.segments.push(p),x}encodeCentroid(e,i){const o=e.centroid(),l=i.span(),r=Math.min(7,Math.round(l.x*this.tileToMeter/10)),u=Math.min(7,Math.round(l.y*this.tileToMeter/10));return new qe(Vt(o.x,1,st-1)<<3|r,Vt(o.y,1,st-1)<<3|u)}encodeBorderCentroid(e){if(!e.borders)return new qe(0,0);const i=e.borders,o=Number.MAX_VALUE;if(i[0][0]!==o||i[1][0]!==o){const l=i[0][0]!==o?0:1;return new qe(6|(i[0][0]!==o?0:65528),(i[l][0]+i[l][1])/2<<3|6)}{const l=i[2][0]!==o?2:3;return new qe((i[l][0]+i[l][1])/2<<3|6,6|(i[2][0]!==o?0:65528))}}showCentroid(e){const i=this.centroidData[e.centroidDataIndex];i.flags&=il,i.centroidXY.x=0,i.centroidXY.y=0,this.writeCentroidToBuffer(i)}writeCentroidToBuffer(e){this.groundEffect.updateHiddenByLandmark(e);const i=e.vertexArrayOffset,o=e.vertexCount+e.vertexArrayOffset,l=e.flags&il?Py:e.centroidXY,r=this.centroidVertexArray.geta_centroid_pos0(i);if(this.centroidVertexArray.geta_centroid_pos1(i)!==l.y||r!==l.x){for(let u=i;u<o;++u)this.centroidVertexArray.emplace(u,l.x,l.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const e of this.centroidData)this.writeCentroidToBuffer(e)}updateReplacement(e,i){if(i.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=i.updateTime;const o=i.getReplacementRegionsForTile(e.toUnwrapped());if(function(r,u){if(r.length!==u.length)return!1;for(let m=0;m<r.length;m++)if(r[m].sourceId!==u[m].sourceId||!by(r[m],u[m]))return!1;return!0}(this.activeReplacements,o))return;if(this.activeReplacements=o,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const r of this.centroidData)r.flags&=2147483647;const l=[];for(const r of this.activeReplacements){const u=Math.pow(2,r.footprintTileId.canonical.z-e.canonical.z);for(const m of this.centroidData)if(!(m.flags&il||r.min.x>m.max.x||m.min.x>r.max.x||r.min.y>m.max.y||m.min.y>r.max.y))for(let p=0;p<m.footprintSegLen;p++){const h=this.footprintSegments[m.footprintSegIdx+p];if(l.length=0,H2(this.footprintVertices,h.vertexOffset,h.vertexCount,r.footprintTileId.canonical,e.canonical,l),vy(r.footprint,l,this.footprintIndices.uint16,h.indexOffset,h.indexCount,-h.vertexOffset,-u)){m.flags|=il;break}}}for(const r of this.centroidData)this.writeCentroidToBuffer(r);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(e,i,o){let l=!1;for(let r=0;r<o.footprintSegLen;r++){const u=this.footprintSegments[o.footprintSegIdx+r];let m=0;for(const p of u.ringIndices){for(let h=m,y=p+m-1;h<p+m;y=h++){const x=this.footprintVertices.int16[2*(h+u.vertexOffset)+0],E=this.footprintVertices.int16[2*(h+u.vertexOffset)+1],S=this.footprintVertices.int16[2*(y+u.vertexOffset)+1];E>i!=S>i&&e<(this.footprintVertices.int16[2*(y+u.vertexOffset)+0]-x)*(i-E)/(S-E)+x&&(l=!l)}m=p}}return l}getHeightAtTileCoord(e,i){let o=Number.NEGATIVE_INFINITY,l=!0;const r=4*(e+st)*st+(i+st);if(this.partLookup.hasOwnProperty(r)){const u=this.partLookup[r];return u?{height:u.height,hidden:!!(u.flags&il)}:void 0}for(const u of this.centroidData)e>u.max.x||u.min.x>e||i>u.max.y||u.min.y>i||this.footprintContainsPoint(e,i,u)&&u&&u.height>o&&(o=u.height,this.partLookup[r]=u,l=!!(u.flags&il));if(o!==Number.NEGATIVE_INFINITY)return{height:o,hidden:l};this.partLookup[r]=void 0}}function Fy(t,e){const i=t.add(e)._unit();return t.x*i.x+t.y*i.y}function z2(t,e,i,o){const l=e.sub(t)._perp()._unit(),r=i.sub(e)._perp()._unit();return By(t,e,i,Fy(l,r),o)}function By(t,e,i,o,l){const r=Math.sqrt(1-o*o);return Math.min(t.dist(e)/3,e.dist(i)/3,l*r/o)}function fp(t,e,i){return t.x<i[0].x&&e.x<i[0].x||t.x>i[1].x&&e.x>i[1].x||t.y<i[0].y&&e.y<i[0].y||t.y>i[1].y&&e.y>i[1].y}function Uy(t,e){return t.x<e[0].x||t.x>e[1].x||t.y<e[0].y||t.y>e[1].y}function ky(t,e,i){if(t.x<0||t.x>=st||e.x<0||e.x>=st||i.x<0||i.x>=st)return!1;const o=i.sub(e),l=o.perp(),r=t.sub(e);return(o.x*r.x+o.y*r.y)/Math.sqrt((o.x*o.x+o.y*o.y)*(r.x*r.x+r.y*r.y))>-.866&&l.x*r.x+l.y*r.y<0}function zy(t,e,i){const o=e?2|t:-3&t;return i?1|o:-2&o}function Hy(){const t=Math.PI/32,e=Math.tan(t),i=Ee;return i*Math.sqrt(1+2*e*e)-i}function Yy(t,e,i){const o=1<<i.z,l=kt(i.x/o),r=kt((i.x+1)/o),u=di(i.y/o),m=di((i.y+1)/o);return function(p,h,y,x,E=0,S){const C=[];if(!p.length||!y||!x)return C;const w=(J,se)=>{for(const _e of J)C.push({polygon:_e,bounds:se})},W=Math.ceil(Math.log2(y)),D=Math.ceil(Math.log2(x)),Y=W-D,q=[];for(let J=0;J<Math.abs(Y);J++)q.push(Y>0?0:1);for(let J=0;J<Math.min(W,D);J++)q.push(0),q.push(1);let K=p;if(K=om(K,h[0].y-E,h[1].y+E,1),K=om(K,h[0].x-E,h[1].x+E,0),!K.length)return C;const ee=[];for(q.length?ee.push({polygons:K,bounds:h,depth:0}):w(K,h);ee.length;){const J=ee.pop(),se=J.depth,_e=q[se],me=J.bounds[0],be=J.bounds[1],fe=_e===0?me.x:me.y,Se=_e===0?be.x:be.y,De=S?S(_e,fe,Se):.5*(fe+Se),Ae=om(J.polygons,fe-E,De+E,_e),We=om(J.polygons,De-E,Se+E,_e);if(Ae.length){const xe=[me,new qe(_e===0?De:be.x,_e===1?De:be.y)];q.length>se+1?ee.push({polygons:Ae,bounds:xe,depth:se+1}):w(Ae,xe)}if(We.length){const xe=[new qe(_e===0?De:me.x,_e===1?De:me.y),be];q.length>se+1?ee.push({polygons:We,bounds:xe,depth:se+1}):w(We,xe)}}return C}(t,e,Math.ceil((r-l)/11.25),Math.ceil((u-m)/11.25),1,(p,h,y)=>{if(p===0)return .5*(h+y);{const x=di((i.y+h/st)/o);return(Ft(.5*(di((i.y+y/st)/o)+x))*o-i.y)*st}})}function H2(t,e,i,o,l,r){const u=Math.pow(2,o.z-l.z);for(let m=0;m<i;m++){let p=t.int16[2*(m+e)+0],h=t.int16[2*(m+e)+1];p=(p+l.x*st)*u-o.x*st,h=(h+l.y*st)*u-o.y*st,r.push(new qe(p,h))}}mt(rm,"FillExtrusionBucket",{omit:["layers","features"]}),mt(Ny,"PartData"),mt(Ly,"FootprintSegment"),mt(Wy,"BorderCentroidData"),mt(Dy,"GroundEffect");const Y2=new $i({visibility:new Xe(ge["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Xe(ge["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var G2={paint:new $i({"fill-extrusion-opacity":new Xe(ge["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Rt(ge["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Xe(ge["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Xe(ge["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Rt(ge["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Rt(ge["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Rt(ge["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Xe(ge["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Xe(ge["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Xe(ge["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Xe(ge["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Xe(ge["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Xe(ge["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Xe(ge["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Xe(ge["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Rt(ge["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Rt(ge["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Xe(ge["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Xe(ge["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Xe(ge["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Xe(ge["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Xe(ge["paint_fill-extrusion"]["fill-extrusion-emissive-strength"])}),layout:Y2};class sd extends qe{constructor(e,i,o){super(e,i),this.z=o}}function hu(t,e){return t.x*e.x+t.y*e.y}function Gy(t,e){if(t.length===1){let i=0;const o=e[i++];let l;for(;!l||o.equals(l);)if(l=e[i++],!l)return 1/0;for(;i<e.length;i++){const r=e[i],u=t[0],m=l.sub(o),p=r.sub(o),h=u.sub(o),y=hu(m,m),x=hu(m,p),E=hu(p,p),S=hu(h,m),C=hu(h,p),w=y*E-x*x,W=(E*S-x*C)/w,D=(y*C-x*S)/w,Y=o.z*(1-W-D)+l.z*W+r.z*D;if(isFinite(Y))return Y}return 1/0}{let i=1/0;for(const o of e)i=Math.min(i,o.z);return i}}function Vy(t,e,i,o,l,r,u,m){const p=u*l.getElevationAt(t,e,!0,!0),h=r[0]!==0,y=h?r[1]===0?u*(r[0]/7-450):u*function(x,E,S){const C=Math.floor(E[0]/8),w=Math.floor(E[1]/8),W=10*(E[0]-8*C),D=10*(E[1]-8*w),Y=x.getElevationAt(C,w,!0,!0),q=x.getMeterToDEM(S),K=Math.floor(.5*(W*q-1)),ee=Math.floor(.5*(D*q-1)),J=x.tileCoordToPixel(C,w),se=2*K+1,_e=2*ee+1,me=function(We,xe,Ne,Qe,Be){return[We.getElevationAtPixel(xe,Ne,!0),We.getElevationAtPixel(xe+Be,Ne,!0),We.getElevationAtPixel(xe,Ne+Be,!0),We.getElevationAtPixel(xe+Qe,Ne+Be,!0)]}(x,J.x-K,J.y-ee,se,_e),be=Math.abs(me[0]-me[1]),fe=Math.abs(me[2]-me[3]),Se=Math.abs(me[0]-me[2])+Math.abs(me[1]-me[3]),De=Math.min(.25,.5*q*(be+fe)/se),Ae=Math.min(.25,.5*q*Se/_e);return Y+Math.max(De*W,Ae*D)}(l,r,m):p;return{base:p+(i===0)?-1:i,top:h?Math.max(y+o,p+i+2):p+o}}const V2=Ii([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:j2}=V2,K2=Ii([{name:"a_packed",components:4,type:"Float32"}]),{members:q2}=K2;class jy{constructor(e,i){this.width=e,this.height=i,this.nextRow=0,this.image=new el({width:e,height:i}),this.positions={},this.uploaded=!1}getDash(e,i){const o=this.getKey(e,i);return this.positions[o]}trim(){const e=this.width,i=this.height=hl(this.nextRow);this.image.resize({width:e,height:i})}getKey(e,i){return e.join(",")+i}getDashRanges(e,i,o){const l=[];let r=e.length%2==1?-e[e.length-1]*o:0,u=e[0]*o,m=!0;l.push({left:r,right:u,isDash:m,zeroLength:e[0]===0});let p=e[0];for(let h=1;h<e.length;h++){m=!m;const y=e[h];r=p*o,p+=y,u=p*o,l.push({left:r,right:u,isDash:m,zeroLength:y===0})}return l}addRoundDash(e,i,o){const l=i/2;for(let r=-o;r<=o;r++){const u=this.width*(this.nextRow+o+r);let m=0,p=e[m];for(let h=0;h<this.width;h++){h/p.right>1&&(p=e[++m]);const y=Math.abs(h-p.left),x=Math.abs(h-p.right),E=Math.min(y,x);let S;const C=r/o*(l+1);if(p.isDash){const w=l-Math.abs(C);S=Math.sqrt(E*E+w*w)}else S=l-Math.sqrt(E*E+C*C);this.image.data[u+h]=Math.max(0,Math.min(255,S+128))}}}addRegularDash(e,i){for(let p=e.length-1;p>=0;--p){const h=e[p],y=e[p+1];h.zeroLength?e.splice(p,1):y&&y.isDash===h.isDash&&(y.left=h.left,e.splice(p,1))}const o=e[0],l=e[e.length-1];o.isDash===l.isDash&&(o.left=l.left-this.width,l.right=o.right+this.width);const r=this.width*this.nextRow;let u=0,m=e[u];for(let p=0;p<this.width;p++){p/m.right>1&&(m=e[++u]);const h=Math.abs(p-m.left),y=Math.abs(p-m.right),x=Math.min(h,y);this.image.data[r+p]=Math.max(0,Math.min(255,(m.isDash?x:-x)+i+128))}}addDash(e,i){const o=this.getKey(e,i);if(this.positions[o])return this.positions[o];const l=i==="round",r=l?7:0,u=2*r+1;if(this.nextRow+u>this.height)return ta("LineAtlas out of space"),null;e.length===0&&e.push(1);let m=0;for(let y=0;y<e.length;y++)e[y]<0&&(ta("Negative value is found in line dasharray, replacing values with 0"),e[y]=0),m+=e[y];if(m!==0){const y=this.width/m,x=this.getDashRanges(e,this.width,y);l?this.addRoundDash(x,y,r):this.addRegularDash(x,i==="square"?.5*y:0)}const p=this.nextRow+r;this.nextRow+=u;const h={tl:[p,r],br:[m,0]};return this.positions[o]=h,h}}mt(jy,"LineAtlas");const $2=am.types,Z2=Math.cos(Math.PI/180*37.5);class pp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new q_,this.layoutVertexArray2=new kn,this.indexArray=new Ia,this.programConfigurations=new U(e.layers,e.zoom),this.segments=new ia,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,o,l){this.hasPattern=_p("line",this.layers,i);const r=this.layers[0].layout.get("line-sort-key"),u=[];for(const{feature:y,id:x,index:E,sourceLayerIndex:S}of e){const C=this.layers[0]._featureFilter.needGeometry,w=ya(y,C);if(!this.layers[0]._featureFilter.filter(new qi(this.zoom),w,o))continue;const W=r?r.evaluate(w,{},o):void 0,D={id:x,properties:y.properties,type:y.type,sourceLayerIndex:S,index:E,geometry:C?w.geometry:Sa(y,o,l),patterns:{},sortKey:W};u.push(D)}r&&u.sort((y,x)=>y.sortKey-x.sortKey);const{lineAtlas:m,featureIndex:p}=i,h=this.addConstantDashes(m);for(const y of u){const{geometry:x,index:E,sourceLayerIndex:S}=y;if(h&&this.addFeatureDashes(y,m),this.hasPattern){const C=up("line",this.layers,y,this.zoom,i);this.patternFeatures.push(C)}else this.addFeature(y,x,E,o,m.positions,i.availableImages,i.brightness);p.insert(e[E].feature,x,E,S,this.index)}}addConstantDashes(e){let i=!1;for(const o of this.layers){const l=o.paint.get("line-dasharray").value,r=o.layout.get("line-cap").value;if(l.kind!=="constant"||r.kind!=="constant")i=!0;else{const u=r.value,m=l.value;if(!m)continue;e.addDash(m,u)}}return i}addFeatureDashes(e,i){const o=this.zoom;for(const l of this.layers){const r=l.paint.get("line-dasharray").value,u=l.layout.get("line-cap").value;if(r.kind==="constant"&&u.kind==="constant")continue;let m,p;if(r.kind==="constant"){if(m=r.value,!m)continue}else m=r.evaluate({zoom:o},e);p=u.kind==="constant"?u.value:u.evaluate({zoom:o},e),i.addDash(m,p),e.patterns[l.id]=i.getKey(m,p)}}update(e,i,o,l,r){const u=Object.keys(e).length!==0;u&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,i,u?this.stateDependentLayers:this.layers,o,l,r)}addFeatures(e,i,o,l,r,u){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,i,o,l,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,q2)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,j2),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,i,o,l,r,u,m){const p=this.layers[0].layout,h=p.get("line-join").evaluate(e,{}),y=p.get("line-cap").evaluate(e,{}),x=p.get("line-miter-limit"),E=p.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const S of i)this.addLine(S,e,h,y,x,E);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,r,u,l,m)}addLine(e,i,o,l,r,u){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let D=0;D<e.length-1;D++)this.totalDistance+=e[D].dist(e[D+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const m=$2[i.type]==="Polygon";let p=e.length;for(;p>=2&&e[p-1].equals(e[p-2]);)p--;let h=0;for(;h<p-1&&e[h].equals(e[h+1]);)h++;if(p<(m?3:2))return;o==="bevel"&&(r=1.05);const y=this.overscaling<=16?15*st/(512*this.overscaling):0,x=this.segments.prepareSegment(10*p,this.layoutVertexArray,this.indexArray);let E,S,C,w,W;this.e1=this.e2=-1,m&&(E=e[p-2],W=e[h].sub(E)._unit()._perp());for(let D=h;D<p;D++){if(C=D===p-1?m?e[h+1]:void 0:e[D+1],C&&e[D].equals(C))continue;W&&(w=W),E&&(S=E),E=e[D],W=C?C.sub(E)._unit()._perp():w,w=w||W;let Y=w.add(W);Y.x===0&&Y.y===0||Y._unit();const q=w.x*W.x+w.y*W.y,K=Y.x*W.x+Y.y*W.y,ee=K!==0?1/K:1/0,J=2*Math.sqrt(2-2*K),se=K<Z2&&S&&C,_e=w.x*W.y-w.y*W.x>0;if(se&&D>h){const fe=E.dist(S);if(fe>2*y){const Se=E.sub(E.sub(S)._mult(y/fe)._round());this.updateDistance(S,Se),this.addCurrentVertex(Se,w,0,0,x),S=Se}}const me=S&&C;let be=me?o:m?"butt":l;if(me&&be==="round"&&(ee<u?be="miter":ee<=2&&(be="fakeround")),be==="miter"&&ee>r&&(be="bevel"),be==="bevel"&&(ee>2&&(be="flipbevel"),ee<r&&(be="miter")),S&&this.updateDistance(S,E),be==="miter")Y._mult(ee),this.addCurrentVertex(E,Y,0,0,x);else if(be==="flipbevel"){if(ee>100)Y=W.mult(-1);else{const fe=ee*w.add(W).mag()/w.sub(W).mag();Y._perp()._mult(fe*(_e?-1:1))}this.addCurrentVertex(E,Y,0,0,x),this.addCurrentVertex(E,Y.mult(-1),0,0,x)}else if(be==="bevel"||be==="fakeround"){const fe=-Math.sqrt(ee*ee-1),Se=_e?fe:0,De=_e?0:fe;if(S&&this.addCurrentVertex(E,w,Se,De,x),be==="fakeround"){const Ae=Math.round(180*J/Math.PI/20);for(let We=1;We<Ae;We++){let xe=We/Ae;if(xe!==.5){const Qe=xe-.5;xe+=xe*Qe*(xe-1)*((1.0904+q*(q*(3.55645-1.43519*q)-3.2452))*Qe*Qe+(.848013+q*(.215638*q-1.06021)))}const Ne=W.sub(w)._mult(xe)._add(w)._unit()._mult(_e?-1:1);this.addHalfVertex(E,Ne.x,Ne.y,!1,_e,0,x)}}C&&this.addCurrentVertex(E,W,-Se,-De,x)}else if(be==="butt")this.addCurrentVertex(E,Y,0,0,x);else if(be==="square"){const fe=S?1:-1;S||this.addCurrentVertex(E,Y,fe,fe,x),this.addCurrentVertex(E,Y,0,0,x),S&&this.addCurrentVertex(E,Y,fe,fe,x)}else be==="round"&&(S&&(this.addCurrentVertex(E,w,0,0,x),this.addCurrentVertex(E,w,1,1,x,!0)),C&&(this.addCurrentVertex(E,W,-1,-1,x,!0),this.addCurrentVertex(E,W,0,0,x)));if(se&&D<p-1){const fe=E.dist(C);if(fe>2*y){const Se=E.add(C.sub(E)._mult(y/fe)._round());this.updateDistance(E,Se),this.addCurrentVertex(Se,W,0,0,x),E=Se}}}}addCurrentVertex(e,i,o,l,r,u=!1){const m=i.y*l-i.x,p=-i.y-i.x*l;this.addHalfVertex(e,i.x+i.y*o,i.y-i.x*o,u,!1,o,r),this.addHalfVertex(e,m,p,u,!0,-l,r)}addHalfVertex({x:e,y:i},o,l,r,u,m,p){this.layoutVertexArray.emplaceBack((e<<1)+(r?1:0),(i<<1)+(u?1:0),Math.round(63*o)+128,Math.round(63*l)+128,1+(m===0?0:m<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const h=p.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,h),p.primitiveLength++),u?this.e2=h:this.e1=h}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,i){this.distance+=e.dist(i),this.updateScaledDistance()}}mt(pp,"LineBucket",{omit:["layers","patternFeatures"]});const X2=new $i({"line-cap":new Rt(ge.layout_line["line-cap"]),"line-join":new Rt(ge.layout_line["line-join"]),"line-miter-limit":new Xe(ge.layout_line["line-miter-limit"]),"line-round-limit":new Xe(ge.layout_line["line-round-limit"]),"line-sort-key":new Rt(ge.layout_line["line-sort-key"]),visibility:new Xe(ge.layout_line.visibility)});var Ky={paint:new $i({"line-opacity":new Rt(ge.paint_line["line-opacity"]),"line-color":new Rt(ge.paint_line["line-color"]),"line-translate":new Xe(ge.paint_line["line-translate"]),"line-translate-anchor":new Xe(ge.paint_line["line-translate-anchor"]),"line-width":new Rt(ge.paint_line["line-width"]),"line-gap-width":new Rt(ge.paint_line["line-gap-width"]),"line-offset":new Rt(ge.paint_line["line-offset"]),"line-blur":new Rt(ge.paint_line["line-blur"]),"line-dasharray":new Rt(ge.paint_line["line-dasharray"]),"line-pattern":new Rt(ge.paint_line["line-pattern"]),"line-gradient":new ms(ge.paint_line["line-gradient"]),"line-trim-offset":new Xe(ge.paint_line["line-trim-offset"]),"line-emissive-strength":new Xe(ge.paint_line["line-emissive-strength"]),"line-border-width":new Rt(ge.paint_line["line-border-width"]),"line-border-color":new Rt(ge.paint_line["line-border-color"])}),layout:X2};function qy(t,e,i){return e*(st/(t.tileSize*Math.pow(2,i-t.tileID.overscaledZ)))}function $y(t,e){return 1/qy(t,1,e.tileZoom)}function Zy(t,e,i,o){return t.translatePosMatrix(o||e.tileID.projMatrix,e,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}const Xy=t=>{const e=[];Jy(t)&&e.push("RENDER_LINE_DASH"),t.paint.get("line-gradient")&&e.push("RENDER_LINE_GRADIENT");const i=t.paint.get("line-trim-offset");return i[0]===0&&i[1]===0||e.push("RENDER_LINE_TRIM_OFFSET"),t.paint.get("line-border-width").constantOr(1)!==0&&e.push("RENDER_LINE_BORDER"),e};function Jy(t){const e=t.paint.get("line-dasharray").value;return e.value||e.kind!=="constant"}const Qy=new class extends Rt{possiblyEvaluate(t,e){return e=new qi(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,i,o){return e=za({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,i,o)}}(Ky.paint.properties["line-width"].specification);function e0(t,e){return e>0?e+2*t:t}Qy.useIntegerZoom=!0;const J2=Ii([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Q2=Ii([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),e3=Ii([{name:"a_projected_pos",components:4,type:"Float32"}],4);Ii([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const t3=Ii([{name:"a_z_offset",components:1,type:"Float32"}],4),i3=Ii([{name:"a_texb",components:2,type:"Uint16"}]),a3=Ii([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),o3=Ii([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_z_offset",components:1,type:"Float32"}]);Ii([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const t0=Ii([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),n3=Ii([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Ii([{name:"triangle",components:3,type:"Uint16"}]),Ii([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Ii([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),Ii([{type:"Float32",name:"offsetX"}]),Ii([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Ya=24;const fn=128;function hp(t,e){const{expression:i}=e;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new qi(t+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:o,interpolationType:l}=i;let r=0;for(;r<o.length&&o[r]<=t;)r++;r=Math.max(0,r-1);let u=r;for(;u<o.length&&o[u]<t+1;)u++;u=Math.min(o.length-1,u);const m=o[r],p=o[u];return i.kind==="composite"?{kind:"composite",minZoom:m,maxZoom:p,interpolationType:l}:{kind:"camera",minZoom:m,maxZoom:p,minSize:i.evaluate(new qi(m)),maxSize:i.evaluate(new qi(p)),interpolationType:l}}}function dm(t,{uSize:e,uSizeT:i},{lowerSize:o,upperSize:l}){return t.kind==="source"?o/fn:t.kind==="composite"?si(o/fn,l/fn,i):e}function ld(t,e){let i=0,o=0;if(t.kind==="constant")o=t.layoutSize;else if(t.kind!=="source"){const{interpolationType:l,minZoom:r,maxZoom:u}=t,m=l?Vt(mo.interpolationFactor(l,e,r,u),0,1):0;t.kind==="camera"?o=si(t.minSize,t.maxSize,m):i=m}return{uSizeT:i,uSize:o}}var s3=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:fn,evaluateSizeForFeature:dm,evaluateSizeForZoom:ld,getSizeData:hp});function l3(t,e,i){return t.sections.forEach(o=>{o.text=function(l,r,u){const m=r.layout.get("text-transform").evaluate(u,{});return m==="uppercase"?l=l.toLocaleUpperCase():m==="lowercase"&&(l=l.toLocaleLowerCase()),fo.applyArabicShaping&&(l=fo.applyArabicShaping(l)),l}(o.text,e,i)}),t}const gu={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function r3(t){return t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""}function d3(t){return t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""}var _3={read:function(t,e,i,o,l){var r,u,m=8*l-o-1,p=(1<<m)-1,h=p>>1,y=-7,x=i?l-1:0,E=i?-1:1,S=t[e+x];for(x+=E,r=S&(1<<-y)-1,S>>=-y,y+=m;y>0;r=256*r+t[e+x],x+=E,y-=8);for(u=r&(1<<-y)-1,r>>=-y,y+=o;y>0;u=256*u+t[e+x],x+=E,y-=8);if(r===0)r=1-h;else{if(r===p)return u?NaN:1/0*(S?-1:1);u+=Math.pow(2,o),r-=h}return(S?-1:1)*u*Math.pow(2,r-o)},write:function(t,e,i,o,l,r){var u,m,p,h=8*r-l-1,y=(1<<h)-1,x=y>>1,E=l===23?Math.pow(2,-24)-Math.pow(2,-77):0,S=o?0:r-1,C=o?1:-1,w=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(m=isNaN(e)?1:0,u=y):(u=Math.floor(Math.log(e)/Math.LN2),e*(p=Math.pow(2,-u))<1&&(u--,p*=2),(e+=u+x>=1?E/p:E*Math.pow(2,1-x))*p>=2&&(u++,p/=2),u+x>=y?(m=0,u=y):u+x>=1?(m=(e*p-1)*Math.pow(2,l),u+=x):(m=e*Math.pow(2,x-1)*Math.pow(2,l),u=0));l>=8;t[i+S]=255&m,S+=C,m/=256,l-=8);for(u=u<<l|m,h+=l;h>0;t[i+S]=255&u,S+=C,u/=256,h-=8);t[i+S-C]|=128*w}},i0=ji,_m=_3;function ji(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}ji.Varint=0,ji.Fixed64=1,ji.Bytes=2,ji.Fixed32=5;var gp=4294967296,a0=1/gp,o0=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function xs(t){return t.type===ji.Bytes?t.readVarint()+t.pos:t.pos+1}function rd(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function n0(t,e,i){var o=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(o);for(var l=i.pos-1;l>=t;l--)i.buf[l+o]=i.buf[l]}function u3(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function c3(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function m3(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function f3(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function p3(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function h3(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function g3(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function y3(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function b3(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}function um(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function dd(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24}function s0(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}ji.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var o=this.readVarint(),l=o>>3,r=this.pos;this.type=7&o,t(l,e,this),this.pos===r&&this.skip(o)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=um(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=s0(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=um(this.buf,this.pos)+um(this.buf,this.pos+4)*gp;return this.pos+=8,t},readSFixed64:function(){var t=um(this.buf,this.pos)+s0(this.buf,this.pos+4)*gp;return this.pos+=8,t},readFloat:function(){var t=_m.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=_m.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,i,o=this.buf;return e=127&(i=o[this.pos++]),i<128?e:(e|=(127&(i=o[this.pos++]))<<7,i<128?e:(e|=(127&(i=o[this.pos++]))<<14,i<128?e:(e|=(127&(i=o[this.pos++]))<<21,i<128?e:function(l,r,u){var m,p,h=u.buf;if(m=(112&(p=h[u.pos++]))>>4,p<128||(m|=(127&(p=h[u.pos++]))<<3,p<128)||(m|=(127&(p=h[u.pos++]))<<10,p<128)||(m|=(127&(p=h[u.pos++]))<<17,p<128)||(m|=(127&(p=h[u.pos++]))<<24,p<128)||(m|=(1&(p=h[u.pos++]))<<31,p<128))return rd(l,m,r);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=o[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&o0?function(i,o,l){return o0.decode(i.subarray(o,l))}(this.buf,e,t):function(i,o,l){for(var r="",u=o;u<l;){var m,p,h,y=i[u],x=null,E=y>239?4:y>223?3:y>191?2:1;if(u+E>l)break;E===1?y<128&&(x=y):E===2?(192&(m=i[u+1]))==128&&(x=(31&y)<<6|63&m)<=127&&(x=null):E===3?(p=i[u+2],(192&(m=i[u+1]))==128&&(192&p)==128&&((x=(15&y)<<12|(63&m)<<6|63&p)<=2047||x>=55296&&x<=57343)&&(x=null)):E===4&&(p=i[u+2],h=i[u+3],(192&(m=i[u+1]))==128&&(192&p)==128&&(192&h)==128&&((x=(15&y)<<18|(63&m)<<12|(63&p)<<6|63&h)<=65535||x>=1114112)&&(x=null)),x===null?(x=65533,E=1):x>65535&&(x-=65536,r+=String.fromCharCode(x>>>10&1023|55296),x=56320|1023&x),r+=String.fromCharCode(x),u+=E}return r}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==ji.Bytes)return t.push(this.readVarint(e));var i=xs(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==ji.Bytes)return t.push(this.readSVarint());var e=xs(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==ji.Bytes)return t.push(this.readBoolean());var e=xs(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==ji.Bytes)return t.push(this.readFloat());var e=xs(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==ji.Bytes)return t.push(this.readDouble());var e=xs(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==ji.Bytes)return t.push(this.readFixed32());var e=xs(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==ji.Bytes)return t.push(this.readSFixed32());var e=xs(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==ji.Bytes)return t.push(this.readFixed64());var e=xs(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==ji.Bytes)return t.push(this.readSFixed64());var e=xs(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===ji.Varint)for(;this.buf[this.pos++]>127;);else if(e===ji.Bytes)this.pos=this.readVarint()+this.pos;else if(e===ji.Fixed32)this.pos+=4;else{if(e!==ji.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),dd(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),dd(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),dd(this.buf,-1&t,this.pos),dd(this.buf,Math.floor(t*a0),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),dd(this.buf,-1&t,this.pos),dd(this.buf,Math.floor(t*a0),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(e,i){var o,l;if(e>=0?(o=e%4294967296|0,l=e/4294967296|0):(l=~(-e/4294967296),4294967295^(o=~(-e%4294967296))?o=o+1|0:(o=0,l=l+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(r,u,m){m.buf[m.pos++]=127&r|128,r>>>=7,m.buf[m.pos++]=127&r|128,r>>>=7,m.buf[m.pos++]=127&r|128,r>>>=7,m.buf[m.pos++]=127&r|128,m.buf[m.pos]=127&(r>>>=7)}(o,0,i),function(r,u){var m=(7&r)<<4;u.buf[u.pos++]|=m|((r>>>=3)?128:0),r&&(u.buf[u.pos++]=127&r|((r>>>=7)?128:0),r&&(u.buf[u.pos++]=127&r|((r>>>=7)?128:0),r&&(u.buf[u.pos++]=127&r|((r>>>=7)?128:0),r&&(u.buf[u.pos++]=127&r|((r>>>=7)?128:0),r&&(u.buf[u.pos++]=127&r)))))}(l,i)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(!!t)},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(o,l,r){for(var u,m,p=0;p<l.length;p++){if((u=l.charCodeAt(p))>55295&&u<57344){if(!m){u>56319||p+1===l.length?(o[r++]=239,o[r++]=191,o[r++]=189):m=u;continue}if(u<56320){o[r++]=239,o[r++]=191,o[r++]=189,m=u;continue}u=m-55296<<10|u-56320|65536,m=null}else m&&(o[r++]=239,o[r++]=191,o[r++]=189,m=null);u<128?o[r++]=u:(u<2048?o[r++]=u>>6|192:(u<65536?o[r++]=u>>12|224:(o[r++]=u>>18|240,o[r++]=u>>12&63|128),o[r++]=u>>6&63|128),o[r++]=63&u|128)}return r}(this.buf,t,this.pos);var i=this.pos-e;i>=128&&n0(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),_m.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),_m.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var o=this.pos-i;o>=128&&n0(i,o,this),this.pos=i-1,this.writeVarint(o),this.pos+=o},writeMessage:function(t,e,i){this.writeTag(t,ji.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,u3,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,c3,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,p3,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,m3,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,f3,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,h3,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,g3,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,y3,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,b3,e)},writeBytesField:function(t,e){this.writeTag(t,ji.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,ji.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,ji.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,ji.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,ji.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,ji.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,ji.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,ji.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,ji.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,ji.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,!!e)}};var _d=bt(i0);const yp=3;function T3(t,e,i){e.glyphs=[],t===1&&i.readMessage(x3,e)}function x3(t,e,i){if(t===3){const{id:o,bitmap:l,width:r,height:u,left:m,top:p,advance:h}=i.readMessage(v3,{});e.glyphs.push({id:o,bitmap:new el({width:r+2*yp,height:u+2*yp},l),metrics:{width:r,height:u,left:m,top:p,advance:h}})}else t===4?e.ascender=i.readSVarint():t===5&&(e.descender=i.readSVarint())}function v3(t,e,i){t===1?e.id=i.readVarint():t===2?e.bitmap=i.readBytes():t===3?e.width=i.readVarint():t===4?e.height=i.readVarint():t===5?e.left=i.readSVarint():t===6?e.top=i.readSVarint():t===7&&(e.advance=i.readVarint())}const l0=yp,Go={horizontal:1,vertical:2,horizontalOnly:3};class yu{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,i){const o=new yu;return o.scale=e||1,o.fontStack=i,o}static forImage(e){const i=new yu;return i.imageName=e,i}}class ud{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,i){const o=new ud;for(let l=0;l<e.sections.length;l++){const r=e.sections[l];r.image?o.addImageSection(r):o.addTextSection(r,i)}return o}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCodePoint(e){return this.text.codePointAt(e)}verticalizePunctuation(e){this.text=function(i,o){let l="";for(let r=0;r<i.length;r++){const u=i.charCodeAt(r+1)||null,m=i.charCodeAt(r-1)||null;l+=!o&&(u&&yc(u)&&!gu[i[r+1]]||m&&yc(m)&&!gu[i[r-1]])||!gu[i[r]]?i[r]:gu[i[r]]}return l}(this.text,e)}trim(){let e=0;for(let o=0;o<this.text.length&&cm[this.text.charCodeAt(o)];o++)e++;let i=this.text.length;for(let o=this.text.length-1;o>=0&&o>=e&&cm[this.text.charCodeAt(o)];o--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)}substring(e,i){const o=new ud;return o.text=this.text.substring(e,i),o.sectionIndex=this.sectionIndex.slice(e,i),o.sections=this.sections,o}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,i)=>Math.max(e,this.sections[i].scale),0)}addTextSection(e,i){this.text+=e.text,this.sections.push(yu.forText(e.scale,e.fontStack||i));const o=this.sections.length-1;for(let l=0;l<e.text.length;++l)this.sectionIndex.push(o)}addImageSection(e){const i=e.image?e.image.namePrimary:"";if(i.length===0)return void ta("Can't add FormattedSection with an empty image.");const o=this.getNextImageSectionCharCode();o?(this.text+=String.fromCodePoint(o),this.sections.push(yu.forImage(i)),this.sectionIndex.push(this.sections.length-1)):ta("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function bp(t,e,i,o,l,r,u,m,p,h,y,x,E,S,C){const w=ud.fromFeature(t,l);x===Go.vertical&&w.verticalizePunctuation(E);let W=[];const D=function(J,se,_e,me,be,fe){if(!J)return[];const Se=[],De=function(Ne,Qe,Be,pt,dt,ze){let Lt=0;for(let Et=0;Et<Ne.length();Et++){const ft=Ne.getSection(Et);Lt+=r0(Ne.getCodePoint(Et),ft,pt,dt,Qe,ze)}return Lt/Math.max(1,Math.ceil(Lt/Be))}(J,se,_e,me,be,fe),Ae=J.text.indexOf("")>=0;let We=0;for(let Ne=0;Ne<J.length();Ne++){const Qe=J.getSection(Ne),Be=J.getCodePoint(Ne);if(cm[Be]||(We+=r0(Be,Qe,me,be,se,fe)),Ne<J.length()-1){const pt=!((xe=Be)<11904||!(yt["Bopomofo Extended"](xe)||yt.Bopomofo(xe)||yt["CJK Compatibility Forms"](xe)||yt["CJK Compatibility Ideographs"](xe)||yt["CJK Compatibility"](xe)||yt["CJK Radicals Supplement"](xe)||yt["CJK Strokes"](xe)||yt["CJK Symbols and Punctuation"](xe)||yt["CJK Unified Ideographs Extension A"](xe)||yt["CJK Unified Ideographs"](xe)||yt["Enclosed CJK Letters and Months"](xe)||yt["Halfwidth and Fullwidth Forms"](xe)||yt.Hiragana(xe)||yt["Ideographic Description Characters"](xe)||yt["Kangxi Radicals"](xe)||yt["Katakana Phonetic Extensions"](xe)||yt.Katakana(xe)||yt["Vertical Forms"](xe)||yt["Yi Radicals"](xe)||yt["Yi Syllables"](xe)));(E3[Be]||pt||Qe.imageName)&&Se.push(_0(Ne+1,We,De,Se,A3(Be,J.getCodePoint(Ne+1),pt&&Ae),!1))}}var xe;return u0(_0(J.length(),We,De,Se,0,!0))}(w,h,r,e,o,S),{processBidirectionalText:Y,processStyledBidirectionalText:q}=fo;if(Y&&w.sections.length===1){const J=Y(w.toString(),D);for(const se of J){const _e=new ud;_e.text=se,_e.sections=w.sections;for(let me=0;me<se.length;me++)_e.sectionIndex.push(0);W.push(_e)}}else if(q){const J=q(w.text,w.sectionIndex,D);for(const se of J){const _e=new ud;_e.text=se[0],_e.sectionIndex=se[1],_e.sections=w.sections,W.push(_e)}}else W=function(J,se){const _e=[],me=J.text;let be=0;for(const fe of se)_e.push(J.substring(be,fe)),be=fe;return be<me.length&&_e.push(J.substring(be,me.length)),_e}(w,D);const K=[],ee={positionedLines:K,text:w.toString(),top:y[1],bottom:y[1],left:y[0],right:y[0],writingMode:x,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(J,se,_e,me,be,fe,Se,De,Ae,We,xe,Ne){let Qe=0,Be=0,pt=0;const dt=De==="right"?1:De==="left"?0:.5;let ze=!1;for(const $t of be){const Wt=$t.getSections();for(const Zt of Wt){if(Zt.imageName)continue;const Ut=se[Zt.fontStack];if(Ut&&(ze=Ut.ascender!==void 0&&Ut.descender!==void 0,!ze))break}if(!ze)break}let Lt=0;for(const $t of be){$t.trim();const Wt=$t.getMaxScale(),Zt=(Wt-1)*Ya,Ut={positionedGlyphs:[],lineOffset:0};J.positionedLines[Lt]=Ut;const li=Ut.positionedGlyphs;let Ht=0;if(!$t.length()){Be+=fe,++Lt;continue}let Ni=0,pi=0;for(let Ei=0;Ei<$t.length();Ei++){const hi=$t.getSection(Ei),Ki=$t.getSectionIndex(Ei),Ri=$t.getCodePoint(Ei);let aa=hi.scale,xa=null,Ua=null,Gi=null,Ji=Ya,wa=0;const Pa=!(Ae===Go.horizontal||!xe&&!L_(Ri)||xe&&(cm[Ri]||(Et=Ri,yt.Arabic(Et)||yt["Arabic Supplement"](Et)||yt["Arabic Extended-A"](Et)||yt["Arabic Presentation Forms-A"](Et)||yt["Arabic Presentation Forms-B"](Et))));if(hi.imageName){const La=me[hi.imageName];if(!La)continue;Gi=hi.imageName,J.iconsInText=J.iconsInText||!0,Ua=La.paddedRect;const ki=La.displaySize;aa=aa*Ya/Ne,xa={width:ki[0],height:ki[1],left:0,top:-l0,advance:Pa?ki[1]:ki[0],localGlyph:!1},wa=ze?-xa.height*aa:Wt*Ya-17-ki[1]*aa,Ji=xa.advance;const So=(Pa?ki[0]:ki[1])*aa-Ya*Wt;So>0&&So>Ht&&(Ht=So)}else{const La=_e[hi.fontStack];if(!La)continue;La[Ri]&&(Ua=La[Ri]);const ki=se[hi.fontStack];if(!ki)continue;const So=ki.glyphs[Ri];if(!So)continue;if(xa=So.metrics,Ji=Ri!==8203?Ya:0,ze){const dl=ki.ascender!==void 0?Math.abs(ki.ascender):0,ro=ki.descender!==void 0?Math.abs(ki.descender):0,Xa=(dl+ro)*aa;Ni<Xa&&(Ni=Xa,pi=(dl-ro)/2*aa),wa=-dl*aa}else wa=(Wt-aa)*Ya-17}Pa?(J.verticalizable=!0,li.push({glyph:Ri,imageName:Gi,x:Qe,y:Be+wa,vertical:Pa,scale:aa,localGlyph:xa.localGlyph,fontStack:hi.fontStack,sectionIndex:Ki,metrics:xa,rect:Ua}),Qe+=Ji*aa+We):(li.push({glyph:Ri,imageName:Gi,x:Qe,y:Be+wa,vertical:Pa,scale:aa,localGlyph:xa.localGlyph,fontStack:hi.fontStack,sectionIndex:Ki,metrics:xa,rect:Ua}),Qe+=xa.advance*aa+We)}li.length!==0&&(pt=Math.max(Qe-We,pt),ze?c0(li,dt,Ht,pi,fe*Wt/2):c0(li,dt,Ht,0,fe/2)),Qe=0;const gi=fe*Wt+Ht;Ut.lineOffset=Math.max(Ht,Zt),Be+=gi,++Lt}var Et;const ft=Be,{horizontalAlign:He,verticalAlign:Ct}=Tp(Se);(function($t,Wt,Zt,Ut,li,Ht){const Ni=(Wt-Zt)*li,pi=-Ht*Ut;for(const gi of $t)for(const Ei of gi.positionedGlyphs)Ei.x+=Ni,Ei.y+=pi})(J.positionedLines,dt,He,Ct,pt,ft),J.top+=-Ct*ft,J.bottom=J.top+ft,J.left+=-He*pt,J.right=J.left+pt,J.hasBaseline=ze}(ee,e,i,o,W,u,m,p,x,h,E,C),!function(J){for(const se of J)if(se.positionedGlyphs.length!==0)return!1;return!0}(K)&&ee}const cm={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},E3={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function r0(t,e,i,o,l,r){if(e.imageName){const u=o[e.imageName];return u?u.displaySize[0]*e.scale*Ya/r+l:0}{const u=i[e.fontStack],m=u&&u.glyphs[t];return m?m.metrics.advance*e.scale+l:0}}function d0(t,e,i,o){const l=Math.pow(t-e,2);return o?t<e?l/2:2*l:l+Math.abs(i)*i}function A3(t,e,i){let o=0;return t===10&&(o-=1e4),i&&(o+=150),t!==40&&t!==65288||(o+=50),e!==41&&e!==65289||(o+=50),o}function _0(t,e,i,o,l,r){let u=null,m=d0(e,i,l,r);for(const p of o){const h=d0(e-p.x,i,l,r)+p.badness;h<=m&&(u=p,m=h)}return{index:t,x:e,priorBreak:u,badness:m}}function u0(t){return t?u0(t.priorBreak).concat(t.index):[]}function Tp(t){let e=.5,i=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function c0(t,e,i,o,l){if(!(e||i||o||l))return;const r=t.length-1,u=t[r],m=(u.x+u.metrics.advance*u.scale)*e;for(let p=0;p<=r;p++)t[p].x-=m,t[p].y+=i+o+l}function I3(t,e,i,o){const{horizontalAlign:l,verticalAlign:r}=Tp(o),u=i[0]-t.displaySize[0]*l,m=i[1]-t.displaySize[1]*r;return{imagePrimary:t,imageSecondary:e,top:m,bottom:m+t.displaySize[1],left:u,right:u+t.displaySize[0]}}function m0(t,e,i,o,l,r){const u=t.imagePrimary;let m;if(u.content){const W=u.content,D=u.pixelRatio||1;m=[W[0]/D,W[1]/D,u.displaySize[0]-W[2]/D,u.displaySize[1]-W[3]/D]}const p=e.left*r,h=e.right*r;let y,x,E,S;i==="width"||i==="both"?(S=l[0]+p-o[3],x=l[0]+h+o[1]):(S=l[0]+(p+h-u.displaySize[0])/2,x=S+u.displaySize[0]);const C=e.top*r,w=e.bottom*r;return i==="height"||i==="both"?(y=l[1]+C-o[0],E=l[1]+w+o[2]):(y=l[1]+(C+w-u.displaySize[1])/2,E=y+u.displaySize[1]),{imagePrimary:u,imageSecondary:void 0,top:y,right:x,bottom:E,left:S,collisionPadding:m}}class vs extends qe{constructor(e,i,o,l,r){super(e,i),this.angle=l,this.z=o,r!==void 0&&(this.segment=r)}clone(){return new vs(this.x,this.y,this.z,this.angle,this.segment)}}function f0(t,e,i,o,l){if(e.segment===void 0)return!0;let r=e,u=e.segment+1,m=0;for(;m>-i/2;){if(u--,u<0)return!1;m-=t[u].dist(r),r=t[u]}m+=t[u].dist(t[u+1]),u++;const p=[];let h=0;for(;m<i/2;){const y=t[u],x=t[u+1];if(!x)return!1;let E=t[u-1].angleTo(y)-y.angleTo(x);for(E=Math.abs((E+3*Math.PI)%(2*Math.PI)-Math.PI),p.push({distance:m,angleDelta:E}),h+=E;m-p[0].distance>o;)h-=p.shift().angleDelta;if(h>l)return!1;u++,m+=y.dist(x)}return!0}function p0(t){let e=0;for(let i=0;i<t.length-1;i++)e+=t[i].dist(t[i+1]);return e}function h0(t,e,i){return t?.6*e*i:0}function g0(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function O3(t,e,i,o,l,r){const u=h0(i,l,r),m=g0(i,o)*r;let p=0;const h=p0(t)/2;for(let y=0;y<t.length-1;y++){const x=t[y],E=t[y+1],S=x.dist(E);if(p+S>h){const C=(h-p)/S,w=si(x.x,E.x,C),W=si(x.y,E.y,C),D=new vs(w,W,0,E.angleTo(x),y);return!u||f0(t,D,m,u,e)?D:void 0}p+=S}}function S3(t,e,i,o,l,r,u,m,p){const h=h0(o,r,u),y=g0(o,l),x=y*u,E=t[0].x===0||t[0].x===p||t[0].y===0||t[0].y===p;return e-x<e/4&&(e=x+e/4),y0(t,E?e/2*m%e:(y/2+2*r)*u*m%e,e,h,i,x,E,!1,p)}function y0(t,e,i,o,l,r,u,m,p){const h=r/2,y=p0(t);let x=0,E=e-i,S=[];for(let C=0;C<t.length-1;C++){const w=t[C],W=t[C+1],D=w.dist(W),Y=W.angleTo(w);for(;E+i<x+D;){E+=i;const q=(E-x)/D,K=si(w.x,W.x,q),ee=si(w.y,W.y,q);if(K>=0&&K<p&&ee>=0&&ee<p&&E-h>=0&&E+h<=y){const J=new vs(K,ee,0,Y,C);o&&!f0(t,J,r,o,l)||S.push(J)}}x+=D}return m||S.length||u||(S=y0(t,x/2,i,o,l,r,u,!0,p)),S}function b0(t,e,i,o,l){const r=[];for(let u=0;u<t.length;u++){const m=t[u];let p;for(let h=0;h<m.length-1;h++){let y=m[h],x=m[h+1];y.x<e&&x.x<e||(y.x<e?y=new qe(e,y.y+(e-y.x)/(x.x-y.x)*(x.y-y.y))._round():x.x<e&&(x=new qe(e,y.y+(e-y.x)/(x.x-y.x)*(x.y-y.y))._round()),y.y<i&&x.y<i||(y.y<i?y=new qe(y.x+(i-y.y)/(x.y-y.y)*(x.x-y.x),i)._round():x.y<i&&(x=new qe(y.x+(i-y.y)/(x.y-y.y)*(x.x-y.x),i)._round()),y.x>=o&&x.x>=o||(y.x>=o?y=new qe(o,y.y+(o-y.x)/(x.x-y.x)*(x.y-y.y))._round():x.x>=o&&(x=new qe(o,y.y+(o-y.x)/(x.x-y.x)*(x.y-y.y))._round()),y.y>=l&&x.y>=l||(y.y>=l?y=new qe(y.x+(l-y.y)/(x.y-y.y)*(x.x-y.x),l)._round():x.y>=l&&(x=new qe(y.x+(l-y.y)/(x.y-y.y)*(x.x-y.x),l)._round()),p&&y.equals(p[p.length-1])||(p=[y],r.push(p)),p.push(x)))))}}return r}function T0(t){let e=0,i=0;for(const u of t)e+=u.w*u.h,i=Math.max(i,u.w);t.sort((u,m)=>m.h-u.h);const o=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let l=0,r=0;for(const u of t)for(let m=o.length-1;m>=0;m--){const p=o[m];if(!(u.w>p.w||u.h>p.h)){if(u.x=p.x,u.y=p.y,r=Math.max(r,u.y+u.h),l=Math.max(l,u.x+u.w),u.w===p.w&&u.h===p.h){const h=o.pop();m<o.length&&(o[m]=h)}else u.h===p.h?(p.x+=u.w,p.w-=u.w):u.w===p.w?(p.y+=u.h,p.h-=u.h):(o.push({x:p.x+u.w,y:p.y,w:p.w-u.w,h:u.h}),p.y+=u.h,p.h-=u.h);break}}return{w:l,h:r,fill:e/(l*r)||0}}mt(vs,"Anchor");const Oo=1;class xp{constructor(e,{pixelRatio:i,version:o,stretchX:l,stretchY:r,content:u}){this.paddedRect=e,this.pixelRatio=i,this.stretchX=l,this.stretchY=r,this.content=u,this.version=o}get tl(){return[this.paddedRect.x+Oo,this.paddedRect.y+Oo]}get br(){return[this.paddedRect.x+this.paddedRect.w-Oo,this.paddedRect.y+this.paddedRect.h-Oo]}get displaySize(){return[(this.paddedRect.w-2*Oo)/this.pixelRatio,(this.paddedRect.h-2*Oo)/this.pixelRatio]}}class x0{constructor(e,i){const o={},l={};this.haveRenderCallbacks=[];const r=[];this.addImages(e,o,r),this.addImages(i,l,r);const{w:u,h:m}=T0(r),p=new Yo({width:u||1,height:m||1});for(const h in e){const y=e[h],x=o[h].paddedRect;Yo.copy(y.data,p,{x:0,y:0},{x:x.x+Oo,y:x.y+Oo},y.data,y.sdf)}for(const h in i){const y=i[h],x=l[h].paddedRect,E=x.x+Oo,S=x.y+Oo,C=y.data.width,w=y.data.height;Yo.copy(y.data,p,{x:0,y:0},{x:E,y:S},y.data),Yo.copy(y.data,p,{x:0,y:w-1},{x:E,y:S-1},{width:C,height:1}),Yo.copy(y.data,p,{x:0,y:0},{x:E,y:S+w},{width:C,height:1}),Yo.copy(y.data,p,{x:C-1,y:0},{x:E-1,y:S},{width:1,height:w}),Yo.copy(y.data,p,{x:0,y:0},{x:E+C,y:S},{width:1,height:w})}this.image=p,this.iconPositions=o,this.patternPositions=l}addImages(e,i,o){for(const l in e){const r=e[l],u={x:0,y:0,w:r.data.width+2*Oo,h:r.data.height+2*Oo};o.push(u),i[l]=new xp(u,r),r.hasRenderCallback&&this.haveRenderCallbacks.push(l)}}patchUpdatedImages(e,i,o){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(l=>e.hasImage(l,o)),e.dispatchRenderCallbacks(this.haveRenderCallbacks,o);for(const l in e.getUpdatedImages(o))this.patchUpdatedImage(this.iconPositions[l],e.getImage(l,o),i),this.patchUpdatedImage(this.patternPositions[l],e.getImage(l,o),i)}patchUpdatedImage(e,i,o){if(!e||!i||e.version===i.version)return;e.version=i.version;const[l,r]=e.tl,u=!!Object.keys(this.patternPositions).length;o.update(i.data,{useMipmap:u},{x:l,y:r})}}mt(xp,"ImagePosition"),mt(x0,"ImageAtlas");const bu=1e20;function v0(t,e,i,o,l,r,u,m,p){for(let h=e;h<e+o;h++)E0(t,i*r+h,r,l,u,m,p);for(let h=i;h<i+l;h++)E0(t,h*r+e,1,o,u,m,p)}function E0(t,e,i,o,l,r,u){r[0]=0,u[0]=-bu,u[1]=bu,l[0]=t[e];for(let m=1,p=0,h=0;m<o;m++){l[m]=t[e+m*i];const y=m*m;do{const x=r[p];h=(l[m]-l[x]+y-x*x)/(m-x)/2}while(h<=u[p]&&--p>-1);p++,r[p]=m,u[p]=h,u[p+1]=bu}for(let m=0,p=0;m<o;m++){for(;u[p+1]<m;)p++;const h=r[p],y=m-h;t[e+m*i]=l[h]+y*y}}const pn=2,vp={none:0,ideographs:1,all:2};class cd{constructor(e,i,o){this.requestManager=e,this.localGlyphMode=i,this.localFontFamily=o,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e,i){this.urls[i]=e}getGlyphs(e,i,o){const l=[],r=this.urls[i]||ve.GLYPHS_URL;for(const u in e)for(const m of e[u])l.push({stack:u,id:m});No(l,({stack:u,id:m},p)=>{let h=this.entries[u];h||(h=this.entries[u]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let y=h.glyphs[m];if(y!==void 0)return void p(null,{stack:u,id:m,glyph:y});if(y=this._tinySDF(h,u,m),y)return h.glyphs[m]=y,void p(null,{stack:u,id:m,glyph:y});const x=Math.floor(m/256);if(256*x>65535)return void p(new Error("glyphs > 65535 not supported"));if(h.ranges[x])return void p(null,{stack:u,id:m,glyph:y});let E=h.requests[x];E||(E=h.requests[x]=[],cd.loadGlyphRange(u,x,r,this.requestManager,(S,C)=>{if(C){h.ascender=C.ascender,h.descender=C.descender;for(const w in C.glyphs)this._doesCharSupportLocalGlyph(+w)||(h.glyphs[+w]=C.glyphs[+w]);h.ranges[x]=!0}for(const w of E)w(S,C);delete h.requests[x]})),E.push((S,C)=>{S?p(S):C&&p(null,{stack:u,id:m,glyph:C.glyphs[m]||null})})},(u,m)=>{if(u)o(u);else if(m){const p={};for(const{stack:h,id:y,glyph:x}of m)p[h]===void 0&&(p[h]={}),p[h].glyphs===void 0&&(p[h].glyphs={}),p[h].glyphs[y]=x&&{id:x.id,bitmap:x.bitmap.clone(),metrics:x.metrics},p[h].ascender=this.entries[h].ascender,p[h].descender=this.entries[h].descender;o(null,p)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==vp.none&&(this.localGlyphMode===vp.all?!!this.localFontFamily:!!this.localFontFamily&&(yt["CJK Unified Ideographs"](e)||yt["Hangul Syllables"](e)||yt.Hiragana(e)||yt.Katakana(e)||yt["CJK Symbols and Punctuation"](e)||yt["CJK Unified Ideographs Extension A"](e)||yt["CJK Unified Ideographs Extension B"](e)))}_tinySDF(e,i,o){const l=this.localFontFamily;if(!l||!this._doesCharSupportLocalGlyph(o))return;let r=e.tinySDF;if(!r){let w="400";/bold/i.test(i)?w="900":/medium/i.test(i)?w="500":/light/i.test(i)&&(w="200"),r=e.tinySDF=new cd.TinySDF({fontFamily:l,fontWeight:w,fontSize:24*pn,buffer:3*pn,radius:8*pn}),r.fontWeight=w}if(this.localGlyphs[r.fontWeight][o])return this.localGlyphs[r.fontWeight][o];const u=String.fromCodePoint(o),{data:m,width:p,height:h,glyphWidth:y,glyphHeight:x,glyphLeft:E,glyphTop:S,glyphAdvance:C}=r.draw(u);return this.localGlyphs[r.fontWeight][o]={id:o,bitmap:new el({width:p,height:h},m),metrics:{width:y/pn,height:x/pn,left:E/pn,top:S/pn-27,advance:C/pn,localGlyph:!0}}}}cd.loadGlyphRange=function(t,e,i,o,l){const r=256*e,u=r+255,m=o.transformRequest(o.normalizeGlyphsURL(i).replace("{fontstack}",t).replace("{range}",`${r}-${u}`),eo.Glyphs);Le(m,(p,h)=>{if(p)l(p);else if(h){const y={},x=function(E){return new _d(E).readFields(T3,{})}(h);for(const E of x.glyphs)y[E.id]=E;l(null,{glyphs:y,ascender:x.ascender,descender:x.descender})}})},cd.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:i=8,cutoff:o=.25,fontFamily:l="sans-serif",fontWeight:r="normal",fontStyle:u="normal"}={}){this.buffer=e,this.cutoff=o,this.radius=i;const m=this.size=t+4*e,p=this._createCanvas(m),h=this.ctx=p.getContext("2d",{willReadFrequently:!0});h.font=`${u} ${r} ${t}px ${l}`,h.textBaseline="alphabetic",h.textAlign="left",h.fillStyle="black",this.gridOuter=new Float64Array(m*m),this.gridInner=new Float64Array(m*m),this.f=new Float64Array(m),this.z=new Float64Array(m+1),this.v=new Uint16Array(m)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:i,actualBoundingBoxDescent:o,actualBoundingBoxLeft:l,actualBoundingBoxRight:r}=this.ctx.measureText(t),u=Math.ceil(i),m=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(r-l))),p=Math.min(this.size-this.buffer,u+Math.ceil(o)),h=m+2*this.buffer,y=p+2*this.buffer,x=Math.max(h*y,0),E=new Uint8ClampedArray(x),S={data:E,width:h,height:y,glyphWidth:m,glyphHeight:p,glyphTop:u,glyphLeft:0,glyphAdvance:e};if(m===0||p===0)return S;const{ctx:C,buffer:w,gridInner:W,gridOuter:D}=this;C.clearRect(w,w,m,p),C.fillText(t,w,w+u);const Y=C.getImageData(w,w,m,p);D.fill(bu,0,x),W.fill(0,0,x);for(let q=0;q<p;q++)for(let K=0;K<m;K++){const ee=Y.data[4*(q*m+K)+3]/255;if(ee===0)continue;const J=(q+w)*h+K+w;if(ee===1)D[J]=0,W[J]=bu;else{const se=.5-ee;D[J]=se>0?se*se:0,W[J]=se<0?se*se:0}}v0(D,0,0,h,y,h,this.f,this.v,this.z),v0(W,w,w,m,p,h,this.f,this.v,this.z);for(let q=0;q<x;q++){const K=Math.sqrt(D[q])-Math.sqrt(W[q]);E[q]=Math.round(255-255*(K/this.radius+this.cutoff))}return S}};const al=Oo;function A0(t,e,i,o){const l=[],r=t.imagePrimary,u=r.pixelRatio,m=r.paddedRect.w-2*al,p=r.paddedRect.h-2*al,h=t.right-t.left,y=t.bottom-t.top,x=r.stretchX||[[0,m]],E=r.stretchY||[[0,p]],S=(fe,Se)=>fe+Se[1]-Se[0],C=x.reduce(S,0),w=E.reduce(S,0),W=m-C,D=p-w;let Y=0,q=C,K=0,ee=w,J=0,se=W,_e=0,me=D;if(r.content&&o){const fe=r.content;Y=mm(x,0,fe[0]),K=mm(E,0,fe[1]),q=mm(x,fe[0],fe[2]),ee=mm(E,fe[1],fe[3]),J=fe[0]-Y,_e=fe[1]-K,se=fe[2]-fe[0]-q,me=fe[3]-fe[1]-ee}const be=(fe,Se,De,Ae)=>{const We=fm(fe.stretch-Y,q,h,t.left),xe=pm(fe.fixed-J,se,fe.stretch,C),Ne=fm(Se.stretch-K,ee,y,t.top),Qe=pm(Se.fixed-_e,me,Se.stretch,w),Be=fm(De.stretch-Y,q,h,t.left),pt=pm(De.fixed-J,se,De.stretch,C),dt=fm(Ae.stretch-K,ee,y,t.top),ze=pm(Ae.fixed-_e,me,Ae.stretch,w),Lt=new qe(We,Ne),Et=new qe(Be,Ne),ft=new qe(Be,dt),He=new qe(We,dt),Ct=new qe(xe/u,Qe/u),$t=new qe(pt/u,ze/u),Wt=e*Math.PI/180;if(Wt){const pi=Math.sin(Wt),gi=Math.cos(Wt),Ei=[gi,-pi,pi,gi];Lt._matMult(Ei),Et._matMult(Ei),He._matMult(Ei),ft._matMult(Ei)}const Zt=fe.stretch+fe.fixed,Ut=De.stretch+De.fixed,li=Se.stretch+Se.fixed,Ht=Ae.stretch+Ae.fixed,Ni=t.imageSecondary;return{tl:Lt,tr:Et,bl:He,br:ft,texPrimary:{x:r.paddedRect.x+al+Zt,y:r.paddedRect.y+al+li,w:Ut-Zt,h:Ht-li},texSecondary:Ni?{x:Ni.paddedRect.x+al+Zt,y:Ni.paddedRect.y+al+li,w:Ut-Zt,h:Ht-li}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ct,pixelOffsetBR:$t,minFontScaleX:se/u/h,minFontScaleY:me/u/y,isSDF:i}};if(o&&(r.stretchX||r.stretchY)){const fe=I0(x,W,C),Se=I0(E,D,w);for(let De=0;De<fe.length-1;De++){const Ae=fe[De],We=fe[De+1];for(let xe=0;xe<Se.length-1;xe++)l.push(be(Ae,Se[xe],We,Se[xe+1]))}}else l.push(be({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:m+1},{fixed:0,stretch:p+1}));return l}function mm(t,e,i){let o=0;for(const l of t)o+=Math.max(e,Math.min(i,l[1]))-Math.max(e,Math.min(i,l[0]));return o}function I0(t,e,i){const o=[{fixed:-al,stretch:0}];for(const[l,r]of t){const u=o[o.length-1];o.push({fixed:l-u.stretch,stretch:u.stretch}),o.push({fixed:l-u.stretch,stretch:u.stretch+(r-l)})}return o.push({fixed:e+al,stretch:i}),o}function fm(t,e,i,o){return t/e*i+o}function pm(t,e,i,o){return t-e*i/o}function R3(t,e,i,o){const l=e+t.positionedLines[o].lineOffset;return o===0?i+l/2:i+(l+(e+t.positionedLines[o-1].lineOffset))/2}function C3(t,e=1,i=!1){let o=1/0,l=1/0,r=-1/0,u=-1/0;const m=t[0];for(let S=0;S<m.length;S++){const C=m[S];(!S||C.x<o)&&(o=C.x),(!S||C.y<l)&&(l=C.y),(!S||C.x>r)&&(r=C.x),(!S||C.y>u)&&(u=C.y)}const p=Math.min(r-o,u-l);let h=p/2;const y=new Io([],w3);if(p===0)return new qe(o,l);for(let S=o;S<r;S+=p)for(let C=l;C<u;C+=p)y.push(new md(S+h,C+h,h,t));let x=function(S){let C=0,w=0,W=0;const D=S[0];for(let Y=0,q=D.length,K=q-1;Y<q;K=Y++){const ee=D[Y],J=D[K],se=ee.x*J.y-J.x*ee.y;w+=(ee.x+J.x)*se,W+=(ee.y+J.y)*se,C+=3*se}return new md(w/C,W/C,0,S)}(t),E=y.length;for(;y.length;){const S=y.pop();(S.d>x.d||!x.d)&&(x=S,i&&console.log("found best %d after %d probes",Math.round(1e4*S.d)/1e4,E)),S.max-x.d<=e||(h=S.h/2,y.push(new md(S.p.x-h,S.p.y-h,h,t)),y.push(new md(S.p.x+h,S.p.y-h,h,t)),y.push(new md(S.p.x-h,S.p.y+h,h,t)),y.push(new md(S.p.x+h,S.p.y+h,h,t)),E+=4)}return i&&(console.log(`num probes: ${E}`),console.log(`best distance: ${x.d}`)),x.p}function w3(t,e){return e.max-t.max}class md{constructor(e,i,o,l){this.p=new qe(e,i),this.h=o,this.d=function(r,u){let m=!1,p=1/0;for(let h=0;h<u.length;h++){const y=u[h];for(let x=0,E=y.length,S=E-1;x<E;S=x++){const C=y[x],w=y[S];C.y>r.y!=w.y>r.y&&r.x<(w.x-C.x)*(r.y-C.y)/(w.y-C.y)+C.x&&(m=!m),p=Math.min(p,Xs(r,C,w))}}return(m?1:-1)*Math.sqrt(p)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}}const Ep=Number.POSITIVE_INFINITY,P3=Math.sqrt(2);function O0(t,[e,i]){let o=0,l=0;if(i===Ep){e<0&&(e=0);const r=e/P3;switch(t){case"top-right":case"top-left":l=r-7;break;case"bottom-right":case"bottom-left":l=7-r;break;case"bottom":l=7-e;break;case"top":l=e-7}switch(t){case"top-right":case"bottom-right":o=-r;break;case"top-left":case"bottom-left":o=r;break;case"left":o=e;break;case"right":o=-e}}else{switch(e=Math.abs(e),i=Math.abs(i),t){case"top-right":case"top-left":case"top":l=i-7;break;case"bottom-right":case"bottom-left":case"bottom":l=7-i}switch(t){case"top-right":case"bottom-right":case"right":o=-e;break;case"top-left":case"bottom-left":case"left":o=e}}return[o,l]}function Ap(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function L3(t,e,i,o,l,r,u,m,p,h,y,x,E,S,C){let w=r.textMaxSize.evaluate(e,{},x);w===void 0&&(w=u);const W=t.layers[0].layout,D=W.get("icon-offset").evaluate(e,{},x),Y=R0(i.horizontal)||i.vertical,q=E.name==="globe",K=Ya,ee=u/K,J=t.tilePixelRatio*w/K,se=(We=t.overscaling,t.zoom>18&&We>2&&(We>>=1),Math.max(st/(512*We),1)*W.get("symbol-spacing")),_e=W.get("text-padding")*t.tilePixelRatio,me=W.get("icon-padding")*t.tilePixelRatio,be=Ot(W.get("text-max-angle")),fe=W.get("text-rotation-alignment")==="map"&&W.get("symbol-placement")!=="point",Se=W.get("icon-rotation-alignment")==="map"&&W.get("symbol-placement")!=="point",De=W.get("symbol-placement"),Ae=se/2;var We;const xe=W.get("icon-text-fit").evaluate(e,{},x),Ne=W.get("icon-text-fit-padding").evaluate(e,{},x),Qe=xe!=="none";let Be;t.hasAnyIconTextFit===!1&&Qe&&(t.hasAnyIconTextFit=!0),o&&Qe&&(t.allowVerticalPlacement&&i.vertical&&(Be=m0(o,i.vertical,xe,Ne,D,ee)),Y&&(o=m0(o,Y,xe,Ne,D,ee)));const pt=(dt,ze,Lt)=>{if(ze.x<0||ze.x>=st||ze.y<0||ze.y>=st)return;let Et=null;if(q){const{x:ft,y:He,z:Ct}=E.projectTilePoint(ze.x,ze.y,Lt);Et={anchor:new vs(ft,He,Ct,0,void 0),up:E.upVector(Lt,ze.x,ze.y)}}(function(ft,He,Ct,$t,Wt,Zt,Ut,li,Ht,Ni,pi,gi,Ei,hi,Ki,Ri,aa,xa,Ua,Gi,Ji,wa,Pa,La,ki,So,dl){const ro=ft.addToLineVertexArray(He,$t);let Xa,jo,Mu,Dm,R1,C1,w1,P1=0,L1=0,N1=0,W1=0,qp=-1,$p=-1;const qn={};let M1=nu("");const cr=Ct?Ct.anchor:He,Zp=Ht.layout.get("icon-text-fit").evaluate(Ji,{},ki)!=="none";let Xp=0,Jp=0;if(Ht._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Xp,Jp]=Ht.layout.get("text-offset").evaluate(Ji,{},ki).map(Ro=>Ro*Ya):(Xp=Ht.layout.get("text-radial-offset").evaluate(Ji,{},ki)*Ya,Jp=Ep),ft.allowVerticalPlacement&&Wt.vertical){const Ro=Wt.vertical;if(Ki)C1=Ip(Ro),li&&(w1=Ip(li));else{const Co=Ht.layout.get("text-rotate").evaluate(Ji,{},ki)+90;Mu=hm(Ni,cr,He,pi,gi,Ei,Ro,hi,Co,Ri),li&&(Dm=hm(Ni,cr,He,pi,gi,Ei,li,xa,Co))}}if(Zt){const Ro=Ht.layout.get("icon-rotate").evaluate(Ji,{},ki),Co=A0(Zt,Ro,Pa,Zp),xd=li?A0(li,Ro,Pa,Zp):void 0;jo=hm(Ni,cr,He,pi,gi,Ei,Zt,xa,Ro),P1=4*Co.length;const D1=ft.iconSizeData;let mr=null;D1.kind==="source"?(mr=[fn*Ht.layout.get("icon-size").evaluate(Ji,{},ki)],mr[0]>ol&&ta(`${ft.layerIds[0]}: Value for "icon-size" is >= ${Tu}. Reduce your "icon-size".`)):D1.kind==="composite"&&(mr=[fn*wa.compositeIconSizes[0].evaluate(Ji,{},ki),fn*wa.compositeIconSizes[1].evaluate(Ji,{},ki)],(mr[0]>ol||mr[1]>ol)&&ta(`${ft.layerIds[0]}: Value for "icon-size" is >= ${Tu}. Reduce your "icon-size".`)),ft.addSymbols(ft.icon,Co,mr,Gi,Ua,Ji,!1,Ct,He,ro.lineStartIndex,ro.lineLength,-1,La,ki,So,dl),qp=ft.icon.placedSymbolArray.length-1,xd&&(L1=4*xd.length,ft.addSymbols(ft.icon,xd,mr,Gi,Ua,Ji,Go.vertical,Ct,He,ro.lineStartIndex,ro.lineLength,-1,La,ki,So,dl),$p=ft.icon.placedSymbolArray.length-1)}for(const Ro in Wt.horizontal){const Co=Wt.horizontal[Ro];Xa||(M1=nu(Co.text),Ki?R1=Ip(Co):Xa=hm(Ni,cr,He,pi,gi,Ei,Co,hi,Ht.layout.get("text-rotate").evaluate(Ji,{},ki),Ri));const xd=Co.positionedLines.length===1;if(N1+=S0(ft,Ct,He,Co,Ut,Ht,Ki,Ji,Ri,ro,Wt.vertical?Go.horizontal:Go.horizontalOnly,xd?Object.keys(Wt.horizontal):[Ro],qn,qp,wa,La,ki,So),xd)break}Wt.vertical&&(W1+=S0(ft,Ct,He,Wt.vertical,Ut,Ht,Ki,Ji,Ri,ro,Go.vertical,["vertical"],qn,$p,wa,La,ki,So));let _l=-1;const Qp=(Ro,Co)=>Ro?Math.max(Ro,Co):Co;_l=Qp(R1,_l),_l=Qp(C1,_l),_l=Qp(w1,_l);const Zx=_l>-1?1:0;ft.glyphOffsetArray.length>=65535&&ta("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ji.sortKey!==void 0&&ft.addToSortKeyRanges(ft.symbolInstances.length,Ji.sortKey),ft.symbolInstances.emplaceBack(He.x,He.y,cr.x,cr.y,cr.z,qn.right>=0?qn.right:-1,qn.center>=0?qn.center:-1,qn.left>=0?qn.left:-1,qn.vertical>=0?qn.vertical:-1,qp,$p,M1,Xa!==void 0?Xa:ft.collisionBoxArray.length,Xa!==void 0?Xa+1:ft.collisionBoxArray.length,Mu!==void 0?Mu:ft.collisionBoxArray.length,Mu!==void 0?Mu+1:ft.collisionBoxArray.length,jo!==void 0?jo:ft.collisionBoxArray.length,jo!==void 0?jo+1:ft.collisionBoxArray.length,Dm||ft.collisionBoxArray.length,Dm?Dm+1:ft.collisionBoxArray.length,pi,N1,W1,P1,L1,Zx,0,Xp,Jp,_l,0,Zp?1:0)})(t,ze,Et,dt,i,o,l,Be,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,_e,fe,p,0,me,Se,D,e,r,h,y,x,S,C)};if(De==="line")for(const dt of b0(e.geometry,0,0,st,st)){const ze=S3(dt,se,be,i.vertical||Y,o,K,J,t.overscaling,st);for(const Lt of ze)Y&&N3(t,Y.text,Ae,Lt)||pt(dt,Lt,x)}else if(De==="line-center"){for(const dt of e.geometry)if(dt.length>1){const ze=O3(dt,be,i.vertical||Y,o,K,J);ze&&pt(dt,ze,x)}}else if(e.type==="Polygon")for(const dt of dp(e.geometry,0)){const ze=C3(dt,16);pt(dt[0],new vs(ze.x,ze.y,0,0,void 0),x)}else if(e.type==="LineString")for(const dt of e.geometry)pt(dt,new vs(dt[0].x,dt[0].y,0,0,void 0),x);else if(e.type==="Point")for(const dt of e.geometry)for(const ze of dt)pt([ze],new vs(ze.x,ze.y,0,0,void 0),x)}const Tu=255,ol=Tu*fn;function S0(t,e,i,o,l,r,u,m,p,h,y,x,E,S,C,w,W,D){const Y=function(ee,J,se,_e,me,be,fe,Se){const De=[];if(J.positionedLines.length===0)return De;const Ae=_e.layout.get("text-rotate").evaluate(be,{})*Math.PI/180,We=function(pt){const dt=pt[0],ze=pt[1],Lt=dt*ze;return Lt>0?[dt,-ze]:Lt<0?[-dt,ze]:dt===0?[ze,dt]:[ze,-dt]}(se);let xe=Math.abs(J.top-J.bottom);for(const pt of J.positionedLines)xe-=pt.lineOffset;const Ne=J.positionedLines.length,Qe=xe/Ne;let Be=J.top-se[1];for(let pt=0;pt<Ne;++pt){const dt=J.positionedLines[pt];Be=R3(J,Qe,Be,pt);for(const ze of dt.positionedGlyphs){if(!ze.rect)continue;const Lt=ze.rect||{};let Et=l0+1,ft=!0,He=1,Ct=0;if(ze.imageName){const Gi=fe[ze.imageName];if(!Gi)continue;if(Gi.sdf){ta("SDF images are not supported in formatted text and will be ignored.");continue}ft=!1,He=Gi.pixelRatio,Et=Oo/He}const $t=(me||Se)&&ze.vertical,Wt=ze.metrics.advance*ze.scale/2,Zt=ze.metrics,Ut=ze.rect;if(Ut===null)continue;Se&&J.verticalizable&&(Ct=ze.imageName?Wt-ze.metrics.width*ze.scale/2:0);const li=me?[ze.x+Wt,ze.y]:[0,0];let Ht=[0,0],Ni=[0,0],pi=!1;me||($t?(Ni=[ze.x+Wt+We[0],ze.y+We[1]-Ct],pi=!0):Ht=[ze.x+Wt+se[0],ze.y+se[1]-Ct]);const gi=Ut.w*ze.scale/(He*(ze.localGlyph?pn:1)),Ei=Ut.h*ze.scale/(He*(ze.localGlyph?pn:1));let hi,Ki,Ri,aa;if($t){const Gi=ze.y-Be,Ji=new qe(-Wt,Wt-Gi),wa=-Math.PI/2,Pa=new qe(...Ni);hi=new qe(-Wt+Ht[0],Ht[1]),hi._rotateAround(wa,Ji)._add(Pa),hi.x+=-Gi+Wt,hi.y-=(Zt.left-Et)*ze.scale;const La=ze.imageName?Zt.advance*ze.scale:Ya*ze.scale,ki=String.fromCodePoint(ze.glyph);r3(ki)?hi.x+=(1-Et)*ze.scale:d3(ki)?hi.x+=La-Zt.height*ze.scale+(-Et-1)*ze.scale:hi.x+=ze.imageName||Zt.width+2*Et===Ut.w&&Zt.height+2*Et===Ut.h?(La-Ei)/2:(La-(Zt.height+2*Et)*ze.scale)/2,Ki=new qe(hi.x,hi.y-gi),Ri=new qe(hi.x+Ei,hi.y),aa=new qe(hi.x+Ei,hi.y-gi)}else{const Gi=(Zt.left-Et)*ze.scale-Wt+Ht[0],Ji=(-Zt.top-Et)*ze.scale+Ht[1],wa=Gi+gi,Pa=Ji+Ei;hi=new qe(Gi,Ji),Ki=new qe(wa,Ji),Ri=new qe(Gi,Pa),aa=new qe(wa,Pa)}if(Ae){let Gi;Gi=me?new qe(0,0):pi?new qe(We[0],We[1]):new qe(se[0],se[1]),hi._rotateAround(Ae,Gi),Ki._rotateAround(Ae,Gi),Ri._rotateAround(Ae,Gi),aa._rotateAround(Ae,Gi)}const xa=new qe(0,0),Ua=new qe(0,0);De.push({tl:hi,tr:Ki,bl:Ri,br:aa,texPrimary:Lt,texSecondary:void 0,writingMode:J.writingMode,glyphOffset:li,sectionIndex:ze.sectionIndex,isSDF:ft,pixelOffsetTL:xa,pixelOffsetBR:Ua,minFontScaleX:0,minFontScaleY:0})}}return De}(0,o,p,r,u,m,l,t.allowVerticalPlacement),q=t.textSizeData;let K=null;q.kind==="source"?(K=[fn*r.layout.get("text-size").evaluate(m,{},W)],K[0]>ol&&ta(`${t.layerIds[0]}: Value for "text-size" is >= ${Tu}. Reduce your "text-size".`)):q.kind==="composite"&&(K=[fn*C.compositeTextSizes[0].evaluate(m,{},W),fn*C.compositeTextSizes[1].evaluate(m,{},W)],(K[0]>ol||K[1]>ol)&&ta(`${t.layerIds[0]}: Value for "text-size" is >= ${Tu}. Reduce your "text-size".`)),t.addSymbols(t.text,Y,K,p,u,m,y,e,i,h.lineStartIndex,h.lineLength,S,w,W,D,!1);for(const ee of x)E[ee]=t.text.placedSymbolArray.length-1;return 4*Y.length}function R0(t){for(const e in t)return t[e];return null}function hm(t,e,i,o,l,r,u,m,p,h){let y=u.top,x=u.bottom,E=u.left,S=u.right;const C=u.collisionPadding;if(C&&(E-=C[0],y-=C[1],S+=C[2],x+=C[3]),p){const w=new qe(E,y),W=new qe(S,y),D=new qe(E,x),Y=new qe(S,x),q=Ot(p);let K=new qe(0,0);h&&(K=new qe(h[0],h[1])),w._rotateAround(q,K),W._rotateAround(q,K),D._rotateAround(q,K),Y._rotateAround(q,K),E=Math.min(w.x,W.x,D.x,Y.x),S=Math.max(w.x,W.x,D.x,Y.x),y=Math.min(w.y,W.y,D.y,Y.y),x=Math.max(w.y,W.y,D.y,Y.y)}return t.emplaceBack(e.x,e.y,e.z,i.x,i.y,E,y,S,x,m,o,l,r),t.length-1}function Ip(t){t.collisionPadding&&(t.top-=t.collisionPadding[1],t.bottom+=t.collisionPadding[3]);const e=t.bottom-t.top;return e>0?Math.max(10,e):null}function N3(t,e,i,o){const l=t.compareText;if(e in l){const r=l[e];for(let u=r.length-1;u>=0;u--)if(o.dist(r[u])<i)return!0}else l[e]=[];return l[e].push(o),!1}function C0(t,e){const i=t.fovAboveCenter,o=t.elevation?t.elevation.getMinElevationBelowMSL()*e:0,l=(t._camera.position[2]*t.worldSize-o)/Math.cos(t._pitch),r=Math.sin(i)*l/Math.sin(Math.max(Math.PI/2-t._pitch-i,.01)),u=Math.sin(t._pitch)*r+l;return Math.min(1.01*u,l*(1/t._horizonShift))}function xu(t,e){if(!e.isReprojectedInTileSpace)return{scale:1<<t.z,x:t.x,y:t.y,x2:t.x+1,y2:t.y+1,projection:e};const i=Math.pow(2,-t.z),o=t.x*i,l=(t.x+1)*i,r=t.y*i,u=(t.y+1)*i,m=kt(o),p=kt(l),h=di(r),y=di(u),x=e.project(m,h),E=e.project(p,h),S=e.project(p,y),C=e.project(m,y);let w=Math.min(x.x,E.x,S.x,C.x),W=Math.min(x.y,E.y,S.y,C.y),D=Math.max(x.x,E.x,S.x,C.x),Y=Math.max(x.y,E.y,S.y,C.y);const q=i/16;function K(J,se,_e,me,be,fe){const Se=(_e+be)/2,De=(me+fe)/2,Ae=e.project(kt(Se),di(De)),We=Math.max(0,w-Ae.x,W-Ae.y,Ae.x-D,Ae.y-Y);w=Math.min(w,Ae.x),D=Math.max(D,Ae.x),W=Math.min(W,Ae.y),Y=Math.max(Y,Ae.y),We>q&&(K(J,Ae,_e,me,Se,De),K(Ae,se,Se,De,be,fe))}K(x,E,o,r,l,r),K(E,S,l,r,l,u),K(S,C,l,u,o,u),K(C,x,o,u,o,r),w-=q,W-=q,D+=q,Y+=q;const ee=1/Math.max(D-w,Y-W);return{scale:ee,x:w*ee,y:W*ee,x2:D*ee,y2:Y*ee,projection:e}}function w0(t,{x:e,y:i},o=0){return new qe(((e-o)*t.scale-t.x)*st,(i*t.scale-t.y)*st)}const W3=s.a6.identity(new Float32Array(16));class nl{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,i){return{x:0,y:0,z:0}}unproject(e,i){return new ce(0,0)}projectTilePoint(e,i,o){return{x:e,y:i,z:0}}locationPoint(e,i,o=!0){return e._coordinatePoint(e.locationCoordinate(i),o)}pixelsPerMeter(e,i){return zt(1,e)*i}pixelSpaceConversion(e,i,o){return 1}farthestPixelDistance(e){return C0(e,e.pixelsPerMeter)}pointCoordinate(e,i,o,l){const r=e.horizonLineFromTop(!1),u=new qe(i,Math.max(r,o));return e.rayIntersectionCoordinate(e.pointRayIntersection(u,l))}pointCoordinate3D(e,i,o){const l=new qe(i,o);if(e.elevation)return e.elevation.pointCoordinate(l);{const r=this.pointCoordinate(e,l.x,l.y,0);return[r.x,r.y,r.z]}}isPointAboveHorizon(e,i){if(e.elevation)return!this.pointCoordinate3D(e,i.x,i.y);const o=e.horizonLineFromTop();return i.y<o}createInversionMatrix(e,i){return W3}createTileMatrix(e,i,o){let l,r,u;const m=o.canonical,p=s.a6.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const h=xu(m,this);l=1,r=h.x+o.wrap*h.scale,u=h.y,s.a6.scale(p,p,[l/h.scale,l/h.scale,e.pixelsPerMeter/i])}else l=i/e.zoomScale(m.z),r=(m.x+Math.pow(2,m.z)*o.wrap)*l,u=m.y*l;return s.a6.translate(p,p,[r,u,0]),s.a6.scale(p,p,[l/st,l/st,1]),p}upVector(e,i,o){return[0,0,1]}upVectorScale(e,i,o){return{metersToTile:1}}}class M3 extends nl{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[i,o]=this.parallels=e.parallels||[29.5,45.5],l=Math.sin(Ot(i));this.n=(l+Math.sin(Ot(o)))/2,this.c=1+l*(2*this.n-l),this.r0=Math.sqrt(this.c)/this.n}project(e,i){const{n:o,c:l,r0:r}=this,u=Ot(e-this.center[0]),m=Ot(i),p=Math.sqrt(l-2*o*Math.sin(m))/o;return{x:p*Math.sin(u*o),y:p*Math.cos(u*o)-r,z:0}}unproject(e,i){const{n:o,c:l,r0:r}=this,u=r+i;let m=Math.atan2(e,Math.abs(u))*Math.sign(u);u*o<0&&(m-=Math.PI*Math.sign(e)*Math.sign(u));const p=Ot(this.center[0])*o;m=Na(m,-Math.PI-p,Math.PI-p);const h=Vt(na(m/o)+this.center[0],-180,180),y=Math.asin(Vt((l-(e*e+u*u)*o*o)/(2*o),-1,1)),x=Vt(na(y),-ei,ei);return new ce(h,x)}}const vu=1.340264,Eu=-.081106,Au=893e-6,Iu=.003796,gm=Math.sqrt(3)/2;class D3 extends nl{project(e,i){i=i/180*Math.PI,e=e/180*Math.PI;const o=Math.asin(gm*Math.sin(i)),l=o*o,r=l*l*l;return{x:.5*(e*Math.cos(o)/(gm*(vu+3*Eu*l+r*(7*Au+9*Iu*l)))/Math.PI+.5),y:1-.5*(o*(vu+Eu*l+r*(Au+Iu*l))/Math.PI+1),z:0}}unproject(e,i){e=(2*e-.5)*Math.PI;let o=i=(2*(1-i)-1)*Math.PI,l=o*o,r=l*l*l;for(let y,x,E,S=0;S<12&&(x=o*(vu+Eu*l+r*(Au+Iu*l))-i,E=vu+3*Eu*l+r*(7*Au+9*Iu*l),y=x/E,o=Vt(o-y,-Math.PI/3,Math.PI/3),l=o*o,r=l*l*l,!(Math.abs(y)<1e-12));++S);const u=gm*e*(vu+3*Eu*l+r*(7*Au+9*Iu*l))/Math.cos(o),m=Math.asin(Math.sin(o)/gm),p=Vt(180*u/Math.PI,-180,180),h=Vt(180*m/Math.PI,-ei,ei);return new ce(p,h)}}class F3 extends nl{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,i){return{x:.5+e/360,y:.5-i/360,z:0}}unproject(e,i){const o=360*(e-.5),l=Vt(360*(.5-i),-ei,ei);return new ce(o,l)}}const fd=Math.PI/2;function ym(t){return Math.tan((fd+t)/2)}class B3 extends nl{constructor(e){super(e),this.center=e.center||[0,30];const[i,o]=this.parallels=e.parallels||[30,30];let l=Ot(i),r=Ot(o);this.southernCenter=l+r<0,this.southernCenter&&(l=-l,r=-r);const u=Math.cos(l),m=ym(l);this.n=l===r?Math.sin(l):Math.log(u/Math.cos(r))/Math.log(ym(r)/m),this.f=u*Math.pow(ym(l),this.n)/this.n}project(e,i){i=Ot(i),this.southernCenter&&(i=-i),e=Ot(e-this.center[0]);const o=1e-6,{n:l,f:r}=this;r>0?i<-fd+o&&(i=-fd+o):i>fd-o&&(i=fd-o);const u=r/Math.pow(ym(i),l);let m=u*Math.sin(l*e),p=r-u*Math.cos(l*e);return m=.5*(m/Math.PI+.5),p=.5*(p/Math.PI+.5),{x:m,y:this.southernCenter?p:1-p,z:0}}unproject(e,i){e=(2*e-.5)*Math.PI,this.southernCenter&&(i=1-i),i=(2*(1-i)-.5)*Math.PI;const{n:o,f:l}=this,r=l-i,u=Math.sign(r),m=Math.sign(o)*Math.sqrt(e*e+r*r);let p=Math.atan2(e,Math.abs(r))*u;r*o<0&&(p-=Math.PI*Math.sign(e)*u);const h=Vt(na(p/o)+this.center[0],-180,180),y=Vt(na(2*Math.atan(Math.pow(l/m,1/o))-fd),-ei,ei);return new ce(h,this.southernCenter?-y:y)}}class P0 extends nl{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,i){return{x:jt(e),y:Ft(i),z:0}}unproject(e,i){const o=kt(e),l=di(i);return new ce(o,l)}}const L0=Ot(ei);class U3 extends nl{project(e,i){const o=(i=Ot(i))*i,l=o*o;return{x:.5*((e=Ot(e))*(.8707-.131979*o+l*(l*(.003971*o-.001529*l)-.013791))/Math.PI+.5),y:1-.5*(i*(1.007226+o*(.015085+l*(.028874*o-.044475-.005916*l)))/Math.PI+1),z:0}}unproject(e,i){e=(2*e-.5)*Math.PI;let o=i=(2*(1-i)-1)*Math.PI,l=25,r=0,u=o*o;do{u=o*o;const h=u*u;r=(o*(1.007226+u*(.015085+h*(.028874*u-.044475-.005916*h)))-i)/(1.007226+u*(.045255+h*(.259866*u-.311325-.005916*11*h))),o=Vt(o-r,-L0,L0)}while(Math.abs(r)>1e-6&&--l>0);u=o*o;const m=Vt(na(e/(.8707+u*(u*(u*u*u*(.003971-.001529*u)-.013791)-.131979))),-180,180),p=na(o);return new ce(m,p)}}const N0=Ot(ei);class k3 extends nl{project(e,i){i=Ot(i),e=Ot(e);const o=Math.cos(i),l=2/Math.PI,r=Math.acos(o*Math.cos(e/2)),u=Math.sin(r)/r,m=.5*(e*l+2*o*Math.sin(e/2)/u)||0,p=.5*(i+Math.sin(i)/u)||0;return{x:.5*(m/Math.PI+.5),y:1-.5*(p/Math.PI+1),z:0}}unproject(e,i){let o=e=(2*e-.5)*Math.PI,l=i=(2*(1-i)-1)*Math.PI,r=25;const u=1e-6;let m=0,p=0;do{const h=Math.cos(l),y=Math.sin(l),x=2*y*h,E=y*y,S=h*h,C=Math.cos(o/2),w=Math.sin(o/2),W=2*C*w,D=w*w,Y=1-S*C*C,q=Y?1/Y:0,K=Y?Math.acos(h*C)*Math.sqrt(1/Y):0,ee=.5*(2*K*h*w+2*o/Math.PI)-e,J=.5*(K*y+l)-i,se=.5*q*(S*D+K*h*C*E)+1/Math.PI,_e=q*(W*x/4-K*y*w),me=.125*q*(x*w-K*y*S*W),be=.5*q*(E*C+K*D*h)+.5,fe=_e*me-be*se;m=(J*_e-ee*be)/fe,p=(ee*me-J*se)/fe,o=Vt(o-m,-Math.PI,Math.PI),l=Vt(l-p,-N0,N0)}while((Math.abs(m)>u||Math.abs(p)>u)&&--r>0);return new ce(na(o),na(l))}}class W0 extends nl{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Ot(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,i){const{scale:o,cosPhi:l}=this;return{x:Ot(e)*l*o+.5,y:-Math.sin(Ot(i))/l*o+.5,z:0}}unproject(e,i){const{scale:o,cosPhi:l}=this,r=-(i-.5)/o,u=Vt(na((e-.5)/o)/l,-180,180),m=Math.asin(Vt(r*l,-1,1)),p=Vt(na(m),-ei,ei);return new ce(u,p)}}class z3 extends P0{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,i,o){const l=du(e,i,o),r=Zc(Kn(o));return s.N.transformMat4(l,l,r),{x:l[0],y:l[1],z:l[2]}}locationPoint(e,i){const o=Ie(i.lat,i.lng),l=s.N.normalize([],o),r=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(i),e._centerAltitude):e._centerAltitude,u=zt(1,0)*st*r;s.N.scaleAndAdd(o,o,l,u);const m=s.a6.identity(new Float64Array(16));return s.a6.multiply(m,e.pixelMatrix,e.globeMatrix),s.N.transformMat4(o,o,m),new qe(o[0],o[1])}pixelsPerMeter(e,i){return zt(1,0)*i}pixelSpaceConversion(e,i,o){const l=zt(1,e)*i,r=si(zt(1,45)*i,l,o);return this.pixelsPerMeter(e,i)/r}createTileMatrix(e,i,o){const l=tp(Kn(o.canonical));return s.a6.multiply(new Float64Array(16),e.globeMatrix,l)}createInversionMatrix(e,i){const{center:o}=e,l=Zc(Kn(i));return s.a6.rotateY(l,l,Ot(o.lng)),s.a6.rotateX(l,l,Ot(o.lat)),s.a6.scale(l,l,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(l)}pointCoordinate(e,i,o,l){return Xg(e,i,o,!0)||new mi(0,0)}pointCoordinate3D(e,i,o){const l=this.pointCoordinate(e,i,o,0);return[l.x,l.y,l.z]}isPointAboveHorizon(e,i){return!Xg(e,i.x,i.y,!1)}farthestPixelDistance(e){const i=function(l,r){const u=l.cameraToCenterDistance,m=l._centerAltitude*r,p=l._camera,h=l._camera.forward(),y=s.N.add([],s.N.scale([],h,-u),[0,0,m]),x=l.worldSize/(2*Math.PI),E=[0,0,-x],S=l.width/l.height,C=Math.tan(l.fovAboveCenter),w=s.N.scale([],p.up(),C),W=s.N.scale([],p.right(),C*S),D=s.N.normalize([],s.N.add([],s.N.add([],h,w),W)),Y=[];let q;if(new Zf(y,D).closestPointOnSphere(E,x,Y)){const K=s.N.add([],Y,E),ee=s.N.sub([],K,y);q=Math.cos(l.fovAboveCenter)*s.N.length(ee)}else{const K=s.N.sub([],y,E),ee=s.N.sub([],E,y);s.N.normalize(ee,ee);const J=s.N.length(K)-x;q=Math.sqrt(J*(J+2*x));const se=Math.acos(q/(x+J))-Math.acos(s.N.dot(h,ee));q*=Math.cos(se)}return 1.01*q}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),o=Qs(e.zoom);if(o>0){const l=C0(e,zt(1,e.center.lat)*e.worldSize),r=e.worldSize/(2*Math.PI),u=Math.max(e.width,e.height)/e.worldSize*Math.PI;return si(i,l+r*(1-Math.cos(u)),Math.pow(o,10))}return i}upVector(e,i,o){return du(i,o,e,1)}upVectorScale(e){return{metersToTile:Kc($c(Kn(e)))}}}function M0(t){const e=t.parallels,i=!!e&&Math.abs(e[0]+e[1])<.01;switch(t.name){case"mercator":return new P0(t);case"equirectangular":return new F3(t);case"naturalEarth":return new U3(t);case"equalEarth":return new D3(t);case"winkelTripel":return new k3(t);case"albers":return i?new W0(t):new M3(t);case"lambertConformalConic":return i?new W0(t):new B3(t);case"globe":return new z3(t)}throw new Error(`Invalid projection name: ${t.name}`)}const H3=am.types,Y3=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function bm(t,e,i,o,l,r,u,m,p,h,y,x,E){const S=m?Math.min(ol,Math.round(m[0])):0,C=m?Math.min(ol,Math.round(m[1])):0;t.emplaceBack(e,i,Math.round(32*o),Math.round(32*l),r,u,(S<<1)+(p?1:0),C,16*h,16*y,256*x,256*E)}function Tm(t,e,i){t.emplaceBack(e,i)}function xm(t,e,i,o,l,r,u){t.emplaceBack(e,i,o,l,r,u)}function vm(t,e,i,o,l){t.emplaceBack(e,i,o,l),t.emplaceBack(e,i,o,l),t.emplaceBack(e,i,o,l),t.emplaceBack(e,i,o,l)}function G3(t){for(const e of t.sections)if(N_(e.text))return!0;return!1}class Op{constructor(e){this.layoutVertexArray=new Kl,this.indexArray=new Ia,this.programConfigurations=e,this.segments=new ia,this.dynamicLayoutVertexArray=new kn,this.opacityVertexArray=new Z_,this.placedSymbolArray=new Rc,this.iconTransitioningVertexArray=new $o,this.globeExtVertexArray=new $_,this.zOffsetVertexArray=new $l}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(e,i,o,l,r){this.isEmpty()||(o&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,J2.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,e3.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Y3,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=e.createVertexBuffer(this.iconTransitioningVertexArray,i3.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Q2.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||r)&&(this.zOffsetVertexBuffer=e.createVertexBuffer(this.zOffsetVertexArray,t3.members,!0)),this.opacityVertexBuffer.itemSize=1),(o||l)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}mt(Op,"SymbolBuffers");class Sp{constructor(e,i,o){this.layoutVertexArray=new e,this.layoutAttributes=i,this.indexArray=new o,this.segments=new ia,this.collisionVertexArray=new J_,this.collisionVertexArrayExt=new kn}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,a3.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,o3.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}mt(Sp,"CollisionBuffers");class Em{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(u=>u.fqid),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=s.a6.identity([]),this.placementViewportMatrix=s.a6.identity([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=hp(this.zoom,i["text-size"]),this.iconSizeData=hp(this.zoom,i["icon-size"]);const o=this.layers[0].layout,l=o.get("symbol-sort-key"),r=o.get("symbol-z-order");this.canOverlap=o.get("text-allow-overlap")||o.get("icon-allow-overlap")||o.get("text-ignore-placement")||o.get("icon-ignore-placement"),this.sortFeaturesByKey=r!=="viewport-y"&&l.constantOr(1)!==void 0,this.sortFeaturesByY=(r==="viewport-y"||r==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=o.get("text-writing-mode").map(u=>Go[u]),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.sourceID=e.sourceID,this.projection=e.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=o.get("symbol-z-elevate")}createArrays(){this.text=new Op(new U(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Op(new U(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Pc,this.lineVertexArray=new Ql,this.symbolInstances=new wc}calculateGlyphDependencies(e,i,o,l,r){for(let u=0;u<e.length;u++){const m=e.codePointAt(u);if(m===void 0)break;if(i[m]=!0,l&&r&&m<=65535){const p=gu[e.charAt(u)];p&&(i[p.charCodeAt(0)]=!0)}}}populate(e,i,o,l){const r=this.layers[0],u=r.layout,m=this.projection.name==="globe",p=u.get("text-font"),h=u.get("text-field"),y=u.get("icon-image"),x=(h.value.kind!=="constant"||h.value.value instanceof Da&&!h.value.value.isEmpty()||h.value.value.toString().length>0)&&(p.value.kind!=="constant"||p.value.value.length>0),E=y.value.kind!=="constant"||!!y.value.value||Object.keys(y.parameters).length>0,S=u.get("symbol-sort-key");if(this.features=[],!x&&!E)return;const C=i.iconDependencies,w=i.glyphDependencies,W=i.availableImages,D=new qi(this.zoom);for(const{feature:Y,id:q,index:K,sourceLayerIndex:ee}of e){const J=r._featureFilter.needGeometry,se=ya(Y,J);if(!r._featureFilter.filter(D,se,o))continue;if(J||(se.geometry=Sa(Y,o,l)),m&&Y.type!==1&&o.z<=5){const fe=se.geometry,Se=.98078528056,De=(Ae,We)=>{const xe=du(Ae.x,Ae.y,o,1),Ne=du(We.x,We.y,o,1);return s.N.dot(xe,Ne)<Se};for(let Ae=0;Ae<fe.length;Ae++)fe[Ae]=Ba(fe[Ae],De)}let _e,me;if(x){const fe=r.getValueAndResolveTokens("text-field",se,o,W),Se=Da.factory(fe);G3(Se)&&(this.hasRTLText=!0),(!this.hasRTLText||Un()==="unavailable"||this.hasRTLText&&fo.isParsed())&&(_e=l3(Se,r,se))}if(E){const fe=r.getValueAndResolveTokens("icon-image",se,o,W);me=fe instanceof Pt?fe:Pt.fromString(fe)}if(!_e&&!me)continue;const be=this.sortFeaturesByKey?S.evaluate(se,{},o):void 0;if(this.features.push({id:q,text:_e,icon:me,index:K,sourceLayerIndex:ee,geometry:se.geometry,properties:Y.properties,type:H3[Y.type],sortKey:be}),me&&(C[me.namePrimary]=!0,me.nameSecondary&&(C[me.nameSecondary]=!0)),_e){const fe=p.evaluate(se,{},o).join(","),Se=u.get("text-rotation-alignment")==="map"&&u.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Go.vertical)>=0;for(const De of _e.sections)if(De.image)C[De.image.namePrimary]=!0;else{const Ae=Fn(_e.toString()),We=De.fontStack||fe,xe=w[We]=w[We]||{};this.calculateGlyphDependencies(De.text,xe,Se,this.allowVerticalPlacement,Ae)}}}u.get("symbol-placement")==="line"&&(this.features=function(Y){const q={},K={},ee=[];let J=0;function se(fe){ee.push(Y[fe]),J++}function _e(fe,Se,De){const Ae=K[fe];return delete K[fe],K[Se]=Ae,ee[Ae].geometry[0].pop(),ee[Ae].geometry[0]=ee[Ae].geometry[0].concat(De[0]),Ae}function me(fe,Se,De){const Ae=q[Se];return delete q[Se],q[fe]=Ae,ee[Ae].geometry[0].shift(),ee[Ae].geometry[0]=De[0].concat(ee[Ae].geometry[0]),Ae}function be(fe,Se,De){const Ae=De?Se[0][Se[0].length-1]:Se[0][0];return`${fe}:${Ae.x}:${Ae.y}`}for(let fe=0;fe<Y.length;fe++){const Se=Y[fe],De=Se.geometry,Ae=Se.text?Se.text.toString():null;if(!Ae){se(fe);continue}const We=be(Ae,De),xe=be(Ae,De,!0);if(We in K&&xe in q&&K[We]!==q[xe]){const Ne=me(We,xe,De),Qe=_e(We,xe,ee[Ne].geometry);delete q[We],delete K[xe],K[be(Ae,ee[Qe].geometry,!0)]=Qe,ee[Ne].geometry=null}else We in K?_e(We,xe,De):xe in q?me(We,xe,De):(se(fe),q[We]=J-1,K[xe]=J-1)}return ee.filter(fe=>fe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Y,q)=>Y.sortKey-q.sortKey)}update(e,i,o,l,r){const u=Object.keys(e).length!==0;if(u&&!this.stateDependentLayers.length)return;const m=u?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(e,i,m,o,l,r),this.icon.programConfigurations.updatePaintArrays(e,i,m,o,l,r)}updateZOffset(){const e=(r,u,m)=>{o+=u,o>r.length&&r.resize(o);for(let p=-u;p<0;p++)r.emplace(p+o,m)},i=(r,u,m)=>{l+=u,l>r.length&&r.resize(l);for(let p=-u;p<0;p++)r.emplace(p+l,m)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let o=0,l=0;for(let r=0;r<this.symbolInstances.length;r++){const u=this.symbolInstances.get(r),{numHorizontalGlyphVertices:m,numVerticalGlyphVertices:p,numIconVertices:h}=u,y=u.zOffset,x=h>0;if((m>0||p>0)&&(e(this.text.zOffsetVertexArray,m,y),e(this.text.zOffsetVertexArray,p,y)),x){const{placedIconSymbolIndex:E,verticalPlacedIconSymbolIndex:S}=u;E>=0&&i(this.icon.zOffsetVertexArray,h,y),S>=0&&i(this.icon.zOffsetVertexArray,u.numVerticalIconVertices,y)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=M0(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,i){const o=this.lineVertexArray.length;if(e.segment!==void 0)for(const{x:l,y:r}of i)this.lineVertexArray.emplaceBack(l,r);return{lineStartIndex:o,lineLength:this.lineVertexArray.length-o}}addSymbols(e,i,o,l,r,u,m,p,h,y,x,E,S,C,w,W){const D=e.indexArray,Y=e.layoutVertexArray,q=e.globeExtVertexArray,K=e.segments.prepareSegment(4*i.length,Y,D,this.canOverlap?u.sortKey:void 0),ee=this.glyphOffsetArray.length,J=K.vertexLength,se=this.allowVerticalPlacement&&m===Go.vertical?Math.PI/2:0,_e=u.text&&u.text.sections;for(let be=0;be<i.length;be++){const{tl:fe,tr:Se,bl:De,br:Ae,texPrimary:We,texSecondary:xe,pixelOffsetTL:Ne,pixelOffsetBR:Qe,minFontScaleX:Be,minFontScaleY:pt,glyphOffset:dt,isSDF:ze,sectionIndex:Lt}=i[be],Et=K.vertexLength,ft=dt[1];if(bm(Y,h.x,h.y,fe.x,ft+fe.y,We.x,We.y,o,ze,Ne.x,Ne.y,Be,pt),bm(Y,h.x,h.y,Se.x,ft+Se.y,We.x+We.w,We.y,o,ze,Qe.x,Ne.y,Be,pt),bm(Y,h.x,h.y,De.x,ft+De.y,We.x,We.y+We.h,o,ze,Ne.x,Qe.y,Be,pt),bm(Y,h.x,h.y,Ae.x,ft+Ae.y,We.x+We.w,We.y+We.h,o,ze,Qe.x,Qe.y,Be,pt),p){const{x:He,y:Ct,z:$t}=p.anchor,[Wt,Zt,Ut]=p.up;xm(q,He,Ct,$t,Wt,Zt,Ut),xm(q,He,Ct,$t,Wt,Zt,Ut),xm(q,He,Ct,$t,Wt,Zt,Ut),xm(q,He,Ct,$t,Wt,Zt,Ut),vm(e.dynamicLayoutVertexArray,He,Ct,$t,se)}else vm(e.dynamicLayoutVertexArray,h.x,h.y,h.z,se);if(W){const He=xe||We;Tm(e.iconTransitioningVertexArray,He.x,He.y),Tm(e.iconTransitioningVertexArray,He.x+He.w,He.y),Tm(e.iconTransitioningVertexArray,He.x,He.y+He.h),Tm(e.iconTransitioningVertexArray,He.x+He.w,He.y+He.h)}D.emplaceBack(Et,Et+1,Et+2),D.emplaceBack(Et+1,Et+2,Et+3),K.vertexLength+=4,K.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(dt[0]),be!==i.length-1&&Lt===i[be+1].sectionIndex||e.programConfigurations.populatePaintArrays(Y.length,u,u.index,{},S,C,w,_e&&_e[Lt])}const me=p?p.anchor:h;e.placedSymbolArray.emplaceBack(me.x,me.y,me.z,h.x,h.y,ee,this.glyphOffsetArray.length-ee,J,y,x,h.segment,o?o[0]:0,o?o[1]:0,l[0],l[1],m,0,!1,0,E,0)}_commitLayoutVertex(e,i,o,l,r,u,m){e.emplaceBack(i,o,l,r,u,Math.round(m.x),Math.round(m.y))}_addCollisionDebugVertices(e,i,o,l,r,u,m){const p=o.segments.prepareSegment(4,o.layoutVertexArray,o.indexArray),h=p.vertexLength,y=m.tileAnchorX,x=m.tileAnchorY;for(let S=0;S<4;S++)o.collisionVertexArray.emplaceBack(0,0,0,0);this._commitDebugCollisionVertexUpdate(o.collisionVertexArrayExt,i,e.padding,m.zOffset),this._commitLayoutVertex(o.layoutVertexArray,l,r,u,y,x,new qe(e.x1,e.y1)),this._commitLayoutVertex(o.layoutVertexArray,l,r,u,y,x,new qe(e.x2,e.y1)),this._commitLayoutVertex(o.layoutVertexArray,l,r,u,y,x,new qe(e.x2,e.y2)),this._commitLayoutVertex(o.layoutVertexArray,l,r,u,y,x,new qe(e.x1,e.y2)),p.vertexLength+=4;const E=o.indexArray;E.emplaceBack(h,h+1),E.emplaceBack(h+1,h+2),E.emplaceBack(h+2,h+3),E.emplaceBack(h+3,h),p.primitiveLength+=4}_addTextDebugCollisionBoxes(e,i,o,l,r,u){for(let m=l;m<r;m++){const p=o.get(m),h=this.getSymbolInstanceTextSize(e,u,i,m);this._addCollisionDebugVertices(p,h,this.textCollisionBox,p.projectedAnchorX,p.projectedAnchorY,p.projectedAnchorZ,u)}}_addIconDebugCollisionBoxes(e,i,o,l,r,u){for(let m=l;m<r;m++){const p=o.get(m),h=this.getSymbolInstanceIconSize(e,i,u.placedIconSymbolIndex);this._addCollisionDebugVertices(p,h,this.iconCollisionBox,p.projectedAnchorX,p.projectedAnchorY,p.projectedAnchorZ,u)}}generateCollisionDebugBuffers(e,i){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Sp(ql,t0.members,$o),this.iconCollisionBox=new Sp(ql,t0.members,$o);const o=ld(this.iconSizeData,e),l=ld(this.textSizeData,e);for(let r=0;r<this.symbolInstances.length;r++){const u=this.symbolInstances.get(r);this._addTextDebugCollisionBoxes(l,e,i,u.textBoxStartIndex,u.textBoxEndIndex,u),this._addTextDebugCollisionBoxes(l,e,i,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u),this._addIconDebugCollisionBoxes(o,e,i,u.iconBoxStartIndex,u.iconBoxEndIndex,u),this._addIconDebugCollisionBoxes(o,e,i,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex,u)}}getSymbolInstanceTextSize(e,i,o,l){const r=this.text.placedSymbolArray.get(i.rightJustifiedTextSymbolIndex>=0?i.rightJustifiedTextSymbolIndex:i.centerJustifiedTextSymbolIndex>=0?i.centerJustifiedTextSymbolIndex:i.leftJustifiedTextSymbolIndex>=0?i.leftJustifiedTextSymbolIndex:i.verticalPlacedTextSymbolIndex>=0?i.verticalPlacedTextSymbolIndex:l),u=dm(this.textSizeData,e,r)/Ya;return this.tilePixelRatio*u}getSymbolInstanceIconSize(e,i,o){const l=this.icon.placedSymbolArray.get(o),r=dm(this.iconSizeData,e,l);return this.tilePixelRatio*r}_commitDebugCollisionVertexUpdate(e,i,o,l){e.emplaceBack(i,-o,-o,l),e.emplaceBack(i,o,-o,l),e.emplaceBack(i,o,o,l),e.emplaceBack(i,-o,o,l)}_updateTextDebugCollisionBoxes(e,i,o,l,r,u){for(let m=l;m<r;m++){const p=o.get(m),h=this.getSymbolInstanceTextSize(e,u,i,m);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,h,p.padding,u.zOffset)}}_updateIconDebugCollisionBoxes(e,i,o,l,r,u){for(let m=l;m<r;m++){const p=o.get(m),h=this.getSymbolInstanceIconSize(e,i,u.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,h,p.padding,u.zOffset)}}updateCollisionDebugBuffers(e,i){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const o=ld(this.iconSizeData,e),l=ld(this.textSizeData,e);for(let r=0;r<this.symbolInstances.length;r++){const u=this.symbolInstances.get(r);this._updateTextDebugCollisionBoxes(l,e,i,u.textBoxStartIndex,u.textBoxEndIndex,u),this._updateTextDebugCollisionBoxes(l,e,i,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u),this._updateIconDebugCollisionBoxes(o,e,i,u.iconBoxStartIndex,u.iconBoxEndIndex,u),this._updateIconDebugCollisionBoxes(o,e,i,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex,u)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,i,o,l,r,u,m,p,h){const y={};if(i<o){const{x1:x,y1:E,x2:S,y2:C,padding:w,projectedAnchorX:W,projectedAnchorY:D,projectedAnchorZ:Y,tileAnchorX:q,tileAnchorY:K,featureIndex:ee}=e.get(i);y.textBox={x1:x,y1:E,x2:S,y2:C,padding:w,projectedAnchorX:W,projectedAnchorY:D,projectedAnchorZ:Y,tileAnchorX:q,tileAnchorY:K},y.textFeatureIndex=ee}if(l<r){const{x1:x,y1:E,x2:S,y2:C,padding:w,projectedAnchorX:W,projectedAnchorY:D,projectedAnchorZ:Y,tileAnchorX:q,tileAnchorY:K,featureIndex:ee}=e.get(l);y.verticalTextBox={x1:x,y1:E,x2:S,y2:C,padding:w,projectedAnchorX:W,projectedAnchorY:D,projectedAnchorZ:Y,tileAnchorX:q,tileAnchorY:K},y.verticalTextFeatureIndex=ee}if(u<m){const{x1:x,y1:E,x2:S,y2:C,padding:w,projectedAnchorX:W,projectedAnchorY:D,projectedAnchorZ:Y,tileAnchorX:q,tileAnchorY:K,featureIndex:ee}=e.get(u);y.iconBox={x1:x,y1:E,x2:S,y2:C,padding:w,projectedAnchorX:W,projectedAnchorY:D,projectedAnchorZ:Y,tileAnchorX:q,tileAnchorY:K},y.iconFeatureIndex=ee}if(p<h){const{x1:x,y1:E,x2:S,y2:C,padding:w,projectedAnchorX:W,projectedAnchorY:D,projectedAnchorZ:Y,tileAnchorX:q,tileAnchorY:K,featureIndex:ee}=e.get(p);y.verticalIconBox={x1:x,y1:E,x2:S,y2:C,padding:w,projectedAnchorX:W,projectedAnchorY:D,projectedAnchorZ:Y,tileAnchorX:q,tileAnchorY:K},y.verticalIconFeatureIndex=ee}return y}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const o=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,o.textBoxStartIndex,o.textBoxEndIndex,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o.iconBoxStartIndex,o.iconBoxEndIndex,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(e,i){const o=e.placedSymbolArray.get(i),l=o.vertexStartIndex+4*o.numGlyphs;for(let r=o.vertexStartIndex;r<l;r+=4)e.indexArray.emplaceBack(r,r+1,r+2),e.indexArray.emplaceBack(r+1,r+2,r+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(e),o=Math.cos(e),l=[],r=[],u=[];for(let m=0;m<this.symbolInstances.length;++m){u.push(m);const p=this.symbolInstances.get(m);l.push(0|Math.round(i*p.tileAnchorX+o*p.tileAnchorY)),r.push(p.featureIndex)}return u.sort((m,p)=>l[m]-l[p]||r[p]-r[m]),u}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let e=0;e<this.symbolInstances.length;++e)this.symbolInstanceIndexesSortedZOffset.push(e)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((e,i)=>this.symbolInstances.get(i).zOffset-this.symbolInstances.get(e).zOffset)}addToSortKeyRanges(e,i){const o=this.sortKeyRanges[this.sortKeyRanges.length-1];o&&o.sortKey===i?o.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const o=this.symbolInstances.get(i);this.featureSortOrder.push(o.featureIndex);const{rightJustifiedTextSymbolIndex:l,centerJustifiedTextSymbolIndex:r,leftJustifiedTextSymbolIndex:u,verticalPlacedTextSymbolIndex:m,placedIconSymbolIndex:p,verticalPlacedIconSymbolIndex:h}=o;l>=0&&this.addIndicesForPlacedSymbol(this.text,l),r>=0&&r!==l&&this.addIndicesForPlacedSymbol(this.text,r),u>=0&&u!==r&&u!==l&&this.addIndicesForPlacedSymbol(this.text,u),m>=0&&this.addIndicesForPlacedSymbol(this.text,m),p>=0&&this.addIndicesForPlacedSymbol(this.icon,p),h>=0&&this.addIndicesForPlacedSymbol(this.icon,h)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}mt(Em,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Em.addDynamicAttributes=vm;const V3=new $i({"symbol-placement":new Xe(ge.layout_symbol["symbol-placement"]),"symbol-spacing":new Xe(ge.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Xe(ge.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Rt(ge.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Xe(ge.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Xe(ge.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new Xe(ge.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Xe(ge.layout_symbol["icon-ignore-placement"]),"icon-optional":new Xe(ge.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Xe(ge.layout_symbol["icon-rotation-alignment"]),"icon-size":new Rt(ge.layout_symbol["icon-size"]),"icon-text-fit":new Rt(ge.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Rt(ge.layout_symbol["icon-text-fit-padding"]),"icon-image":new Rt(ge.layout_symbol["icon-image"]),"icon-rotate":new Rt(ge.layout_symbol["icon-rotate"]),"icon-padding":new Xe(ge.layout_symbol["icon-padding"]),"icon-keep-upright":new Xe(ge.layout_symbol["icon-keep-upright"]),"icon-offset":new Rt(ge.layout_symbol["icon-offset"]),"icon-anchor":new Rt(ge.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Xe(ge.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Xe(ge.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Xe(ge.layout_symbol["text-rotation-alignment"]),"text-field":new Rt(ge.layout_symbol["text-field"]),"text-font":new Rt(ge.layout_symbol["text-font"]),"text-size":new Rt(ge.layout_symbol["text-size"]),"text-max-width":new Rt(ge.layout_symbol["text-max-width"]),"text-line-height":new Rt(ge.layout_symbol["text-line-height"]),"text-letter-spacing":new Rt(ge.layout_symbol["text-letter-spacing"]),"text-justify":new Rt(ge.layout_symbol["text-justify"]),"text-radial-offset":new Rt(ge.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Xe(ge.layout_symbol["text-variable-anchor"]),"text-anchor":new Rt(ge.layout_symbol["text-anchor"]),"text-max-angle":new Xe(ge.layout_symbol["text-max-angle"]),"text-writing-mode":new Xe(ge.layout_symbol["text-writing-mode"]),"text-rotate":new Rt(ge.layout_symbol["text-rotate"]),"text-padding":new Xe(ge.layout_symbol["text-padding"]),"text-keep-upright":new Xe(ge.layout_symbol["text-keep-upright"]),"text-transform":new Rt(ge.layout_symbol["text-transform"]),"text-offset":new Rt(ge.layout_symbol["text-offset"]),"text-allow-overlap":new Xe(ge.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Xe(ge.layout_symbol["text-ignore-placement"]),"text-optional":new Xe(ge.layout_symbol["text-optional"]),visibility:new Xe(ge.layout_symbol.visibility)});var Rp={paint:new $i({"icon-opacity":new Rt(ge.paint_symbol["icon-opacity"]),"icon-emissive-strength":new Rt(ge.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Rt(ge.paint_symbol["text-emissive-strength"]),"icon-color":new Rt(ge.paint_symbol["icon-color"]),"icon-halo-color":new Rt(ge.paint_symbol["icon-halo-color"]),"icon-halo-width":new Rt(ge.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Rt(ge.paint_symbol["icon-halo-blur"]),"icon-translate":new Xe(ge.paint_symbol["icon-translate"]),"icon-translate-anchor":new Xe(ge.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Rt(ge.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Rt(ge.paint_symbol["text-opacity"]),"text-color":new Rt(ge.paint_symbol["text-color"],{runtimeType:vo,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new Rt(ge.paint_symbol["text-halo-color"]),"text-halo-width":new Rt(ge.paint_symbol["text-halo-width"]),"text-halo-blur":new Rt(ge.paint_symbol["text-halo-blur"]),"text-translate":new Xe(ge.paint_symbol["text-translate"]),"text-translate-anchor":new Xe(ge.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Xe(ge.paint_symbol["icon-color-saturation"])}),layout:V3};class D0{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Rs,this.defaultValue=e}evaluate(e){if(e.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(e.formattedSection))return i.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}mt(D0,"FormatSectionOverride",{omit:["defaultValue"]});class Am extends oo{constructor(e,i,o){super(e,Rp,i,o)}recalculate(e,i){super.recalculate(e,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const o=this.layout.get("text-writing-mode");if(o){const l=[];for(const r of o)l.indexOf(r)<0&&l.push(r);this.layout._values["text-writing-mode"]=l}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,i,o,l){const r=this.layout.get(e).evaluate(i,{},o,l),u=this._unevaluatedLayout._values[e];return u.isDataDriven()||Wl(u.value)||!r?r:function(m,p){return p.replace(/{([^{}]+)}/g,(h,y)=>y in m?String(m[y]):"")}(i.properties,r)}createBucket(e){return new Em(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of Rp.paint.overridableProperties){if(!Am.hasPaintOverride(this.layout,e))continue;const i=this.paint.get(e),o=new D0(i),l=new zr(o,i.property.specification,this.scope,this.options);let r=null;r=i.value.kind==="constant"||i.value.kind==="source"?new P_("source",l):new Ml("composite",l,i.value.zoomStops,i.value._interpolationType),this.paint._values[e]=new Ks(i.property,r,i.parameters)}}_handleOverridablePaintPropertyUpdate(e,i,o){return!(!this.layout||i.isDataDriven()||o.isDataDriven())&&Am.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,i){const o=e.get("text-field"),l=Rp.paint.properties[i];let r=!1;const u=m=>{for(const p of m)if(l.overrides&&l.overrides.hasOverride(p))return void(r=!0)};if(o.value.kind==="constant"&&o.value.value instanceof Da)u(o.value.value.sections);else if(o.value.kind==="source"){const m=h=>{r||(h instanceof an&&ha(h.value)===ws?u(h.value.sections):h instanceof Ls?u(h.sections):h.eachChild(m))},p=o.value;p._styleExpression&&m(p._styleExpression.expression)}return r}getProgramIds(){const e=this.paint.get("icon-opacity").constantOr(1)!==0,i=this.paint.get("text-opacity").constantOr(1)!==0,o=[];return e&&o.push("symbolIcon"),i&&o.push("symbolSDF"),o}getDefaultProgramParams(e,i){return{config:new N(this,i),overrideFog:!1}}}const j3=new $i({visibility:new Xe(ge.layout_background.visibility)});var K3={paint:new $i({"background-color":new Xe(ge.paint_background["background-color"]),"background-pattern":new Xe(ge.paint_background["background-pattern"]),"background-opacity":new Xe(ge.paint_background["background-opacity"]),"background-emissive-strength":new Xe(ge.paint_background["background-emissive-strength"])}),layout:j3};const q3=new $i({visibility:new Xe(ge.layout_raster.visibility)});var $3={paint:new $i({"raster-opacity":new Xe(ge.paint_raster["raster-opacity"]),"raster-color":new ms(ge.paint_raster["raster-color"]),"raster-color-mix":new Xe(ge.paint_raster["raster-color-mix"]),"raster-color-range":new Xe(ge.paint_raster["raster-color-range"]),"raster-hue-rotate":new Xe(ge.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Xe(ge.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Xe(ge.paint_raster["raster-brightness-max"]),"raster-saturation":new Xe(ge.paint_raster["raster-saturation"]),"raster-contrast":new Xe(ge.paint_raster["raster-contrast"]),"raster-resampling":new Xe(ge.paint_raster["raster-resampling"]),"raster-fade-duration":new Xe(ge.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Xe(ge.paint_raster["raster-emissive-strength"]),"raster-array-band":new Xe(ge.paint_raster["raster-array-band"]),"raster-elevation":new Xe(ge.paint_raster["raster-elevation"])}),layout:q3},Cp=Ii([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class wp{constructor(e,i,o,l){this.context=e,this.format=o,this.texture=e.gl.createTexture(),this.update(i,l)}update(e,i,o){const{width:l,height:r}=e,{context:u}=this,{gl:m}=u;if(m.bindTexture(m.TEXTURE_2D,this.texture),u.pixelStoreUnpackFlipY.set(!1),u.pixelStoreUnpack.set(1),u.pixelStoreUnpackPremultiplyAlpha.set(this.format===m.RGBA&&(!i||i.premultiply!==!1)),o||this.size&&this.size[0]===l&&this.size[1]===r){const{x:p,y:h}=o||{x:0,y:0};if(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||ImageBitmap&&e instanceof ImageBitmap)m.texSubImage2D(m.TEXTURE_2D,0,p,h,m.RGBA,m.UNSIGNED_BYTE,e);else{let y=this.format,x=m.UNSIGNED_BYTE;this.format===m.R32F&&(y=m.RED,x=m.FLOAT),m.texSubImage2D(m.TEXTURE_2D,0,p,h,l,r,y,x,e.data)}}else if(this.size=[l,r],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||ImageBitmap&&e instanceof ImageBitmap){let p=this.format;this.format===m.R8&&(p=m.RED),m.texImage2D(m.TEXTURE_2D,0,this.format,p,m.UNSIGNED_BYTE,e)}else{let p=this.format,h=this.format,y=m.UNSIGNED_BYTE;this.format===m.DEPTH_COMPONENT&&(p=m.DEPTH_COMPONENT16,y=m.UNSIGNED_SHORT),this.format===m.R8&&(h=m.RED),this.format===m.R32F&&(y=m.FLOAT,h=m.RED),m.texImage2D(m.TEXTURE_2D,0,p,l,r,0,h,y,e.data)}this.useMipmap=!!(i&&i.useMipmap),this.useMipmap&&m.generateMipmap(m.TEXTURE_2D)}bind(e,i,o=!1){const{context:l}=this,{gl:r}=l;r.bindTexture(r.TEXTURE_2D,this.texture),e!==this.minFilter&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,this.useMipmap&&!o?e===r.NEAREST?r.NEAREST_MIPMAP_NEAREST:r.LINEAR_MIPMAP_LINEAR:e),this.minFilter=e),i!==this.wrapS&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,i),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,i),this.wrapS=i)}bindExtraParam(e,i,o,l){const{context:r}=this,{gl:u}=r;u.bindTexture(u.TEXTURE_2D,this.texture),i!==this.magFilter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,i),this.magFilter=i),e!==this.minFilter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,this.useMipmap?e===u.NEAREST?u.NEAREST_MIPMAP_NEAREST:u.LINEAR_MIPMAP_LINEAR:e),this.minFilter=e),o!==this.wrapS&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,o),this.wrapS=o),l!==this.wrapT&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,l),this.wrapT=l)}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class Im{constructor(e,i){this.context=e,this.texture=i}bind(e,i){const{context:o}=this,{gl:l}=o;l.bindTexture(l.TEXTURE_2D,this.texture),e!==this.minFilter&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,e),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,e),this.minFilter=e),i!==this.wrapS&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,i),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,i),this.wrapS=i)}}function Om(t,e,i,o,l,r,u,m){const p=[t,e,1,i,o,1,l,r,1],h=[u,m,1],y=s.co.adjoint([],p),[x,E,S]=s.N.transformMat3(h,h,y);return s.co.multiply(p,p,[x,0,0,0,E,0,0,0,S])}function F0(t,e,i,o,l,r,u,m){const p=function(h,y,x,E,S,C,w,W){const D=Om(0,0,1,0,1,1,0,1),Y=Om(h,y,x,E,S,C,w,W),q=s.co.adjoint([],D);return s.co.multiply(Y,Y,q)}(t,e,i,o,l,r,u,m);return[p[2]/p[8]/st,p[5]/p[8]/st]}function Sm(t){return[t[0],Math.min(Math.max(t[1],-ei),ei)]}class B0 extends Ss{constructor(e,i,o,l){super(),this.id=e,this.dispatcher=o,this.coordinates=i.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(l),this.options=i,this._dirty=!1}load(e,i){if(this._loaded=i||!1,this.fire(new es("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return e&&(this.coordinates=e),this._loaded=!0,void this._finishLoading();this._imageRequest=nt(this.map._requestManager.transformRequest(this.url,eo.Image),(o,l)=>{this._imageRequest=null,this._loaded=!0,o?this.fire(new Md(o)):l&&(this.image=l instanceof HTMLImageElement?Ge.getImageData(l):l,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,e&&(this.coordinates=e),this._finishLoading())})}loaded(){return this._loaded}updateImage(e){return e.url?(this._imageRequest&&e.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=e.url,this.load(e.coordinates,this._loaded),this):this}setTexture(e){if(!(e.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new Im(this.map.painter.context,e.handle),this.width=e.dimensions[0],this.height=e.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new es("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof Im||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(e){if(this.coordinates=e,this._boundsArray=void 0,this._unsupportedCoords=!1,!e.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let i=e[0][1],o=e[0][1];for(const r of e)r[1]>o&&(o=r[1]),r[1]<i&&(i=r[1]);const l=(o+i)/2;if(l>ei?this.onNorthPole=!0:l<-ei&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const r=e.map(mi.fromLngLat);this.tileID=function(u){let m=1/0,p=1/0,h=-1/0,y=-1/0;for(const w of u)m=Math.min(m,w.x),p=Math.min(p,w.y),h=Math.max(h,w.x),y=Math.max(y,w.y);const x=Math.max(h-m,y-p),E=Math.max(0,Math.floor(-Math.log(x)/Math.LN2)),S=Math.pow(2,E);let C=Math.floor((m+h)/2*S);return C>1&&(C-=1),new ke(E,C,Math.floor((p+y)/2*S))}(r),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new es("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(e){for(const D in this.tiles){const Y=this.tiles[D];Y.state!=="loaded"&&(Y.state="loaded",Y.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const i=xu(new ke(0,0,0),this.map.transform.projection),o=[i.projection.project(this.coordinates[0][0],this.coordinates[0][1]),i.projection.project(this.coordinates[1][0],this.coordinates[1][1]),i.projection.project(this.coordinates[2][0],this.coordinates[2][1]),i.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(D){const Y=D[1].x-D[0].x,q=D[1].y-D[0].y,K=D[2].x-D[1].x,ee=D[2].y-D[1].y,J=D[3].x-D[2].x,se=D[3].y-D[2].y,_e=D[0].x-D[3].x,me=D[0].y-D[3].y,be=Y*ee-K*q,fe=K*se-J*ee,Se=J*me-_e*se,De=_e*q-Y*me;return be>0&&fe>0&&Se>0&&De>0||be<0&&fe<0&&Se<0&&De<0}(o))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const l=xu(this.tileID,this.map.transform.projection),[r,u,m,p]=this.coordinates.map(D=>{const Y=l.projection.project(D[0],D[1]);return w0(l,Y)._round()});this.perspectiveTransform=F0(r.x,r.y,u.x,u.y,m.x,m.y,p.x,p.y);const h=this._boundsArray=new dn;h.emplaceBack(r.x,r.y,0,0),h.emplaceBack(u.x,u.y,st,0),h.emplaceBack(p.x,p.y,0,st),h.emplaceBack(m.x,m.y,st,st),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=e.createVertexBuffer(h,Cp.members),this.boundsSegments=ia.simpleSegment(0,0,4,2);const y=[],x=[Sm((E=this.coordinates)[0]),Sm(E[1]),Sm(E[2]),Sm(E[3])];var E;const[S,C,w,W]=function(D){let Y=D[0][0],q=Y,K=D[0][1],ee=K;for(let J=1;J<D.length;J++)D[J][0]<Y?Y=D[J][0]:D[J][0]>q&&(q=D[J][0]),D[J][1]<K?K=D[J][1]:D[J][1]>ee&&(ee=D[J][1]);return[Y,K,q-Y,ee-K]}(x);{const D=new dn,[Y,q,K,ee]=function(Ne){let Qe=Ne[0].x,Be=Qe,pt=Ne[0].y,dt=pt;for(let ze=1;ze<Ne.length;ze++)Ne[ze].x<Qe?Qe=Ne[ze].x:Ne[ze].x>Be&&(Be=Ne[ze].x),Ne[ze].y<pt?pt=Ne[ze].y:Ne[ze].y>dt&&(dt=Ne[ze].y);return[Qe,pt,Be-Qe,dt-pt]}(o),J=Ne=>[(Ne.x-Y)/K,(Ne.y-q)/ee],[se,_e,me,be]=o.map(J),fe=function(Ne,Qe,Be,pt,dt,ze,Lt,Et){const ft=Om(0,0,1,0,1,1,0,1),He=Om(Ne,Qe,Be,pt,dt,ze,Lt,Et),Ct=s.co.adjoint([],He);return s.co.multiply(ft,ft,Ct)}(se[0],se[1],_e[0],_e[1],me[0],me[1],be[0],be[1]);this.elevatedGlobePerspectiveTransform=F0(se[0],se[1],_e[0],_e[1],me[0],me[1],be[0],be[1]);const Se=(Ne,Qe)=>{y.push(Ne.lng);const Be=Math.round((Ne.lng-S)/w*st),pt=Math.round((Ne.lat-C)/W*st),dt=J(Qe),ze=s.N.transformMat3([],[dt[0],dt[1],1],fe),Lt=Math.round(ze[0]/ze[2]*st),Et=Math.round(ze[1]/ze[2]*st);D.emplaceBack(Be,pt,Lt,Et)},De=o[3].x-o[0].x,Ae=o[3].y-o[0].y,We=o[2].x-o[1].x,xe=o[2].y-o[1].y;for(let Ne=0;Ne<65;Ne++){const Qe=Ne/64,Be=[o[0].x+Qe*De,o[0].y+Qe*Ae],pt=[o[1].x+Qe*We,o[1].y+Qe*xe],dt=pt[0]-Be[0],ze=pt[1]-Be[1];for(let Lt=0;Lt<65;Lt++){const Et=Lt/64,ft={x:Be[0]+dt*Et,y:Be[1]+ze*Et,z:0};Se(i.projection.unproject(ft.x,ft.y),ft)}}this.elevatedGlobeVertexBuffer=e.createVertexBuffer(D,Cp.members)}{this.maxLongitudeTriangleSize=0;let D=[],Y=new Ia;const q=(K,ee,J)=>{Y.emplaceBack(K,ee,J);const se=y[K],_e=y[ee],me=y[J],be=Math.min(Math.min(se,_e),me),fe=Math.max(Math.max(se,_e),me)-be;fe>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=fe),D.push(be+fe/2)};for(let K=0;K<64;K++)for(let ee=0;ee<64;ee++){const J=65*K+ee,se=J+1,_e=J+65,me=_e+1;q(J,_e,se),q(se,_e,me)}[D,Y]=function(K,ee){const J=Array.from({length:K.length},(me,be)=>be);J.sort((me,be)=>K[me]-K[be]);const se=[],_e=new Ia;for(let me=0;me<J.length;me++){const be=J[me];se.push(K[be]);const fe=3*be,Se=fe+1;_e.emplaceBack(ee.uint16[fe],ee.uint16[Se],ee.uint16[Se+1])}return[se,_e]}(D,Y),this.elevatedGlobeTrianglesCenterLongitudes=D,this.elevatedGlobeIndexBuffer=e.createIndexBuffer(Y)}this.elevatedGlobeSegments=ia.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,w/st,0,W/st,0,0,C,S,0])}prepare(){const e=Object.keys(this.tiles).length!==0;if(this.tileID&&!e)return;const i=this.map.painter.context,o=i.gl;!this._dirty||this.texture instanceof Im||(this.texture?this.texture.update(this.image):(this.texture=new wp(i,this.image,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE)),this._dirty=!1),e&&this._prepareData(i)}loadTile(e,i){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={},i(null)):(e.state="errored",i(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(e){const i=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!i)return null;const o=this.elevatedGlobeTrianglesCenterLongitudes;let l=((y,x)=>y+360*Math.round((x-y)/360))(e+180,o[0]);const r=new ia,u=(y,x)=>{r.segments.push({vertexOffset:0,primitiveOffset:y,vertexLength:i.segments[0].vertexLength,primitiveLength:x,sortKey:void 0,vaos:{}})},m=.51*this.maxLongitudeTriangleSize;if(Math.abs(o[0]-l)<=m){const y=we(o,0,o.length,l+m);return y===o.length||u(y,de(o,y+1,o.length,l+360-m)-y),r}l<o[0]&&(l+=360);const p=de(o,0,o.length,l-m);if(p===o.length)return u(0,o.length),r;u(0,p-0);const h=we(o,p+1,o.length,l+m);return h!==o.length&&u(h,o.length-h),r}}const Z3=(Math.pow(256,2)-1)/16907520;class U0 extends oo{constructor(e,i,o){super(e,$3,i,o),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isLayerDraped(e){return!(e&&e._source instanceof B0&&(e._source.onNorthPole||e._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(e){e!=="raster-color"&&e!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(e){if(!this.hasColorMap()||!this._curRampRange)return;const i=this._transitionablePaint._values["raster-color"].value.expression,[o,l]=e||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(o)&&isNaN(l)||o===this._curRampRange[0]&&l===this._curRampRange[1]||(this.colorRamp=_u({expression:i,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:o,end:l}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[o,l])}}const X3=new $i({visibility:new Xe(ge["layout_raster-particle"].visibility)});var J3={paint:new $i({"raster-particle-array-band":new Xe(ge["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Xe(ge["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new ms(ge["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Xe(ge["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Xe(ge["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Xe(ge["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Xe(ge["paint_raster-particle"]["raster-particle-reset-rate-factor"])}),layout:X3};class k0 extends oo{constructor(e,i,o){super(e,J3,i,o),this._updateColorRamp(),this.onRemove=l=>{this.colorRampTexture&&this.colorRampTexture.destroy(),this.transformFeedbackObject&&l.painter.context.gl.deleteTransformFeedback(this.transformFeedbackObject),this.tileFramebuffer&&this.tileFramebuffer.destroy()},this.lastInvalidatedAt=Ge.now()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isLayerDraped(e){return!1}_handleSpecialPaintPropertyUpdate(e){e!=="raster-particle-color"&&e!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),e==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const e=this._transitionablePaint._values["raster-particle-color"].value.expression,i=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=_u({expression:e,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:i}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Ge.now()}}class Q3 extends oo{constructor(e,i){super(e,{},i),this.implementation=e,e.slot&&(this.slot=e.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(e){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}const ex=new $i({visibility:new Xe(ge.layout_sky.visibility)});var tx={paint:new $i({"sky-type":new Xe(ge.paint_sky["sky-type"]),"sky-atmosphere-sun":new Xe(ge.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Xe(ge.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Xe(ge.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Xe(ge.paint_sky["sky-gradient-radius"]),"sky-gradient":new ms(ge.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Xe(ge.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Xe(ge.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Xe(ge.paint_sky["sky-opacity"])}),layout:ex};function Pp(t,e,i){const o=[0,0,1],l=s.bi.identity([]);return s.bi.rotateY(l,l,i?-Ot(t)+Math.PI:Ot(t)),s.bi.rotateX(l,l,-Ot(e)),s.N.transformQuat(o,o,l),s.N.normalize(o,o)}var ix={paint:new $i({})};function z0(t,e){const i=Rm(t.projection,t.zoom,t.width,t.height),o=function(r,u,m,p,h){const y=new ce(m.lng-180*sl,m.lat),x=new ce(m.lng+180*sl,m.lat),E=r.project(y.lng,y.lat),S=r.project(x.lng,x.lat),C=-Math.atan2(S.y-E.y,S.x-E.x),w=mi.fromLngLat(m);w.y=Vt(w.y,-1+sl,1-sl);const W=w.toLngLat(),D=r.project(W.lng,W.lat),Y=mi.fromLngLat(W);Y.x+=sl;const q=Y.toLngLat(),K=r.project(q.lng,q.lat),ee=G0(K.x-D.x,K.y-D.y,C),J=mi.fromLngLat(W);J.y+=sl;const se=J.toLngLat(),_e=r.project(se.lng,se.lat),me=G0(_e.x-D.x,_e.y-D.y,C),be=Math.abs(ee.x)/Math.abs(me.y),fe=s.a6.identity([]);s.a6.rotateZ(fe,fe,-C*(1-(h?0:p)));const Se=s.a6.identity([]);return s.a6.scale(Se,Se,[1,1-(1-be)*p,1]),Se[4]=-me.x/me.y*p,s.a6.rotateZ(Se,Se,C),s.a6.multiply(Se,fe,Se),Se}(t.projection,0,t.center,i,e),l=H0(t);return s.a6.scale(o,o,[l,l,1]),o}function H0(t){const e=t.projection,i=Rm(t.projection,t.zoom,t.width,t.height),o=Y0(e,t.center),l=Y0(e,ce.convert(e.center));return Math.pow(2,o*i+(1-i)*l)}function Rm(t,e,i,o,l=1/0){const r=t.range;if(!r)return 0;const u=Math.min(l,Math.max(i,o)),m=Math.log(u/1024)/Math.LN2;return Lo(r[0]+m,r[1]+m,e)}const sl=1/4e4;function Y0(t,e){const i=Vt(e.lat,-ei,ei),o=new ce(e.lng-180*sl,i),l=new ce(e.lng+180*sl,i),r=t.project(o.lng,i),u=t.project(l.lng,i),m=mi.fromLngLat(o),p=mi.fromLngLat(l),h=u.x-r.x,y=u.y-r.y,x=p.x-m.x,E=p.y-m.y,S=Math.sqrt((x*x+E*E)/(h*h+y*y));return Math.log(S)/Math.LN2}function G0(t,e,i){const o=Math.cos(i),l=Math.sin(i);return{x:t*o-e*l,y:t*l+e*o}}function V0(t,e,i){s.a6.identity(t),s.a6.rotateZ(t,t,Ot(e[2])),s.a6.rotateX(t,t,Ot(e[0])),s.a6.rotateY(t,t,Ot(e[1])),s.a6.scale(t,t,i),s.a6.multiply(t,t,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function Cm(t,e,i,o,l,r,u,m){const p=[i[0]-e[0],i[1]-e[1],0],h=[o[0]-e[0],o[1]-e[1],0];if(s.N.length(p)<1e-12||s.N.length(h)<1e-12)return s.bi.identity(t);const y=s.N.cross([],p,h);s.N.normalize(y,y),s.N.subtract(h,o,e),p[2]=(r-l)*m,h[2]=(u-l)*m;const x=p;return s.N.cross(x,p,h),s.N.normalize(x,x),s.bi.rotationTo(t,y,x)}function Lp(t,e,i=!1){const o=Qs(e.zoom),l=function(r,u,m){const p=u.worldSize,h=[r[12],r[13],r[14]],y=di(h[1]/p),x=kt(h[0]/p),E=s.a6.identity([]),S=zt(1,y)*p,C=zt(1,0)*p*ti(y,u.zoom),w=1/ip(p);let W=C*w;if(m){const K=Rm(u.projection,u.zoom,u.width,u.height,1024);W=w*u.projection.pixelSpaceConversion(u.center.lat,p,K)}const D=Ie(y,x);s.N.add(D,D,s.N.scale([],s.N.normalize([],D),S*W*h[2]));const Y=function(K){const ee=[K[0],K[1],K[2]];let J=[0,1,0];const se=s.N.cross([],J,ee);return s.N.cross(J,ee,se),s.N.squaredLength(J)===0&&(J=[0,1,0],s.N.cross(se,ee,J)),s.N.normalize(se,se),s.N.normalize(J,J),s.N.normalize(ee,ee),[se[0],se[1],se[2],0,J[0],J[1],J[2],0,ee[0],ee[1],ee[2],0,K[0],K[1],K[2],1]}(D);s.a6.scale(E,E,[W,W,W*S]),s.a6.translate(E,E,[-h[0],-h[1],-h[2]]);const q=s.a6.multiply([],u.globeMatrix,Y);return s.a6.multiply(q,q,E),s.a6.multiply(q,q,r),q}(t,e,i);if(o>0){const r=function(u,m){const p=m.worldSize,h=zt(1,0)*p*ti(m.center.lat,m.zoom)/ip(p),y=zt(1,m.center.lat)*p,x=s.a6.identity([]);return s.a6.rotateY(x,x,Ot(m.center.lng)),s.a6.rotateX(x,x,Ot(m.center.lat)),s.a6.translate(x,x,[0,0,V]),s.a6.scale(x,x,[h,h,h*y]),s.a6.translate(x,x,[m.point.x-.5*p,m.point.y-.5*p,0]),s.a6.multiply(x,x,u),s.a6.multiply(x,m.globeMatrix,x)}(t,e);return function(u,m,p){const h=(C,w,W)=>{const D=s.N.length(C),Y=s.N.length(w),q=Ts(C,w,W);return s.N.scale(q,q,1/s.N.length(q)*si(D,Y,W))},y=h([u[0],u[1],u[2]],[m[0],m[1],m[2]],p),x=h([u[4],u[5],u[6]],[m[4],m[5],m[6]],p),E=h([u[8],u[9],u[10]],[m[8],m[9],m[10]],p),S=Ts([u[12],u[13],u[14]],[m[12],m[13],m[14]],p);return[y[0],y[1],y[2],0,x[0],x[1],x[2],0,E[0],E[1],E[2],0,S[0],S[1],S[2],1]}(l,r,o)}return l}function j0(t,e,i,o){const l=ea.projectAabbCorners(o,i);let r=Number.MAX_VALUE,u=-1;for(let h=0;h<l.length;++h){const y=l[h];y[0]=(.5*y[0]+.5)*e.width,y[1]=(.5-.5*y[1])*e.height,y[2]<r&&(u=h,r=y[2])}const m=h=>new qe(l[h][0],l[h][1]);let p;switch(u){case 0:case 6:p=[m(1),m(5),m(4),m(7),m(3),m(2),m(1)];break;case 1:case 7:p=[m(0),m(4),m(5),m(6),m(2),m(3),m(0)];break;case 3:case 5:p=[m(1),m(0),m(4),m(7),m(6),m(2),m(1)];break;default:p=[m(1),m(5),m(6),m(7),m(3),m(0),m(1)]}if(Xo(t,p))return r}const ax=Ii([{name:"a_pos_3f",components:3,type:"Float32"}]),ox=Ii([{name:"a_color_3f",components:3,type:"Float32"}]),nx=Ii([{name:"a_color_4f",components:4,type:"Float32"}]),sx=Ii([{name:"a_uv_2f",components:2,type:"Float32"}]),lx=Ii([{name:"a_normal_3f",components:3,type:"Float32"}]),rx=Ii([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),dx=Ii([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);class K0{constructor(e,i){this.feature=e,this.instancedDataOffset=i,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class q0{constructor(){this.instancedDataArray=new tu,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class Np{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.fqid),this.projection=e.projection,this.index=e.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0}}populate(e,i,o,l){this.tileToMeter=ii(o);const r=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:u,id:m,index:p,sourceLayerIndex:h}of e){const y=ya(u,r);if(!this.layers[0]._featureFilter.filter(new qi(this.zoom),y,o))continue;const x={id:m,sourceLayerIndex:h,index:p,geometry:r?y.geometry:Sa(u,o,l),properties:u.properties,type:u.type,patterns:{}},E=this.addFeature(x,x.geometry,y);E&&i.featureIndex.insert(u,x.geometry,p,h,this.index,this.instancesPerModel[E].instancedDataArray.length,st/32)}this.lookup=null}update(e,i,o,l){for(const r in this.instancesPerModel){const u=this.instancesPerModel[r];for(const m in e)u.idToFeaturesIndex.hasOwnProperty(m)&&this.evaluate(u.features[u.idToFeaturesIndex[m]],e[m],u,!0)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let e=!1;for(const i in this.instancesPerModel){const o=this.instancesPerModel[i];for(const l of o.features){const r=this.layers[0],u=l.feature,m=this.canonical,p=r.paint.get("model-rotation").evaluate(u,{},m),h=r.paint.get("model-scale").evaluate(u,{},m),y=r.paint.get("model-translation").evaluate(u,{},m);s.N.exactEquals(l.rotation,p)&&s.N.exactEquals(l.scale,h)&&s.N.exactEquals(l.translation,y)||(this.evaluate(l,l.featureStates,o,!0),e=!0)}}return e}isEmpty(){for(const e in this.instancesPerModel)if(this.instancesPerModel[e].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(e){if(!this.uploaded)for(const i in this.instancesPerModel){const o=this.instancesPerModel[i];o.instancedDataArray.length<0||o.instancedDataArray.length===0||(o.instancedDataBuffer?o.instancedDataBuffer.updateData(o.instancedDataArray):o.instancedDataBuffer=e.createVertexBuffer(o.instancedDataArray,rx.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const e in this.instancesPerModel){const i=this.instancesPerModel[e];i.instancedDataArray.length!==0&&i.instancedDataBuffer&&i.instancedDataBuffer.destroy()}}addFeature(e,i,o){const l=this.layers[0],r=l.layout.get("model-id").evaluate(o,{},this.canonical);if(!r)return ta(`modelId is not evaluated for layer ${l.id} and it is not going to get rendered.`),r;this.instancesPerModel[r]||(this.instancesPerModel[r]=new q0);const u=this.instancesPerModel[r],m=u.instancedDataArray,p=new K0(o,m.length);for(const h of i)for(const y of h){if(y.x<0||y.x>=st||y.y<0||y.y>=st)continue;const x=(this.lookupDim-1)/st,E=this.lookupDim*(y.y*x|0)+y.x*x|0;if(this.lookup){if(this.lookup[E]!==0)continue;this.lookup[E]=1}this.instanceCount++;const S=m.length;m.resize(S+1),u.instancesEvaluatedElevation.push(0),m.float32[16*S]=y.x,m.float32[16*S+1]=y.y}return p.instancedDataCount=u.instancedDataArray.length-p.instancedDataOffset,p.instancedDataCount>0&&(e.id&&(u.idToFeaturesIndex[e.id]=u.features.length),u.features.push(p),this.evaluate(p,{},u,!1)),r}evaluate(e,i,o,l){const r=this.layers[0],u=e.feature,m=this.canonical,p=e.rotation=r.paint.get("model-rotation").evaluate(u,i,m),h=e.scale=r.paint.get("model-scale").evaluate(u,i,m),y=e.translation=r.paint.get("model-translation").evaluate(u,i,m),x=r.paint.get("model-color").evaluate(u,i,m);x.a=r.paint.get("model-color-mix-intensity").evaluate(u,i,m);const E=[];this.maxVerticalOffset<y[2]&&(this.maxVerticalOffset=y[2]),this.maxScale=Math.max(Math.max(this.maxScale,h[0]),Math.max(h[1],h[2])),V0(E,p,h);const S=Math.round(100*x.a)+x.b/1.05;for(let C=0;C<e.instancedDataCount;++C){const w=e.instancedDataOffset+C,W=16*w,D=o.instancedDataArray.float32;let Y=0;l&&(Y=D[W+6]-o.instancesEvaluatedElevation[w]);const q=0|D[W+1];D[W]=(0|D[W])+x.r/1.05,D[W+1]=q+x.g/1.05,D[W+2]=S,D[W+3]=1/(m.z>10?this.tileToMeter:ii(m,q)),D[W+4]=y[0],D[W+5]=y[1],D[W+6]=y[2]+Y,D[W+7]=E[0],D[W+8]=E[1],D[W+9]=E[2],D[W+10]=E[4],D[W+11]=E[5],D[W+12]=E[6],D[W+13]=E[8],D[W+14]=E[9],D[W+15]=E[10],o.instancesEvaluatedElevation[w]=y[2]}}}mt(Np,"ModelBucket",{omit:["layers"]}),mt(q0,"PerModelAttributes"),mt(K0,"ModelFeature");const _x=new $i({visibility:new Xe(ge.layout_model.visibility),"model-id":new Rt(ge.layout_model["model-id"])});var ux={paint:new $i({"model-opacity":new Xe(ge.paint_model["model-opacity"]),"model-rotation":new Rt(ge.paint_model["model-rotation"]),"model-scale":new Rt(ge.paint_model["model-scale"]),"model-translation":new Rt(ge.paint_model["model-translation"]),"model-color":new Rt(ge.paint_model["model-color"]),"model-color-mix-intensity":new Rt(ge.paint_model["model-color-mix-intensity"]),"model-type":new Xe(ge.paint_model["model-type"]),"model-cast-shadows":new Xe(ge.paint_model["model-cast-shadows"]),"model-receive-shadows":new Xe(ge.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Xe(ge.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Rt(ge.paint_model["model-emissive-strength"]),"model-roughness":new Rt(ge.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Rt(ge.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Xe(ge.paint_model["model-cutoff-fade-range"])}),layout:_x};const dr=64,pd={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function $0(t,e,i,o,l,r,u,m,p,h=!1){const y=i.zoom,x=i.project(o),E=ti(o.lat,y),S=1/E;s.a6.identity(t),s.a6.translate(t,t,[x.x+u[0]*S,x.y+u[1]*S,u[2]]);let C=1,w=1;const W=i.worldSize;if(h){if(i.projection.name==="mercator"){let K=0;i.elevation&&(K=i.elevation.getAtPointOrZero(new mi(x.x/W,x.y/W),0));const ee=s.a7.transformMat4([],[x.x,x.y,K,1],i.projMatrix)[3]/i.cameraToCenterDistance;C=ee,w=ee*ti(i.center.lat,y)}else if(i.projection.name==="globe"){const K=Lp(t,i),ee=s.a6.multiply([],i.projMatrix,K),J=[0,0,0,1];s.a7.transformMat4(J,J,ee);const se=J[3]/i.cameraToCenterDistance,_e=Qs(y),me=i.projection.pixelsPerMeter(o.lat,W)*ti(o.lat,y),be=i.projection.pixelsPerMeter(i.center.lat,W)*ti(i.center.lat,y);C=se/si(me,Zi(i.center.lat),_e),w=se*E/me,C*=be,w*=be}}else C=S;s.a6.scale(t,t,[C,C,w]);const D=[...t],Y=e.orientation,q=[];if(V0(q,[Y[0]+l[0],Y[1]+l[1],Y[2]+l[2]],r),s.a6.multiply(t,D,q),m&&i.elevation){let K=0;const ee=[];if(p&&i.elevation){K=function(_e,me,be,fe,Se){const De=me.elevation;if(!De)return 0;const Ae=ea.projectAabbCorners(be,fe),We=zt(1,Se.lat)*me.worldSize,xe=function(Ct,$t){const Wt=[0,0,1],Zt=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Ut of Zt){const li=Ct[Ut.corners[0]],Ht=Ct[Ut.corners[1]],Ni=Ct[Ut.corners[2]],pi=[Ht[0]-li[0],Ht[1]-li[1],$t*(Ht[2]-li[2])],gi=s.N.cross(pi,pi,[Ni[0]-li[0],Ni[1]-li[1],$t*(Ni[2]-li[2])]);s.N.normalize(gi,gi),Ut.dotProductWithUp=s.N.dot(gi,Wt)}return Zt.sort((Ut,li)=>Ut.dotProductWithUp-li.dotProductWithUp),Zt[0].corners}(Ae,We),Ne=Ae[xe[0]],Qe=Ae[xe[1]],Be=Ae[xe[2]],pt=Ae[xe[3]],dt=De.getAtPointOrZero(new mi(Ne[0]/me.worldSize,Ne[1]/me.worldSize),0),ze=De.getAtPointOrZero(new mi(Qe[0]/me.worldSize,Qe[1]/me.worldSize),0),Lt=De.getAtPointOrZero(new mi(Be[0]/me.worldSize,Be[1]/me.worldSize),0),Et=De.getAtPointOrZero(new mi(pt[0]/me.worldSize,pt[1]/me.worldSize),0),ft=(dt+Et)/2,He=(ze+Lt)/2;return ft>He?ze<Lt?Cm(_e,Qe,pt,Ne,ze,Et,dt,We):Cm(_e,Be,Ne,pt,Lt,dt,Et,We):dt<Et?Cm(_e,Ne,Qe,Be,dt,ze,Lt,We):Cm(_e,pt,Be,Qe,Et,Lt,ze,We),Math.max(ft,He)}(ee,i,e.aabb,t,o);const J=s.a6.fromQuat([],ee),se=s.a6.multiply([],J,q);s.a6.multiply(t,D,se)}else K=i.elevation.getAtPointOrZero(new mi(x.x/W,x.y/W),0);K!==0&&(t[14]+=K)}}function Ou(t,e,i=!1){t.uploaded||(t.gfxTexture=new wp(e,t.image,i?e.gl.R8:e.gl.RGBA,{useMipmap:t.sampler.minFilter>=e.gl.NEAREST_MIPMAP_NEAREST}),t.uploaded=!0,t.image=null)}function cx(t,e,i){t.indexBuffer=e.createIndexBuffer(t.indexArray,!1,!0),t.vertexBuffer=e.createVertexBuffer(t.vertexArray,ax.members,!1,!0),t.normalArray&&(t.normalBuffer=e.createVertexBuffer(t.normalArray,lx.members,!1,!0)),t.texcoordArray&&(t.texcoordBuffer=e.createVertexBuffer(t.texcoordArray,sx.members,!1,!0)),t.colorArray&&(t.colorBuffer=e.createVertexBuffer(t.colorArray,(t.colorArray.bytesPerElement===12?ox:nx).members,!1,!0)),t.featureArray&&(t.pbrBuffer=e.createVertexBuffer(t.featureArray,dx.members,!0)),t.segments=ia.simpleSegment(0,0,t.vertexArray.length,t.indexArray.length);const o=t.material;o.pbrMetallicRoughness.baseColorTexture&&Ou(o.pbrMetallicRoughness.baseColorTexture,e),o.pbrMetallicRoughness.metallicRoughnessTexture&&Ou(o.pbrMetallicRoughness.metallicRoughnessTexture,e),o.normalTexture&&Ou(o.normalTexture,e),o.occlusionTexture&&Ou(o.occlusionTexture,e,i),o.emissionTexture&&Ou(o.emissionTexture,e)}function Wp(t,e,i){if(t.meshes)for(const o of t.meshes)cx(o,e,i);if(t.children)for(const o of t.children)Wp(o,e,i)}function wm(t){if(t.meshes)for(const e of t.meshes)e.indexArray.destroy(),e.vertexArray.destroy(),e.colorArray&&e.colorArray.destroy(),e.normalArray&&e.normalArray.destroy(),e.texcoordArray&&e.texcoordArray.destroy(),e.featureArray&&e.featureArray.destroy();if(t.children)for(const e of t.children)wm(e)}function Mp(t){if(t.meshes)for(const i of t.meshes)i.vertexBuffer&&(i.vertexBuffer.destroy(),i.indexBuffer.destroy(),i.normalBuffer&&i.normalBuffer.destroy(),i.texcoordBuffer&&i.texcoordBuffer.destroy(),i.colorBuffer&&i.colorBuffer.destroy(),i.pbrBuffer&&i.pbrBuffer.destroy(),i.segments.destroy(),i.material&&((e=i.material).pbrMetallicRoughness.baseColorTexture&&e.pbrMetallicRoughness.baseColorTexture.gfxTexture&&e.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),e.pbrMetallicRoughness.metallicRoughnessTexture&&e.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&e.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),e.normalTexture&&e.normalTexture.gfxTexture&&e.normalTexture.gfxTexture.destroy(),e.emissionTexture&&e.emissionTexture.gfxTexture&&e.emissionTexture.gfxTexture.destroy(),e.occlusionTexture&&e.occlusionTexture.gfxTexture&&e.occlusionTexture.gfxTexture.destroy()));var e;if(t.children)for(const i of t.children)Mp(i)}class mx{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class fx{constructor(){this.tasks={},this.taskQueue=[],Xn(["process"],this),this.invoker=new mx(this.process),this.nextId=0}add(e,i){const o=this.nextId++,l=function({type:r,isSymbolTile:u,zoom:m}){return m=m||0,r==="message"?0:r!=="maybePrepare"||u?r!=="parseTile"||u?r==="parseTile"&&u?300-m:r==="maybePrepare"&&u?400-m:500:200-m:100-m}(i);if(l===0){Ko();try{e()}finally{}return null}return this.tasks[o]={fn:e,metadata:i,priority:l,id:o},this.taskQueue.push(o),this.invoker.trigger(),{cancel:()=>{delete this.tasks[o]}}}process(){Ko();try{if(this.taskQueue=this.taskQueue.filter(o=>!!this.tasks[o]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const i=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!i)return;i.fn()}finally{}}pick(){let e=null,i=1/0;for(let l=0;l<this.taskQueue.length;l++){const r=this.tasks[this.taskQueue[l]];r.priority<i&&(i=r.priority,e=l)}if(e===null)return null;const o=this.taskQueue[e];return this.taskQueue.splice(e,1),o}remove(){this.invoker.remove()}}class Z0{constructor(e,i,o){this.target=e,this.parent=i,this.mapId=o,this.callbacks={},this.cancelCallbacks={},Xn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new fx}send(e,i,o,l,r=!1,u){const m=Math.round(1e18*Math.random()).toString(36).substring(0,10);o&&(o.metadata=u,this.callbacks[m]=o);const p=new Set;return this.target.postMessage({id:m,type:e,hasCallback:!!o,targetMapId:l,mustQueue:r,sourceMapId:this.mapId,data:Dn(i,p)},p),{cancel:()=>{o&&delete this.callbacks[m],this.target.postMessage({id:m,type:"<cancel>",targetMapId:l,sourceMapId:this.mapId})}}}receive(e){const i=e.data,o=i.id;if(o&&(!i.targetMapId||this.mapId===i.targetMapId))if(i.type==="<cancel>"){const l=this.cancelCallbacks[o];delete this.cancelCallbacks[o],l&&l.cancel()}else if(i.mustQueue||Ko()){const l=this.callbacks[o],r=this.scheduler.add(()=>this.processTask(o,i),l&&l.metadata||{type:"message"});r&&(this.cancelCallbacks[o]=r)}else this.processTask(o,i)}processTask(e,i){if(delete this.cancelCallbacks[e],i.type==="<response>"){const o=this.callbacks[e];delete this.callbacks[e],o&&(i.error?o(us(i.error)):o(null,us(i.data)))}else{const o=new Set,l=i.hasCallback?(u,m)=>{this.target.postMessage({id:e,type:"<response>",sourceMapId:this.mapId,error:u?Dn(u):null,data:Dn(m,o)},o)}:u=>{},r=us(i.data);if(this.parent[i.type])this.parent[i.type](i.sourceMapId,r,l);else if(this.parent.getWorkerSource){const u=i.type.split(".");this.parent.getWorkerSource(i.sourceMapId,u[0],r.source,r.scope)[u[1]](r,l)}else l(new Error(`Could not find function ${i.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class hd{constructor(e,i){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=Es();const o=this.workerPool.acquire(this.id);for(let l=0;l<o.length;l++){const r=new hd.Actor(o[l],i,this.id);r.name=`Worker ${l}`,this.actors.push(r)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(e,i,o){No(this.actors,(l,r)=>{l.send(e,i,r)},o=o||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(e=>{e.remove()}),this.actors=[],this.workerPool.release(this.id)}}hd.Actor=Z0;var Su={workerUrl:"",workerClass:null,workerParams:void 0};function px(){return Su.workerClass!=null?new Su.workerClass:new self.Worker(Su.workerUrl,Su.workerParams)}const Dp="mapboxgl_preloaded_worker_pool";class Ru{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<Ru.workerCount;)this.workers.push(new px);return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.workers&&this.numActive()===0&&(this.workers.forEach(i=>{i.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Dp]}numActive(){return Object.keys(this.active).length}}let Cu;function Pm(){return Cu||(Cu=new Ru),Cu}Ru.workerCount=2;let Lm,Fp,hn,gd,Bp,yd=null;function X0(){return Ko()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:Fp||ve.DRACO_URL}function J0(){if(Ko()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(gd)return gd;const t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return gd=WebAssembly.validate(t)?ve.MESHOPT_SIMD_URL:ve.MESHOPT_URL,gd}const Nm={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},hx={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},wu={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function Q0(t,e,i){const o=i.json.bufferViews.length,l=i.buffers.length;e.bufferView=o,i.json.bufferViews[o]={buffer:l,byteLength:t.byteLength},i.buffers[l]=t}const Up="KHR_draco_mesh_compression";function gx(t,e){const i=t.extensions&&t.extensions[Up];if(!i)return;const o=new hn.Decoder,l=a1(e,i.bufferView),r=new hn.Mesh;if(!o.DecodeArrayToMesh(l,l.byteLength,r))throw new Error("Failed to decode Draco mesh");const u=e.json.accessors[t.indices],m=Nm[u.componentType],p=u.count*m.BYTES_PER_ELEMENT,h=hn._malloc(p);m===Uint16Array?o.GetTrianglesUInt16Array(r,p,h):o.GetTrianglesUInt32Array(r,p,h),Q0(hn.memory.buffer.slice(h,h+p),u,e),hn._free(h);for(const y of Object.keys(i.attributes)){const x=o.GetAttributeByUniqueId(r,i.attributes[y]),E=e.json.accessors[t.attributes[y]],S=hx[E.componentType],C=E.count*wu[E.type]*Nm[E.componentType].BYTES_PER_ELEMENT,w=hn._malloc(C);o.GetAttributeDataArrayForAllPoints(r,x,hn[S],C,w),Q0(hn.memory.buffer.slice(w,w+C),E,e),hn._free(w)}o.destroy(),r.destroy(),delete t.extensions[Up]}const Wm="EXT_meshopt_compression";function yx(t,e){if(!t.extensions||!t.extensions[Wm])return;const i=t.extensions[Wm],o=new Uint8Array(e.buffers[i.buffer],i.byteOffset||0,i.byteLength||0),l=new Uint8Array(i.count*i.byteStride);Bp.decodeGltfBuffer(l,i.count,i.byteStride,o,i.mode,i.filter),t.buffer=e.buffers.length,t.byteOffset=0,e.buffers[t.buffer]=l.buffer,delete t.extensions[Wm]}const e1=1179937895,t1=new TextDecoder("utf8");function i1(t,e){return new URL(t,e).href}function bx(t,e,i,o){return fetch(i1(t.uri,o)).then(l=>l.arrayBuffer()).then(l=>{e.buffers[i]=l})}function a1(t,e){const i=t.json.bufferViews[e];return new Uint8Array(t.buffers[i.buffer],i.byteOffset||0,i.byteLength)}function Tx(t,e,i,o){if(t.uri){const l=i1(t.uri,o);return fetch(l).then(r=>r.blob()).then(r=>createImageBitmap(r)).then(r=>{e.images[i]=r})}if(t.bufferView!==void 0){const l=a1(e,t.bufferView),r=new Blob([l],{type:t.mimeType});return createImageBitmap(r).then(u=>{e.images[i]=u})}}function o1(t,e=0,i){const o={json:null,images:[],buffers:[]};if(new Uint32Array(t,e,1)[0]===e1){const y=new Uint32Array(t,e);let x=2;const E=(y[x++]>>2)-3,S=y[x++]>>2;if(x++,o.json=JSON.parse(t1.decode(y.subarray(x,x+S))),x+=S,x<E){const C=y[x++];x++;const w=e+(x<<2);o.buffers[0]=t.slice(w,w+C)}}else o.json=JSON.parse(t1.decode(new Uint8Array(t,e)));const{buffers:l,images:r,meshes:u,extensionsUsed:m,bufferViews:p}=o.json;let h=Promise.resolve();if(l){const y=[];for(let x=0;x<l.length;x++){const E=l[x];E.uri?y.push(bx(E,o,x,i)):o.buffers[x]||(o.buffers[x]=null)}h=Promise.all(y)}return h.then(()=>{const y=[],x=m&&m.includes(Up),E=m&&m.includes(Wm);if(x&&y.push(function(){if(!hn)return Lm||(Lm=function(S){let C,w=null;function W(){C=new Uint8Array(w.buffer)}function D(){throw new Error("Unexpected Draco error.")}const Y={a:{a:D,d:function(q,K,ee){return C.copyWithin(q,K,K+ee)},c:function(q){const K=C.length,ee=Math.max(q>>>0,Math.ceil(1.2*K)),J=Math.ceil((ee-K)/65536);try{return w.grow(J),W(),!0}catch{return!1}},b:D}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(S,Y):S.then(q=>q.arrayBuffer()).then(q=>WebAssembly.instantiate(q,Y))).then(q=>{const{Rb:K,Qb:ee,P:J,T:se,X:_e,Ja:me,La:be,Qa:fe,Va:Se,Wa:De,eb:Ae,jb:We,f:xe,e:Ne,yb:Qe,zb:Be,Ab:pt,Bb:dt,Db:ze,Gb:Lt}=q.instance.exports;w=Ne;const Et=(()=>{let ft=0,He=0,Ct=0,$t=0;return Wt=>{Ct&&(K($t),K(ft),He+=Ct,Ct=ft=0),ft||(He+=128,ft=ee(He));const Zt=Wt.length+7&-8;let Ut=ft;Zt>=He&&(Ct=Zt,Ut=$t=ee(Zt));for(let li=0;li<Wt.length;li++)C[Ut+li]=Wt[li];return Ut}})();return W(),xe(),{memory:Ne,_free:K,_malloc:ee,Mesh:class{constructor(){this.ptr=J()}destroy(){se(this.ptr)}},Decoder:class{constructor(){this.ptr=me()}destroy(){We(this.ptr)}DecodeArrayToMesh(ft,He,Ct){const $t=Et(ft),Wt=be(this.ptr,$t,He,Ct.ptr);return!!_e(Wt)}GetAttributeByUniqueId(ft,He){return{ptr:fe(this.ptr,ft.ptr,He)}}GetTrianglesUInt16Array(ft,He,Ct){Se(this.ptr,ft.ptr,He,Ct)}GetTrianglesUInt32Array(ft,He,Ct){De(this.ptr,ft.ptr,He,Ct)}GetAttributeDataArrayForAllPoints(ft,He,Ct,$t,Wt){Ae(this.ptr,ft.ptr,He.ptr,Ct,$t,Wt)}},DT_INT8:Qe(),DT_UINT8:Be(),DT_INT16:pt(),DT_UINT16:dt(),DT_UINT32:ze(),DT_FLOAT32:Lt()}})}(fetch(X0())),Lm.then(S=>{hn=S,Lm=void 0}))}()),E&&y.push(function(){if(Bp)return;const S=function(C){let w;const W=WebAssembly.instantiateStreaming(C,{}).then(q=>{w=q.instance,w.exports.__wasm_call_ctors()}),D={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},Y={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:W,supported:!0,decodeGltfBuffer(q,K,ee,J,se,_e){(function(me,be,fe,Se,De,Ae,We){const xe=me.exports.sbrk,Ne=Se+3&-4,Qe=xe(Ne*De),Be=xe(Ae.length),pt=new Uint8Array(me.exports.memory.buffer);pt.set(Ae,Be);const dt=be(Qe,Se,De,Be,Ae.length);if(dt===0&&We&&We(Qe,Ne,De),fe.set(pt.subarray(Qe,Qe+Se*De)),xe(Qe-xe(0)),dt!==0)throw new Error(`Malformed buffer data: ${dt}`)})(w,w.exports[Y[se]],q,K,ee,J,w.exports[D[_e]])}}}(fetch(J0()));return S.ready.then(()=>{Bp=S})}()),r)for(let S=0;S<r.length;S++)y.push(Tx(r[S],o,S,i));return(y.length?Promise.all(y):Promise.resolve()).then(()=>{if(x&&u)for(const{primitives:S}of u)for(const C of S)gx(C,o);if(E&&u&&p)for(const S of p)yx(S,o);return o})})}class n1{constructor(e,i,o){if(this.triangleCount=i.length/3,this.min=new qe(0,0),this.max=new qe(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||e.length===0||o===0)return;const l=e.map(y=>y.x),r=e.map(y=>y.y);this.min=new qe(Math.min(...l),Math.min(...r)),this.max=new qe(Math.max(...l),Math.max(...r));const u=this.max.sub(this.min);u.x=Math.max(u.x,1),u.y=Math.max(u.y,1);const m=Math.max(u.x,u.y)/o;this.cellsX=Math.max(1,Math.ceil(u.x/m)),this.cellsY=Math.max(1,Math.ceil(u.y/m)),this.xScale=1/m,this.yScale=1/m;const p=[];for(let y=0;y<this.triangleCount;y++){const x=e[i[3*y+0]].sub(this.min),E=e[i[3*y+1]].sub(this.min),S=e[i[3*y+2]].sub(this.min),C=ll(Math.floor(Math.min(x.x,E.x,S.x)),this.xScale,this.cellsX),w=ll(Math.floor(Math.max(x.x,E.x,S.x)),this.xScale,this.cellsX),W=ll(Math.floor(Math.min(x.y,E.y,S.y)),this.yScale,this.cellsY),D=ll(Math.floor(Math.max(x.y,E.y,S.y)),this.yScale,this.cellsY),Y=new qe(0,0),q=new qe(0,0),K=new qe(0,0),ee=new qe(0,0);for(let J=W;J<=D;++J){Y.y=q.y=J*m,K.y=ee.y=(J+1)*m;for(let se=C;se<=w;++se)Y.x=K.x=se*m,q.x=ee.x=(se+1)*m,(Wf(x,E,S,Y,q,ee)||Wf(x,E,S,Y,ee,K))&&p.push({cellIdx:J*this.cellsX+se,triIdx:y})}}if(p.length===0)return;p.sort((y,x)=>y.cellIdx-x.cellIdx||y.triIdx-x.triIdx);let h=0;for(;h<p.length;){const y=p[h].cellIdx,x={start:this.payload.length,len:0};for(;h<p.length&&p[h].cellIdx===y;)++x.len,this.payload.push(p[h++].triIdx);this.cells[y]=x}}query(e,i,o){if(this.triangleCount===0||this.cells.length===0||e.x>this.max.x||this.min.x>i.x||e.y>this.max.y||this.min.y>i.y)return;this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8)));for(let p=0;p<this.lookup.length;p++)this.lookup[p]=0;const l=ll(e.x-this.min.x,this.xScale,this.cellsX),r=ll(i.x-this.min.x,this.xScale,this.cellsX),u=ll(e.y-this.min.y,this.yScale,this.cellsY),m=ll(i.y-this.min.y,this.yScale,this.cellsY);for(let p=u;p<=m;p++)for(let h=l;h<=r;h++){const y=this.cells[p*this.cellsX+h];if(y)for(let x=0;x<y.len;x++){const E=this.payload[y.start+x],S=Math.floor(E/8),C=1<<E%8;if(!(this.lookup[S]&C)&&(this.lookup[S]|=C,o.push(E),o.length===this.triangleCount))return}}}}function ll(t,e,i){return Math.max(0,Math.min(i-1,Math.floor(t*e)))}function _r(t,e){const i=t.json.bufferViews[e.bufferView],o=Nm[e.componentType];return new o(t.buffers[i.buffer],(e.byteOffset||0)+(i.byteOffset||0),e.count*(i.byteStride&&i.byteStride!==wu[e.type]*o.BYTES_PER_ELEMENT?i.byteStride/o.BYTES_PER_ELEMENT:wu[e.type]))}function kp(t,e,i,o){const l=Nm[e.componentType],r=function(y){switch(y){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(l),u=t.json.bufferViews[e.bufferView],m=u.byteStride?u.byteStride/l.BYTES_PER_ELEMENT:wu[e.type],p=i.float32,h=p.length/i.capacity;for(let y=0,x=0;y<e.count*m;y+=m,x+=h)for(let E=0;E<h;E++)p[x+E]=o[y+E]*r;i._trim()}function xx(t,e,i){const o=t.indices,l=t.attributes,r={};r.indexArray=new Ia;const u=e.json.accessors[o],m=u.count/3;r.indexArray.reserve(m);const p=_r(e,u);for(let E=0;E<m;E++)r.indexArray.emplaceBack(p[3*E],p[3*E+1],p[3*E+2]);r.indexArray._trim(),r.vertexArray=new fs;const h=e.json.accessors[l.POSITION];r.vertexArray.reserve(h.count);const y=_r(e,h);for(let E=0;E<h.count;E++)r.vertexArray.emplaceBack(y[3*E],y[3*E+1],y[3*E+2]);if(r.vertexArray._trim(),r.aabb=new ea(h.min,h.max),r.centroid=function(E,S){const C=[0,0,0],w=E.length;if(w>0){for(let W=0;W<w;W++){const D=3*E[W];C[0]+=S[D],C[1]+=S[D+1],C[2]+=S[D+2]}C[0]/=w,C[1]/=w,C[2]/=w}return C}(p,y),l.COLOR_0!==void 0){const E=e.json.accessors[l.COLOR_0],S=wu[E.type],C=_r(e,E);r.colorArray=S===3?new fs:new kn,r.colorArray.resize(E.count),kp(e,E,r.colorArray,C)}if(l.NORMAL!==void 0){r.normalArray=new fs;const E=e.json.accessors[l.NORMAL];r.normalArray.resize(E.count);const S=_r(e,E);kp(e,E,r.normalArray,S)}if(l.TEXCOORD_0!==void 0&&i.length>0){r.texcoordArray=new Xl;const E=e.json.accessors[l.TEXCOORD_0];r.texcoordArray.resize(E.count);const S=_r(e,E);kp(e,E,r.texcoordArray,S)}if(l._FEATURE_ID_RGBA4444!==void 0){const E=e.json.accessors[l._FEATURE_ID_RGBA4444];e.json.extensionsUsed&&e.json.extensionsUsed.includes("EXT_meshopt_compression")&&(r.featureData=_r(e,E))}l._FEATURE_RGBA4444!==void 0&&(r.featureData=new Uint32Array(_r(e,e.json.accessors[l._FEATURE_RGBA4444]).buffer));const x=t.material;return r.material=function(E,S){const{emissiveFactor:C=[0,0,0],alphaMode:w="OPAQUE",alphaCutoff:W=.5,normalTexture:D,occlusionTexture:Y,emissiveTexture:q,doubleSided:K}=E,{baseColorFactor:ee=[1,1,1,1],metallicFactor:J=1,roughnessFactor:se=1,baseColorTexture:_e,metallicRoughnessTexture:me}=E.pbrMetallicRoughness||{},be=Y?S[Y.index]:void 0;if(Y&&Y.extensions&&Y.extensions.KHR_texture_transform&&be){const fe=Y.extensions.KHR_texture_transform;be.offsetScale=[fe.offset[0],fe.offset[1],fe.scale[0],fe.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new ca(...ee),metallicFactor:J,roughnessFactor:se,baseColorTexture:_e?S[_e.index]:void 0,metallicRoughnessTexture:me?S[me.index]:void 0},doubleSided:K,emissiveFactor:C,alphaMode:w,alphaCutoff:W,normalTexture:D?S[D.index]:void 0,occlusionTexture:be,emissionTexture:q?S[q.index]:void 0,defined:E.defined===void 0}}(x!==void 0?e.json.materials[x]:{defined:!1},i),r}function s1(t,e,i){const{matrix:o,rotation:l,translation:r,scale:u,mesh:m,extras:p,children:h}=t,y={};if(y.matrix=o||s.a6.fromRotationTranslationScale([],l||[0,0,0,1],r||[0,0,0],u||[1,1,1]),m!==void 0){y.meshes=i[m];const x=y.anchor=[0,0];for(const E of y.meshes){const{min:S,max:C}=E.aabb;x[0]+=S[0]+C[0],x[1]+=S[1]+C[1]}x[0]=Math.floor(x[0]/y.meshes.length/2),x[1]=Math.floor(x[1]/y.meshes.length/2)}if(p&&(p.id&&(y.id=p.id),p.lights&&(y.lights=function(x){if(!x.length)return[];const E=function(D){const Y=atob(D),q=new Uint8Array(Y.length);for(let K=0;K<Y.length;K++)q[K]=Y.codePointAt(K);return q}(x),S=[],C=E.length/24,w=new Uint16Array(E.buffer),W=new Float32Array(E.buffer);for(let D=0;D<C;D++){const Y=w[2*D*6]/30,q=w[2*D*6+1]/30,K=w[2*D*6+10]/100,ee=W[6*D+1],J=W[6*D+2],se=W[6*D+3],_e=W[6*D+4],me=se-ee,be=_e-J,fe=Math.hypot(me,be);S.push({pos:[ee+.5*me,J+.5*be,q],normal:[be/fe,-me/fe,0],width:fe,height:Y,depth:K,points:[ee,J,se,_e]})}return S}(p.lights))),h){const x=[];for(const E of h)x.push(s1(e.json.nodes[E],e,i));y.children=x}return y}function vx(t){if(t.vertices.length===0||t.indices.length===0)return null;const[e,i]=[t.vertices[0].clone(),t.vertices[0].clone()];for(let u=1;u<t.vertices.length;++u){const m=t.vertices[u];e.x=Math.min(e.x,m.x),e.y=Math.min(e.y,m.y),i.x=Math.max(i.x,m.x),i.y=Math.max(i.y,m.y)}const o=Math.ceil(Math.max(i.x-e.x,i.y-e.y)/256),l=Math.max(8,o),r=new n1(t.vertices,t.indices,l);return{vertices:t.vertices,indices:t.indices,grid:r,min:e,max:i}}function Ex(t){if(!t.extras||!t.extras.ground)return null;const e=t.extras.ground;if(!e||!Array.isArray(e)||e.length===0)return null;const i=e[0];if(!i||!Array.isArray(i)||i.length===0)return null;const o=[];for(const u of i){if(!Array.isArray(u)||u.length!==2)continue;const m=u[0],p=u[1];typeof m=="number"&&typeof p=="number"&&o.push(new qe(m,p))}if(o.length<3)return null;o.length>1&&o[o.length-1].equals(o[0])&&o.pop();let l=0;for(let u=0;u<o.length;u++){const m=o[u],p=o[(u+1)%o.length],h=o[(u+2)%o.length];l+=(m.x-p.x)*(h.y-p.y)-(h.x-p.x)*(m.y-p.y)}l>0&&o.reverse();const r=tm(o.flatMap(u=>[u.x,u.y]),[]);return r.length===0?null:{vertices:o,indices:r}}function Ax(t){const e=[],i=[];let o=0;for(const l of t){o=e.length;const r=l.vertexArray.float32,u=l.indexArray.uint16;for(let m=0;m<l.vertexArray.length;m++)e.push(new qe(r[3*m+0],r[3*m+1]));for(let m=0;m<3*l.indexArray.length;m++)i.push(u[m]+o)}if(i.length%3!=0)return null;for(let l=0;l<i.length;l+=3){const r=e[i[l+0]],u=e[i[l+1]],m=e[i[l+2]];(r.x-u.x)*(m.y-u.y)-(m.x-u.x)*(r.y-u.y)>0&&([i[l+1],i[l+2]]=[i[l+2],i[l+1]])}return{vertices:e,indices:i}}function l1(t){const e=function(p,h){const y=[],x=WebGL2RenderingContext;if(p.json.textures)for(const E of p.json.textures){const S={magFilter:x.LINEAR,minFilter:x.NEAREST,wrapS:x.REPEAT,wrapT:x.REPEAT};E.sampler!==void 0&&Object.assign(S,p.json.samplers[E.sampler]),y.push({image:h[E.source],sampler:S,uploaded:!1})}return y}(t,t.images),i=function(p,h){const y=[];for(const x of p.json.meshes){const E=[];for(const S of x.primitives)E.push(xx(S,p,h));y.push(E)}return y}(t,e),{scenes:o,scene:l,nodes:r}=t.json,u=o?o[l||0].nodes:r,m=[];for(const p of u)m.push(s1(r[p],t,i));return function(p,h,y){const x={},E=new Set;for(let S=0;S<p.length;S++){const C=y[h[S]];if(!C.extras)continue;const w=C.extras["mapbox:footprint:version"],W=C.extras["mapbox:footprint:id"];(w||W)&&E.add(S),w==="1.0.0"&&W&&(x[W]=S)}for(let S=0;S<p.length;S++){if(E.has(S))continue;const C=p[S],w=y[h[S]];if(!w.extras)continue;let W=null;C.id in x&&(W=Ax(p[x[C.id]].meshes)),W||(W=Ex(w)),W&&(C.footprint=vx(W))}if(E.size>0){const S=Array.from(E.values()).sort((C,w)=>C-w);for(let C=S.length-1;C>=0;C--)p.splice(S[C],1)}}(m,u,t.json.nodes),m}function Ix(t){t.heightmap=new Float32Array(4096),t.heightmap.fill(-1);const e=t.vertexArray.float32,i=t.aabb.min[0]-1,o=t.aabb.min[1]-1,l=dr/(t.aabb.max[0]-i+2),r=dr/(t.aabb.max[1]-o+2);for(let u=0;u<e.length;u+=3){const m=e[u+2],p=(e[u+0]-i)*l|0,h=(e[u+1]-o)*r|0;m>t.heightmap[h*dr+p]&&(t.heightmap[h*dr+p]=m)}}function Ox(t,e){const i={};i.indexArray=new Ia,i.indexArray.reserve(4*t.length),i.vertexArray=new fs,i.vertexArray.reserve(10*t.length),i.colorArray=new kn,i.vertexArray.reserve(10*t.length);let o=0;for(const u of t){const m=Math.min(10,Math.max(4,1.3*u.height))*e,p=[-u.normal[1],u.normal[0],0],h=Math.min(.29,.1*u.width/u.depth),y=u.width-2*u.depth*e*(h+.01),x=s.N.scaleAndAdd([],u.pos,p,y/2),E=s.N.scaleAndAdd([],u.pos,p,-y/2),S=[x[0],x[1],x[2]+u.height],C=[E[0],E[1],E[2]+u.height],w=s.N.scaleAndAdd([],u.normal,p,h);s.N.scale(w,w,m);const W=s.N.scaleAndAdd([],u.normal,p,-h);s.N.scale(W,W,m),s.N.add(w,x,w),s.N.add(W,E,W),x[2]+=.1,E[2]+=.1,i.vertexArray.emplaceBack(w[0],w[1],w[2]),i.vertexArray.emplaceBack(W[0],W[1],W[2]),i.vertexArray.emplaceBack(x[0],x[1],x[2]),i.vertexArray.emplaceBack(E[0],E[1],E[2]),i.vertexArray.emplaceBack(S[0],S[1],S[2]),i.vertexArray.emplaceBack(C[0],C[1],C[2]),i.vertexArray.emplaceBack(x[0],x[1],x[2]),i.vertexArray.emplaceBack(E[0],E[1],E[2]),i.vertexArray.emplaceBack(w[0],w[1],w[2]),i.vertexArray.emplaceBack(W[0],W[1],W[2]);const D=y/m/2;i.colorArray.emplaceBack(-D-h,-1,D,.8),i.colorArray.emplaceBack(D+h,-1,D,.8),i.colorArray.emplaceBack(-D,0,D,1.3),i.colorArray.emplaceBack(D,0,D,1.3),i.colorArray.emplaceBack(D+h,-.8,D,.7),i.colorArray.emplaceBack(D+h,-.8,D,.7),i.colorArray.emplaceBack(0,0,D,1.3),i.colorArray.emplaceBack(0,0,D,1.3),i.colorArray.emplaceBack(D+h,-1.2,D,.8),i.colorArray.emplaceBack(D+h,-1.2,D,.8),i.indexArray.emplaceBack(6+o,4+o,8+o),i.indexArray.emplaceBack(7+o,9+o,5+o),i.indexArray.emplaceBack(0+o,1+o,2+o),i.indexArray.emplaceBack(1+o,3+o,2+o),o+=10}const l={defined:!0,emissiveFactor:[0,0,0]},r={};return r.baseColorFactor=ca.white,l.pbrMetallicRoughness=r,i.material=l,i.aabb=new ea([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),i}mt(n1,"TriangleGridIndex");class r1{constructor(e){this._stringToNumber={},this._numberToString=[];for(let i=0;i<e.length;i++){const o=e[i];this._stringToNumber[o]=i,this._numberToString[i]=o}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const Sx=["tile","layer","source","sourceLayer","state"];class d1{constructor(e,i,o,l,r){this.type="Feature",this._vectorTileFeature=e,this._z=i,this._x=o,this._y=l,this.properties=e.properties,this.id=r}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(e.id=this.id);for(const i of Sx)this[i]!==void 0&&(e[i]=this[i]);return e}}class _1{constructor(e,i){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new ln(st,16,0),this.featureIndexArray=new Nc,this.promoteId=i,this.is3DTile=!1}insert(e,i,o,l,r,u=0,m=0){const p=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(o,l,r,u);const h=this.grid;for(let y=0;y<i.length;y++){const x=i[y],E=[1/0,1/0,-1/0,-1/0];for(let S=0;S<x.length;S++){const C=x[S];E[0]=Math.min(E[0],C.x),E[1]=Math.min(E[1],C.y),E[2]=Math.max(E[2],C.x),E[3]=Math.max(E[3],C.y)}m!==0&&(E[0]-=m,E[1]-=m,E[2]+=m,E[3]+=m),E[0]<st&&E[1]<st&&E[2]>=0&&E[3]>=0&&h.insert(p,E[0],E[1],E[2],E[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new mp(new _d(this.rawTileData)).layers,this.sourceLayerCoder=new r1(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,i,o,l){this.loadVTLayers();const r=e.params||{},u=po(r.filter),m=e.tileResult,p=e.transform,h=m.bufferedTilespaceBounds,y=this.grid.query(h.min.x,h.min.y,h.max.x,h.max.y,(C,w,W,D)=>Ph(m.bufferedTilespaceGeometry,C,w,W,D));y.sort(Rx);let x=null;p.elevation&&y.length>0&&(x=nd.create(p.elevation,this.tileID));const E={};let S;for(let C=0;C<y.length;C++){const w=y[C];if(w===S)continue;S=w;const W=this.featureIndexArray.get(w);let D=null;if(this.is3DTile){const Y=this.bucketLayerIDs[0][0],q=i[Y];if(q.type!=="model")continue;const{queryFeature:K,intersectionZ:ee}=q.queryIntersectsMatchingFeature(m,W.featureIndex,u,p);K&&this.appendToResult(E,Y,W.featureIndex,K,ee)}else this.loadMatchingFeature(E,W,u,r.layers,r.availableImages,i,o,l,(Y,q,K,ee=0)=>(D||(D=Sa(Y,this.tileID.canonical,e.tileTransform)),q.queryIntersectsFeature(m,Y,K,D,this.z,e.transform,e.pixelPosMatrix,x,ee)))}return E}loadMatchingFeature(e,i,o,l,r,u,m,p,h){const{featureIndex:y,bucketIndex:x,sourceLayerIndex:E,layoutVertexArrayOffset:S}=i,C=this.bucketLayerIDs[x];if(l&&!function(Y,q){for(let K=0;K<Y.length;K++)if(q.indexOf(Y[K])>=0)return!0;return!1}(l,C))return;const w=this.sourceLayerCoder.decode(E),W=this.vtLayers[w].feature(y);if(o.needGeometry){const Y=ya(W,!0);if(!o.filter(new qi(this.tileID.overscaledZ),Y,this.tileID.canonical))return}else if(!o.filter(new qi(this.tileID.overscaledZ),W))return;const D=this.getId(W,w);for(let Y=0;Y<C.length;Y++){const q=C[Y];if(l&&l.indexOf(q)<0)continue;const K=u[q];if(!K)continue;let ee={};D!==void 0&&p&&(ee=p.getState(K.sourceLayer||"_geojsonTileLayer",D));const J=!h||h(W,K,ee,S);if(!J)continue;const se=new d1(W,this.z,this.x,this.y,D),_e=za({},m[q]);_e.paint=u1(_e.paint,K.paint,W,ee,r),_e.layout=u1(_e.layout,K.layout,W,ee,r),se.layer=_e,this.appendToResult(e,q,y,se,J)}}appendToResult(e,i,o,l,r){let u=e[i];u===void 0&&(u=e[i]=[]),u.push({featureIndex:o,feature:l,intersectionZ:r})}lookupSymbolFeatures(e,i,o,l,r,u,m,p){const h={};this.loadVTLayers();const y=po(r);for(const x of e)this.loadMatchingFeature(h,{bucketIndex:o,sourceLayerIndex:l,featureIndex:x,layoutVertexArrayOffset:0},y,u,m,p,i);return h}loadFeature(e){const{featureIndex:i,sourceLayerIndex:o}=e;this.loadVTLayers();const l=this.sourceLayerCoder.decode(o),r=this.vtFeatures[l];if(r[i])return r[i];const u=this.vtLayers[l].feature(i);return r[i]=u,u}hasLayer(e){for(const i of this.bucketLayerIDs)for(const o of i)if(e===o)return!0;return!1}getId(e,i){let o=e.id;if(this.promoteId){const l=typeof this.promoteId=="string"?this.promoteId:this.promoteId[i];l!=null&&(o=e.properties[l]),typeof o=="boolean"&&(o=Number(o))}return o}}function u1(t,e,i,o,l){return Ha(t,(r,u)=>{const m=e instanceof Ul?e.get(u):null;return m&&m.evaluate?m.evaluate(i,o,l):m})}function Rx(t,e){return e-t}mt(_1,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const zp=new Float32Array(262144),ur=new Uint8Array(262144);function c1(t){let e=0;if(t.meshes)for(const i of t.meshes)e=Math.max(e,i.aabb.max[2]);if(t.children)for(const i of t.children)e=Math.max(e,c1(i));return e}function m1(t,e,i){if(t.meshes)for(const o of t.meshes)o.aabb.min[0]!==1/0&&i.insert(e,o.aabb.min[0],o.aabb.min[1],o.aabb.max[0],o.aabb.max[1]);if(t.children)for(const o of t.children)m1(o,e,i)}const f1=["","wall","door","roof","window","lamp","logo"];class p1{constructor(e){this.node=e,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:e.id,geometry:[],properties:{height:c1(e)}}}getLocalBounds(){if(!this.node.meshes)return new ea([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let e=0;const i=new ea([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const o of this.node.meshes)this.node.lightMeshIndex!==e&&i.encapsulate(o.aabb),e++;this.aabb=i}return this.aabb}}class Mm{constructor(e,i,o,l,r,u){this.id=i,this.modelTraits|=pd.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,o&&(this.modelTraits|=pd.HasMapboxMeshFeatures),l&&(this.modelTraits|=pd.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=r,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const m of e)this.nodesInfo.push(new p1(m)),m1(m,u.featureIndexArray.length,u.grid),u.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,u.bucketLayerIDs.length-1,0)}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(e){if(!this.needsUpload)return;const i=this.getNodesInfo();for(const o of i){const l=o.node;this.uploaded?this.updatePbrBuffer(l):Wp(l,e,!0)}for(const o of i)wm(o.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(e){let i=!1;if(!e.meshes)return i;for(const o of e.meshes)o.pbrBuffer&&(o.pbrBuffer.updateData(o.featureArray),i=!0);return i}needsReEvaluation(e,i,o){const l=e.transform.projectionOptions,r=e.style.getBrightness(),u=this.brightness!==r;return!!(!this.uploaded||this.dirty||l.name!==this.projection.name||Pu(o.paint.get("model-color").value,u)||Pu(o.paint.get("model-color-mix-intensity").value,u)||Pu(o.paint.get("model-roughness").value,u)||Pu(o.paint.get("model-emissive-strength").value,u)||Pu(o.paint.get("model-height-based-emissive-strength-multiplier").value,u))&&(this.projection=l,this.brightness=r,!0)}evaluateScale(e,i){if(e.transform.zoom===this.zoom)return;this.zoom=e.transform.zoom;const o=this.getNodesInfo(),l=this.id.canonical;for(const r of o){const u=r.feature;r.evaluatedScale=i.paint.get("model-scale").evaluate(u,{},l)}}evaluate(e){const i=this.getNodesInfo();for(const o of i){if(!o.node.meshes)continue;const l=o.feature,r=o.node.meshes&&o.node.meshes[0].featureData,u=o.evaluatedColor[2],m=o.evaluatedRMEA[2],p=this.id.canonical;if(o.hasTranslucentParts=!1,r){for(let h=0;h<f1.length;h++){const y=f1[h];y.length&&(l.properties.part=y);const x=e.paint.get("model-color").evaluate(l,{},p),E=e.paint.get("model-color-mix-intensity").evaluate(l,{},p);o.evaluatedColor[h]=[x.r,x.g,x.b,E],o.evaluatedRMEA[h][0]=e.paint.get("model-roughness").evaluate(l,{},p),o.evaluatedRMEA[h][2]=e.paint.get("model-emissive-strength").evaluate(l,{},p),o.evaluatedRMEA[h][3]=x.a,o.emissionHeightBasedParams[h]=e.paint.get("model-height-based-emissive-strength-multiplier").evaluate(l,{},p),!o.hasTranslucentParts&&x.a<1&&(o.hasTranslucentParts=!0)}delete l.properties.part,wx(o,u!==o.evaluatedColor[2]||m!==o.evaluatedRMEA[2],this.modelTraits)}else o.evaluatedRMEA[0][2]=e.paint.get("model-emissive-strength").evaluate(l,{},p);o.evaluatedScale=e.paint.get("model-scale").evaluate(l,{},p),this.updatePbrBuffer(o.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(e,i,o,l){const r=e.findDEMTileFor(o);if(r&&(r.tileID.canonical!==this.terrainTile||i!==this.terrainExaggeration)){if(r.dem&&r.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=r.tileID.overscaledZ;const u=nd.create(e,o,r);if(!u)return;this.modelTraits&pd.HasMapboxMeshFeatures&&this.updateDEM(e,u,o,l);for(const m of this.getNodesInfo()){const p=m.node;if(!p.footprint||!p.footprint.vertices||!p.footprint.vertices.length)continue;const h=p.footprint.vertices;let y=u.getElevationAt(h[0].x,h[0].y,!0,!0);for(let x=1;x<h.length;x++)y=Math.min(y,u.getElevationAt(h[x].x,h[x].y,!0,!0));p.elevation=y}}this.terrainTile=r.tileID.canonical,this.terrainExaggeration=i}}updateDEM(e,i,o,l){let r=i._dem._modifiedForSources[l];if(r===void 0&&(i._dem._modifiedForSources[l]=[],r=i._dem._modifiedForSources[l]),r.includes(o.canonical))return;const u=i._dem.dim;r.push(o.canonical);let m=!1;for(const p of this.getNodesInfo()){const h=p.node;if(!h.footprint||!h.footprint.grid)continue;const y=h.footprint.grid,x=i.tileCoordToPixel(y.min.x,y.min.y),E=i.tileCoordToPixel(y.max.x,y.max.y),S=Math.min(Math.min(u-E.y,x.x),Math.min(x.y,u-E.x));if(S<0)continue;const C=Vt(S,2,5);let w=Math.max(0,x.x-C),W=Math.max(0,x.y-C),D=Math.min(E.x+C,u-1),Y=Math.min(E.y+C,u-1);for(let J=W;J<=Y;++J)for(let se=w;se<=D;++se)ur[J*u+se]=255;let q=0,K=0;for(let J=0;J<y.cellsY;++J)for(let se=0;se<y.cellsX;++se){if(!y.cells[J*y.cellsX+se])continue;const _e=i.tileCoordToPixel(y.min.x+se/y.xScale,y.min.y+J/y.yScale),me=i.tileCoordToPixel(y.min.x+(se+1)/y.xScale,y.min.y+(J+1)/y.yScale);for(let be=_e.y;be<=Math.min(me.y+1,u-1);++be)for(let fe=_e.x;fe<=Math.min(me.x+1,u-1);++fe)ur[be*u+fe]===255&&(ur[be*u+fe]=0,q+=i.getElevationAtPixel(fe,be),K++)}const ee=q/K;w=Math.max(1,x.x-C),W=Math.max(1,x.y-C),D=Math.min(E.x+C,u-2),Y=Math.min(E.y+C,u-2),m=!0;for(let J=W;J<=Y;++J)for(let se=w;se<=D;++se)ur[J*u+se]===0&&(zp[J*u+se]=i._dem.set(se,J,ee));for(let J=1;J<C;++J){w=Math.max(1,x.x-J),W=Math.max(1,x.y-J),D=Math.min(E.x+J,u-2),Y=Math.min(E.y+J,u-2);for(let se=W;se<=Y;++se)for(let _e=w;_e<=D;++_e){const me=se*u+_e;if(ur[me]===255){let be=0,fe=0,Se=-1,De=-1;for(let Ae=-1;Ae<=1;++Ae)for(let We=-1;We<=1;++We){const xe=(se+Ae)*u+_e+We;if(ur[xe]>=J)continue;const Ne=zp[xe],Qe=Math.abs(Ne);Qe>fe&&(be=Ne,fe=Qe,Se=We,De=Ae)}if(fe>.1){const Ae=1-(J+.5*Math.abs(Se*De))/C;let We=i._dem.get(_e,se)+be*Ae;const xe=i._dem.get(_e+Se,se+De),Ne=i._dem.get(_e-Se,se-De,!0);(We-xe)*(We-Ne)>0&&(We=(xe+Ne)/2),zp[me]=i._dem.set(_e,se,We),ur[me]=J}}}}}m&&(i._demTile.needsDEMTextureUpload=!0,i._dem._timestamp=Ge.now())}getNodesInfo(){return this.nodesInfo}destroy(){const e=this.getNodesInfo();for(const i of e)wm(i.node),Mp(i.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(e,i){if(i.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=i.updateTime;const o=i.getReplacementRegionsForTile(e.toUnwrapped()),l=this.getNodesInfo();for(let r=0;r<this.nodesInfo.length;r++){const u=l[r].node;l[r].hiddenByReplacement=!!u.footprint&&!o.find(m=>m.footprint===u.footprint)}}getHeightAtTileCoord(e,i){const o=this.getNodesInfo(),l=[];for(let r=0;r<this.nodesInfo.length;r++){const u=o[r],m=u.node.meshes[0];if(e<m.aabb.min[0]||i<m.aabb.min[1]||e>m.aabb.max[0]||i>m.aabb.max[1])continue;const p=(e-m.aabb.min[0])/(m.aabb.max[0]-m.aabb.min[0])*dr|0,h=Math.min(63,(i-m.aabb.min[1])/(m.aabb.max[1]-m.aabb.min[1])*dr|0)*dr+Math.min(63,p);if(!(m.heightmap[h]<0&&u.node.footprint))return u.hiddenByReplacement?void 0:{height:m.heightmap[h],maxHeight:u.feature.properties.height,hidden:!1,verticalScale:u.evaluatedScale[2]};if(u.node.footprint.grid.query(new qe(e,i),new qe(e,i),l),l.length>0)return{height:void 0,maxHeight:u.feature.properties.height,hidden:u.hiddenByReplacement,verticalScale:u.evaluatedScale[2]}}}}function Pu(t,e){return!t.isLightConstant&&e}function Cx(t,e,i,o,l,r,u,m){let p=(61440&e|(61440&e)>>4)>>8,h=(3840&e|(3840&e)>>4)>>4,y=240&e|(240&e)>>4;i[3]>0&&(p=si(p,255*i[0],i[3]),h=si(h,255*i[1],i[3]),y=si(y,255*i[2],i[3]));const x=p<<8|h,E=y<<8|Math.floor(255*o[3]),S=function(J){const se=Vt(J,0,2);return Math.min(Math.round(.5*se*255),255)}(o[2])<<8|15*o[0]<<4|15*o[1],C=Vt(l[0],0,1),w=Vt(l[1],0,1),W=Vt(l[2],0,1),D=Vt(l[3],0,1);let Y,q,K,ee;if(C!==w&&u!==r&&w!==C){const J=u-r;q=1/(J*(w-C)),K=-(r+J*C)/(J*(w-C));const se=Vt(l[4],-1,1);ee=Math.pow(10,se),Y=255*W<<8|255*D}else Y=65535,q=0,K=1,ee=1;if(t.emplaceBack(x,E,S,Y,q,K,ee),m){const J=m.length;m.clear();for(let se=0;se<J;se++)m.emplaceBack(x,E,S,Y,q,K,ee)}}function wx(t,e,i){const o=t.node;let l=0;const r=i&pd.HasMeshoptCompression;for(const u of o.meshes){if(o.lights&&o.lightMeshIndex===l||!u.featureData)continue;u.featureArray=new Jl,u.featureArray.reserve(u.featureData.length);let m=e;for(const p of u.featureData){const h=r?65535&p:p>>16&65535,y=r?p>>16&65535:65535&p,x=(15&y)<8?15&y:0,E=t.evaluatedRMEA[x],S=t.evaluatedColor[x],C=t.emissionHeightBasedParams[x];let w;if(m&&x===2&&o.lights&&(w=new Jl,w.resize(10*o.lights.length)),Cx(u.featureArray,h,S,E,C,u.aabb.min[2],u.aabb.max[2],w),w&&m){m=!1;const W=o.meshes[o.lightMeshIndex];W.featureArray=w,W.featureArray._trim()}}u.featureArray._trim(),l++}}function h1(t,e,i,o){const l=1<<t.z;e.lat=di((o/st+t.y)/l),e.lng=kt((i/st+t.x)/l)}mt(Mm,"Tiled3dModelBucket",{omit:["layers"]}),mt(p1,"Tiled3dModelFeature");const Px={circle:class extends oo{constructor(t,e,i){super(t,ET,e,i)}createBucket(t){return new lo(t)}queryRadius(t){const e=t;return id("circle-radius",this,e)+id("circle-stroke-width",this,e)+Hc(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,i,o,l,r,u,m){const p=Nh(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),r.angle,t.pixelToTileUnitsFactor),h=this.paint.get("circle-radius").evaluate(e,i)+this.paint.get("circle-stroke-width").evaluate(e,i);return sy(t,o,r,u,m,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",p,h)}getProgramIds(){return["circle"]}getDefaultProgramParams(t,e){const i=ny(this);return{config:new N(this,e),defines:i,overrideFog:!1}}},heatmap:class extends oo{createBucket(t){return new ry(t)}constructor(t,e,i){super(t,e2,e,i),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=_u({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(t){return id("heatmap-radius",this,t)}queryIntersectsFeature(t,e,i,o,l,r,u,m){const p=this.paint.get("heatmap-radius").evaluate(e,i);return sy(t,o,r,u,m,!0,!0,new qe(0,0),p)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(t,e){return t==="heatmap"?{config:new N(this,e),overrideFog:!1}:{}}},hillshade:class extends oo{constructor(t,e,i){super(t,i2,e,i)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(t,e){return{overrideFog:!1}}},fill:class extends oo{constructor(t,e,i){super(t,h2,e,i)}getProgramIds(){const t=this.paint.get("fill-pattern"),e=t&&t.constantOr(1),i=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}getDefaultProgramParams(t,e){return{config:new N(this,e),overrideFog:!1}}recalculate(t,e){super.recalculate(t,e);const i=this.paint._values["fill-outline-color"];i.value.kind==="constant"&&i.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new cp(t)}queryRadius(){return Hc(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,i,o,l,r){return!t.queryGeometry.isAboveHorizon&&ps(Lh(t.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),r.angle,t.pixelToTileUnitsFactor),o)}isTileClipped(){return!0}},"fill-extrusion":class extends oo{constructor(t,e,i){super(t,G2,e,i),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(t){return new rm(t)}queryRadius(){return Hc(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(t,e,i,o,l,r,u,m,p){const h=Nh(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),r.angle,t.pixelToTileUnitsFactor),y=this.paint.get("fill-extrusion-height").evaluate(e,i),x=this.paint.get("fill-extrusion-base").evaluate(e,i),E=[0,0],S=m&&r.elevation,C=r.elevation?r.elevation.exaggeration():1,w=t.tile.getBucket(this);if(S&&w instanceof rm){const K=w.centroidVertexArray,ee=p+1;ee<K.length&&(E[0]=K.geta_centroid_pos0(ee),E[1]=K.geta_centroid_pos1(ee))}if(E[0]===0&&E[1]===1)return!1;r.projection.name==="globe"&&(o=Yy([o],[new qe(0,0),new qe(st,st)],t.tileID.canonical).map(K=>K.polygon).flat());const W=S?m:null,[D,Y]=function(K,ee,J,se,_e,me,be,fe,Se,De,Ae){return K.projection.name==="globe"?function(We,xe,Ne,Qe,Be,pt,dt,ze,Lt,Et,ft){const He=[],Ct=[],$t=We.projection.upVectorScale(ft,We.center.lat,We.worldSize).metersToTile,Wt=[0,0,0,1],Zt=[0,0,0,1],Ut=(Ht,Ni,pi,gi)=>{Ht[0]=Ni,Ht[1]=pi,Ht[2]=gi,Ht[3]=1},li=Hy();Ne>0&&(Ne+=li),Qe+=li;for(const Ht of xe){const Ni=[],pi=[];for(const gi of Ht){const Ei=gi.x+Be.x,hi=gi.y+Be.y,Ki=We.projection.projectTilePoint(Ei,hi,ft),Ri=We.projection.upVector(ft,gi.x,gi.y);let aa=Ne,xa=Qe;if(dt){const Ua=Vy(Ei,hi,Ne,Qe,dt,ze,Lt,Et);aa+=Ua.base,xa+=Ua.top}Ne!==0?Ut(Wt,Ki.x+Ri[0]*$t*aa,Ki.y+Ri[1]*$t*aa,Ki.z+Ri[2]*$t*aa):Ut(Wt,Ki.x,Ki.y,Ki.z),Ut(Zt,Ki.x+Ri[0]*$t*xa,Ki.y+Ri[1]*$t*xa,Ki.z+Ri[2]*$t*xa),s.N.transformMat4(Wt,Wt,pt),s.N.transformMat4(Zt,Zt,pt),Ni.push(new sd(Wt[0],Wt[1],Wt[2])),pi.push(new sd(Zt[0],Zt[1],Zt[2]))}He.push(Ni),Ct.push(pi)}return[He,Ct]}(K,ee,J,se,_e,me,be,fe,Se,De,Ae):be?function(We,xe,Ne,Qe,Be,pt,dt,ze,Lt){const Et=[],ft=[],He=[0,0,0,1];for(const Ct of We){const $t=[],Wt=[];for(const Zt of Ct){const Ut=Zt.x+Qe.x,li=Zt.y+Qe.y,Ht=Vy(Ut,li,xe,Ne,pt,dt,ze,Lt);He[0]=Ut,He[1]=li,He[2]=Ht.base,He[3]=1,s.a7.transformMat4(He,He,Be),He[3]=Math.max(He[3],1e-5);const Ni=new sd(He[0]/He[3],He[1]/He[3],He[2]/He[3]);He[0]=Ut,He[1]=li,He[2]=Ht.top,He[3]=1,s.a7.transformMat4(He,He,Be),He[3]=Math.max(He[3],1e-5);const pi=new sd(He[0]/He[3],He[1]/He[3],He[2]/He[3]);$t.push(Ni),Wt.push(pi)}Et.push($t),ft.push(Wt)}return[Et,ft]}(ee,J,se,_e,me,be,fe,Se,De):function(We,xe,Ne,Qe,Be){const pt=[],dt=[],ze=Be[8]*xe,Lt=Be[9]*xe,Et=Be[10]*xe,ft=Be[11]*xe,He=Be[8]*Ne,Ct=Be[9]*Ne,$t=Be[10]*Ne,Wt=Be[11]*Ne;for(const Zt of We){const Ut=[],li=[];for(const Ht of Zt){const Ni=Ht.x+Qe.x,pi=Ht.y+Qe.y,gi=Be[0]*Ni+Be[4]*pi+Be[12],Ei=Be[1]*Ni+Be[5]*pi+Be[13],hi=Be[2]*Ni+Be[6]*pi+Be[14],Ki=Be[3]*Ni+Be[7]*pi+Be[15],Ri=gi+ze,aa=Ei+Lt,xa=hi+Et,Ua=Math.max(Ki+ft,1e-5),Gi=gi+He,Ji=Ei+Ct,wa=hi+$t,Pa=Math.max(Ki+Wt,1e-5);Ut.push(new sd(Ri/Ua,aa/Ua,xa/Ua)),li.push(new sd(Gi/Pa,Ji/Pa,wa/Pa))}pt.push(Ut),dt.push(li)}return[pt,dt]}(ee,J,se,_e,me)}(r,o,x,y,h,u,W,E,C,r.center.lat,t.tileID.canonical),q=t.queryGeometry;return function(K,ee,J){let se=1/0;ps(J,ee)&&(se=Gy(J,ee[0]));for(let _e=0;_e<ee.length;_e++){const me=ee[_e],be=K[_e];for(let fe=0;fe<me.length-1;fe++){const Se=me[fe],De=[Se,me[fe+1],be[fe+1],be[fe],Se];Xo(J,De)&&(se=Math.min(se,Gy(J,De)))}}return se!==1/0&&se}(D,Y,q.isPointQuery()?q.screenBounds:q.screenGeometry)}},line:class extends oo{constructor(t,e,i){super(t,Ky,e,i),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof wl,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=Qy.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new pp(t)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(t,e){const i=Xy(this);return{config:new N(this,e),defines:i,overrideFog:!1}}queryRadius(t){const e=t,i=e0(id("line-width",this,e),id("line-gap-width",this,e)),o=id("line-offset",this,e);return i/2+Math.abs(o)+Hc(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,i,o,l,r){if(t.queryGeometry.isAboveHorizon)return!1;const u=Lh(t.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),r.angle,t.pixelToTileUnitsFactor),m=t.pixelToTileUnitsFactor/2*e0(this.paint.get("line-width").evaluate(e,i),this.paint.get("line-gap-width").evaluate(e,i)),p=this.paint.get("line-offset").evaluate(e,i);return p&&(o=function(h,y){const x=[],E=new qe(0,0);for(let S=0;S<h.length;S++){const C=h[S],w=[];for(let W=0;W<C.length;W++){const D=C[W],Y=C[W+1],q=W===0?E:D.sub(C[W-1])._unit()._perp(),K=W===C.length-1?E:Y.sub(D)._unit()._perp(),ee=q._add(K)._unit();ee._mult(1/(ee.x*K.x+ee.y*K.y)),w.push(ee._mult(y)._add(D))}x.push(w)}return x}(o,p*t.pixelToTileUnitsFactor)),function(h,y,x){for(let E=0;E<y.length;E++){const S=y[E];if(h.length>=3){for(let C=0;C<S.length;C++)if(un(h,S[C]))return!0}if(ar(h,S,x))return!0}return!1}(u,o,m)}isTileClipped(){return!0}},symbol:Am,background:class extends oo{constructor(t,e,i){super(t,K3,e,i)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(t,e){return{overrideFog:!1}}},raster:U0,"raster-particle":k0,sky:class extends oo{constructor(t,e,i){super(t,tx,e,i),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="sky-gradient"?this._updateColorRamp():t!=="sky-atmosphere-sun"&&t!=="sky-atmosphere-halo-color"&&t!=="sky-atmosphere-color"&&t!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=_u({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(t){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=t.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(t,e){if(this.paint.get("sky-type")==="atmosphere"){const o=this.paint.get("sky-atmosphere-sun"),l=!o,r=t.style.light,u=r.properties.get("position");return l&&r.properties.get("anchor")==="viewport"&&ta("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),l?Pp(u.azimuthal,90-u.polar,e):Pp(o[0],90-o[1],e)}const i=this.paint.get("sky-gradient-center");return Pp(i[0],90-i[1],e)}isSky(){return!0}markSkyboxValid(t){this._skyboxInvalidated=!1,this._lightPosition=t.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const t=this.paint.get("sky-type");return t==="atmosphere"?["skyboxCapture","skybox"]:t==="gradient"?["skyboxGradient"]:null}},slot:class extends oo{constructor(t,e,i){super(t,ix,e)}},model:class extends oo{constructor(t,e,i){super(t,ux,e,i),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(t){return new Np(t)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(t){return t instanceof Mm?st-1:0}queryIntersectsFeature(t,e,i,o,l,r){if(!this.modelManager)return!1;const u=this.modelManager,m=t.tile.getBucket(this);if(!(m&&m instanceof Np))return!1;const p=m;for(const h in p.instancesPerModel){const y=p.instancesPerModel[h];if(y.idToFeaturesIndex.hasOwnProperty(e.id)){const x=y.features[y.idToFeaturesIndex[e.id]],E=u.getModel(h,this.scope);if(!E)return!1;let S=s.a6.create();const C=new ce(0,0),w=p.canonical;let W=Number.MAX_VALUE;for(let D=0;D<x.instancedDataCount;++D){const Y=16*(x.instancedDataOffset+D),q=y.instancedDataArray.float32,K=[q[Y+4],q[Y+5],q[Y+6]];h1(w,C,q[Y],0|q[Y+1]),$0(S,E,r,C,x.rotation,x.scale,K,!1,!1,!1),r.projection.name==="globe"&&(S=Lp(S,r));const ee=s.a6.multiply([],r.projMatrix,S),J=t.queryGeometry,se=j0(J.isPointQuery()?J.screenBounds:J.screenGeometry,r,ee,E.aabb);se!=null&&(W=Math.min(se,W))}return W!==Number.MAX_VALUE&&W}}return!1}_handleOverridablePaintPropertyUpdate(t,e,i){return!(!this.layout||e.isDataDriven()||i.isDataDriven()||t!=="model-color"&&t!=="model-color-mix-intensity"&&t!=="model-rotation"&&t!=="model-scale"&&t!=="model-translation"&&t!=="model-emissive-strength")}_isPropertyZoomDependent(t){const e=this._transitionablePaint._values[t];return e!=null&&e.value!=null&&e.value.expression!=null&&e.value.expression instanceof Ml}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}queryIntersectsMatchingFeature(t,e,i,o){const l=t.tile,r=l.getBucket(this);let u=null,m=Number.MAX_VALUE;if(!(r&&r instanceof Mm))return{queryFeature:u,intersectionZ:m};const p=r.getNodesInfo()[e];if(p.hiddenByReplacement||!p.node.meshes||!i.filter(new qi(l.tileID.overscaledZ),p.feature,l.tileID.canonical))return{queryFeature:u,intersectionZ:m};const h=p.node,y=o.calculatePosMatrix(l.tileID.toUnwrapped(),o.worldSize),x=p.evaluatedScale;let E=0;o.elevation&&h.elevation&&(E=h.elevation*o.elevation.exaggeration()),s.a6.translate(y,y,[(h.anchor?h.anchor[0]:0)*(x[0]-1),(h.anchor?h.anchor[1]:0)*(x[1]-1),E]),s.a6.scale(y,y,x),s.a6.multiply(y,y,h.matrix);const S=t.queryGeometry,C=S.isPointQuery()?S.screenBounds:S.screenGeometry,w=function(D){const Y=s.a6.multiply([],y,D.matrix),q=s.a6.multiply(Y,o.expandedFarZProjMatrix,Y);for(let K=0;K<D.meshes.length;++K){const ee=D.meshes[K];if(K===D.lightMeshIndex)continue;const J=j0(C,o,q,ee.aabb);J!=null&&(m=Math.min(J,m))}if(D.children)for(const K of D.children)w(K)};if(w(h),m===Number.MAX_VALUE)return{queryFeature:u,intersectionZ:m};const W=new ce(0,0);return h1(l.tileID.canonical,W,p.node.anchor[0],p.node.anchor[1]),u={type:"Feature",geometry:{type:"Point",coordinates:[W.lng,W.lat]},properties:p.feature.properties,id:p.feature.id,state:{},layer:this.serialize()},{queryFeature:u,intersectionZ:m}}}},Gt={read:function(t,e){return t.readFields(Gt._readField,{header_length:0,x:0,y:0,z:0,layers:[]},e)},_readField:function(t,e,i){t===1?e.header_length=i.readFixed32():t===2?e.x=i.readVarint():t===3?e.y=i.readVarint():t===4?e.z=i.readVarint():t===5&&e.layers.push(Gt.Layer.read(i,i.readVarint()+i.pos))},PixelFormat:{PIXEL_FORMAT_UNKNOWN:{value:0,options:{}},PIXEL_FORMAT_UINT32:{value:1,options:{}},PIXEL_FORMAT_UINT16:{value:2,options:{}},PIXEL_FORMAT_UINT8:{value:3,options:{}}},Filter:{}};Gt.Filter.read=function(t,e){return t.readFields(Gt.Filter._readField,{delta_filter:null,filter:null,zigzag_filter:null,bitshuffle_filter:null,byteshuffle_filter:null},e)},Gt.Filter._readField=function(t,e,i){t===1?(e.delta_filter=Gt.Filter.Delta.read(i,i.readVarint()+i.pos),e.filter="delta_filter"):t===2?(e.zigzag_filter=Gt.Filter.Zigzag.read(i,i.readVarint()+i.pos),e.filter="zigzag_filter"):t===3?(e.bitshuffle_filter=Gt.Filter.BitShuffle.read(i,i.readVarint()+i.pos),e.filter="bitshuffle_filter"):t===4&&(e.byteshuffle_filter=Gt.Filter.ByteShuffle.read(i,i.readVarint()+i.pos),e.filter="byteshuffle_filter")},Gt.Filter.Delta={},Gt.Filter.Delta.read=function(t,e){return t.readFields(Gt.Filter.Delta._readField,{block_size:0},e)},Gt.Filter.Delta._readField=function(t,e,i){t===1&&(e.block_size=i.readVarint())},Gt.Filter.Zigzag={},Gt.Filter.Zigzag.read=function(t,e){return t.readFields(Gt.Filter.Zigzag._readField,{},e)},Gt.Filter.Zigzag._readField=function(t,e,i){},Gt.Filter.BitShuffle={},Gt.Filter.BitShuffle.read=function(t,e){return t.readFields(Gt.Filter.BitShuffle._readField,{},e)},Gt.Filter.BitShuffle._readField=function(t,e,i){},Gt.Filter.ByteShuffle={},Gt.Filter.ByteShuffle.read=function(t,e){return t.readFields(Gt.Filter.ByteShuffle._readField,{},e)},Gt.Filter.ByteShuffle._readField=function(t,e,i){},Gt.Codec={},Gt.Codec.read=function(t,e){return t.readFields(Gt.Codec._readField,{gzip_data:null,codec:null,jpeg_image:null,webp_image:null,png_image:null},e)},Gt.Codec._readField=function(t,e,i){t===1?(e.gzip_data=Gt.Codec.GzipData.read(i,i.readVarint()+i.pos),e.codec="gzip_data"):t===2?(e.jpeg_image=Gt.Codec.JpegImage.read(i,i.readVarint()+i.pos),e.codec="jpeg_image"):t===3?(e.webp_image=Gt.Codec.WebpImage.read(i,i.readVarint()+i.pos),e.codec="webp_image"):t===4&&(e.png_image=Gt.Codec.PngImage.read(i,i.readVarint()+i.pos),e.codec="png_image")},Gt.Codec.GzipData={},Gt.Codec.GzipData.read=function(t,e){return t.readFields(Gt.Codec.GzipData._readField,{},e)},Gt.Codec.GzipData._readField=function(t,e,i){},Gt.Codec.JpegImage={},Gt.Codec.JpegImage.read=function(t,e){return t.readFields(Gt.Codec.JpegImage._readField,{},e)},Gt.Codec.JpegImage._readField=function(t,e,i){},Gt.Codec.WebpImage={},Gt.Codec.WebpImage.read=function(t,e){return t.readFields(Gt.Codec.WebpImage._readField,{},e)},Gt.Codec.WebpImage._readField=function(t,e,i){},Gt.Codec.PngImage={},Gt.Codec.PngImage.read=function(t,e){return t.readFields(Gt.Codec.PngImage._readField,{},e)},Gt.Codec.PngImage._readField=function(t,e,i){},Gt.DataIndexEntry={},Gt.DataIndexEntry.read=function(t,e){return t.readFields(Gt.DataIndexEntry._readField,{first_byte:0,last_byte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},e)},Gt.DataIndexEntry._readField=function(t,e,i){t===1?e.first_byte=i.readFixed64():t===2?e.last_byte=i.readFixed64():t===3?e.filters.push(Gt.Filter.read(i,i.readVarint()+i.pos)):t===4?e.codec=Gt.Codec.read(i,i.readVarint()+i.pos):t===5?e.offset=i.readFloat():t===6?e.scale=i.readFloat():t===7&&e.bands.push(i.readString())},Gt.Layer={},Gt.Layer.read=function(t,e){return t.readFields(Gt.Layer._readField,{version:0,name:"",units:"",tilesize:0,buffer:0,pixel_format:0,data_index:[]},e)},Gt.Layer._readField=function(t,e,i){t===1?e.version=i.readVarint():t===2?e.name=i.readString():t===3?e.units=i.readString():t===4?e.tilesize=i.readVarint():t===5?e.buffer=i.readVarint():t===6?e.pixel_format=i.readVarint():t===7&&e.data_index.push(Gt.DataIndexEntry.read(i,i.readVarint()+i.pos))};const gn={read:function(t,e){return t.readFields(gn._readField,{uint32_values:null,values:null,fixed32_values:null},e)},_readField:function(t,e,i){t===2?(e.uint32_values=gn.Uint32Values.read(i,i.readVarint()+i.pos),e.values="uint32_values"):t===3&&(e.fixed32_values=gn.Fixed32Values.read(i,i.readVarint()+i.pos),e.values="fixed32_values")},Uint32Values:{}};gn.Uint32Values.read=function(t,e){return t.readFields(gn.Uint32Values._readField,{values:[]},e)},gn.Uint32Values._readField=function(t,e,i){t===1&&(e.readValuesInto=function(o){if(o.type!==2)throw new Error(`Unsupported pbf type "${o.type}"`);const l=function(u){return u.type===2?u.readVarint()+u.pos:u.pos+1}(o),r=o.pos;return o.pos=l,function(u){o.pos=r;let m=0;for(;o.pos<l;){const p=o.readVarint();u[m++]=p}return u}}(i))},gn.Fixed32Values={},gn.Fixed32Values.read=function(t,e){return t.readFields(gn.Fixed32Values._readField,{values:[]},e)},gn.Fixed32Values._readField=function(t,e,i){throw new Error("Not implemented")};/**
 * tiny-lru
 *
 * @copyright 2023 Jason Mulligan <jason.mulligan@avoidwork.com>
 * @license BSD-3-Clause
 * @version 11.2.5
 */class Lx{constructor(e=0,i=0,o=!1){this.first=null,this.items=Object.create(null),this.last=null,this.max=e,this.resetTtl=o,this.size=0,this.ttl=i}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(e){if(this.has(e)){const i=this.items[e];delete this.items[e],this.size--,i.prev!==null&&(i.prev.next=i.next),i.next!==null&&(i.next.prev=i.prev),this.first===i&&(this.first=i.next),this.last===i&&(this.last=i.prev)}return this}entries(e=this.keys()){return e.map(i=>[i,this.get(i)])}evict(e=!1){if(e||this.size>0){const i=this.first;delete this.items[i.key],--this.size==0?(this.first=null,this.last=null):(this.first=i.next,this.first.prev=null)}return this}expiresAt(e){let i;return this.has(e)&&(i=this.items[e].expiry),i}get(e){let i;if(this.has(e)){const o=this.items[e];this.ttl>0&&o.expiry<=Date.now()?this.delete(e):(i=o.value,this.set(e,i,!0))}return i}has(e){return e in this.items}keys(){const e=[];let i=this.first;for(;i!==null;)e.push(i.key),i=i.next;return e}set(e,i,o=!1,l=this.resetTtl){let r;if(o||this.has(e)){if(r=this.items[e],r.value=i,o===!1&&l&&(r.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl),this.last!==r){const u=this.last,m=r.next,p=r.prev;this.first===r&&(this.first=r.next),r.next=null,r.prev=this.last,u.next=r,p!==null&&(p.next=m),m!==null&&(m.prev=p)}}else this.max>0&&this.size===this.max&&this.evict(!0),r=this.items[e]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:i},++this.size==1?this.first=r:this.last.next=r;return this.last=r,this}values(e=this.keys()){return e.map(i=>this.get(i))}}function Nx(t,e){if(e.length!==4)throw new Error(`Expected data of dimension 4 but got ${e.length}.`);let i=e[3];for(let o=2;o>=1;o--){const l=o===1?1:0,r=o===2?1:0;for(let u=0;u<e[0];u++){const m=e[1]*u;for(let p=l;p<e[1];p++){const h=e[2]*(p+m);for(let y=r;y<e[2];y++){const x=e[3]*(y+h);for(let E=0;E<e[3];E++){const S=x+E;t[S]+=t[S-i]}}}}i*=e[o]}return t}function Wx(t){for(let e=0,i=t.length;e<i;e++)t[e]=t[e]>>>1^-(1&t[e]);return t}function Mx(t,e){switch(e){case"uint32":return t;case"uint16":for(let i=0;i<t.length;i+=2){const o=t[i],l=t[i+1];t[i]=(240&o)>>4|(61440&o)>>8|(240&l)<<4|61440&l,t[i+1]=15&o|(3840&o)>>4|(15&l)<<8|(3840&l)<<4}return t;case"uint8":for(let i=0;i<t.length;i+=4){const o=t[i],l=t[i+1],r=t[i+2],u=t[i+3];t[i+0]=(192&o)>>6|(192&l)>>4|(192&r)>>2|192&u,t[i+1]=(48&o)>>4|(48&l)>>2|48&r|(48&u)<<2,t[i+2]=(12&o)>>2|12&l|(12&r)<<2|(12&u)<<4,t[i+3]=3&o|(3&l)<<2|(3&r)<<4|(3&u)<<6}return t;default:throw new Error(`Invalid pixel format, "${e}"`)}}class rl extends Error{constructor(e){super(e),this.name="MRTError"}}var Vo=Uint8Array,bd=Uint16Array,Dx=Int32Array,g1=new Vo([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),y1=new Vo([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Fx=new Vo([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),b1=function(t,e){for(var i=new bd(31),o=0;o<31;++o)i[o]=e+=1<<t[o-1];var l=new Dx(i[30]);for(o=1;o<30;++o)for(var r=i[o];r<i[o+1];++r)l[r]=r-i[o]<<5|o;return{b:i,r:l}},T1=b1(g1,2),x1=T1.b,Bx=T1.r;x1[28]=258,Bx[258]=28;for(var Ux=b1(y1,0).b,Hp=new bd(32768),ma=0;ma<32768;++ma){var Td=(43690&ma)>>1|(21845&ma)<<1;Hp[ma]=((65280&(Td=(61680&(Td=(52428&Td)>>2|(13107&Td)<<2))>>4|(3855&Td)<<4))>>8|(255&Td)<<8)>>1}var Lu=function(t,e,i){for(var o=t.length,l=0,r=new bd(e);l<o;++l)t[l]&&++r[t[l]-1];var u,m=new bd(e);for(l=1;l<e;++l)m[l]=m[l-1]+r[l-1]<<1;if(i){u=new bd(1<<e);var p=15-e;for(l=0;l<o;++l)if(t[l])for(var h=l<<4|t[l],y=e-t[l],x=m[t[l]-1]++<<y,E=x|(1<<y)-1;x<=E;++x)u[Hp[x]>>p]=h}else for(u=new bd(o),l=0;l<o;++l)t[l]&&(u[l]=Hp[m[t[l]-1]++]>>15-t[l]);return u},Nu=new Vo(288);for(ma=0;ma<144;++ma)Nu[ma]=8;for(ma=144;ma<256;++ma)Nu[ma]=9;for(ma=256;ma<280;++ma)Nu[ma]=7;for(ma=280;ma<288;++ma)Nu[ma]=8;var v1=new Vo(32);for(ma=0;ma<32;++ma)v1[ma]=5;var kx=Lu(Nu,9,1),zx=Lu(v1,5,1),Yp=function(t){for(var e=t[0],i=1;i<t.length;++i)t[i]>e&&(e=t[i]);return e},yn=function(t,e,i){var o=e/8|0;return(t[o]|t[o+1]<<8)>>(7&e)&i},Gp=function(t,e){var i=e/8|0;return(t[i]|t[i+1]<<8|t[i+2]<<16)>>(7&e)},Hx=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],bn=function(t,e,i){var o=new Error(e||Hx[t]);if(o.code=t,Error.captureStackTrace&&Error.captureStackTrace(o,bn),!i)throw o;return o},Yx=new Vo(0),Gx=typeof TextDecoder<"u"&&new TextDecoder;try{Gx.decode(Yx,{stream:!0})}catch{}const Vx={gzip_data:"gzip"},jx={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},Kx={uint32:1,uint16:2,uint8:4},qx={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};class E1{constructor(e=1){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=e}getLayer(e){return this.layers[e]}getHeaderLength(e){const i=new Uint8Array(e),o=new DataView(e);if(i[0]!==13)throw new rl("File is not a valid MRT.");return o.getUint32(1,!0)}parseHeader(e){const i=new Uint8Array(e),o=this.getHeaderLength(e);if(i.length<o)throw new rl(`Expected header with length >= ${o} but got buffer of length ${i.length}`);const l=new _d(i.subarray(0,o)),r=Gt.read(l);if(!isNaN(this.x)&&(this.x!==r.x||this.y!==r.y||this.z!==r.z))throw new rl(`Invalid attempt to parse header ${r.z}/${r.x}/${r.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=r.x,this.y=r.y,this.z=r.z;for(const u of r.layers)this.layers[u.name]=new $x(u,{cacheSize:this._cacheSize});return this}createDecodingTask(e){const i=[],o=this.getLayer(e.layerName);for(let l=0;l<o.dataIndex.length;l++){const r=o.dataIndex[l],u=r.first_byte-e.firstByte,m=r.last_byte+1-e.firstByte;if(l<e.firstBlock||l>e.lastBlock||o._blocksInProgress.has(l))continue;const p={layerName:o.name,firstByte:u,lastByte:m,pixelFormat:o.pixelFormat,blockIndex:l,blockShape:[r.bands.length].concat(o.bandShape),buffer:o.buffer,codec:r.codec.codec,filters:r.filters.map(h=>h.filter)};o._blocksInProgress.add(l),i.push(p)}return new A1(i,()=>{i.forEach(l=>o._blocksInProgress.delete(l.blockIndex))},(l,r)=>{if(i.forEach(u=>o._blocksInProgress.delete(u.blockIndex)),l)throw l;r.forEach(u=>{this.getLayer(u.layerName).processDecodedData(u)})})}}class $x{constructor({version:e,name:i,units:o,tilesize:l,pixel_format:r,buffer:u,data_index:m},p){if(this.version=e,this.version!==1)throw new rl(`Cannot parse raster layer encoded with MRT version ${e}`);this.name=i,this.units=o,this.tileSize=l,this.buffer=u,this.pixelFormat=jx[r],this.dataIndex=m,this.bandShape=[l+2*u,l+2*u,Kx[this.pixelFormat]],this._decodedBlocks=function(h=1e3,y=0,x=!1){if(isNaN(h)||h<0)throw new TypeError("Invalid max value");if(isNaN(y)||y<0)throw new TypeError("Invalid ttl value");if(typeof x!="boolean")throw new TypeError("Invalid resetTtl value");return new Lx(h,y,x)}(p?p.cacheSize:5),this._blocksInProgress=new Set}processDecodedData(e){const i=e.blockIndex.toString();this._decodedBlocks.get(i)||this._decodedBlocks.set(i,e.data)}getBlockForBand(e){let i=0;switch(typeof e){case"string":for(const[o,l]of this.dataIndex.entries()){for(const[r,u]of l.bands.entries())if(u===e)return{bandIndex:i+r,blockIndex:o,blockBandIndex:r};i+=l.bands.length}break;case"number":for(const[o,l]of this.dataIndex.entries()){if(e>=i&&e<i+l.bands.length)return{bandIndex:e,blockIndex:o,blockBandIndex:e-i};i+=l.bands.length}break;default:throw new rl(`Invalid band \`${JSON.stringify(e)}\`. Expected string or integer.`)}throw new rl(`Band not found: ${JSON.stringify(e)}`)}getDataRange(e){let i=1/0,o=-1/0,l=1/0,r=-1/0;for(const u of e){const{blockIndex:m}=this.getBlockForBand(u);if(m<0)throw new rl(`Invalid band: ${JSON.stringify(u)}`);const p=this.dataIndex[m];l=Math.min(l,m),r=Math.max(r,m),i=Math.min(i,p.first_byte),o=Math.max(o,p.last_byte)}return{layerName:this.name,firstByte:i,lastByte:o,firstBlock:l,lastBlock:r}}hasBand(e){const{blockIndex:i}=this.getBlockForBand(e);return i>=0}hasDataForBand(e){const{blockIndex:i}=this.getBlockForBand(e);return i>=0&&!!this._decodedBlocks.get(i.toString())}getBandView(e){const{blockIndex:i,blockBandIndex:o}=this.getBlockForBand(e),l=this._decodedBlocks.get(i.toString());if(!l)throw new rl(`Data for band ${JSON.stringify(e)} of layer "${this.name}" not decoded.`);const r=this.dataIndex[i],u=this.bandShape.reduce((h,y)=>h*y,1),m=o*u,p=l.subarray(m,m+u);return{data:p,bytes:new Uint8Array(p.buffer).subarray(p.byteOffset,p.byteOffset+p.byteLength),tileSize:this.tileSize,buffer:this.buffer,offset:r.offset,scale:r.scale}}}class A1{constructor(e,i,o){this.tasks=e,this._onCancel=i,this._onComplete=o,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(e,i){this._finalized||(this._onComplete(e,i),this._finalized=!0)}}E1.performDecoding=function(t,e){return Promise.all(e.tasks.map(i=>{const{layerName:o,firstByte:l,lastByte:r,pixelFormat:u,blockShape:m,blockIndex:p,filters:h,codec:y}=i,x=new Uint8Array(t).subarray(l,r+1),E=new Uint32Array(m[0]*m[1]*m[2]);let S;if(y!=="gzip_data")throw new Error(`Unhandled codec: ${y}`);return S=function(C,w){if(!globalThis.DecompressionStream&&w==="gzip_data")return Promise.resolve(((q=function(J){J[0]==31&&J[1]==139&&J[2]==8||bn(6,"invalid gzip data");var se=J[3],_e=10;4&se&&(_e+=2+(J[10]|J[11]<<8));for(var me=(se>>3&1)+(se>>4&1);me>0;me-=!J[_e++]);return _e+(2&se)}(Y=C))+8>Y.length&&bn(6,"invalid gzip data"),function(J,se,_e,me){var be=J.length;if(!be||se.f&&!se.l)return _e||new Vo(0);var fe=!_e,Se=fe||se.i!=2,De=se.i;fe&&(_e=new Vo(3*be));var Ae=function(ro){var Xa=_e.length;if(ro>Xa){var jo=new Vo(Math.max(2*Xa,ro));jo.set(_e),_e=jo}},We=se.f||0,xe=se.p||0,Ne=se.b||0,Qe=se.l,Be=se.d,pt=se.m,dt=se.n,ze=8*be;do{if(!Qe){We=yn(J,xe,1);var Lt=yn(J,xe+1,3);if(xe+=3,!Lt){var Et=J[(pi=4+((xe+7)/8|0))-4]|J[pi-3]<<8,ft=pi+Et;if(ft>be){De&&bn(0);break}Se&&Ae(Ne+Et),_e.set(J.subarray(pi,ft),Ne),se.b=Ne+=Et,se.p=xe=8*ft,se.f=We;continue}if(Lt==1)Qe=kx,Be=zx,pt=9,dt=5;else if(Lt==2){var He=yn(J,xe,31)+257,Ct=yn(J,xe+10,15)+4,$t=He+yn(J,xe+5,31)+1;xe+=14;for(var Wt=new Vo($t),Zt=new Vo(19),Ut=0;Ut<Ct;++Ut)Zt[Fx[Ut]]=yn(J,xe+3*Ut,7);xe+=3*Ct;var li=Yp(Zt),Ht=(1<<li)-1,Ni=Lu(Zt,li,1);for(Ut=0;Ut<$t;){var pi,gi=Ni[yn(J,xe,Ht)];if(xe+=15&gi,(pi=gi>>4)<16)Wt[Ut++]=pi;else{var Ei=0,hi=0;for(pi==16?(hi=3+yn(J,xe,3),xe+=2,Ei=Wt[Ut-1]):pi==17?(hi=3+yn(J,xe,7),xe+=3):pi==18&&(hi=11+yn(J,xe,127),xe+=7);hi--;)Wt[Ut++]=Ei}}var Ki=Wt.subarray(0,He),Ri=Wt.subarray(He);pt=Yp(Ki),dt=Yp(Ri),Qe=Lu(Ki,pt,1),Be=Lu(Ri,dt,1)}else bn(1);if(xe>ze){De&&bn(0);break}}Se&&Ae(Ne+131072);for(var aa=(1<<pt)-1,xa=(1<<dt)-1,Ua=xe;;Ua=xe){var Gi=(Ei=Qe[Gp(J,xe)&aa])>>4;if((xe+=15&Ei)>ze){De&&bn(0);break}if(Ei||bn(2),Gi<256)_e[Ne++]=Gi;else{if(Gi==256){Ua=xe,Qe=null;break}var Ji=Gi-254;Gi>264&&(Ji=yn(J,xe,(1<<(La=g1[Ut=Gi-257]))-1)+x1[Ut],xe+=La);var wa=Be[Gp(J,xe)&xa],Pa=wa>>4;if(wa||bn(3),xe+=15&wa,Ri=Ux[Pa],Pa>3){var La=y1[Pa];Ri+=Gp(J,xe)&(1<<La)-1,xe+=La}if(xe>ze){De&&bn(0);break}Se&&Ae(Ne+131072);var ki=Ne+Ji;if(Ne<Ri){var So=0-Ri,dl=Math.min(Ri,ki);for(So+Ne<0&&bn(3);Ne<dl;++Ne)_e[Ne]=me[So+Ne]}for(;Ne<ki;++Ne)_e[Ne]=_e[Ne-Ri]}}se.l=Qe,se.p=Ua,se.b=Ne,se.f=We,Qe&&(We=1,se.m=pt,se.d=Be,se.n=dt)}while(!We);return Ne!=_e.length&&fe?function(ro,Xa,jo){return(Xa==null||Xa<0)&&(Xa=0),(jo==null||jo>ro.length)&&(jo=ro.length),new Vo(ro.subarray(Xa,jo))}(_e,0,Ne):_e.subarray(0,Ne)}(Y.subarray(q,-8),{i:2},new Vo(((W=Y)[(D=W.length)-4]|W[D-3]<<8|W[D-2]<<16|W[D-1]<<24)>>>0),void 0)));var W,D,Y,q;const K=Vx[w];if(!K)throw new Error(`Unhandled codec: ${w}`);const ee=new globalThis.DecompressionStream(K);return new Response(new Blob([C]).stream().pipeThrough(ee)).arrayBuffer().then(J=>new Uint8Array(J))}(x,y).then(C=>{const w=gn.read(new _d(C));if(w.values==="uint32_values")return w.uint32_values.readValuesInto(E),new qx[u](E.buffer);throw new Error(`Unhandled numeric data "${w.values}"`)}),S.then(C=>{for(let w=h.length-1;w>=0;w--)switch(h[w]){case"delta_filter":Nx(C,m);break;case"zigzag_filter":Wx(C);break;case"bitshuffle_filter":Mx(C,u);break;default:throw new Error(`Unhandled filter "${h[w]}"`)}return{layerName:o,blockIndex:p,data:C}}).catch(C=>{throw C})}))},mt(A1,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});const I1=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Vp{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[i,o]=new Uint8Array(e,0,2);if(i!==219)throw new Error("Data does not appear to be in a KDBush format.");const l=o>>4;if(l!==1)throw new Error(`Got v${l} data when expected v1.`);const r=I1[15&o];if(!r)throw new Error("Unrecognized array type.");const[u]=new Uint16Array(e,2,1),[m]=new Uint32Array(e,4,1);return new Vp(m,u,r,e)}constructor(e,i=64,o=Float64Array,l){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+i,2),65535),this.ArrayType=o,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const r=I1.indexOf(this.ArrayType),u=2*e*this.ArrayType.BYTES_PER_ELEMENT,m=e*this.IndexArrayType.BYTES_PER_ELEMENT,p=(8-m%8)%8;if(r<0)throw new Error(`Unexpected typed array class: ${o}.`);l&&l instanceof ArrayBuffer?(this.data=l,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+m+p,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+u+m+p),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+m+p,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+r]),new Uint16Array(this.data,2,1)[0]=i,new Uint32Array(this.data,4,1)[0]=e)}add(e,i){const o=this._pos>>1;return this.ids[o]=o,this.coords[this._pos++]=e,this.coords[this._pos++]=i,o}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return jp(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,i,o,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:u,nodeSize:m}=this,p=[0,r.length-1,0],h=[];for(;p.length;){const y=p.pop()||0,x=p.pop()||0,E=p.pop()||0;if(x-E<=m){for(let W=E;W<=x;W++){const D=u[2*W],Y=u[2*W+1];D>=e&&D<=o&&Y>=i&&Y<=l&&h.push(r[W])}continue}const S=E+x>>1,C=u[2*S],w=u[2*S+1];C>=e&&C<=o&&w>=i&&w<=l&&h.push(r[S]),(y===0?e<=C:i<=w)&&(p.push(E),p.push(S-1),p.push(1-y)),(y===0?o>=C:l>=w)&&(p.push(S+1),p.push(x),p.push(1-y))}return h}within(e,i,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:l,coords:r,nodeSize:u}=this,m=[0,l.length-1,0],p=[],h=o*o;for(;m.length;){const y=m.pop()||0,x=m.pop()||0,E=m.pop()||0;if(x-E<=u){for(let W=E;W<=x;W++)S1(r[2*W],r[2*W+1],e,i)<=h&&p.push(l[W]);continue}const S=E+x>>1,C=r[2*S],w=r[2*S+1];S1(C,w,e,i)<=h&&p.push(l[S]),(y===0?e-o<=C:i-o<=w)&&(m.push(E),m.push(S-1),m.push(1-y)),(y===0?e+o>=C:i+o>=w)&&(m.push(S+1),m.push(x),m.push(1-y))}return p}}function jp(t,e,i,o,l,r){if(l-o<=i)return;const u=o+l>>1;O1(t,e,u,o,l,r),jp(t,e,i,o,u-1,1-r),jp(t,e,i,u+1,l,1-r)}function O1(t,e,i,o,l,r){for(;l>o;){if(l-o>600){const h=l-o+1,y=i-o+1,x=Math.log(h),E=.5*Math.exp(2*x/3),S=.5*Math.sqrt(x*E*(h-E)/h)*(y-h/2<0?-1:1);O1(t,e,i,Math.max(o,Math.floor(i-y*E/h+S)),Math.min(l,Math.floor(i+(h-y)*E/h+S)),r)}const u=e[2*i+r];let m=o,p=l;for(Wu(t,e,o,i),e[2*l+r]>u&&Wu(t,e,o,l);m<p;){for(Wu(t,e,m,p),m++,p--;e[2*m+r]<u;)m++;for(;e[2*p+r]>u;)p--}e[2*o+r]===u?Wu(t,e,o,p):(p++,Wu(t,e,p,l)),p<=i&&(o=p+1),i<=p&&(l=p-1)}}function Wu(t,e,i,o){Kp(t,i,o),Kp(e,2*i,2*o),Kp(e,2*i+1,2*o+1)}function Kp(t,e,i){const o=t[e];t[e]=t[i],t[i]=o}function S1(t,e,i,o){const l=t-i,r=e-o;return l*l+r*r}s.$=w0,s.A=kr,s.B=R_,s.C=ri,s.D=ge,s.E=Ss,s.F=$i,s.G=Xe,s.H=class{constructor(t){this.specification=t}possiblyEvaluate(t,e){return en(t.expression.evaluate(e))}interpolate(t,e,i){return{x:si(t.x,e.x,i),y:si(t.y,e.y,i),z:si(t.z,e.z,i),azimuthal:si(t.azimuthal,e.azimuthal,i),polar:si(t.polar,e.polar,i)}}},s.I=xp,s.J=rn,s.K=qi,s.L=mi,s.M=class{constructor(t,e,i,o){this.id=t,this.position=e!=null?new ce(e[0],e[1]):new ce(0,0),this.orientation=i??[0,0,0],this.nodes=o,this.uploaded=!1,this.aabb=new ea([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(t,e){if(s.a6.multiply(t.matrix,e,t.matrix),t.meshes)for(const i of t.meshes){const o=ea.applyTransform(i.aabb,t.matrix);this.aabb.encapsulate(o)}if(t.children)for(const i of t.children)this._applyTransformations(i,t.matrix)}computeBoundsAndApplyParent(){const t=s.a6.identity([]);for(const e of this.nodes)this._applyTransformations(e,t)}computeModelMatrix(t,e,i,o,l,r,u=!1){$0(this.matrix,this,t.transform,this.position,e,i,o,l,r,u)}upload(t){if(!this.uploaded){for(const e of this.nodes)Wp(e,t);for(const e of this.nodes)wm(e);this.uploaded=!0}}destroy(){for(const t of this.nodes)Mp(t)}},s.O=Lo,s.P=qe,s.Q=Ul,s.R=eo,s.S=Qs,s.T=wp,s.U=si,s.V=st,s.W=ju,s.X=class{constructor(t){this.specification=t}possiblyEvaluate(t,e){return function([i,o]){const l=en([1,i,o]);return{x:l.x,y:l.y,z:l.z}}(t.expression.evaluate(e))}interpolate(t,e,i){return{x:si(t.x,e.x,i),y:si(t.y,e.y,i),z:si(t.z,e.z,i)}}},s.Y=function(t,e,i=0,o=!0){const l=new qe(i,i),r=t.sub(l),u=e.add(l),m=[r,new qe(u.x,r.y),u,new qe(r.x,u.y)];return o&&m.push(r.clone()),m},s.Z=Ml,s._=function(t,e){const i=[];for(let o=0;o<t.length;o++){const l=Na(o-1,-1,t.length-1),r=Na(o+1,-1,t.length-1),u=t[o],m=t[r],p=t[l].sub(u).unit(),h=m.sub(u).unit(),y=h.angleWithSep(p.x,p.y),x=p.add(h).unit().mult(-1*e/Math.sin(y/2));i.push(u.add(x))}return i},s.a=Md,s.a$=function(t){const e=[];for(const i in t)e.push(t[i]);return e},s.a0=Ph,s.a1=function(t,e,i=0){return s.N.fromValues(((e.x-i)*t.scale-t.x)*st,(e.y*t.scale-t.y)*st,Wi(e.z,e.y))},s.a2=Zf,s.a3=qy,s.a4=function(t){let e=1/0,i=1/0,o=-1/0,l=-1/0;for(const r of t)e=Math.min(e,r.x),i=Math.min(i,r.y),o=Math.max(o,r.x),l=Math.max(l,r.y);return{min:new qe(e,i),max:new qe(o,l)}},s.a5=jt,s.a8=un,s.a9=bi,s.aA=_c,s.aB=ia,s.aC=Es,s.aD=Oc,s.aE=Em,s.aF=function(){fo.isLoading()||fo.isLoaded()||Un()!=="deferred"||k_()},s.aG=po,s.aH=ya,s.aI=d1,s.aJ=Qn,s.aK=pp,s.aL=cp,s.aM=Sa,s.aN=ko,s.aO=eu,s.aP=Zg,s.aQ=tm,s.aR=Cp,s.aS=function(t,e){const i=Qs(e.zoom);if(i===0)return Kn(t);const o=qc(t),l=ep(o),r=jt(o.getWest())*e.worldSize,u=jt(o.getEast())*e.worldSize,m=Ft(o.getNorth())*e.worldSize,p=Ft(o.getSouth())*e.worldSize,h=[r,m,0],y=[u,m,0],x=[r,p,0],E=[u,p,0],S=s.a6.invert([],e.globeMatrix);return s.N.transformMat4(h,h,S),s.N.transformMat4(y,y,S),s.N.transformMat4(x,x,S),s.N.transformMat4(E,E,S),l[0]=Ts(l[0],x,i),l[1]=Ts(l[1],E,i),l[2]=Ts(l[2],y,i),l[3]=Ts(l[3],h,i),ea.fromPoints(l)},s.aT=Zc,s.aU=du,s.aV=Ts,s.aW=$a,s.aX=GT,s.aY=Xn,s.aZ=E1,s.a_=Le,s.aa=Vt,s.ab=V,s.ac=function(t,e){const i={};for(let o=0;o<e.length;o++){const l=e[o];l in t&&(i[l]=t[l])}return i},s.ad=Te,s.ae=Ft,s.af=class{constructor(t){this.entries={},this.scheduler=t}request(t,e,i,o){const l=this.entries[t]=this.entries[t]||{callbacks:[]};if(l.result){const[r,u]=l.result;return this.scheduler?this.scheduler.add(()=>{o(r,u)},e):o(r,u),()=>{}}return l.callbacks.push(o),l.cancel||(l.cancel=i((r,u)=>{l.result=[r,u];for(const m of l.callbacks)this.scheduler?this.scheduler.add(()=>{m(r,u)},e):m(r,u);setTimeout(()=>delete this.entries[t],3e3)})),()=>{l.result||(l.callbacks=l.callbacks.filter(r=>r!==o),l.callbacks.length||(l.cancel(),delete this.entries[t]))}}},s.ag=j_,s.ah=function(t,e,i){const o=JSON.stringify(t.request);return t.data&&(this.deduped.entries[o]={result:[null,t.data]}),this.deduped.request(o,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom},l=>{const r=Le(t.request,(u,m,p,h)=>{u?l(u):m&&l(null,{vectorTile:i?void 0:new mp(new _d(m)),rawData:m,cacheControl:p,expires:h})});return()=>{r.cancel(),l()}},e)},s.ai=function(t){Ai++,Ai>Tt&&(t.getActor().send("enforceCacheSizeLimit",Pe),Ai=0)},s.aj=pa,s.ak=Fe,s.al=function(t){return t<=1?1:Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},s.am=je,s.an=U0,s.ao=k0,s.ap=B0,s.aq=function(t,e){const i=document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(let o=0;o<t.length;o++){const l=document.createElement("source");Ve(t[o])||(i.crossOrigin="Anonymous"),l.src=t[o],i.appendChild(l)}return{cancel:()=>{}}},s.ar=Im,s.as=xu,s.at=kt,s.au=di,s.av=dn,s.aw=Ia,s.ax=ca,s.ay=Ii,s.az=fs,s.b=es,s.b$=xc,s.b0=function(t,e){const i=[];for(const o in t)o in e||i.push(o);return i},s.b1=No,s.b2=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.b3=function(t,e){const{x:i,y:o}=t.point,l=iy(i,o,t.worldSize/t._pixelsPerMercatorPixel,0,0);return s.a6.multiply(l,l,tp(Kn(e)))},s.b5=ld,s.b6=Go,s.b7=dm,s.b8=function(t,e,i,o,l){const r=5*e+2;t.float32[r+0]=i,t.float32[r+1]=o,t.float32[r+2]=l},s.b9=vm,s.bA=Rm,s.bB=z0,s.bC=function(t){const e=z0(t,!0);return s.b4.invert([],[e[0],e[1],e[4],e[5]])},s.bD=Xf,s.bE=function(t){const{x:e,y:i}=t.point,{lng:o,lat:l}=t._center;return iy(e,i,t.worldSize,o,l)},s.bF=na,s.bG=Z,s.bH=function(t){const e=Math.round((t+45+360)%360/90)%4;return ka[e]},s.bI=45,s.bJ=At,s.bK=_,s.bL=Yn,s.bM=zc,s.bN=Va,s.bO=Qr,s.bP=d,s.bQ=function(t,e,i){const o=Math.sqrt(t*t+e*e+i*i),l=o>0?Math.acos(i/o)*En:0;let r=t!==0||e!==0?Math.atan2(-e,-t)*En+90:0;return r<0&&(r+=360),[o,r,l]},s.bR=ii,s.bS=ea,s.bT=en,s.bU=function(t){return[Math.pow(t[0],1/2.2),Math.pow(t[1],1/2.2),Math.pow(t[2],1/2.2)]},s.bV=function(t){return t({pluginStatus:ao,pluginURL:Bn}),U_.on("pluginStateChange",t),t},s.bW=hd,s.bX=Pm,s.bY=cd,s.bZ=vp,s.b_=ua,s.ba=b0,s.bb=Xo,s.bc=Ya,s.bd=O0,s.be=Ap,s.bf=Tp,s.bg=Vp,s.bh=Na,s.bj=Ot,s.bk=Q,s.bl=zt,s.bm=function(t,e,i){t[4*e+0]=i[0],t[4*e+1]=i[1],t[4*e+2]=i[2],t[4*e+3]=i[3]},s.bn=ce,s.bo=M0,s.bp=$e,s.bq=Jf,s.br=H0,s.bs=ke,s.bt=Qg,s.bu=function(t,e,i,o,l,r,u,m,p){if(p.name==="globe")return Qg(t,e,new ke(i,o,l),!1);const h=xu({z:i,x:o,y:l},p);return new ea([(r+h.x/h.scale)*e,e*(h.y/h.scale),u],[(r+h.x2/h.scale)*e,e*(h.y2/h.scale),m])},s.bv=function(t,e,i){let o=0;for(let l=0;l<2;++l){const r=i?i[l]:0;t[l]>r&&(o+=(t[l]-r)*(t[l]-r)),e[l]<r&&(o+=(r-e[l])*(r-e[l]))}return o},s.bw=ei,s.bx=z,s.by=function(t){const e=s.a6.identity(new Float64Array(16));s.a6.multiply(e,t.pixelMatrix,t.globeMatrix);const i=[0,re,0],o=[0,ye,0];return s.N.transformMat4(i,i,e),s.N.transformMat4(o,o,e),[i[0]>0&&i[0]<=t.width&&i[1]>0&&i[1]<=t.height&&!ap(t,new ce(t.center.lat,90)),o[0]>0&&o[0]<=t.width&&o[1]>0&&o[1]<=t.height&&!ap(t,new ce(t.center.lat,-90))]},s.bz=function(t,e){const{scale:i}=t.tileTransform,o=i*st/(t.tileSize*Math.pow(2,e.zoom-t.tileID.overscaledZ+t.tileID.canonical.z));return s.b4.scale(new Float32Array(4),e.inverseAdjustmentMatrix,[o,o])},s.c=l1,s.c$=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},s.c0=Ce,s.c1=uo,s.c2=function(t,e,i){return t.type==="custom"?new Q3(t,e):new Px[t.type](t,e,i)},s.c3=function(t){const e=t.indexOf(jr);return e>=0?t.slice(0,e):t},s.c4=function(t){return t.indexOf(jr)>=0},s.c5=function(t){const e=t.indexOf(jr);return e>=0?t.slice(e+1):""},s.c6=function(t){const e=[],i=t.id;return i===void 0&&e.push({message:`layers.${i}: missing required property "id"`}),t.render===void 0&&e.push({message:`layers.${i}: missing required method "render"`}),t.renderingMode&&t.renderingMode!=="2d"&&t.renderingMode!=="3d"&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e},s.c7=bo,s.c8=U_,s.c9=Re,s.cA=Xy,s.cB=(t,e,i,o,l,r)=>{const u=t.transform;return{u_matrix:Zy(t,e,i,o),u_texsize:e.imageAtlasTexture?e.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:u.calculatePixelsToTileUnitsMatrix(e),u_device_pixel_ratio:l,u_image:0,u_tile_units_to_pixels:$y(e,u),u_units_to_pixels:[1/u.pixelsToGLUnits[0],1/u.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:r}},s.cC=(t,e,i,o,l,r,u)=>{const m=t.transform,p=m.calculatePixelsToTileUnitsMatrix(e);return{u_matrix:Zy(t,e,i,o),u_pixels_to_tile_units:p,u_device_pixel_ratio:r,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:l,u_texsize:Jy(i)&&e.lineAtlasTexture?e.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:$y(e,t.transform),u_alpha_discard_threshold:0,u_trim_offset:u,u_emissive_strength:i.paint.get("line-emissive-strength")}},s.cD=hl,s.cE=_u,s.cF=Hy,s.cG=ht,s.cH=rm,s.cI=il,s.cJ=450,s.cK=7,s.cL=Z3,s.cM=256,s.cN=tp,s.cO=Hn,s.cP=Q_,s.cQ=function(t,e,i,o,l){return Vt((t-e)/(i-e)*(l-o)+o,o,l)},s.cR=ti,s.cS=Lp,s.cT=[1,1,1],s.cU=nd,s.cV=pd,s.cW=$o,s.cX=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[]}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(t){const e=xy(new qe(0,0),new qe(st,st),t),i=[];for(const o of this._activeRegions){if(o.hiddenByOverlap||!Ty(e,o))continue;const l=w2(o.min,o.max,t);i.push({min:l.min,max:l.max,sourceId:this._sourceIds[o.priority],footprint:o.footprint,footprintTileId:o.tileId})}return i}setSources(t){this._setSources(t.map(e=>({getSourceId:()=>e.cache.id,getFootprints:()=>{const i=[];for(const o of e.cache.getVisibleCoordinates()){const l=e.cache.getTile(o).buckets[e.layer];if(l)for(const r of l.getNodesInfo()){const u=r.node;u.footprint&&i.push({footprint:u.footprint,id:o.toUnwrapped()})}}return i}})))}_addSource(t){const e=t.getFootprints();if(e.length!==0){for(const i of e){if(!i.footprint)continue;const o=xy(i.footprint.min,i.footprint.max,i.id);this._activeRegions.push({min:o.min,max:o.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:i.id,footprint:i.footprint})}this._sourceIds.push(t.getSourceId())}}_computeReplacement(){this._activeRegions.sort((e,i)=>e.priority-i.priority||nm(e.min,i.min)||nm(e.max,i.max));let t=this._activeRegions.length!==this._prevRegions.length;if(!t){let e=0,i=0;for(;!t&&e!==this._activeRegions.length;){const o=this._activeRegions[e],l=this._prevRegions[i];t=o.priority!==l.priority||!by(o,l),++e,++i}}if(t){++this._updateTime;const e=i=>{const o=this._activeRegions;if(i>=o.length)return i;const l=o[i].priority;for(;i<o.length&&o[i].priority===l;)++i;return i};if(this._sourceIds.length>1){let i=0,o=e(i);for(;i!==o;){let l=i;const r=i;for(;l!==o;){const u=this._activeRegions[l];u.hiddenByOverlap=!1;for(let m=0;m<r;m++){const p=this._activeRegions[m];if(!p.hiddenByOverlap&&Ty(u,p)&&(u.hiddenByOverlap=Ey(u.footprint,u.tileId,p.footprint,p.tileId),u.hiddenByOverlap))break}++l}i=o,o=e(i)}}}}_setSources(t){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let e=t.length-1;e>=0;e--)this._addSource(t[e]);this._computeReplacement()}},s.cY=class{constructor(t){this._createGrid(t),this._createPoles(t)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const t of this._poleSegments)t.destroy();for(const t of this._gridSegments)t.withSkirts.destroy(),t.withoutSkirts.destroy()}_fillGridMeshWithLods(t,e){const i=new ko,o=new Ia,l=[],r=t+1+2,u=e[0]+1,m=e[0]+1+(1+e.length),p=(h,y,x)=>{let E=h===r-1?h-2:h===0?h:h-1;return E+=x?24575:0,[E,y]};for(let h=0;h<r;++h)i.emplaceBack(...p(h,0,!0));for(let h=0;h<u;++h)for(let y=0;y<r;++y)i.emplaceBack(...p(y,h,(y===0||y===r-1)&&!0));for(let h=0;h<e.length;++h){const y=e[h];for(let x=0;x<r;++x)i.emplaceBack(...p(x,y,!0))}for(let h=0;h<e.length;++h){const y=o.length,x=e[h]+1+2,E=new Ia;for(let w=0;w<x-1;w++){const W=w===x-2,D=W?r*(m-e.length+h-w):r;for(let Y=0;Y<r-1;Y++){const q=w*r+Y;w===0||W||Y===0||Y===r-2?(E.emplaceBack(q+1,q,q+D),E.emplaceBack(q+D,q+D+1,q+1)):(o.emplaceBack(q+1,q,q+D),o.emplaceBack(q+D,q+D+1,q+1))}}const S=ia.simpleSegment(0,y,i.length,o.length-y);for(let w=0;w<E.uint16.length;w+=3)o.emplaceBack(E.uint16[w],E.uint16[w+1],E.uint16[w+2]);const C=ia.simpleSegment(0,y,i.length,o.length-y);l.push({withoutSkirts:S,withSkirts:C})}return{vertices:i,indices:o,segments:l}}_createGrid(t){const e=this._fillGridMeshWithLods(ie,ne);this._gridSegments=e.segments,this._gridBuffer=t.createVertexBuffer(e.vertices,Zg.members),this._gridIndexBuffer=t.createIndexBuffer(e.indices,!0)}_createPoles(t){const e=new Ia;for(let u=0;u<=ie;u++)e.emplaceBack(0,u+1,u+2);this._poleIndexBuffer=t.createIndexBuffer(e,!0);const i=new Hn,o=new Hn,l=new Hn,r=new Hn;this._poleSegments=[];for(let u=0,m=0;u<Z;u++){const p=360/(1<<u);i.emplaceBack(0,-V,0,.5,0),o.emplaceBack(0,-V,0,.5,1),l.emplaceBack(0,-V,0,.5,.5),r.emplaceBack(0,-V,0,.5,.5);for(let h=0;h<=ie;h++){let y=h/ie,x=0;const E=si(0,p,y),[S,C,w]=ue(KT,qT,E,V);i.emplaceBack(S,C,w,y,x),o.emplaceBack(S,C,w,y,1-x);const W=Ot(E);y=.5+.5*Math.sin(W),x=.5+.5*Math.cos(W),l.emplaceBack(S,C,w,y,x),r.emplaceBack(S,C,w,y,1-x)}this._poleSegments.push(ia.simpleSegment(m,0,66,64)),m+=66}this._poleNorthVertexBuffer=t.createVertexBuffer(i,jc,!1),this._poleSouthVertexBuffer=t.createVertexBuffer(o,jc,!1),this._texturedPoleNorthVertexBuffer=t.createVertexBuffer(l,jc,!1),this._texturedPoleSouthVertexBuffer=t.createVertexBuffer(r,jc,!1)}getGridBuffers(t,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[t].withSkirts:this._gridSegments[t].withoutSkirts]}getPoleBuffers(t,e){return[e?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,e?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[t]]}},s.cZ=function(t){return In.has(t)},s.c_=Qa,s.ca=a,s.cb=class extends _n{constructor(t){super(t),this.current=c}set(t,e,i){if(this.fetchUniformLocation(t,e)){for(let o=0;o<9;o++)if(i[o]!==this.current[o]){this.current=i,this.gl.uniformMatrix3fv(this.location,!1,i);break}}}},s.cc=ot,s.cd=function(t,e,i){const o=Qs(i.zoom),l=t.style.map._antialias,r=e.options.extStandardDerivativesForceOff||t.terrain&&t.terrain.exaggeration()>0;return o===0&&!l&&!r},s.ce=function(t){const e=t.pixelsPerMeter,i=e/zt(1,t.center.lat),o=s.a6.identity(new Float64Array(16));return s.a6.translate(o,o,[t.point.x,t.point.y,0]),s.a6.scale(o,o,[i,i,e]),Float32Array.from(o)},s.cf=qc,s.cg=function(t){const e=ei-5;t=Vt(t,-e,e)/e*90;const i=Math.pow(Math.abs(Math.sin(Ot(t))),3);return Math.round(i*(ne.length-1))},s.ch=function(t,e,i,o){const l=e.getNorth(),r=e.getSouth(),u=e.getWest(),m=e.getEast(),p=1<<t.z,h=m-u,y=l-r,x=h/ie,E=-y/ne[i],S=[0,x,0,E,0,0,l,u,0];if(t.z>0){const C=180/o;s.co.multiply(S,S,[C/h+1,0,0,0,C/y+1,0,-.5*C/x,.5*C/E,1])}return S[2]=p,S[5]=t.x,S[8]=t.y,S},s.ci=Kn,s.cj=function(t,e,i){const o=s.a6.identity(new Float64Array(16)),l=(e/(1<<t)-.5)*Math.PI*2;return s.a6.rotateY(o,i.globeMatrix,l),Float32Array.from(o)},s.ck=class{isDataAvailableAtPoint(t){const e=this._source();if(this.isUsingMockSource()||!e||t.y<0||t.y>1)return!1;const i=e.getSource().maxzoom,o=1<<i,l=Math.floor(t.x),r=Math.floor((t.x-l)*o),u=Math.floor(t.y*o),m=this.findDEMTileFor(new je(i,l,i,r,u));return!(!m||!m.dem)}getAtPointOrZero(t,e=0){return this.getAtPoint(t,e)||0}getAtPoint(t,e,i=!0){if(this.isUsingMockSource())return null;e==null&&(e=null);const o=this._source();if(!o||t.y<0||t.y>1)return e;const l=o.getSource().maxzoom,r=1<<l,u=Math.floor(t.x),m=t.x-u,p=new je(l,u,l,Math.floor(m*r),Math.floor(t.y*r)),h=this.findDEMTileFor(p);if(!h||!h.dem)return e;const y=h.dem,x=1<<h.tileID.canonical.z,E=(m*x-h.tileID.canonical.x)*y.dim,S=(t.y*x-h.tileID.canonical.y)*y.dim,C=Math.floor(E),w=Math.floor(S);return(i?this.exaggeration():1)*si(si(y.get(C,w),y.get(C,w+1),S-w),si(y.get(C+1,w),y.get(C+1,w+1),S-w),E-C)}getAtTileOffset(t,e,i){const o=1<<t.canonical.z;return this.getAtPointOrZero(new mi(t.wrap+(t.canonical.x+e/st)/o,(t.canonical.y+i/st)/o))}getAtTileOffsetFunc(t,e,i,o){return l=>{const r=this.getAtTileOffset(t,l.x,l.y),u=o.upVector(t.canonical,l.x,l.y),m=o.upVectorScale(t.canonical,e,i).metersToTile;return s.N.scale(u,u,r*m),u}}getForTilePoints(t,e,i,o){if(this.isUsingMockSource())return!1;const l=nd.create(this,t,o);return!!l&&(e.forEach(r=>{r[2]=this.exaggeration()*l.getElevationAt(r[0],r[1],i)}),!0)}getMinMaxForTile(t){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(t);if(!e||!e.dem)return null;const i=e.dem.tree,o=e.tileID,l=1<<t.canonical.z-o.canonical.z;let r=t.canonical.x/l-o.canonical.x,u=t.canonical.y/l-o.canonical.y,m=0;for(let p=0;p<t.canonical.z-o.canonical.z&&!i.leaves[m];p++){r*=2,u*=2;const h=2*Math.floor(u)+Math.floor(r);m=i.childOffsets[m]+h,r%=1,u%=1}return{min:this.exaggeration()*i.minimums[m],max:this.exaggeration()*i.maximums[m]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,e,i){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const t=this.visibleDemTiles;if(t.length===0)return null;let e=!1,i=Number.MAX_VALUE,o=Number.MIN_VALUE;for(const l of t){const r=this.getMinMaxForTile(l.tileID);r&&(i=Math.min(i,r.min),o=Math.max(o,r.max),e=!0)}return e?{min:i,max:o}:null}},s.cl=Kc,s.cm=uy,s.cn=function(t,e){return[Math.pow(t[0],2.2)*e,Math.pow(t[1],2.2)*e,Math.pow(t[2],2.2)*e]},s.cp=ty,s.cq=256,s.cr=function(t,e){const i=[0,0,0],o=Zc(Kn(e.canonical));return s.N.transformMat4(i,i,o),s.N.transformMat4(i,i,t),i},s.cs=t=>({u_camera_to_center_distance:new Va(t),u_extrude_scale:new g(t),u_device_pixel_ratio:new Va(t),u_matrix:new _(t),u_inv_rot_matrix:new _(t),u_merc_center:new Yn(t),u_tile_id:new zc(t),u_zoom_transition:new Va(t),u_up_dir:new zc(t),u_emissive_strength:new Va(t)}),s.ct=t=>({u_matrix:new _(t),u_pixels_to_tile_units:new g(t),u_device_pixel_ratio:new Va(t),u_units_to_pixels:new Yn(t),u_dash_image:new Qr(t),u_gradient_image:new Qr(t),u_image_height:new Va(t),u_texsize:new Yn(t),u_tile_units_to_pixels:new Va(t),u_alpha_discard_threshold:new Va(t),u_trim_offset:new Yn(t),u_emissive_strength:new Va(t)}),s.cu=t=>({u_matrix:new _(t),u_texsize:new Yn(t),u_pixels_to_tile_units:new g(t),u_device_pixel_ratio:new Va(t),u_image:new Qr(t),u_units_to_pixels:new Yn(t),u_tile_units_to_pixels:new Va(t),u_alpha_discard_threshold:new Va(t),u_trim_offset:new Yn(t)}),s.cv=$r,s.cw=n3,s.cx=s3,s.cy=ny,s.cz=(t,e,i,o,l,r)=>{const u=t.transform,m=u.projection.name==="globe";let p;if(r.paint.get("circle-pitch-alignment")==="map")if(m){const y=ty(u.zoom,e.canonical)*u._pixelsPerMercatorPixel;p=Float32Array.from([y,0,0,y])}else p=u.calculatePixelsToTileUnitsMatrix(i);else p=new Float32Array([u.pixelsToGLUnits[0],0,0,u.pixelsToGLUnits[1]]);const h={u_camera_to_center_distance:t.transform.getCameraToCenterDistance(u.projection),u_matrix:t.translatePosMatrix(e.projMatrix,i,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Ge.devicePixelRatio,u_extrude_scale:p,u_inv_rot_matrix:$T,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:r.paint.get("circle-emissive-strength")};if(m){h.u_inv_rot_matrix=o,h.u_merc_center=l,h.u_tile_id=[e.canonical.x,e.canonical.y,1<<e.canonical.z],h.u_zoom_transition=Qs(u.zoom);const y=l[0]*st,x=l[1]*st;h.u_up_dir=u.projection.upVector(new ke(0,0,0),y,x)}return h},s.d=nt,s.d0=Ea,s.d1=fi,s.d2=Ie,s.d3=function([t,e,i]){const o=Math.hypot(t,e,i),l=Math.atan2(t,i),r=.5*Math.PI-Math.acos(-e/o);return new ce(na(l),na(r))},s.d4=Ee,s.d5=ve,s.d6=ap,s.d7=ay,s.d8=function(t){const e=[0,0,0],i=s.a6.identity(new Float64Array(16));return s.a6.multiply(i,t.pixelMatrix,t.globeMatrix),s.N.transformMat4(e,e,i),new qe(e[0],e[1])},s.d9=function(t){const e=t.navigator?t.navigator.userAgent:null;return!!function(i){if(Me==null){const o=i.navigator?i.navigator.userAgent:null;Me=!!i.safari||!(!o||!(/\b(iPad|iPhone|iPod)\b/.test(o)||o.match("Safari")&&!o.match("Chrome")))}return Me}(t)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},s.dA=pn,s.dB=r1,s.dC=_1,s.dD=jy,s.dE=Ha,s.dF=x0,s.dG=function(t,e,i,o,l,r,u,m,p,h,y){t.createArrays(),t.tilePixelRatio=st/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;const x=t.layers[0].layout,E=t.layers[0]._unevaluatedLayout._values,S={};if(t.textSizeData.kind==="composite"){const{minZoom:D,maxZoom:Y}=t.textSizeData;S.compositeTextSizes=[E["text-size"].possiblyEvaluate(new qi(D),m),E["text-size"].possiblyEvaluate(new qi(Y),m)]}if(t.iconSizeData.kind==="composite"){const{minZoom:D,maxZoom:Y}=t.iconSizeData;S.compositeIconSizes=[E["icon-size"].possiblyEvaluate(new qi(D),m),E["icon-size"].possiblyEvaluate(new qi(Y),m)]}S.layoutTextSize=E["text-size"].possiblyEvaluate(new qi(p+1),m),S.layoutIconSize=E["icon-size"].possiblyEvaluate(new qi(p+1),m),S.textMaxSize=E["text-size"].possiblyEvaluate(new qi(18),m);const C=x.get("text-rotation-alignment")==="map"&&x.get("symbol-placement")!=="point",w=x.get("text-size");let W=!1;for(const D of t.features)if(D.icon&&D.icon.nameSecondary){W=!0;break}for(const D of t.features){const Y=x.get("text-font").evaluate(D,{},m).join(","),q=w.evaluate(D,{},m),K=S.layoutTextSize.evaluate(D,{},m),ee=(S.layoutIconSize.evaluate(D,{},m),{horizontal:{},vertical:void 0}),J=D.text;let se,_e=[0,0];if(J){const fe=J.toString(),Se=x.get("text-letter-spacing").evaluate(D,{},m)*Ya,De=x.get("text-line-height").evaluate(D,{},m)*Ya,Ae=Sf(fe)?Se:0,We=x.get("text-anchor").evaluate(D,{},m),xe=x.get("text-variable-anchor");if(!xe){const dt=x.get("text-radial-offset").evaluate(D,{},m);_e=dt?O0(We,[dt*Ya,Ep]):x.get("text-offset").evaluate(D,{},m).map(ze=>ze*Ya)}let Ne=C?"center":x.get("text-justify").evaluate(D,{},m);const Qe=x.get("symbol-placement")==="point",Be=Qe?x.get("text-max-width").evaluate(D,{},m)*Ya:1/0,pt=dt=>{t.allowVerticalPlacement&&Fn(fe)&&(ee.vertical=bp(J,e,i,l,Y,Be,De,We,dt,Ae,_e,Go.vertical,!0,K,q))};if(!C&&xe){const dt=Ne==="auto"?xe.map(Lt=>Ap(Lt)):[Ne];let ze=!1;for(let Lt=0;Lt<dt.length;Lt++){const Et=dt[Lt];if(!ee.horizontal[Et])if(ze)ee.horizontal[Et]=ee.horizontal[0];else{const ft=bp(J,e,i,l,Y,Be,De,"center",Et,Ae,_e,Go.horizontal,!1,K,q);ft&&(ee.horizontal[Et]=ft,ze=ft.positionedLines.length===1)}}pt("left")}else{if(Ne==="auto"&&(Ne=Ap(We)),Qe||x.get("text-writing-mode").indexOf("horizontal")>=0||!Fn(fe)){const dt=bp(J,e,i,l,Y,Be,De,We,Ne,Ae,_e,Go.horizontal,!1,K,q);dt&&(ee.horizontal[Ne]=dt)}pt(Qe?"left":Ne)}}let me=!1;if(D.icon&&D.icon.namePrimary){const fe=o[D.icon.namePrimary];fe&&(se=I3(l[D.icon.namePrimary],D.icon.nameSecondary?l[D.icon.nameSecondary]:void 0,x.get("icon-offset").evaluate(D,{},m),x.get("icon-anchor").evaluate(D,{},m)),me=fe.sdf,t.sdfIcons===void 0?t.sdfIcons=fe.sdf:t.sdfIcons!==fe.sdf&&ta("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(fe.pixelRatio!==t.pixelRatio||x.get("icon-rotate").constantOr(1)!==0)&&(t.iconsNeedLinear=!0))}const be=R0(ee.horizontal)||ee.vertical;t.iconsInText||(t.iconsInText=!!be&&be.iconsInText),(be||se)&&L3(t,D,ee,se,o,S,K,0,_e,me,u,m,h,y,W)}r&&t.generateCollisionDebugBuffers(p,t.collisionBoxArray)},s.dH=mp,s.dI=_d,s.dJ=sm,s.dK=bt,s.dL=am,s.dM=im,s.dN=Oi,s.dO=i0,s.dP=function(t){let e=0;if(new Uint32Array(t,0,1)[0]!==e1){const i=new Uint32Array(t,0,7),[,,o,l,r,u]=i;e=i.byteLength+l+r+u+r,(o!==t.byteLength||e>=t.byteLength)&&ta("Invalid b3dm header information.")}return o1(t,e)},s.dQ=function(t,e){const i=l1(t);for(const o of i){for(const l of o.meshes)Ix(l);o.lights&&(o.lightMeshIndex=o.meshes.length,o.meshes.push(Ox(o.lights,e)))}return i},s.dR=Mm,s.dS=Z0,s.dT=fo,s.dU=function(t){Ci(),ct&&ct.then(e=>{e.keys().then(i=>{for(let o=0;o<i.length-t;o++)e.delete(i[o])})})},s.da=class{constructor(t,e,i){this._transformRequestFn=t,this._customAccessToken=e,this._silenceAuthErrors=!!i,this._createSkuToken()}_createSkuToken(){const t=function(){let e="";for(let i=0;i<10;i++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Je,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeStyleURL(t,e){if(!Ce(t))return t;const i=Dt(t);return i.params.push(`sdk=js-${oe}`),i.path=`/styles/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeGlyphsURL(t,e){if(!Ce(t))return t;const i=Dt(t);return i.path=`/fonts/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeModelURL(t,e){if(!Ce(t))return t;const i=Dt(t);return i.path=`/models/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeSourceURL(t,e,i,o){if(!Ce(t))return t;const l=Dt(t);return l.path=`/v4/${l.authority}.json`,l.params.push("secure"),i&&l.params.push(`language=${i}`),o&&l.params.push(`worldview=${o}`),this._makeAPIURL(l,this._customAccessToken||e)}normalizeSpriteURL(t,e,i,o){const l=Dt(t);return Ce(t)?(l.path=`/styles/v1${l.path}/sprite${e}${i}`,this._makeAPIURL(l,this._customAccessToken||o)):(l.path+=`${e}${i}`,ni(l))}normalizeTileURL(t,e,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!Ce(t))return t;const o=Dt(t);o.path=o.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||i&&o.authority!=="raster"&&i===512?"@2x":""}${Ti.supported?".webp":"$1"}`),o.authority==="raster"?o.path=`/${ve.RASTER_URL_PREFIX}${o.path}`:o.authority==="rasterarrays"?o.path=`/${ve.RASTERARRAYS_URL_PREFIX}${o.path}`:(o.path=o.path.replace(/^.+\/v4\//,"/"),o.path=`/${ve.TILE_URL_VERSION}${o.path}`);const l=this._customAccessToken||function(r){for(const u of r){const m=u.match(/^access_token=(.*)$/);if(m)return m[1]}return null}(o.params)||ve.ACCESS_TOKEN;return ve.REQUIRE_ACCESS_TOKEN&&l&&this._skuToken&&o.params.push(`sku=${this._skuToken}`),this._makeAPIURL(o,l)}canonicalizeTileURL(t,e){const i=Dt(t);if(!i.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!i.path.match(/\.[\w]+$/))return t;let o="mapbox://";i.path.match(/^\/raster\/v1\//)?o+=`raster/${i.path.replace(`/${ve.RASTER_URL_PREFIX}/`,"")}`:i.path.match(/^\/rasterarrays\/v1\//)?o+=`rasterarrays/${i.path.replace(`/${ve.RASTERARRAYS_URL_PREFIX}/`,"")}`:o+=`tiles/${i.path.replace(`/${ve.TILE_URL_VERSION}/`,"")}`;let l=i.params;return e&&(l=l.filter(r=>!r.match(/^access_token=/))),l.length&&(o+=`?${l.join("&")}`),o}canonicalizeTileset(t,e){const i=!!e&&Ce(e),o=[];for(const l of t.tiles||[])Ye(l)?o.push(this.canonicalizeTileURL(l,i)):o.push(l);return o}_makeAPIURL(t,e){const i="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",o=Dt(ve.API_URL);if(t.protocol=o.protocol,t.authority=o.authority,t.protocol==="http"){const l=t.params.indexOf("secure");l>=0&&t.params.splice(l,1)}if(o.path!=="/"&&(t.path=`${o.path}${t.path}`),!ve.REQUIRE_ACCESS_TOKEN)return ni(t);if(e=e||ve.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${i}`);if(e[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${i}`)}return t.params=t.params.filter(l=>l.indexOf("access_token")===-1),t.params.push(`access_token=${e||""}`),ni(t)}},s.db=function(t,e){e?In.add(t):In.delete(t)},s.dc=Ti,s.dd=Wo,s.de=yl,s.df=rt,s.dg=yi,s.dh=function(t){In.delete(t)},s.di=Ma,s.dj=Wa,s.dk=oe,s.dl=function(t,e){Pe=t,Tt=e},s.dm=function(t,e,i=!1){if(ao===W_||ao===M_||ao===D_)throw new Error("setRTLTextPlugin cannot be called multiple times.");Bn=Ge.resolveURL(t),ao=W_,F_=e,B_(),i||k_()},s.dn=Un,s.dp=function(){Pm().acquire(Dp)},s.dq=function(){const t=Cu;t&&(t.isPreloaded()&&t.numActive()===1?(t.release(Dp),Cu=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},s.dr=Ru,s.ds=function(t){const e=Xt();if(!e)return;const i=e.delete(gt);t&&i.catch(t).then(()=>t())},s.dt=Su,s.du=X0,s.dv=function(t){Fp=Ge.resolveURL(t),yd||(yd=new hd(Pm(),new Ss)),yd.broadcast("setDracoUrl",Fp)},s.dw=J0,s.dx=function(t){gd=Ge.resolveURL(t),yd||(yd=new hd(Pm(),new Ss)),yd.broadcast("setMeshoptUrl",gd)},s.dy=mt,s.dz=el,s.e=za,s.f=Ge,s.g=function(t,e){return Re(za(t,{type:"json"}),e)},s.h=Yo,s.i=Ns,s.j=Bd,s.k=Ur,s.l=function(t){return fetch(t).then(e=>e.arrayBuffer()).then(e=>o1(e,0,t))},s.m=mc,s.n=Wl,s.o=zl,s.p=T0,s.q=Yr,s.r=Hr,s.s=C_,s.t=Rl,s.u=kl,s.v=Fa,s.w=ta,s.x=Bs,s.z=Y_}),te(["./shared"],function(s){function oe(Me){const j=Me?Me.url.toString():void 0;return j?performance.getEntriesByName(j):[]}function he(Me){if(typeof Me=="number"||typeof Me=="boolean"||typeof Me=="string"||Me==null)return JSON.stringify(Me);if(Array.isArray(Me)){let Q="[";for(const de of Me)Q+=`${he(de)},`;return`${Q}]`}let j="{";for(const Q of Object.keys(Me).sort())j+=`${Q}:${he(Me[Q])},`;return`${j}}`}function ve(Me){let j="";for(const Q of s.b2)j+=`/${he(Me[Q])}`;return j}class Ye{constructor(j){this.keyCache={},this._layers={},this._layerConfigs={},j&&this.replace(j)}replace(j,Q){this._layerConfigs={},this._layers={},this.update(j,[],Q)}update(j,Q,de){this._options=de;for(const Fe of j)this._layerConfigs[Fe.id]=Fe,(this._layers[Fe.id]=s.c2(Fe,this.scope,this._options)).compileFilter(),this.keyCache[Fe.id]&&delete this.keyCache[Fe.id];for(const Fe of Q)delete this.keyCache[Fe],delete this._layerConfigs[Fe],delete this._layers[Fe];this.familiesBySource={};const we=function(Fe,Ge){const gt={};for(let Tt=0;Tt<Fe.length;Tt++){const ct=Ge&&Ge[Fe[Tt].id]||ve(Fe[Tt]);Ge&&(Ge[Fe[Tt].id]=ct);let vt=gt[ct];vt||(vt=gt[ct]=[]),vt.push(Fe[Tt])}const Pe=[];for(const Tt in gt)Pe.push(gt[Tt]);return Pe}(s.a$(this._layerConfigs),this.keyCache);for(const Fe of we){const Ge=Fe.map(Xt=>this._layers[Xt.id]),gt=Ge[0];if(gt.visibility==="none")continue;const Pe=gt.source||"";let Tt=this.familiesBySource[Pe];Tt||(Tt=this.familiesBySource[Pe]={});const ct=gt.sourceLayer||"_geojsonTileLayer";let vt=Tt[ct];vt||(vt=Tt[ct]=[]),vt.push(Ge)}}}const Ce=1*s.dA;class lt{constructor(j){const Q={},de=[];for(const gt in j){const Pe=j[gt],Tt=Q[gt]={};for(const ct in Pe.glyphs){const vt=Pe.glyphs[+ct];if(!vt||vt.bitmap.width===0||vt.bitmap.height===0)continue;const Xt=vt.metrics.localGlyph?Ce:1,Ci={x:0,y:0,w:vt.bitmap.width+2*Xt,h:vt.bitmap.height+2*Xt};de.push(Ci),Tt[ct]=Ci}}const{w:we,h:Fe}=s.p(de),Ge=new s.dz({width:we||1,height:Fe||1});for(const gt in j){const Pe=j[gt];for(const Tt in Pe.glyphs){const ct=Pe.glyphs[+Tt];if(!ct||ct.bitmap.width===0||ct.bitmap.height===0)continue;const vt=Q[gt][Tt],Xt=ct.metrics.localGlyph?Ce:1;s.dz.copy(ct.bitmap,Ge,{x:0,y:0},{x:vt.x+Xt,y:vt.y+Xt},ct.bitmap)}}this.image=Ge,this.positions=Q}}s.dy(lt,"GlyphAtlas");class Ke{constructor(j){this.tileID=new s.am(j.tileID.overscaledZ,j.tileID.wrap,j.tileID.canonical.z,j.tileID.canonical.x,j.tileID.canonical.y),this.tileZoom=j.tileZoom,this.uid=j.uid,this.zoom=j.zoom,this.canonical=j.tileID.canonical,this.pixelRatio=j.pixelRatio,this.tileSize=j.tileSize,this.source=j.source,this.scope=j.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=j.showCollisionBoxes,this.collectResourceTiming=!!j.collectResourceTiming,this.promoteId=j.promoteId,this.isSymbolTile=j.isSymbolTile,this.tileTransform=s.as(j.tileID.canonical,j.projection),this.projection=j.projection,this.brightness=j.brightness,this.extraShadowCaster=!!j.extraShadowCaster}parse(j,Q,de,we,Fe){this.status="parsing",this.data=j,this.collisionBoxArray=new s.aD;const Ge=new s.dB(Object.keys(j.layers).sort()),gt=new s.dC(this.tileID,this.promoteId);gt.bucketLayerIDs=[];const Pe={},Tt=new s.dD(256,256),ct={featureIndex:gt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:Tt,availableImages:de,brightness:this.brightness},vt=Q.familiesBySource[this.source];for(const Si in vt){const Bi=j.layers[Si];if(!Bi)continue;let Aa=!1,zi=!1,Ka=!1;for(const fa of vt[Si])fa[0].type==="symbol"?Aa=!0:zi=!0,fa[0].is3D()&&fa[0].type!=="model"&&(Ka=!0);if(this.extraShadowCaster&&!Ka||this.isSymbolTile===!0&&!Aa||this.isSymbolTile===!1&&!zi)continue;Bi.version===1&&s.w(`Vector tile source "${this.source}" layer "${Si}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ga=Ge.encode(Si),eo=[];for(let fa=0;fa<Bi.length;fa++){const ua=Bi.feature(fa),Re=gt.getId(ua,Si);eo.push({feature:ua,id:Re,index:fa,sourceLayerIndex:Ga})}for(const fa of vt[Si]){const ua=fa[0];(!this.extraShadowCaster||ua.is3D()&&ua.type!=="model")&&(this.isSymbolTile!==void 0&&ua.type==="symbol"!==this.isSymbolTile||ua.minzoom&&this.zoom<Math.floor(ua.minzoom)||ua.maxzoom&&this.zoom>=ua.maxzoom||ua.visibility!=="none"&&(Nt(fa,this.zoom,ct.brightness,de),(Pe[ua.id]=ua.createBucket({index:gt.bucketLayerIDs.length,layers:fa,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ga,sourceID:this.source,projection:this.projection.spec})).populate(eo,ct,this.tileID.canonical,this.tileTransform),gt.bucketLayerIDs.push(fa.map(Re=>Re.id))))}}let Xt,Ci,Hi,wi;Tt.trim();const Ai={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Ti=()=>{if(Xt)return this.status="done",Fe(Xt);if(this.extraShadowCaster)this.status="done",Fe(null,{buckets:s.a$(Pe).filter(Si=>!Si.isEmpty()),featureIndex:gt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:ct.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Ci&&Hi&&wi){const Si=new lt(Ci),Bi=new s.dF(Hi,wi);for(const Aa in Pe){const zi=Pe[Aa];zi instanceof s.aE?(Nt(zi.layers,this.zoom,ct.brightness,de),s.dG(zi,Ci,Si.positions,Hi,Bi.iconPositions,this.showCollisionBoxes,de,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):zi.hasPattern&&(zi instanceof s.aK||zi instanceof s.aL||zi instanceof s.cH)&&(Nt(zi.layers,this.zoom,ct.brightness,de),zi.addFeatures(ct,this.tileID.canonical,Bi.patternPositions,de,this.tileTransform,this.brightness))}this.status="done",Fe(null,{buckets:s.a$(Pe).filter(Aa=>!Aa.isEmpty()),featureIndex:gt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Si.image,lineAtlas:Tt,imageAtlas:Bi,brightness:ct.brightness})}};if(!this.extraShadowCaster){const Si=s.dE(ct.glyphDependencies,zi=>Object.keys(zi).map(Number));Object.keys(Si).length?we.send("getGlyphs",{uid:this.uid,stacks:Si,scope:this.scope},(zi,Ka)=>{Xt||(Xt=zi,Ci=Ka,Ti())},void 0,!1,Ai):Ci={};const Bi=Object.keys(ct.iconDependencies);Bi.length?we.send("getImages",{icons:Bi,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(zi,Ka)=>{Xt||(Xt=zi,Hi=Ka,Ti())},void 0,!1,Ai):Hi={};const Aa=Object.keys(ct.patternDependencies);Aa.length?we.send("getImages",{icons:Aa,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(zi,Ka)=>{Xt||(Xt=zi,wi=Ka,Ti())},void 0,!1,Ai):wi={}}Ti()}}function Nt(Me,j,Q,de){const we=new s.K(j,{brightness:Q});for(const Fe of Me)Fe.recalculate(we,de)}class Oe extends s.E{constructor(j,Q,de,we,Fe,Ge){super(),this.actor=j,this.layerIndex=Q,this.availableImages=de,this.loadVectorData=Fe||s.ah,this.loading={},this.loaded={},this.deduped=new s.af(j.scheduler),this.isSpriteLoaded=we,this.scheduler=j.scheduler,this.brightness=Ge}loadTile(j,Q){const de=j.uid,we=j&&j.request,Fe=we&&we.collectResourceTiming,Ge=this.loading[de]=new Ke(j);Ge.abort=this.loadVectorData(j,(gt,Pe)=>{const Tt=!this.loading[de];if(delete this.loading[de],Tt||gt||!Pe)return Ge.status="done",Tt||(this.loaded[de]=Ge),Q(gt);const ct=Pe.rawData,vt={};Pe.expires&&(vt.expires=Pe.expires),Pe.cacheControl&&(vt.cacheControl=Pe.cacheControl),Ge.vectorTile=Pe.vectorTile||new s.dH(new s.dI(ct));const Xt=()=>{Ge.parse(Ge.vectorTile,this.layerIndex,this.availableImages,this.actor,(Ci,Hi)=>{if(Ci||!Hi)return Q(Ci);const wi={};if(Fe){const Ai=oe(we);Ai.length>0&&(wi.resourceTiming=JSON.parse(JSON.stringify(Ai)))}Q(null,s.e({rawTileData:ct.slice(0)},Hi,vt,wi))})};this.isSpriteLoaded?Xt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Xt,{type:"parseTile",isSymbolTile:j.isSymbolTile,zoom:j.tileZoom}):Xt()}),this.loaded=this.loaded||{},this.loaded[de]=Ge})}reloadTile(j,Q){const de=this.loaded,we=j.uid,Fe=this;if(de&&de[we]){const Ge=de[we];Ge.showCollisionBoxes=j.showCollisionBoxes,Ge.projection=j.projection,Ge.brightness=j.brightness,Ge.tileTransform=s.as(j.tileID.canonical,j.projection),Ge.extraShadowCaster=j.extraShadowCaster;const gt=(Pe,Tt)=>{const ct=Ge.reloadCallback;ct&&(delete Ge.reloadCallback,Ge.parse(Ge.vectorTile,Fe.layerIndex,this.availableImages,Fe.actor,ct)),Q(Pe,Tt)};Ge.status==="parsing"?Ge.reloadCallback=gt:Ge.status==="done"&&(Ge.vectorTile?Ge.parse(Ge.vectorTile,this.layerIndex,this.availableImages,this.actor,gt):gt())}else Q(null,void 0)}abortTile(j,Q){const de=j.uid,we=this.loading[de];we&&(we.abort&&we.abort(),delete this.loading[de]),Q()}removeTile(j,Q){const de=this.loaded,we=j.uid;de&&de[we]&&delete de[we],Q()}}class ut{loadTile(j,Q){const{uid:de,encoding:we,rawImageData:Fe,padding:Ge}=j,gt=ImageBitmap&&Fe instanceof ImageBitmap?this.getImageData(Fe,Ge):Fe;Q(null,new s.dJ(de,gt,we,Ge<1))}getImageData(j,Q){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(j.width,j.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=j.width,this.offscreenCanvas.height=j.height,this.offscreenCanvasContext.drawImage(j,0,0,j.width,j.height);const de=this.offscreenCanvasContext.getImageData(-Q,-Q,j.width+2*Q,j.height+2*Q);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),de}}class bt{decodeRasterArray({task:j,buffer:Q},de){s.aZ.performDecoding(Q,j).then(we=>{de(null,we)},we=>{de(we)})}}function Mt(Me,j){if(Me.length!==0){Fi(Me[0],j);for(var Q=1;Q<Me.length;Q++)Fi(Me[Q],!j)}}function Fi(Me,j){for(var Q=0,de=0,we=0,Fe=Me.length,Ge=Fe-1;we<Fe;Ge=we++){var gt=(Me[we][0]-Me[Ge][0])*(Me[Ge][1]+Me[we][1]),Pe=Q+gt;de+=Math.abs(Q)>=Math.abs(gt)?Q-Pe+gt:gt-Pe+Q,Q=Pe}Q+de>=0!=!!j&&Me.reverse()}var ai=s.dK(function Me(j,Q){var de,we=j&&j.type;if(we==="FeatureCollection")for(de=0;de<j.features.length;de++)Me(j.features[de],Q);else if(we==="GeometryCollection")for(de=0;de<j.geometries.length;de++)Me(j.geometries[de],Q);else if(we==="Feature")Me(j.geometry,Q);else if(we==="Polygon")Mt(j.coordinates,Q);else if(we==="MultiPolygon")for(de=0;de<j.coordinates.length;de++)Mt(j.coordinates[de],Q);return j});const Oi=s.dL.prototype.toGeoJSON;let va=class{constructor(Me){this._feature=Me,this.extent=s.V,this.type=Me.type,this.properties=Me.tags,"id"in Me&&!isNaN(Me.id)&&(this.id=parseInt(Me.id,10))}loadGeometry(){if(this._feature.type===1){const Me=[];for(const j of this._feature.geometry)Me.push([new s.P(j[0],j[1])]);return Me}{const Me=[];for(const j of this._feature.geometry){const Q=[];for(const de of j)Q.push(new s.P(de[0],de[1]));Me.push(Q)}return Me}}toGeoJSON(Me,j,Q){return Oi.call(this,Me,j,Q)}},qe=class{constructor(Me){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.V,this.length=Me.length,this._features=Me}feature(Me){return new va(this._features[Me])}};var yo={exports:{}},En=s.dN,Ot=s.dM.VectorTileFeature,na=ka;function ka(Me,j){this.options=j||{},this.features=Me,this.length=Me.length}function ot(Me,j){this.id=typeof Me.id=="number"?Me.id:void 0,this.type=Me.type,this.rawGeometry=Me.type===1?[Me.geometry]:Me.geometry,this.properties=Me.tags,this.extent=j||4096}ka.prototype.feature=function(Me){return new ot(this.features[Me],this.options.extent)},ot.prototype.loadGeometry=function(){var Me=this.rawGeometry;this.geometry=[];for(var j=0;j<Me.length;j++){for(var Q=Me[j],de=[],we=0;we<Q.length;we++)de.push(new En(Q[we][0],Q[we][1]));this.geometry.push(de)}return this.geometry},ot.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Me=this.geometry,j=1/0,Q=-1/0,de=1/0,we=-1/0,Fe=0;Fe<Me.length;Fe++)for(var Ge=Me[Fe],gt=0;gt<Ge.length;gt++){var Pe=Ge[gt];j=Math.min(j,Pe.x),Q=Math.max(Q,Pe.x),de=Math.min(de,Pe.y),we=Math.max(we,Pe.y)}return[j,de,Q,we]},ot.prototype.toGeoJSON=Ot.prototype.toGeoJSON;var Qa=s.dO,Ea=na;function Vt(Me){var j=new Qa;return function(Q,de){for(var we in Q.layers)de.writeMessage(3,Lo,Q.layers[we])}(Me,j),j.finish()}function Lo(Me,j){var Q;j.writeVarintField(15,Me.version||1),j.writeStringField(1,Me.name||""),j.writeVarintField(5,Me.extent||4096);var de={keys:[],values:[],keycache:{},valuecache:{}};for(Q=0;Q<Me.length;Q++)de.feature=Me.feature(Q),j.writeMessage(2,Na,de);var we=de.keys;for(Q=0;Q<we.length;Q++)j.writeStringField(3,we[Q]);var Fe=de.values;for(Q=0;Q<Fe.length;Q++)j.writeMessage(4,pl,Fe[Q])}function Na(Me,j){var Q=Me.feature;Q.id!==void 0&&j.writeVarintField(1,Q.id),j.writeMessage(2,No,Me),j.writeVarintField(3,Q.type),j.writeMessage(4,Es,Q)}function No(Me,j){var Q=Me.feature,de=Me.keys,we=Me.values,Fe=Me.keycache,Ge=Me.valuecache;for(var gt in Q.properties){var Pe=Q.properties[gt],Tt=Fe[gt];if(Pe!==null){Tt===void 0&&(de.push(gt),Fe[gt]=Tt=de.length-1),j.writeVarint(Tt);var ct=typeof Pe;ct!=="string"&&ct!=="boolean"&&ct!=="number"&&(Pe=JSON.stringify(Pe));var vt=ct+":"+Pe,Xt=Ge[vt];Xt===void 0&&(we.push(Pe),Ge[vt]=Xt=we.length-1),j.writeVarint(Xt)}}}function za(Me,j){return(j<<3)+(7&Me)}function Zn(Me){return Me<<1^Me>>31}function Es(Me,j){for(var Q=Me.loadGeometry(),de=Me.type,we=0,Fe=0,Ge=Q.length,gt=0;gt<Ge;gt++){var Pe=Q[gt],Tt=1;de===1&&(Tt=Pe.length),j.writeVarint(za(1,Tt));for(var ct=de===3?Pe.length-1:Pe.length,vt=0;vt<ct;vt++){vt===1&&de!==1&&j.writeVarint(za(2,ct-1));var Xt=Pe[vt].x-we,Ci=Pe[vt].y-Fe;j.writeVarint(Zn(Xt)),j.writeVarint(Zn(Ci)),we+=Xt,Fe+=Ci}de===3&&j.writeVarint(za(7,1))}}function pl(Me,j){var Q=typeof Me;Q==="string"?j.writeStringField(1,Me):Q==="boolean"?j.writeBooleanField(7,Me):Q==="number"&&(Me%1!=0?j.writeDoubleField(3,Me):Me<0?j.writeSVarintField(6,Me):j.writeVarintField(5,Me))}yo.exports=Vt,yo.exports.fromVectorTileJs=Vt,yo.exports.fromGeojsonVt=function(Me,j){j=j||{};var Q={};for(var de in Me)Q[de]=new Ea(Me[de].features,j),Q[de].name=de,Q[de].version=j.version,Q[de].extent=j.extent;return Vt({layers:Q})},yo.exports.GeoJSONWrapper=Ea;var hl=s.dK(yo.exports);const gl={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Me=>Me},Xn=Math.fround||(Qo=new Float32Array(1),Me=>(Qo[0]=+Me,Qo[0]));var Qo;const Ha=3,bo=5,uo=6;class yr{constructor(j){this.options=Object.assign(Object.create(gl),j),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(j){const{log:Q,minZoom:de,maxZoom:we}=this.options;Q&&console.time("total time");const Fe=`prepare ${j.length} points`;Q&&console.time(Fe),this.points=j;const Ge=[];for(let Pe=0;Pe<j.length;Pe++){const Tt=j[Pe];if(!Tt.geometry)continue;const[ct,vt]=Tt.geometry.coordinates,Xt=Xn(Jn(ct)),Ci=Xn(en(vt));Ge.push(Xt,Ci,1/0,Pe,-1,1),this.options.reduce&&Ge.push(0)}let gt=this.trees[we+1]=this._createTree(Ge);Q&&console.timeEnd(Fe);for(let Pe=we;Pe>=de;Pe--){const Tt=+Date.now();gt=this.trees[Pe]=this._createTree(this._cluster(gt,Pe)),Q&&console.log("z%d: %d clusters in %dms",Pe,gt.numItems,+Date.now()-Tt)}return Q&&console.timeEnd("total time"),this}getClusters(j,Q){let de=((j[0]+180)%360+360)%360-180;const we=Math.max(-90,Math.min(90,j[1]));let Fe=j[2]===180?180:((j[2]+180)%360+360)%360-180;const Ge=Math.max(-90,Math.min(90,j[3]));if(j[2]-j[0]>=360)de=-180,Fe=180;else if(de>Fe){const vt=this.getClusters([de,we,180,Ge],Q),Xt=this.getClusters([-180,we,Fe,Ge],Q);return vt.concat(Xt)}const gt=this.trees[this._limitZoom(Q)],Pe=gt.range(Jn(de),en(Ge),Jn(Fe),en(we)),Tt=gt.data,ct=[];for(const vt of Pe){const Xt=this.stride*vt;ct.push(Tt[Xt+bo]>1?ta(Tt,Xt,this.clusterProps):this.points[Tt[Xt+Ha]])}return ct}getChildren(j){const Q=this._getOriginId(j),de=this._getOriginZoom(j),we="No cluster with the specified id.",Fe=this.trees[de];if(!Fe)throw new Error(we);const Ge=Fe.data;if(Q*this.stride>=Ge.length)throw new Error(we);const gt=this.options.radius/(this.options.extent*Math.pow(2,de-1)),Pe=Fe.within(Ge[Q*this.stride],Ge[Q*this.stride+1],gt),Tt=[];for(const ct of Pe){const vt=ct*this.stride;Ge[vt+4]===j&&Tt.push(Ge[vt+bo]>1?ta(Ge,vt,this.clusterProps):this.points[Ge[vt+Ha]])}if(Tt.length===0)throw new Error(we);return Tt}getLeaves(j,Q,de){const we=[];return this._appendLeaves(we,j,Q=Q||10,de=de||0,0),we}getTile(j,Q,de){const we=this.trees[this._limitZoom(j)],Fe=Math.pow(2,j),{extent:Ge,radius:gt}=this.options,Pe=gt/Ge,Tt=(de-Pe)/Fe,ct=(de+1+Pe)/Fe,vt={features:[]};return this._addTileFeatures(we.range((Q-Pe)/Fe,Tt,(Q+1+Pe)/Fe,ct),we.data,Q,de,Fe,vt),Q===0&&this._addTileFeatures(we.range(1-Pe/Fe,Tt,1,ct),we.data,Fe,de,Fe,vt),Q===Fe-1&&this._addTileFeatures(we.range(0,Tt,Pe/Fe,ct),we.data,-1,de,Fe,vt),vt.features.length?vt:null}getClusterExpansionZoom(j){let Q=this._getOriginZoom(j)-1;for(;Q<=this.options.maxZoom;){const de=this.getChildren(j);if(Q++,de.length!==1)break;j=de[0].properties.cluster_id}return Q}_appendLeaves(j,Q,de,we,Fe){const Ge=this.getChildren(Q);for(const gt of Ge){const Pe=gt.properties;if(Pe&&Pe.cluster?Fe+Pe.point_count<=we?Fe+=Pe.point_count:Fe=this._appendLeaves(j,Pe.cluster_id,de,we,Fe):Fe<we?Fe++:j.push(gt),j.length===de)break}return Fe}_createTree(j){const Q=new s.bg(j.length/this.stride|0,this.options.nodeSize,Float32Array);for(let de=0;de<j.length;de+=this.stride)Q.add(j[de],j[de+1]);return Q.finish(),Q.data=j,Q}_addTileFeatures(j,Q,de,we,Fe,Ge){for(const gt of j){const Pe=gt*this.stride,Tt=Q[Pe+bo]>1;let ct,vt,Xt;if(Tt)ct=To(Q,Pe,this.clusterProps),vt=Q[Pe],Xt=Q[Pe+1];else{const wi=this.points[Q[Pe+Ha]];ct=wi.properties;const[Ai,Ti]=wi.geometry.coordinates;vt=Jn(Ai),Xt=en(Ti)}const Ci={type:1,geometry:[[Math.round(this.options.extent*(vt*Fe-de)),Math.round(this.options.extent*(Xt*Fe-we))]],tags:ct};let Hi;Hi=Tt||this.options.generateId?Q[Pe+Ha]:this.points[Q[Pe+Ha]].id,Hi!==void 0&&(Ci.id=Hi),Ge.features.push(Ci)}}_limitZoom(j){return Math.max(this.options.minZoom,Math.min(Math.floor(+j),this.options.maxZoom+1))}_cluster(j,Q){const{radius:de,extent:we,reduce:Fe,minPoints:Ge}=this.options,gt=de/(we*Math.pow(2,Q)),Pe=j.data,Tt=[],ct=this.stride;for(let vt=0;vt<Pe.length;vt+=ct){if(Pe[vt+2]<=Q)continue;Pe[vt+2]=Q;const Xt=Pe[vt],Ci=Pe[vt+1],Hi=j.within(Pe[vt],Pe[vt+1],gt),wi=Pe[vt+bo];let Ai=wi;for(const Ti of Hi){const Si=Ti*ct;Pe[Si+2]>Q&&(Ai+=Pe[Si+bo])}if(Ai>wi&&Ai>=Ge){let Ti,Si=Xt*wi,Bi=Ci*wi,Aa=-1;const zi=(vt/ct<<5)+(Q+1)+this.points.length;for(const Ka of Hi){const Ga=Ka*ct;if(Pe[Ga+2]<=Q)continue;Pe[Ga+2]=Q;const eo=Pe[Ga+bo];Si+=Pe[Ga]*eo,Bi+=Pe[Ga+1]*eo,Pe[Ga+4]=zi,Fe&&(Ti||(Ti=this._map(Pe,vt,!0),Aa=this.clusterProps.length,this.clusterProps.push(Ti)),Fe(Ti,this._map(Pe,Ga)))}Pe[vt+4]=zi,Tt.push(Si/Ai,Bi/Ai,1/0,zi,-1,Ai),Fe&&Tt.push(Aa)}else{for(let Ti=0;Ti<ct;Ti++)Tt.push(Pe[vt+Ti]);if(Ai>1)for(const Ti of Hi){const Si=Ti*ct;if(!(Pe[Si+2]<=Q)){Pe[Si+2]=Q;for(let Bi=0;Bi<ct;Bi++)Tt.push(Pe[Si+Bi])}}}}return Tt}_getOriginId(j){return j-this.points.length>>5}_getOriginZoom(j){return(j-this.points.length)%32}_map(j,Q,de){if(j[Q+bo]>1){const Ge=this.clusterProps[j[Q+uo]];return de?Object.assign({},Ge):Ge}const we=this.points[j[Q+Ha]].properties,Fe=this.options.map(we);return de&&Fe===we?Object.assign({},Fe):Fe}}function ta(Me,j,Q){return{type:"Feature",id:Me[j+Ha],properties:To(Me,j,Q),geometry:{type:"Point",coordinates:[(de=Me[j],360*(de-.5)),Ko(Me[j+1])]}};var de}function To(Me,j,Q){const de=Me[j+bo],we=de>=1e4?`${Math.round(de/1e3)}k`:de>=1e3?Math.round(de/100)/10+"k":de,Fe=Me[j+uo],Ge=Fe===-1?{}:Object.assign({},Q[Fe]);return Object.assign(Ge,{cluster:!0,cluster_id:Me[j+Ha],point_count:de,point_count_abbreviated:we})}function Jn(Me){return Me/360+.5}function en(Me){const j=Math.sin(Me*Math.PI/180),Q=.5-.25*Math.log((1+j)/(1-j))/Math.PI;return Q<0?0:Q>1?1:Q}function Ko(Me){const j=(180-360*Me)*Math.PI/180;return 360*Math.atan(Math.exp(j))/Math.PI-90}var Qn={exports:{}};Qn.exports=function(){function Me(Re,Le,Ve,et){for(var Ze,at=et,nt=Ve-Le>>1,Je=Ve-Le,rt=Re[Le],tt=Re[Le+1],Dt=Re[Ve],ni=Re[Ve+1],It=Le+3;It<Ve;It+=3){var Pi=j(Re[It],Re[It+1],rt,tt,Dt,ni);if(Pi>at)Ze=It,at=Pi;else if(Pi===at){var Vi=Math.abs(It-nt);Vi<Je&&(Ze=It,Je=Vi)}}at>et&&(Ze-Le>3&&Me(Re,Le,Ze,et),Re[Ze+2]=at,Ve-Ze>3&&Me(Re,Ze,Ve,et))}function j(Re,Le,Ve,et,Ze,at){var nt=Ze-Ve,Je=at-et;if(nt!==0||Je!==0){var rt=((Re-Ve)*nt+(Le-et)*Je)/(nt*nt+Je*Je);rt>1?(Ve=Ze,et=at):rt>0&&(Ve+=nt*rt,et+=Je*rt)}return(nt=Re-Ve)*nt+(Je=Le-et)*Je}function Q(Re,Le,Ve,et){var Ze={id:Re===void 0?null:Re,type:Le,geometry:Ve,tags:et,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(at){var nt=at.geometry,Je=at.type;if(Je==="Point"||Je==="MultiPoint"||Je==="LineString")de(at,nt);else if(Je==="Polygon"||Je==="MultiLineString")for(var rt=0;rt<nt.length;rt++)de(at,nt[rt]);else if(Je==="MultiPolygon")for(rt=0;rt<nt.length;rt++)for(var tt=0;tt<nt[rt].length;tt++)de(at,nt[rt][tt])}(Ze),Ze}function de(Re,Le){for(var Ve=0;Ve<Le.length;Ve+=3)Re.minX=Math.min(Re.minX,Le[Ve]),Re.minY=Math.min(Re.minY,Le[Ve+1]),Re.maxX=Math.max(Re.maxX,Le[Ve]),Re.maxY=Math.max(Re.maxY,Le[Ve+1])}function we(Re,Le,Ve,et){if(Le.geometry){var Ze=Le.geometry.coordinates,at=Le.geometry.type,nt=Math.pow(Ve.tolerance/((1<<Ve.maxZoom)*Ve.extent),2),Je=[],rt=Le.id;if(Ve.promoteId?rt=Le.properties[Ve.promoteId]:Ve.generateId&&(rt=et||0),at==="Point")Fe(Ze,Je);else if(at==="MultiPoint")for(var tt=0;tt<Ze.length;tt++)Fe(Ze[tt],Je);else if(at==="LineString")Ge(Ze,Je,nt,!1);else if(at==="MultiLineString"){if(Ve.lineMetrics){for(tt=0;tt<Ze.length;tt++)Ge(Ze[tt],Je=[],nt,!1),Re.push(Q(rt,"LineString",Je,Le.properties));return}gt(Ze,Je,nt,!1)}else if(at==="Polygon")gt(Ze,Je,nt,!0);else{if(at!=="MultiPolygon"){if(at==="GeometryCollection"){for(tt=0;tt<Le.geometry.geometries.length;tt++)we(Re,{id:rt,geometry:Le.geometry.geometries[tt],properties:Le.properties},Ve,et);return}throw new Error("Input data is not a valid GeoJSON object.")}for(tt=0;tt<Ze.length;tt++){var Dt=[];gt(Ze[tt],Dt,nt,!0),Je.push(Dt)}}Re.push(Q(rt,at,Je,Le.properties))}}function Fe(Re,Le){Le.push(Pe(Re[0])),Le.push(Tt(Re[1])),Le.push(0)}function Ge(Re,Le,Ve,et){for(var Ze,at,nt=0,Je=0;Je<Re.length;Je++){var rt=Pe(Re[Je][0]),tt=Tt(Re[Je][1]);Le.push(rt),Le.push(tt),Le.push(0),Je>0&&(nt+=et?(Ze*tt-rt*at)/2:Math.sqrt(Math.pow(rt-Ze,2)+Math.pow(tt-at,2))),Ze=rt,at=tt}var Dt=Le.length-3;Le[2]=1,Me(Le,0,Dt,Ve),Le[Dt+2]=1,Le.size=Math.abs(nt),Le.start=0,Le.end=Le.size}function gt(Re,Le,Ve,et){for(var Ze=0;Ze<Re.length;Ze++){var at=[];Ge(Re[Ze],at,Ve,et),Le.push(at)}}function Pe(Re){return Re/360+.5}function Tt(Re){var Le=Math.sin(Re*Math.PI/180),Ve=.5-.25*Math.log((1+Le)/(1-Le))/Math.PI;return Ve<0?0:Ve>1?1:Ve}function ct(Re,Le,Ve,et,Ze,at,nt,Je){if(et/=Le,at>=(Ve/=Le)&&nt<et)return Re;if(nt<Ve||at>=et)return null;for(var rt=[],tt=0;tt<Re.length;tt++){var Dt=Re[tt],ni=Dt.geometry,It=Dt.type,Pi=Ze===0?Dt.minX:Dt.minY,Vi=Ze===0?Dt.maxX:Dt.maxY;if(Pi>=Ve&&Vi<et)rt.push(Dt);else if(!(Vi<Ve||Pi>=et)){var Mi=[];if(It==="Point"||It==="MultiPoint")vt(ni,Mi,Ve,et,Ze);else if(It==="LineString")Xt(ni,Mi,Ve,et,Ze,!1,Je.lineMetrics);else if(It==="MultiLineString")Hi(ni,Mi,Ve,et,Ze,!1);else if(It==="Polygon")Hi(ni,Mi,Ve,et,Ze,!0);else if(It==="MultiPolygon")for(var pa=0;pa<ni.length;pa++){var Wa=[];Hi(ni[pa],Wa,Ve,et,Ze,!0),Wa.length&&Mi.push(Wa)}if(Mi.length){if(Je.lineMetrics&&It==="LineString"){for(pa=0;pa<Mi.length;pa++)rt.push(Q(Dt.id,It,Mi[pa],Dt.tags));continue}It!=="LineString"&&It!=="MultiLineString"||(Mi.length===1?(It="LineString",Mi=Mi[0]):It="MultiLineString"),It!=="Point"&&It!=="MultiPoint"||(It=Mi.length===3?"Point":"MultiPoint"),rt.push(Q(Dt.id,It,Mi,Dt.tags))}}}return rt.length?rt:null}function vt(Re,Le,Ve,et,Ze){for(var at=0;at<Re.length;at+=3){var nt=Re[at+Ze];nt>=Ve&&nt<=et&&(Le.push(Re[at]),Le.push(Re[at+1]),Le.push(Re[at+2]))}}function Xt(Re,Le,Ve,et,Ze,at,nt){for(var Je,rt,tt=Ci(Re),Dt=Ze===0?Ai:Ti,ni=Re.start,It=0;It<Re.length-3;It+=3){var Pi=Re[It],Vi=Re[It+1],Mi=Re[It+2],pa=Re[It+3],Wa=Re[It+4],yi=Ze===0?Pi:Vi,co=Ze===0?pa:Wa,Wo=!1;nt&&(Je=Math.sqrt(Math.pow(Pi-pa,2)+Math.pow(Vi-Wa,2))),yi<Ve?co>Ve&&(rt=Dt(tt,Pi,Vi,pa,Wa,Ve),nt&&(tt.start=ni+Je*rt)):yi>et?co<et&&(rt=Dt(tt,Pi,Vi,pa,Wa,et),nt&&(tt.start=ni+Je*rt)):wi(tt,Pi,Vi,Mi),co<Ve&&yi>=Ve&&(rt=Dt(tt,Pi,Vi,pa,Wa,Ve),Wo=!0),co>et&&yi<=et&&(rt=Dt(tt,Pi,Vi,pa,Wa,et),Wo=!0),!at&&Wo&&(nt&&(tt.end=ni+Je*rt),Le.push(tt),tt=Ci(Re)),nt&&(ni+=Je)}var Ma=Re.length-3;Pi=Re[Ma],Vi=Re[Ma+1],Mi=Re[Ma+2],(yi=Ze===0?Pi:Vi)>=Ve&&yi<=et&&wi(tt,Pi,Vi,Mi),Ma=tt.length-3,at&&Ma>=3&&(tt[Ma]!==tt[0]||tt[Ma+1]!==tt[1])&&wi(tt,tt[0],tt[1],tt[2]),tt.length&&Le.push(tt)}function Ci(Re){var Le=[];return Le.size=Re.size,Le.start=Re.start,Le.end=Re.end,Le}function Hi(Re,Le,Ve,et,Ze,at){for(var nt=0;nt<Re.length;nt++)Xt(Re[nt],Le,Ve,et,Ze,at,!1)}function wi(Re,Le,Ve,et){Re.push(Le),Re.push(Ve),Re.push(et)}function Ai(Re,Le,Ve,et,Ze,at){var nt=(at-Le)/(et-Le);return Re.push(at),Re.push(Ve+(Ze-Ve)*nt),Re.push(1),nt}function Ti(Re,Le,Ve,et,Ze,at){var nt=(at-Ve)/(Ze-Ve);return Re.push(Le+(et-Le)*nt),Re.push(at),Re.push(1),nt}function Si(Re,Le){for(var Ve=[],et=0;et<Re.length;et++){var Ze,at=Re[et],nt=at.type;if(nt==="Point"||nt==="MultiPoint"||nt==="LineString")Ze=Bi(at.geometry,Le);else if(nt==="MultiLineString"||nt==="Polygon"){Ze=[];for(var Je=0;Je<at.geometry.length;Je++)Ze.push(Bi(at.geometry[Je],Le))}else if(nt==="MultiPolygon")for(Ze=[],Je=0;Je<at.geometry.length;Je++){for(var rt=[],tt=0;tt<at.geometry[Je].length;tt++)rt.push(Bi(at.geometry[Je][tt],Le));Ze.push(rt)}Ve.push(Q(at.id,nt,Ze,at.tags))}return Ve}function Bi(Re,Le){var Ve=[];Ve.size=Re.size,Re.start!==void 0&&(Ve.start=Re.start,Ve.end=Re.end);for(var et=0;et<Re.length;et+=3)Ve.push(Re[et]+Le,Re[et+1],Re[et+2]);return Ve}function Aa(Re,Le){if(Re.transformed)return Re;var Ve,et,Ze,at=1<<Re.z,nt=Re.x,Je=Re.y;for(Ve=0;Ve<Re.features.length;Ve++){var rt=Re.features[Ve],tt=rt.geometry,Dt=rt.type;if(rt.geometry=[],Dt===1)for(et=0;et<tt.length;et+=2)rt.geometry.push(zi(tt[et],tt[et+1],Le,at,nt,Je));else for(et=0;et<tt.length;et++){var ni=[];for(Ze=0;Ze<tt[et].length;Ze+=2)ni.push(zi(tt[et][Ze],tt[et][Ze+1],Le,at,nt,Je));rt.geometry.push(ni)}}return Re.transformed=!0,Re}function zi(Re,Le,Ve,et,Ze,at){return[Math.round(Ve*(Re*et-Ze)),Math.round(Ve*(Le*et-at))]}function Ka(Re,Le,Ve,et,Ze){for(var at=Le===Ze.maxZoom?0:Ze.tolerance/((1<<Le)*Ze.extent),nt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Ve,y:et,z:Le,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Je=0;Je<Re.length;Je++){nt.numFeatures++,Ga(nt,Re[Je],at,Ze);var rt=Re[Je].minX,tt=Re[Je].minY,Dt=Re[Je].maxX,ni=Re[Je].maxY;rt<nt.minX&&(nt.minX=rt),tt<nt.minY&&(nt.minY=tt),Dt>nt.maxX&&(nt.maxX=Dt),ni>nt.maxY&&(nt.maxY=ni)}return nt}function Ga(Re,Le,Ve,et){var Ze=Le.geometry,at=Le.type,nt=[];if(at==="Point"||at==="MultiPoint")for(var Je=0;Je<Ze.length;Je+=3)nt.push(Ze[Je]),nt.push(Ze[Je+1]),Re.numPoints++,Re.numSimplified++;else if(at==="LineString")eo(nt,Ze,Re,Ve,!1,!1);else if(at==="MultiLineString"||at==="Polygon")for(Je=0;Je<Ze.length;Je++)eo(nt,Ze[Je],Re,Ve,at==="Polygon",Je===0);else if(at==="MultiPolygon")for(var rt=0;rt<Ze.length;rt++){var tt=Ze[rt];for(Je=0;Je<tt.length;Je++)eo(nt,tt[Je],Re,Ve,!0,Je===0)}if(nt.length){var Dt=Le.tags||null;if(at==="LineString"&&et.lineMetrics){for(var ni in Dt={},Le.tags)Dt[ni]=Le.tags[ni];Dt.mapbox_clip_start=Ze.start/Ze.size,Dt.mapbox_clip_end=Ze.end/Ze.size}var It={geometry:nt,type:at==="Polygon"||at==="MultiPolygon"?3:at==="LineString"||at==="MultiLineString"?2:1,tags:Dt};Le.id!==null&&(It.id=Le.id),Re.features.push(It)}}function eo(Re,Le,Ve,et,Ze,at){var nt=et*et;if(et>0&&Le.size<(Ze?nt:et))Ve.numPoints+=Le.length/3;else{for(var Je=[],rt=0;rt<Le.length;rt+=3)(et===0||Le[rt+2]>nt)&&(Ve.numSimplified++,Je.push(Le[rt]),Je.push(Le[rt+1])),Ve.numPoints++;Ze&&function(tt,Dt){for(var ni=0,It=0,Pi=tt.length,Vi=Pi-2;It<Pi;Vi=It,It+=2)ni+=(tt[It]-tt[Vi])*(tt[It+1]+tt[Vi+1]);if(ni>0===Dt)for(It=0,Pi=tt.length;It<Pi/2;It+=2){var Mi=tt[It],pa=tt[It+1];tt[It]=tt[Pi-2-It],tt[It+1]=tt[Pi-1-It],tt[Pi-2-It]=Mi,tt[Pi-1-It]=pa}}(Je,at),Re.push(Je)}}function fa(Re,Le){var Ve=(Le=this.options=function(Ze,at){for(var nt in at)Ze[nt]=at[nt];return Ze}(Object.create(this.options),Le)).debug;if(Ve&&console.time("preprocess data"),Le.maxZoom<0||Le.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Le.promoteId&&Le.generateId)throw new Error("promoteId and generateId cannot be used together.");var et=function(Ze,at){var nt=[];if(Ze.type==="FeatureCollection")for(var Je=0;Je<Ze.features.length;Je++)we(nt,Ze.features[Je],at,Je);else we(nt,Ze.type==="Feature"?Ze:{geometry:Ze},at);return nt}(Re,Le);this.tiles={},this.tileCoords=[],Ve&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Le.indexMaxZoom,Le.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(et=function(Ze,at){var nt=at.buffer/at.extent,Je=Ze,rt=ct(Ze,1,-1-nt,nt,0,-1,2,at),tt=ct(Ze,1,1-nt,2+nt,0,-1,2,at);return(rt||tt)&&(Je=ct(Ze,1,-nt,1+nt,0,-1,2,at)||[],rt&&(Je=Si(rt,1).concat(Je)),tt&&(Je=Je.concat(Si(tt,-1)))),Je}(et,Le)).length&&this.splitTile(et,0,0,0),Ve&&(et.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ua(Re,Le,Ve){return 32*((1<<Re)*Ve+Le)+Re}return fa.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},fa.prototype.splitTile=function(Re,Le,Ve,et,Ze,at,nt){for(var Je=[Re,Le,Ve,et],rt=this.options,tt=rt.debug;Je.length;){et=Je.pop(),Ve=Je.pop(),Le=Je.pop(),Re=Je.pop();var Dt=1<<Le,ni=ua(Le,Ve,et),It=this.tiles[ni];if(!It&&(tt>1&&console.time("creation"),It=this.tiles[ni]=Ka(Re,Le,Ve,et,rt),this.tileCoords.push({z:Le,x:Ve,y:et}),tt)){tt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Le,Ve,et,It.numFeatures,It.numPoints,It.numSimplified),console.timeEnd("creation"));var Pi="z"+Le;this.stats[Pi]=(this.stats[Pi]||0)+1,this.total++}if(It.source=Re,Ze){if(Le===rt.maxZoom||Le===Ze)continue;var Vi=1<<Ze-Le;if(Ve!==Math.floor(at/Vi)||et!==Math.floor(nt/Vi))continue}else if(Le===rt.indexMaxZoom||It.numPoints<=rt.indexMaxPoints)continue;if(It.source=null,Re.length!==0){tt>1&&console.time("clipping");var Mi,pa,Wa,yi,co,Wo,Ma=.5*rt.buffer/rt.extent,yl=.5-Ma,In=.5+Ma,Os=1+Ma;Mi=pa=Wa=yi=null,co=ct(Re,Dt,Ve-Ma,Ve+In,0,It.minX,It.maxX,rt),Wo=ct(Re,Dt,Ve+yl,Ve+Os,0,It.minX,It.maxX,rt),Re=null,co&&(Mi=ct(co,Dt,et-Ma,et+In,1,It.minY,It.maxY,rt),pa=ct(co,Dt,et+yl,et+Os,1,It.minY,It.maxY,rt),co=null),Wo&&(Wa=ct(Wo,Dt,et-Ma,et+In,1,It.minY,It.maxY,rt),yi=ct(Wo,Dt,et+yl,et+Os,1,It.minY,It.maxY,rt),Wo=null),tt>1&&console.timeEnd("clipping"),Je.push(Mi||[],Le+1,2*Ve,2*et),Je.push(pa||[],Le+1,2*Ve,2*et+1),Je.push(Wa||[],Le+1,2*Ve+1,2*et),Je.push(yi||[],Le+1,2*Ve+1,2*et+1)}}},fa.prototype.getTile=function(Re,Le,Ve){var et=this.options,Ze=et.extent,at=et.debug;if(Re<0||Re>24)return null;var nt=1<<Re,Je=ua(Re,Le=(Le%nt+nt)%nt,Ve);if(this.tiles[Je])return Aa(this.tiles[Je],Ze);at>1&&console.log("drilling down to z%d-%d-%d",Re,Le,Ve);for(var rt,tt=Re,Dt=Le,ni=Ve;!rt&&tt>0;)tt--,Dt=Math.floor(Dt/2),ni=Math.floor(ni/2),rt=this.tiles[ua(tt,Dt,ni)];return rt&&rt.source?(at>1&&console.log("found parent tile z%d-%d-%d",tt,Dt,ni),at>1&&console.time("drilling down"),this.splitTile(rt.source,tt,Dt,ni,Re,Le,Ve),at>1&&console.timeEnd("drilling down"),this.tiles[Je]?Aa(this.tiles[Je],Ze):null):null},function(Re,Le){return new fa(Re,Le)}}();var _a=s.dK(Qn.exports);function As(Me,j){const Q=Me.tileID.canonical;if(!this._geoJSONIndex)return j(null,null);const de=this._geoJSONIndex.getTile(Q.z,Q.x,Q.y);if(!de)return j(null,null);const we=new qe(de.features);let Fe=hl(we);Fe.byteOffset===0&&Fe.byteLength===Fe.buffer.byteLength||(Fe=new Uint8Array(Fe)),j(null,{vectorTile:we,rawData:Fe.buffer})}class Is extends Oe{constructor(j,Q,de,we,Fe,Ge){super(j,Q,de,we,As,Ge),Fe&&(this.loadGeoJSON=Fe)}loadData(j,Q){const de=j&&j.request,we=de&&de.collectResourceTiming;this.loadGeoJSON(j,(Fe,Ge)=>{if(Fe||!Ge)return Q(Fe);if(typeof Ge!="object")return Q(new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`));{ai(Ge,!0);try{if(j.filter){const Pe=s.r(j.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Pe.result==="error")throw new Error(Pe.value.map(ct=>`${ct.key}: ${ct.message}`).join(", "));Ge={type:"FeatureCollection",features:Ge.features.filter(ct=>Pe.value.evaluate({zoom:0},ct))}}this._geoJSONIndex=j.cluster?new yr(function({superclusterOptions:Pe,clusterProperties:Tt}){if(!Tt||!Pe)return Pe;const ct={},vt={},Xt={accumulated:null,zoom:0},Ci={properties:null},Hi=Object.keys(Tt);for(const wi of Hi){const[Ai,Ti]=Tt[wi],Si=s.r(Ti),Bi=s.r(typeof Ai=="string"?[Ai,["accumulated"],["get",wi]]:Ai);ct[wi]=Si.value,vt[wi]=Bi.value}return Pe.map=wi=>{Ci.properties=wi;const Ai={};for(const Ti of Hi)Ai[Ti]=ct[Ti].evaluate(Xt,Ci);return Ai},Pe.reduce=(wi,Ai)=>{Ci.properties=Ai;for(const Ti of Hi)Xt.accumulated=wi[Ti],wi[Ti]=vt[Ti].evaluate(Xt,Ci)},Pe}(j)).load(Ge.features):_a(Ge,j.geojsonVtOptions)}catch(Pe){return Q(Pe)}this.loaded={};const gt={};if(we){const Pe=oe(de);Pe&&(gt.resourceTiming={},gt.resourceTiming[j.source]=JSON.parse(JSON.stringify(Pe)))}Q(null,gt)}})}reloadTile(j,Q){const de=this.loaded;return de&&de[j.uid]?super.reloadTile(j,Q):this.loadTile(j,Q)}loadGeoJSON(j,Q){if(j.request)s.g(j.request,Q);else{if(typeof j.data!="string")return Q(new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`));try{return Q(null,JSON.parse(j.data))}catch{return Q(new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(j,Q){try{Q(null,this._geoJSONIndex.getClusterExpansionZoom(j.clusterId))}catch(de){Q(de)}}getClusterChildren(j,Q){try{Q(null,this._geoJSONIndex.getChildren(j.clusterId))}catch(de){Q(de)}}getClusterLeaves(j,Q){try{Q(null,this._geoJSONIndex.getLeaves(j.clusterId,j.limit,j.offset))}catch(de){Q(de)}}}class xo{constructor(j,Q){this.tileID=new s.am(j.tileID.overscaledZ,j.tileID.wrap,j.tileID.canonical.z,j.tileID.canonical.x,j.tileID.canonical.y),this.tileZoom=j.tileZoom,this.uid=j.uid,this.zoom=j.zoom,this.canonical=j.tileID.canonical,this.pixelRatio=j.pixelRatio,this.tileSize=j.tileSize,this.source=j.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=j.projection,this.brightness=Q}parse(j,Q,de,we){this.status="parsing";const Fe=new s.am(de.tileID.overscaledZ,de.tileID.wrap,de.tileID.canonical.z,de.tileID.canonical.x,de.tileID.canonical.y),Ge={},gt=Q.familiesBySource[de.source],Pe=new s.dC(Fe,de.promoteId);return Pe.bucketLayerIDs=[],Pe.is3DTile=!0,s.dP(j).then(Tt=>{if(!Tt)return we(new Error("Could not parse tile"));const ct=s.dQ(Tt,1/s.bR(de.tileID.canonical)),vt=Tt.json.extensionsUsed&&Tt.json.extensionsUsed.includes("MAPBOX_mesh_features")||Tt.json.asset.extras&&Tt.json.asset.extras.MAPBOX_mesh_features,Xt=Tt.json.extensionsUsed&&Tt.json.extensionsUsed.includes("EXT_meshopt_compression"),Ci=new s.K(this.zoom,{brightness:this.brightness});for(const Hi in gt)for(const wi of gt[Hi]){const Ai=wi[0];Pe.bucketLayerIDs.push(wi.map(Si=>Si.id)),Ai.recalculate(Ci,[]);const Ti=new s.dR(ct,Fe,vt,Xt,this.brightness,Pe);vt||(Ti.needsUpload=!0),Ge[Ai.fqid]=Ti,Ti.evaluate(Ai)}this.status="done",we(null,{buckets:Ge,featureIndex:Pe})}).catch(Tt=>we(new Error(Tt.message)))}}class tn{constructor(j,Q,de,we,Fe,Ge){this.actor=j,this.layerIndex=Q,this.brightness=Ge,this.loading={},this.loaded={}}loadTile(j,Q){const de=j.uid,we=this.loading[de]=new xo(j,this.brightness);s.a_(j.request,(Fe,Ge)=>{const gt=!this.loading[de];return delete this.loading[de],gt||Fe?(we.status="done",gt||(this.loaded[de]=we),Q(Fe)):Ge&&Ge.byteLength!==0?void we.parse(Ge,this.layerIndex,j,(Pe,Tt)=>{we.status="done",this.loaded=this.loaded||{},this.loaded[de]=we,Pe||!Tt?Q(Pe):Q(null,Tt)}):(we.status="done",this.loaded[de]=we,Q())})}reloadTile(j,Q){const de=this.loaded,we=j.uid;if(de&&de[we]){const Fe=de[we];Fe.projection=j.projection,Fe.brightness=j.brightness;const Ge=(gt,Pe)=>{Fe.reloadCallback&&(delete Fe.reloadCallback,this.loadTile(j,Q)),Q(gt,Pe)};Fe.status==="parsing"?Fe.reloadCallback=Ge:Fe.status==="done"&&this.loadTile(j,Q)}}abortTile(j,Q){const de=j.uid;this.loading[de]&&delete this.loading[de],Q()}removeTile(j,Q){const de=this.loaded,we=j.uid;de&&de[we]&&delete de[we],Q()}}class An{constructor(j){this.self=j,this.actor=new s.dS(j,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=s.bo({name:"mercator"}),this.workerSourceTypes={vector:Oe,geojson:Is,"batched-model":tn},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Q,de)=>{if(this.workerSourceTypes[Q])throw new Error(`Worker source with name "${Q}" already registered.`);this.workerSourceTypes[Q]=de},this.self.registerRTLTextPlugin=Q=>{if(s.dT.isParsed())throw new Error("RTL text plugin already registered.");s.dT.applyArabicShaping=Q.applyArabicShaping,s.dT.processBidirectionalText=Q.processBidirectionalText,s.dT.processStyledBidirectionalText=Q.processStyledBidirectionalText}}clearCaches(j,Q,de){delete this.layerIndexes[j],delete this.availableImages[j],delete this.workerSources[j],delete this.demWorkerSources[j],delete this.rasterArrayWorkerSource,de()}checkIfReady(j,Q,de){de()}setReferrer(j,Q){this.referrer=Q}spriteLoaded(j,{scope:Q,isLoaded:de}){if(this.isSpriteLoaded[j]||(this.isSpriteLoaded[j]={}),this.isSpriteLoaded[j][Q]=de,this.workerSources[j]&&this.workerSources[j][Q])for(const we in this.workerSources[j][Q]){const Fe=this.workerSources[j][Q][we];for(const Ge in Fe)Fe[Ge]instanceof Oe&&(Fe[Ge].isSpriteLoaded=de,Fe[Ge].fire(new s.b("isSpriteLoaded")))}}setImages(j,{scope:Q,images:de},we){if(this.availableImages[j]||(this.availableImages[j]={}),this.availableImages[j][Q]=de,this.workerSources[j]&&this.workerSources[j][Q]){for(const Fe in this.workerSources[j][Q]){const Ge=this.workerSources[j][Q][Fe];for(const gt in Ge)Ge[gt].availableImages=de}we()}else we()}setProjection(j,Q){this.projections[j]=s.bo(Q)}setBrightness(j,Q,de){this.brightness=Q,de()}setLayers(j,Q,de){this.getLayerIndex(j,Q.scope).replace(Q.layers,Q.options),de()}updateLayers(j,Q,de){this.getLayerIndex(j,Q.scope).update(Q.layers,Q.removedIds,Q.options),de()}loadTile(j,Q,de){Q.projection=this.projections[j]||this.defaultProjection,this.getWorkerSource(j,Q.type,Q.source,Q.scope).loadTile(Q,de)}loadDEMTile(j,Q,de){this.getDEMWorkerSource(j,Q.source,Q.scope).loadTile(Q,de)}decodeRasterArray(j,Q,de){this.getRasterArrayWorkerSource().decodeRasterArray(Q,de)}reloadTile(j,Q,de){Q.projection=this.projections[j]||this.defaultProjection,this.getWorkerSource(j,Q.type,Q.source,Q.scope).reloadTile(Q,de)}abortTile(j,Q,de){this.getWorkerSource(j,Q.type,Q.source,Q.scope).abortTile(Q,de)}removeTile(j,Q,de){this.getWorkerSource(j,Q.type,Q.source,Q.scope).removeTile(Q,de)}removeSource(j,Q,de){if(!(this.workerSources[j]&&this.workerSources[j][Q.scope]&&this.workerSources[j][Q.scope][Q.type]&&this.workerSources[j][Q.scope][Q.type][Q.source]))return;const we=this.workerSources[j][Q.scope][Q.type][Q.source];delete this.workerSources[j][Q.scope][Q.type][Q.source],we.removeSource!==void 0?we.removeSource(Q,de):de()}loadWorkerSource(j,Q,de){try{this.self.importScripts(Q.url),de()}catch(we){de(we.toString())}}syncRTLPluginState(j,Q,de){try{s.dT.setState(Q);const we=s.dT.getPluginURL();if(s.dT.isLoaded()&&!s.dT.isParsed()&&we!=null){this.self.importScripts(we);const Fe=s.dT.isParsed();de(Fe?void 0:new Error(`RTL Text Plugin failed to import scripts from ${we}`),Fe)}}catch(we){de(we.toString())}}setDracoUrl(j,Q){this.dracoUrl=Q}getAvailableImages(j,Q){this.availableImages[j]||(this.availableImages[j]={});let de=this.availableImages[j][Q];return de||(de=[]),de}getLayerIndex(j,Q){this.layerIndexes[j]||(this.layerIndexes[j]={});let de=this.layerIndexes[j][Q];return de||(de=this.layerIndexes[j][Q]=new Ye,de.scope=Q),de}getWorkerSource(j,Q,de,we){if(this.workerSources[j]||(this.workerSources[j]={}),this.workerSources[j][we]||(this.workerSources[j][we]={}),this.workerSources[j][we][Q]||(this.workerSources[j][we][Q]={}),this.isSpriteLoaded[j]||(this.isSpriteLoaded[j]={}),!this.workerSources[j][we][Q][de]){const Fe={send:(Ge,gt,Pe,Tt,ct,vt)=>{this.actor.send(Ge,gt,Pe,j,ct,vt)},scheduler:this.actor.scheduler};this.workerSources[j][we][Q][de]=new this.workerSourceTypes[Q](Fe,this.getLayerIndex(j,we),this.getAvailableImages(j,we),this.isSpriteLoaded[j][we],void 0,this.brightness)}return this.workerSources[j][we][Q][de]}getDEMWorkerSource(j,Q,de){return this.demWorkerSources[j]||(this.demWorkerSources[j]={}),this.demWorkerSources[j][de]||(this.demWorkerSources[j][de]={}),this.demWorkerSources[j][de][Q]||(this.demWorkerSources[j][de][Q]=new ut),this.demWorkerSources[j][de][Q]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new bt),this.rasterArrayWorkerSource}enforceCacheSizeLimit(j,Q){s.dU(Q)}getWorkerPerformanceMetrics(j,Q,de){de(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new An(self)),An}),te(["./shared"],function(s){function oe(d,a){if(Array.isArray(d)){if(!Array.isArray(a)||d.length!==a.length)return!1;for(let n=0;n<d.length;n++)if(!oe(d[n],a[n]))return!1;return!0}if(typeof d=="object"&&d!==null&&a!==null){if(typeof a!="object"||Object.keys(d).length!==Object.keys(a).length)return!1;for(const n in d)if(!oe(d[n],a[n]))return!1;return!0}return d===a}var he=ve;function ve(d){return!function(a){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var _,c,f=new Blob([""],{type:"text/javascript"}),g=URL.createObjectURL(f);try{c=new Worker(g),_=!0}catch{_=!1}return c&&c.terminate(),URL.revokeObjectURL(g),_}()?function(){var _=document.createElement("canvas");_.width=_.height=1;var c=_.getContext("2d");if(!c)return!1;var f=c.getImageData(0,0,1,1);return f&&f.width===_.width}()?(Ye[n=a&&a.failIfMajorPerformanceCaveat]===void 0&&(Ye[n]=function(_){var c,f=function(g){var b=document.createElement("canvas"),v=Object.create(ve.webGLContextAttributes);return v.failIfMajorPerformanceCaveat=g,b.getContext("webgl2",v)}(_);if(!f)return!1;try{c=f.createShader(f.VERTEX_SHADER)}catch{return!1}return!(!c||f.isContextLost())&&(f.shaderSource(c,"void main() {}"),f.compileShader(c),f.getShaderParameter(c,f.COMPILE_STATUS)===!0)}(n)),Ye[n]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var n}(d)}var Ye={};function Ce(d,a,n){const _=document.createElement(d);return a!=null&&(_.className=a),n&&n.appendChild(_),_}function lt(d,a,n){const _=document.createElementNS("http://www.w3.org/2000/svg",d);for(const c of Object.keys(a))_.setAttributeNS(null,c,String(a[c]));return n&&n.appendChild(_),_}ve.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Ke=typeof document<"u"?document.documentElement&&document.documentElement.style:null,Nt=Ke&&Ke.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Oe;function ut(){Ke&&Nt&&(Oe=Ke[Nt],Ke[Nt]="none")}function bt(){Ke&&Nt&&(Ke[Nt]=Oe)}function Mt(d){d.preventDefault(),d.stopPropagation(),window.removeEventListener("click",Mt,!0)}function Fi(){window.addEventListener("click",Mt,!0),window.setTimeout(()=>{window.removeEventListener("click",Mt,!0)},0)}function ai(d,a){const n=d.getBoundingClientRect();return qe(d,n,a)}function Oi(d,a){const n=d.getBoundingClientRect(),_=[];for(let c=0;c<a.length;c++)_.push(qe(d,n,a[c]));return _}function va(d){return window.InstallTrigger!==void 0&&d.button===2&&d.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:d.button}function qe(d,a,n){const _=d.offsetWidth===a.width?1:d.offsetWidth/a.width;return new s.P((n.clientX-a.left)*_,(n.clientY-a.top)*_)}class yo{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(a,n){this._updatedSourceCaches[a]=n,this.setDirty()}discardSourceCacheUpdate(a){delete this._updatedSourceCaches[a]}updateLayer(a){const n=a.scope;this._updatedLayers[n]=this._updatedLayers[n]||new Set,this._updatedLayers[n].add(a.id),this.setDirty()}removeLayer(a){const n=a.scope;this._removedLayers[n]=this._removedLayers[n]||{},this._updatedLayers[n]=this._updatedLayers[n]||new Set,this._removedLayers[n][a.id]=a,this._updatedLayers[n].delete(a.id),this._updatedPaintProps.delete(a.fqid),this.setDirty()}getRemovedLayer(a){return this._removedLayers[a.scope]?this._removedLayers[a.scope][a.id]:null}discardLayerRemoval(a){this._removedLayers[a.scope]&&delete this._removedLayers[a.scope][a.id]}getLayerUpdatesByScope(){const a={};for(const n in this._updatedLayers)a[n]=a[n]||{},a[n].updatedIds=Array.from(this._updatedLayers[n].values());for(const n in this._removedLayers)a[n]=a[n]||{},a[n].removedIds=Object.keys(this._removedLayers[n]);return a}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(a){this._updatedPaintProps.add(a.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(a){this._updatedImages.add(a),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}class En extends s.E{constructor(a){super(),this.requestManager=a,this.models={"":{}},this.numModelsLoading={}}loadModel(a,n){return s.l(this.requestManager.transformRequest(n,s.R.Model).url).then(_=>{if(!_)return;const c=s.c(_),f=new s.M(a,void 0,void 0,c);return f.computeBoundsAndApplyParent(),f}).catch(_=>{this.fire(new s.a(new Error(`Could not load model ${a} from ${n}: ${_.message}`)))})}load(a,n){this.models[n]||(this.models[n]={});const _=Object.keys(a);this.numModelsLoading[n]=(this.numModelsLoading[n]||0)+_.length;const c=[];for(const f of _)c.push(this.loadModel(f,a[f]));Promise.allSettled(c).then(f=>{for(let g=0;g<f.length;g++){const{status:b,value:v}=f[g];b==="fulfilled"&&v&&(this.models[n][_[g]]=v)}this.numModelsLoading[n]-=_.length,this.fire(new s.b("data",{dataType:"style"}))}).catch(f=>{this.fire(new s.a(new Error(`Could not load models: ${f.message}`)))})}isLoaded(){for(const a in this.numModelsLoading)if(this.numModelsLoading[a]>0)return!1;return!0}hasModel(a,n){return!!this.getModel(a,n)}getModel(a,n){return this.models[n]||(this.models[n]={}),this.models[n][a]}addModel(a,n,_){this.models[_]||(this.models[_]={}),this.hasModel(a,_)&&this.removeModel(a,_),this.load({[a]:this.requestManager.normalizeModelURL(n)},_)}addModels(a,n){const _={};for(const c in a)_[c]=this.requestManager.normalizeModelURL(a[c]);this.load(_,n)}removeModel(a,n){this.models[n]||(this.models[n]={});const _=this.models[n][a];delete this.models[n][a],_.destroy()}listModels(a){return this.models[a]||(this.models[a]={}),Object.keys(this.models[a])}upload(a,n){this.models[n]||(this.models[n]={});for(const _ in this.models[n])this.models[n][_].upload(a.context)}}class Ot{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(a,n,_){const c=String(n);if(this.stateChanges[a]=this.stateChanges[a]||{},this.stateChanges[a][c]=this.stateChanges[a][c]||{},s.e(this.stateChanges[a][c],_),this.deletedStates[a]===null){this.deletedStates[a]={};for(const f in this.state[a])f!==c&&(this.deletedStates[a][f]=null)}else if(this.deletedStates[a]&&this.deletedStates[a][c]===null){this.deletedStates[a][c]={};for(const f in this.state[a][c])_[f]||(this.deletedStates[a][c][f]=null)}else for(const f in _)this.deletedStates[a]&&this.deletedStates[a][c]&&this.deletedStates[a][c][f]===null&&delete this.deletedStates[a][c][f]}removeFeatureState(a,n,_){if(this.deletedStates[a]===null)return;const c=String(n);if(this.deletedStates[a]=this.deletedStates[a]||{},_&&n!==void 0)this.deletedStates[a][c]!==null&&(this.deletedStates[a][c]=this.deletedStates[a][c]||{},this.deletedStates[a][c][_]=null);else if(n!==void 0)if(this.stateChanges[a]&&this.stateChanges[a][c])for(_ in this.deletedStates[a][c]={},this.stateChanges[a][c])this.deletedStates[a][c][_]=null;else this.deletedStates[a][c]=null;else this.deletedStates[a]=null}getState(a,n){const _=String(n),c=s.e({},(this.state[a]||{})[_],(this.stateChanges[a]||{})[_]);if(this.deletedStates[a]===null)return{};if(this.deletedStates[a]){const f=this.deletedStates[a][n];if(f===null)return{};for(const g in f)delete c[g]}return c}initializeTileState(a,n){a.setFeatureState(this.state,n)}coalesceChanges(a,n){const _={};for(const c in this.stateChanges){this.state[c]=this.state[c]||{};const f={};for(const g in this.stateChanges[c])this.state[c][g]||(this.state[c][g]={}),s.e(this.state[c][g],this.stateChanges[c][g]),f[g]=this.state[c][g];_[c]=f}for(const c in this.deletedStates){this.state[c]=this.state[c]||{};const f={};if(this.deletedStates[c]===null)for(const g in this.state[c])f[g]={},this.state[c][g]={};else for(const g in this.deletedStates[c]){if(this.deletedStates[c][g]===null)this.state[c][g]={};else if(this.state[c][g])for(const b of Object.keys(this.deletedStates[c][g]))delete this.state[c][g][b];f[g]=this.state[c][g]}_[c]=_[c]||{},s.e(_[c],f)}if(this.stateChanges={},this.deletedStates={},Object.keys(_).length!==0)for(const c in a)a[c].setFeatureState(_,n)}}function na(d){const{userImage:a}=d;return!!(a&&a.render&&a.render())&&(d.data.replace(new Uint8Array(a.data.buffer)),!0)}class ka extends s.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(a){this.images[a]={},this.loaded[a]=!1,this.updatedImages[a]={},this.patterns[a]={},this.callbackDispatchedThisFrame[a]={},this.atlasImage[a]=new s.h({width:1,height:1})}isLoaded(){for(const a in this.loaded)if(!this.loaded[a])return!1;return!0}setLoaded(a,n){if(this.loaded[n]!==a&&(this.loaded[n]=a,a)){for(const{ids:_,callback:c}of this.requestors)this._notify(_,n,c);this.requestors=[]}}hasImage(a,n){return!!this.getImage(a,n)}getImage(a,n){return this.images[n][a]}addImage(a,n,_){this._validate(a,_)&&(this.images[n][a]=_)}_validate(a,n){let _=!0;return this._validateStretch(n.stretchX,n.data&&n.data.width)||(this.fire(new s.a(new Error(`Image "${a}" has invalid "stretchX" value`))),_=!1),this._validateStretch(n.stretchY,n.data&&n.data.height)||(this.fire(new s.a(new Error(`Image "${a}" has invalid "stretchY" value`))),_=!1),this._validateContent(n.content,n)||(this.fire(new s.a(new Error(`Image "${a}" has invalid "content" value`))),_=!1),_}_validateStretch(a,n){if(!a)return!0;let _=0;for(const c of a){if(c[0]<_||c[1]<c[0]||n<c[1])return!1;_=c[1]}return!0}_validateContent(a,n){return!(a&&(a.length!==4||a[0]<0||n.data.width<a[0]||a[1]<0||n.data.height<a[1]||a[2]<0||n.data.width<a[2]||a[3]<0||n.data.height<a[3]||a[2]<a[0]||a[3]<a[1]))}updateImage(a,n,_){_.version=this.images[n][a].version+1,this.images[n][a]=_,this.updatedImages[n][a]=!0}removeImage(a,n){const _=this.images[n][a];delete this.images[n][a],delete this.patterns[n][a],_.userImage&&_.userImage.onRemove&&_.userImage.onRemove()}listImages(a){return Object.keys(this.images[a])}getImages(a,n,_){let c=!0;const f=!!this.loaded[n];if(!f)for(const g of a)this.images[n][g]||(c=!1);f||c?this._notify(a,n,_):this.requestors.push({ids:a,scope:n,callback:_})}getUpdatedImages(a){return this.updatedImages[a]}_notify(a,n,_){const c={};for(const f of a){this.images[n][f]||this.fire(new s.b("styleimagemissing",{id:f}));const g=this.images[n][f];g?c[f]={data:g.data.clone(),pixelRatio:g.pixelRatio,sdf:g.sdf,version:g.version,stretchX:g.stretchX,stretchY:g.stretchY,content:g.content,hasRenderCallback:!!(g.userImage&&g.userImage.render)}:s.w(`Image "${f}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}_(null,c)}getPixelSize(a){const{width:n,height:_}=this.atlasImage[a];return{width:n,height:_}}getPattern(a,n){const _=this.patterns[n][a],c=this.getImage(a,n);if(!c)return null;if(_&&_.position.version===c.version)return _.position;if(_)_.position.version=c.version;else{const f={w:c.data.width+2,h:c.data.height+2,x:0,y:0},g=new s.I(f,c);this.patterns[n][a]={bin:f,position:g}}return this._updatePatternAtlas(n),this.patterns[n][a].position}bind(a,n){const _=a.gl;let c=this.atlasTexture[n];c?this.dirty&&(c.update(this.atlasImage[n]),this.dirty=!1):(c=new s.T(a,this.atlasImage[n],_.RGBA),this.atlasTexture[n]=c),c.bind(_.LINEAR,_.CLAMP_TO_EDGE)}_updatePatternAtlas(a){const n=[];for(const g in this.patterns[a])n.push(this.patterns[a][g].bin);const{w:_,h:c}=s.p(n),f=this.atlasImage[a];f.resize({width:_||1,height:c||1});for(const g in this.patterns[a]){const{bin:b}=this.patterns[a][g],v=b.x+1,A=b.y+1,O=this.images[a][g].data,R=O.width,P=O.height;s.h.copy(O,f,{x:0,y:0},{x:v,y:A},{width:R,height:P}),s.h.copy(O,f,{x:0,y:P-1},{x:v,y:A-1},{width:R,height:1}),s.h.copy(O,f,{x:0,y:0},{x:v,y:A+P},{width:R,height:1}),s.h.copy(O,f,{x:R-1,y:0},{x:v-1,y:A},{width:1,height:P}),s.h.copy(O,f,{x:0,y:0},{x:v+R,y:A},{width:1,height:P})}this.dirty=!0}beginFrame(){for(const a in this.images)this.callbackDispatchedThisFrame[a]={}}dispatchRenderCallbacks(a,n){for(const _ of a){if(this.callbackDispatchedThisFrame[n][_])continue;this.callbackDispatchedThisFrame[n][_]=!0;const c=this.images[n][_];na(c)&&this.updateImage(_,n,c)}}}class ot{constructor(a,n,_,c){this.message=(a?`${a}: `:"")+_,c&&(this.identifier=c),n!=null&&n.__line__&&(this.line=n.__line__)}}class Qa extends ot{}function Ea(d){const a=d.key,n=d.value,_=d.valueSpec||{},c=d.objectElementValidators||{},f=d.style,g=d.styleSpec;let b=[];const v=s.i(n);if(v!=="object")return[new ot(a,n,`object expected, ${v} found`)];for(const A in n){const O=A.split(".")[0];let R;c[O]?R=c[O]:_[O]?R=_a:c["*"]?R=c["*"]:_["*"]&&(R=_a),R?b=b.concat(R({key:(a&&`${a}.`)+A,value:n[A],valueSpec:_[O]||_["*"],style:f,styleSpec:g,object:n,objectKey:A},n)):b.push(new Qa(a,n[A],`unknown property "${A}"`))}for(const A in _)c[A]||_[A].required&&_[A].default===void 0&&n[A]===void 0&&b.push(new ot(a,n,`missing required property "${A}"`));return b}function Vt(d){const a=d.value,n=d.valueSpec,_=d.style,c=d.styleSpec,f=d.key,g=d.arrayElementValidator||_a;if(s.i(a)!=="array")return[new ot(f,a,`array expected, ${s.i(a)} found`)];if(n.length&&a.length!==n.length)return[new ot(f,a,`array length ${n.length} expected, length ${a.length} found`)];if(n["min-length"]&&a.length<n["min-length"])return[new ot(f,a,`array length at least ${n["min-length"]} expected, length ${a.length} found`)];let b={type:n.value,values:n.values,minimum:n.minimum,maximum:n.maximum,function:void 0};c.$version<7&&(b.function=n.function),s.i(n.value)==="object"&&(b=n.value);let v=[];for(let A=0;A<a.length;A++)v=v.concat(g({array:a,arrayIndex:A,value:a[A],valueSpec:b,style:_,styleSpec:c,key:`${f}[${A}]`},!0));return v}function Lo(d){const a=d.key,n=d.value,_=d.valueSpec;let c=s.i(n);if(c==="number"&&n!=n&&(c="NaN"),c!=="number")return[new ot(a,n,`number expected, ${c} found`)];if("minimum"in _){let f=_.minimum;if(s.i(_.minimum)==="array"&&(f=_.minimum[d.arrayIndex]),n<f)return[new ot(a,n,`${n} is less than the minimum value ${f}`)]}if("maximum"in _){let f=_.maximum;if(s.i(_.maximum)==="array"&&(f=_.maximum[d.arrayIndex]),n>f)return[new ot(a,n,`${n} is greater than the maximum value ${f}`)]}return[]}function Na(d){const a=d.valueSpec,n=s.u(d.value.type);let _,c,f,g={};const b=n!=="categorical"&&d.value.property===void 0,v=!b,A=s.i(d.value.stops)==="array"&&s.i(d.value.stops[0])==="array"&&s.i(d.value.stops[0][0])==="object",O=Ea({key:d.key,value:d.value,valueSpec:d.styleSpec.function,style:d.style,styleSpec:d.styleSpec,objectElementValidators:{stops:function(N){if(n==="identity")return[new ot(N.key,N.value,'identity function may not have a "stops" property')];let U=[];const B=N.value;return U=U.concat(Vt({key:N.key,value:B,valueSpec:N.valueSpec,style:N.style,styleSpec:N.styleSpec,arrayElementValidator:R})),s.i(B)==="array"&&B.length===0&&U.push(new ot(N.key,B,"array must have at least one stop")),U},default:function(N){return _a({key:N.key,value:N.value,valueSpec:a,style:N.style,styleSpec:N.styleSpec})}}});return n==="identity"&&b&&O.push(new ot(d.key,d.value,'missing required property "property"')),n==="identity"||d.value.stops||O.push(new ot(d.key,d.value,'missing required property "stops"')),n==="exponential"&&d.valueSpec.expression&&!s.s(d.valueSpec)&&O.push(new ot(d.key,d.value,"exponential functions not supported")),d.styleSpec.$version>=8&&(v&&!s.k(d.valueSpec)?O.push(new ot(d.key,d.value,"property functions not supported")):b&&!s.m(d.valueSpec)&&O.push(new ot(d.key,d.value,"zoom functions not supported"))),n!=="categorical"&&!A||d.value.property!==void 0||O.push(new ot(d.key,d.value,'"property" property is required')),O;function R(N){let U=[];const B=N.value,k=N.key;if(s.i(B)!=="array")return[new ot(k,B,`array expected, ${s.i(B)} found`)];if(B.length!==2)return[new ot(k,B,`array length 2 expected, length ${B.length} found`)];if(A){if(s.i(B[0])!=="object")return[new ot(k,B,`object expected, ${s.i(B[0])} found`)];if(B[0].zoom===void 0)return[new ot(k,B,"object stop key must have zoom")];if(B[0].value===void 0)return[new ot(k,B,"object stop key must have value")];const M=s.u(B[0].zoom);if(typeof M!="number")return[new ot(k,B[0].zoom,"stop zoom values must be numbers")];if(f&&f>M)return[new ot(k,B[0].zoom,"stop zoom values must appear in ascending order")];M!==f&&(f=M,c=void 0,g={}),U=U.concat(Ea({key:`${k}[0]`,value:B[0],valueSpec:{zoom:{}},style:N.style,styleSpec:N.styleSpec,objectElementValidators:{zoom:Lo,value:P}}))}else U=U.concat(P({key:`${k}[0]`,value:B[0],valueSpec:{},style:N.style,styleSpec:N.styleSpec},B));return s.n(s.o(B[1]))?U.concat([new ot(`${k}[1]`,B[1],"expressions are not allowed in function stops.")]):U.concat(_a({key:`${k}[1]`,value:B[1],valueSpec:a,style:N.style,styleSpec:N.styleSpec}))}function P(N,U){const B=s.i(N.value),k=s.u(N.value),M=N.value!==null?N.value:U;if(_){if(B!==_)return[new ot(N.key,M,`${B} stop domain type must match previous stop domain type ${_}`)]}else _=B;if(B!=="number"&&B!=="string"&&B!=="boolean"&&typeof k!="number"&&typeof k!="string"&&typeof k!="boolean")return[new ot(N.key,M,"stop domain value must be a number, string, or boolean")];if(B!=="number"&&n!=="categorical"){let H=`number expected, ${B} found`;return s.k(a)&&n===void 0&&(H+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ot(N.key,M,H)]}return n!=="categorical"||B!=="number"||typeof k=="number"&&isFinite(k)&&Math.floor(k)===k?n!=="categorical"&&B==="number"&&typeof k=="number"&&typeof c=="number"&&c!==void 0&&k<c?[new ot(N.key,M,"stop domain values must appear in ascending order")]:(c=k,n==="categorical"&&k in g?[new ot(N.key,M,"stop domain values must be unique")]:(g[k]=!0,[])):[new ot(N.key,M,`integer expected, found ${String(k)}`)]}}function No(d){const a=(d.expressionContext==="property"?s.q:s.r)(s.o(d.value),d.valueSpec);if(a.result==="error")return a.value.map(_=>new ot(`${d.key}${_.key}`,d.value,_.message));const n=a.value.expression||a.value._styleExpression.expression;if(d.expressionContext==="property"&&d.propertyKey==="text-font"&&!n.outputDefined())return[new ot(d.key,d.value,`Invalid data expression for "${d.propertyKey}". Output values must be contained as literals within the expression.`)];if(d.expressionContext==="property"&&d.propertyType==="layout"&&!s.t(n))return[new ot(d.key,d.value,'"feature-state" data expressions are not supported with layout properties.')];if(d.expressionContext==="filter")return za(n,d);if(d.expressionContext&&d.expressionContext.indexOf("cluster")===0){if(!s.v(n,["zoom","feature-state"]))return[new ot(d.key,d.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(d.expressionContext==="cluster-initial"&&!s.x(n))return[new ot(d.key,d.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function za(d,a){const n=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(a.valueSpec&&a.valueSpec.expression)for(const c of a.valueSpec.expression.parameters)n.delete(c);if(n.size===0)return[];const _=[];return d instanceof s.C&&n.has(d.name)?[new ot(a.key,a.value,`["${d.name}"] expression is not supported in a filter for a ${a.object.type} layer with id: ${a.object.id}`)]:(d.eachChild(c=>{_.push(...za(c,a))}),_)}function Zn(d){const a=d.key,n=d.value,_=d.valueSpec,c=[];return Array.isArray(_.values)?_.values.indexOf(s.u(n))===-1&&c.push(new ot(a,n,`expected one of [${_.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(_.values).indexOf(s.u(n))===-1&&c.push(new ot(a,n,`expected one of [${Object.keys(_.values).join(", ")}], ${JSON.stringify(n)} found`)),c}function Es(d){return s.z(s.o(d.value))?No(s.j({},d,{expressionContext:"filter",valueSpec:d.styleSpec[`filter_${d.layerType||"fill"}`]})):pl(d)}function pl(d){const a=d.value,n=d.key;if(s.i(a)!=="array")return[new ot(n,a,`array expected, ${s.i(a)} found`)];const _=d.styleSpec;let c,f=[];if(a.length<1)return[new ot(n,a,"filter array must have at least 1 element")];switch(f=f.concat(Zn({key:`${n}[0]`,value:a[0],valueSpec:_.filter_operator,style:d.style,styleSpec:d.styleSpec})),s.u(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&s.u(a[1])==="$type"&&f.push(new ot(n,a,`"$type" cannot be use with operator "${a[0]}"`));case"==":case"!=":a.length!==3&&f.push(new ot(n,a,`filter array for operator "${a[0]}" must have 3 elements`));case"in":case"!in":a.length>=2&&(c=s.i(a[1]),c!=="string"&&f.push(new ot(`${n}[1]`,a[1],`string expected, ${c} found`)));for(let g=2;g<a.length;g++)c=s.i(a[g]),s.u(a[1])==="$type"?f=f.concat(Zn({key:`${n}[${g}]`,value:a[g],valueSpec:_.geometry_type,style:d.style,styleSpec:d.styleSpec})):c!=="string"&&c!=="number"&&c!=="boolean"&&f.push(new ot(`${n}[${g}]`,a[g],`string, number, or boolean expected, ${c} found`));break;case"any":case"all":case"none":for(let g=1;g<a.length;g++)f=f.concat(pl({key:`${n}[${g}]`,value:a[g],style:d.style,styleSpec:d.styleSpec}));break;case"has":case"!has":c=s.i(a[1]),a.length!==2?f.push(new ot(n,a,`filter array for "${a[0]}" operator must have 2 elements`)):c!=="string"&&f.push(new ot(`${n}[1]`,a[1],`string expected, ${c} found`))}return f}function hl(d,a){const n=d.key,_=d.style,c=d.layer,f=d.styleSpec,g=d.value,b=d.objectKey,v=f[`${a}_${d.layerType}`];if(!v)return[];const A=b.match(/^(.*)-transition$/);if(a==="paint"&&A&&v[A[1]]&&v[A[1]].transition)return _a({key:n,value:g,valueSpec:f.transition,style:_,styleSpec:f});const O=d.valueSpec||v[b];if(!O)return[new Qa(n,g,`unknown property "${b}"`)];let R;if(s.i(g)==="string"&&s.k(O)&&!O.tokens&&(R=/^{([^}]+)}$/.exec(g))){const N=`\`{ "type": "identity", "property": ${R?JSON.stringify(R[1]):'"_"'} }\``;return[new ot(n,g,`"${b}" does not support interpolation syntax
Use an identity property function instead: ${N}.`)]}const P=[];if(d.layerType==="symbol")b!=="text-field"||!_||_.glyphs||_.imports||P.push(new ot(n,g,'use of "text-field" requires a style "glyphs" property')),b==="text-font"&&s.A(s.o(g))&&s.u(g.type)==="identity"&&P.push(new ot(n,g,'"text-font" does not support identity functions'));else if(d.layerType==="model"&&a==="paint"&&c&&c.layout&&c.layout.hasOwnProperty("model-id")&&s.k(O)&&(s.B(O)||s.m(O))){const N=s.q(s.o(g),O),U=N.value.expression||N.value._styleExpression.expression;U&&!s.v(U,["measure-light"])&&(b==="model-emissive-strength"&&s.x(U)&&s.t(U)||P.push(new ot(n,g,`${b} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return P.concat(_a({key:d.key,value:g,valueSpec:O,style:_,styleSpec:f,expressionContext:"property",propertyType:a,propertyKey:b}))}function gl(d){return hl(d,"paint")}function Xn(d){return hl(d,"layout")}function Qo(d){let a=[];const n=d.value,_=d.key,c=d.style,f=d.styleSpec;n.type||n.ref||a.push(new ot(_,n,'either "type" or "ref" is required'));let g=s.u(n.type);const b=s.u(n.ref);if(n.id){const v=s.u(n.id);for(let A=0;A<d.arrayIndex;A++){const O=c.layers[A];s.u(O.id)===v&&a.push(new ot(_,n.id,`duplicate layer id "${n.id}", previously used at line ${O.id.__line__}`))}}if("ref"in n){let v;["type","source","source-layer","filter","layout"].forEach(A=>{A in n&&a.push(new ot(_,n[A],`"${A}" is prohibited for ref layers`))}),c.layers.forEach(A=>{s.u(A.id)===b&&(v=A)}),v?v.ref?a.push(new ot(_,n.ref,"ref cannot reference another ref layer")):g=s.u(v.type):typeof b=="string"&&a.push(new ot(_,n.ref,`ref layer "${b}" not found`))}else if(g!=="background"&&g!=="sky"&&g!=="slot")if(n.source){const v=c.sources&&c.sources[n.source],A=v&&s.u(v.type);v?A==="vector"&&g==="raster"?a.push(new ot(_,n.source,`layer "${n.id}" requires a raster source`)):A==="raster"&&g!=="raster"?a.push(new ot(_,n.source,`layer "${n.id}" requires a vector source`)):A!=="vector"||n["source-layer"]?A==="raster-dem"&&g!=="hillshade"?a.push(new ot(_,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):A!=="raster-array"||["raster","raster-particle"].includes(g)?g!=="line"||!n.paint||!n.paint["line-gradient"]&&!n.paint["line-trim-offset"]||A==="geojson"&&v.lineMetrics?g==="raster-particle"&&A!=="raster-array"&&a.push(new ot(_,n.source,`layer "${n.id}" requires a 'raster-array' source.`)):a.push(new ot(_,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):a.push(new ot(_,n.source,"raster-array source can only be used with layer type 'raster'.")):a.push(new ot(_,n,`layer "${n.id}" must specify a "source-layer"`)):a.push(new ot(_,n.source,`source "${n.source}" not found`))}else a.push(new ot(_,n,'missing required property "source"'));return a=a.concat(Ea({key:_,value:n,valueSpec:f.layer,style:d.style,styleSpec:d.styleSpec,objectElementValidators:{"*":()=>[],type:()=>_a({key:`${_}.type`,value:n.type,valueSpec:f.layer.type,style:d.style,styleSpec:d.styleSpec,object:n,objectKey:"type"}),filter:v=>Es(s.j({layerType:g},v)),layout:v=>Ea({layer:n,key:v.key,value:v.value,valueSpec:{},style:v.style,styleSpec:v.styleSpec,objectElementValidators:{"*":A=>Xn(s.j({layerType:g},A))}}),paint:v=>Ea({layer:n,key:v.key,value:v.value,valueSpec:{},style:v.style,styleSpec:v.styleSpec,objectElementValidators:{"*":A=>gl(s.j({layerType:g,layer:n},A))}})}})),a}function Ha(d){const a=d.value,n=d.key,_=s.i(a);return _!=="string"?[new ot(n,a,`string expected, ${_} found`)]:[]}const bo={promoteId:function({key:d,value:a}){if(s.i(a)==="string")return Ha({key:d,value:a});{const n=[];for(const _ in a)n.push(...Ha({key:`${d}.${_}`,value:a[_]}));return n}}};function uo(d){const a=d.value,n=d.key,_=d.styleSpec,c=d.style;if(!a.type)return[new ot(n,a,'"type" is required')];const f=s.u(a.type);let g=[];switch(["vector","raster","raster-dem","raster-array"].includes(f)&&(a.url||a.tiles||g.push(new Qa(n,a,'Either "url" or "tiles" is required.'))),f){case"vector":case"raster":case"raster-dem":case"raster-array":return g=g.concat(Ea({key:n,value:a,valueSpec:_[`source_${f.replace("-","_")}`],style:d.style,styleSpec:_,objectElementValidators:bo})),g;case"geojson":if(g=Ea({key:n,value:a,valueSpec:_.source_geojson,style:c,styleSpec:_,objectElementValidators:bo}),a.cluster)for(const b in a.clusterProperties){const[v,A]=a.clusterProperties[b],O=typeof v=="string"?[v,["accumulated"],["get",b]]:v;g.push(...No({key:`${n}.${b}.map`,value:A,expressionContext:"cluster-map"})),g.push(...No({key:`${n}.${b}.reduce`,value:O,expressionContext:"cluster-reduce"}))}return g;case"video":return Ea({key:n,value:a,valueSpec:_.source_video,style:c,styleSpec:_});case"image":return Ea({key:n,value:a,valueSpec:_.source_image,style:c,styleSpec:_});case"canvas":return[new ot(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Zn({key:`${n}.type`,value:a.type,valueSpec:{values:yr(_)},style:c,styleSpec:_})}}function yr(d){return d.source.reduce((a,n)=>{const _=d[n];return _.type.type==="enum"&&(a=a.concat(Object.keys(_.type.values))),a},[])}function ta(d){const a=d.value;let n=[];if(!a)return n;const _=s.i(a);return _!=="string"?(n=n.concat([new ot(d.key,a,`string expected, "${_}" found`)]),n):(function(c){const f=c.indexOf("://")===-1;try{return new URL(c,f?"http://example.com":void 0),!0}catch{return!1}}(a)||(n=n.concat([new ot(d.key,a,`invalid url "${a}"`)])),n)}function To(d){const a=d.value,n=d.styleSpec,_=n.light,c=d.style;let f=[];const g=s.i(a);if(a===void 0)return f;if(g!=="object")return f=f.concat([new ot("light",a,`object expected, ${g} found`)]),f;for(const b in a){const v=b.match(/^(.*)-transition$/);f=f.concat(v&&_[v[1]]&&_[v[1]].transition?_a({key:b,value:a[b],valueSpec:n.transition,style:c,styleSpec:n}):_[b]?_a({key:b,value:a[b],valueSpec:_[b],style:c,styleSpec:n}):[new ot(b,a[b],`unknown property "${b}"`)])}return f}function Jn(d){const a=d.value;let n=[];if(!a)return n;const _=s.i(a);if(_!=="object")return n=n.concat([new ot("light-3d",a,`object expected, ${_} found`)]),n;const c=d.styleSpec,f=c["light-3d"],g=d.key,b=d.style,v=d.style.lights;for(const R of["type","id"])if(!(R in a))return n=n.concat([new ot("light-3d",a,`missing property ${R} on light`)]),n;if(a.type&&v)for(let R=0;R<d.arrayIndex;R++){const P=s.u(a.type),N=v[R];s.u(N.type)===P&&n.push(new ot(g,a.id,`duplicate light type "${a.type}", previously defined at line ${N.id.__line__}`))}const A=`properties_light_${a.type}`;if(!(A in c))return n=n.concat([new ot("light-3d",a,`Invalid light type ${a.type}`)]),n;const O=c[A];for(const R in a)if(R==="properties"){const P=a[R],N=s.i(P);if(N!=="object")return n=n.concat([new ot("properties",P,`object expected, ${N} found`)]),n;for(const U in P)n=n.concat(O[U]?_a({key:U,value:P[U],valueSpec:O[U],style:b,styleSpec:c}):[new Qa(d.key,P[U],`unknown property "${U}"`)])}else{const P=R.match(/^(.*)-transition$/);n=n.concat(P&&f[P[1]]&&f[P[1]].transition?_a({key:R,value:a[R],valueSpec:c.transition,style:b,styleSpec:c}):f[R]?_a({key:R,value:a[R],valueSpec:f[R],style:b,styleSpec:c}):[new Qa(R,a[R],`unknown property "${R}"`)])}return n}function en(d){const a=d.value,n=d.key,_=d.style,c=d.styleSpec,f=c.terrain;let g=[];const b=s.i(a);if(a===void 0||b==="null")return g;if(b!=="object")return g=g.concat([new ot("terrain",a,`object expected, ${b} found`)]),g;for(const v in a){const A=v.match(/^(.*)-transition$/);g=g.concat(A&&f[A[1]]&&f[A[1]].transition?_a({key:v,value:a[v],valueSpec:c.transition,style:_,styleSpec:c}):f[v]?_a({key:v,value:a[v],valueSpec:f[v],style:_,styleSpec:c}):[new Qa(v,a[v],`unknown property "${v}"`)])}if(a.source){const v=_.sources&&_.sources[a.source],A=v&&s.u(v.type);v?A!=="raster-dem"&&g.push(new ot(n,a.source,`terrain cannot be used with a source of type ${String(A)}, it only be used with a "raster-dem" source type`)):g.push(new ot(n,a.source,`source "${a.source}" not found`))}else g.push(new ot(n,a,'terrain is missing required property "source"'));return g}function Ko(d){const a=d.value,n=d.style,_=d.styleSpec,c=_.fog;let f=[];const g=s.i(a);if(a===void 0)return f;if(g!=="object")return f=f.concat([new ot("fog",a,`object expected, ${g} found`)]),f;for(const b in a){const v=b.match(/^(.*)-transition$/);f=f.concat(v&&c[v[1]]&&c[v[1]].transition?_a({key:b,value:a[b],valueSpec:_.transition,style:n,styleSpec:_}):c[b]?_a({key:b,value:a[b],valueSpec:c[b],style:n,styleSpec:_}):[new Qa(b,a[b],`unknown property "${b}"`)])}return f}const Qn={"*":()=>[],array:Vt,boolean:function(d){const a=d.value,n=d.key,_=s.i(a);return _!=="boolean"?[new ot(n,a,`boolean expected, ${_} found`)]:[]},number:Lo,color:function(d){const a=d.key,n=d.value,_=s.i(n);return _!=="string"?[new ot(a,n,`color expected, ${_} found`)]:s.y(n)===null?[new ot(a,n,`color expected, "${n}" found`)]:[]},enum:Zn,filter:Es,function:Na,layer:Qo,object:Ea,source:uo,model:ta,light:To,"light-3d":Jn,terrain:en,fog:Ko,string:Ha,formatted:function(d){return Ha(d).length===0?[]:No(d)},resolvedImage:function(d){return Ha(d).length===0?[]:No(d)},projection:function(d){const a=d.value,n=d.styleSpec,_=n.projection,c=d.style;let f=[];const g=s.i(a);if(g==="object")for(const b in a)f=f.concat(_a({key:b,value:a[b],valueSpec:_[b],style:c,styleSpec:n}));else g!=="string"&&(f=f.concat([new ot("projection",a,`object or string expected, ${g} found`)]));return f},import:function(d){const{value:a,styleSpec:n}=d,{data:_,...c}=a;Object.defineProperty(c,"__line__",{value:a.__line__,enumerable:!1});let f=Ea(s.j({},d,{value:c,valueSpec:n.import}));return s.u(c.id)===""&&f.push(new ot(`${d.key}.id`,c,"import id can't be an empty string")),_&&(f=f.concat(Is(_,n,{key:`${d.key}.data`}))),f}};function _a(d,a=!1){const n=d.value,_=d.valueSpec,c=d.styleSpec;if(_.expression&&s.A(s.u(n)))return Na(d);if(_.expression&&s.n(s.o(n)))return No(d);if(_.type&&Qn[_.type]){const f=Qn[_.type](d);return a===!0&&f.length>0&&s.i(d.value)==="array"?No(d):f}return Ea(s.j({},d,{valueSpec:_.type?c[_.type]:_}))}function As(d){const a=d.value,n=d.key,_=Ha(d);return _.length||(a.indexOf("{fontstack}")===-1&&_.push(new ot(n,a,'"glyphs" url must include a "{fontstack}" token')),a.indexOf("{range}")===-1&&_.push(new ot(n,a,'"glyphs" url must include a "{range}" token'))),_}function Is(d,a=s.D,n={}){return _a({key:n.key||"",value:d,valueSpec:a.$root,styleSpec:a,style:d,objectElementValidators:{glyphs:As,"*":()=>[]}})}function xo(d,a=s.D){return Pe(Is(d,a))}const tn=d=>Pe(uo(d)),An=d=>Pe(To(d)),Me=d=>Pe(Jn(d)),j=d=>Pe(en(d)),Q=d=>Pe(Ko(d)),de=d=>Pe(Qo(d)),we=d=>Pe(Es(d)),Fe=d=>Pe(gl(d)),Ge=d=>Pe(Xn(d)),gt=d=>Pe(ta(d));function Pe(d){return d.slice().sort((a,n)=>a.line&&n.line?a.line-n.line:0)}function Tt(d,a){let n=!1;if(a&&a.length)for(const _ of a)_ instanceof Qa?s.w(_.message):(d.fire(new s.a(new Error(_.message))),n=!0);return n}const ct=new s.F({anchor:new s.G(s.D.light.anchor),position:new s.H(s.D.light.position),color:new s.G(s.D.light.color),intensity:new s.G(s.D.light.intensity)});class vt extends s.E{constructor(a,n="flat"){super(),this._transitionable=new s.J(ct),this.setLight(a,n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(a,n,_={}){this._validate(An,a,_)||(this._transitionable.setTransitionOrValue(a),this.id=n)}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}_validate(a,n,_){return(!_||_.validate!==!1)&&Tt(this,a.call(xo,s.e({value:n,style:{glyphs:!0,sprite:!0},styleSpec:s.D})))}}const Xt=new s.F({source:new s.G(s.D.terrain.source),exaggeration:new s.G(s.D.terrain.exaggeration)});let Ci=class extends s.E{constructor(d,a,n,_){super(),this.scope=n,this._transitionable=new s.J(Xt,n,_),this._transitionable.setTransitionOrValue(d,_),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=a}get(){return this._transitionable.serialize()}set(d,a){this._transitionable.setTransitionOrValue(d,a)}updateTransitions(d){this._transitioning=this._transitionable.transitioned(d,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(d){this.properties=this._transitioning.possiblyEvaluate(d)}getExaggeration(d){return this._transitioning.possiblyEvaluate(new s.K(d)).get("exaggeration")}isZoomDependent(){const d=this._transitionable._values.exaggeration;return d!=null&&d.value!=null&&d.value.expression!=null&&d.value.expression instanceof s.Z}};const Hi=45,wi=65,Ai=.05;function Ti(d,a,n,_){const c=s.O(Hi,wi,n),[f,g]=Si(d,_);let b=1-Math.min(1,Math.exp((a-f)/(g-f)*-6));return b*=b*b,b=Math.min(1,1.00747*b),b*c*d.alpha}function Si(d,a){const n=.5/Math.tan(.5*a);return[d.range[0]+n,d.range[1]+n]}function Bi(d,a,n,_,c){const f=s.N.transformMat4([],[a,n,_],c.mercatorFogMatrix);return Ti(d,s.N.length(f),c.pitch,c._fov)}function Aa(d,a,n,_,c,f,g){const b=[[n,_,0],[c,_,0],[c,f,0],[n,f,0]];let v=Number.MAX_VALUE,A=-Number.MAX_VALUE;for(const O of b){const R=s.N.transformMat4([],O,a),P=s.N.length(R);v=Math.min(v,P),A=Math.max(A,P)}return[Ti(d,v,g.pitch,g._fov),Ti(d,A,g.pitch,g._fov)]}const zi=new s.F({range:new s.G(s.D.fog.range),color:new s.G(s.D.fog.color),"high-color":new s.G(s.D.fog["high-color"]),"space-color":new s.G(s.D.fog["space-color"]),"horizon-blend":new s.G(s.D.fog["horizon-blend"]),"star-intensity":new s.G(s.D.fog["star-intensity"]),"vertical-range":new s.G(s.D.fog["vertical-range"])});class Ka extends s.E{constructor(a,n,_,c){super(),this._transitionable=new s.J(zi,_,new Map(c)),this.set(a,c),this._transitioning=this._transitionable.untransitioned(),this._transform=n,this.properties=new s.Q(zi)}get state(){const a=this._transform,n=a.projection.name==="globe",_=s.S(a.zoom),c=this.properties.get("range"),f=[.5,3];return{range:n?[s.U(f[0],c[0],_),s.U(f[1],c[1],_)]:c,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(a,n,_={}){if(this._validate(Q,a,_))return;const c=s.e({},a);for(const f of Object.keys(s.D.fog))c[f]===void 0&&(c[f]=s.D.fog[f].default);this._options=c,this._transitionable.setTransitionOrValue(this._options,n)}getOpacity(a){if(!this._transform.projection.supportsFog)return 0;const n=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:s.O(Hi,wi,a))*n.a}getOpacityAtLatLng(a,n){return this._transform.projection.supportsFog?function(_,c,f){const g=s.L.fromLngLat(c),b=f.elevation?f.elevation.getAtPointOrZero(g):0;return Bi(_,g.x,g.y,b,f)}(this.state,a,n):0}getOpacityForTile(a){if(!this._transform.projection.supportsFog)return[1,1];const n=this._transform.calculateFogTileMatrix(a.toUnwrapped());return Aa(this.state,n,0,0,s.V,s.V,this._transform)}getOpacityForBounds(a,n,_,c,f){return this._transform.projection.supportsFog?Aa(this.state,a,n,_,c,f,this._transform):[1,1]}getFovAdjustedRange(a){return this._transform.projection.supportsFog?Si(this.state,a):[0,1]}isVisibleOnFrustum(a){if(!this._transform.projection.supportsFog)return!1;const n=[4,5,6,7];for(const _ of n){const c=a.points[_];let f;if(c[2]>=0)f=c;else{const g=a.points[_-4];f=s.W(g,c,g[2]/(g[2]-c[2]))}if(Bi(this.state,f[0],f[1],0,this._transform)>=Ai)return!0}return!1}updateConfig(a){this._transitionable.setTransitionOrValue(this._options,new Map(a))}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}_validate(a,n,_){return(!_||_.validate!==!1)&&Tt(this,a.call(xo,s.e({value:n,style:{glyphs:!0,sprite:!0},styleSpec:s.D})))}}class Ga extends s.E{constructor(a,n,_,c){super(),this.scope=_,this._options=a,this.properties=new s.Q(n),this._transitionable=new s.J(n,_,new Map(c)),this._transitionable.setTransitionOrValue(a.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(a){this._transitionable.setTransitionOrValue(this._options.properties,new Map(a))}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(a,n){this._options=a,this._transitionable.setTransitionOrValue(a.properties,n)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}const eo=new s.F({color:new s.G(s.D.properties_light_ambient.color),intensity:new s.G(s.D.properties_light_ambient.intensity)}),fa=new s.F({direction:new s.X(s.D.properties_light_directional.direction),color:new s.G(s.D.properties_light_directional.color),intensity:new s.G(s.D.properties_light_directional.intensity),"cast-shadows":new s.G(s.D.properties_light_directional["cast-shadows"]),"shadow-intensity":new s.G(s.D.properties_light_directional["shadow-intensity"])});class ua{constructor(a,n,_,c){this.screenBounds=a,this.cameraPoint=n,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=_,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,c)}static createFromScreenPoints(a,n){let _,c;if(a instanceof s.P||typeof a[0]=="number"){const f=s.P.convert(a);_=[f],c=n.isPointAboveHorizon(f)}else{const f=s.P.convert(a[0]),g=s.P.convert(a[1]);_=[f,g],c=s.Y(f,g).every(b=>n.isPointAboveHorizon(b))}return new ua(_,n.getCameraPoint(),c,n)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(a){return s.Y(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],a)}bufferedCameraGeometry(a){const n=this.screenBounds[0],_=this.screenBounds.length===1?this.screenBounds[0].add(new s.P(1,1)):this.screenBounds[1],c=s.Y(n,_,0,!1);return this.cameraPoint.y>_.y&&(this.cameraPoint.x>n.x&&this.cameraPoint.x<_.x?c.splice(3,0,this.cameraPoint):this.cameraPoint.x>=_.x?c[2]=this.cameraPoint:this.cameraPoint.x<=n.x&&(c[3]=this.cameraPoint)),s._(c,a)}bufferedCameraGeometryGlobe(a){const n=this.screenBounds[0],_=this.screenBounds.length===1?this.screenBounds[0].add(new s.P(1,1)):this.screenBounds[1],c=s.Y(n,_,a),f=this.cameraPoint.clone();switch(3*((f.y>n.y)+(f.y>_.y))+((f.x>n.x)+(f.x>_.x))){case 0:c[0]=f,c[4]=f.clone();break;case 1:c.splice(1,0,f);break;case 2:c[1]=f;break;case 3:c.splice(4,0,f);break;case 5:c.splice(2,0,f);break;case 6:c[3]=f;break;case 7:c.splice(3,0,f);break;case 8:c[2]=f}return c}containsTile(a,n,_,c=0){const f=a.queryPadding/n._pixelsPerMercatorPixel+1,g=_?this._bufferedCameraMercator(f,n):this._bufferedScreenMercator(f,n);let b=a.tileID.wrap+(g.unwrapped?c:0);const v=g.polygon.map(k=>s.$(a.tileTransform,k,b));if(!s.a0(v,0,0,s.V,s.V))return;b=a.tileID.wrap+(this.screenGeometryMercator.unwrapped?c:0);const A=this.screenGeometryMercator.polygon.map(k=>s.a1(a.tileTransform,k,b)),O=A.map(k=>new s.P(k[0],k[1])),R=n.getFreeCameraOptions().position||new s.L(0,0,0),P=s.a1(a.tileTransform,R,b),N=A.map(k=>{const M=s.N.sub(k,k,P);return s.N.normalize(M,M),new s.a2(P,M)}),U=s.a3(a,1,n.zoom)*n._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:O,tilespaceRays:N,bufferedTilespaceGeometry:v,bufferedTilespaceBounds:(B=s.a4(v),B.min.x=s.aa(B.min.x,0,s.V),B.min.y=s.aa(B.min.y,0,s.V),B.max.x=s.aa(B.max.x,0,s.V),B.max.y=s.aa(B.max.y,0,s.V),B),tile:a,tileID:a.tileID,pixelToTileUnitsFactor:U};var B}_bufferedScreenMercator(a,n){const _=Ve(a);if(this._screenRaycastCache[_])return this._screenRaycastCache[_];{let c;return c=n.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(a),n):{polygon:this.bufferedScreenGeometry(a).map(f=>n.pointCoordinate3D(f)),unwrapped:!0},this._screenRaycastCache[_]=c,c}}_bufferedCameraMercator(a,n){const _=Ve(a);if(this._cameraRaycastCache[_])return this._cameraRaycastCache[_];{let c;return c=n.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(a),n):{polygon:this.bufferedCameraGeometry(a).map(f=>n.pointCoordinate3D(f)),unwrapped:!0},this._cameraRaycastCache[_]=c,c}}_projectAndResample(a,n){const _=function(f,g){const b=s.a6.multiply([],g.pixelMatrix,g.globeMatrix),v=[0,-s.ab,0,1],A=[0,s.ab,0,1],O=[0,0,0,1];s.a7.transformMat4(v,v,b),s.a7.transformMat4(A,A,b),s.a7.transformMat4(O,O,b);const R=new s.P(v[0]/v[3],v[1]/v[3]),P=new s.P(A[0]/A[3],A[1]/A[3]),N=s.a8(f,R)&&v[3]<O[3],U=s.a8(f,P)&&A[3]<O[3];if(!N&&!U)return null;const B=function(X,ie,ne){for(let re=1;re<X.length;re++){const ye=Le(ie.pointCoordinate3D(X[re-1]).x),ue=Le(ie.pointCoordinate3D(X[re]).x);if(ne<0){if(ye<ue)return{idx:re,t:-ye/(ue-1-ye)}}else if(ue<ye)return{idx:re,t:(1-ye)/(ue+1-ye)}}return null}(f,g,N?-1:1);if(!B)return null;const{idx:k,t:M}=B;let H=k>1?Re(f.slice(0,k),g):[],$=k<f.length?Re(f.slice(k),g):[];H=H.map(X=>new s.P(Le(X.x),X.y)),$=$.map(X=>new s.P(Le(X.x),X.y));const V=[...H];V.length===0&&V.push($[$.length-1]);const Z=s.U(V[V.length-1].y,($.length===0?H[0]:$[0]).y,M);let z;return z=N?[new s.P(0,Z),new s.P(0,0),new s.P(1,0),new s.P(1,Z)]:[new s.P(1,Z),new s.P(1,1),new s.P(0,1),new s.P(0,Z)],V.push(...z),$.length===0?V.push(H[0]):V.push(...$),{polygon:V.map(X=>new s.L(X.x,X.y)),unwrapped:!1}}(a,n);if(_)return _;const c=function(f,g){let b=!1,v=-1/0,A=0;for(let R=0;R<f.length-1;R++)f[R].x>v&&(v=f[R].x,A=R);for(let R=0;R<f.length-1;R++){const P=(A+R)%(f.length-1),N=f[P],U=f[P+1];Math.abs(N.x-U.x)>.5&&(N.x<U.x?(N.x+=1,P===0&&(f[f.length-1].x+=1)):(U.x+=1,P+1===f.length-1&&(f[0].x+=1)),b=!0)}const O=s.a5(g.center.lng);return b&&O<Math.abs(O-1)&&f.forEach(R=>{R.x-=1}),{polygon:f,unwrapped:b}}(Re(a,n).map(f=>new s.P(Le(f.x),f.y)),n);return{polygon:c.polygon.map(f=>new s.L(f.x,f.y)),unwrapped:c.unwrapped}}}function Re(d,a){return s.a9(d,n=>{const _=a.pointCoordinate3D(n);n.x=_.x,n.y=_.y},1/256)}function Le(d){return d<0?1+d%1:d%1}function Ve(d){return 100*d|0}function et(d,a,n,_,c){const f=function(g,b){if(g)return c(g);if(b){d.url&&b.tiles&&d.tiles&&delete d.tiles;const v=s.ac(s.e(b,d),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);b.vector_layers&&(v.vectorLayers=b.vector_layers,v.vectorLayerIds=v.vectorLayers.map(A=>A.id)),b.raster_layers&&(v.rasterLayers=b.raster_layers,v.rasterLayerIds=v.rasterLayers.map(A=>A.id)),v.tiles=a.canonicalizeTileset(v,d.url),c(null,v)}};return d.url?s.g(a.transformRequest(a.normalizeSourceURL(d.url,null,n,_),s.R.Source),f):s.f.frame(()=>f(null,d))}class Ze{constructor(a,n,_){this.bounds=s.ad.convert(this.validateBounds(a)),this.minzoom=n||0,this.maxzoom=_||24}validateBounds(a){return Array.isArray(a)&&a.length===4?[Math.max(-180,a[0]),Math.max(-90,a[1]),Math.min(180,a[2]),Math.min(90,a[3])]:[-180,-90,180,90]}contains(a){const n=Math.pow(2,a.z),_=Math.floor(s.a5(this.bounds.getWest())*n),c=Math.floor(s.ae(this.bounds.getNorth())*n),f=Math.ceil(s.a5(this.bounds.getEast())*n),g=Math.ceil(s.ae(this.bounds.getSouth())*n);return a.x>=_&&a.x<f&&a.y>=c&&a.y<g}}class at extends s.E{constructor(a,n,_,c){if(super(),this.id=a,this.dispatcher=_,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.e(this,s.ac(n,["url","scheme","tileSize","promoteId"])),this._options=s.e({type:"vector"},n),this._collectResourceTiming=!!n.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(c),this._tileWorkers={},this._deduped=new s.af}load(a){this._loaded=!1,this.fire(new s.b("dataloading",{dataType:"source"}));const n=Array.isArray(this.map._language)?this.map._language.join():this.map._language,_=this.map._worldview;this._tileJSONRequest=et(this._options,this.map._requestManager,n,_,(c,f)=>{this._tileJSONRequest=null,this._loaded=!0,c?(n&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${n}`),_&&_.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${_}`),this.fire(new s.a(c))):f&&(s.e(this,f),f.bounds&&(this.tileBounds=new Ze(f.bounds,this.minzoom,this.maxzoom)),s.aj(f.tiles,this.map._requestManager._customAccessToken),this.fire(new s.b("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.b("data",{dataType:"source",sourceDataType:"content"}))),a&&a(c)})}loaded(){return this._loaded}hasTile(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)}onAdd(a){this.map=a,this.load()}reload(){this.cancelTileJSONRequest();const a=s.ag(this.id,this.scope);this.load(()=>this.map.style.clearSource(a))}setTiles(a){return this._options.tiles=a,this.reload(),this}setUrl(a){return this.url=a,this._options.url=a,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.e({},this._options)}loadTile(a,n){const _=this.map._requestManager.normalizeTileURL(a.tileID.canonical.url(this.tiles,this.scheme)),c={request:this.map._requestManager.transformRequest(_,s.R.Tile),data:void 0,uid:a.uid,tileID:a.tileID,tileZoom:a.tileZoom,zoom:a.tileID.overscaledZ,tileSize:this.tileSize*a.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:s.f.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:a.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:a.isExtraShadowCaster};if(c.request.collectResourceTiming=this._collectResourceTiming,a.actor&&a.state!=="expired")a.state==="loading"?a.reloadCallback=n:a.request=a.actor.send("reloadTile",c,f.bind(this));else if(a.actor=this._tileWorkers[_]=this._tileWorkers[_]||this.dispatcher.getActor(),this.dispatcher.ready)a.request=a.actor.send("loadTile",c,f.bind(this),void 0,!0);else{const g=s.ah.call({deduped:this._deduped},c,(b,v)=>{b||!v?f.call(this,b):(c.data={cacheControl:v.cacheControl,expires:v.expires,rawData:v.rawData.slice(0)},a.actor&&a.actor.send("loadTile",c,f.bind(this),void 0,!0))},!0);a.request={cancel:g}}function f(g,b){return delete a.request,a.aborted?n(null):g&&g.status!==404?n(g):(b&&b.resourceTiming&&(a.resourceTiming=b.resourceTiming),this.map._refreshExpiredTiles&&b&&a.setExpiryData(b),a.loadVectorData(b,this.map.painter),s.ai(this.dispatcher),n(null),void(a.reloadCallback&&(this.loadTile(a,a.reloadCallback),a.reloadCallback=null)))}}abortTile(a){a.request&&(a.request.cancel(),delete a.request),a.actor&&a.actor.send("abortTile",{uid:a.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(a){a.actor&&a.actor.send("removeTile",{uid:a.uid,type:this.type,source:this.id,scope:this.scope}),a.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class nt extends s.E{constructor(a,n,_,c){super(),this.id=a,this.dispatcher=_,this.setEventedParent(c),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.e({type:"raster"},n),s.e(this,s.ac(n,["url","scheme","tileSize"]))}load(a){this._loaded=!1,this.fire(new s.b("dataloading",{dataType:"source"})),this._tileJSONRequest=et(this._options,this.map._requestManager,null,null,(n,_)=>{this._tileJSONRequest=null,this._loaded=!0,n?this.fire(new s.a(n)):_&&(s.e(this,_),_.bounds&&(this.tileBounds=new Ze(_.bounds,this.minzoom,this.maxzoom)),s.aj(_.tiles),this.fire(new s.b("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.b("data",{dataType:"source",sourceDataType:"content"}))),a&&a(n)})}loaded(){return this._loaded}onAdd(a){this.map=a,this.load()}reload(){this.cancelTileJSONRequest();const a=s.ag(this.id,this.scope);this.load(()=>this.map.style.clearSource(a))}setTiles(a){return this._options.tiles=a,this.reload(),this}setUrl(a){return this.url=a,this._options.url=a,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.e({},this._options)}hasTile(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)}loadTile(a,n){const _=s.f.devicePixelRatio>=2,c=this.map._requestManager.normalizeTileURL(a.tileID.canonical.url(this.tiles,this.scheme),_,this.tileSize);a.request=s.d(this.map._requestManager.transformRequest(c,s.R.Tile),(f,g,b,v)=>(delete a.request,a.aborted?(a.state="unloaded",n(null)):f?(a.state="errored",n(f)):g?(this.map._refreshExpiredTiles&&a.setExpiryData({cacheControl:b,expires:v}),a.setTexture(g,this.map.painter),a.state="loaded",s.ai(this.dispatcher),void n(null)):n(null)))}abortTile(a,n){a.request&&(a.request.cancel(),delete a.request),n()}unloadTile(a,n){a.texture&&a.texture instanceof s.T?(a.destroy(!0),a.texture&&a.texture instanceof s.T&&this.map.painter.saveTileTexture(a.texture)):a.destroy(),n()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Je extends nt{constructor(a,n,_,c){super(a,n,_,c),this.type="raster-array",this.maxzoom=22,this._options=s.e({type:"raster-array"},n)}triggerRepaint(a){const n=this.map.painter._terrain,_=this.map.style.getSourceCache(this.id);n&&n.enabled&&_&&n._clearRenderCacheForTile(_.id,a.tileID),this.map.triggerRepaint()}loadTile(a,n){const _=this.map._requestManager.normalizeTileURL(a.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),c=this.map._requestManager.transformRequest(_,s.R.Tile);a.requestParams=c,a.actor||(a.actor=this.dispatcher.getActor()),a.request=a.fetchHeader(void 0,(f,g,b,v)=>{if(delete a.request,a.aborted)return a.state="unloaded",n(null);if(f)return f.code===20?void 0:(a.state="errored",n(f));this.map._refreshExpiredTiles&&a.setExpiryData({cacheControl:b,expires:v}),a.state="empty",n(null)})}unloadTile(a){const n=a.texture;n&&n instanceof s.T?(a.destroy(!0),this.map.painter.saveTileTexture(n)):(a.destroy(),a.flushQueues(),a._isHeaderLoaded=!1,delete a._mrt,delete a.textureDescriptor),a.fbo&&(a.fbo.destroy(),delete a.fbo),delete a.request,delete a.requestParams,delete a.neighboringTiles,a.state="unloaded"}prepareTile(a,n,_){a._isHeaderLoaded&&(a.state!=="empty"&&(a.state="reloading"),a.fetchBand(n,_,(c,f)=>{if(c)return a.state="errored",this.fire(new s.a(c)),void this.triggerRepaint(a);f&&(a.setTexture(f,this.map.painter),a.state="loaded",this.triggerRepaint(a))}))}getInitialBand(a){if(!this.rasterLayers)return 0;const n=this.rasterLayers.find(({id:f})=>f===a),_=n&&n.fields,c=_&&_.bands&&_.bands;return c?c[0]:0}getTextureDescriptor(a,n,_){if(!a)return;const c=n.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!c)return;let f=null;n instanceof s.an?f=n.paint.get("raster-array-band"):n instanceof s.ao&&(f=n.paint.get("raster-particle-array-band"));const g=f||this.getInitialBand(c);if(g!=null)if(a.textureDescriptor){if(!a.updateNeeded(c,g)||_)return Object.assign({},a.textureDescriptor,{texture:a.texture})}else this.prepareTile(a,c,g)}}const rt=32,tt=33,Dt=new Uint16Array(8184);for(let d=0;d<2046;d++){let a=d+2,n=0,_=0,c=0,f=0,g=0,b=0;for(1&a?c=f=g=rt:n=_=b=rt;(a>>=1)>1;){const A=n+c>>1,O=_+f>>1;1&a?(c=n,f=_,n=g,_=b):(n=c,_=f,c=g,f=b),g=A,b=O}const v=4*d;Dt[v+0]=n,Dt[v+1]=_,Dt[v+2]=c,Dt[v+3]=f}const ni=new Uint16Array(2178),It=new Uint8Array(1089),Pi=new Uint16Array(1089);function Vi(d){return d===0?-.03125:d===32?.03125:0}class Mi{constructor(a,n,_,c){this.id=Mi.uniqueIdxCounter,Mi.uniqueIdxCounter++,this.context=a;const f=a.gl;this.buffer=f.createBuffer(),this.dynamicDraw=!!_,this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||c||n.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(a){this.id=Mi.uniqueIdxCounter,Mi.uniqueIdxCounter++;const n=this.context.gl;this.context.unbindVAO(),this.bind(),n.bufferSubData(n.ELEMENT_ARRAY_BUFFER,0,a.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Mi.uniqueIdxCounter=0;const pa={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Wa{constructor(a,n,_,c,f,g){this.length=n.length,this.attributes=_,this.itemSize=n.bytesPerElement,this.dynamicDraw=c,this.instanceCount=g,this.context=a;const b=a.gl;this.buffer=b.createBuffer(),a.bindVertexBuffer.set(this.buffer),b.bufferData(b.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||f||n.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(a){const n=this.context.gl;this.bind(),n.bufferSubData(n.ARRAY_BUFFER,0,a.arrayBuffer)}enableAttributes(a,n){for(let _=0;_<this.attributes.length;_++){const c=n.attributes[this.attributes[_].name];c!==void 0&&a.enableVertexAttribArray(c)}}setVertexAttribPointers(a,n,_){for(let c=0;c<this.attributes.length;c++){const f=this.attributes[c],g=n.attributes[f.name];g!==void 0&&a.vertexAttribPointer(g,f.components,a[pa[f.type]],!1,this.itemSize,f.offset+this.itemSize*(_||0))}}setVertexAttribDivisor(a,n,_){for(let c=0;c<this.attributes.length;c++){const f=n.attributes[this.attributes[c].name];f!==void 0&&this.instanceCount&&this.instanceCount>0&&a.vertexAttribDivisor(f,_)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class yi{constructor(a){this.gl=a.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(a){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class co extends yi{getDefault(){return s.ax.transparent}set(a){const n=this.current;(a.r!==n.r||a.g!==n.g||a.b!==n.b||a.a!==n.a||this.dirty)&&(this.gl.clearColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)}}class Wo extends yi{getDefault(){return 1}set(a){(a!==this.current||this.dirty)&&(this.gl.clearDepth(a),this.current=a,this.dirty=!1)}}class Ma extends yi{getDefault(){return 0}set(a){(a!==this.current||this.dirty)&&(this.gl.clearStencil(a),this.current=a,this.dirty=!1)}}class yl extends yi{getDefault(){return[!0,!0,!0,!0]}set(a){const n=this.current;(a[0]!==n[0]||a[1]!==n[1]||a[2]!==n[2]||a[3]!==n[3]||this.dirty)&&(this.gl.colorMask(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class In extends yi{getDefault(){return!0}set(a){(a!==this.current||this.dirty)&&(this.gl.depthMask(a),this.current=a,this.dirty=!1)}}class Os extends yi{getDefault(){return 255}set(a){(a!==this.current||this.dirty)&&(this.gl.stencilMask(a),this.current=a,this.dirty=!1)}}class Wd extends yi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(a){const n=this.current;(a.func!==n.func||a.ref!==n.ref||a.mask!==n.mask||this.dirty)&&(this.gl.stencilFunc(a.func,a.ref,a.mask),this.current=a,this.dirty=!1)}}class es extends yi{getDefault(){const a=this.gl;return[a.KEEP,a.KEEP,a.KEEP]}set(a){const n=this.current;(a[0]!==n[0]||a[1]!==n[1]||a[2]!==n[2]||this.dirty)&&(this.gl.stencilOp(a[0],a[1],a[2]),this.current=a,this.dirty=!1)}}class Md extends yi{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const n=this.gl;a?n.enable(n.STENCIL_TEST):n.disable(n.STENCIL_TEST),this.current=a,this.dirty=!1}}class Ss extends yi{getDefault(){return[0,1]}set(a){const n=this.current;(a[0]!==n[0]||a[1]!==n[1]||this.dirty)&&(this.gl.depthRange(a[0],a[1]),this.current=a,this.dirty=!1)}}class Vu extends yi{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const n=this.gl;a?n.enable(n.DEPTH_TEST):n.disable(n.DEPTH_TEST),this.current=a,this.dirty=!1}}class br extends yi{getDefault(){return this.gl.LESS}set(a){(a!==this.current||this.dirty)&&(this.gl.depthFunc(a),this.current=a,this.dirty=!1)}}class Dd extends yi{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const n=this.gl;a?n.enable(n.BLEND):n.disable(n.BLEND),this.current=a,this.dirty=!1}}class Tr extends yi{getDefault(){const a=this.gl;return[a.ONE,a.ZERO,a.ONE,a.ZERO]}set(a){const n=this.current;(a[0]!==n[0]||a[1]!==n[1]||a[2]!==n[2]||a[3]!==n[3]||this.dirty)&&(this.gl.blendFuncSeparate(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class Fd extends yi{getDefault(){return s.ax.transparent}set(a){const n=this.current;(a.r!==n.r||a.g!==n.g||a.b!==n.b||a.a!==n.a||this.dirty)&&(this.gl.blendColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)}}class to extends yi{getDefault(){return this.gl.FUNC_ADD}set(a){(a!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(a,a),this.current=a,this.dirty=!1)}}class ca extends yi{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const n=this.gl;a?n.enable(n.CULL_FACE):n.disable(n.CULL_FACE),this.current=a,this.dirty=!1}}class si extends yi{getDefault(){return this.gl.BACK}set(a){(a!==this.current||this.dirty)&&(this.gl.cullFace(a),this.current=a,this.dirty=!1)}}class ju extends yi{getDefault(){return this.gl.CCW}set(a){(a!==this.current||this.dirty)&&(this.gl.frontFace(a),this.current=a,this.dirty=!1)}}let xr=class extends yi{getDefault(){return null}set(d){(d!==this.current||this.dirty)&&(this.gl.useProgram(d),this.current=d,this.dirty=!1)}};class Bd extends yi{getDefault(){return this.gl.TEXTURE0}set(a){(a!==this.current||this.dirty)&&(this.gl.activeTexture(a),this.current=a,this.dirty=!1)}}class df extends yi{getDefault(){const a=this.gl;return[0,0,a.drawingBufferWidth,a.drawingBufferHeight]}set(a){const n=this.current;(a[0]!==n[0]||a[1]!==n[1]||a[2]!==n[2]||a[3]!==n[3]||this.dirty)&&(this.gl.viewport(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class qo extends yi{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const n=this.gl;n.bindFramebuffer(n.FRAMEBUFFER,a),this.current=a,this.dirty=!1}}class Ud extends yi{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const n=this.gl;n.bindRenderbuffer(n.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class _f extends yi{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const n=this.gl;n.bindTexture(n.TEXTURE_2D,a),this.current=a,this.dirty=!1}}class Rs extends yi{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const n=this.gl;n.bindBuffer(n.ARRAY_BUFFER,a),this.current=a,this.dirty=!1}}class _t extends yi{getDefault(){return null}set(a){const n=this.gl;n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,a),this.current=a,this.dirty=!1}}class xi extends yi{getDefault(){return null}set(a){this.gl&&(a!==this.current||this.dirty)&&(this.gl.bindVertexArray(a),this.current=a,this.dirty=!1)}}class vi extends yi{getDefault(){return 4}set(a){if(a===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_ALIGNMENT,a),this.current=a,this.dirty=!1}}class vo extends yi{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a),this.current=a,this.dirty=!1}}class Cs extends yi{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,a),this.current=a,this.dirty=!1}}class ui extends yi{constructor(a,n){super(a),this.context=a,this.parent=n}getDefault(){return null}}class vr extends ui{setDirty(){this.dirty=!0}set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,a,0),this.current=a,this.dirty=!1}}class ws extends ui{attachment(){return this.gl.DEPTH_ATTACHMENT}set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,this.attachment(),n.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class bl extends ui{attachment(){return this.gl.DEPTH_ATTACHMENT}set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferTexture2D(n.FRAMEBUFFER,this.attachment(),n.TEXTURE_2D,a,0),this.current=a,this.dirty=!1}}class io extends ws{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class la{constructor(a,n,_,c,f){this.context=a,this.width=n,this.height=_;const g=this.framebuffer=a.gl.createFramebuffer();c&&(this.colorAttachment=new vr(a,g)),f&&(this.depthAttachmentType=f,this.depthAttachment=f==="renderbuffer"?new ws(a,g):new bl(a,g))}destroy(){const a=this.context.gl;if(this.colorAttachment){const n=this.colorAttachment.get();n&&a.deleteTexture(n)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const n=this.depthAttachment.get();n&&a.deleteRenderbuffer(n)}else{const n=this.depthAttachment.get();n&&a.deleteTexture(n)}a.deleteFramebuffer(this.framebuffer)}}class wt{constructor(a,n,_){this.func=a,this.mask=n,this.range=_}}wt.ReadOnly=!1,wt.ReadWrite=!0,wt.disabled=new wt(519,wt.ReadOnly,[0,1]);const ts=7680;class Bt{constructor(a,n,_,c,f,g){this.test=a,this.ref=n,this.mask=_,this.fail=c,this.depthFail=f,this.pass=g}}Bt.disabled=new Bt({func:519,mask:0},0,0,ts,ts,ts);const On=771;class Jt{constructor(a,n,_,c){this.blendFunction=a,this.blendColor=n,this.mask=_,this.blendEquation=c}}Jt.Replace=[1,0,1,0],Jt.disabled=new Jt(Jt.Replace,s.ax.transparent,[!1,!1,!1,!1]),Jt.unblended=new Jt(Jt.Replace,s.ax.transparent,[!0,!0,!0,!0]),Jt.alphaBlended=new Jt([1,On,1,On],s.ax.transparent,[!0,!0,!0,!0]),Jt.multiply=new Jt([774,0,774,0],s.ax.transparent,[!0,!0,!0,!0]);const Ps=1029,Da=2305;class Pt{constructor(a,n,_){this.enable=a,this.mode=n,this.frontFace=_}}Pt.disabled=new Pt(!1,Ps,Da),Pt.backCCW=new Pt(!0,Ps,Da),Pt.backCW=new Pt(!0,Ps,2304),Pt.frontCW=new Pt(!0,1028,2304),Pt.frontCCW=new Pt(!0,1028,Da);class Ku{constructor(a,n){this.gl=a,this.clearColor=new co(this),this.clearDepth=new Wo(this),this.clearStencil=new Ma(this),this.colorMask=new yl(this),this.depthMask=new In(this),this.stencilMask=new Os(this),this.stencilFunc=new Wd(this),this.stencilOp=new es(this),this.stencilTest=new Md(this),this.depthRange=new Ss(this),this.depthTest=new Vu(this),this.depthFunc=new br(this),this.blend=new Dd(this),this.blendFunc=new Tr(this),this.blendColor=new Fd(this),this.blendEquation=new to(this),this.cullFace=new ca(this),this.cullFaceSide=new si(this),this.frontFace=new ju(this),this.program=new xr(this),this.activeTexture=new Bd(this),this.viewport=new df(this),this.bindFramebuffer=new qo(this),this.bindRenderbuffer=new Ud(this),this.bindTexture=new _f(this),this.bindVertexBuffer=new Rs(this),this.bindElementBuffer=new _t(this),this.bindVertexArrayOES=new xi(this),this.pixelStoreUnpack=new vi(this),this.pixelStoreUnpackPremultiplyAlpha=new vo(this),this.pixelStoreUnpackFlipY=new Cs(this),this.options=n?{...n}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=a.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=a.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=a.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=a.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=a.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=a.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE),this.maxPointSize=a.getParameter(a.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(a,n,_){return new Mi(this,a,n,_)}createVertexBuffer(a,n,_,c,f){return new Wa(this,a,n,_,c,f)}createRenderbuffer(a,n,_){const c=this.gl,f=c.createRenderbuffer();return this.bindRenderbuffer.set(f),c.renderbufferStorage(c.RENDERBUFFER,a,n,_),this.bindRenderbuffer.set(null),f}createFramebuffer(a,n,_,c){return new la(this,a,n,_,c)}clear({color:a,depth:n,stencil:_,colorMask:c}){const f=this.gl;let g=0;a&&(g|=f.COLOR_BUFFER_BIT,this.clearColor.set(a),this.colorMask.set(c||[!0,!0,!0,!0])),n!==void 0&&(g|=f.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),_!==void 0&&(g|=f.STENCIL_BUFFER_BIT,this.clearStencil.set(_),this.stencilMask.set(255)),f.clear(g)}setCullFace(a){a.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(a.mode),this.frontFace.set(a.frontFace))}setDepthMode(a){a.func!==this.gl.ALWAYS||a.mask?(this.depthTest.set(!0),this.depthFunc.set(a.func),this.depthMask.set(a.mask),this.depthRange.set(a.range)):this.depthTest.set(!1)}setStencilMode(a){a.test.func!==this.gl.ALWAYS||a.mask?(this.stencilTest.set(!0),this.stencilMask.set(a.mask),this.stencilOp.set([a.fail,a.depthFail,a.pass]),this.stencilFunc.set({func:a.test.func,ref:a.ref,mask:a.test.mask})):this.stencilTest.set(!1)}setColorMode(a){oe(a.blendFunction,Jt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(a.blendFunction),this.blendColor.set(a.blendColor),a.blendEquation?this.blendEquation.set(a.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(a.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}var is=s.ay([{name:"a_pos",type:"Float32",components:3}]);class ha{constructor(a,n,_,c){const f={width:_[0],height:_[1],data:null},g=a.gl;this.targetColorTexture=new s.T(a,f,g.RGBA,{useMipmap:!1}),this.backgroundColorTexture=new s.T(a,f,g.RGBA,{useMipmap:!1}),this.context=a,this.setNumParticles(n,c),this.lastInvalidatedAt=0}setNumParticles(a,n){if(this.numParticles===n)return;(this.particleVertices0||this.particleVertices1||this.particleSegment)&&(this.particleVertices0.destroy(),this.particleVertices1.destroy(),this.particleSegment.destroy());const _=new s.az;_.reserve(Math.round(n));const c=s.aA(a.key);for(let f=0;f<n;f++)_.emplaceBack(c(),c(),c());this.particleVertices0=this.context.createVertexBuffer(_,is.members,!0),this.particleVertices1=this.context.createVertexBuffer(_,is.members,!0),this.particleSegment=s.aB.simpleSegment(0,0,this.particleVertices0.length,0),this.numParticles=n}update(a){return!(this.lastInvalidatedAt<a&&(this.lastInvalidatedAt=s.f.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleVertices0.destroy(),this.particleVertices1.destroy(),this.particleSegment.destroy()}}const Eo={type:2,extent:s.V,loadGeometry:()=>[[new s.P(0,0),new s.P(s.V+1,0),new s.P(s.V+1,s.V+1),new s.P(0,s.V+1),new s.P(0,0)]]};class Sn{constructor(a,n,_,c,f){this.tileID=a,this.uid=s.aC(),this.uses=0,this.tileSize=n,this.tileZoom=_,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=f,c&&c.style&&(this._lastUpdatedBrightness=c.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",c&&c.transform&&(this.projection=c.transform.projection)}registerFadeDuration(a){const n=a+this.timeAdded;n<s.f.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=s.as(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(a,n,_){if(this.unloadVectorData(),this.state="loaded",a){a.featureIndex&&(this.latestFeatureIndex=a.featureIndex,a.rawTileData?(this.latestRawTileData=a.rawTileData,this.latestFeatureIndex.rawTileData=a.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=a.collisionBoxArray,this.buckets=function(c,f){const g={};if(!f)return g;for(const b of c){const v=b.layerIds.map(A=>f.getLayer(A)).filter(Boolean);if(v.length!==0){b.layers=v,b.stateDependentLayerIds&&(b.stateDependentLayers=b.stateDependentLayerIds.map(A=>v.filter(O=>O.id===A)[0]));for(const A of v)g[A.fqid]=b}}return g}(a.buckets,n.style),this.hasSymbolBuckets=!1;for(const c in this.buckets){const f=this.buckets[c];if(f instanceof s.aE){if(this.hasSymbolBuckets=!0,!_)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const c in this.buckets){const f=this.buckets[c];if(f instanceof s.aE&&f.hasRTLText){this.hasRTLText=!0,s.aF();break}}this.queryPadding=0;for(const c in this.buckets){const f=this.buckets[c],g=n.style.getOwnLayer(c);if(!g)continue;const b=g.queryRadius(f);this.queryPadding=Math.max(this.queryPadding,b)}a.imageAtlas&&(this.imageAtlas=a.imageAtlas),a.glyphAtlasImage&&(this.glyphAtlasImage=a.glyphAtlasImage),a.lineAtlas&&(this.lineAtlas=a.lineAtlas),this._lastUpdatedBrightness=a.brightness}else this.collisionBoxArray=new s.aD}unloadVectorData(){if(this.hasData()){for(const a in this.buckets)this.buckets[a].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(a){return this.buckets[a.fqid]}upload(a){for(const c in this.buckets){const f=this.buckets[c];f.uploadPending()&&f.upload(a)}const n=a.gl,_=this.imageAtlas;if(_&&!_.uploaded){const c=!!Object.keys(_.patternPositions).length;this.imageAtlasTexture=new s.T(a,_.image,n.RGBA,{useMipmap:c}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new s.T(a,this.glyphAtlasImage,n.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new s.T(a,this.lineAtlas.image,n.R8),this.lineAtlas.uploaded=!0)}prepare(a,n,_){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(a,this.imageAtlasTexture,_),!n||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const c=n.style.getBrightness();(this._lastUpdatedBrightness||c)&&(this._lastUpdatedBrightness&&c&&Math.abs(this._lastUpdatedBrightness-c)<.001||(this._lastUpdatedBrightness=c,this.updateBuckets(void 0,n)))}queryRenderedFeatures(a,n,_,c,f,g,b,v){return this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)?this.latestFeatureIndex.query({tileResult:c,pixelPosMatrix:b,transform:g,params:f,tileTransform:this.tileTransform},a,n,_):{}}querySourceFeatures(a,n){const _=this.latestFeatureIndex;if(!_||!_.rawTileData)return;const c=_.loadVTLayers(),f=n?n.sourceLayer:"",g=c._geojsonTileLayer||c[f];if(!g)return;const b=s.aG(n&&n.filter),{z:v,x:A,y:O}=this.tileID.canonical,R={z:v,x:A,y:O};for(let P=0;P<g.length;P++){const N=g.feature(P);if(b.needGeometry){const k=s.aH(N,!0);if(!b.filter(new s.K(this.tileID.overscaledZ),k,this.tileID.canonical))continue}else if(!b.filter(new s.K(this.tileID.overscaledZ),N))continue;const U=_.getId(N,f),B=new s.aI(N,v,A,O,U);B.tile=R,a.push(B)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}bucketsLoaded(){for(const a in this.buckets)if(this.buckets[a].uploadPending())return!1;return!0}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(a){const n=this.expirationTime;if(a.cacheControl){const _=s.aJ(a.cacheControl);_["max-age"]&&(this.expirationTime=Date.now()+1e3*_["max-age"])}else a.expires&&(this.expirationTime=new Date(a.expires).getTime());if(this.expirationTime){const _=Date.now();let c=!1;if(this.expirationTime>_)c=!1;else if(n)if(this.expirationTime<n)c=!0;else{const f=this.expirationTime-n;f?this.expirationTime=_+Math.max(f,3e4):c=!0}else c=!0;c?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(a,n){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(a).length!==0&&n&&this.updateBuckets(a,n)}updateBuckets(a,n){if(!this.latestFeatureIndex)return;const _=this.latestFeatureIndex.loadVTLayers(),c=n.style.listImages(),f=n.style.getBrightness();for(const g in this.buckets){if(!n.style.hasLayer(g))continue;const b=this.buckets[g],v=b.layers[0].sourceLayer||"_geojsonTileLayer",A=_[v];let O={};if(a&&(O=a[v],!A||!O||Object.keys(O).length===0))continue;if(b.update(O,A,c,this.imageAtlas&&this.imageAtlas.patternPositions||{},f),b instanceof s.aK||b instanceof s.aL){const P=n.style.getOwnSourceCache(b.layers[0].source);n._terrain&&n._terrain.enabled&&P&&b.programConfigurations.needsUpload&&n._terrain._clearRenderCacheForTile(P.id,this.tileID)}const R=n&&n.style&&n.style.getOwnLayer(g);R&&(this.queryPadding=Math.max(this.queryPadding,R.queryRadius(b)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<s.f.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(a){this.symbolFadeHoldUntil=s.f.now()+a}setTexture(a,n){const _=n.context,c=_.gl;this.texture=this.texture||n.getTileTexture(a.width),this.texture&&this.texture instanceof s.T?this.texture.update(a,{useMipmap:!0}):(this.texture=new s.T(_,a,c.RGBA,{useMipmap:!0}),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE))}setDependencies(a,n){const _={};for(const c of n)_[c]=!0;this.dependencies[a]=_}hasDependency(a,n){for(const _ of a){const c=this.dependencies[_];if(c){for(const f of n)if(c[f])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(a,n){if(!n||n.name==="mercator"||this._tileDebugBuffer)return;const _=s.aM(Eo,this.tileID.canonical,this.tileTransform)[0],c=new s.aN,f=new s.aO;for(let g=0;g<_.length;g++){const{x:b,y:v}=_[g];c.emplaceBack(b,v),f.emplaceBack(g)}f.emplaceBack(0),this._tileDebugIndexBuffer=a.createIndexBuffer(f),this._tileDebugBuffer=a.createVertexBuffer(c,s.aP.members),this._tileDebugSegments=s.aB.simpleSegment(0,0,c.length,f.length)}_makeTileBoundsBuffers(a,n){if(this._tileBoundsBuffer||!n||n.name==="mercator")return;const _=s.aM(Eo,this.tileID.canonical,this.tileTransform)[0];let c,f;if(this.isRaster){const g=function(b,v){const A=s.as(b,v),O=Math.pow(2,b.z);for(let k=0;k<tt;k++)for(let M=0;M<tt;M++){const H=s.at((b.x+(M+Vi(M))/rt)/O),$=s.au((b.y+(k+Vi(k))/rt)/O),V=v.project(H,$),Z=k*tt+M;ni[2*Z+0]=Math.round((V.x*A.scale-A.x)*s.V),ni[2*Z+1]=Math.round((V.y*A.scale-A.y)*s.V)}It.fill(0),Pi.fill(0);for(let k=2045;k>=0;k--){const M=4*k,H=Dt[M+0],$=Dt[M+1],V=Dt[M+2],Z=Dt[M+3],z=H+V>>1,X=$+Z>>1,ie=z+X-$,ne=X+H-z,re=$*tt+H,ye=Z*tt+V,ue=X*tt+z,Ie=Math.hypot((ni[2*re+0]+ni[2*ye+0])/2-ni[2*ue+0],(ni[2*re+1]+ni[2*ye+1])/2-ni[2*ue+1])>=16;It[ue]=It[ue]||(Ie?1:0),k<1022&&(It[ue]=It[ue]||It[($+ne>>1)*tt+(H+ie>>1)]||It[(Z+ne>>1)*tt+(V+ie>>1)])}const R=new s.av,P=new s.aw;let N=0;function U(k,M){const H=M*tt+k;return Pi[H]===0&&(R.emplaceBack(ni[2*H+0],ni[2*H+1],k*s.V/rt,M*s.V/rt),Pi[H]=++N),Pi[H]-1}function B(k,M,H,$,V,Z){const z=k+H>>1,X=M+$>>1;if(Math.abs(k-V)+Math.abs(M-Z)>1&&It[X*tt+z])B(V,Z,k,M,z,X),B(H,$,V,Z,z,X);else{const ie=U(k,M),ne=U(H,$),re=U(V,Z);P.emplaceBack(ie,ne,re)}}return B(0,0,rt,rt,rt,0),B(rt,rt,0,0,0,rt),{vertices:R,indices:P}}(this.tileID.canonical,n);c=g.vertices,f=g.indices}else{c=new s.av,f=new s.aw;for(const{x:b,y:v}of _)c.emplaceBack(b,v,0,0);const g=s.aQ(c.int16,void 0,4);for(let b=0;b<g.length;b+=3)f.emplaceBack(g[b],g[b+1],g[b+2])}this._tileBoundsBuffer=a.createVertexBuffer(c,s.aR.members),this._tileBoundsIndexBuffer=a.createIndexBuffer(f),this._tileBoundsSegments=s.aB.simpleSegment(0,0,c.length,f.length)}_makeGlobeTileDebugBuffers(a,n){const _=n.projection;if(!_||_.name!=="globe"||n.freezeTileCoverage)return;const c=this.tileID.canonical,f=s.aS(c,n),g=s.aT(f),b=s.S(n.zoom);let v;b>0&&(v=s.a6.invert(new Float64Array(16),n.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(a,c,n,g,v,b),this._makeGlobeTileDebugTextBuffer(a,c,n,g,v,b)}_globePoint(a,n,_,c,f,g,b){let v=s.aU(a,n,_);if(g){const A=1<<_.z,O=s.a5(c.center.lng),R=s.ae(c.center.lat),P=(_.x+.5)/A-O;let N=0;P>.5?N=-1:P<-.5&&(N=1);let U=(a/s.V+_.x)/A+N,B=(n/s.V+_.y)/A;U=(U-O)*c._pixelsPerMercatorPixel+O,B=(B-R)*c._pixelsPerMercatorPixel+R;const k=[U*c.worldSize,B*c.worldSize,0];s.N.transformMat4(k,k,g),v=s.aV(v,k,b)}return s.N.transformMat4(v,v,f)}_makeGlobeTileDebugBorderBuffer(a,n,_,c,f,g){const b=new s.aN,v=new s.aO,A=new s.aW,O=(P,N,U,B,k)=>{const M=(U-P)/(k-1),H=(B-N)/(k-1),$=b.length;for(let V=0;V<k;V++){const Z=P+V*M,z=N+V*H;b.emplaceBack(Z,z);const X=this._globePoint(Z,z,n,_,c,f,g);A.emplaceBack(X[0],X[1],X[2]),v.emplaceBack($+V)}},R=s.V;O(0,0,R,0,16),O(R,0,R,R,16),O(R,R,0,R,16),O(0,R,0,0,16),this._tileDebugIndexBuffer=a.createIndexBuffer(v),this._tileDebugBuffer=a.createVertexBuffer(b,s.aP.members),this._globeTileDebugBorderBuffer=a.createVertexBuffer(A,s.aX.members),this._tileDebugSegments=s.aB.simpleSegment(0,0,b.length,v.length)}_makeGlobeTileDebugTextBuffer(a,n,_,c,f,g){const b=s.V/4,v=new s.aN,A=new s.aw,O=new s.aW,R=25;A.reserve(32),v.reserve(R),O.reserve(R);const P=(N,U)=>R*N+U;for(let N=0;N<R;N++){const U=N*b;for(let B=0;B<R;B++){const k=B*b;v.emplaceBack(k,U);const M=this._globePoint(k,U,n,_,c,f,g);O.emplaceBack(M[0],M[1],M[2])}}for(let N=0;N<4;N++)for(let U=0;U<4;U++){const B=P(N,U),k=P(N,U+1),M=P(N+1,U),H=P(N+1,U+1);A.emplaceBack(B,k,M),A.emplaceBack(M,k,H)}this._tileDebugTextIndexBuffer=a.createIndexBuffer(A),this._tileDebugTextBuffer=a.createVertexBuffer(v,s.aP.members),this._globeTileDebugTextBuffer=a.createVertexBuffer(O,s.aX.members),this._tileDebugTextSegments=s.aB.simpleSegment(0,0,R,32)}destroy(a=!1){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!a&&this.texture&&this.texture instanceof s.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}const an={vector:at,raster:nt,"raster-dem":class extends nt{constructor(d,a,n,_){super(d,a,n,_),this.type="raster-dem",this.maxzoom=22,this._options=s.e({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox"}loadTile(d,a){const n=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function _(c,f){c&&(d.state="errored",a(c)),f&&(d.dem=f,d.dem.onDeserialize(),d.needsHillshadePrepare=!0,d.needsDEMTextureUpload=!0,d.state="loaded",a(null))}d.request=s.d(this.map._requestManager.transformRequest(n,s.R.Tile),(function(c,f,g,b){if(delete d.request,d.aborted)d.state="unloaded",a(null);else if(c)d.state="errored",a(c);else if(f){this.map._refreshExpiredTiles&&d.setExpiryData({cacheControl:g,expires:b});const v=ImageBitmap&&f instanceof ImageBitmap&&s.ak(),A=1-(f.width-s.al(f.width))/2;A<1||d.neighboringTiles||(d.neighboringTiles=this._getNeighboringTiles(d.tileID));const O=v?f:s.f.getImageData(f,A),R={uid:d.uid,coord:d.tileID,source:this.id,scope:this.scope,rawImageData:O,encoding:this.encoding,padding:A};d.actor&&d.state!=="expired"||(d.actor=this.dispatcher.getActor(),d.actor.send("loadDEMTile",R,_.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(d){const a=d.canonical,n=Math.pow(2,a.z),_=(a.x-1+n)%n,c=a.x===0?d.wrap-1:d.wrap,f=(a.x+1+n)%n,g=a.x+1===n?d.wrap+1:d.wrap,b={};return b[new s.am(d.overscaledZ,c,a.z,_,a.y).key]={backfilled:!1},b[new s.am(d.overscaledZ,g,a.z,f,a.y).key]={backfilled:!1},a.y>0&&(b[new s.am(d.overscaledZ,c,a.z,_,a.y-1).key]={backfilled:!1},b[new s.am(d.overscaledZ,d.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},b[new s.am(d.overscaledZ,g,a.z,f,a.y-1).key]={backfilled:!1}),a.y+1<n&&(b[new s.am(d.overscaledZ,c,a.z,_,a.y+1).key]={backfilled:!1},b[new s.am(d.overscaledZ,d.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},b[new s.am(d.overscaledZ,g,a.z,f,a.y+1).key]={backfilled:!1}),b}},"raster-array":Je,geojson:class extends s.E{constructor(d,a,n,_){super(),this.id=d,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=n.getActor(),this.setEventedParent(_),this._data=a.data,this._options=s.e({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId;const c=s.V/this.tileSize;this.workerOptions=s.e({source:this.id,scope:this.scope,cluster:a.cluster||!1,geojsonVtOptions:{buffer:(a.buffer!==void 0?a.buffer:128)*c,tolerance:(a.tolerance!==void 0?a.tolerance:.375)*c,extent:s.V,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:a.clusterMaxZoom!==void 0?a.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,a.clusterMinPoints||2),extent:s.V,radius:(a.clusterRadius!==void 0?a.clusterRadius:50)*c,log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions)}onAdd(d){this.map=d,this.setData(this._data)}setData(d){return this._data=d,this._updateWorkerData(),this}getClusterExpansionZoom(d,a){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:d,source:this.id,scope:this.scope},a),this}getClusterChildren(d,a){return this.actor.send("geojson.getClusterChildren",{clusterId:d,source:this.id,scope:this.scope},a),this}getClusterLeaves(d,a,n,_){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:d,limit:a,offset:n},_),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.b("dataloading",{dataType:"source"})),this._loaded=!1;const d=s.e({},this.workerOptions);d.scope=this.scope;const a=this._data;typeof a=="string"?(d.request=this.map._requestManager.transformRequest(s.f.resolveURL(a),s.R.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(a),this._pendingLoad=this.actor.send(`${this.type}.loadData`,d,(n,_)=>{if(this._loaded=!0,this._pendingLoad=null,n)this.fire(new s.a(n));else{const c={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&_&&_.resourceTiming&&_.resourceTiming[this.id]&&(c.resourceTiming=_.resourceTiming[this.id]),this.fire(new s.b("data",c)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(d,a){const n=d.actor?"reloadTile":"loadTile";d.actor=this.actor;const _={type:this.type,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,scope:this.scope,pixelRatio:s.f.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0};d.request=this.actor.send(n,_,(c,f)=>(delete d.request,d.destroy(),d.aborted?a(null):c?a(c):(d.loadVectorData(f,this.map.painter,n==="reloadTile"),a(null))),void 0,n==="loadTile")}abortTile(d){d.request&&(d.request.cancel(),delete d.request),d.aborted=!0}unloadTile(d){this.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id,scope:this.scope}),d.destroy()}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return s.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends s.ap{constructor(d,a,n,_){super(d,a,n,_),this.roundZoom=!0,this.type="video",this.options=a}load(){this._loaded=!1;const d=this.options;this.urls=[];for(const a of d.urls)this.urls.push(this.map._requestManager.transformRequest(a,s.R.Source).url);s.aq(this.urls,(a,n)=>{this._loaded=!0,a?this.fire(new s.a(a)):n&&(this.video=n,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(d){if(this.video){const a=this.video.seekable;d<a.start(0)||d>a.end(0)?this.fire(new s.a(new ot(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=d}}getVideo(){return this.video}onAdd(d){this.map||(this.map=d,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const d=this.map.painter.context,a=d.gl;this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new s.T(d,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(d)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:s.ap,model:class extends s.E{constructor(d,a,n,_){super(),this.id=d,this.type="model",this.models=[],this._loaded=!1,this._options=a}load(){const d=[];for(const a in this._options.models){const n=this._options.models[a],_=s.l(this.map._requestManager.transformRequest(n.uri,s.R.Model).url).then(c=>{if(!c)return;const f=s.c(c),g=new s.M(a,n.position,n.orientation,f);g.computeBoundsAndApplyParent(),this.models.push(g)}).catch(c=>{this.fire(new s.a(new Error(`Could not load model ${a} from ${n.uri}: ${c.message}`)))});d.push(_)}return Promise.allSettled(d).then(()=>{this._loaded=!0,this.fire(new s.b("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(a=>{this.fire(new s.a(new Error(`Could not load models: ${a.message}`)))})}onAdd(d){this.map=d,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(d,a){}serialize(){return{type:"model"}}},"batched-model":class extends s.E{constructor(d,a,n,_){super(),this.type="batched-model",this.id=d,this.tileSize=512,this._options=a,this.tiles=this._options.tiles,this.maxzoom=a.maxzoom||19,this.minzoom=a.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=n,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(_)}onAdd(d){this.map=d,this.load()}load(d){this._loaded=!1,this.fire(new s.b("dataloading",{dataType:"source"}));const a=Array.isArray(this.map._language)?this.map._language.join():this.map._language,n=this.map._worldview;this._tileJSONRequest=et(this._options,this.map._requestManager,a,n,(_,c)=>{this._tileJSONRequest=null,this._loaded=!0,_?(a&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${a}`),n&&n.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${n}`),this.fire(new s.a(_))):c&&(s.e(this,c),c.bounds&&(this.tileBounds=new Ze(c.bounds,this.minzoom,this.maxzoom)),s.aj(c.tiles,this.map._requestManager._customAccessToken),this.fire(new s.b("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.b("data",{dataType:"source",sourceDataType:"content"}))),d&&d(_)})}hasTransition(){return!1}hasTile(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)}loaded(){return this._loaded}loadTile(d,a){const n=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme)),_={request:this.map._requestManager.transformRequest(n,s.R.Tile),data:void 0,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,tileSize:this.tileSize*d.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:d.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(d.actor&&d.state!=="expired")if(d.state==="loading")d.reloadCallback=a;else{if(d.buckets){const f=Object.values(d.buckets);for(const g of f)g.dirty=!0;return void(d.state="loaded")}d.request=d.actor.send("reloadTile",_,c.bind(this))}else d.actor=this.dispatcher.getActor(),d.request=d.actor.send("loadTile",_,c.bind(this),void 0,!0);function c(f,g){return d.aborted?a(null):f&&f.status!==404?a(f):(g&&(g.resourceTiming&&(d.resourceTiming=g.resourceTiming),this.map._refreshExpiredTiles&&d.setExpiryData(g),d.buckets={...d.buckets,...g.buckets},g.featureIndex&&(d.latestFeatureIndex=g.featureIndex)),d.state="loaded",void a(null))}}serialize(){return s.e({},this._options)}},canvas:class extends s.ap{constructor(d,a,n,_){super(d,a,n,_),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some(c=>!Array.isArray(c)||c.length!==2||c.some(f=>typeof f!="number"))||this.fire(new s.a(new ot(`sources.${d}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.a(new ot(`sources.${d}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new s.a(new ot(`sources.${d}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new s.a(new ot(`sources.${d}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.a(new ot(`sources.${d}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.a(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(d){this.map=d,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let d=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,d=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,d=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context;this.texture?!d&&!this._playing||this.texture instanceof s.ar||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.T(a,this.canvas,a.gl.RGBA,{premultiply:!0}),this._prepareData(a)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const d of[this.canvas.width,this.canvas.height])if(isNaN(d)||d<=0)return!0;return!1}},custom:class extends s.E{constructor(d,a,n,_){super(),this.id=d,this.type="custom",this._dataType="raster",this._dispatcher=n,this._implementation=a,this.setEventedParent(_),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new s.a(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new s.a(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Ze(this._implementation.bounds,this.minzoom,this.maxzoom)),a.update=this._update.bind(this),a.clearTiles=this._clearTiles.bind(this),a.coveringTiles=this._coveringTiles.bind(this),s.e(this,s.ac(a,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return s.ac(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new s.b("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.b("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(d){this._map=d,this._loaded=!1,this.fire(new s.b("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(d),this.load()}onRemove(d){this._implementation.onRemove&&this._implementation.onRemove(d)}hasTile(d){if(this._implementation.hasTile){const{x:a,y:n,z:_}=d.canonical;return this._implementation.hasTile({x:a,y:n,z:_})}return!this.tileBounds||this.tileBounds.contains(d.canonical)}loadTile(d,a){const{x:n,y:_,z:c}=d.tileID.canonical,f=new AbortController;d.request=Promise.resolve(this._implementation.loadTile({x:n,y:_,z:c},{signal:f.signal})).then((function(g){return delete d.request,d.aborted?(d.state="unloaded",a(null)):g===void 0?(d.state="errored",a(null)):g===null?(this.loadTileData(d,{width:this.tileSize,height:this.tileSize,data:null}),d.state="loaded",a(null)):function(b){return b instanceof ImageData||b instanceof HTMLCanvasElement||b instanceof ImageBitmap||b instanceof HTMLImageElement}(g)?(this.loadTileData(d,g),d.state="loaded",void a(null)):(d.state="errored",a(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(g=>{g.code!==20&&(d.state="errored",a(g))}),d.request.cancel=()=>f.abort()}loadTileData(d,a){d.setTexture(a,this._map.painter)}unloadTile(d,a){if(d.texture&&d.texture instanceof s.T?(d.destroy(!0),d.texture&&d.texture instanceof s.T&&this._map.painter.saveTileTexture(d.texture)):d.destroy(),this._implementation.unloadTile){const{x:n,y:_,z:c}=d.tileID.canonical;this._implementation.unloadTile({x:n,y:_,z:c})}a()}abortTile(d,a){d.request&&d.request.cancel&&(d.request.cancel(),delete d.request),a()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(d=>({x:d.canonical.x,y:d.canonical.y,z:d.canonical.z}))}_clearTiles(){const d=s.ag(this.id,this.scope);this._map.style.clearSource(d)}_update(){this.fire(new s.b("data",{dataType:"source",sourceDataType:"content"}))}}},ga=function(d,a,n,_){const c=new an[a.type](d,a,n,_);if(c.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${c.id}`);return s.aY(["load","abort","unload","serialize","prepare"],c),c};function kd(d,a){const n=s.a6.identity([]);return s.a6.scale(n,n,[.5*d.width,.5*-d.height,1]),s.a6.translate(n,n,[1,-1,0]),s.a6.multiply(n,n,d.calculateProjMatrix(a.toUnwrapped())),Float32Array.from(n)}function zd(d,a,n,_,c,f,g,b=!1){const v=d.tilesIn(_,g,b);v.sort(Ls);const A=[];for(const R of v)A.push({wrappedTileID:R.tile.tileID.wrapped().key,queryResults:R.tile.queryRenderedFeatures(a,n,d._state,R,c,f,kd(d.transform,R.tile.tileID),b)});const O=function(R){const P={},N={};for(const U of R){const B=U.queryResults,k=U.wrappedTileID,M=N[k]=N[k]||{};for(const H in B){const $=B[H],V=M[H]=M[H]||{},Z=P[H]=P[H]||[];for(const z of $)V[z.featureIndex]||(V[z.featureIndex]=!0,Z.push(z))}}return P}(A);for(const R in O)O[R].forEach(P=>{const N=P.feature,U=N.layer;U&&U.type!=="background"&&U.type!=="sky"&&U.type!=="slot"&&(N.source=U.source,U["source-layer"]&&(N.sourceLayer=U["source-layer"]),N.state=N.id!==void 0?d.getFeatureState(U["source-layer"],N.id):{})});return O}function on(d,a){const n=d.getRenderableIds().map(f=>d.getTileByID(f)),_=[],c={};for(let f=0;f<n.length;f++){const g=n[f],b=g.tileID.canonical.key;c[b]||(c[b]=!0,g.querySourceFeatures(_,a))}return _}function Ls(d,a){const n=d.tileID,_=a.tileID;return n.overscaledZ-_.overscaledZ||n.canonical.y-_.canonical.y||n.wrap-_.wrap||n.canonical.x-_.canonical.x}class as extends Sn{constructor(a,n,_,c,f){super(a,n,_,c,f),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(a,n){const _=n.context,c=_.gl;this.texture=this.texture||n.getTileTexture(a.width),this.texture&&this.texture instanceof s.T?this.texture.update(a,{useMipmap:!1,premultiply:!1}):this.texture=new s.T(_,a,c.RGBA,{useMipmap:!1,premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(a=16384,n){const _=this._mrt=new s.aZ(30),c=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(a-1)}});return this.entireBuffer=null,this.request=s.a_(c,(f,g,b,v)=>{if(f)n(f);else try{const A=_.getHeaderLength(g);if(A>a)return void(this.request=this.fetchHeader(A,n));_.parseHeader(g),this._isHeaderLoaded=!0;let O=0;for(const R of Object.values(_.layers))O=Math.max(O,R.dataIndex[R.dataIndex.length-1].last_byte);g.byteLength>=O&&(this.entireBuffer=g),n(null,this.entireBuffer||g,b,v)}catch(A){n(A)}}),this.request}fetchBand(a,n,_){const c=this._mrt;if(!this._isHeaderLoaded||!c)return void _(new Error("Tile header is not ready"));const f=this.actor;if(!f)return void _(new Error("Can't fetch tile band without an actor"));let g;const b=(R,P)=>{g.complete(R,P),R?_(R):(this.updateTextureDescriptor(a,n),_(null,this.textureDescriptor&&this.textureDescriptor.img))},v=(R,P)=>{if(R)return _(R);const N=f.send("decodeRasterArray",{buffer:P,task:g},b,void 0,!0);this._workQueue.push(()=>{N&&N.cancel(),g.cancel()})},A=c.getLayer(a);if(!A)return void _(new Error(`Unknown sourceLayer "${a}"`));if(A.hasDataForBand(n))return this.updateTextureDescriptor(a,n),void _(null,this.textureDescriptor?this.textureDescriptor.img:null);const O=A.getDataRange([n]);if(g=c.createDecodingTask(O),!g||g.tasks.length)if(this.flushQueues(),this.entireBuffer)v(null,this.entireBuffer.slice(O.firstByte,O.lastByte+1));else{const R=Object.assign({},this.requestParams,{headers:{Range:`bytes=${O.firstByte}-${O.lastByte}`}}),P=s.a_(R,v);this._fetchQueue.push(()=>{P.cancel(),g.cancel()})}else _(null)}updateNeeded(a,n){return(!this.textureDescriptor||this.textureDescriptor.band!==n||this.textureDescriptor.layer!==a)&&this.state!=="errored"}updateTextureDescriptor(a,n){if(!this._mrt)return;const _=this._mrt.getLayer(a);if(!_||!_.hasBand(n)||!_.hasDataForBand(n))return;const{bytes:c,tileSize:f,buffer:g,offset:b,scale:v}=_.getBandView(n),A=f+2*g,O={data:c,width:A,height:A},R=this.texture;R&&R instanceof s.T&&R.update(O,{useMipmap:!1,premultiply:!1}),this.textureDescriptor={layer:a,band:n,img:O,buffer:g,offset:b,tileSize:f,format:_.pixelFormat,mix:[v,256*v,65536*v,16777216*v]}}}class Ns{constructor(a,n){this.max=a,this.onRemove=n,this.reset()}reset(){for(const a in this.data)for(const n of this.data[a])n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value);return this.data={},this.order=[],this}add(a,n,_){const c=a.wrapped().key;this.data[c]===void 0&&(this.data[c]=[]);const f={value:n,timeout:void 0};if(_!==void 0&&(f.timeout=setTimeout(()=>{this.remove(a,f)},_)),this.data[c].push(f),this.order.push(c),this.order.length>this.max){const g=this._getAndRemoveByKey(this.order[0]);g&&this.onRemove(g)}return this}has(a){return a.wrapped().key in this.data}getAndRemove(a){return this.has(a)?this._getAndRemoveByKey(a.wrapped().key):null}_getAndRemoveByKey(a){const n=this.data[a].shift();return n.timeout&&clearTimeout(n.timeout),this.data[a].length===0&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),n.value}getByKey(a){const n=this.data[a];return n?n[0].value:null}get(a){return this.has(a)?this.data[a.wrapped().key][0].value:null}remove(a,n){if(!this.has(a))return this;const _=a.wrapped().key,c=n===void 0?0:this.data[_].indexOf(n),f=this.data[_][c];return this.data[_].splice(c,1),f.timeout&&clearTimeout(f.timeout),this.data[_].length===0&&delete this.data[_],this.onRemove(f.value),this.order.splice(this.order.indexOf(_),1),this}setMaxSize(a){for(this.max=a;this.order.length>this.max;){const n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this}filter(a){const n=[];for(const _ in this.data)for(const c of this.data[_])a(c.value)||n.push(c);for(const _ of n)this.remove(_.value.tileID,_)}}class Mo extends s.E{constructor(a,n,_){super(),this.id=a,this._onlySymbols=_,n.on("data",c=>{c.dataType==="source"&&c.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&c.dataType==="source"&&c.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),n.on("error",()=>{this._sourceErrored=!0}),this._source=n,this._tiles={},this._cache=new Ns(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=n.minTileCacheSize,this._maxTileCacheSize=n.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Ot,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(a){this.map=a,this._minTileCacheSize=this._minTileCacheSize===void 0&&a?a._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&a?a._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const a in this._tiles){const n=this._tiles[a];if(n.state!=="errored"&&(n.state!=="loaded"||!n.bucketsLoaded()))return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const a=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,a&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(a,n){return a.isSymbolTile=this._onlySymbols,a.isExtraShadowCaster=this._shadowCasterTiles[a.tileID.key],this._source.loadTile(a,n)}_unloadTile(a){if(this._source.unloadTile)return this._source.unloadTile(a,()=>{})}_abortTile(a){if(this._source.abortTile)return this._source.abortTile(a,()=>{})}serialize(){return this._source.serialize()}prepare(a){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const n in this._tiles){const _=this._tiles[n];_.upload(a),_.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return s.a$(this._tiles).map(a=>a.tileID).sort(Er).map(a=>a.key)}getRenderableIds(a,n){const _=[];for(const c in this._tiles)this._isIdRenderable(+c,a,n)&&_.push(this._tiles[c]);return a?_.sort((c,f)=>{const g=c.tileID,b=f.tileID,v=new s.P(g.canonical.x,g.canonical.y)._rotate(this.transform.angle),A=new s.P(b.canonical.x,b.canonical.y)._rotate(this.transform.angle);return g.overscaledZ-b.overscaledZ||A.y-v.y||A.x-v.x}).map(c=>c.tileID.key):_.map(c=>c.tileID).sort(Er).map(c=>c.key)}hasRenderableParent(a){const n=this.findLoadedParent(a,0);return!!n&&this._isIdRenderable(n.tileID.key)}_isIdRenderable(a,n,_){return this._tiles[a]&&this._tiles[a].hasData()&&!this._coveredTiles[a]&&(n||!this._tiles[a].holdingForFade())&&(_||!this._shadowCasterTiles[a])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const a in this._tiles)this._tiles[a].state!=="errored"&&this._reloadTile(+a,"reloading")}}_reloadTile(a,n){const _=this._tiles[a];_&&(_.state!=="loading"&&(_.state=n),this._loadTile(_,this._tileLoaded.bind(this,_,a,n)))}_tileLoaded(a,n,_,c){if(c)if(a.state="errored",c.status!==404)this._source.fire(new s.a(c,{tile:a}));else{if(!(a.tileID.key in this._loadedParentTiles))return void this._source.fire(new s.b("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id}));if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const f=this.map.painter.terrain;this.update(this.transform,f.getScaledDemTileSize(),!0),f.resetTileLookupCache(this.id)}else this.update(this.transform)}else a.timeAdded=s.f.now(),_==="expired"&&(a.refreshedUponExpiration=!0),this._setTileReloadTimer(n,a),this._source.type==="raster-dem"&&a.dem&&this._backfillDEM(a),this._state.initializeTileState(a,this.map?this.map.painter:null),this._source.fire(new s.b("data",{dataType:"source",tile:a,coord:a.tileID,sourceCacheId:this.id}))}_backfillDEM(a){const n=this.getRenderableIds();for(let c=0;c<n.length;c++){const f=n[c];if(a.neighboringTiles&&a.neighboringTiles[f]){const g=this.getTileByID(f);_(a,g),_(g,a)}}function _(c,f){if(!c.dem||c.dem.borderReady)return;c.needsHillshadePrepare=!0,c.needsDEMTextureUpload=!0;let g=f.tileID.canonical.x-c.tileID.canonical.x;const b=f.tileID.canonical.y-c.tileID.canonical.y,v=Math.pow(2,c.tileID.canonical.z),A=f.tileID.key;g===0&&b===0||Math.abs(b)>1||(Math.abs(g)>1&&(Math.abs(g+v)===1?g+=v:Math.abs(g-v)===1&&(g-=v)),f.dem&&c.dem&&(c.dem.backfillBorder(f.dem,g,b),c.neighboringTiles&&c.neighboringTiles[A]&&(c.neighboringTiles[A].backfilled=!0)))}}getTile(a){return this.getTileByID(a.key)}getTileByID(a){return this._tiles[a]}_retainLoadedChildren(a,n,_,c){for(const f in this._tiles){let g=this._tiles[f];if(c[f]||!g.hasData()||g.tileID.overscaledZ<=n||g.tileID.overscaledZ>_)continue;let b=g.tileID;for(;g&&g.tileID.overscaledZ>n+1;){const A=g.tileID.scaledTo(g.tileID.overscaledZ-1);g=this._tiles[A.key],g&&g.hasData()&&(b=A)}let v=b;for(;v.overscaledZ>n;)if(v=v.scaledTo(v.overscaledZ-1),a[v.key]){c[b.key]=b;break}}}findLoadedParent(a,n){if(a.key in this._loadedParentTiles){const _=this._loadedParentTiles[a.key];return _&&_.tileID.overscaledZ>=n?_:null}for(let _=a.overscaledZ-1;_>=n;_--){const c=a.scaledTo(_),f=this._getLoadedTile(c);if(f)return f}}_getLoadedTile(a){const n=this._tiles[a.key];return n&&n.hasData()?n:this._cache.getByKey(this._source.reparseOverscaled?a.wrapped().key:a.canonical.key)}updateCacheSize(a,n){n=n||this._source.tileSize;const _=Math.ceil(a.width/n)+1,c=Math.ceil(a.height/n)+1,f=Math.floor(_*c*5),g=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,f):f,b=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,g):g;this._cache.setMaxSize(b)}handleWrapJump(a){const n=Math.round((a-(this._prevLng===void 0?a:this._prevLng))/360);if(this._prevLng=a,n){const _={};for(const c in this._tiles){const f=this._tiles[c];f.tileID=f.tileID.unwrapTo(f.tileID.wrap+n),_[f.tileID.key]=f}this._tiles=_;for(const c in this._timers)clearTimeout(this._timers[c]),delete this._timers[c];for(const c in this._tiles)this._setTileReloadTimer(+c,this._tiles[c])}}update(a,n,_,c){if(this.transform=a,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!_)return;let f;if(this.updateCacheSize(a,n),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={},this.used||this.usedForTerrain)if(this._source.tileID)f=a.getVisibleUnwrappedCoordinates(this._source.tileID).map(v=>new s.am(v.canonical.z,v.wrap,v.canonical.z,v.canonical.x,v.canonical.y));else if(this.tileCoverLift!==0){const v=a.clone();v.tileCoverLift=this.tileCoverLift,f=v.coveringTiles({tileSize:n||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!_,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.minzoom<=1&&a.projection.name==="globe"&&(f.push(new s.am(1,0,1,0,0)),f.push(new s.am(1,0,1,1,0)),f.push(new s.am(1,0,1,0,1)),f.push(new s.am(1,0,1,1,1)))}else f=a.coveringTiles({tileSize:n||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!_,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(f=f.filter(v=>this._source.hasTile(v)));else f=[];if(f.length>0&&this.castsShadows&&c&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!nn(this._source.type)){const v=a.coveringZoomLevel({tileSize:n||this._source.tileSize,roundZoom:this._source.roundZoom&&!_}),A=Math.min(v,this._source.maxzoom),O=a.extendTileCoverForShadows(f,c,A);for(const R of O)this._shadowCasterTiles[R.key]=!0,f.push(R)}const g=this._updateRetainedTiles(f);if(nn(this._source.type)&&f.length!==0){const v={},A={},O=Object.keys(g);for(const P of O){const N=g[P],U=this._tiles[P];if(!U||U.fadeEndTime&&U.fadeEndTime<=s.f.now())continue;const B=this.findLoadedParent(N,Math.max(N.overscaledZ-Mo.maxOverzooming,this._source.minzoom));B&&(this._addTile(B.tileID),v[B.tileID.key]=B.tileID),A[P]=N}const R=f[f.length-1].overscaledZ;for(const P in this._tiles){const N=this._tiles[P];if(g[P]||!N.hasData())continue;let U=N.tileID;for(;U.overscaledZ>R;){U=U.scaledTo(U.overscaledZ-1);const B=this._tiles[U.key];if(B&&B.hasData()&&A[U.key]){g[P]=N.tileID;break}}}for(const P in v)g[P]||(this._coveredTiles[P]=!0,g[P]=v[P])}for(const v in g)this._tiles[v].clearFadeHold();const b=s.b0(this._tiles,g);for(const v of b){const A=this._tiles[v];A.hasSymbolBuckets&&!A.holdingForFade()?A.setHoldDuration(this.map._fadeDuration):A.hasSymbolBuckets&&!A.symbolFadeFinished()||this._removeTile(+v)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const a in this._tiles)this._tiles[a].holdingForFade()&&this._removeTile(+a)}_updateRetainedTiles(a){const n={};if(a.length===0)return n;const _={},c=a.reduce((A,O)=>Math.min(A,O.overscaledZ),1/0),f=a[0].overscaledZ,g=Math.max(f-Mo.maxOverzooming,this._source.minzoom),b=Math.max(f+Mo.maxUnderzooming,this._source.minzoom),v={};for(const A of a){const O=this._addTile(A);n[A.key]=A,O.hasData()||c<this._source.maxzoom&&(v[A.key]=A)}this._retainLoadedChildren(v,c,b,n);for(const A of a){let O=this._tiles[A.key];if(O.hasData())continue;if(A.canonical.z>=this._source.maxzoom){const P=A.children(this._source.maxzoom)[0],N=this.getTile(P);if(N&&N.hasData()){n[P.key]=P;continue}}else{const P=A.children(this._source.maxzoom);if(n[P[0].key]&&n[P[1].key]&&n[P[2].key]&&n[P[3].key])continue}let R=O.wasRequested();for(let P=A.overscaledZ-1;P>=g;--P){const N=A.scaledTo(P);if(_[N.key]||(_[N.key]=!0,O=this.getTile(N),!O&&R&&(O=this._addTile(N)),O&&(n[N.key]=N,R=O.wasRequested(),O.hasData())))break}}return n}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const a in this._tiles){const n=[];let _,c=this._tiles[a].tileID;for(;c.overscaledZ>0;){if(c.key in this._loadedParentTiles){_=this._loadedParentTiles[c.key];break}n.push(c.key);const f=c.scaledTo(c.overscaledZ-1);if(_=this._getLoadedTile(f),_)break;c=f}for(const f of n)this._loadedParentTiles[f]=_}}_addTile(a){let n=this._tiles[a.key];if(n)return n.isExtraShadowCaster!==!0||this._shadowCasterTiles[a.key]||this._reloadTile(a.key,"reloading"),n;n=this._cache.getAndRemove(a),n&&(this._setTileReloadTimer(a.key,n),n.tileID=a,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[a.key]&&(clearTimeout(this._cacheTimers[a.key]),delete this._cacheTimers[a.key],this._setTileReloadTimer(a.key,n)));const _=!!n;if(!_){const c=this.map?this.map.painter:null,f=this._source.tileSize*a.overscaleFactor();n=this._source.type==="raster-array"?new as(a,f,this.transform.tileZoom,c,this._isRaster):new Sn(a,f,this.transform.tileZoom,c,this._isRaster),this._loadTile(n,this._tileLoaded.bind(this,n,a.key,n.state))}return n?(n.uses++,this._tiles[a.key]=n,_||this._source.fire(new s.b("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n):null}_setTileReloadTimer(a,n){a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);const _=n.getExpiryTimeout();_&&(this._timers[a]=setTimeout(()=>{this._reloadTile(a,"expired"),delete this._timers[a]},_))}_removeTile(a){const n=this._tiles[a];n&&(n.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),delete this._timers[a]),n.uses>0||(n.hasData()&&n.state!=="reloading"||n.state==="empty"?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const a in this._tiles)this._removeTile(+a);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(a,n,_){const c=[],f=this.transform;if(!f)return c;const g=f.projection.name==="globe",b=s.a5(f.center.lng);for(const v in this._tiles){const A=this._tiles[v];if(_&&A.clearQueryDebugViz(),A.holdingForFade())continue;let O;if(g){const R=A.tileID.canonical;if(R.z===0){const P=[Math.abs(s.aa(b,...Tl(R,-1))-b),Math.abs(s.aa(b,...Tl(R,1))-b)];O=[0,2*P.indexOf(Math.min(...P))-1]}else{const P=[Math.abs(s.aa(b,...Tl(R,-1))-b),Math.abs(s.aa(b,...Tl(R,0))-b),Math.abs(s.aa(b,...Tl(R,1))-b)];O=[P.indexOf(Math.min(...P))-1]}}else O=[0];for(const R of O){const P=a.containsTile(A,f,n,R);P&&c.push(P)}}return c}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(a){return this._getRenderableCoordinates(a)}_getRenderableCoordinates(a,n){const _=this.getRenderableIds(a,n).map(f=>this._tiles[f].tileID),c=this.transform.projection.name==="globe";for(const f of _)f.projMatrix=this.transform.calculateProjMatrix(f.toUnwrapped()),f.expandedProjMatrix=c?this.transform.calculateProjMatrix(f.toUnwrapped(),!1,!0):f.projMatrix;return _}sortCoordinatesByDistance(a){const n=a.slice(),_=this.transform._camera.position,c=this.transform._camera.forward(),f={};for(const g of n){const b=1/(1<<g.canonical.z);f[g.key]=((g.canonical.x+.5)*b+g.wrap-_[0])*c[0]+((g.canonical.y+.5)*b-_[1])*c[1]-_[2]*c[2]}return n.sort((g,b)=>f[g.key]-f[b.key]),n}hasTransition(){if(this._source.hasTransition())return!0;if(nn(this._source.type))for(const a in this._tiles){const n=this._tiles[a];if(n.fadeEndTime!==void 0&&n.fadeEndTime>=s.f.now())return!0}return!1}setFeatureState(a,n,_){this._state.updateState(a=a||"_geojsonTileLayer",n,_)}removeFeatureState(a,n,_){this._state.removeFeatureState(a=a||"_geojsonTileLayer",n,_)}getFeatureState(a,n){return this._state.getState(a=a||"_geojsonTileLayer",n)}setDependencies(a,n,_){const c=this._tiles[a];c&&c.setDependencies(n,_)}reloadTilesForDependencies(a,n){for(const _ in this._tiles)this._tiles[_].hasDependency(a,n)&&this._reloadTile(+_,"reloading");this._cache.filter(_=>!_.hasDependency(a,n))}_preloadTiles(a,n){if(!this._sourceLoaded){const v=()=>{this._sourceLoaded&&(this._source.off("data",v),this._preloadTiles(a,n))};return void this._source.on("data",v)}const _=new Map,c=Array.isArray(a)?a:[a],f=this.map.painter.terrain,g=this.usedForTerrain&&f?f.getScaledDemTileSize():this._source.tileSize;for(const v of c){const A=v.coveringTiles({tileSize:g,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const O of A)_.set(O.key,O);this.usedForTerrain&&v.updateElevation(!1)}const b=Array.from(_.values());s.b1(b,(v,A)=>{const O=new Sn(v,this._source.tileSize*v.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(O,R=>{this._source.type==="raster-dem"&&O.dem&&this._backfillDEM(O),A(R,O)})},n)}}function Er(d,a){const n=Math.abs(2*d.wrap)-+(d.wrap<0),_=Math.abs(2*a.wrap)-+(a.wrap<0);return d.overscaledZ-a.overscaledZ||_-n||a.canonical.y-d.canonical.y||a.canonical.x-d.canonical.x}function nn(d){return d==="raster"||d==="image"||d==="video"||d==="custom"}function Tl(d,a){const n=1<<d.z;return[d.x/n+a,(d.x+1)/n+a]}Mo.maxOverzooming=10,Mo.maxUnderzooming=3;class qu{constructor(a){this.style=a,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const a=!1,n=!1;for(const _ in this.style._mergedLayers){const c=this.style._mergedLayers[_];if(c.type==="fill-extrusion")this.layers.push({layer:c,visible:a,visibilityChanged:n});else if(c.type==="model"){const f=this.style.getLayerSource(c);f&&f.type==="batched-model"&&this.layers.push({layer:c,visible:a,visibilityChanged:n})}}}onNewFrame(a){this.layersGotHidden=!1;for(const n of this.layers){const _=n.layer;let c=!1;_.type==="fill-extrusion"?c=!_.isHidden(a)&&_.paint.get("fill-extrusion-opacity")>0:_.type==="model"&&(c=!_.isHidden(a)&&_.paint.get("model-opacity")>0),this.layersGotHidden=this.layersGotHidden||!c&&n.visible,n.visible=c}}updateZOffset(a,n){this.currentBuildingBuckets=[];for(const c of this.layers){const f=c.layer,g=this.style.getLayerSourceCache(f);let b=1;f.type==="fill-extrusion"&&(b=c.visible?f.paint.get("fill-extrusion-vertical-scale"):0);let v=g?g.getTile(n):null;if(!v&&g&&n.canonical.z>g.getSource().minzoom){let A=n.scaledTo(Math.min(g.getSource().maxzoom,n.overscaledZ-1));for(;A.overscaledZ>=g.getSource().minzoom&&(v=g.getTile(A),!v&&A.overscaledZ!==0);)A=A.scaledTo(A.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:v?v.getBucket(f):null,tileID:v?v.tileID:n,verticalScale:b})}a.hasAnyZOffset=!1;let _=!1;for(let c=0;c<a.symbolInstances.length;c++){const f=a.symbolInstances.get(c),g=f.zOffset,b=this._getHeightAtTileOffset(n,f.tileAnchorX,f.tileAnchorY);f.zOffset=b!==Number.NEGATIVE_INFINITY?b:g,_||g===f.zOffset||(_=!0),a.hasAnyZOffset||f.zOffset===0||(a.hasAnyZOffset=!0)}_&&(a.zOffsetBuffersNeedUpload=!0,a.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(a,n,_,c){let f=n,g=_;if(a.canonical.z!==c.canonical.z){const b=c.canonical,v=1/(1<<a.canonical.z-b.z);f=(n+a.canonical.x*s.V)*v-b.x*s.V|0,g=(_+a.canonical.y*s.V)*v-b.y*s.V|0}return{tileX:f,tileY:g}}_getHeightAtTileOffset(a,n,_){let c,f;for(let g=0;g<this.layers.length;++g){if(this.layers[g].layer.type!=="fill-extrusion")continue;const{bucket:b,tileID:v,verticalScale:A}=this.currentBuildingBuckets[g];if(!b)continue;const{tileX:O,tileY:R}=this._mapCoordToOverlappingTile(a,n,_,v),P=b.getHeightAtTileCoord(O,R);P&&P.height!==void 0&&(P.hidden?c=P.height:f=Math.max(P.height*A,f||0))}if(f!==void 0)return f;for(let g=0;g<this.layers.length;++g){const b=this.layers[g];if(b.layer.type!=="model"||!b.visible)continue;const{bucket:v,tileID:A}=this.currentBuildingBuckets[g];if(!v)continue;const{tileX:O,tileY:R}=this._mapCoordToOverlappingTile(a,n,_,A),P=v.getHeightAtTileCoord(O,R);if(P&&!P.hidden)return P.height===void 0&&c!==void 0?Math.min(P.maxHeight,c)*P.verticalScale:(P.height||0)*P.verticalScale}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function os(d,a){const n={};for(const _ in d)_!=="ref"&&(n[_]=d[_]);return s.b2.forEach(_=>{_ in a&&(n[_]=a[_])}),n}function $u(d){d=d.slice();const a=Object.create(null);for(let n=0;n<d.length;n++)a[d[n].id]=d[n];for(let n=0;n<d.length;n++)"ref"in d[n]&&(d[n]=os(d[n],a[d[n].ref]));return d}const ri={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function xl(d,a,n){n.push({command:ri.addSource,args:[d,a[d]]})}function Hd(d,a,n){a.push({command:ri.removeSource,args:[d]}),n[d]=!0}function uf(d,a,n,_){Hd(d,n,_),xl(d,a,n)}function cf(d,a,n){let _;for(_ in d[n])if(d[n].hasOwnProperty(_)&&_!=="data"&&!oe(d[n][_],a[n][_]))return!1;for(_ in a[n])if(a[n].hasOwnProperty(_)&&_!=="data"&&!oe(d[n][_],a[n][_]))return!1;return!0}function Rn(d,a,n,_,c,f){let g;for(g in a=a||{},d=d||{})d.hasOwnProperty(g)&&(oe(d[g],a[g])||n.push({command:f,args:[_,g,a[g],c]}));for(g in a)a.hasOwnProperty(g)&&!d.hasOwnProperty(g)&&(oe(d[g],a[g])||n.push({command:f,args:[_,g,a[g],c]}))}function Cn(d){return d.id}function Ar(d,a){return d[a.id]=a,d}class Ws{constructor(a,n){this.reset(a,n)}reset(a,n){this.points=a||[],this._distances=[0];for(let _=1;_<this.points.length;_++)this._distances[_]=this._distances[_-1]+this.points[_].dist(this.points[_-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(n||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(a){if(this.points.length===1)return this.points[0];a=s.aa(a,0,1);let n=1,_=this._distances[n];const c=a*this.paddedLength+this.padding;for(;_<c&&n<this._distances.length;)_=this._distances[++n];const f=n-1,g=this._distances[f],b=_-g,v=b>0?(c-g)/b:0;return this.points[f].mult(1-v).add(this.points[n].mult(v))}}class Yd{constructor(a,n,_){const c=this.boxCells=[],f=this.circleCells=[];this.xCellCount=Math.ceil(a/_),this.yCellCount=Math.ceil(n/_);for(let g=0;g<this.xCellCount*this.yCellCount;g++)c.push([]),f.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=n,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(a,n,_,c,f){this._forEachCell(n,_,c,f,this._insertBoxCell,this.boxUid++),this.boxKeys.push(a),this.bboxes.push(n),this.bboxes.push(_),this.bboxes.push(c),this.bboxes.push(f)}insertCircle(a,n,_,c){this._forEachCell(n-c,_-c,n+c,_+c,this._insertCircleCell,this.circleUid++),this.circleKeys.push(a),this.circles.push(n),this.circles.push(_),this.circles.push(c)}_insertBoxCell(a,n,_,c,f,g){this.boxCells[f].push(g)}_insertCircleCell(a,n,_,c,f,g){this.circleCells[f].push(g)}_query(a,n,_,c,f,g){if(_<0||a>this.width||c<0||n>this.height)return!f&&[];const b=[];if(a<=0&&n<=0&&this.width<=_&&this.height<=c){if(f)return!0;for(let v=0;v<this.boxKeys.length;v++)b.push({key:this.boxKeys[v],x1:this.bboxes[4*v],y1:this.bboxes[4*v+1],x2:this.bboxes[4*v+2],y2:this.bboxes[4*v+3]});for(let v=0;v<this.circleKeys.length;v++){const A=this.circles[3*v],O=this.circles[3*v+1],R=this.circles[3*v+2];b.push({key:this.circleKeys[v],x1:A-R,y1:O-R,x2:A+R,y2:O+R})}return g?b.filter(g):b}return this._forEachCell(a,n,_,c,this._queryCell,b,{hitTest:f,seenUids:{box:{},circle:{}}},g),f?b.length>0:b}_queryCircle(a,n,_,c,f){const g=a-_,b=a+_,v=n-_,A=n+_;if(b<0||g>this.width||A<0||v>this.height)return!c&&[];const O=[];return this._forEachCell(g,v,b,A,this._queryCellCircle,O,{hitTest:c,circle:{x:a,y:n,radius:_},seenUids:{box:{},circle:{}}},f),c?O.length>0:O}query(a,n,_,c,f){return this._query(a,n,_,c,!1,f)}hitTest(a,n,_,c,f){return this._query(a,n,_,c,!0,f)}hitTestCircle(a,n,_,c){return this._queryCircle(a,n,_,!0,c)}_queryCell(a,n,_,c,f,g,b,v){const A=b.seenUids,O=this.boxCells[f];if(O!==null){const P=this.bboxes;for(const N of O)if(!A.box[N]){A.box[N]=!0;const U=4*N;if(a<=P[U+2]&&n<=P[U+3]&&_>=P[U+0]&&c>=P[U+1]&&(!v||v(this.boxKeys[N]))){if(b.hitTest)return g.push(!0),!0;g.push({key:this.boxKeys[N],x1:P[U],y1:P[U+1],x2:P[U+2],y2:P[U+3]})}}}const R=this.circleCells[f];if(R!==null){const P=this.circles;for(const N of R)if(!A.circle[N]){A.circle[N]=!0;const U=3*N;if(this._circleAndRectCollide(P[U],P[U+1],P[U+2],a,n,_,c)&&(!v||v(this.circleKeys[N]))){if(b.hitTest)return g.push(!0),!0;{const B=P[U],k=P[U+1],M=P[U+2];g.push({key:this.circleKeys[N],x1:B-M,y1:k-M,x2:B+M,y2:k+M})}}}}}_queryCellCircle(a,n,_,c,f,g,b,v){const A=b.circle,O=b.seenUids,R=this.boxCells[f];if(R!==null){const N=this.bboxes;for(const U of R)if(!O.box[U]){O.box[U]=!0;const B=4*U;if(this._circleAndRectCollide(A.x,A.y,A.radius,N[B+0],N[B+1],N[B+2],N[B+3])&&(!v||v(this.boxKeys[U])))return g.push(!0),!0}}const P=this.circleCells[f];if(P!==null){const N=this.circles;for(const U of P)if(!O.circle[U]){O.circle[U]=!0;const B=3*U;if(this._circlesCollide(N[B],N[B+1],N[B+2],A.x,A.y,A.radius)&&(!v||v(this.circleKeys[U])))return g.push(!0),!0}}}_forEachCell(a,n,_,c,f,g,b,v){const A=this._convertToXCellCoord(a),O=this._convertToYCellCoord(n),R=this._convertToXCellCoord(_),P=this._convertToYCellCoord(c);for(let N=A;N<=R;N++)for(let U=O;U<=P;U++)if(f.call(this,a,n,_,c,this.xCellCount*U+N,g,b,v))return}_convertToXCellCoord(a){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(a*this.xScale)))}_convertToYCellCoord(a){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(a*this.yScale)))}_circlesCollide(a,n,_,c,f,g){const b=c-a,v=f-n,A=_+g;return A*A>b*b+v*v}_circleAndRectCollide(a,n,_,c,f,g,b){const v=(g-c)/2,A=Math.abs(a-(c+v));if(A>v+_)return!1;const O=(b-f)/2,R=Math.abs(n-(f+O));if(R>O+_)return!1;if(A<=v||R<=O)return!0;const P=A-v,N=R-O;return P*P+N*N<=_*_}}const sn={unknown:0,flipRequired:1,flipNotRequired:2},wn=Math.tan(85*Math.PI/180);function vl(d,a,n,_,c,f,g){const b=s.a6.create();if(n)if(f.name==="globe"){const v=s.b3(c,a);s.a6.multiply(b,b,v)}else{const v=s.b4.invert([],g);b[0]=v[0],b[1]=v[1],b[4]=v[2],b[5]=v[3],_||s.a6.rotateZ(b,b,c.angle)}else s.a6.multiply(b,c.labelPlaneMatrix,d);return b}function Gd(d,a,n,_,c,f,g){const b=vl(d,a,n,_,c,f,g);return f.name==="globe"&&n||(b[2]=b[6]=b[10]=b[14]=0),b}function Vd(d,a,n,_,c,f,g){if(n){if(f.name==="globe"){const b=vl(d,a,n,_,c,f,g);return s.a6.invert(b,b),s.a6.multiply(b,d,b),b}{const b=s.a6.clone(d),v=s.a6.identity([]);return v[0]=g[0],v[1]=g[1],v[4]=g[2],v[5]=g[3],s.a6.multiply(b,b,v),_||s.a6.rotateZ(b,b,-c.angle),b}}return c.glCoordMatrix}function Ao(d,a,n,_){const c=[d,a,n,1];n?s.a7.transformMat4(c,c,_):Xd(c,c,_);const f=c[3];return c[0]/=f,c[1]/=f,c[2]/=f,c}function Zu(d,a){return Math.min(.5+d/a*.5,1.5)}function jd(d,a){const n=d[0]/d[3],_=d[1]/d[3];return n>=-a[0]&&n<=a[0]&&_>=-a[1]&&_<=a[1]}function Kd(d,a,n,_,c,f,g,b,v,A){const O=n.transform,R=_?d.textSizeData:d.iconSizeData,P=s.b5(R,n.transform.zoom),N=O.projection.name==="globe",U=[256/n.width*2+1,256/n.height*2+1],B=_?d.text.dynamicLayoutVertexArray:d.icon.dynamicLayoutVertexArray;B.clear();let k=null;N&&(k=_?d.text.globeExtVertexArray:d.icon.globeExtVertexArray);const M=d.lineVertexArray,H=_?d.text.placedSymbolArray:d.icon.placedSymbolArray,$=n.transform.width/n.transform.height;let V,Z=!1;for(let z=0;z<H.length;z++){const X=H.get(z),{numGlyphs:ie,writingMode:ne}=X;if(ne!==s.b6.vertical||Z||V===s.b6.horizontal||(Z=!0),V=ne,(X.hidden||ne===s.b6.vertical)&&!Z){Pn(ie,B);continue}Z=!1;const re=new s.P(X.tileAnchorX,X.tileAnchorY);let{x:ye,y:ue,z:Ie}=O.projection.projectTilePoint(re.x,re.y,A.canonical);if(v){const[it,ht,St]=v(re);ye+=it,ue+=ht,Ie+=St}const Ee=[ye,ue,Ie,1];if(s.a7.transformMat4(Ee,Ee,a),!jd(Ee,U)){Pn(ie,B);continue}const Ue=Ee[3],ce=Zu(n.transform.getCameraToCenterDistance(O.projection),Ue),Te=s.b7(R,P,X),le=g?Te/ce:Te*ce,pe=Ao(ye,ue,Ie,c);if(pe[3]<=0){Pn(ie,B);continue}let ke={};const $e=g?null:v,je=Zd(X,le,!1,b,a,c,f,d.glyphOffsetArray,M,B,k,pe,re,ke,$,$e,O.projection,A,g);Z=je.useVertical,$e&&je.needsFlipping&&(ke={}),(je.notEnoughRoom||Z||je.needsFlipping&&Zd(X,le,!0,b,a,c,f,d.glyphOffsetArray,M,B,k,pe,re,ke,$,$e,O.projection,A,g).notEnoughRoom)&&Pn(ie,B)}_?(d.text.dynamicLayoutVertexBuffer.updateData(B),k&&d.text.globeExtVertexBuffer&&d.text.globeExtVertexBuffer.updateData(k)):(d.icon.dynamicLayoutVertexBuffer.updateData(B),k&&d.icon.globeExtVertexBuffer&&d.icon.globeExtVertexBuffer.updateData(k))}function qd(d,a,n,_,c,f,g,b,v,A,O,R,P,N,U,B){const{lineStartIndex:k,glyphStartIndex:M,segment:H}=b,$=M+b.numGlyphs,V=k+b.lineLength,Z=a.getoffsetX(M),z=a.getoffsetX($-1),X=El(d*Z,n,_,c,f,g,H,k,V,v,A,O,R,P,!0,N,U,B);if(!X)return null;const ie=El(d*z,n,_,c,f,g,H,k,V,v,A,O,R,P,!0,N,U,B);return ie?{first:X,last:ie}:null}function $d(d,a,n,_){return d===s.b6.horizontal&&Math.abs(_)>Math.abs(n)?{useVertical:!0}:d===s.b6.vertical?_>0?{needsFlipping:!0}:null:a!==sn.unknown&&function(c,f){return c===0||Math.abs(f/c)>wn}(n,_)?a===sn.flipRequired?{needsFlipping:!0}:null:n<0?{needsFlipping:!0}:null}function Zd(d,a,n,_,c,f,g,b,v,A,O,R,P,N,U,B,k,M,H){const $=a/24,V=d.lineOffsetX*$,Z=d.lineOffsetY*$,{lineStartIndex:z,glyphStartIndex:X,numGlyphs:ie,segment:ne,writingMode:re,flipState:ye}=d,ue=z+d.lineLength,Ie=Ee=>{if(O){const[le,pe,ke]=Ee.up,$e=A.length;s.b8(O,$e+0,le,pe,ke),s.b8(O,$e+1,le,pe,ke),s.b8(O,$e+2,le,pe,ke),s.b8(O,$e+3,le,pe,ke)}const[Ue,ce,Te]=Ee.point;s.b9(A,Ue,ce,Te,Ee.angle)};if(ie>1){const Ee=qd($,b,V,Z,n,R,P,d,v,f,N,B,!1,k,M,H);if(!Ee)return{notEnoughRoom:!0};if(_&&!n){let[Ue,ce,Te]=Ee.first.point,[le,pe,ke]=Ee.last.point;[Ue,ce]=Ao(Ue,ce,Te,g),[le,pe]=Ao(le,pe,ke,g);const $e=$d(re,ye,(le-Ue)*U,pe-ce);if(d.flipState=$e&&$e.needsFlipping?sn.flipRequired:sn.flipNotRequired,$e)return $e}Ie(Ee.first);for(let Ue=X+1;Ue<X+ie-1;Ue++){const ce=El($*b.getoffsetX(Ue),V,Z,n,R,P,ne,z,ue,v,f,N,B,!1,!1,k,M,H);if(!ce)return A.length-=4*(Ue-X),{notEnoughRoom:!0};Ie(ce)}Ie(Ee.last)}else{if(_&&!n){const Ue=Ao(P.x,P.y,0,c),ce=z+ne+1,Te=new s.P(v.getx(ce),v.gety(ce)),le=Ao(Te.x,Te.y,0,c),pe=le[3]>0?le:Ir(P,Te,Ue,1,c,void 0,k,M.canonical),ke=$d(re,ye,(pe[0]-Ue[0])*U,pe[1]-Ue[1]);if(d.flipState=ke&&ke.needsFlipping?sn.flipRequired:sn.flipNotRequired,ke)return ke}const Ee=El($*b.getoffsetX(X),V,Z,n,R,P,ne,z,ue,v,f,N,B,!1,!1,k,M,H);if(!Ee)return{notEnoughRoom:!0};Ie(Ee)}return{}}function Ms(d,a,n,_,c){const{x:f,y:g,z:b}=_.projectTilePoint(d.x,d.y,a);if(!c)return Ao(f,g,b,n);const[v,A,O]=c(d);return Ao(f+v,g+A,b+O,n)}function Ir(d,a,n,_,c,f,g,b){const v=Ms(d.sub(a)._unit()._add(d),b,c,g,f);return s.N.sub(v,n,v),s.N.normalize(v,v),s.N.scaleAndAdd(v,n,v,_)}function El(d,a,n,_,c,f,g,b,v,A,O,R,P,N,U,B,k,M){const H=_?d-a:d+a;let $=H>0?1:-1,V=0;_&&($*=-1,V=Math.PI),$<0&&(V+=Math.PI);let Z=b+g+($>0?0:1)|0,z=c,X=c,ie=0,ne=0;const re=Math.abs(H),ye=[],ue=[];let Ie=f,Ee=Ie;const Ue=()=>Ir(Ee,Ie,X,re-ie+1,O,P,B,k.canonical);for(;ie+ne<=re;){if(Z+=$,Z<b||Z>=v)return null;if(X=z,Ee=Ie,ye.push(X),N&&ue.push(Ee),Ie=new s.P(A.getx(Z),A.gety(Z)),z=R[Z],!z){const ht=Ms(Ie,k.canonical,O,B,P);z=ht[3]>0?R[Z]=ht:Ue()}ie+=ne,ne=s.N.distance(X,z)}U&&P&&(R[Z]&&(z=Ue(),ne=s.N.distance(X,z)),R[Z]=z);const ce=(re-ie)/ne,Te=Ie.sub(Ee)._mult(ce)._add(Ee),le=s.N.sub([],z,X),pe=s.N.scaleAndAdd([],X,le,ce);let ke=[0,0,1],$e=le[0],je=le[1];if(M&&(ke=B.upVector(k.canonical,Te.x,Te.y),ke[0]!==0||ke[1]!==0||ke[2]!==1)){const ht=[ke[2],0,-ke[0]],St=s.N.cross([],ke,ht);s.N.normalize(ht,ht),s.N.normalize(St,St),$e=s.N.dot(le,ht),je=s.N.dot(le,St)}if(n){const ht=s.N.cross([],ke,le);s.N.normalize(ht,ht),s.N.scaleAndAdd(pe,pe,ht,n*$)}const it=V+Math.atan2(je,$e);return ye.push(pe),N&&ue.push(Te),{point:pe,angle:it,path:ye,tilePath:ue,up:ke}}function Pn(d,a){const n=a.length,_=n+4*d;a.resize(_),a.float32.fill(-1/0,4*n,4*_)}function Xd(d,a,n){const _=a[0],c=a[1];return d[0]=n[0]*_+n[4]*c+n[12],d[1]=n[1]*_+n[5]*c+n[13],d[3]=n[3]*_+n[7]*c+n[15],d}const Io=100;class st{constructor(a,n,_=new Yd(a.width+200,a.height+200,25),c=new Yd(a.width+200,a.height+200,25)){this.transform=a,this.grid=_,this.ignoredGrid=c,this.pitchfactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+Io,this.screenBottomBoundary=a.height+Io,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200,this.fogState=n}placeCollisionBox(a,n,_,c,f,g,b,v){let A=_.projectedAnchorX,O=_.projectedAnchorY,R=_.projectedAnchorZ;const P=_.elevation,N=_.tileID,U=a.getProjection();if(P&&N){const[z,X,ie]=U.upVector(N.canonical,_.tileAnchorX,_.tileAnchorY),ne=U.upVectorScale(N.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;A+=z*P*ne,O+=X*P*ne,R+=ie*P*ne}const B=this.projectAndGetPerspectiveRatio(b,A,O,R,_.tileID,U.name==="globe"||!!P||this.transform.pitch>0,U),k=g*B.perspectiveRatio,M=(_.x1*n+c.x-_.padding)*k+B.point.x,H=(_.y1*n+c.y-_.padding)*k+B.point.y,$=(_.x2*n+c.x+_.padding)*k+B.point.x,V=(_.y2*n+c.y+_.padding)*k+B.point.y,Z=B.perspectiveRatio<=.55||B.occluded;return!this.isInsideGrid(M,H,$,V)||!f&&this.grid.hitTest(M,H,$,V,v)||Z?{box:[],offscreen:!1,occluded:B.occluded}:{box:[M,H,$,V],offscreen:this.isOffscreen(M,H,$,V),occluded:!1}}placeCollisionCircles(a,n,_,c,f,g,b,v,A,O,R,P,N,U,B){const k=[],M=this.transform.elevation,H=a.getProjection(),$=M?M.getAtTileOffsetFunc(B,this.transform.center.lat,this.transform.worldSize,H):null,V=new s.P(_.tileAnchorX,_.tileAnchorY);let{x:Z,y:z,z:X}=H.projectTilePoint(V.x,V.y,B.canonical);if($){const[Te,le,pe]=$(V);Z+=Te,z+=le,X+=pe}const ie=H.name==="globe",ne=this.projectAndGetPerspectiveRatio(b,Z,z,X,B,ie||!!M||this.transform.pitch>0,H),{perspectiveRatio:re}=ne,ye=(R?g/re:g*re)/s.bc,ue=Ao(Z,z,X,v),Ie=ne.signedDistanceFromCamera>0?qd(ye,f,_.lineOffsetX*ye,_.lineOffsetY*ye,!1,ue,V,_,c,v,{},M&&!R?$:null,R&&!!M,H,B,R):null;let Ee=!1,Ue=!1,ce=!0;if(Ie&&!ne.occluded){const Te=.5*N*re+U,le=new s.P(-100,-100),pe=new s.P(this.screenRightBoundary,this.screenBottomBoundary),ke=new Ws,{first:$e,last:je}=Ie,it=$e.path.length;let ht=[];for(let At=it-1;At>=1;At--)ht.push($e.path[At]);for(let At=1;At<je.path.length;At++)ht.push(je.path[At]);const St=2.5*Te;A&&(ht=ht.map(([At,jt,Ft],zt)=>($&&!ie&&(Ft=$(zt<it-1?$e.tilePath[it-1-zt]:je.tilePath[zt-it+2])[2]),Ao(At,jt,Ft,A))),ht.some(At=>At[3]<=0)&&(ht=[]));let xt=[];if(ht.length>0){let At=1/0,jt=-1/0,Ft=1/0,zt=-1/0;for(const kt of ht)At=Math.min(At,kt[0]),Ft=Math.min(Ft,kt[1]),jt=Math.max(jt,kt[0]),zt=Math.max(zt,kt[1]);jt>=le.x&&At<=pe.x&&zt>=le.y&&Ft<=pe.y&&(xt=[ht.map(kt=>new s.P(kt[0],kt[1]))],(At<le.x||jt>pe.x||Ft<le.y||zt>pe.y)&&(xt=s.ba(xt,le.x,le.y,pe.x,pe.y)))}for(const At of xt){ke.reset(At,.25*Te);let jt=0;jt=ke.length<=.5*Te?1:Math.ceil(ke.paddedLength/St)+1;for(let Ft=0;Ft<jt;Ft++){const zt=Ft/Math.max(jt-1,1),kt=ke.lerp(zt),di=kt.x+Io,Wi=kt.y+Io;k.push(di,Wi,Te,0);const ei=di-Te,Zi=Wi-Te,ti=di+Te,fi=Wi+Te;if(ce=ce&&this.isOffscreen(ei,Zi,ti,fi),Ue=Ue||this.isInsideGrid(ei,Zi,ti,fi),!n&&this.grid.hitTestCircle(di,Wi,Te,P)&&(Ee=!0,!O))return{circles:[],offscreen:!1,collisionDetected:Ee,occluded:!1}}}}return{circles:!O&&Ee||!Ue?[]:k,offscreen:ce,collisionDetected:Ee,occluded:ne.occluded}}queryRenderedSymbols(a){if(a.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const n=[];let _=1/0,c=1/0,f=-1/0,g=-1/0;for(const O of a){const R=new s.P(O.x+Io,O.y+Io);_=Math.min(_,R.x),c=Math.min(c,R.y),f=Math.max(f,R.x),g=Math.max(g,R.y),n.push(R)}const b=this.grid.query(_,c,f,g).concat(this.ignoredGrid.query(_,c,f,g)),v={},A={};for(const O of b){const R=O.key;if(v[R.bucketInstanceId]===void 0&&(v[R.bucketInstanceId]={}),v[R.bucketInstanceId][R.featureIndex])continue;const P=[new s.P(O.x1,O.y1),new s.P(O.x2,O.y1),new s.P(O.x2,O.y2),new s.P(O.x1,O.y2)];s.bb(n,P)&&(v[R.bucketInstanceId][R.featureIndex]=!0,A[R.bucketInstanceId]===void 0&&(A[R.bucketInstanceId]=[]),A[R.bucketInstanceId].push(R.featureIndex))}return A}insertCollisionBox(a,n,_,c,f){(n?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:c,collisionGroupID:f},a[0],a[1],a[2],a[3])}insertCollisionCircles(a,n,_,c,f){const g=n?this.ignoredGrid:this.grid,b={bucketInstanceId:_,featureIndex:c,collisionGroupID:f};for(let v=0;v<a.length;v+=4)g.insertCircle(b,a[v],a[v+1],a[v+2])}projectAndGetPerspectiveRatio(a,n,_,c,f,g,b){const v=[n,_,c,1];let A=!1;c||this.transform.pitch>0?(s.a7.transformMat4(v,v,a),this.fogState&&f&&b.name!=="globe"&&(A=function(P,N,U,B,k,M){const H=M.calculateFogTileMatrix(k),$=[N,U,B];return s.N.transformMat4($,$,H),Ti(P,s.N.length($),M.pitch,M._fov)}(this.fogState,n,_,c,f.toUnwrapped(),this.transform)>.9)):Xd(v,v,a);const O=v[3];return{point:new s.P((v[0]/O+1)/2*this.transform.width+Io,(-v[1]/O+1)/2*this.transform.height+Io),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(b)/O*.5,1.5),signedDistanceFromCamera:O,occluded:g&&v[2]>O||A}}isOffscreen(a,n,_,c){return _<Io||a>=this.screenRightBoundary||c<Io||n>this.screenBottomBoundary}isInsideGrid(a,n,_,c){return _>=0&&a<this.gridRightBoundary&&c>=0&&n<this.gridBottomBoundary}getViewportMatrix(){const a=s.a6.identity([]);return s.a6.translate(a,a,[-100,-100,0]),a}}function Or(d,a,n){const _=a.createTileMatrix(d,d.worldSize,n.toUnwrapped());return s.a6.multiply(new Float32Array(16),d.projMatrix,_)}function Jd(d,a,n){if(a.projection.name===n.projection.name)return d.projMatrix;const _=n.clone();return _.setProjection(a.projection),Or(_,a.getProjection(),d)}function Al(d,a,n){return a.name===n.projection.name?d.projMatrix:Or(n,a,d)}class Qd{constructor(a,n,_,c){this.opacity=a?Math.max(0,Math.min(1,a.opacity+(a.placed?n:-n))):c&&_?1:0,this.placed=_}isHidden(){return this.opacity===0&&!this.placed}}class Ln{constructor(a,n,_,c,f,g=!1){this.text=new Qd(a?a.text:null,n,_,f),this.icon=new Qd(a?a.icon:null,n,c,f),this.clipped=g}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Do{constructor(a,n,_,c=!1){this.text=a,this.icon=n,this.skipFade=_,this.clipped=c}}class e_{constructor(){this.invProjMatrix=s.a6.create(),this.viewportMatrix=s.a6.create(),this.circles=[]}}class ns{constructor(a,n,_,c,f){this.bucketInstanceId=a,this.featureIndex=n,this.sourceLayerIndex=_,this.bucketIndex=c,this.tileID=f}}class Sr{constructor(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}}get(a){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[a]){const n=++this.maxGroupID;this.collisionGroups[a]={ID:n,predicate:_=>_.collisionGroupID===n}}return this.collisionGroups[a]}}function ss(d,a,n,_,c){const{horizontalAlign:f,verticalAlign:g}=s.bf(d),b=-(f-.5)*a,v=-(g-.5)*n,A=s.bd(d,_);return new s.P(b+A[0]*c,v+A[1]*c)}function t_(d,a,n,_,c){const f=new s.P(d,a);return n&&f._rotate(_?c:-c),f}class mf{constructor(a,n,_,c,f,g){this.transform=a.clone(),this.projection=a.projection.name,this.collisionIndex=new st(this.transform,f),this.buildingIndex=g,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=n,this.retainedQueryData={},this.collisionGroups=new Sr(_),this.collisionCircleArrays={},this.prevPlacement=c,c&&(c.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(a,n,_,c){const f=_.getBucket(n),g=_.latestFeatureIndex;if(!f||!g||n.fqid!==f.layerIds[0])return;const b=f.layers[0].layout,v=_.collisionBoxArray,A=Math.pow(2,this.transform.zoom-_.tileID.overscaledZ),O=_.tileSize/s.V,R=_.tileID.toUnwrapped();this.transform.setProjection(f.projection);const P=(N=_.tileID,U=f.getProjection(),B=this.transform,U.name===this.projection?B.calculateProjMatrix(N.toUnwrapped()):Or(B,U,N));var N,U,B;const k=b.get("text-pitch-alignment")==="map",M=b.get("text-rotation-alignment")==="map";n.compileFilter();const H=n.dynamicFilter(),$=n.dynamicFilterNeedsFeature(),V=this.transform.calculatePixelsToTileUnitsMatrix(_),Z=Gd(P,_.tileID.canonical,k,M,this.transform,f.getProjection(),V);let z=null;if(k){const ne=Vd(P,_.tileID.canonical,k,M,this.transform,f.getProjection(),V);z=s.a6.multiply([],this.transform.labelPlaneMatrix,ne)}let X=null;H&&_.latestFeatureIndex&&(X={unwrappedTileID:R,dynamicFilter:H,dynamicFilterNeedsFeature:$,featureIndex:_.latestFeatureIndex}),this.retainedQueryData[f.bucketInstanceId]=new ns(f.bucketInstanceId,g,f.sourceLayerIndex,f.index,_.tileID);const ie={bucket:f,layout:b,posMatrix:P,textLabelPlaneMatrix:Z,labelToScreenMatrix:z,clippingData:X,scale:A,textPixelRatio:O,holdingForFade:_.holdingForFade(),collisionBoxArray:v,partiallyEvaluatedTextSize:s.b5(f.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:s.b5(f.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(f.sourceID)};if(c)for(const ne of f.sortKeyRanges){const{sortKey:re,symbolInstanceStart:ye,symbolInstanceEnd:ue}=ne;a.push({sortKey:re,symbolInstanceStart:ye,symbolInstanceEnd:ue,parameters:ie})}else a.push({symbolInstanceStart:0,symbolInstanceEnd:f.symbolInstances.length,parameters:ie})}attemptAnchorPlacement(a,n,_,c,f,g,b,v,A,O,R,P,N,U,B,k,M,H){const{textOffset0:$,textOffset1:V,crossTileID:Z}=P,z=[$,V],X=ss(a,_,c,z,f),ie=this.collisionIndex.placeCollisionBox(U,f,n,t_(X.x,X.y,g,b,this.transform.angle),R,v,A,O.predicate);if(k){const ne=U.getSymbolInstanceIconSize(H,this.transform.zoom,P.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(U,ne,k,t_(X.x,X.y,g,b,this.transform.angle),R,v,A,O.predicate).box.length===0)return}if(ie.box.length>0){let ne;return this.prevPlacement&&this.prevPlacement.variableOffsets[Z]&&this.prevPlacement.placements[Z]&&this.prevPlacement.placements[Z].text&&(ne=this.prevPlacement.variableOffsets[Z].anchor),this.variableOffsets[Z]={textOffset:z,width:_,height:c,anchor:a,textScale:f,prevAnchor:ne},this.markUsedJustification(U,a,P,B),U.allowVerticalPlacement&&(this.markUsedOrientation(U,B,P),this.placedOrientations[Z]=B),{shift:X,placedGlyphBoxes:ie}}}placeLayerBucketPart(a,n,_,c){const{bucket:f,layout:g,posMatrix:b,textLabelPlaneMatrix:v,labelToScreenMatrix:A,clippingData:O,textPixelRatio:R,holdingForFade:P,collisionBoxArray:N,partiallyEvaluatedTextSize:U,partiallyEvaluatedIconSize:B,collisionGroup:k}=a.parameters,M=g.get("text-optional"),H=g.get("icon-optional"),$=g.get("text-allow-overlap"),V=g.get("icon-allow-overlap"),Z=g.get("text-rotation-alignment")==="map",z=g.get("text-pitch-alignment")==="map",X=g.get("symbol-z-order")==="viewport-y",ie=g.get("symbol-z-elevate");this.transform.setProjection(f.projection);let ne=$&&(V||!f.hasIconData()||H),re=V&&($||!f.hasTextData()||M);!f.collisionArrays&&N&&f.deserializeCollisionBoxes(N),_&&c&&f.updateCollisionDebugBuffers(this.transform.zoom,N);const ye=(ue,Ie,Ee)=>{const{crossTileID:Ue,numVerticalGlyphVertices:ce}=ue;if(O){const ti={zoom:this.transform.zoom,pitch:this.transform.pitch};let fi=null;if(O.dynamicFilterNeedsFeature){const ii=this.retainedQueryData[f.bucketInstanceId];fi=O.featureIndex.loadFeature({featureIndex:ue.featureIndex,bucketIndex:ii.bucketIndex,sourceLayerIndex:ii.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,O.dynamicFilter)(ti,fi,this.retainedQueryData[f.bucketInstanceId].tileID.canonical,new s.P(ue.tileAnchorX,ue.tileAnchorY),this.transform.calculateDistanceTileData(O.unwrappedTileID)))return this.placements[Ue]=new Do(!1,!1,!1,!0),void n.add(Ue)}if(n.has(Ue))return;if(P)return void(this.placements[Ue]=new Do(!1,!1,!1));let Te=!1,le=!1,pe=!0,ke=!1,$e=!1,je=null,it={box:null,offscreen:null,occluded:null},ht={box:null,offscreen:null,occluded:null},St=null,xt=null,At=null,jt=0,Ft=0,zt=0;Ee.textFeatureIndex?jt=Ee.textFeatureIndex:ue.useRuntimeCollisionCircles&&(jt=ue.featureIndex),Ee.verticalTextFeatureIndex&&(Ft=Ee.verticalTextFeatureIndex);const kt=ti=>{ti.tileID=this.retainedQueryData[f.bucketInstanceId].tileID;const fi=this.transform.elevation;ti.elevation=ue.zOffset+(fi?fi.getAtTileOffset(ti.tileID,ti.tileAnchorX,ti.tileAnchorY):0)},di=Ee.textBox;if(di){kt(di);const ti=ii=>{let mi=s.b6.horizontal;if(f.allowVerticalPlacement&&!ii&&this.prevPlacement){const Ui=this.prevPlacement.placedOrientations[Ue];Ui&&(this.placedOrientations[Ue]=Ui,mi=Ui,this.markUsedOrientation(f,mi,ue))}return mi},fi=(ii,mi)=>{if(f.allowVerticalPlacement&&ce>0&&Ee.verticalTextBox){for(const Ui of f.writingModes)if(Ui===s.b6.vertical?(it=mi(),ht=it):it=ii(),it&&it.box&&it.box.length)break}else it=ii()};if(g.get("text-variable-anchor")){let ii=g.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ue]){const bi=this.prevPlacement.variableOffsets[Ue];ii.indexOf(bi.anchor)>0&&(ii=ii.filter(Oa=>Oa!==bi.anchor),ii.unshift(bi.anchor))}const mi=(bi,Oa,Ba)=>{const no=f.getSymbolInstanceTextSize(U,ue,this.transform.zoom,Ie),Zo=(bi.x2-bi.x1)*no+2*bi.padding,so=(bi.y2-bi.y1)*no+2*bi.padding,Sa=ue.hasIconTextFit&&!V?Oa:null;Sa&&kt(Sa);let ya={box:[],offscreen:!1,occluded:!1};const ja=$?2*ii.length:ii.length;for(let Za=0;Za<ja;++Za){const lo=this.attemptAnchorPlacement(ii[Za%ii.length],bi,Zo,so,no,Z,z,R,b,k,Za>=ii.length,ue,Ie,f,Ba,Sa,U,B);if(lo&&(ya=lo.placedGlyphBoxes,ya&&ya.box&&ya.box.length)){Te=!0,je=lo.shift;break}}return ya};fi(()=>mi(di,Ee.iconBox,s.b6.horizontal),()=>{const bi=Ee.verticalTextBox;return bi&&kt(bi),f.allowVerticalPlacement&&!(it&&it.box&&it.box.length)&&ce>0&&bi?mi(bi,Ee.verticalIconBox,s.b6.vertical):{box:null,offscreen:null,occluded:null}}),it&&(Te=it.box,pe=it.offscreen,ke=it.occluded);const Ui=ti(!(!it||!it.box));if(!Te&&this.prevPlacement){const bi=this.prevPlacement.variableOffsets[Ue];bi&&(this.variableOffsets[Ue]=bi,this.markUsedJustification(f,bi.anchor,ue,Ui))}}else{const ii=(mi,Ui)=>{const bi=f.getSymbolInstanceTextSize(U,ue,this.transform.zoom,Ie),Oa=this.collisionIndex.placeCollisionBox(f,bi,mi,new s.P(0,0),$,R,b,k.predicate);return Oa&&Oa.box&&Oa.box.length&&(this.markUsedOrientation(f,Ui,ue),this.placedOrientations[Ue]=Ui),Oa};fi(()=>ii(di,s.b6.horizontal),()=>{const mi=Ee.verticalTextBox;return f.allowVerticalPlacement&&ce>0&&mi?(kt(mi),ii(mi,s.b6.vertical)):{box:null,offscreen:null,occluded:null}}),ti(!!(it&&it.box&&it.box.length))}}if(St=it,Te=St&&St.box&&St.box.length>0,pe=St&&St.offscreen,ke=St&&St.occluded,ue.useRuntimeCollisionCircles){const ti=f.text.placedSymbolArray.get(ue.centerJustifiedTextSymbolIndex>=0?ue.centerJustifiedTextSymbolIndex:ue.verticalPlacedTextSymbolIndex),fi=s.b7(f.textSizeData,U,ti),ii=g.get("text-padding");xt=this.collisionIndex.placeCollisionCircles(f,$,ti,f.lineVertexArray,f.glyphOffsetArray,fi,b,v,A,_,z,k.predicate,ue.collisionCircleDiameter*fi/s.bc,ii,this.retainedQueryData[f.bucketInstanceId].tileID),Te=$||xt.circles.length>0&&!xt.collisionDetected,pe=pe&&xt.offscreen,ke=xt.occluded}if(Ee.iconFeatureIndex&&(zt=Ee.iconFeatureIndex),Ee.iconBox){const ti=fi=>{kt(fi);const ii=ue.hasIconTextFit&&je?t_(je.x,je.y,Z,z,this.transform.angle):new s.P(0,0),mi=f.getSymbolInstanceIconSize(B,this.transform.zoom,ue.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(f,mi,fi,ii,V,R,b,k.predicate)};ht&&ht.box&&ht.box.length&&Ee.verticalIconBox?(At=ti(Ee.verticalIconBox),le=At.box.length>0):(At=ti(Ee.iconBox),le=At.box.length>0),pe=pe&&At.offscreen,$e=At.occluded}const Wi=M||ue.numHorizontalGlyphVertices===0&&ce===0,ei=H||ue.numIconVertices===0;if(Wi||ei?ei?Wi||(le=le&&Te):Te=le&&Te:le=Te=le&&Te,Te&&St&&St.box&&this.collisionIndex.insertCollisionBox(St.box,g.get("text-ignore-placement"),f.bucketInstanceId,ht&&ht.box&&Ft?Ft:jt,k.ID),le&&At&&this.collisionIndex.insertCollisionBox(At.box,g.get("icon-ignore-placement"),f.bucketInstanceId,zt,k.ID),xt&&(Te&&this.collisionIndex.insertCollisionCircles(xt.circles,g.get("text-ignore-placement"),f.bucketInstanceId,jt,k.ID),_)){const ti=f.bucketInstanceId;let fi=this.collisionCircleArrays[ti];fi===void 0&&(fi=this.collisionCircleArrays[ti]=new e_);for(let ii=0;ii<xt.circles.length;ii+=4)fi.circles.push(xt.circles[ii+0]),fi.circles.push(xt.circles[ii+1]),fi.circles.push(xt.circles[ii+2]),fi.circles.push(xt.collisionDetected?1:0)}const Zi=f.projection.name!=="globe";ne=ne&&(Zi||!ke),re=re&&(Zi||!$e),this.placements[Ue]=new Do(Te||ne,le||re,pe||f.justReloaded),n.add(Ue)};if(ie&&this.buildingIndex&&(this.buildingIndex.updateZOffset(f,this.retainedQueryData[f.bucketInstanceId].tileID),f.updateZOffset()),X){const ue=f.getSortedSymbolIndexes(this.transform.angle);for(let Ie=ue.length-1;Ie>=0;--Ie){const Ee=ue[Ie];ye(f.symbolInstances.get(Ee),Ee,f.collisionArrays[Ee])}f.hasAnyZOffset&&s.w(`${f.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(f.hasAnyZOffset){const ue=f.getSortedIndexesByZOffset();for(let Ie=0;Ie<ue.length;++Ie){const Ee=ue[Ie];ye(f.symbolInstances.get(Ee),Ee,f.collisionArrays[Ee])}}else for(let ue=a.symbolInstanceStart;ue<a.symbolInstanceEnd;ue++)ye(f.symbolInstances.get(ue),ue,f.collisionArrays[ue]);if(_&&f.bucketInstanceId in this.collisionCircleArrays){const ue=this.collisionCircleArrays[f.bucketInstanceId];s.a6.invert(ue.invProjMatrix,b),ue.viewportMatrix=this.collisionIndex.getViewportMatrix()}f.justReloaded=!1}markUsedJustification(a,n,_,c){const{leftJustifiedTextSymbolIndex:f,centerJustifiedTextSymbolIndex:g,rightJustifiedTextSymbolIndex:b,verticalPlacedTextSymbolIndex:v,crossTileID:A}=_,O=s.be(n),R=c===s.b6.vertical?v:O==="left"?f:O==="center"?g:O==="right"?b:-1;f>=0&&(a.text.placedSymbolArray.get(f).crossTileID=R>=0&&f!==R?0:A),g>=0&&(a.text.placedSymbolArray.get(g).crossTileID=R>=0&&g!==R?0:A),b>=0&&(a.text.placedSymbolArray.get(b).crossTileID=R>=0&&b!==R?0:A),v>=0&&(a.text.placedSymbolArray.get(v).crossTileID=R>=0&&v!==R?0:A)}markUsedOrientation(a,n,_){const c=n===s.b6.horizontal||n===s.b6.horizontalOnly?n:0,f=n===s.b6.vertical?n:0,{leftJustifiedTextSymbolIndex:g,centerJustifiedTextSymbolIndex:b,rightJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:A}=_,O=a.text.placedSymbolArray;g>=0&&(O.get(g).placedOrientation=c),b>=0&&(O.get(b).placedOrientation=c),v>=0&&(O.get(v).placedOrientation=c),A>=0&&(O.get(A).placedOrientation=f)}commit(a){this.commitTime=a,this.zoomAtLastRecencyCheck=this.transform.zoom;const n=this.prevPlacement;let _=!1;this.prevZoomAdjustment=n?n.zoomAdjustment(this.transform.zoom):0;const c=n?n.symbolFadeChange(a):1,f=n?n.opacities:{},g=n?n.variableOffsets:{},b=n?n.placedOrientations:{};for(const v in this.placements){const A=this.placements[v],O=f[v];O?(this.opacities[v]=new Ln(O,c,A.text,A.icon,null,A.clipped),_=_||A.text!==O.text.placed||A.icon!==O.icon.placed):(this.opacities[v]=new Ln(null,c,A.text,A.icon,A.skipFade,A.clipped),_=_||A.text||A.icon)}for(const v in f){const A=f[v];if(!this.opacities[v]){const O=new Ln(A,c,!1,!1);O.isHidden()||(this.opacities[v]=O,_=_||A.text.placed||A.icon.placed)}}for(const v in g)this.variableOffsets[v]||!this.opacities[v]||this.opacities[v].isHidden()||(this.variableOffsets[v]=g[v]);for(const v in b)this.placedOrientations[v]||!this.opacities[v]||this.opacities[v].isHidden()||(this.placedOrientations[v]=b[v]);_?this.lastPlacementChangeTime=a:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=n?n.lastPlacementChangeTime:a)}updateLayerOpacities(a,n){const _=new Set;for(const c of n){const f=c.getBucket(a);f&&c.latestFeatureIndex&&a.fqid===f.layerIds[0]&&(this.updateBucketOpacities(f,_,c.collisionBoxArray),f.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(f,c.tileID),f.updateZOffset()))}}updateBucketOpacities(a,n,_){a.hasTextData()&&a.text.opacityVertexArray.clear(),a.hasIconData()&&a.icon.opacityVertexArray.clear(),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexArray.clear(),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexArray.clear();const c=a.layers[0].layout,f=!!a.layers[0].dynamicFilter(),g=new Ln(null,0,!1,!1,!0),b=c.get("text-allow-overlap"),v=c.get("icon-allow-overlap"),A=c.get("text-variable-anchor"),O=c.get("text-rotation-alignment")==="map",R=c.get("text-pitch-alignment")==="map",P=new Ln(null,0,b&&(v||!a.hasIconData()||c.get("icon-optional")),v&&(b||!a.hasTextData()||c.get("text-optional")),!0);!a.collisionArrays&&_&&(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData())&&a.deserializeCollisionBoxes(_);const N=(B,k,M)=>{for(let H=0;H<k/4;H++)B.opacityVertexArray.emplaceBack(M)};let U=0;for(let B=0;B<a.symbolInstances.length;B++){const k=a.symbolInstances.get(B),{numHorizontalGlyphVertices:M,numVerticalGlyphVertices:H,crossTileID:$,numIconVertices:V}=k,Z=n.has($);let z=this.opacities[$];Z?z=g:z||(z=P,this.opacities[$]=z),n.add($);const X=M>0||H>0,ie=V>0,ne=this.placedOrientations[$],re=ne===s.b6.vertical,ye=ne===s.b6.horizontal||ne===s.b6.horizontalOnly;if(!X&&!ie||z.isHidden()||U++,X){const ue=Qu(z.text);N(a.text,M,re?Il:ue),N(a.text,H,ye?Il:ue);const Ie=z.text.isHidden(),{leftJustifiedTextSymbolIndex:Ee,centerJustifiedTextSymbolIndex:Ue,rightJustifiedTextSymbolIndex:ce,verticalPlacedTextSymbolIndex:Te}=k,le=a.text.placedSymbolArray,pe=Ie||re?1:0;Ee>=0&&(le.get(Ee).hidden=pe),Ue>=0&&(le.get(Ue).hidden=pe),ce>=0&&(le.get(ce).hidden=pe),Te>=0&&(le.get(Te).hidden=Ie||ye?1:0);const ke=this.variableOffsets[$];ke&&this.markUsedJustification(a,ke.anchor,k,ne);const $e=this.placedOrientations[$];$e&&(this.markUsedJustification(a,"left",k,$e),this.markUsedOrientation(a,$e,k))}if(ie){const ue=Qu(z.icon),{placedIconSymbolIndex:Ie,verticalPlacedIconSymbolIndex:Ee}=k,Ue=a.icon.placedSymbolArray,ce=z.icon.isHidden()?1:0;Ie>=0&&(N(a.icon,V,re?Il:ue),Ue.get(Ie).hidden=ce),Ee>=0&&(N(a.icon,k.numVerticalIconVertices,ye?Il:ue),Ue.get(Ee).hidden=ce)}if(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData()){const ue=a.collisionArrays[B];if(ue){let Ie=new s.P(0,0),Ee=!0;if(ue.textBox||ue.verticalTextBox){if(A){const ce=this.variableOffsets[$];ce?(Ie=ss(ce.anchor,ce.width,ce.height,ce.textOffset,ce.textScale),O&&Ie._rotate(R?this.transform.angle:-this.transform.angle)):Ee=!1}f&&(Ee=!z.clipped),ue.textBox&&Ds(a.textCollisionBox.collisionVertexArray,z.text.placed,!Ee||re,Ie.x,Ie.y),ue.verticalTextBox&&Ds(a.textCollisionBox.collisionVertexArray,z.text.placed,!Ee||ye,Ie.x,Ie.y)}const Ue=Ee&&!!(!ye&&ue.verticalIconBox);ue.iconBox&&Ds(a.iconCollisionBox.collisionVertexArray,z.icon.placed,Ue,k.hasIconTextFit?Ie.x:0,k.hasIconTextFit?Ie.y:0),ue.verticalIconBox&&Ds(a.iconCollisionBox.collisionVertexArray,z.icon.placed,!Ue,k.hasIconTextFit?Ie.x:0,k.hasIconTextFit?Ie.y:0)}}}if(a.fullyClipped=U===0,a.sortFeatures(this.transform.angle),this.retainedQueryData[a.bucketInstanceId]&&(this.retainedQueryData[a.bucketInstanceId].featureSortOrder=a.featureSortOrder),a.hasTextData()&&a.text.opacityVertexBuffer&&a.text.opacityVertexBuffer.updateData(a.text.opacityVertexArray),a.hasIconData()&&a.icon.opacityVertexBuffer&&a.icon.opacityVertexBuffer.updateData(a.icon.opacityVertexArray),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexBuffer&&a.iconCollisionBox.collisionVertexBuffer.updateData(a.iconCollisionBox.collisionVertexArray),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexBuffer&&a.textCollisionBox.collisionVertexBuffer.updateData(a.textCollisionBox.collisionVertexArray),a.bucketInstanceId in this.collisionCircleArrays){const B=this.collisionCircleArrays[a.bucketInstanceId];a.placementInvProjMatrix=B.invProjMatrix,a.placementViewportMatrix=B.viewportMatrix,a.collisionCircleArray=B.circles,delete this.collisionCircleArrays[a.bucketInstanceId]}}symbolFadeChange(a){return this.fadeDuration===0?1:(a-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(a){return Math.max(0,(this.transform.zoom-a)/1.5)}hasTransitions(a){return this.stale||a-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(a,n){const _=this.zoomAtLastRecencyCheck===n?1-this.zoomAdjustment(n):1;return this.zoomAtLastRecencyCheck=n,this.commitTime+this.fadeDuration*_>a}setStale(){this.stale=!0}}function Ds(d,a,n,_,c){d.emplaceBack(a?1:0,n?1:0,_||0,c||0),d.emplaceBack(a?1:0,n?1:0,_||0,c||0),d.emplaceBack(a?1:0,n?1:0,_||0,c||0),d.emplaceBack(a?1:0,n?1:0,_||0,c||0)}const ff=Math.pow(2,25),Xu=Math.pow(2,24),Ju=Math.pow(2,17),i_=Math.pow(2,16),pf=Math.pow(2,9),hf=Math.pow(2,8),gf=Math.pow(2,1);function Qu(d){if(d.opacity===0&&!d.placed)return 0;if(d.opacity===1&&d.placed)return 4294967295;const a=d.placed?1:0,n=Math.floor(127*d.opacity);return n*ff+a*Xu+n*Ju+a*i_+n*pf+a*hf+n*gf+a}const Il=0;class yf{constructor(a){this._sortAcrossTiles=a.layout.get("symbol-z-order")!=="viewport-y"&&a.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(a,n,_,c,f){const g=this._bucketParts;for(;this._currentTileIndex<a.length;)if(n.getBucketParts(g,c,a[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,f())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,g.sort((b,v)=>b.sortKey-v.sortKey));this._currentPartIndex<g.length;){const b=g[this._currentPartIndex];if(n.placeLayerBucketPart(b,this._seenCrossTileIDs,_,b.symbolInstanceStart===0),this._currentPartIndex++,f())return!0}return!1}}class Rr{constructor(a,n,_,c,f,g,b,v,A){this.placement=new mf(a,f,g,b,v,A),this._currentPlacementIndex=n.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=c,this._done=!1}isDone(){return this._done}continuePlacement(a,n,_,c){const f=s.f.now(),g=()=>{const b=s.f.now()-f;return!this._forceFullPlacement&&b>2};for(;this._currentPlacementIndex>=0;){const b=n[a[this._currentPlacementIndex]],v=this.placement.collisionIndex.transform.zoom;if(b.type==="symbol"&&(!b.minzoom||b.minzoom<=v)&&(!b.maxzoom||b.maxzoom>v)){const A=b,O=A.layout.get("symbol-z-elevate"),R=this._inProgressLayer=this._inProgressLayer||new yf(A),P=s.ag(b.source,b.scope);if(R.continuePlacement(O?c[P]:_[P],this.placement,this._showCollisionBoxes,b,g))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(a){return this.placement.commit(a),this.placement}}const a_=512/s.V/2;class ec{constructor(a,n,_){this.tileID=a,this.bucketInstanceId=_,this.index=new s.bg(n.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const c=a.canonical.x*s.V,f=a.canonical.y*s.V;for(let g=0;g<n.length;g++){const{key:b,crossTileID:v,tileAnchorX:A,tileAnchorY:O}=n.get(g),R=Math.floor((c+A)*a_),P=Math.floor((f+O)*a_);this.index.add(R,P),this.keys.push(b),this.crossTileIDs.push(v)}this.index.finish()}findMatches(a,n,_){const c=this.tileID.canonical.z<n.canonical.z?1:Math.pow(2,this.tileID.canonical.z-n.canonical.z),f=a_/Math.pow(2,n.canonical.z-this.tileID.canonical.z),g=n.canonical.x*s.V,b=n.canonical.y*s.V;for(let v=0;v<a.length;v++){const A=a.get(v);if(A.crossTileID)continue;const{key:O,tileAnchorX:R,tileAnchorY:P}=A,N=Math.floor((g+R)*f),U=Math.floor((b+P)*f),B=this.index.range(N-c,U-c,N+c,U+c);for(const k of B){const M=this.crossTileIDs[k];if(this.keys[k]===O&&!_.has(M)){_.add(M),A.crossTileID=M;break}}}}}class o_{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Cr{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(a){const n=Math.round((a-this.lng)/360);if(n!==0)for(const _ in this.indexes){const c=this.indexes[_],f={};for(const g in c){const b=c[g];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+n),f[b.tileID.key]=b}this.indexes[_]=f}this.lng=a}addBucket(a,n,_){if(this.indexes[a.overscaledZ]&&this.indexes[a.overscaledZ][a.key]){if(this.indexes[a.overscaledZ][a.key].bucketInstanceId===n.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(a.overscaledZ,this.indexes[a.overscaledZ][a.key])}for(let f=0;f<n.symbolInstances.length;f++)n.symbolInstances.get(f).crossTileID=0;this.usedCrossTileIDs[a.overscaledZ]||(this.usedCrossTileIDs[a.overscaledZ]=new Set);const c=this.usedCrossTileIDs[a.overscaledZ];for(const f in this.indexes){const g=this.indexes[f];if(Number(f)>a.overscaledZ)for(const b in g){const v=g[b];v.tileID.isChildOf(a)&&v.findMatches(n.symbolInstances,a,c)}else{const b=g[a.scaledTo(Number(f)).key];b&&b.findMatches(n.symbolInstances,a,c)}}for(let f=0;f<n.symbolInstances.length;f++){const g=n.symbolInstances.get(f);g.crossTileID||(g.crossTileID=_.generate(),c.add(g.crossTileID))}return this.indexes[a.overscaledZ]===void 0&&(this.indexes[a.overscaledZ]={}),this.indexes[a.overscaledZ][a.key]=new ec(a,n.symbolInstances,n.bucketInstanceId),!0}removeBucketCrossTileIDs(a,n){for(const _ of n.crossTileIDs)this.usedCrossTileIDs[a].delete(_)}removeStaleBuckets(a){let n=!1;for(const _ in this.indexes){const c=this.indexes[_];for(const f in c)a[c[f].bucketInstanceId]||(this.removeBucketCrossTileIDs(_,c[f]),delete c[f],n=!0)}return n}}class n_{constructor(){this.layerIndexes={},this.crossTileIDs=new o_,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(a,n,_,c){let f=this.layerIndexes[a.fqid];f===void 0&&(f=this.layerIndexes[a.fqid]=new Cr);let g=!1;const b={};c.name!=="globe"&&f.handleWrapJump(_);for(const v of n){const A=v.getBucket(a);A&&a.fqid===A.layerIds[0]&&(A.bucketInstanceId||(A.bucketInstanceId=++this.maxBucketInstanceId),f.addBucket(v.tileID,A,this.crossTileIDs)&&(g=!0),b[A.bucketInstanceId]=!0)}return f.removeStaleBuckets(b)&&(g=!0),g}pruneUnusedLayers(a){const n={};a.forEach(_=>{n[_]=!0});for(const _ in this.layerIndexes)n[_]||delete this.layerIndexes[_]}}class ls{constructor(a=0,n=0,_=0,c=0){if(isNaN(a)||a<0||isNaN(n)||n<0||isNaN(_)||_<0||isNaN(c)||c<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=a,this.bottom=n,this.left=_,this.right=c}interpolate(a,n,_){return n.top!=null&&a.top!=null&&(this.top=s.U(a.top,n.top,_)),n.bottom!=null&&a.bottom!=null&&(this.bottom=s.U(a.bottom,n.bottom,_)),n.left!=null&&a.left!=null&&(this.left=s.U(a.left,n.left,_)),n.right!=null&&a.right!=null&&(this.right=s.U(a.right,n.right,_)),this}getCenter(a,n){const _=s.aa((this.left+a-this.right)/2,0,a),c=s.aa((this.top+n-this.bottom)/2,0,n);return new s.P(_,c)}equals(a){return this.top===a.top&&this.bottom===a.bottom&&this.left===a.left&&this.right===a.right}clone(){return new ls(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function wr(d,a){const n=s.bk(d,3);s.a6.fromQuat(d,a),s.bm(d,3,n)}function Ol(d,a){const n=s.bi.identity([]);return s.bi.rotateZ(n,n,-a),s.bi.rotateX(n,n,-d),n}function s_(d,a){const n=[d[0],d[1],0],_=[a[0],a[1],0];if(s.N.length(n)>=1e-15){const g=s.N.normalize([],n);s.N.scale(_,g,s.N.dot(_,g)),a[0]=_[0],a[1]=_[1]}const c=s.N.cross([],a,d);if(s.N.len(c)<1e-15)return null;const f=Math.atan2(-c[1],c[0]);return Ol(Math.atan2(Math.sqrt(d[0]*d[0]+d[1]*d[1]),-d[2]),f)}class Sl{constructor(a,n){this.position=a,this.orientation=n}get position(){return this._position}set position(a){if(a){const n=a instanceof s.L?a:new s.L(a[0],a[1],a[2]);this._renderWorldCopies&&(n.x=s.bh(n.x,0,1)),this._position=n}else this._position=null}lookAtPoint(a,n){if(this.orientation=null,!this.position)return;const _=this.position,c=this._elevation?this._elevation.getAtPointOrZero(s.L.fromLngLat(a)):0,f=s.L.fromLngLat(a,c),g=[f.x-_.x,f.y-_.y,f.z-_.z];n||(n=[0,0,1]),n[2]=Math.abs(n[2]),this.orientation=s_(g,n)}setPitchBearing(a,n){this.orientation=Ol(s.bj(a),s.bj(-n))}}class Fs{constructor(a,n){this._transform=s.a6.identity([]),this.orientation=n,this.position=a}get mercatorPosition(){const a=this.position;return new s.L(a[0],a[1],a[2])}get position(){const a=s.bk(this._transform,3);return[a[0],a[1],a[2]]}set position(a){var n;a&&s.bm(this._transform,3,[(n=a)[0],n[1],n[2],1])}get orientation(){return this._orientation}set orientation(a){this._orientation=a||s.bi.identity([]),a&&wr(this._transform,this._orientation)}getPitchBearing(){const a=this.forward(),n=this.right();return{bearing:Math.atan2(-n[1],n[0]),pitch:Math.atan2(Math.sqrt(a[0]*a[0]+a[1]*a[1]),-a[2])}}setPitchBearing(a,n){this._orientation=Ol(a,n),wr(this._transform,this._orientation)}forward(){const a=s.bk(this._transform,2);return[-a[0],-a[1],-a[2]]}up(){const a=s.bk(this._transform,1);return[-a[0],-a[1],-a[2]]}right(){const a=s.bk(this._transform,0);return[a[0],a[1],a[2]]}getCameraToWorld(a,n){const _=new Float64Array(16);return s.a6.invert(_,this.getWorldToCamera(a,n)),_}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(a,n,_){const c=this.position;s.N.scale(c,c,-a);const f=new Float64Array(16);return s.a6.fromScaling(f,[_,_,_]),s.a6.translate(f,f,c),f[10]*=n,f}getWorldToCamera(a,n){const _=new Float64Array(16),c=new Float64Array(4),f=this.position;return s.bi.conjugate(c,this._orientation),s.N.scale(f,f,-a),s.a6.fromQuat(_,c),s.a6.translate(_,_,f),_[1]*=-1,_[5]*=-1,_[9]*=-1,_[13]*=-1,_[8]*=n,_[9]*=n,_[10]*=n,_[11]*=n,_}getCameraToClipPerspective(a,n,_,c){const f=new Float64Array(16);return s.a6.perspective(f,a,n,_,c),f}getCameraToClipOrthographic(a,n,_,c,f,g){const b=new Float64Array(16);return s.a6.ortho(b,a,n,_,c,f,g),b}getDistanceToElevation(a,n=!1){const _=a===0?0:s.bl(a,n?s.au(this.position[1]):this.position[1]),c=this.forward();return(_-this.position[2])/c[2]}clone(){return new Fs([...this.position],[...this.orientation])}}const Bs=(d,a,n)=>(1-n)*d+n*a,Rl=d=>d*d*d*d*d;class Cl{constructor(a,n,_,c,f,g,b){this.tileSize=512,this._renderWorldCopies=f===void 0||f,this._minZoom=a||0,this._maxZoom=n||22,this._minPitch=_??0,this._maxPitch=c??60,this.setProjection(g),this.setMaxBounds(b),this.width=0,this.height=0,this._center=new s.bn(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new ls,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Fs,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const a=new Cl(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return a._elevation=this._elevation,a._centerAltitude=this._centerAltitude,a._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,a.tileSize=this.tileSize,a.mercatorFromTransition=this.mercatorFromTransition,a.width=this.width,a.height=this.height,a.cameraElevationReference=this.cameraElevationReference,a._center=this._center,a._setZoom(this.zoom),a._seaLevelZoom=this._seaLevelZoom,a.angle=this.angle,a._fov=this._fov,a._pitch=this._pitch,a._nearZ=this._nearZ,a._farZ=this._farZ,a._averageElevation=this._averageElevation,a._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,a._unmodified=this._unmodified,a._edgeInsets=this._edgeInsets.clone(),a._camera=this._camera.clone(),a._calcMatrices(),a.freezeTileCoverage=this.freezeTileCoverage,a.frustumCorners=this.frustumCorners,a}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(a){this._elevation!==a&&(this._elevation=a,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(a,n=!1){const _=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||_)&&this._updateCameraOnTerrain(),(a||_)&&this._constrainCamera(n),this._calcMatrices()}getProjection(){return s.ac(this.projection,["name","center","parallels"])}setProjection(a){this.projectionOptions=a||{name:"mercator"};const n=this.projection?this.getProjection():void 0;this.projection=s.bo(this.projectionOptions);const _=!oe(n,this.getProjection());return _&&this._calcMatrices(),this.mercatorFromTransition=!1,_}setOrthographicProjectionAtLowPitch(a){return this._orthographicProjectionAtLowPitch!==a&&(this._orthographicProjectionAtLowPitch=a,this._calcMatrices(),!0)}setMercatorFromTransition(){const a=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=s.bo({name:"mercator"});const n=a!==this.projection.name;return n&&this._calcMatrices(),n}get minZoom(){return this._minZoom}set minZoom(a){this._minZoom!==a&&(this._minZoom=a,this.zoom=Math.max(this.zoom,a))}get maxZoom(){return this._maxZoom}set maxZoom(a){this._maxZoom!==a&&(this._maxZoom=a,this.zoom=Math.min(this.zoom,a))}get minPitch(){return this._minPitch}set minPitch(a){this._minPitch!==a&&(this._minPitch=a,this.pitch=Math.max(this.pitch,a))}get maxPitch(){return this._maxPitch}set maxPitch(a){this._maxPitch!==a&&(this._maxPitch=a,this.pitch=Math.min(this.pitch,a))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(a){a===void 0?a=!0:a===null&&(a=!1),this._renderWorldCopies=a}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const a=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(a))}get cameraWorldSize(){const a=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(a))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return s.bl(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.P(this.width,this.height)}get bearing(){return s.bh(this.rotation,-180,180)}set bearing(a){this.rotation=a}get rotation(){return-this.angle/Math.PI*180}set rotation(a){const n=-a*Math.PI/180;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=s.b4.create(),s.b4.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(a){const n=s.aa(a,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const a=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/a)}set fov(a){a=Math.max(.01,Math.min(60,a)),this._fov!==a&&(this._unmodified=!1,this._fov=s.bj(a),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(a){this._averageElevation=a,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(a){const n=Math.min(Math.max(a,this.minZoom),this.maxZoom);this._zoom!==n&&(this._unmodified=!1,this._setZoom(n),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(a){this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(a){this._tileCoverLift!==a&&(this._tileCoverLift=a)}_updateCameraOnTerrain(){const a=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,n=this.elevation&&a===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||a===Number.NEGATIVE_INFINITY&&(!n||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const _=this._elevation;n||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&_.exaggeration()&&this._centerAltitudeValidForExaggeration!==_.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*_.exaggeration(),this._centerAltitudeValidForExaggeration=_.exaggeration()):(this._centerAltitude=a||0,this._centerAltitudeValidForExaggeration=_.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const a=this._elevation,n=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],_=this.horizonLineFromTop();let c=0,f=0;for(let g=0;g<n.length;g++){const b=new s.P(n[g][0]*this.width,_+n[g][1]*(this.height-_)),v=a.pointCoordinate(b);if(!v)continue;const A=1/Math.hypot(v[0]-this._camera.position[0],v[1]-this._camera.position[1]);c+=v[3]*A,f+=A}return f===0?NaN:c/f}get center(){return this._center}set center(a){a.lat===this._center.lat&&a.lng===this._center.lng||(this._unmodified=!1,this._center=a,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const a=this._seaLevelZoom,n=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),_=this.pixelsPerMeter/this.worldSize*n,c=this._mercatorZfromZoom(a),f=this._mercatorZfromZoom(this._maxZoom),g=Math.max(c-_,f);this._setZoom(this._zoomFromMercatorZ(g))}get padding(){return this._edgeInsets.toJSON()}set padding(a){this._edgeInsets.equals(a)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,a,1),this._calcMatrices())}computeZoomRelativeTo(a){const n=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,a.toAltitude()));let _;_=a.z<this._camera.position[2]?[n.x,n.y,n.z]:[a.x,a.y,a.z];const c=s.N.length(s.N.sub([],this._camera.position,_));return s.aa(this._zoomFromMercatorZ(c),this._minZoom,this._maxZoom)}setFreeCameraOptions(a){if(!this.height||!a.position&&!a.orientation)return;this._updateCameraState();let n=!1;if(a.orientation&&!s.bi.exactEquals(a.orientation,this._camera.orientation)&&(n=this._setCameraOrientation(a.orientation)),a.position){const _=[a.position.x,a.position.y,a.position.z];s.N.exactEquals(_,this._camera.position)||(this._setCameraPosition(_),n=!0)}n&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const a=this._camera.position,n=new Sl;return n.position=new s.L(a[0],a[1],a[2]),n.orientation=this._camera.orientation,n._elevation=this.elevation,n._renderWorldCopies=this.renderWorldCopies,n}_setCameraOrientation(a){if(!s.bi.length(a))return!1;s.bi.normalize(a,a);const n=s.N.transformQuat([],[0,0,-1],a),_=s.N.transformQuat([],[0,-1,0],a);if(_[2]<0)return!1;const c=s_(n,_);return!!c&&(this._camera.orientation=c,!0)}_setCameraPosition(a){const n=this.zoomScale(this.minZoom)*this.tileSize,_=this.zoomScale(this.maxZoom)*this.tileSize,c=this.cameraToCenterDistance;a[2]=s.aa(a[2],c/_,c/n),this._camera.position=a}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(a){return this._edgeInsets.equals(a)}interpolatePadding(a,n,_){this._unmodified=!1,this._edgeInsets.interpolate(a,n,_),this._constrain(),this._calcMatrices()}coveringZoomLevel(a){const n=(a.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/a.tileSize));return Math.max(0,n)}getVisibleUnwrappedCoordinates(a){const n=[new s.bp(0,a)];if(this.renderWorldCopies){const _=this.pointCoordinate(new s.P(0,0)),c=this.pointCoordinate(new s.P(this.width,0)),f=this.pointCoordinate(new s.P(this.width,this.height)),g=this.pointCoordinate(new s.P(0,this.height)),b=Math.floor(Math.min(_.x,c.x,f.x,g.x)),v=Math.floor(Math.max(_.x,c.x,f.x,g.x)),A=1;for(let O=b-A;O<=v+A;O++)O!==0&&n.push(new s.bp(O,a))}return n}isLODDisabled(a){return(!a||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCoverForShadows(a,n,_){let c=[];if(n[0]===0&&n[1]===0)return c;for(const g of a){const b=g.canonical,v=g.overscaledZ,A=g.wrap,O=1<<b.z,R=b.x+1<O,P=b.x>0,N=b.y+1<O,U=b.y>0,B=g.wrap-(P?0:1),k=g.wrap+(R?0:1),M=P?b.x-1:O-1,H=R?b.x+1:0;n[0]<0?(c.push(new s.am(v,k,b.z,H,b.y)),n[1]<0&&N&&(c.push(new s.am(v,A,b.z,b.x,b.y+1)),c.push(new s.am(v,k,b.z,H,b.y+1))),n[1]>0&&U&&(c.push(new s.am(v,A,b.z,b.x,b.y-1)),c.push(new s.am(v,k,b.z,H,b.y-1)))):n[0]>0?(c.push(new s.am(v,B,b.z,M,b.y)),n[1]<0&&N&&(c.push(new s.am(v,A,b.z,b.x,b.y+1)),c.push(new s.am(v,B,b.z,M,b.y+1))),n[1]>0&&U&&(c.push(new s.am(v,A,b.z,b.x,b.y-1)),c.push(new s.am(v,B,b.z,M,b.y-1)))):n[1]<0&&N?c.push(new s.am(v,A,b.z,b.x,b.y+1)):U&&c.push(new s.am(v,A,b.z,b.x,b.y-1))}if(c.length>1){c.sort((v,A)=>v.overscaledZ-A.overscaledZ||v.wrap-A.wrap||v.canonical.z-A.canonical.z||v.canonical.x-A.canonical.x||v.canonical.y-A.canonical.y);let g=0,b=0;for(;b<c.length;)c[b].equals(c[g])?++b:c[++g]=c[b++];c.length=g+1}const f=[];for(const g of c)c.some(b=>g.isChildOf(b))||f.push(g);return c=f.filter(g=>!a.some(b=>!!(g.overscaledZ<_&&b.isChildOf(g))||g.equals(b)||g.isChildOf(b))),c}coveringTiles(a){let n=this.coveringZoomLevel(a);const _=n,c=this.elevation&&this.elevation.exaggeration(),f=c&&!a.isTerrainDEM,g=this.projection.name==="mercator";if(a.minzoom!==void 0&&n<a.minzoom)return[];a.maxzoom!==void 0&&n>a.maxzoom&&(n=a.maxzoom);const b=this.locationCoordinate(this.center),v=this.center.lat,A=1<<n,O=[A*b.x,A*b.y,0],R=this.projection.name==="globe",P=!R,N=s.bq.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n,P),U=R?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),B=A*s.bl(1,this.center.lat),k=this._camera.position[2]/s.bl(1,this.center.lat),M=[A*U.x,A*U.y,k*(P?1:B)],H=R||c,$=this.cameraToCenterDistance/a.tileSize*(a.roundZoom?1:.502),V=this.isLODDisabled(!0)?n:0;let Z;if(this._elevation&&a.isTerrainDEM)Z=1e4*this._elevation.exaggeration();else if(this._elevation){const le=this._elevation.getMinMaxForVisibleTiles();Z=le?le.max:this._centerAltitude}else Z=this._centerAltitude;const z=a.isTerrainDEM?-Z:this._elevation?this._elevation.getMinElevationBelowMSL():0,X=this.projection.isReprojectedInTileSpace?s.br(this):1,ie=le=>{const ke=new s.L(le.x+25e-6,le.y,le.z),$e=new s.L(le.x,le.y+25e-6,le.z),je=le.toLngLat(),it=ke.toLngLat(),ht=$e.toLngLat(),St=this.locationCoordinate(je),xt=this.locationCoordinate(it),At=this.locationCoordinate(ht),jt=Math.hypot(xt.x-St.x,xt.y-St.y),Ft=Math.hypot(At.x-St.x,At.y-St.y);return Math.sqrt(jt*Ft)*X/25e-6},ne=le=>{const pe=Z,ke=z;return{aabb:s.bu(this,A,0,0,0,le,ke,pe,this.projection),zoom:0,x:0,y:0,minZ:ke,maxZ:pe,wrap:le,fullyVisible:!1}},re=[];let ye=[];const ue=n,Ie=a.reparseOverscaled?_:n,Ee=le=>le*le,Ue=Ee((k-this._centerAltitude)*B),ce=le=>{if(!this._elevation||!le.tileID||!g)return;const pe=this._elevation.getMinMaxForTile(le.tileID),ke=le.aabb;pe?(ke.min[2]=pe.min,ke.max[2]=pe.max,ke.center[2]=(ke.min[2]+ke.max[2])/2):(le.shouldSplit=Te(le),le.shouldSplit||(ke.min[2]=ke.max[2]=ke.center[2]=this._centerAltitude))},Te=le=>{if(le.zoom<V)return!0;if(le.zoom===ue)return!1;if(le.shouldSplit!=null)return le.shouldSplit;const pe=le.aabb.distanceX(M),ke=le.aabb.distanceY(M);let $e=Ue,je=1;if(R){$e=Ee(le.aabb.distanceZ(M));const St=Math.pow(2,le.zoom),xt=s.au((le.y+1)/St),At=s.au(le.y/St),jt=Math.min(Math.max(v,xt),At),Ft=s.bJ(jt)/s.bJ(v);if(je=jt===v?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Ft/this._mercatorScaleRatio),this.zoom<=s.bG&&le.zoom===ue-1&&Ft>=.9)return!0}else if(f&&($e=Ee(le.aabb.distanceZ(M)*B)),this.projection.isReprojectedInTileSpace&&_<=5){const St=Math.pow(2,le.zoom),xt=ie(new s.L((le.x+.5)/St,(le.y+.5)/St));je=xt>.85?1:xt}const it=pe*pe+ke*ke+$e,ht=Ee((1<<ue-le.zoom)*$*je*((St,xt)=>{if(xt*Ee(.707)<St)return 1;const At=Math.sqrt(xt/St);return At/(1.4144271570014144+(Math.pow(1.1,At-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max($e,Ue),it));return it<ht};if(this.renderWorldCopies)for(let le=1;le<=3;le++)re.push(ne(-le)),re.push(ne(le));for(re.push(ne(0));re.length>0;){const le=re.pop(),pe=le.x,ke=le.y;let $e=le.fullyVisible;const je=()=>this.projection.name==="globe"&&(le.y===0||le.y===(1<<le.zoom)-1);if(!$e){let it=H?le.aabb.intersects(N):le.aabb.intersectsFlat(N);if(it===0&&je()){const ht=new s.bs(le.zoom,pe,ke);it=s.bt(this,A,ht,!0).intersects(N)}if(it===0)continue;$e=it===2}if(le.zoom!==ue&&Te(le))for(let it=0;it<4;it++){const ht=(pe<<1)+it%2,St=(ke<<1)+(it>>1),xt={aabb:g?le.aabb.quadrant(it):s.bu(this,A,le.zoom+1,ht,St,le.wrap,le.minZ,le.maxZ,this.projection),zoom:le.zoom+1,x:ht,y:St,wrap:le.wrap,fullyVisible:$e,tileID:void 0,shouldSplit:void 0,minZ:le.minZ,maxZ:le.maxZ};f&&!R&&(xt.tileID=new s.am(le.zoom+1===ue?Ie:le.zoom+1,le.wrap,le.zoom+1,ht,St),ce(xt)),re.push(xt)}else{const it=le.zoom===ue?Ie:le.zoom;if(a.minzoom&&a.minzoom>it)continue;if(!$e){let At=H?le.aabb.intersectsPrecise(N):le.aabb.intersectsPreciseFlat(N);if(At===0&&je()){const jt=new s.bs(le.zoom,pe,ke);At=s.bt(this,A,jt,!0).intersectsPrecise(N)}if(At===0)continue}const ht=O[0]-(.5+pe+(le.wrap<<le.zoom))*(1<<n-le.zoom),St=O[1]-.5-ke,xt=le.tileID?le.tileID:new s.am(it,le.wrap,le.zoom,pe,ke);ye.push({tileID:xt,distanceSq:ht*ht+St*St})}}if(this.fogCullDistSq){const le=this.fogCullDistSq,pe=this.horizonLineFromTop();ye=ye.filter(ke=>{const $e=[0,0,0,1],je=[s.V,s.V,0,1],it=this.calculateFogTileMatrix(ke.tileID.toUnwrapped());s.a7.transformMat4($e,$e,it),s.a7.transformMat4(je,je,it);const ht=s.a7.min([],$e,je),St=s.a7.max([],$e,je),xt=s.bv(ht,St);if(xt===0)return!0;let At=!1;const jt=this._elevation;if(jt&&xt>le&&pe!==0){const Ft=this.calculateProjMatrix(ke.tileID.toUnwrapped());let zt;a.isTerrainDEM||(zt=jt.getMinMaxForTile(ke.tileID)),zt||(zt={min:z,max:Z});const kt=s.bH(this.rotation),di=[kt[0]*s.V,kt[1]*s.V,zt.max];s.N.transformMat4(di,di,Ft),At=(1-di[1])*this.height*.5<pe}return xt<le||At})}return ye.sort((le,pe)=>le.distanceSq-pe.distanceSq).map(le=>le.tileID)}resize(a,n){this.width=a,this.height=n,this.pixelsToGLUnits=[2/a,-2/n],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(a){return Math.pow(2,a)}scaleZoom(a){return Math.log(a)/Math.LN2}project(a){const n=s.aa(a.lat,-s.bw,s.bw),_=this.projection.project(a.lng,n);return new s.P(_.x*this.worldSize,_.y*this.worldSize)}unproject(a){return this.projection.unproject(a.x/this.worldSize,a.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/s.bl(1,this.center.lat)/this.worldSize}setLocationAtPoint(a,n){let _,c;const f=this.centerPoint;if(this.projection.name==="globe"){const b=this.worldSize;_=(n.x-f.x)/b,c=(n.y-f.y)/b}else{const b=this.pointCoordinate(n),v=this.pointCoordinate(f);_=b.x-v.x,c=b.y-v.y}const g=this.locationCoordinate(a);this.setLocation(new s.L(g.x-_,g.y-c))}setLocation(a){this.center=this.coordinateLocation(a),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(a){return this.projection.locationPoint(this,a)}locationPoint3D(a){return this.projection.locationPoint(this,a,!0)}pointLocation(a){return this.coordinateLocation(this.pointCoordinate(a))}pointLocation3D(a){return this.coordinateLocation(this.pointCoordinate3D(a))}locationCoordinate(a,n){const _=n?s.bl(n,a.lat):void 0,c=this.projection.project(a.lng,a.lat);return new s.L(c.x,c.y,_)}coordinateLocation(a){return this.projection.unproject(a.x,a.y)}pointRayIntersection(a,n){const _=n??this._centerAltitude,c=[a.x,a.y,0,1],f=[a.x,a.y,1,1];s.a7.transformMat4(c,c,this.pixelMatrixInverse),s.a7.transformMat4(f,f,this.pixelMatrixInverse);const g=f[3];s.a7.scale(c,c,1/c[3]),s.a7.scale(f,f,1/g);const b=c[2],v=f[2];return{p0:c,p1:f,t:b===v?0:(_-b)/(v-b)}}screenPointToMercatorRay(a){const n=[a.x,a.y,0,1],_=[a.x,a.y,1,1];return s.a7.transformMat4(n,n,this.pixelMatrixInverse),s.a7.transformMat4(_,_,this.pixelMatrixInverse),s.a7.scale(n,n,1/n[3]),s.a7.scale(_,_,1/_[3]),n[2]=s.bl(n[2],this._center.lat)*this.worldSize,_[2]=s.bl(_[2],this._center.lat)*this.worldSize,s.a7.scale(n,n,1/this.worldSize),s.a7.scale(_,_,1/this.worldSize),new s.a2([n[0],n[1],n[2]],s.N.normalize([],s.N.sub([],_,n)))}rayIntersectionCoordinate(a){const{p0:n,p1:_,t:c}=a,f=s.bl(n[2],this._center.lat),g=s.bl(_[2],this._center.lat);return new s.L(s.U(n[0],_[0],c)/this.worldSize,s.U(n[1],_[1],c)/this.worldSize,s.U(f,g,c))}pointCoordinate(a,n=this._centerAltitude){return this.projection.pointCoordinate(this,a.x,a.y,n)}pointCoordinate3D(a){if(!this.elevation)return this.pointCoordinate(a);let n=this.projection.pointCoordinate3D(this,a.x,a.y);if(n)return new s.L(n[0],n[1],n[2]);let _=0,c=this.horizonLineFromTop();if(a.y>c)return this.pointCoordinate(a);const f=.02*c,g=a.clone();for(let b=0;b<10&&c-_>f;b++){g.y=s.U(_,c,.66);const v=this.projection.pointCoordinate3D(this,g.x,g.y);v?(c=g.y,n=v):_=g.y}return n?new s.L(n[0],n[1],n[2]):this.pointCoordinate(a)}isPointAboveHorizon(a){return this.projection.isPointAboveHorizon(this,a)}isPointOnSurface(a){if(a.y<0||a.y>this.height||a.x<0||a.x>this.width)return!1;if(this.elevation||this.zoom>=s.bx)return!this.isPointAboveHorizon(a);const n=this.pointCoordinate(a);return n.y>=0&&n.y<=1}_coordinatePoint(a,n){const _=n&&this.elevation?this.elevation.getAtPointOrZero(a,this._centerAltitude):this._centerAltitude,c=[a.x*this.worldSize,a.y*this.worldSize,_+a.toAltitude(),1];return s.a7.transformMat4(c,c,this.pixelMatrix),c[3]>0?new s.P(c[0]/c[3],c[1]/c[3]):new s.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:a,left:n}=this._edgeInsets,_=this.height-this._edgeInsets.bottom,c=this.width-this._edgeInsets.right,f=this.pointLocation3D(new s.P(n,a)),g=this.pointLocation3D(new s.P(c,a)),b=this.pointLocation3D(new s.P(c,_)),v=this.pointLocation3D(new s.P(n,_));let A=Math.min(f.lng,g.lng,b.lng,v.lng),O=Math.max(f.lng,g.lng,b.lng,v.lng),R=Math.min(f.lat,g.lat,b.lat,v.lat),P=Math.max(f.lat,g.lat,b.lat,v.lat);const N=Math.pow(2,-this.zoom)/16*270,U=this.projection.name==="globe"?1:4,B=(k,M,H,$,V)=>{const Z=(k+H)/2,z=(M+$)/2,X=new s.P(Z,z),{lng:ie,lat:ne}=this.pointLocation3D(X),re=Math.max(0,A-ie,R-ne,ie-O,ne-P);A=Math.min(A,ie),O=Math.max(O,ie),R=Math.min(R,ne),P=Math.max(P,ne),(V<U||re>N)&&(B(k,M,Z,z,V+1),B(Z,z,H,$,V+1))};if(B(n,a,c,a,1),B(c,a,c,_,1),B(c,_,n,_,1),B(n,_,n,a,1),this.projection.name==="globe"){const[k,M]=s.by(this);k?(P=90,O=180,A=-180):M&&(R=-90,O=180,A=-180)}return new s.ad(new s.bn(A,R),new s.bn(O,P))}_getBoundsRectangular(a,n){const{top:_,left:c}=this._edgeInsets,f=this.height-this._edgeInsets.bottom,g=this.width-this._edgeInsets.right,b=new s.P(c,_),v=new s.P(g,_),A=new s.P(g,f),O=new s.P(c,f);let R=this.pointCoordinate(b,a),P=this.pointCoordinate(v,a);const N=this.pointCoordinate(A,n),U=this.pointCoordinate(O,n),B=(k,M)=>(M.y-k.y)/(M.x-k.x);return R.y>1&&P.y>=0?R=new s.L((1-U.y)/B(U,R)+U.x,1):R.y<0&&P.y<=1&&(R=new s.L(-U.y/B(U,R)+U.x,0)),P.y>1&&R.y>=0?P=new s.L((1-N.y)/B(N,P)+N.x,1):P.y<0&&R.y<=1&&(P=new s.L(-N.y/B(N,P)+N.x,0)),new s.ad().extend(this.coordinateLocation(R)).extend(this.coordinateLocation(P)).extend(this.coordinateLocation(U)).extend(this.coordinateLocation(N))}_getBoundsRectangularTerrain(){const a=this.elevation;if(!a.visibleDemTiles.length||a.isUsingMockSource())return this._getBoundsRectangular(0,0);const n=a.visibleDemTiles.reduce((_,c)=>{if(c.dem){const f=c.dem.tree;_.min=Math.min(_.min,f.minimums[0]),_.max=Math.max(_.max,f.maximums[0])}return _},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(n.min*a.exaggeration(),n.max*a.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(a=!0){const n=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,_=this.height/2-n*(1-this._horizonShift);return a?Math.max(0,_):_}getMaxBounds(){return this.maxBounds}setMaxBounds(a){this.maxBounds=a,this.minLat=-s.bw,this.maxLat=s.bw,this.minLng=-180,this.maxLng=180,a&&(this.minLat=a.getSouth(),this.maxLat=a.getNorth(),this.minLng=a.getWest(),this.maxLng=a.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.a5(this.minLng)*this.tileSize,this.worldMaxX=s.a5(this.maxLng)*this.tileSize,this.worldMinY=s.ae(this.maxLat)*this.tileSize,this.worldMaxY=s.ae(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(a,n){return this.projection.createTileMatrix(this,n,a)}calculateDistanceTileData(a){const n=a.key,_=this._distanceTileDataCache;if(_[n])return _[n];const c=a.canonical,f=1/this.height,g=this.cameraWorldSize,b=g/this.zoomScale(c.z),v=(c.x+Math.pow(2,c.z)*a.wrap)*b,A=c.y*b,O=this.point;O.x*=g/this.worldSize,O.y*=g/this.worldSize;const R=this.angle,P=Math.sin(-R),N=-Math.cos(-R);return _[n]={bearing:[P,N],center:[(O.x-v)*f,(O.y-A)*f],scale:b/s.V*f},_[n]}calculateFogTileMatrix(a){const n=a.key,_=this._fogTileMatrixCache;if(_[n])return _[n];const c=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,a);return s.a6.multiply(c,this.worldToFogMatrix,c),_[n]=new Float32Array(c),_[n]}calculateProjMatrix(a,n=!1,_=!1){const c=a.key;let f;if(f=_?this._expandedProjMatrixCache:n?this._alignedProjMatrixCache:this._projMatrixCache,f[c])return f[c];const g=this.calculatePosMatrix(a,this.worldSize);let b;return b=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:_?this.expandedFarZProjMatrix:n?this.alignedProjMatrix:this.projMatrix,s.a6.multiply(g,b,g),f[c]=new Float32Array(g),f[c]}calculatePixelsToTileUnitsMatrix(a){const n=a.tileID.key,_=this._pixelsToTileUnitsCache;if(_[n])return _[n];const c=s.bz(a,this);return _[n]=c,_[n]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const a=1/this.worldSize,n=s.a6.fromScaling([],[a,a,a]);return s.a6.multiply(n,n,this.globeMatrix),n}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const a=this._elevation;this._updateCameraState();const n=s.bl(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(n),c=this._camera.forward(),f=s.bl(1,this._center.lat);_[2]/=f,c[2]/=f,s.N.normalize(c,c);const g=a.raycast(_,c,a.exaggeration());if(g){const b=s.N.scaleAndAdd([],_,c,g),v=new s.L(b[0],b[1],s.bl(b[2],s.au(b[1]))),A=(v.z+s.N.length([v.x-_[0],v.y-_[1],v.z-_[2]*f]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(A),this._centerAltitude=v.toAltitude(),this._center=this.coordinateLocation(v),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(a=!1){if(!this._elevation)return;const n=this._elevation,_=s.bl(1,this._center.lat)*this.worldSize,c=this._computeCameraPosition(_),f=n.getAtPointOrZero(new s.L(...c)),g=this.pixelsPerMeter/this.worldSize*f,b=this._minimumHeightOverTerrain(),v=c[2]-g;if(v<=b)if(v<0||a){const A=this.locationCoordinate(this._center,this._centerAltitude),O=[c[0],c[1],A.z-c[2]],R=s.N.length(O);O[2]-=(b-v)/this._pixelsPerMercatorPixel;const P=s.N.length(O);if(P===0)return;s.N.scale(O,O,R/P*this._pixelsPerMercatorPixel),this._camera.position=[c[0],c[1],A.z*this._pixelsPerMercatorPixel-O[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const a=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||a){const P=this.center;return P.lat=s.aa(P.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!a)&&(P.lng=s.aa(P.lng,this.minLng,this.maxLng)),this.center=P,void(this._constraining=!1)}const n=this._unmodified,{x:_,y:c}=this.point;let f=0,g=_,b=c;const v=this.width/2,A=this.height/2,O=this.worldMinY*this.scale,R=this.worldMaxY*this.scale;if(c-A<O&&(b=O+A),c+A>R&&(b=R-A),R-O<this.height&&(f=Math.max(f,this.height/(R-O)),b=(R+O)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const P=this.worldMinX*this.scale,N=this.worldMaxX*this.scale,U=this.worldSize/2-(P+N)/2;g=(_+U+this.worldSize)%this.worldSize-U,g-v<P&&(g=P+v),g+v>N&&(g=N-v),N-P<this.width&&(f=Math.max(f,this.width/(N-P)),g=(N+P)/2)}g===_&&b===c||(this.center=this.unproject(new s.P(g,b))),f&&(this.zoom+=this.scaleZoom(f)),this._constrainCamera(),this._unmodified=n,this._constraining=!1}_minZoomForBounds(){let a=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(a=Math.max(a,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),a}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const a=this.centerOffset,n=this.projection.name==="globe",_=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=s.bl(1,this.center.lat)/s.bl(1,s.bI));const c=s.bA(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,c),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const f=this.projection.zAxisUnit==="meters"?_:1,g=this._camera.getWorldToCamera(this.worldSize,f);let b;const v=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(v[8]=2*-a.x/this.width,v[9]=2*a.y/this.height,this.isOrthographic){let ne=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),re=ne*this.aspect,ye=-re,ue=-ne;re-=a.x,ye-=a.x,ne+=a.y,ue+=a.y,b=this._camera.getCameraToClipOrthographic(ye,re,ue,ne,this._nearZ,this._farZ),((Ie,Ee,Ue,ce)=>{for(let Te=0;Te<16;Te++)Ie[Te]=Bs(Ee[Te],Ue[Te],ce)})(b,b,v,Rl(this.pitch>=15?1:this.pitch/15))}else b=v;const A=s.a6.mul([],v,g);let O=s.a6.mul([],b,g);if(this.projection.isReprojectedInTileSpace){const ne=this.locationCoordinate(this.center),re=s.a6.identity([]);s.a6.translate(re,re,[ne.x*this.worldSize,ne.y*this.worldSize,0]),s.a6.multiply(re,re,s.bB(this)),s.a6.translate(re,re,[-ne.x*this.worldSize,-ne.y*this.worldSize,0]),s.a6.multiply(O,O,re),s.a6.multiply(A,A,re),this.inverseAdjustmentMatrix=s.bC(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=s.a6.scale([],O,[this.worldSize,this.worldSize,this.worldSize/f,1]),this.projMatrix=O,this.invProjMatrix=s.a6.invert(new Float64Array(16),this.projMatrix),n){const ne=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);ne[8]=2*-a.x/this.width,ne[9]=2*a.y/this.height,this.expandedFarZProjMatrix=s.a6.mul([],ne,g)}else this.expandedFarZProjMatrix=this.projMatrix;const R=s.a6.invert([],b);this.frustumCorners=s.bD.fromInvProjectionMatrix(R,this.horizonLineFromTop(),this.height),this.cameraFrustum=s.bq.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!n);const P=new Float32Array(16);s.a6.identity(P),s.a6.scale(P,P,[1,-1,1]),s.a6.rotateX(P,P,this._pitch),s.a6.rotateZ(P,P,this.angle);const N=s.a6.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=s.a6.clone(N);const U=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;N[8]=2*-a.x/this.width,N[9]=2*(a.y+U)/this.height,this.skyboxMatrix=s.a6.multiply(P,N,P);const B=this.point,k=B.x,M=B.y,H=this.width%2/2,$=this.height%2/2,V=Math.cos(this.angle),Z=Math.sin(this.angle),z=k-Math.round(k)+V*H+Z*$,X=M-Math.round(M)+V*$+Z*H,ie=new Float64Array(O);if(s.a6.translate(ie,ie,[z>.5?z-1:z,X>.5?X-1:X,0]),this.alignedProjMatrix=ie,O=s.a6.create(),s.a6.scale(O,O,[this.width/2,-this.height/2,1]),s.a6.translate(O,O,[1,-1,0]),this.labelPlaneMatrix=O,O=s.a6.create(),s.a6.scale(O,O,[1,-1,1]),s.a6.translate(O,O,[-1,-1,0]),s.a6.scale(O,O,[2/this.width,2/this.height,1]),this.glCoordMatrix=O,this.pixelMatrix=s.a6.multiply(new Float64Array(16),this.labelPlaneMatrix,A),this._calcFogMatrices(),this._distanceTileDataCache={},O=s.a6.invert(new Float64Array(16),this.pixelMatrix),!O)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=O,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=s.bE(this);const ne=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=s.N.transformMat4(ne,ne,g),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=O;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const a=this.cameraWorldSizeForFog,n=this.cameraPixelsPerMeter,_=this._camera.position,c=1/this.height/this._pixelsPerMercatorPixel,f=[a,a,n];s.N.scale(f,f,c),s.N.scale(_,_,-1),s.N.multiply(_,_,f);const g=s.a6.create();s.a6.translate(g,g,_),s.a6.scale(g,g,f),this.mercatorFogMatrix=g,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(a,n,c)}_computeCameraPosition(a){const n=(a=a||this.pixelsPerMeter)/this.pixelsPerMeter,_=this._camera.forward(),c=this.point,f=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*n-a/this.worldSize*this._centerAltitude;return[c.x/this.worldSize-_[0]*f,c.y/this.worldSize-_[1]*f,a/this.worldSize*this._centerAltitude-_[2]*f]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(a){const n=this._maxCameraBoundsDistance()*Math.cos(this._pitch),_=this._camera.position[2],c=a[2];let f=1;this.projection.wrap&&(this.center=this.center.wrap()),c>0&&(f=Math.min((n-_)/c,1)),this._camera.position=s.N.scaleAndAdd([],this._camera.position,a,f),this._updateStateFromCamera()}_updateStateFromCamera(){const a=this._camera.position,n=this._camera.forward(),{pitch:_,bearing:c}=this._camera.getPitchBearing(),f=s.bl(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,g=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.bj(this._maxPitch)),b=Math.max((a[2]-f)/Math.cos(_),g),v=this._zoomFromMercatorZ(b);s.N.scaleAndAdd(a,a,n,b),this._pitch=s.aa(_,s.bj(this.minPitch),s.bj(this.maxPitch)),this.angle=s.bh(c,-Math.PI,Math.PI),this._setZoom(s.aa(v,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new s.L(a[0],a[1],a[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(a){return Math.pow(2,a)*this.tileSize}_mercatorZfromZoom(a){return this.cameraToCenterDistance/this._worldSizeFromZoom(a)}_minimumHeightOverTerrain(){const a=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(a)}_zoomFromMercatorZ(a){return this.scaleZoom(this.cameraToCenterDistance/(a*this.tileSize))}zoomFromMercatorZAdjusted(a){let n=0,_=s.bx,c=0,f=1/0;for(;_-n>1e-6&&_>n;){const g=n+.5*(_-n),b=this.tileSize*Math.pow(2,g),v=this.getCameraToCenterDistance(this.projection,g,b),A=this.scaleZoom(v/(a*this.tileSize)),O=Math.abs(g-A);O<f&&(f=O,c=g),g<A?n=g:_=g}return c}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(s.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(a,n){const _=Math.min(a.x,n.x),c=Math.max(a.x,n.x),f=Math.min(a.y,n.y),g=Math.max(a.y,n.y);if(f<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const b=[new s.P(_,f),new s.P(c,g),new s.P(_,g),new s.P(c,f)],v=this.renderWorldCopies?-3:0,A=this.renderWorldCopies?4:1;for(const O of b){const R=this.pointRayIntersection(O);if(R.t<0)return!0;const P=this.rayIntersectionCoordinate(R);if(P.x<v||P.y<0||P.x>A||P.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.bF(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.P(0,0),new s.P(this.width,this.height))}zoomDeltaToMovement(a,n){const _=s.N.length(s.N.sub([],this._camera.position,a)),c=this._zoomFromMercatorZ(_)+n;return _-this._mercatorZfromZoom(c)}getCameraPoint(){if(this.projection.name==="globe"){const a=function([n,_,c],f){const g=[n,_,c,1];s.a7.transformMat4(g,g,f);const b=g[3]=Math.max(g[3],1e-6);return g[0]/=b,g[1]/=b,g[2]/=b,g}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new s.P(a[0],a[1])}{const a=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.P(0,a))}}getCameraToCenterDistance(a,n=this.zoom,_=this.worldSize){const c=s.bA(a,n,this.width,this.height,1024),f=a.pixelSpaceConversion(this.center.lat,_,c);let g=.5/Math.tan(.5*this._fov)*this.height*f;return this.isOrthographic&&(g=Bs(1,g,Rl(this.pitch>=15?1:this.pitch/15))),g}getWorldToCameraMatrix(){const a=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&s.a6.multiply(a,a,this.globeMatrix),a}getFrustum(a){return s.bq.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,a,this.projection.zAxisUnit==="meters")}}const Fa={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,ShadowMap0:10},Nn=(d,a)=>{if(a>0&&d.terrain&&s.w("Cutoff is currently disabled on terrain"),a<=0||d.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const n=d.transform,_=Math.max(Math.abs(n._zoom-(d.minCutoffZoom-1)),1),c=n.isLODDisabled(!1)?s.O(60,45,n.pitch):s.O(30,15,n.pitch),f=n._farZ-n._nearZ,g=a*n.height,b=((1-(v=c))*n.cameraToCenterDistance+v*(n._farZ+g))*_;var v;return{shouldRenderCutoff:c<1,uniformValues:{u_cutoff_params:[n._nearZ,n._farZ,(b-n._nearZ)/f,(b-g-n._nearZ)/f]}}},qa={cascadeCount:2,shadowMapResolution:2048};class l_{constructor(a,n){this.aabb=a,this.lastCascade=n}}class tc{add(a,n){const _=this.receivers[a.key];_!==void 0?(_.aabb.min[0]=Math.min(_.aabb.min[0],n.min[0]),_.aabb.min[1]=Math.min(_.aabb.min[1],n.min[1]),_.aabb.min[2]=Math.min(_.aabb.min[2],n.min[2]),_.aabb.max[0]=Math.max(_.aabb.max[0],n.max[0]),_.aabb.max[1]=Math.max(_.aabb.max[1],n.max[1]),_.aabb.max[2]=Math.max(_.aabb.max[2],n.max[2])):this.receivers[a.key]=new l_(n,null)}clear(){this.receivers={}}get(a){return this.receivers[a.key]}computeRequiredCascades(a,n,_){const c=s.bS.fromPoints(a.points);let f=0;for(const g in this.receivers){const b=this.receivers[g];if(!b||!c.intersectsAabb(b.aabb))continue;b.aabb.min=c.closestPoint(b.aabb.min),b.aabb.max=c.closestPoint(b.aabb.max);const v=b.aabb.getCorners();for(let A=0;A<_.length;A++){let O=!0;for(const R of v){const P=[R[0]*n,R[1]*n,R[2]];if(s.N.transformMat4(P,P,_[A].matrix),P[0]<-1||P[0]>1||P[1]<-1||P[1]>1){O=!1;break}}if(b.lastCascade=A,f=Math.max(f,A),O)break}}return f+1}}class r_{constructor(a){this.painter=a,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new tc,this._depthMode=new wt(a.context.gl.LEQUAL,wt.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this.useNormalOffset=!1,a.tp.registerParameter(qa,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),a.tp.registerParameter(qa,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32})}destroy(){for(const a of this._cascades)a.texture.destroy(),a.framebuffer.destroy();this._cascades=[]}updateShadowParameters(a,n){const _=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!n||!n.properties)return;const c=n.properties.get("shadow-intensity");if(!n.shadowsEnabled()||c<=0||(this._shadowLayerCount=_.style.order.reduce((U,B)=>{const k=_.style._mergedLayers[B];return U+(k.hasShadowPass()&&!k.isHidden(a.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this._enabled))return;const f=_.context,g=qa.shadowMapResolution,b=qa.shadowMapResolution;if(this._cascades.length===0||qa.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let U=0;U<qa.cascadeCount;++U){const B=_._shadowMapDebug,k=f.gl,M=f.createFramebuffer(g,b,B,"texture"),H=new s.T(f,{width:g,height:b,data:null},k.DEPTH_COMPONENT);if(M.depthAttachment.set(H.texture),B){const $=new s.T(f,{width:g,height:b,data:null},k.RGBA);M.colorAttachment.set($.texture)}this._cascades.push({framebuffer:M,texture:H,matrix:[],far:0,boundingSphereRadius:0,frustum:new s.bq,scale:0})}}this.shadowDirection=Pr(n);let v=0;if(a.elevation){const U=a.elevation,B=[1e4,-1e4];U.visibleDemTiles.filter(k=>k.dem).forEach(k=>{const M=k.dem.tree;B[0]=Math.min(B[0],M.minimums[0]),B[1]=Math.max(B[1],M.maximums[0])}),B[0]!==1e4&&(v=(B[1]-B[0])*U.exaggeration())}const A=1.5*a.cameraToCenterDistance,O=3*A,R=new Float64Array(16);for(let U=0;U<this._cascades.length;++U){const B=this._cascades[U];let k=a.height/50,M=1;qa.cascadeCount===1?M=O:U===0?M=A:(k=A,M=O);const[H,$]=ic(a,this.shadowDirection,k,M,qa.shadowMapResolution,v);B.scale=a.scale,B.matrix=H,B.boundingSphereRadius=$,s.a6.invert(R,B.matrix),B.frustum=s.bq.fromInvProjectionMatrix(R,1,0,!0),B.far=M}const P=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[P].far,this._cascades[P].far],this._uniformValues.u_shadow_intensity=c,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/qa.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=qa.shadowMapResolution,this._uniformValues.u_shadowmap_0=Fa.ShadowMap0,this._uniformValues.u_shadowmap_1=Fa.ShadowMap0+1,this._groundShadowTiles=_.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const N=_.transform.elevation;for(const U of this._groundShadowTiles){let B={min:0,max:0};if(N){const k=N.getMinMaxForTile(U);k&&(B=k)}this.addShadowReceiver(U.toUnwrapped(),B.min,B.max)}}get enabled(){return this._enabled}set enabled(a){this._enabled=a}drawShadowPass(a,n){if(!this._enabled)return;const _=this.painter,c=_.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(_.transform.getFrustum(0),_.transform.worldSize,this._cascades),c.viewport.set([0,0,qa.shadowMapResolution,qa.shadowMapResolution]);for(let f=0;f<this._numCascadesToRender;++f){_.currentShadowCascade=f,c.bindFramebuffer.set(this._cascades[f].framebuffer.framebuffer),c.clear({color:s.ax.white,depth:1});for(const g of a.order){const b=a._mergedLayers[g];if(!b.hasShadowPass()||b.isHidden(_.transform.zoom))continue;const v=a.getLayerSourceCache(b),A=v?n[v.id]:void 0;(b.type==="model"||A&&A.length)&&_.renderLayer(_,v,b,A)}}_.currentShadowCascade=0}drawGroundShadows(){if(!this._enabled)return;const a=this.painter,n=a.style,_=a.context,c=n.directionalLight,f=n.ambientLight;if(!c||!f)return;const g=[],b=Nn(a,a.longestCutoffRange);b.shouldRenderCutoff&&g.push("RENDER_CUTOFF");const v=wl(c,f),A=new wt(_.gl.LEQUAL,wt.ReadOnly,a.depthRangeFor3D);for(const O of this._groundShadowTiles){const R=O.toUnwrapped(),P=a.isTileAffectedByFog(O),N=a.getOrCreateProgram("groundShadow",{defines:g,overrideFog:P});this.setupShadows(R,N),a.uploadCommonUniforms(_,N,R,null,b);const U={u_matrix:a.transform.calculateProjMatrix(R),u_ground_shadow_factor:v};N.draw(a,_.gl.TRIANGLES,A,Bt.disabled,Jt.multiply,Pt.disabled,U,"ground_shadow",a.tileExtentBuffer,a.quadTriangleIndexBuffer,a.tileExtentSegments,{},a.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Jt.unblended:Jt.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(a){const n=this.painter.transform,_=n.calculatePosMatrix(a,n.worldSize);return s.a6.multiply(_,this._cascades[this.painter.currentShadowCascade].matrix,_),Float32Array.from(_)}calculateShadowPassMatrixFromMatrix(a){return s.a6.multiply(a,this._cascades[this.painter.currentShadowCascade].matrix,a),Float32Array.from(a)}setupShadows(a,n,_,c=0){if(!this._enabled)return;const f=this.painter.transform,g=this.painter.context,b=g.gl,v=this._uniformValues,A=new Float64Array(16),O=f.calculatePosMatrix(a,f.worldSize);for(let R=0;R<this._cascades.length;R++)s.a6.multiply(A,this._cascades[R].matrix,O),v[R===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(A),g.activeTexture.set(b.TEXTURE0+Fa.ShadowMap0+R),this._cascades[R].texture.bind(b.NEAREST,b.CLAMP_TO_EDGE);if(this.useNormalOffset=!!_,this.useNormalOffset){const R=s.bR(a.canonical),P=2/f.tileSize*s.V/qa.shadowMapResolution,N=P*this._cascades[0].boundingSphereRadius,U=P*this._cascades[this._cascades.length-1].boundingSphereRadius,B=(_==="vector-tile"?1:3)/Math.pow(2,c-a.canonical.z-(1-f.zoom+Math.floor(f.zoom)));v.u_shadow_normal_offset=[R,N*B,U*B],v.u_shadow_bias=[6e-5,.0012,.012]}else v.u_shadow_bias=[36e-5,.0012,.012];n.setShadowUniformValues(g,v)}setupShadowsFromMatrix(a,n,_=!1){if(!this._enabled)return;const c=this.painter.context,f=c.gl,g=this._uniformValues,b=new Float64Array(16);for(let v=0;v<qa.cascadeCount;v++)s.a6.multiply(b,this._cascades[v].matrix,a),g[v===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(b),c.activeTexture.set(f.TEXTURE0+Fa.ShadowMap0+v),this._cascades[v].texture.bind(f.NEAREST,f.CLAMP_TO_EDGE);this.useNormalOffset=_,_?(g.u_shadow_normal_offset=[1,5,5],g.u_shadow_bias=[6e-5,.0012,.012]):g.u_shadow_bias=[36e-5,.0012,.012],n.setShadowUniformValues(c,g)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(a,n,_,c){if(c[2]>=0)return{};const f=function(v,A,O){const R=O/(1<<v.canonical.z);return new s.bS([v.canonical.x*R+v.wrap*O,v.canonical.y*R+v.wrap*O,0],[(v.canonical.x+1)*R+v.wrap*O,(v.canonical.y+1)*R+v.wrap*O,A])}(a,n,_).getCorners(),g=n/-c[2];c[0]<0?(s.N.add(f[0],f[0],[c[0]*g,0,0]),s.N.add(f[3],f[3],[c[0]*g,0,0])):c[0]>0&&(s.N.add(f[1],f[1],[c[0]*g,0,0]),s.N.add(f[2],f[2],[c[0]*g,0,0])),c[1]<0?(s.N.add(f[0],f[0],[0,c[1]*g,0]),s.N.add(f[1],f[1],[0,c[1]*g,0])):c[1]>0&&(s.N.add(f[2],f[2],[0,c[1]*g,0]),s.N.add(f[3],f[3],[0,c[1]*g,0]));const b={};return b.vertices=f,b.planes=[rs(f[1],f[0],f[4]),rs(f[2],f[1],f[5]),rs(f[3],f[2],f[6]),rs(f[0],f[3],f[7])],b}addShadowReceiver(a,n,_){this._receivers.add(a,s.bS.fromTileIdAndHeight(a,n,_))}getMaxCascadeForTile(a){const n=this._receivers.get(a);return n&&n.lastCascade?n.lastCascade:0}}function rs(d,a,n){const _=s.N.sub([],n,a),c=s.N.sub([],d,a),f=s.N.cross([],_,c),g=s.N.length(f);return g===0?[0,0,1,0]:(s.N.scale(f,f,1/g),[f[0],f[1],f[2],-s.N.dot(f,a)])}function Pr(d){const a=d.properties.get("direction"),n=s.bQ(a.x,a.y,a.z);n[2]=s.aa(n[2],0,75);const _=s.bT([n[0],n[1],n[2]]);return s.N.fromValues(_.x,_.y,_.z)}function wl(d,a){const n=d.properties.get("color"),_=d.properties.get("intensity"),c=d.properties.get("direction"),f=[c.x,c.y,c.z],g=a.properties.get("color"),b=a.properties.get("intensity"),v=Math.max(s.N.dot([0,0,1],f),0),A=[0,0,0];s.N.scale(A,g.toArray01Linear().slice(0,3),b);const O=[0,0,0];return s.N.scale(O,n.toArray01Linear().slice(0,3),v*_),s.bU([A[0]>0?A[0]/(A[0]+O[0]):0,A[1]>0?A[1]/(A[1]+O[1]):0,A[2]>0?A[2]/(A[2]+O[2]):0])}function ic(d,a,n,_,c,f){const g=d.zoom,b=d.scale,v=d.worldSize,A=1/v,O=d.aspect,R=Math.sqrt(1+O*O)*Math.tan(.5*d.fovX),P=R*R,N=_-n,U=_+n;let B,k;P>N/U?(B=_,k=_*R):(B=.5*U*(1+P),k=.5*Math.sqrt(N*N+2*(_*_+n*n)*P+U*U*P*P));const M=d.projection.pixelsPerMeter(d.center.lat,v),H=d._camera.getCameraToWorldMercator(),$=[0,0,-B*A];s.N.transformMat4($,$,H);let V=k*A;const Z=d._edgeInsets;if(!(Z.left===0&&Z.top===0&&Z.right===0&&Z.bottom===0||Z.left===Z.right&&Z.top===Z.bottom)){const $e=d._camera.getWorldToCamera(d.worldSize,d.projection.zAxisUnit==="meters"?M:1),je=d._camera.getCameraToClipPerspective(d._fov,d.width/d.height,n,_);je[8]=2*-d.centerOffset.x/d.width,je[9]=2*d.centerOffset.y/d.height;const it=new Float64Array(16);s.a6.mul(it,je,$e);const ht=new Float64Array(16);s.a6.invert(ht,it);const St=s.bq.fromInvProjectionMatrix(ht,v,g,!0);for(const xt of St.points){const At=((z=xt)[0]/=b,z[1]/=b,z[2]=s.bl(z[2],d._center.lat),z);V=Math.max(V,s.N.len(s.N.subtract([],$,At)))}}var z;V*=c/(c-1);const X=Math.acos(a[2]),ie=Math.atan2(-a[0],-a[1]),ne=new Fs;ne.position=$,ne.setPitchBearing(X,ie);const re=ne.getWorldToCamera(v,M),ye=V*v,ue=Math.min(d._mercatorZfromZoom(17)*v*-2,-2*ye),Ie=ne.getCameraToClipOrthographic(-ye,ye,-ye,ye,ue,(ye+f*M)/a[2]),Ee=new Float64Array(16);s.a6.multiply(Ee,Ie,re);const Ue=s.N.fromValues(Math.floor(1e6*$[0])/1e6*v,Math.floor(1e6*$[1])/1e6*v,0),ce=.5*c,Te=[0,0,0];s.N.transformMat4(Te,Ue,Ee),s.N.scale(Te,Te,ce);const le=[Math.floor(Te[0]),Math.floor(Te[1]),Math.floor(Te[2])],pe=[0,0,0];s.N.sub(pe,Te,le),s.N.scale(pe,pe,-1/ce);const ke=new Float64Array(16);return s.a6.identity(ke),s.a6.translate(ke,ke,pe),s.a6.multiply(Ee,ke,Ee),[Ee,ye]}const Wn=(d,a)=>Tt(d,a&&a.filter(n=>n.identifier!=="source.canvas")),ac=s.ac(ri,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","updateImport"]),Us=s.ac(ri,["setCenter","setZoom","setBearing","setPitch"]),d_={version:8,layers:[],sources:{}},oc={duration:300,delay:0},bf=new Set(["fill","line","background","hillshade","raster"]);class Fo extends s.E{constructor(a,n={}){super(),this.map=a,this.scope=n.scope||"",this.fragments=[],this.importDepth=n.importDepth||0,this.importsCache=n.importsCache||new Map,this.resolvedImports=n.resolvedImports||new Set,this.transition=s.e({},oc),this._buildingIndex=new qu(this),this.crossTileSymbolIndex=new n_,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=n.styleChanges||new yo,this.dispatcher=n.dispatcher?n.dispatcher:new s.bW(s.bX(),this),n.imageManager?this.imageManager=n.imageManager:(this.imageManager=new ka,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=n.glyphManager?n.glyphManager:new s.bY(a._requestManager,n.localFontFamily?s.bZ.all:n.localIdeographFontFamily?s.bZ.ideographs:s.bZ.none,n.localFontFamily||n.localIdeographFontFamily),n.modelManager?this.modelManager=n.modelManager:(this.modelManager=new En(a._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=n.configOptions?n.configOptions:new Map,this._configDependentLayers=n.configDependentLayers?n.configDependentLayers:new Set,this._config=n.config,this.dispatcher.broadcast("setReferrer",s.b_());const _=this;this._rtlTextPluginCallback=Fo.registerForPluginStateChange(c=>{_.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:c.pluginStatus,pluginURL:c.pluginURL},(f,g)=>{if(s.b$(f),g&&g.every(b=>b))for(const b in _._sourceCaches){const v=_._sourceCaches[b],A=v.getSource().type;A!=="vector"&&A!=="geojson"||v.reload()}})}),this.on("data",c=>{if(c.dataType!=="source"||c.sourceDataType!=="metadata")return;const f=this.getOwnSource(c.sourceId);if(f&&f.vectorLayerIds)for(const g in this._layers){const b=this._layers[g];b.source===f.id&&this._validateLayer(b)}})}loadURL(a,n={}){this.fire(new s.b("dataloading",{dataType:"style"}));const _=typeof n.validate=="boolean"?n.validate:!s.c0(a);a=this.map._requestManager.normalizeStyleURL(a,n.accessToken),this.resolvedImports.add(a);const c=this.importsCache.get(a);if(c)return this._load(c,_);const f=this.map._requestManager.transformRequest(a,s.R.Style);this._request=s.g(f,(g,b)=>{if(this._request=null,g)this.fire(new s.a(g));else if(b)return this.importsCache.set(a,b),this._load(b,_)})}loadJSON(a,n={}){this.fire(new s.b("dataloading",{dataType:"style"})),this._request=s.f.frame(()=>{this._request=null,this._load(a,n.validate!==!1)})}loadEmpty(){this.fire(new s.b("dataloading",{dataType:"style"})),this._load(d_,!1)}_loadImports(a,n,_){if(this.importDepth>=4)return s.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const c=[];for(const f of a){const g=this._createFragmentStyle(f),b=new Promise(O=>{g.once("style.import.load",O),g.once("error",O)}).then(()=>this.mergeAll());if(c.push(b),this.resolvedImports.has(f.url)){g.loadEmpty();continue}const v=f.data||this.importsCache.get(f.url);v?g.loadJSON(v,{validate:n}):f.url?g.loadURL(f.url,{validate:n}):g.loadEmpty();const A={style:g,id:f.id,config:f.config};if(_){const O=this.fragments.findIndex(({id:R})=>R===_);this.fragments=this.fragments.slice(0,O).concat(A).concat(this.fragments.slice(O))}else this.fragments.push(A)}return Promise.allSettled(c)}_createFragmentStyle(a){const n=this.scope?s.ag(a.id,this.scope):a.id,_=new Fo(this.map,{scope:n,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:a.config,configOptions:this.options,configDependentLayers:this._configDependentLayers});return _.setEventedParent(this.map,{style:_}),_}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options});const a=this.isRootStyle();this._shouldPrecompile=a,this.fire(new s.b(a?"style.load":"style.import.load"))}_load(a,n){const _=a.schema;if(this.isRootStyle()&&(a.fragment||_&&a.fragment!==!1)){const g=s.e({},d_,{imports:[{id:"basemap",data:a,url:""}]});return void this._load(g,n)}if(this.setConfig(this._config,_),n&&Wn(this,xo(a)))return;this._loaded=!0,this.stylesheet=s.c1(a);for(const g in a.sources)this.addSource(g,a.sources[g],{validate:!1,isInitialLoad:!0});a.sprite?this._loadSprite(a.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(a.glyphs,this.scope);const c=$u(this.stylesheet.layers);if(this._order=c.map(g=>g.id),this.stylesheet.light&&s.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const g=this.stylesheet.lights[0];this.light=new vt(g.properties,g.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new vt(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const g of c){const b=s.c2(g,this.scope,this.options);b.isConfigDependent&&this._configDependentLayers.add(b.fqid),b.setEventedParent(this,{layer:{id:b.id}}),this._layers[b.id]=b,this._serializedLayers[b.id]=b.serialize();const v=this.getOwnLayerSourceCache(b),A=!!this.directionalLight&&this.directionalLight.shadowsEnabled();v&&b.canCastShadows()&&A&&(v.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const f=this.stylesheet.terrain;f&&(this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=s.f.hasCanvasFingerprintNoise()),this.disableElevatedTerrain?s.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."):this.terrainSetForDrapingOnly()||this._createTerrain(f,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new s.b("data",{dataType:"style"})),a.imports?this._loadImports(a.imports,n).then(()=>this._reloadImports()):this._reloadImports()}isRootStyle(){return this.importDepth===0}mergeAll(){let a,n,_,c,f,g,b,v;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(A=>{if(A.stylesheet){if(A.light!=null&&(a=A.light),A.stylesheet.lights)for(const O of A.stylesheet.lights)O.type==="ambient"&&A.ambientLight!=null&&(n=A.ambientLight),O.type==="directional"&&A.directionalLight!=null&&(_=A.directionalLight);c=this._prioritizeTerrain(c,A.terrain,A.stylesheet.terrain),A.stylesheet.fog&&A.fog!=null&&(f=A.fog),A.stylesheet.camera!=null&&(v=A.stylesheet.camera),A.stylesheet.projection!=null&&(g=A.stylesheet.projection),A.stylesheet.transition!=null&&(b=A.stylesheet.transition)}}),this.light=a,this.ambientLight=n,this.directionalLight=_,this.fog=f,c===null?delete this.terrain:this.terrain=c,this.camera=v||{"camera-projection":"perspective"},this.projection=g||{name:"mercator"},this.transition=s.e({},oc,b),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(a){const n=_=>{for(const c of _.fragments)n(c.style);a(_)};n(this)}_prioritizeTerrain(a,n,_){const c=a&&a.drapeRenderMode===0;return _===null?n&&n.drapeRenderMode===0?n:c?a:null:n!=null&&(!a||c||n&&n.drapeRenderMode===1)?n:a}mergeTerrain(){let a;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(n=>{a=this._prioritizeTerrain(a,n.terrain,n.stylesheet.terrain)}),a===null?delete this.terrain:this.terrain=a}mergeProjection(){let a;this.forEachFragmentStyle(n=>{n.stylesheet.projection!=null&&(a=n.stylesheet.projection)}),this.projection=a||{name:"mercator"}}mergeSources(){const a={},n={},_={};this.forEachFragmentStyle(c=>{for(const f in c._sourceCaches){const g=s.ag(f,c.scope);a[g]=c._sourceCaches[f]}for(const f in c._otherSourceCaches){const g=s.ag(f,c.scope);n[g]=c._otherSourceCaches[f]}for(const f in c._symbolSourceCaches){const g=s.ag(f,c.scope);_[g]=c._symbolSourceCaches[f]}}),this._mergedSourceCaches=a,this._mergedOtherSourceCaches=n,this._mergedSymbolSourceCaches=_}mergeLayers(){const a={},n=[],_={};this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(f=>{for(const g of f._order){const b=f._layers[g];if(b.type==="slot"){const v=s.c3(g);if(a[v])continue;a[v]=[]}b.slot&&a[b.slot]?a[b.slot].push(b):n.push(b)}}),this._mergedOrder=[];const c=(f=[])=>{for(const g of f)if(g.type==="slot"){const b=s.c3(g.id);a[b]&&c(a[b])}else{const b=s.ag(g.id,g.scope);this._mergedOrder.push(b),_[b]=g,g.is3D()&&(this._has3DLayers=!0),g.type==="circle"&&(this._hasCircleLayers=!0),g.type==="symbol"&&(this._hasSymbolLayers=!0)}};c(n),this._mergedLayers=_,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(a){return this.stylesheet.camera=s.e({},this.stylesheet.camera,a),this.camera=this.stylesheet.camera,this}setProjection(a){a?this.stylesheet.projection=a:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(a){this._spriteRequest=function(n,_,c){let f,g,b;const v=s.f.devicePixelRatio>1?"@2x":"";let A=s.g(_.transformRequest(_.normalizeSpriteURL(n,v,".json"),s.R.SpriteJSON),(P,N)=>{A=null,b||(b=P,f=N,R())}),O=s.d(_.transformRequest(_.normalizeSpriteURL(n,v,".png"),s.R.SpriteImage),(P,N)=>{O=null,b||(b=P,g=N,R())});function R(){if(b)c(b);else if(f&&g){const P=s.f.getImageData(g),N={};for(const U in f){const{width:B,height:k,x:M,y:H,sdf:$,pixelRatio:V,stretchX:Z,stretchY:z,content:X}=f[U],ie=new s.h({width:B,height:k});s.h.copy(P,ie,{x:M,y:H},{x:0,y:0},{width:B,height:k}),N[U]={data:ie,pixelRatio:V,sdf:$,stretchX:Z,stretchY:z,content:X}}c(null,N)}}return{cancel(){A&&(A.cancel(),A=null),O&&(O.cancel(),O=null)}}}(a,this.map._requestManager,(n,_)=>{if(this._spriteRequest=null,n)this.fire(new s.a(n));else if(_)for(const c in _)this.imageManager.addImage(c,this.scope,_[c]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new s.b("data",{dataType:"style"}))})}_validateLayer(a){const n=this.getOwnSource(a.source);if(!n)return;const _=a.sourceLayer;_&&(n.type==="geojson"||n.vectorLayerIds&&n.vectorLayerIds.indexOf(_)===-1)&&this.fire(new s.a(new Error(`Source layer "${_}" does not exist on source "${n.id}" as specified by style layer "${a.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const a in this._sourceCaches)if(!this._sourceCaches[a].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded())return!1;for(const{style:a}of this.fragments)if(!a.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((a,n)=>{const _=this.fragments[n];return _&&_.style&&(a.data=_.style.serialize()),a})}_serializeSources(){const a={};for(const n in this._sourceCaches){const _=this._sourceCaches[n].getSource();a[_.id]||(a[_.id]=_.serialize())}return a}_serializeLayers(a){const n=[];for(const _ of a){const c=this._layers[_];c&&c.type!=="custom"&&n.push(c.serialize())}return n}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const a in this._sourceCaches)if(this._sourceCaches[a].hasTransition())return!0;for(const a in this._layers)if(this._layers[a].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(a){return!!this.terrain&&(typeof a.isLayerDraped=="function"?a.isLayerDraped(this.getLayerSourceCache(a)):bf.has(a.type))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(a){const n=this.getOwnLayer(a);if(n)return n;this.fire(new s.a(new Error(`The layer '${a}' does not exist in the map's style.`)))}_checkSource(a){const n=this.getOwnSource(a);if(n)return n;this.fire(new s.a(new Error(`The source '${a}' does not exist in the map's style.`)))}update(a){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(a),this.directionalLight&&this.directionalLight.recalculate(a);const n=this.calculateLightsBrightness();a.brightness=n||0,n!==this._brightness&&(this._brightness=n,this.dispatcher.broadcast("setBrightness",n));const _=this._changes.isDirty();if(this._changes.isDirty()){const f=this._changes.getLayerUpdatesByScope();for(const g in f){const{updatedIds:b,removedIds:v}=f[g];(b||v)&&this._updateWorkerLayers(g,b,v)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(a),this.light&&this.light.updateTransitions(a),this.ambientLight&&this.ambientLight.updateTransitions(a),this.directionalLight&&this.directionalLight.updateTransitions(a),this.fog&&this.fog.updateTransitions(a),this._changes.reset()}const c={};for(const f in this._mergedSourceCaches){const g=this._mergedSourceCaches[f];c[f]=g.used,g.used=!1,g.tileCoverLift=0}for(const f of this._mergedOrder){const g=this._mergedLayers[f];if(g.recalculate(a,this._availableImages),!g.isHidden(a.zoom)){const b=this.getLayerSourceCache(g);b&&(b.used=!0,b.tileCoverLift=Math.max(b.tileCoverLift,g.tileCoverLift()))}if(!this._precompileDone&&this._shouldPrecompile)for(let b=g.minzoom||0;b<(g.maxzoom||25.5);b++){const v=this.map.painter;if(v){const A=g.getProgramIds();if(!A)continue;for(const O of A){const R=g.getDefaultProgramParams(O,a.zoom);R&&(v.style=this,this.fog&&(v._fogVisible=!0,R.overrideFog=!0,v.getOrCreateProgram(O,R)),v._fogVisible=!1,R.overrideFog=!1,v.getOrCreateProgram(O,R),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(R.overrideRtt=!0,v.getOrCreateProgram(O,R)))}}}}this._shouldPrecompile&&(this._precompileDone=!0);for(const f in c){const g=this._mergedSourceCaches[f];c[f]!==g.used&&g.getSource().fire(new s.b("data",{sourceDataType:"visibility",dataType:"source",sourceId:g.getSource().id}))}this.light&&this.light.recalculate(a),this.terrain&&this.terrain.recalculate(a),this.fog&&this.fog.recalculate(a),this.z=a.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),_&&this.fire(new s.b("data",{dataType:"style"}))}_updateTilesForChangedImages(){const a=this._changes.getUpdatedImages();if(a.length){for(const n in this._sourceCaches)this._sourceCaches[n].reloadTilesForDependencies(["icons","patterns"],a);this._changes.resetUpdatedImages()}}_updateWorkerLayers(a,n,_){const c=this.getFragmentStyle(a);c&&this.dispatcher.broadcast("updateLayers",{layers:n?c._serializeLayers(n):[],scope:a,removedIds:_||[],options:c.options})}setState(a){if(this._checkLoaded(),Wn(this,xo(a)))return!1;(a=s.c1(a)).layers=$u(a.layers);const n=function(c,f){if(!c)return[{command:ri.setStyle,args:[f]}];let g=[];try{if(!oe(c.version,f.version))return[{command:ri.setStyle,args:[f]}];oe(c.center,f.center)||g.push({command:ri.setCenter,args:[f.center]}),oe(c.zoom,f.zoom)||g.push({command:ri.setZoom,args:[f.zoom]}),oe(c.bearing,f.bearing)||g.push({command:ri.setBearing,args:[f.bearing]}),oe(c.pitch,f.pitch)||g.push({command:ri.setPitch,args:[f.pitch]}),oe(c.sprite,f.sprite)||g.push({command:ri.setSprite,args:[f.sprite]}),oe(c.glyphs,f.glyphs)||g.push({command:ri.setGlyphs,args:[f.glyphs]}),oe(c.imports,f.imports)||function(R=[],P=[],N){P=P||[];const U=(R=R||[]).map(Cn),B=P.map(Cn),k=R.reduce(Ar,{}),M=P.reduce(Ar,{}),H=U.slice();let $,V,Z,z;for($=0,V=0;$<U.length;$++)Z=U[$],M.hasOwnProperty(Z)?V++:(N.push({command:ri.removeImport,args:[Z]}),H.splice(H.indexOf(Z,V),1));for($=0,V=0;$<B.length;$++)Z=B[B.length-1-$],H[H.length-1-$]!==Z&&(k.hasOwnProperty(Z)?(N.push({command:ri.removeImport,args:[Z]}),H.splice(H.lastIndexOf(Z,H.length-V),1)):V++,z=H[H.length-$],N.push({command:ri.addImport,args:[M[Z],z]}),H.splice(H.length-$,0,Z));for(const X of P){const ie=k[X.id];ie&&!oe(ie,X)&&N.push({command:ri.updateImport,args:[X.id,X]})}}(c.imports,f.imports,g),oe(c.transition,f.transition)||g.push({command:ri.setTransition,args:[f.transition]}),oe(c.light,f.light)||g.push({command:ri.setLight,args:[f.light]}),oe(c.fog,f.fog)||g.push({command:ri.setFog,args:[f.fog]}),oe(c.projection,f.projection)||g.push({command:ri.setProjection,args:[f.projection]}),oe(c.lights,f.lights)||g.push({command:ri.setLights,args:[f.lights]}),oe(c.camera,f.camera)||g.push({command:ri.setCamera,args:[f.camera]});const b={},v=[];(function(R,P,N,U){let B;for(B in P=P||{},R=R||{})R.hasOwnProperty(B)&&(P.hasOwnProperty(B)||Hd(B,N,U));for(B in P){if(!P.hasOwnProperty(B))continue;const k=P[B];R.hasOwnProperty(B)?oe(R[B],k)||(R[B].type==="geojson"&&k.type==="geojson"&&cf(R,P,B)?N.push({command:ri.setGeoJSONSourceData,args:[B,k.data]}):uf(B,P,N,U)):xl(B,P,N)}})(c.sources,f.sources,v,b);const A=[];c.layers&&c.layers.forEach(R=>{R.source&&b[R.source]?g.push({command:ri.removeLayer,args:[R.id]}):A.push(R)});let O=c.terrain;O&&b[O.source]&&(g.push({command:ri.setTerrain,args:[void 0]}),O=void 0),g=g.concat(v),oe(O,f.terrain)||g.push({command:ri.setTerrain,args:[f.terrain]}),function(R,P,N){P=P||[];const U=(R=R||[]).map(Cn),B=P.map(Cn),k=R.reduce(Ar,{}),M=P.reduce(Ar,{}),H=U.slice(),$=Object.create(null);let V,Z,z,X,ie,ne,re;for(V=0,Z=0;V<U.length;V++)z=U[V],M.hasOwnProperty(z)?Z++:(N.push({command:ri.removeLayer,args:[z]}),H.splice(H.indexOf(z,Z),1));for(V=0,Z=0;V<B.length;V++)z=B[B.length-1-V],H[H.length-1-V]!==z&&(k.hasOwnProperty(z)?(N.push({command:ri.removeLayer,args:[z]}),H.splice(H.lastIndexOf(z,H.length-Z),1)):Z++,ne=H[H.length-V],N.push({command:ri.addLayer,args:[M[z],ne]}),H.splice(H.length-V,0,z),$[z]=!0);for(V=0;V<B.length;V++)if(z=B[V],X=k[z],ie=M[z],!$[z]&&!oe(X,ie))if(oe(X.source,ie.source)&&oe(X["source-layer"],ie["source-layer"])&&oe(X.type,ie.type)){for(re in Rn(X.layout,ie.layout,N,z,null,ri.setLayoutProperty),Rn(X.paint,ie.paint,N,z,null,ri.setPaintProperty),oe(X.slot,ie.slot)||N.push({command:ri.setSlot,args:[z,ie.slot]}),oe(X.filter,ie.filter)||N.push({command:ri.setFilter,args:[z,ie.filter]}),oe(X.minzoom,ie.minzoom)&&oe(X.maxzoom,ie.maxzoom)||N.push({command:ri.setLayerZoomRange,args:[z,ie.minzoom,ie.maxzoom]}),X)X.hasOwnProperty(re)&&re!=="layout"&&re!=="paint"&&re!=="filter"&&re!=="metadata"&&re!=="minzoom"&&re!=="maxzoom"&&re!=="slot"&&(re.indexOf("paint.")===0?Rn(X[re],ie[re],N,z,re.slice(6),ri.setPaintProperty):oe(X[re],ie[re])||N.push({command:ri.setLayerProperty,args:[z,re,ie[re]]}));for(re in ie)ie.hasOwnProperty(re)&&!X.hasOwnProperty(re)&&re!=="layout"&&re!=="paint"&&re!=="filter"&&re!=="metadata"&&re!=="minzoom"&&re!=="maxzoom"&&re!=="slot"&&(re.indexOf("paint.")===0?Rn(X[re],ie[re],N,z,re.slice(6),ri.setPaintProperty):oe(X[re],ie[re])||N.push({command:ri.setLayerProperty,args:[z,re,ie[re]]}))}else N.push({command:ri.removeLayer,args:[z]}),ne=H[H.lastIndexOf(z)+1],N.push({command:ri.addLayer,args:[ie,ne]})}(A,f.layers,g)}catch(b){console.warn("Unable to compute style diff:",b),g=[{command:ri.setStyle,args:[f]}]}return g}(this.serialize(),a).filter(c=>!(c.command in Us));if(n.length===0)return!1;const _=n.filter(c=>!(c.command in ac));if(_.length>0)throw new Error(`Unimplemented: ${_.map(c=>c.command).join(", ")}.`);return n.forEach(c=>{this[c.command].apply(this,c.args)}),this.stylesheet=a,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(a,n){return this.getImage(a)?this.fire(new s.a(new Error("An image with this name already exists."))):(this.imageManager.addImage(a,this.scope,n),this._afterImageUpdated(a),this)}updateImage(a,n){this.imageManager.updateImage(a,this.scope,n)}getImage(a){return this.imageManager.getImage(a,this.scope)}removeImage(a){return this.getImage(a)?(this.imageManager.removeImage(a,this.scope),this._afterImageUpdated(a),this):this.fire(new s.a(new Error("No image with this name exists.")))}_afterImageUpdated(a){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(a),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new s.b("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(a,n,_={}){return this._checkLoaded(),this._validate(gt,`models.${a}`,n,null,_)||(this.modelManager.addModel(a,n,this.scope),this._changes.setDirty()),this}hasModel(a){return this.modelManager.hasModel(a,this.scope)}removeModel(a){return this.hasModel(a)?(this.modelManager.removeModel(a,this.scope),this):this.fire(new s.a(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(a,n,_={}){if(this._checkLoaded(),this.getOwnSource(a)!==void 0)throw new Error(`There is already a source with ID "${a}".`);if(!n.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(n).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(tn,`sources.${a}`,n,null,_))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);const c=ga(a,n,this.dispatcher,this);c.scope=this.scope,c.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(c.id),source:c.serialize(),sourceId:c.id}));const f=g=>{const b=(g?"symbol:":"other:")+c.id,v=s.ag(b,this.scope),A=this._sourceCaches[b]=new Mo(v,c,g);(g?this._symbolSourceCaches:this._otherSourceCaches)[c.id]=A,A.onAdd(this.map)};f(!1),n.type!=="vector"&&n.type!=="geojson"||f(!0),c.onAdd&&c.onAdd(this.map),_.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(a){this._checkLoaded();const n=this.getOwnSource(a);if(!n)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===a)return this.fire(new s.a(new Error(`Source "${a}" cannot be removed while layer "${c}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===a)return this.fire(new s.a(new Error(`Source "${a}" cannot be removed while terrain is using it.`)));const _=this.getOwnSourceCaches(a);for(const c of _){const f=s.c3(c.id);delete this._sourceCaches[f],this._changes.discardSourceCacheUpdate(c.id),c.fire(new s.b("data",{sourceDataType:"metadata",dataType:"source",sourceId:c.getSource().id})),c.setEventedParent(null),c.clearTiles()}return delete this._otherSourceCaches[a],delete this._symbolSourceCaches[a],this.mergeSources(),n.setEventedParent(null),n.onRemove&&n.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(a,n){this._checkLoaded(),this.getOwnSource(a).setData(n),this._changes.setDirty()}getOwnSource(a){const n=this.getOwnSourceCache(a);return n&&n.getSource()}getOwnSources(){const a=[];for(const n in this._otherSourceCaches){const _=this.getOwnSourceCache(n);_&&a.push(_.getSource())}return a}areTilesLoaded(){const a=this._mergedSourceCaches;for(const n in a){const _=a[n]._tiles;for(const c in _){const f=_[c];if(f.state!=="loaded"&&f.state!=="errored")return!1}}return!0}setLights(a){if(this._checkLoaded(),!a)return delete this.ambientLight,void delete this.directionalLight;const n=this._getTransitionParameters();for(const c of a){if(this._validate(Me,"lights",c))return;switch(c.type){case"ambient":if(this.ambientLight){const f=this.ambientLight;f.set(c),f.updateTransitions(n)}else this.ambientLight=new Ga(c,eo,this.scope,this.options);break;case"directional":if(this.directionalLight){const f=this.directionalLight;f.set(c),f.updateTransitions(n)}else this.directionalLight=new Ga(c,fa,this.scope,this.options)}}const _=new s.K(this.z||0,n);this.ambientLight&&this.ambientLight.recalculate(_),this.directionalLight&&this.directionalLight.recalculate(_),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const a=this.directionalLight,n=this.ambientLight;if(!a||!n)return;const _=R=>.2126*(R[0]<=.03928?R[0]/12.92:Math.pow((R[0]+.055)/1.055,2.4))+.7152*(R[1]<=.03928?R[1]/12.92:Math.pow((R[1]+.055)/1.055,2.4))+.0722*(R[2]<=.03928?R[2]/12.92:Math.pow((R[2]+.055)/1.055,2.4)),c=a.properties.get("color").toArray01(),f=a.properties.get("intensity"),g=a.properties.get("direction"),b=1-s.bQ(g.x,g.y,g.z)[2]/90,v=_(c)*f*b,A=n.properties.get("color").toArray01(),O=n.properties.get("intensity");return(v+_(A)*O)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const a=[];return this.directionalLight&&a.push(this.directionalLight.get()),this.ambientLight&&a.push(this.ambientLight.get()),a}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(a){if(!a)return this;if(s.c4(a)){const n=s.c5(a),_=this.fragments.find(({id:f})=>f===n);if(!_)throw new Error(`Style import not found: ${a}`);const c=s.c3(a);return _.style.getFragmentStyle(c)}{const n=this.fragments.find(({id:_})=>_===a);if(!n)throw new Error(`Style import not found: ${a}`);return n.style}}getConfigProperty(a,n){const _=this.getFragmentStyle(a);if(!_)return null;const c=s.ag(n,_.scope),f=_.options.get(c),g=f?f.value||f.default:null;return g?g.serialize():null}setConfigProperty(a,n,_){const c=s.r(_);if(c.result!=="success")return void Wn(this,c.value);const f=c.value.expression,g=this.getFragmentStyle(a);if(!g)return;const b=s.ag(n,g.scope),v=g.options.get(b);v&&(this.options.set(b,{...v,value:f}),this.updateConfigDependencies())}setConfig(a,n){if(this._config=a,a||n)if(n)for(const _ in n){let c,f;const g=s.r(n[_].default);if(g.result==="success"&&(c=g.value.expression),a&&a[_]!==void 0){const P=s.r(a[_]);P.result==="success"&&(f=P.value.expression)}const{minValue:b,maxValue:v,stepValue:A,type:O,values:R}=n[_];if(c){const P=s.ag(_,this.scope);this.options.set(P,{default:c,value:f,minValue:b,maxValue:v,stepValue:A,type:O,values:R})}else this.fire(new s.a(new Error(`No schema defined for config option "${_}".`)))}else this.fire(new s.a(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(){for(const a of this._configDependentLayers){const n=this.getLayer(a);n&&(n.possiblyEvaluateVisibility(),this._updateLayer(n))}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this._changes.setDirty()}addLayer(a,n,_={}){this._checkLoaded();const c=a.id;if(this._layers[c])return void this.fire(new s.a(new Error(`Layer with id "${c}" already exists on this map`)));let f;if(a.type==="custom"){if(Wn(this,s.c6(a)))return;f=s.c2(a,this.scope,this.options)}else{if(typeof a.source=="object"&&(this.addSource(c,a.source),a=s.c1(a),a=s.e(a,{source:c})),this._validate(de,`layers.${c}`,a,{arrayIndex:-1},_))return;f=s.c2(a,this.scope,this.options),this._validateLayer(f),f.setEventedParent(this,{layer:{id:c}}),this._serializedLayers[f.id]=f.serialize()}f.isConfigDependent&&this._configDependentLayers.add(f.fqid);let g=this._order.length;if(n){const O=this._order.indexOf(n);if(O===-1)return void this.fire(new s.a(new Error(`Layer with id "${n}" does not exist on this map.`)));f.slot===this._layers[n].slot?g=O:s.w(`Layer with id "${n}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(g,0,c),this._layerOrderChanged=!0,this._layers[c]=f;const b=this.getOwnLayerSourceCache(f),v=!!this.directionalLight&&this.directionalLight.shadowsEnabled();b&&f.canCastShadows()&&v&&(b.castsShadows=!0);const A=this._changes.getRemovedLayer(f);if(A&&f.source&&b&&f.type!=="custom"){this._changes.discardLayerRemoval(f);const O=s.ag(f.source,f.scope);A.type!==f.type?this._changes.updateSourceCache(O,"clear"):(this._changes.updateSourceCache(O,"reload"),b.pause())}this._updateLayer(f),f.onAdd&&f.onAdd(this.map),f.scope=this.scope,this.mergeLayers()}moveLayer(a,n){this._checkLoaded();const _=this._checkLayer(a);if(!_||a===n)return;const c=this._order.indexOf(a);this._order.splice(c,1);let f=this._order.length;if(n){const g=this._order.indexOf(n);if(g===-1)return void this.fire(new s.a(new Error(`Layer with id "${n}" does not exist on this map.`)));_.slot===this._layers[n].slot?f=g:s.w(`Layer with id "${n}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(f,0,a),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(a){this._checkLoaded();const n=this._checkLayer(a);if(!n)return;n.setEventedParent(null);const _=this._order.indexOf(a);this._order.splice(_,1),delete this._layers[a],delete this._serializedLayers[a],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(n.fqid),this._changes.removeLayer(n);const c=this.getOwnLayerSourceCache(n);if(c&&c.castsShadows){let f=!1;for(const g in this._layers)if(this._layers[g].source===n.source&&this._layers[g].canCastShadows()){f=!0;break}c.castsShadows=f}n.onRemove&&n.onRemove(this.map),this.mergeLayers()}getOwnLayer(a){return this._layers[a]}hasLayer(a){return a in this._mergedLayers}hasLayerType(a){for(const n in this._layers)if(this._layers[n].type===a)return!0;return!1}setLayerZoomRange(a,n,_){this._checkLoaded();const c=this._checkLayer(a);c&&(c.minzoom===n&&c.maxzoom===_||(n!=null&&(c.minzoom=n),_!=null&&(c.maxzoom=_),this._updateLayer(c)))}setSlot(a,n){this._checkLoaded();const _=this._checkLayer(a);_&&_.slot!==n&&(_.slot=n,this._updateLayer(_))}setFilter(a,n,_={}){this._checkLoaded();const c=this._checkLayer(a);if(c&&!oe(c.filter,n))return n==null?(c.filter=void 0,void this._updateLayer(c)):void(this._validate(we,`layers.${c.id}.filter`,n,{layerType:c.type},_)||(c.filter=s.c1(n),this._updateLayer(c)))}getFilter(a){const n=this._checkLayer(a);if(n)return s.c1(n.filter)}setLayoutProperty(a,n,_,c={}){this._checkLoaded();const f=this._checkLayer(a);if(f&&!oe(f.getLayoutProperty(n),_)){if(_!=null&&(!c||c.validate!==!1)&&Wn(f,Ge.call(xo,{key:`layers.${a}.layout.${n}`,layerType:f.type,objectKey:n,value:_,styleSpec:s.D,style:{glyphs:!0,sprite:!0}})))return;f.setLayoutProperty(n,_),f.isConfigDependent&&this._configDependentLayers.add(f.fqid),this._updateLayer(f)}}getLayoutProperty(a,n){const _=this._checkLayer(a);if(_)return _.getLayoutProperty(n)}setPaintProperty(a,n,_,c={}){this._checkLoaded();const f=this._checkLayer(a);if(!f||oe(f.getPaintProperty(n),_)||_!=null&&(!c||c.validate!==!1)&&Wn(f,Fe.call(xo,{key:`layers.${a}.paint.${n}`,layerType:f.type,objectKey:n,value:_,styleSpec:s.D})))return;const g=f.setPaintProperty(n,_);f.isConfigDependent&&this._configDependentLayers.add(f.fqid),g&&this._updateLayer(f),this._changes.updatePaintProperties(f)}getPaintProperty(a,n){const _=this._checkLayer(a);if(_)return _.getPaintProperty(n)}setFeatureState(a,n){this._checkLoaded();const _=a.source,c=a.sourceLayer,f=this._checkSource(_);if(!f)return;const g=f.type;if(g==="geojson"&&c)return void this.fire(new s.a(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(g==="vector"&&!c)return void this.fire(new s.a(new Error("The sourceLayer parameter must be provided for vector source types.")));a.id===void 0&&this.fire(new s.a(new Error("The feature id parameter must be provided.")));const b=this.getOwnSourceCaches(_);for(const v of b)v.setFeatureState(c,a.id,n)}removeFeatureState(a,n){this._checkLoaded();const _=a.source,c=this._checkSource(_);if(!c)return;const f=c.type,g=f==="vector"?a.sourceLayer:void 0;if(f==="vector"&&!g)return void this.fire(new s.a(new Error("The sourceLayer parameter must be provided for vector source types.")));if(n&&typeof a.id!="string"&&typeof a.id!="number")return void this.fire(new s.a(new Error("A feature id is required to remove its specific state property.")));const b=this.getOwnSourceCaches(_);for(const v of b)v.removeFeatureState(g,a.id,n)}getFeatureState(a){this._checkLoaded();const n=a.source,_=a.sourceLayer,c=this._checkSource(n);if(c){if(c.type!=="vector"||_)return a.id===void 0&&this.fire(new s.a(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(n)[0].getFeatureState(_,a.id);this.fire(new s.a(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(a){return this.stylesheet.transition=s.e({},this.stylesheet.transition,a),this.transition=this.stylesheet.transition,this}getTransition(){return s.e({},this.stylesheet.transition)}serialize(){this._checkLoaded();const a=this.getTerrain(),n=a&&this.terrain&&this.terrain.scope===this.scope?a:this.stylesheet.terrain;return s.c7({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:n,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},_=>_!==void 0)}_updateLayer(a){this._changes.updateLayer(a);const n=this.getLayerSourceCache(a),_=s.ag(a.source,a.scope),c=this._changes.getUpdatedSourceCaches();a.source&&!c[_]&&n&&n.getSource().type!=="raster"&&(this._changes.updateSourceCache(_,"reload"),n.pause()),a.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(a){const n=b=>this._mergedLayers[b].type==="fill-extrusion"||this._mergedLayers[b].type==="model",_=this.order,c={},f=[];for(let b=_.length-1;b>=0;b--){const v=_[b];if(n(v)){c[v]=b;for(const A of a){const O=A[v];if(O)for(const R of O)f.push(R)}}}f.sort((b,v)=>v.intersectionZ-b.intersectionZ);const g=[];for(let b=_.length-1;b>=0;b--){const v=_[b];if(n(v))for(let A=f.length-1;A>=0;A--){const O=f[A].feature;if(c[O.layer.id]<b)break;g.push(O),f.pop()}else for(const A of a){const O=A[v];if(O)for(const R of O)g.push(R.feature)}}return g}queryRenderedFeatures(a,n,_){n&&n.filter&&this._validate(we,"queryRenderedFeatures.filter",n.filter,null,n),n.scope=this.scope,n.availableImages=this._availableImages,n.serializedLayers=this._serializedLayers;const c={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new s.a(new Error("parameters.layers must be an Array."))),[];for(const A of n.layers){const O=this._mergedLayers[A];if(!O)return this.fire(new s.a(new Error(`The layer '${A}' does not exist in the map's style and cannot be queried for features.`))),[];c[O.source]=!0}}const f=[],g=n.serializedLayers||{},b=n&&n.layers?n.layers.some(A=>{const O=this.getLayer(A);return O&&O.is3D()}):this.has3DLayers(),v=ua.createFromScreenPoints(a,_);for(const A in this._mergedSourceCaches){const O=this._mergedSourceCaches[A].getSource();if(!O||O.scope!==n.scope)continue;const R=this._mergedSourceCaches[A].getSource().id;n.layers&&!c[R]||f.push(zd(this._mergedSourceCaches[A],this._mergedLayers,g,v,n,_,b,!!this.map._showQueryGeometry))}return this.placement&&f.push(function(A,O,R,P,N,U,B){const k={},M=U.queryRenderedSymbols(P),H=[];for(const $ of Object.keys(M).map(Number))H.push(B[$]);H.sort(Ls);for(const $ of H){const V=$.featureIndex.lookupSymbolFeatures(M[$.bucketInstanceId],O,$.bucketIndex,$.sourceLayerIndex,N.filter,N.layers,N.availableImages,A);for(const Z in V){const z=k[Z]=k[Z]||[],X=V[Z];X.sort((ie,ne)=>{const re=$.featureSortOrder;if(re){const ye=re.indexOf(ie.featureIndex);return re.indexOf(ne.featureIndex)-ye}return ne.featureIndex-ie.featureIndex});for(const ie of X)z.push(ie)}}for(const $ in k)k[$].forEach(V=>{const Z=V.feature,z=R(A[$]);if(!z)return;const X=z.getFeatureState(Z.layer["source-layer"],Z.id);Z.source=Z.layer.source,Z.layer["source-layer"]&&(Z.sourceLayer=Z.layer["source-layer"]),Z.state=X});return k}(this._mergedLayers,g,this.getLayerSourceCache.bind(this),v.screenGeometry,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(f)}querySourceFeatures(a,n){n&&n.filter&&this._validate(we,"querySourceFeatures.filter",n.filter,null,n);const _=this.getOwnSourceCaches(a);let c=[];for(const f of _)c=c.concat(on(f,n));return c}addSourceType(a,n,_){return Fo.getSourceType(a)?_(new Error(`A source type called "${a}" already exists.`)):(Fo.setSourceType(a,n),n.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:a,url:n.workerSourceURL},_):_(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(a,n,_={}){this._checkLoaded();const c=this.light.getLight();let f=!1;for(const b in a)if(!oe(a[b],c[b])){f=!0;break}if(!f)return;const g=this._getTransitionParameters();this.light.setLight(a,n,_),this.light.updateTransitions(g)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(a,n=1){if(this._checkLoaded(),!a)return this.terrainSetForDrapingOnly()&&n!==0||delete this.terrain,a===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let _=a;const c=a.source==null;if(n===1){if(typeof _.source=="object"){const b="terrain-dem-src";this.addSource(b,_.source),_=s.c1(_),_=s.e(_,{source:b})}const f=s.e({},_),g={};if(this.terrain&&c){f.source=this.terrain.get().source;const b=this.terrain?this.getFragmentStyle(this.terrain.scope):null;b&&(g.style=b.serialize())}if(this._validate(j,"terrain",f,g))return}if(!this.terrain||this.terrain.scope!==this.scope&&!c||this.terrain&&n!==this.terrain.drapeRenderMode){if(!_)return;this._createTerrain(_,n),this.fire(new s.b("data",{dataType:"style"}))}else{const f=this.terrain,g=f.get();for(const b of Object.keys(s.D.terrain))!_.hasOwnProperty(b)&&s.D.terrain[b].default&&(_[b]=s.D.terrain[b].default);for(const b in a)if(!oe(a[b],g[b])){f.set(a,this.options),this.stylesheet.terrain=a;const v=this._getTransitionParameters({duration:0});f.updateTransitions(v),this.fire(new s.b("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(a){const n=this.fog=new Ka(a,this.map.transform,this.scope,this.options);this.stylesheet.fog=n.get();const _=this._getTransitionParameters({duration:0});n.updateTransitions(_)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const a of this.map._markers)a._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(a){if(this._checkLoaded(),!a)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const n=this.fog;if(!oe(n.get(),a)){n.set(a,this.options),this.stylesheet.fog=n.get();const _=this._getTransitionParameters({duration:0});n.updateTransitions(_)}}else this._createFog(a);this._markersNeedUpdate=!0}_getTransitionParameters(a){return{now:s.f.now(),transition:s.e(this.transition,a)}}updateDrapeFirstLayers(){if(!this.terrain)return;const a=[],n=[];for(const _ in this._mergedLayers)this.isLayerDraped(this._mergedLayers[_])?a.push(_):n.push(_);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...a),this._drapedFirstOrder.push(...n)}_createTerrain(a,n){const _=this.terrain=new Ci(a,n,this.scope,this.options);n===1&&(this.stylesheet.terrain=a),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const c=this._getTransitionParameters({duration:0});_.updateTransitions(c)}_force3DLayerUpdate(){for(const a in this._layers){const n=this._layers[a];n.type==="fill-extrusion"&&this._updateLayer(n)}}_forceSymbolLayerUpdate(){for(const a in this._layers){const n=this._layers[a];n.type==="symbol"&&this._updateLayer(n)}}_validate(a,n,_,c,f={}){if(f&&f.validate===!1)return!1;const g=s.e({},this.serialize());return Wn(this,a.call(xo,s.e({key:n,style:g,value:_,styleSpec:s.D},c)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.c8.off("pluginStateChange",this._rtlTextPluginCallback);for(const a in this._mergedLayers)this._mergedLayers[a].setEventedParent(null);for(const a in this._mergedSourceCaches)this._mergedSourceCaches[a].clearTiles(),this._mergedSourceCaches[a].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(a){const n=this.getSourceCaches(a);for(const _ of n)_.clearTiles()}clearSources(){for(const a in this._mergedSourceCaches)this._mergedSourceCaches[a].clearTiles()}reloadSource(a){const n=this.getSourceCaches(a);for(const _ of n)_.resume(),_.reload()}reloadSources(){for(const a of this.getSources())a.reload&&a.reload()}updateSources(a){let n;this.directionalLight&&(n=Pr(this.directionalLight));for(const _ in this._mergedSourceCaches)this._mergedSourceCaches[_].update(a,void 0,void 0,n)}_generateCollisionBoxes(){for(const a in this._sourceCaches){const n=this._sourceCaches[a];n.resume(),n.reload()}}_updatePlacement(a,n,_,c,f=!1){let g=!1,b=!1;const v={},A={};for(const O of this._mergedOrder){const R=this._mergedLayers[O];if(R.type!=="symbol")continue;const P=s.ag(R.source,R.scope);let N=v[P];if(!N){const B=this.getLayerSourceCache(R);if(!B)continue;const k=B.getRenderableIds(!0).map(M=>B.getTileByID(M));A[P]=k.slice(),N=v[P]=k.sort((M,H)=>H.tileID.overscaledZ-M.tileID.overscaledZ||(M.tileID.isLessThan(H.tileID)?-1:1))}const U=this.crossTileSymbolIndex.addLayer(R,N,a.center.lng,a.projection);g=g||U}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),f=f||this._layerOrderChanged||_===0,this._layerOrderChanged&&this.fire(new s.b("neworder")),(f||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.f.now(),a.zoom))&&(this.pauseablePlacement=new Rr(a,this._mergedOrder,f,n,_,c,this.placement,this.fog&&a.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,v,A),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.f.now()),b=!0),g&&this.pauseablePlacement.placement.setStale()),b||g){this._buildingIndex.onNewFrame(a.zoom);for(const O of this._mergedOrder){const R=this._mergedLayers[O];R.type==="symbol"&&this.placement.updateLayerOpacities(R,v[s.ag(R.source,R.scope)])}}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.f.now())}_releaseSymbolFadeTiles(){for(const a in this._sourceCaches)this._sourceCaches[a].releaseSymbolFadeTiles()}addImport(a,n){this._checkLoaded();const _=this.stylesheet.imports=this.stylesheet.imports||[];if(_.findIndex(({id:f})=>f===a.id)!==-1)return this.fire(new s.a(new Error(`Import with id '${a.id}' already exists in the map's style.`)));if(!n)return _.push(a),this._loadImports([a],!0),this;const c=_.findIndex(({id:f})=>f===n);return c===-1?this.fire(new s.a(new Error(`Import with id "${n}" does not exist on this map.`))):(this.stylesheet.imports=_.slice(0,c).concat(a).concat(_.slice(c)),this._loadImports([a],!0,n),this)}updateImport(a,n){this._checkLoaded();const _=this.stylesheet.imports||[],c=this.getImportIndex(a);return c===-1?this:typeof n=="string"?(this.setImportUrl(a,n),this):(n.url&&n.url!==_[c].url&&this.setImportUrl(a,n.url),oe(n.config,_[c].config)||this.setImportConfig(a,n.config),oe(n.data,_[c].data)||this.setImportData(a,n.data),this)}moveImport(a,n){this._checkLoaded();let _=this.stylesheet.imports||[];const c=this.getImportIndex(a);if(c===-1)return this;const f=this.getImportIndex(n);if(f===-1)return this;const g=_[c],b=this.fragments[c];return _=_.filter(({id:v})=>v!==a),this.fragments=this.fragments.filter(({id:v})=>v!==a),this.stylesheet.imports=_.slice(0,f).concat(g).concat(_.slice(f)),this.fragments=this.fragments.slice(0,f).concat(b).concat(this.fragments.slice(f)),this.mergeLayers(),this}setImportUrl(a,n){this._checkLoaded();const _=this.stylesheet.imports||[],c=this.getImportIndex(a);if(c===-1)return this;_[c].url=n;const f=this.fragments[c];return f.style=this._createFragmentStyle(_[c]),f.style.on("style.import.load",()=>this.mergeAll()),f.style.loadURL(n),this}setImportData(a,n){this._checkLoaded();const _=this.getImportIndex(a),c=this.stylesheet.imports||[];return _===-1?this:n?(this.fragments[_].style.setState(n),this._reloadImports(),this):(delete c[_].data,this.setImportUrl(a,c[_].url))}setImportConfig(a,n){this._checkLoaded();const _=this.getImportIndex(a),c=this.stylesheet.imports||[];if(_===-1)return this;n?c[_].config=n:delete c[_].config;const f=this.fragments[_],g=f.style.stylesheet&&f.style.stylesheet.schema;return f.config=n,f.style.setConfig(n,g),this.updateConfigDependencies(),this}removeImport(a){this._checkLoaded();const n=this.stylesheet.imports||[],_=this.getImportIndex(a);return _===-1||(n.splice(_,1),this.fragments[_].style._remove(),this.fragments.splice(_,1),this._reloadImports()),this}getImportIndex(a){const n=(this.stylesheet.imports||[]).findIndex(_=>_.id===a);return n===-1&&this.fire(new s.a(new Error(`Import '${a}' does not exist in the map's style and cannot be updated.`))),n}getLayer(a){return this._mergedLayers[a]}getSources(){const a=[];for(const n in this._mergedOtherSourceCaches){const _=this._mergedOtherSourceCaches[n];_&&a.push(_.getSource())}return a}getSource(a,n){const _=this.getSourceCache(a,n);return _&&_.getSource()}getLayerSource(a){const n=this.getLayerSourceCache(a);return n&&n.getSource()}getSourceCache(a,n){const _=s.ag(a,n);return this._mergedOtherSourceCaches[_]}getLayerSourceCache(a){const n=s.ag(a.source,a.scope);return a.type==="symbol"?this._mergedSymbolSourceCaches[n]:this._mergedOtherSourceCaches[n]}getSourceCaches(a){const n=[];return this._mergedOtherSourceCaches[a]&&n.push(this._mergedOtherSourceCaches[a]),this._mergedSymbolSourceCaches[a]&&n.push(this._mergedSymbolSourceCaches[a]),n}updateSourceCaches(){const a=this._changes.getUpdatedSourceCaches();for(const n in a){const _=a[n];_==="reload"?this.reloadSource(n):_==="clear"&&this.clearSource(n)}}updateLayers(a){const n=this._changes.getUpdatedPaintProperties();for(const _ of n){const c=this.getLayer(_);c&&c.updateTransitions(a)}}getImages(a,n,_){this.imageManager.getImages(n.icons,n.scope,_),this._updateTilesForChangedImages();const c=f=>{f&&f.setDependencies(n.tileID.key,n.type,n.icons)};c(this._otherSourceCaches[n.source]),c(this._symbolSourceCaches[n.source])}getGlyphs(a,n,_){this.glyphManager.getGlyphs(n.stacks,n.scope,_)}getResource(a,n,_){return s.c9(n,_)}getOwnSourceCache(a){return this._otherSourceCaches[a]}getOwnLayerSourceCache(a){return a.type==="symbol"?this._symbolSourceCaches[a.source]:this._otherSourceCaches[a.source]}getOwnSourceCaches(a){const n=[];return this._otherSourceCaches[a]&&n.push(this._otherSourceCaches[a]),this._symbolSourceCaches[a]&&n.push(this._symbolSourceCaches[a]),n}_isSourceCacheLoaded(a){const n=this.getOwnSourceCaches(a);return n.length===0?(this.fire(new s.a(new Error(`There is no source with ID '${a}'`))),!1):n.every(_=>_.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(a=>{a.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Fo.getSourceType=function(d){return an[d]},Fo.setSourceType=function(d,a){an[d]=a},Fo.registerForPluginStateChange=s.bV;var Lr=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,Nr=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,vec2 pos,vec2 lod_coord) {vec2 size=vec2(textureSize(image,0));vec2 dx=dFdx(lod_coord.xy*size);vec2 dy=dFdy(lod_coord.xy*size);float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}`,Wr=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,Mr="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",__=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture(u_depth,uv-df.xz)),unpack_depth(texture(u_depth,uv+df.xz)),unpack_depth(texture(u_depth,uv-df.zy)),unpack_depth(texture(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,u_=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,nc=`highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,ks=`#ifdef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,zs=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform vec2 u_velocity_res;uniform float u_max_speed;const vec2 INVALID_VELOCITY=vec2(-1);uniform vec2 u_texture_offset;uniform float u_data_offset;uniform vec4 u_data_scale;vec2 lookup_velocity(vec2 uv) {uv=u_texture_offset.x+u_texture_offset.y*uv;vec2 fxy;ivec4 c=_raTexLinearCoord(uv,u_velocity_res,fxy);vec4 tl=texelFetch(u_velocity,c.yz,0);vec4 tr=texelFetch(u_velocity,c.xz,0);vec4 bl=texelFetch(u_velocity,c.yw,0);vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NODATA) {return INVALID_VELOCITY;}if (tr==NODATA) {return INVALID_VELOCITY;}if (bl==NODATA) {return INVALID_VELOCITY;}if (br==NODATA) {return INVALID_VELOCITY;}vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);
#ifdef DATA_FORMAT_UINT32
vec2 velocity=vec2(u_data_offset+dot(t,u_data_scale),0);return velocity;
#else
vec2 velocity=vec2(u_data_offset+dot(t.rg,u_data_scale.yx),-(u_data_offset+dot(t.ba,u_data_scale.yx)));
#endif
return velocity/max(u_max_speed,length(velocity));}
#endif`,c_=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Pl=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef NATIVE
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const Hs=[];Mn(Lr,Hs),Mn(Wr,Hs),Mn(Nr,Hs);const mo={"_prelude_fog.vertex.glsl":u_,"_prelude_terrain.vertex.glsl":__,"_prelude_shadow.vertex.glsl":c_,"_prelude_fog.fragment.glsl":nc,"_prelude_shadow.fragment.glsl":Pl,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":ks,"_prelude_raster_particle.glsl":zs},Ys={};ci("",__),ci(nc,u_),ci(Pl,c_),ci(ks,""),ci(zs,"");const m_=ci(Nr,Wr),Dr=Lr;var f_={background:ci(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:ci(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:ci(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:ci("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ci(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:ci(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:ci("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in float a_size_scale;in vec2 a_padding;in float a_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(a_z_offset+elevation(a_anchor_pos)),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:ci("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:ci("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:ci(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:ci(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:ci(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:ci(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:ci(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
uniform float u_emissive_strength;in float v_height;void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,u_emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=max(0.01,cutoff_opacity(u_cutoff_params,ground.z));if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff < 0.01 && centroid_pos.x !=0.0));gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:ci(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:ci(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
out vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:ci(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:ci(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(1.0,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:ci(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ci(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:ci(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {    
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trimmed,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:ci(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 v_uv;
#endif
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float pattern_x=v_linesofar/pattern_size.x*aspect;float x=mod(pattern_x,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {color=vec4(0,0,0,0);}}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_ground(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 a_packed;
#endif
in float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec4 v_uv;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
float a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:ci(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:ci(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;vec2 uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
vec2 uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:ci("precision highp float;uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`precision highp float;
#include "_prelude_raster_array.glsl"
#include "_prelude_raster_particle.glsl"
in vec3 a_pos;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {vec2 pos=a_pos.xy+u_tile_offset;vec2 tex_coords=fract(pos);gl_PointSize=1.0;vec2 velocity=lookup_velocity(tex_coords);if (velocity==INVALID_VELOCITY) {v_particle_speed=0.0;gl_Position=vec4(2.0,2.0,2.0,1.0);} else {v_particle_speed=length(velocity);gl_Position=vec4(2.0*pos-vec2(1.0),0.0,1.0);}}`),rasterParticleTexture:ci("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {v_tex_pos=0.5*a_pos+vec2(0.5);gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:ci("void main() {}",`#include "_prelude_raster_array.glsl"
#include "_prelude_raster_particle.glsl"
in vec3 a_pos;uniform float u_speed_factor;uniform float u_lifetime_delta;uniform float u_rand_seed;out vec3 v_new_particle;const vec3 rand_constants=vec3(12.9898,78.233,4375.85453);float rand(const vec2 co) {float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {float lifetime=a_pos.z;vec2 pos=a_pos.xy;vec2 uv=clamp(pos,vec2(0.0),vec2(1.0));vec2 velocity=lookup_velocity(uv);float next_lifetime=lifetime-u_lifetime_delta;float t=step(0.0,next_lifetime);
#ifdef DATA_FORMAT_UINT32
vec2 dp=vec2(0);
#else
vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;
#endif
vec2 seed=pos*u_rand_seed;vec2 next_pos=pos+dp;vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));v_new_particle=vec3(
vec2(mix(random_pos,next_pos,t)),mix(1.0,next_lifetime,t)
);}`),symbolIcon:ci(`#include "_prelude_lighting.glsl"
uniform sampler2D u_texture;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
in float v_fade_opacity;in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
uniform mediump float u_icon_saturation;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
lowp float alpha=opacity*v_fade_opacity;vec4 out_color;
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b)*alpha;
#else
out_color=texture(u_texture,v_tex_a)*alpha;
#endif
#ifdef SATURATION
vec3 luma=vec3(dot(out_color.rgb,vec3(0.2126,0.7152,0.0722)));out_color.rgb=mix(luma,out_color.rgb,u_icon_saturation);
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
v_tex_a=a_tex/u_texsize;
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
v_fade_opacity=out_fade_opacity;}`),symbolSDF:ci(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;in float v_draw_halo;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out float v_draw_halo;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}`),symbolTextAndIcon:ci(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;in float v_draw_halo;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out float v_draw_halo;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}`),terrainRaster:ci(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:ci("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:ci(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Mr),skyboxGradient:ci(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Mr),skyboxCapture:ci(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:ci(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:ci(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:ci(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;bool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;highp float depth=unpack_depth(texture(u_depthTexture,coord));return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
return vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);color=mix(color,v_color_mix.rgb,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=u_matrix*pos;pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 shadow_pos=local_pos;
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normalize(normal_3f));shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1);v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:ci(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=u_matrix*pos;
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:ci(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`)};function Mn(d,a){const n=d.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let _ of n)if(_=_.trim(),_[0]==="#"&&_.includes("if")&&!_.includes("endif")){_=_.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const c=_.split(" ");for(const f of c)a.includes(f)||a.push(f)}}function ci(d,a){const n=/#include\s+"([^"]+)"/g,_=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let c=a.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);c&&(c=c.map(A=>{const O=A.split(" ");return O[O.length-1]}),c=[...new Set(c)]);const f={},g=[],b=[];if(d=d.replace(n,(A,O)=>(b.push(O),"")),(a=a.replace(n,(A,O)=>(g.push(O),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let v=[...Hs];Mn(d,v),Mn(a,v);for(const A of[...g,...b])mo[A]||console.error(`Undefined include: ${A}`),Ys[A]||(Ys[A]=[],Mn(mo[A],Ys[A])),v=[...v,...Ys[A]];return{fragmentSource:d=d.replace(_,(A,O,R,P,N)=>(f[N]=!0,O==="define"?`
#ifndef HAS_UNIFORM_u_${N}
in ${R} ${P} ${N};
#else
uniform ${R} ${P} u_${N};
#endif
`:O==="initialize"?`
#ifdef HAS_UNIFORM_u_${N}
    ${R} ${P} ${N} = u_${N};
#endif
`:O==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${N}
    in ${R} ${P} ${N};
#endif
`:O==="initialize-attribute"?"":void 0)),vertexSource:a=a.replace(_,(A,O,R,P,N)=>{const U=P==="float"?"vec2":P,B=N.match(/color/)?"color":U;return O==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${N}
in ${R} ${P} a_${N};
#endif
`:f[N]?O==="define"?`
#ifndef HAS_UNIFORM_u_${N}
uniform lowp float u_${N}_t;
in ${R} ${U} a_${N};
out ${R} ${P} ${N};
#else
uniform ${R} ${P} u_${N};
#endif
`:O==="initialize"?B==="vec4"?`
#ifndef HAS_UNIFORM_u_${N}
    ${N} = a_${N};
#else
    ${R} ${P} ${N} = u_${N};
#endif
`:`
#ifndef HAS_UNIFORM_u_${N}
    ${N} = unpack_mix_${B}(a_${N}, u_${N}_t);
#else
    ${R} ${P} ${N} = u_${N};
#endif
`:O==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${N}
    in ${R} ${P} a_${N};
    out ${R} ${P} ${N};
#endif
`:O==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${N}
    ${N} = a_${N};
#endif
`:void 0:O==="define"?`
#ifndef HAS_UNIFORM_u_${N}
uniform lowp float u_${N}_t;
in ${R} ${U} a_${N};
#else
uniform ${R} ${P} u_${N};
#endif
`:O==="define-instanced"?B==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${N}0;
in vec4 a_${N}1;
in vec4 a_${N}2;
in vec4 a_${N}3;
#else
uniform ${R} ${P} u_${N};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${R} ${U} a_${N};
#else
uniform ${R} ${P} u_${N};
#endif
`:O==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${N}
    ${R} ${P} ${N} = a_${N};
#endif
`:B==="vec4"?`
#ifndef HAS_UNIFORM_u_${N}
    ${R} ${P} ${N} = a_${N};
#else
    ${R} ${P} ${N} = u_${N};
#endif
`:`
#ifndef HAS_UNIFORM_u_${N}
    ${R} ${P} ${N} = unpack_mix_${B}(a_${N}, u_${N}_t);
#else
    ${R} ${P} ${N} = u_${N};
#endif
`}),staticAttributes:c,usedDefines:v,vertexIncludes:g,fragmentIncludes:b}}class p_{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(a,n,_,c,f,g,b,v){this.context=a;let A=this.boundPaintVertexBuffers.length!==c.length;for(let R=0;!A&&R<c.length;R++)this.boundPaintVertexBuffers[R]!==c[R]&&(A=!0);let O=this.boundDynamicVertexBuffers.length!==b.length;for(let R=0;!O&&R<b.length;R++)this.boundDynamicVertexBuffers[R]!==b[R]&&(O=!0);if(!this.vao||this.boundProgram!==n||this.boundLayoutVertexBuffer!==_||A||O||this.boundIndexBuffer!==f||this.boundVertexOffset!==g)this.freshBind(n,_,c,f,g,b,v);else{a.bindVertexArrayOES.set(this.vao);for(const R of b)R&&(R.bind(),v&&R.instanceCount&&R.setVertexAttribDivisor(a.gl,n,v));f&&f.dynamicDraw&&f.bind()}}freshBind(a,n,_,c,f,g,b){const v=a.numAttributes,A=this.context,O=A.gl;this.vao&&this.destroy(),this.vao=A.gl.createVertexArray(),A.bindVertexArrayOES.set(this.vao),this.boundProgram=a,this.boundLayoutVertexBuffer=n,this.boundPaintVertexBuffers=_,this.boundIndexBuffer=c,this.boundVertexOffset=f,this.boundDynamicVertexBuffers=g,n.enableAttributes(O,a),n.bind(),n.setVertexAttribPointers(O,a,f);for(const R of _)R.enableAttributes(O,a),R.bind(),R.setVertexAttribPointers(O,a,f);for(const R of g)R&&(R.enableAttributes(O,a),R.bind(),R.setVertexAttribPointers(O,a,f),b&&R.instanceCount&&R.setVertexAttribDivisor(O,a,b));c&&c.bind(),A.currentNumAttributes=v}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Tf(d,a){const n=Math.pow(2,a.canonical.z),_=a.canonical.y;return[new s.L(0,_/n).toLngLat().lat,new s.L(0,(_+1)/n).toLngLat().lat]}function Fr(d,a,n,_,c,f,g){const b=d.context,v=b.gl,A=n.hillshadeFBO;if(!A)return;d.prepareDrawTile();const O=d.isTileAffectedByFog(a),R=d.getOrCreateProgram("hillshade",{overrideFog:O});b.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,A.colorAttachment.get());const P=((k,M,H,$)=>{const V=H.paint.get("hillshade-shadow-color"),Z=H.paint.get("hillshade-highlight-color"),z=H.paint.get("hillshade-accent-color"),X=H.paint.get("hillshade-emissive-strength");let ie=s.bj(H.paint.get("hillshade-illumination-direction"));if(H.paint.get("hillshade-illumination-anchor")==="viewport")ie-=k.transform.angle;else if(k.style&&k.style.enable3dLights()&&k.style.directionalLight){const re=k.style.directionalLight.properties.get("direction"),ye=s.bQ(re.x,re.y,re.z);ie=s.bj(ye[1])}const ne=!k.options.moving;return{u_matrix:$||k.transform.calculateProjMatrix(M.tileID.toUnwrapped(),ne),u_image:0,u_latrange:Tf(0,M.tileID),u_light:[H.paint.get("hillshade-exaggeration"),ie],u_shadow:V,u_highlight:Z,u_emissive_strength:X,u_accent:z}})(d,n,_,d.terrain?a.projMatrix:null);d.uploadCommonUniforms(b,R,a.toUnwrapped());const{tileBoundsBuffer:N,tileBoundsIndexBuffer:U,tileBoundsSegments:B}=d.getTileBoundsBuffers(n);R.draw(d,v.TRIANGLES,c,f,g,Pt.disabled,P,_.id,N,U,B)}function sc(d,a,n){if(!a.needsDEMTextureUpload)return;const _=d.context,c=_.gl;_.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||d.getTileTexture(n.stride);const f=n.getPixels();a.demTexture?a.demTexture.update(f,{premultiply:!1}):a.demTexture=new s.T(_,f,c.R32F,{premultiply:!1}),a.needsDEMTextureUpload=!1}function h_(d,a,n){const _=d.context,c=_.gl;if(!a.dem)return;const f=a.dem;if(_.activeTexture.set(c.TEXTURE1),sc(d,a,f),!a.demTexture)return;a.demTexture.bind(c.NEAREST,c.CLAMP_TO_EDGE);const g=f.dim;_.activeTexture.set(c.TEXTURE0);let b=a.hillshadeFBO;if(!b){const P=new s.T(_,{width:g,height:g,data:null},c.RGBA);P.bind(c.LINEAR,c.CLAMP_TO_EDGE),b=a.hillshadeFBO=_.createFramebuffer(g,g,!0,"renderbuffer"),b.colorAttachment.set(P.texture)}_.bindFramebuffer.set(b.framebuffer),_.viewport.set([0,0,g,g]);const{tileBoundsBuffer:v,tileBoundsIndexBuffer:A,tileBoundsSegments:O}=d.getMercatorTileBoundsBuffers(),R=[];d.linearFloatFilteringSupported()&&R.push("TERRAIN_DEM_FLOAT_FORMAT"),d.getOrCreateProgram("hillshadePrepare",{defines:R}).draw(d,c.TRIANGLES,wt.disabled,Bt.disabled,Jt.unblended,Pt.disabled,((P,N)=>{const U=N.stride,B=s.a6.create();return s.a6.ortho(B,0,s.V,-s.V,0,0,1),s.a6.translate(B,B,[0,-s.V,0]),{u_matrix:B,u_image:1,u_dimension:[U,U],u_zoom:P.overscaledZ}})(a.tileID,f),n.id,v,A,O),a.needsHillshadePrepare=!1}const lc=d=>({u_matrix:new s.bK(d),u_image0:new s.bO(d),u_skirt_height:new s.bN(d),u_ground_shadow_factor:new s.bM(d)}),Br=(d,a,n)=>({u_matrix:d,u_image0:0,u_skirt_height:a,u_ground_shadow_factor:n}),rc=(d,a,n,_,c,f,g,b,v,A,O,R,P,N,U,B)=>({u_proj_matrix:Float32Array.from(d),u_globe_matrix:a,u_normalize_matrix:Float32Array.from(_),u_merc_matrix:n,u_zoom_transition:c,u_merc_center:f,u_image0:0,u_frustum_tl:g,u_frustum_tr:b,u_frustum_br:v,u_frustum_bl:A,u_globe_pos:O,u_globe_radius:R,u_viewport:P,u_grid_matrix:B?Float32Array.from(B):new Float32Array(9),u_skirt_height:N,u_far_z_cutoff:U});function Ll(d,a){return d!=null&&a!=null&&!(!d.hasData()||!a.hasData())&&d.demTexture!=null&&a.demTexture!=null&&d.tileID.key!==a.tileID.key}const Gs=new class{constructor(){this.operations={}}newMorphing(d,a,n,_,c){if(d in this.operations){const f=this.operations[d];f.to.tileID.key!==n.tileID.key&&(f.queued=n)}else this.operations[d]={startTime:_,phase:0,duration:c,from:a,to:n,queued:null}}getMorphValuesForProxy(d){if(!(d in this.operations))return null;const a=this.operations[d];return{from:a.from,to:a.to,phase:a.phase}}update(d){for(const a in this.operations){const n=this.operations[a];for(n.phase=(d-n.startTime)/n.duration;n.phase>=1||!this._validOp(n);)if(!this._nextOp(n,d)){delete this.operations[a];break}}}_nextOp(d,a){return!!d.queued&&(d.from=d.to,d.to=d.queued,d.queued=null,d.phase=0,d.startTime=a,!0)}_validOp(d){return d.from.hasData()&&d.to.hasData()}},g_={0:null,1:"TERRAIN_VERTEX_MORPHING"};function y_(d,a,n){if(a===0)return 0;const _=a<1&&n===514?.25/a:1;return 6*Math.pow(1.5,22-d)*Math.max(a,1)*_}function Vs(d,a){const n=1<<d.z;return!a&&(d.x===0||d.x===n-1)||d.y===0||d.y===n-1}const b_=d=>({u_matrix:d});function T_(d,a,n,_,c){if(c>0){const f=s.f.now(),g=(f-d.timeAdded)/c,b=a?(f-a.timeAdded)/c:-1,v=n.getSource(),A=_.coveringZoomLevel({tileSize:v.tileSize,roundZoom:v.roundZoom}),O=!a||Math.abs(a.tileID.overscaledZ-A)>Math.abs(d.tileID.overscaledZ-A),R=O&&d.refreshedUponExpiration?1:s.aa(O?g:1-b,0,1);return d.refreshedUponExpiration&&g>=1&&(d.refreshedUponExpiration=!1),a?{opacity:1,mix:1-R}:{opacity:R,mix:0}}return{opacity:1,mix:0}}class xf extends Mo{constructor(a){const n={type:"raster-dem",maxzoom:a.transform.maxZoom},_=new s.bW(s.bX(),null),c=ga("mock-dem",n,_,a.style);super("mock-dem",c,!1),c.setEventedParent(this),this._sourceLoaded=!0}_loadTile(a,n){a.state="loaded",n(null)}}class vf extends Mo{constructor(a){const n=ga("proxy",{type:"geojson",maxzoom:a.transform.maxZoom},new s.bW(s.bX(),null),a.style);super("proxy",n,!1),n.setEventedParent(this),this.map=this.getSource().map=a,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(a,n,_){if(a.freezeTileCoverage)return;this.transform=a;const c=a.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((f,g)=>{if(f[g.key]="",!this._tiles[g.key]){const b=new Sn(g,this._source.tileSize*g.overscaleFactor(),a.tileZoom);b.state="loaded",this._tiles[g.key]=b}return f},{});for(const f in this._tiles)f in c||(this.freeFBO(f),this._tiles[f].unloadVectorData(),delete this._tiles[f])}freeFBO(a){const n=this.proxyCachedFBO[a];if(n!==void 0){const _=Object.values(n);this.renderCachePool.push(..._),delete this.proxyCachedFBO[a]}}deallocRenderCache(){this.renderCache.forEach(a=>a.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class dc extends s.am{constructor(a,n,_){super(a.overscaledZ,a.wrap,a.canonical.z,a.canonical.x,a.canonical.y),this.proxyTileKey=n,this.projMatrix=_}}class Ef extends s.ck{constructor(a,n){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},a.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),a.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),a.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=a,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[_,c,f]=function(v){const A=new s.aN,O=new s.aw,R=131;A.reserve(17161),O.reserve(33800);const P=s.V/128,N=s.V+P/2,U=N+P;for(let k=-P;k<U;k+=P)for(let M=-P;M<U;M+=P){const H=M<0||M>N||k<0||k>N?24575:0,$=s.aa(Math.round(M),0,s.V),V=s.aa(Math.round(k),0,s.V);A.emplaceBack($+H,V)}const B=(k,M)=>{const H=M*R+k;O.emplaceBack(H+1,H,H+R),O.emplaceBack(H+R,H+R+1,H+1)};for(let k=1;k<129;k++)for(let M=1;M<129;M++)B(M,k);return[0,129].forEach(k=>{for(let M=0;M<130;M++)B(M,k),B(k,M)}),[A,O,32768]}(),g=a.context;this.gridBuffer=g.createVertexBuffer(_,s.aP.members),this.gridIndexBuffer=g.createIndexBuffer(c),this.gridSegments=s.aB.simpleSegment(0,0,_.length,c.length),this.gridNoSkirtSegments=s.aB.simpleSegment(0,0,_.length,f),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new vf(n.map),this.orthoMatrix=s.a6.create(),s.a6.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,s.V,0,s.V,0,1);const b=g.gl;this._overlapStencilMode=new Bt({func:b.GEQUAL,mask:255},0,255,b.KEEP,b.KEEP,b.REPLACE),this._previousZoom=a.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=n,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new xf(n.map),this._pendingGroundEffectLayers=[]}set style(a){a.on("data",this._onStyleDataEvent.bind(this)),this._style=a,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(a,n,_){if(a&&a.terrain){this._style!==a&&(this.style=a,this._evaluationZoom=void 0);const c=a.terrain.properties,f=a.terrain.drapeRenderMode===0,g=a.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=s.f.now();const b=a.terrain&&a.terrain.scope,v=c.get("source"),A=f?this._mockSourceCache:a.getSourceCache(v,b);if(!A)return void s.w(`Couldn't find terrain source "${v}".`);if(this.sourceCache=A,this._exaggeration=g?this.calculateExaggeration(n):c.get("exaggeration"),!n.projection.requiresDraping&&g&&this._exaggeration===0)return void this._disable();this.enabled=!0;const O=()=>{this.sourceCache.used&&s.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const R=this.getScaledDemTileSize();this.sourceCache.update(n,R,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,O(),this._initializing=!0),O(),n.updateElevation(!0,_),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(n),this._emptyDEMTextureDirty=!0,this._previousZoom=n.zoom}else this._disable()}calculateExaggeration(a){const n=this._previousCameraAltitude,_=a.getFreeCameraOptions().position.z/a.pixelsPerMeter*a.worldSize;this._previousCameraAltitude=_;const c=n!=null?_-n:Number.MAX_VALUE;if(Math.abs(c)<2)return this._exaggeration;const f=a.zoom,g=this._style.terrain;if(!this._previousUpdateTimestamp)return g.getExaggeration(f);let b=f-this._previousZoom;const v=this._previousUpdateTimestamp;let A=f;this._evaluationZoom!=null&&(A=this._evaluationZoom,Math.abs(f-A)>.5&&(b=.5*(f-A+b)),b*c<0&&(A+=b)),this._evaluationZoom=A;const O=g.getExaggeration(A),R=O===g.getExaggeration(Math.max(0,A-.1));if(R&&Math.abs(O-this._exaggeration)<.01)return O;let P=Math.min(.1,.00375*(this._updateTimestamp-v));return(R||O<.1||Math.abs(b)<1e-4)&&(P=Math.min(.2,4*P)),s.U(this._exaggeration,O,P)}resetTileLookupCache(a){this._findCoveringTileCache[a]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(a){a.coord&&a.dataType==="source"?this._clearRenderCacheForTile(a.sourceCacheId,a.coord):a.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const a in this._style._mergedSourceCaches)this._style._mergedSourceCaches[a].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(a=>a.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const a=2*this.proxySourceCache.getSource().tileSize;return[a,a]}set useVertexMorphing(a){this._useVertexMorphing=a}updateTileBinding(a){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const n=this.proxySourceCache,_=this.painter.transform;this._initializing&&(this._initializing=_._centerAltitude===0&&this.getAtPointOrZero(s.L.fromLngLat(_.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const c=this.proxyCoords=n.getIds().map(v=>{const A=n.getTileByID(v).tileID;return A.projMatrix=_.calculateProjMatrix(A.toUnwrapped()),A});(function(v,A){const O=A.transform.pointCoordinate(A.transform.getCameraPoint()),R=new s.P(O.x,O.y);v.sort((P,N)=>{if(N.overscaledZ-P.overscaledZ)return N.overscaledZ-P.overscaledZ;const U=new s.P(P.canonical.x+(1<<P.canonical.z)*P.wrap,P.canonical.y),B=new s.P(N.canonical.x+(1<<N.canonical.z)*N.wrap,N.canonical.y),k=R.mult(1<<P.canonical.z);return k.x-=.5,k.y-=.5,k.distSqr(U)-k.distSqr(B)})})(c,this.painter);const f=this.proxyToSource||{};this.proxyToSource={},c.forEach(v=>{this.proxyToSource[v.key]={}}),this.terrainTileForTile={};const g=this._style._mergedSourceCaches;for(const v in g){const A=g[v];if(!A.used||(A!==this.sourceCache&&this.resetTileLookupCache(A.id),this._setupProxiedCoordsForOrtho(A,a[v],f),A.usedForTerrain))continue;const O=a[v];A.getSource().reparseOverscaled&&this._assignTerrainTiles(O)}this.proxiedCoords[n.id]=c.map(v=>new dc(v,v.key,this.orthoMatrix)),this._assignTerrainTiles(c),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(f),this.renderingToTexture=!1;const b={};this._visibleDemTiles=[];for(const v of this.proxyCoords){const A=this.terrainTileForTile[v.key];if(!A)continue;const O=A.tileID.key;O in b||(this._visibleDemTiles.push(A),b[O]=O)}}_assignTerrainTiles(a){this._initializing||a.forEach(n=>{if(this.terrainTileForTile[n.key])return;const _=this._findTileCoveringTileID(n,this.sourceCache);_&&(this.terrainTileForTile[n.key]=_)})}_prepareDEMTextures(){const a=this.painter.context,n=a.gl;for(const _ in this.terrainTileForTile){const c=this.terrainTileForTile[_],f=c.dem;!f||c.demTexture&&!c.needsDEMTextureUpload||(a.activeTexture.set(n.TEXTURE1),sc(this.painter,c,f))}}_prepareDemTileUniforms(a,n,_,c){if(!n||n.demTexture==null)return!1;const f=a.tileID.canonical,g=Math.pow(2,n.tileID.canonical.z-f.z),b=c||"";return _[`u_dem_tl${b}`]=[f.x*g%1,f.y*g%1],_[`u_dem_scale${b}`]=g,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const a=this.painter.context,n=a.gl;if(!this._emptyDepthBufferTexture){const _=new s.h({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new s.T(a,_,n.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let a=0;const n=this._visibleDemTiles.reduce((_,c)=>{if(!c.dem)return _;const f=c.dem.tree.minimums[0];return f>0&&a++,_+f},0);return a?n/a:0}_updateEmptyDEMTexture(){const a=this.painter.context,n=a.gl;a.activeTexture.set(n.TEXTURE2);const _=this._getLoadedAreaMinimum(),[c,f]=(()=>{const b=new s.cm({width:1,height:1},new Float32Array([_]));return[n.R32F,b]})();this._emptyDEMTextureDirty=!1;let g=this._emptyDEMTexture;return g?g.update(f,{premultiply:!1}):g=this._emptyDEMTexture=new s.T(a,f,c,{premultiply:!1}),g}setupElevationDraw(a,n,_){const c=this.painter.context,f=c.gl,g={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0};g.u_exaggeration=this.exaggeration();let b=null,v=null,A=1;if(_&&_.morphing&&this._useVertexMorphing){const P=_.morphing.srcDemTile,N=_.morphing.dstDemTile;A=_.morphing.phase,P&&N&&(this._prepareDemTileUniforms(a,P,g,"_prev")&&(v=P),this._prepareDemTileUniforms(a,N,g)&&(b=N))}const O=P=>P&&P.demTexture&&this.painter.linearFloatFilteringSupported()?f.LINEAR:f.NEAREST,R=P=>{g.u_dem_size=P.size[0]===1?1:P.size[0]-2};if(v&&b)c.activeTexture.set(f.TEXTURE2),b.demTexture.bind(O(b),f.CLAMP_TO_EDGE),c.activeTexture.set(f.TEXTURE4),v.demTexture.bind(O(v),f.CLAMP_TO_EDGE),b.demTexture&&R(b.demTexture),g.u_dem_lerp=A;else{b=this.terrainTileForTile[a.tileID.key],c.activeTexture.set(f.TEXTURE2);const P=this._prepareDemTileUniforms(a,b,g)?b.demTexture:this.emptyDEMTexture;P.bind(O(b),f.CLAMP_TO_EDGE),R(P)}if(c.activeTexture.set(f.TEXTURE3),_&&_.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(f.NEAREST,f.CLAMP_TO_EDGE),this._depthFBO&&(g.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(f.NEAREST,f.CLAMP_TO_EDGE),g.u_depth_size_inv=[1,1]),_&&_.useMeterToDem&&b){const P=(1<<b.tileID.canonical.z)*s.bl(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;g.u_meter_to_dem=P}if(_&&_.labelPlaneMatrixInv&&(g.u_label_plane_matrix_inv=_.labelPlaneMatrixInv),n.setTerrainUniformValues(c,g),this.painter.transform.projection.name==="globe"){const P=this.globeUniformValues(this.painter.transform,a.tileID.canonical,_&&_.useDenormalizedUpVectorScale);n.setGlobeUniformValues(c,P)}}globeUniformValues(a,n,_){const c=a.projection;return{u_tile_tl_up:c.upVector(n,0,0),u_tile_tr_up:c.upVector(n,s.V,0),u_tile_br_up:c.upVector(n,s.V,s.V),u_tile_bl_up:c.upVector(n,0,s.V),u_tile_up_scale:_?s.cl(1):c.upVectorScale(n,a.center.lat,a.worldSize).metersToTile}}renderToBackBuffer(a){const n=this.painter,_=this.painter.context;a.length!==0&&(_.bindFramebuffer.set(null),_.viewport.set([0,0,n.width,n.height]),n.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(c,f,g,b,v){if(c.transform.projection.name==="globe")(function(A,O,R,P,N){const U=A.context,B=U.gl;let k,M;const H=A.transform,$=s.cd(A,U,H),V=(Ie,Ee)=>{if(M===Ee)return;const Ue=[g_[Ee],"PROJECTION_GLOBE_VIEW"];$&&Ue.push("CUSTOM_ANTIALIASING");const ce=A.isTileAffectedByFog(Ie);k=A.getOrCreateProgram("globeRaster",{defines:Ue,overrideFog:ce}),M=Ee},Z=A.colorModeForRenderPass(),z=new wt(B.LEQUAL,wt.ReadWrite,A.depthRangeFor3D);Gs.update(N);const X=s.ce(H),ie=[s.a5(H.center.lng),s.ae(H.center.lat)],ne=A.globeSharedBuffers,re=[H.width*s.f.devicePixelRatio,H.height*s.f.devicePixelRatio],ye=Float32Array.from(H.globeMatrix),ue={useDenormalizedUpVectorScale:!0};{const Ie=A.transform,Ee=y_(Ie.zoom,O.exaggeration(),O.sourceCache._source.tileSize);M=-1;const Ue=B.TRIANGLES;for(const ce of P){const Te=R.getTile(ce),le=Bt.disabled,pe=O.prevTerrainTileForTile[ce.key],ke=O.terrainTileForTile[ce.key];Ll(pe,ke)&&Gs.newMorphing(ce.key,pe,ke,N,250),U.activeTexture.set(B.TEXTURE0),Te.texture&&Te.texture.bind(B.LINEAR,B.CLAMP_TO_EDGE);const $e=Gs.getMorphValuesForProxy(ce.key),je=$e?1:0;$e&&s.j(ue,{morphing:{srcDemTile:$e.from,dstDemTile:$e.to,phase:s.cc($e.phase)}});const it=s.cf(ce.canonical),ht=s.cg(it.getCenter().lat),St=s.ch(ce.canonical,it,ht,Ie.worldSize/Ie._pixelsPerMercatorPixel),xt=s.aT(s.ci(ce.canonical)),At=rc(Ie.expandedFarZProjMatrix,ye,X,xt,s.S(Ie.zoom),ie,Ie.frustumCorners.TL,Ie.frustumCorners.TR,Ie.frustumCorners.BR,Ie.frustumCorners.BL,Ie.globeCenterInViewSpace,Ie.globeRadius,re,Ee,Ie._farZ,St);if(V(ce,je),k&&(O.setupElevationDraw(Te,k,ue),A.uploadCommonUniforms(U,k,ce.toUnwrapped()),ne)){const[jt,Ft,zt]=ne.getGridBuffers(ht,Ee!==0);k.draw(A,Ue,z,le,Z,Pt.backCCW,At,"globe_raster",jt,Ft,zt)}}}if(ne&&(A.renderDefaultNorthPole||A.renderDefaultSouthPole)){const Ie=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];$&&Ie.push("CUSTOM_ANTIALIASING"),k=A.getOrCreateProgram("globeRaster",{defines:Ie});for(const Ee of P){const{x:Ue,y:ce,z:Te}=Ee.canonical,le=ce===0,pe=ce===(1<<Te)-1,[ke,$e,je,it]=ne.getPoleBuffers(Te,!1);if(it&&(le||pe)){const ht=R.getTile(Ee);U.activeTexture.set(B.TEXTURE0),ht.texture&&ht.texture.bind(B.LINEAR,B.CLAMP_TO_EDGE);let St=s.cj(Te,Ue,H);const xt=s.aT(s.ci(Ee.canonical)),At=(jt,Ft)=>jt.draw(A,B.TRIANGLES,z,Bt.disabled,Z,Pt.disabled,rc(H.expandedFarZProjMatrix,St,St,xt,0,ie,H.frustumCorners.TL,H.frustumCorners.TR,H.frustumCorners.BR,H.frustumCorners.BL,H.globeCenterInViewSpace,H.globeRadius,re,0,H._farZ),"globe_pole_raster",Ft,je,it);O.setupElevationDraw(ht,k,ue),A.uploadCommonUniforms(U,k,Ee.toUnwrapped()),le&&A.renderDefaultNorthPole&&At(k,ke),pe&&A.renderDefaultSouthPole&&(St=s.a6.scale(s.a6.create(),St,[1,-1,1]),At(k,$e))}}}})(c,f,g,b,v);else{const A=c.context,O=A.gl;let R,P;const N=c.shadowRenderer,U=Nn(c,c.longestCutoffRange),B=Z=>{if(P===Z)return;const z=[];z.push(g_[Z]),U.shouldRenderCutoff&&z.push("RENDER_CUTOFF"),R=c.getOrCreateProgram("terrainRaster",{defines:z}),P=Z},k=c.colorModeForRenderPass(),M=new wt(O.LEQUAL,wt.ReadWrite,c.depthRangeFor3D);Gs.update(v);const H=c.transform,$=y_(H.zoom,f.exaggeration(),f.sourceCache._source.tileSize);let V=[0,0,0];if(N){const Z=c.style.directionalLight,z=c.style.ambientLight;Z&&z&&(V=wl(Z,z))}{P=-1;const Z=O.TRIANGLES,[z,X]=[f.gridIndexBuffer,f.gridSegments];for(const ie of b){const ne=g.getTile(ie),re=Bt.disabled,ye=f.prevTerrainTileForTile[ie.key],ue=f.terrainTileForTile[ie.key];Ll(ye,ue)&&Gs.newMorphing(ie.key,ye,ue,v,250),A.activeTexture.set(O.TEXTURE0),ne.texture&&ne.texture.bind(O.LINEAR,O.CLAMP_TO_EDGE);const Ie=Gs.getMorphValuesForProxy(ie.key),Ee=Ie?1:0;let Ue;Ie&&(Ue={morphing:{srcDemTile:Ie.from,dstDemTile:Ie.to,phase:s.cc(Ie.phase)}});const ce=Br(ie.projMatrix,Vs(ie.canonical,H.renderWorldCopies)?$/10:$,V);if(B(Ee),!R)continue;f.setupElevationDraw(ne,R,Ue);const Te=ie.toUnwrapped();N&&N.setupShadows(Te,R),c.uploadCommonUniforms(A,R,Te,null,U),R.draw(c,Z,M,re,k,Pt.backCCW,ce,"terrain_raster",f.gridBuffer,z,X)}}}}(n,this,this.proxySourceCache,a,this._updateTimestamp),this.renderingToTexture=!0,n.gpuTimingDeferredRenderEnd(),a.splice(0,a.length))}renderBatch(a){if(this._drapedRenderBatches.length===0)return a+1;this.renderingToTexture=!0;const n=this.painter,_=this.painter.context,c=this.proxySourceCache,f=this.proxiedCoords[c.id],g=this._drapedRenderBatches.shift(),b=n.style.order,v=[];let A=0;for(const O of f){const R=c.getTileByID(O.proxyTileKey),P=c.proxyCachedFBO[O.key]?c.proxyCachedFBO[O.key][a]:void 0,N=P!==void 0?c.renderCache[P]:this.pool[A++],U=P!==void 0;if(R.texture=N.tex,U&&!N.dirty){v.push(R.tileID);continue}let B;_.bindFramebuffer.set(N.fb.framebuffer),this.renderedToTile=!1,N.dirty&&(_.clear({color:s.ax.transparent,stencil:0}),N.dirty=!1);for(let k=g.start;k<=g.end;++k){const M=n.style._mergedLayers[b[k]];if(M.isHidden(n.transform.zoom))continue;const H=n.style.getLayerSourceCache(M),$=H?this.proxyToSource[O.key][H.id]:[O];if(!$)continue;const V=$;_.viewport.set([0,0,N.fb.width,N.fb.height]),B!==(H?H.id:null)&&(this._setupStencil(N,$,M,H),B=H?H.id:null),n.renderLayer(n,H,M,V)}if(this._drapedRenderBatches.length===0)for(const k of this._pendingGroundEffectLayers){const M=n.style._mergedLayers[b[k]];if(M.isHidden(n.transform.zoom))continue;const H=n.style.getLayerSourceCache(M),$=H?this.proxyToSource[O.key][H.id]:[O];if(!$)continue;const V=$;_.viewport.set([0,0,N.fb.width,N.fb.height]),B!==(H?H.id:null)&&(this._setupStencil(N,$,M,H),B=H?H.id:null),n.renderLayer(n,H,M,V)}this.renderedToTile?(N.dirty=!0,v.push(R.tileID)):U||--A,A===5&&(A=0,this.renderToBackBuffer(v))}return this.renderToBackBuffer(v),this.renderingToTexture=!1,_.bindFramebuffer.set(null),_.viewport.set([0,0,n.width,n.height]),g.end+1}postRender(){}isLayerOrderingCorrect(a){const n=a.order.length;let _=-1,c=n;for(let f=0;f<n;++f)this._style.isLayerDraped(a._mergedLayers[a.order[f]])?_=Math.max(_,f):c=Math.min(c,f);return c>_}getMinElevationBelowMSL(){let a=0;return this._visibleDemTiles.filter(n=>n.dem).forEach(n=>{a=Math.min(a,n.dem.tree.minimums[0])}),a===0?a:(a-30)*this._exaggeration}raycast(a,n,_){if(!this._visibleDemTiles)return null;const c=this._visibleDemTiles.filter(f=>f.dem).map(f=>{const g=f.tileID,b=1<<g.overscaledZ,{x:v,y:A}=g.canonical,O=v/b,R=(v+1)/b,P=A/b,N=(A+1)/b;return{minx:O,miny:P,maxx:R,maxy:N,t:f.dem.tree.raycastRoot(O,P,R,N,a,n,_),tile:f}});c.sort((f,g)=>(f.t!==null?f.t:Number.MAX_VALUE)-(g.t!==null?g.t:Number.MAX_VALUE));for(const f of c){if(f.t==null)return null;const g=f.tile.dem.tree.raycast(f.minx,f.miny,f.maxx,f.maxy,a,n,_);if(g!=null)return g}return null}_createFBO(){const a=this.painter.context,n=a.gl,_=this.drapeBufferSize;a.activeTexture.set(n.TEXTURE0);const c=new s.T(a,{width:_[0],height:_[1],data:null},n.RGBA);c.bind(n.LINEAR,n.CLAMP_TO_EDGE);const f=a.createFramebuffer(_[0],_[1],!0,null);return f.colorAttachment.set(c.texture),f.depthAttachment=new io(a,f.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=a.createRenderbuffer(a.gl.DEPTH_STENCIL,_[0],_[1]),this._stencilRef=0,f.depthAttachment.set(this._sharedDepthStencil),a.clear({stencil:0})):f.depthAttachment.set(this._sharedDepthStencil),a.extTextureFilterAnisotropic&&n.texParameterf(n.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax),{fb:f,tex:c,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const a in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[a].hasTransition())return!0;return this._style.order.some(a=>{const n=this._style._mergedLayers[a],_=n.isHidden(this.painter.transform.zoom);return n.type==="custom"?!_&&n.shouldRedrape():!_&&n.hasTransition()})}_clearLineLayersFromRenderCache(){let a=!1;for(const _ of this._style.getSources())if(_ instanceof at){a=!0;break}if(!a)return;const n={};for(let _=0;_<this._style.order.length;++_){const c=this._style._mergedLayers[this._style.order[_]],f=this._style.getLayerSourceCache(c);if(f&&!n[f.id]&&!c.isHidden(this.painter.transform.zoom)&&c.type==="line"&&c.widthExpression()instanceof s.Z){n[f.id]=!0;for(const g of this.proxyCoords){const b=this.proxyToSource[g.key][f.id];if(b)for(const v of b)this._clearRenderCacheForTile(f.id,v)}}}}_clearRasterLayersFromRenderCache(){let a=!1;for(const _ in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[_]._source instanceof nt){a=!0;break}if(!a)return;const n={};for(let _=0;_<this._style.order.length;++_){const c=this._style._mergedLayers[this._style.order[_]],f=this._style.getLayerSourceCache(c);if(!f||n[f.id]||c.isHidden(this.painter.transform.zoom)||c.type!=="raster")continue;const g=c.paint.get("raster-fade-duration");for(const b of this.proxyCoords){const v=this.proxyToSource[b.key][f.id];if(v)for(const A of v){const O=T_(f.getTile(A),f.findLoadedParent(A,0),f,this.painter.transform,g);(O.opacity!==1||O.mix!==0)&&this._clearRenderCacheForTile(f.id,A)}}}}_setupDrapedRenderBatches(){const a=this._style.order,n=a.length;if(n===0)return;const _=[];this._pendingGroundEffectLayers=[];let c,f=0,g=this._style._mergedLayers[a[f]];for(;!this._style.isLayerDraped(g)&&g.isHidden(this.painter.transform.zoom)&&++f<n;)g=this._style._mergedLayers[a[f]];for(;f<n;++f){const b=this._style._mergedLayers[a[f]];b.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(b)?c===void 0&&(c=f):(b.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(f),c!==void 0&&(_.push({start:c,end:f-1}),c=void 0)))}if(c!==void 0&&_.push({start:c,end:f-1}),_.length!==0){const b=_[_.length-1];this._pendingGroundEffectLayers.every(v=>v>b.end)||s.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=_}_setupRenderCache(a){const n=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,n.renderCache.length>n.renderCachePool.length){const g=Object.values(n.proxyCachedFBO);n.proxyCachedFBO={};for(let b=0;b<g.length;++b){const v=Object.values(g[b]);n.renderCachePool.push(...v)}}return}this._clearRasterLayersFromRenderCache();const _=this.proxyCoords,c=this._tilesDirty;for(let g=_.length-1;g>=0;g--){const b=_[g];if(n.getTileByID(b.key),n.proxyCachedFBO[b.key]!==void 0){const v=a[b.key],A=this.proxyToSource[b.key];let O=0;for(const R in A){const P=A[R],N=v[R];if(!N||N.length!==P.length||P.some((U,B)=>U!==N[B]||c[R]&&c[R].hasOwnProperty(U.key))){O=-1;break}++O}for(const R in n.proxyCachedFBO[b.key])n.renderCache[n.proxyCachedFBO[b.key][R]].dirty=O<0||O!==Object.values(v).length}}const f=[...this._drapedRenderBatches];f.sort((g,b)=>b.end-b.start-(g.end-g.start));for(const g of f)for(const b of _){if(n.proxyCachedFBO[b.key])continue;let v=n.renderCachePool.pop();v===void 0&&n.renderCache.length<50&&(v=n.renderCache.length,n.renderCache.push(this._createFBO())),v!==void 0&&(n.proxyCachedFBO[b.key]={},n.proxyCachedFBO[b.key][g.start]=v,n.renderCache[v].dirty=!0)}this._tilesDirty={}}_setupStencil(a,n,_,c){if(!c||!this._sourceTilesOverlap[c.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const f=this.painter.context,g=f.gl;if(n.length<=1)return void(this._overlapStencilType=!1);let b;if(_.isTileClipped())b=n.length,this._overlapStencilMode.test={func:g.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(n[0].overscaledZ>n[n.length-1].overscaledZ))return void(this._overlapStencilType=!1);b=1,this._overlapStencilMode.test={func:g.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+b>255&&(f.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=b,this._overlapStencilMode.ref=this._stencilRef,_.isTileClipped()&&this._renderTileClippingMasks(n,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(a){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[a.key]),this._overlapStencilMode):Bt.disabled}_renderTileClippingMasks(a,n){const _=this.painter,c=this.painter.context,f=c.gl;_._tileClippingMaskIDs={},c.setColorMode(Jt.disabled),c.setDepthMode(wt.disabled);const g=_.getOrCreateProgram("clippingMask");for(const b of a){const v=_._tileClippingMaskIDs[b.key]=--n;g.draw(_,f.TRIANGLES,wt.disabled,new Bt({func:f.ALWAYS,mask:0},v,255,f.KEEP,f.KEEP,f.REPLACE),Jt.disabled,Pt.disabled,b_(b.projMatrix),"$clipping",_.tileExtentBuffer,_.quadTriangleIndexBuffer,_.tileExtentSegments)}}pointCoordinate(a){const n=this.painter.transform;if(a.x<0||a.x>n.width||a.y<0||a.y>n.height)return null;const _=[a.x,a.y,1,1];s.a7.transformMat4(_,_,n.pixelMatrixInverse),s.a7.scale(_,_,1/_[3]),_[0]/=n.worldSize,_[1]/=n.worldSize;const c=n._camera.position,f=s.bl(1,n.center.lat),g=[c[0],c[1],c[2]/f,0],b=s.N.subtract([],_.slice(0,3),g);s.N.normalize(b,b);const v=this.raycast(g,b,this._exaggeration);return v!==null&&v?(s.N.scaleAndAdd(g,g,b,v),g[3]=g[2],g[2]*=f,g):null}drawDepth(){const a=this.painter,n=a.context,_=this.proxySourceCache,c=Math.ceil(a.width),f=Math.ceil(a.height);if(!this._depthFBO||this._depthFBO.width===c&&this._depthFBO.height===f||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const g=n.gl,b=n.createFramebuffer(c,f,!0,"renderbuffer");n.activeTexture.set(g.TEXTURE0);const v=new s.T(n,{width:c,height:f,data:null},g.RGBA);v.bind(g.NEAREST,g.CLAMP_TO_EDGE),b.colorAttachment.set(v.texture);const A=n.createRenderbuffer(n.gl.DEPTH_COMPONENT16,c,f);b.depthAttachment.set(A),this._depthFBO=b,this._depthTexture=v}n.bindFramebuffer.set(this._depthFBO.framebuffer),n.viewport.set([0,0,c,f]),function(g,b,v,A){if(g.transform.projection.name==="globe")return;const O=g.context,R=O.gl;O.clear({depth:1});const P=g.getOrCreateProgram("terrainDepth"),N=new wt(R.LESS,wt.ReadWrite,g.depthRangeFor3D);for(const U of A){const B=v.getTile(U),k=Br(U.projMatrix,0,[0,0,0]);b.setupElevationDraw(B,P),P.draw(g,R.TRIANGLES,N,Bt.disabled,Jt.unblended,Pt.backCCW,k,"terrain_depth",b.gridBuffer,b.gridIndexBuffer,b.gridNoSkirtSegments)}}(a,this,_,this.proxyCoords)}_setupProxiedCoordsForOrtho(a,n,_){if(a.getSource()instanceof s.ap)return this._setupProxiedCoordsForImageSource(a,n,_);this._findCoveringTileCache[a.id]=this._findCoveringTileCache[a.id]||{};const c=this.proxiedCoords[a.id]=[],f=this.proxyCoords;for(let v=0;v<f.length;v++){const A=f[v],O=this._findTileCoveringTileID(A,a);if(O){const R=this._createProxiedId(A,O,_[A.key]&&_[A.key][a.id]);c.push(R),this.proxyToSource[A.key][a.id]=[R]}}let g=!1;const b=new Set;for(let v=0;v<n.length;v++){const A=a.getTile(n[v]);if(!A||!A.hasData())continue;const O=this._findTileCoveringTileID(A.tileID,this.proxySourceCache);if(O&&O.tileID.canonical.z!==A.tileID.canonical.z){const R=this.proxyToSource[O.tileID.key][a.id],P=this._createProxiedId(O.tileID,A,_[O.tileID.key]&&_[O.tileID.key][a.id]);R?R.splice(R.length-1,0,P):this.proxyToSource[O.tileID.key][a.id]=[P];const N=this.proxyToSource[O.tileID.key][a.id];b.has(N)||b.add(N),c.push(P),g=!0}}if(this._sourceTilesOverlap[a.id]=g,g&&this._debugParams.sortTilesHiZFirst)for(const v of b)v.sort((A,O)=>O.overscaledZ-A.overscaledZ)}_setupProxiedCoordsForImageSource(a,n,_){if(!a.getSource().loaded())return;const c=this.proxiedCoords[a.id]=[],f=this.proxyCoords,g=a.getSource(),b=g.tileID;if(!b)return;const v=new s.P(b.x,b.y)._div(1<<b.z),A=g.coordinates.map(s.L.fromLngLat).reduce((R,P)=>(R.min.x=Math.min(R.min.x,P.x-v.x),R.min.y=Math.min(R.min.y,P.y-v.y),R.max.x=Math.max(R.max.x,P.x-v.x),R.max.y=Math.max(R.max.y,P.y-v.y),R),{min:new s.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),O=(R,P)=>{const N=R.wrap+R.canonical.x/(1<<R.canonical.z),U=R.canonical.y/(1<<R.canonical.z),B=s.V/(1<<R.canonical.z),k=P.wrap+P.canonical.x/(1<<P.canonical.z),M=P.canonical.y/(1<<P.canonical.z);return N+B<k+A.min.x||N>k+A.max.x||U+B<M+A.min.y||U>M+A.max.y};for(let R=0;R<f.length;R++){const P=f[R];for(let N=0;N<n.length;N++){const U=a.getTile(n[N]);if(!U||!U.hasData()||O(P,U.tileID))continue;const B=this._createProxiedId(P,U,_[P.key]&&_[P.key][a.id]),k=this.proxyToSource[P.key][a.id];k?k.push(B):this.proxyToSource[P.key][a.id]=[B],c.push(B)}}}_createProxiedId(a,n,_){let c=this.orthoMatrix;if(_){const f=_.find(g=>g.key===n.tileID.key);if(f)return f}if(n.tileID.key!==a.key){const f=a.canonical.z-n.tileID.canonical.z;let g,b,v;c=s.a6.create();const A=n.tileID.wrap-a.wrap<<a.overscaledZ;f>0?(g=s.V>>f,b=g*((n.tileID.canonical.x<<f)-a.canonical.x+A),v=g*((n.tileID.canonical.y<<f)-a.canonical.y)):(g=s.V<<-f,b=s.V*(n.tileID.canonical.x-(a.canonical.x+A<<-f)),v=s.V*(n.tileID.canonical.y-(a.canonical.y<<-f))),s.a6.ortho(c,0,g,0,g,0,1),s.a6.translate(c,c,[b,v,0])}return new dc(n.tileID,a.key,c)}_findTileCoveringTileID(a,n){let _=n.getTile(a);if(_&&_.hasData())return _;const c=this._findCoveringTileCache[n.id],f=c[a.key];if(_=f?n.getTileByID(f):null,_&&_.hasData()||f===null)return _;let g=_?_.tileID:a,b=g.overscaledZ;const v=n.getSource().minzoom,A=[];if(!f){const R=n.getSource().maxzoom;if(a.canonical.z>=R){const P=a.canonical.z-R;n.getSource().reparseOverscaled?(b=Math.max(a.canonical.z+2,n.transform.tileZoom),g=new s.am(b,a.wrap,R,a.canonical.x>>P,a.canonical.y>>P)):P!==0&&(b=R,g=new s.am(b,a.wrap,R,a.canonical.x>>P,a.canonical.y>>P))}g.key!==a.key&&(A.push(g.key),_=n.getTile(g))}const O=R=>{A.forEach(P=>{c[P]=R}),A.length=0};for(b-=1;b>=v&&(!_||!_.hasData());b--){_&&O(_.tileID.key);const R=g.calculateScaledKey(b);if(_=n.getTileByID(R),_&&_.hasData())break;const P=c[R];if(P===null)break;P===void 0?A.push(R):_=n.getTileByID(P)}return O(_?_.tileID.key:null),_&&_.hasData()?_:null}findDEMTileFor(a){return this.enabled?this._findTileCoveringTileID(a,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(a,n){let _=this._tilesDirty[a];_||(_=this._tilesDirty[a]={}),_[n.key]=!0}}function x_(d,a,n){const _=function(b,v,A){const O=s.N.dot(v,b),R=s.N.dot(A,[.2126,.7152,.0722]),P=(U,B,k)=>(1-k)*U+k*B,N=P(1-.3*Math.min(R,1),1,Math.min(O+1,1));return P(.92,1,Math.asin(s.aa(v[2],-1,1))/Math.PI+.5)*N}(d,[0,0,1],a),c=[0,0,0];s.N.scale(c,n.slice(0,3),_);const f=[0,0,0];s.N.scale(f,a.slice(0,3),d[2]);const g=[0,0,0];return s.N.add(g,c,f),s.bU(g)}const v_=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],_c=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class E_{static cacheKey(a,n,_,c){let f=`${n}${c?c.cacheKey:""}`;for(const g of _)a.usedDefines.includes(g)&&(f+=`/${g}`);return f}constructor(a,n,_,c,f,g,b){const v=a.gl;this.program=v.createProgram(),this.configuration=c,this.name=n,this.fixedDefines=[...g];const A=c?c.getBinderAttributes():[],O=(_.staticAttributes||[]).concat(A);let R=c?c.defines():[];R=R.concat(g.map(M=>`#define ${M}`));const P=`#version 300 es
`;let N=P+R.concat("precision mediump float;",Dr,m_.fragmentSource).join(`
`);for(const M of _.fragmentIncludes)N+=`
${mo[M]}`;N+=`
${_.fragmentSource}`;let U=P+R.concat("precision highp float;",Dr,m_.vertexSource).join(`
`);for(const M of _.vertexIncludes)U+=`
${mo[M]}`;U+=`
${_.vertexSource}`;const B=v.createShader(v.FRAGMENT_SHADER);if(v.isContextLost())return void(this.failedToCreate=!0);v.shaderSource(B,N),v.compileShader(B),v.attachShader(this.program,B);const k=v.createShader(v.VERTEX_SHADER);if(v.isContextLost())this.failedToCreate=!0;else{v.shaderSource(k,U),v.compileShader(k),v.attachShader(this.program,k),this.attributes={},this.numAttributes=O.length;for(let M=0;M<this.numAttributes;M++)if(O[M]){const H=O[M].startsWith("a_")?O[M]:`a_${O[M]}`;v.bindAttribLocation(this.program,M,H),this.attributes[H]=M}b&&b.shaderVaryings.length>0&&v.transformFeedbackVaryings(this.program,b.shaderVaryings,b.bufferMode),v.linkProgram(this.program),v.deleteShader(k),v.deleteShader(B),this.fixedUniforms=f(a),this.binderUniforms=c?c.getUniforms(a):[],g.includes("TERRAIN")&&(this.terrainUniforms=(M=>({u_dem:new s.bO(M),u_dem_prev:new s.bO(M),u_dem_tl:new s.bL(M),u_dem_scale:new s.bN(M),u_dem_tl_prev:new s.bL(M),u_dem_scale_prev:new s.bN(M),u_dem_size:new s.bN(M),u_dem_lerp:new s.bN(M),u_exaggeration:new s.bN(M),u_depth:new s.bO(M),u_depth_size_inv:new s.bL(M),u_meter_to_dem:new s.bN(M),u_label_plane_matrix_inv:new s.bK(M)}))(a)),g.includes("GLOBE")&&(this.globeUniforms=(M=>({u_tile_tl_up:new s.bM(M),u_tile_tr_up:new s.bM(M),u_tile_br_up:new s.bM(M),u_tile_bl_up:new s.bM(M),u_tile_up_scale:new s.bN(M)}))(a)),g.includes("FOG")&&(this.fogUniforms=(M=>({u_fog_matrix:new s.bK(M),u_fog_range:new s.bL(M),u_fog_color:new s.bP(M),u_fog_horizon_blend:new s.bN(M),u_fog_vertical_limit:new s.bL(M),u_fog_temporal_offset:new s.bN(M),u_frustum_tl:new s.bM(M),u_frustum_tr:new s.bM(M),u_frustum_br:new s.bM(M),u_frustum_bl:new s.bM(M),u_globe_pos:new s.bM(M),u_globe_radius:new s.bN(M),u_globe_transition:new s.bN(M),u_is_globe:new s.bO(M),u_viewport:new s.bL(M)}))(a)),g.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(M=>({u_cutoff_params:new s.bP(M)}))(a)),g.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(M=>({u_lighting_ambient_color:new s.bM(M),u_lighting_directional_dir:new s.bM(M),u_lighting_directional_color:new s.bM(M),u_ground_radiance:new s.bM(M)}))(a)),g.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(M=>({u_light_matrix_0:new s.bK(M),u_light_matrix_1:new s.bK(M),u_fade_range:new s.bL(M),u_shadow_normal_offset:new s.bM(M),u_shadow_intensity:new s.bN(M),u_shadow_texel_size:new s.bN(M),u_shadow_map_resolution:new s.bN(M),u_shadow_direction:new s.bM(M),u_shadow_bias:new s.bM(M),u_shadowmap_0:new s.bO(M),u_shadowmap_1:new s.bO(M)}))(a))}}setTerrainUniformValues(a,n){if(!this.terrainUniforms)return;const _=this.terrainUniforms;if(!this.failedToCreate){a.program.set(this.program);for(const c in n)_[c]&&_[c].set(this.program,c,n[c])}}setGlobeUniformValues(a,n){if(!this.globeUniforms)return;const _=this.globeUniforms;if(!this.failedToCreate){a.program.set(this.program);for(const c in n)_[c]&&_[c].set(this.program,c,n[c])}}setFogUniformValues(a,n){if(!this.fogUniforms)return;const _=this.fogUniforms;if(!this.failedToCreate){a.program.set(this.program);for(const c in n)_[c].set(this.program,c,n[c])}}setCutoffUniformValues(a,n){if(!this.cutoffUniforms)return;const _=this.cutoffUniforms;if(!this.failedToCreate){a.program.set(this.program);for(const c in n)_[c].set(this.program,c,n[c])}}setLightsUniformValues(a,n){if(!this.lightsUniforms)return;const _=this.lightsUniforms;if(!this.failedToCreate){a.program.set(this.program);for(const c in n)_[c].set(this.program,c,n[c])}}setShadowUniformValues(a,n){if(this.failedToCreate||!this.shadowUniforms)return;const _=this.shadowUniforms;a.program.set(this.program);for(const c in n)_[c].set(this.program,c,n[c])}_drawDebugWireframe(a,n,_,c,f,g,b,v,A,O){const R=a.options.wireframe;if(R.terrain===!1&&R.layers2D===!1&&R.layers3D===!1)return;const P=a.context;if(!(()=>!(!R.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!R.layers2D||a._terrain&&a._terrain.renderingToTexture||!v_.includes(this.name))||!(!R.layers3D||!_c.includes(this.name)))())return;const N=P.gl,U=a.wireframeDebugCache.getLinesFromTrianglesBuffer(a.frameCounter,f,P);if(!U)return;const B=[...this.fixedDefines];B.push("DEBUG_WIREFRAME");const k=a.getOrCreateProgram(this.name,{config:this.configuration,defines:B});P.program.set(k.program);const M=(V,Z,z)=>{if(Z[V]&&z[V])for(const X in Z[V])z[V][X]&&z[V][X].set(z.program,X,Z[V][X].current)};A&&A.setUniforms(k.program,P,k.binderUniforms,b,{zoom:v}),M("fixedUniforms",this,k),M("terrainUniforms",this,k),M("globeUniforms",this,k),M("fogUniforms",this,k),M("lightsUniforms",this,k),M("shadowUniforms",this,k),U.bind(),P.setColorMode(new Jt([N.ONE,N.ONE_MINUS_SRC_ALPHA,N.ZERO,N.ONE],s.ax.transparent,[!0,!0,!0,!1])),P.setDepthMode(new wt(n.func===N.LESS?N.LEQUAL:n.func,wt.ReadOnly,n.range)),P.setStencilMode(Bt.disabled);const H=3*g.primitiveLength*2,$=3*g.primitiveOffset*2*2;O&&O>1?N.drawElementsInstanced(N.LINES,H,N.UNSIGNED_SHORT,$,O):N.drawElements(N.LINES,H,N.UNSIGNED_SHORT,$),f.bind(),P.program.set(this.program),P.setDepthMode(n),P.setStencilMode(_),P.setColorMode(c)}draw(a,n,_,c,f,g,b,v,A,O,R,P,N,U,B,k,M){const H=a.context,$=H.gl;if(this.failedToCreate)return;H.program.set(this.program),H.setDepthMode(_),H.setStencilMode(c),H.setColorMode(f),H.setCullFace(g);for(const X of Object.keys(this.fixedUniforms))this.fixedUniforms[X].set(this.program,X,b[X]);U&&U.setUniforms(this.program,H,this.binderUniforms,P,{zoom:N});const V={[$.POINTS]:1,[$.LINES]:2,[$.TRIANGLES]:3,[$.LINE_STRIP]:1}[n],Z=M&&M.length>0;if(Z){for(const X of M)$.bindBufferBase($.TRANSFORM_FEEDBACK_BUFFER,X.targetIndex,X.buffer.buffer);$.beginTransformFeedback(n)}const z=k&&k>0?1:void 0;for(const X of R.get()){const ie=X.vaos||(X.vaos={});(ie[v]||(ie[v]=new p_)).bind(H,this,A,U?U.getPaintVertexBuffers():[],O,X.vertexOffset,B||[],z),k&&k>1?$.drawElementsInstanced(n,X.primitiveLength*V,$.UNSIGNED_SHORT,X.primitiveOffset*V*2,k):O?$.drawElements(n,X.primitiveLength*V,$.UNSIGNED_SHORT,X.primitiveOffset*V*2):$.drawArrays(n,X.vertexOffset,X.vertexLength),n===$.TRIANGLES&&O&&this._drawDebugWireframe(a,_,c,f,O,X,P,N,U,k)}Z&&$.endTransformFeedback()}}function A_(d,a){const n=Math.pow(2,a.tileID.overscaledZ),_=a.tileSize*Math.pow(2,d.transform.tileZoom)/n,c=_*(a.tileID.canonical.x+a.tileID.wrap*n),f=_*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture?a.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/s.a3(a,1,d.transform.tileZoom),u_pixel_coord_upper:[c>>16,f>>16],u_pixel_coord_lower:[65535&c,65535&f]}}const uc=s.a6.create(),I_=(d,a,n,_,c,f,g,b,v,A,O,R,P,N,U,B)=>{const k=a.style.light,M=k.properties.get("position"),H=[M.x,M.y,M.z],$=s.co.create();k.properties.get("anchor")==="viewport"&&(s.co.fromRotation($,-a.transform.angle),s.N.transformMat3(H,H,$));const V=k.properties.get("color"),Z=a.transform,z={u_matrix:d,u_lightpos:H,u_lightintensity:k.properties.get("intensity"),u_lightcolor:[V.r,V.g,V.b],u_vertical_gradient:+n,u_opacity:_,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:uc,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:c,u_edge_radius:f,u_flood_light_color:R,u_vertical_scale:P,u_flood_light_intensity:N,u_ground_shadow_factor:U,u_emissive_strength:B};return Z.projection.name==="globe"&&(z.u_tile_id=[g.canonical.x,g.canonical.y,1<<g.canonical.z],z.u_zoom_transition=v,z.u_inv_rot_matrix=O,z.u_merc_center=A,z.u_up_dir=Z.projection.upVector(new s.bs(0,0,0),A[0]*s.V,A[1]*s.V),z.u_height_lift=b),z},O_=(d,a,n)=>({u_matrix:d,u_edge_radius:a,u_vertical_scale:n}),ds=(d,a,n,_,c,f,g,b,v,A,O,R,P,N)=>{const U=I_(d,a,n,_,c,f,g,v,A,O,R,P,N,1,[0,0,0],0),B={u_height_factor:-Math.pow(2,g.overscaledZ)/b.tileSize/8};return s.e(U,A_(a,b),B)},js=(d,a)=>({u_matrix:d,u_emissive_strength:a}),S_=(d,a,n,_)=>s.e(js(d,a),A_(n,_)),_s=(d,a,n)=>({u_matrix:d,u_world:n,u_emissive_strength:a}),cc=(d,a,n,_,c)=>s.e(S_(d,a,n,_),{u_world:c}),Ur=(d,a,n,_)=>{const c=s.V/n.tileSize;return{u_matrix:d,u_camera_to_center_distance:a.getCameraToCenterDistance(_),u_extrude_scale:[a.pixelsToGLUnits[0]/c,a.pixelsToGLUnits[1]/c]}},R_=(d,a,n=1)=>({u_matrix:d,u_color:a,u_overlay:0,u_overlay_scale:n}),mc=s.a6.create(),C_=(d,a,n,_,c,f,g)=>{const b=d.transform,v=b.projection.name==="globe",A=v?s.cp(b.zoom,a.canonical)*b._pixelsPerMercatorPixel:s.a3(n,1,f),O={u_matrix:a.projMatrix,u_extrude_scale:A,u_intensity:g,u_inv_rot_matrix:mc,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(v){O.u_inv_rot_matrix=_,O.u_merc_center=c,O.u_tile_id=[a.canonical.x,a.canonical.y,1<<a.canonical.z],O.u_zoom_transition=s.S(b.zoom);const R=c[0]*s.V,P=c[1]*s.V;O.u_up_dir=b.projection.upVector(new s.bs(0,0,0),R,P)}return O};function kr(d,[a,n,_,c],[f,g]){if(f===g)return[0,0,0,0];const b=255*(d-1)/(d*(g-f));return[a*b,n*b,_*b,c*b]}function fc(d,a,[n,_]){return n===_?0:.5/d+(a-n)*(d-1)/(d*(_-n))}const w_=(d,a,n,_,c,f,g,b,v,A,O,R,P,N,U,B,k,M,H,$,V)=>{return{u_matrix:d,u_normalize_matrix:a,u_globe_matrix:n,u_merc_matrix:_,u_grid_matrix:c,u_tl_parent:f,u_scale_parent:A,u_fade_t:O.mix,u_opacity:O.opacity*R.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:R.paint.get("raster-brightness-min"),u_brightness_high:R.paint.get("raster-brightness-max"),u_saturation_factor:(z=R.paint.get("raster-saturation"),z>0?1-1/(1.001-z):-z),u_contrast_factor:(Z=R.paint.get("raster-contrast"),Z>0?1/(1-Z):1+Z),u_spin_weights:Nl(R.paint.get("raster-hue-rotate")),u_perspective_transform:P,u_raster_elevation:N,u_zoom_transition:g,u_merc_center:b,u_cutoff_params:v,u_colorization_mix:kr(s.cq,B,M),u_colorization_offset:fc(s.cq,k,M),u_color_ramp:U,u_texture_offset:[$/(H+2*$),H/(H+2*$)],u_texture_res:[H+2*$,H+2*$],u_emissive_strength:V};var Z,z};function Nl(d){d*=Math.PI/180;const a=Math.sin(d),n=Math.cos(d);return[(2*n+1)/3,(-Math.sqrt(3)*a-n+1)/3,(Math.sqrt(3)*a-n+1)/3]}const Af=(d,a,n,_,c,f,g,b,v,A,O,R)=>({u_matrix:d,u_normalize_matrix:a,u_globe_matrix:n,u_merc_matrix:_,u_grid_matrix:c,u_tl_parent:f,u_scale_parent:A,u_fade_t:O.mix,u_opacity:O.opacity,u_image0:0,u_image1:1,u_raster_elevation:R,u_zoom_transition:g,u_merc_center:b,u_cutoff_params:v}),If=(d,a,n,_,c,f,g,b)=>({u_tile_offset:d,u_velocity:a,u_color_ramp:_,u_velocity_res:n,u_max_speed:c,u_texture_offset:f,u_data_scale:g,u_data_offset:b}),pc=(d,a,n,_,c,f,g,b)=>({u_velocity:d,u_velocity_res:a,u_max_speed:n,u_speed_factor:_,u_lifetime_delta:c,u_rand_seed:Math.random(),u_texture_offset:f,u_data_scale:g,u_data_offset:b}),hc=s.a6.create(),zr=(d,a,n,_,c,f,g,b,v,A,O,R,P,N,U,B,k,M)=>{const H=c.transform,$={u_is_size_zoom_constant:+(d==="constant"||d==="source"),u_is_size_feature_constant:+(d==="constant"||d==="camera"),u_size_t:a?a.uSizeT:0,u_size:a?a.uSize:0,u_camera_to_center_distance:H.getCameraToCenterDistance(B),u_rotate_symbol:+n,u_aspect_ratio:H.width/H.height,u_fade_change:c.options.fadeDuration?c.symbolFadeChange:1,u_matrix:f,u_label_plane_matrix:g,u_coord_matrix:b,u_is_text:+v,u_pitch_with_map:+_,u_texsize:A,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:hc,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:hc,u_up_vector:[0,-1,0],u_icon_transition:M||0,u_icon_saturation:k};return B.name==="globe"&&($.u_tile_id=[O.canonical.x,O.canonical.y,1<<O.canonical.z],$.u_zoom_transition=R,$.u_inv_rot_matrix=N,$.u_merc_center=P,$.u_camera_forward=H._camera.forward(),$.u_ecef_origin=s.cr(H.globeMatrix,O.toUnwrapped()),$.u_tile_matrix=Float32Array.from(H.globeMatrix),$.u_up_vector=U),$},Wl=(d,a,n,_,c,f,g,b,v,A,O,R,P,N,U,B,k)=>s.e(zr(d,a,n,_,c,f,g,b,v,A,R,P,N,U,B,k,1),{u_gamma_scale:_?c.transform.getCameraToCenterDistance(k)*Math.cos(c.terrain?0:c.transform._pitch):1,u_device_pixel_ratio:s.f.devicePixelRatio,u_is_halo:+O,undefined:void 0}),Hr=(d,a,n,_,c,f,g,b,v,A,O,R,P,N,U,B)=>s.e(Wl(d,a,n,_,c,f,g,b,!0,v,!0,O,R,P,N,U,B),{u_texsize_icon:A,u_texture_icon:1}),P_=(d,a,n,_)=>({u_matrix:d,u_emissive_strength:a,u_opacity:n,u_color:_}),Ml=(d,a,n,_,c,f,g)=>s.e(function(b,v,A,O){const R=A.imageManager.getPattern(b.toString(),v),{width:P,height:N}=A.imageManager.getPixelSize(v),U=Math.pow(2,O.tileID.overscaledZ),B=O.tileSize*Math.pow(2,A.transform.tileZoom)/U,k=B*(O.tileID.canonical.x+O.tileID.wrap*U),M=B*O.tileID.canonical.y;return{u_image:0,u_pattern_tl:R.tl,u_pattern_br:R.br,u_texsize:[P,N],u_pattern_size:R.displaySize,u_tile_units_to_pixels:1/s.a3(O,1,A.transform.tileZoom),u_pixel_coord_upper:[k>>16,M>>16],u_pixel_coord_lower:[65535&k,65535&M]}}(c,f,_,g),{u_matrix:d,u_emissive_strength:a,u_opacity:n}),Yr=(d,a,n,_,c,f,g,b,v,A,O,R,P=[0,0,0],N)=>{const U=_.style.light,B=U.properties.get("position"),k=[-B.x,-B.y,B.z],M=s.co.create();U.properties.get("anchor")==="viewport"&&(s.co.fromRotation(M,-_.transform.angle),s.N.transformMat3(k,k,M));const H=A.alphaMode==="MASK",$=U.properties.get("color"),V=R.paint.get("model-ambient-occlusion-intensity"),Z=R.paint.get("model-color").constantOr(s.ax.white),z=R.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:d,u_lighting_matrix:a,u_normal_matrix:n,u_lightpos:k,u_lightintensity:U.properties.get("intensity"),u_lightcolor:[$.r,$.g,$.b],u_camera_pos:P,u_opacity:c,u_baseTextureIsAlpha:0,u_alphaMask:+H,u_alphaCutoff:A.alphaCutoff,u_baseColorFactor:[f.r,f.g,f.b,f.a],u_emissiveFactor:[g[0],g[1],g[2],1],u_metallicFactor:b,u_roughnessFactor:v,u_baseColorTexture:Fa.BaseColor,u_metallicRoughnessTexture:Fa.MetallicRoughness,u_normalTexture:Fa.Normal,u_occlusionTexture:Fa.Occlusion,u_emissionTexture:Fa.Emission,u_color_mix:[Z.r,Z.g,Z.b,z],u_aoIntensity:V,u_emissive_strength:O,u_occlusionTextureTransform:N||[0,0,0,0]}},Dl=new Float32Array(16),Fl=(d,a=Dl,n=Dl)=>({u_matrix:d,u_instance:a,u_node_matrix:n}),Of={fillExtrusion:d=>({u_matrix:new s.bK(d),u_lightpos:new s.bM(d),u_lightintensity:new s.bN(d),u_lightcolor:new s.bM(d),u_vertical_gradient:new s.bN(d),u_opacity:new s.bN(d),u_edge_radius:new s.bN(d),u_ao:new s.bL(d),u_tile_id:new s.bM(d),u_zoom_transition:new s.bN(d),u_inv_rot_matrix:new s.bK(d),u_merc_center:new s.bL(d),u_up_dir:new s.bM(d),u_height_lift:new s.bN(d),u_flood_light_color:new s.bM(d),u_vertical_scale:new s.bN(d),u_flood_light_intensity:new s.bN(d),u_ground_shadow_factor:new s.bM(d),u_emissive_strength:new s.bN(d)}),fillExtrusionDepth:d=>({u_matrix:new s.bK(d),u_edge_radius:new s.bN(d),u_vertical_scale:new s.bN(d)}),fillExtrusionPattern:d=>({u_matrix:new s.bK(d),u_lightpos:new s.bM(d),u_lightintensity:new s.bN(d),u_lightcolor:new s.bM(d),u_vertical_gradient:new s.bN(d),u_height_factor:new s.bN(d),u_edge_radius:new s.bN(d),u_ao:new s.bL(d),u_tile_id:new s.bM(d),u_zoom_transition:new s.bN(d),u_inv_rot_matrix:new s.bK(d),u_merc_center:new s.bL(d),u_up_dir:new s.bM(d),u_height_lift:new s.bN(d),u_image:new s.bO(d),u_texsize:new s.bL(d),u_pixel_coord_upper:new s.bL(d),u_pixel_coord_lower:new s.bL(d),u_tile_units_to_pixels:new s.bN(d),u_opacity:new s.bN(d)}),fillExtrusionGroundEffect:d=>({u_matrix:new s.bK(d),u_opacity:new s.bN(d),u_ao_pass:new s.bN(d),u_meter_to_tile:new s.bN(d),u_ao:new s.bL(d),u_flood_light_intensity:new s.bN(d),u_flood_light_color:new s.bM(d),u_attenuation:new s.bN(d),u_edge_radius:new s.bN(d),u_fb:new s.bO(d),u_fb_size:new s.bN(d)}),fill:d=>({u_matrix:new s.bK(d),u_emissive_strength:new s.bN(d)}),fillPattern:d=>({u_matrix:new s.bK(d),u_emissive_strength:new s.bN(d),u_image:new s.bO(d),u_texsize:new s.bL(d),u_pixel_coord_upper:new s.bL(d),u_pixel_coord_lower:new s.bL(d),u_tile_units_to_pixels:new s.bN(d)}),fillOutline:d=>({u_matrix:new s.bK(d),u_emissive_strength:new s.bN(d),u_world:new s.bL(d)}),fillOutlinePattern:d=>({u_matrix:new s.bK(d),u_emissive_strength:new s.bN(d),u_world:new s.bL(d),u_image:new s.bO(d),u_texsize:new s.bL(d),u_pixel_coord_upper:new s.bL(d),u_pixel_coord_lower:new s.bL(d),u_tile_units_to_pixels:new s.bN(d)}),circle:s.cs,collisionBox:d=>({u_matrix:new s.bK(d),u_camera_to_center_distance:new s.bN(d),u_extrude_scale:new s.bL(d)}),collisionCircle:d=>({u_matrix:new s.bK(d),u_inv_matrix:new s.bK(d),u_camera_to_center_distance:new s.bN(d),u_viewport_size:new s.bL(d)}),debug:d=>({u_color:new s.ca(d),u_matrix:new s.bK(d),u_overlay:new s.bO(d),u_overlay_scale:new s.bN(d)}),clippingMask:d=>({u_matrix:new s.bK(d)}),heatmap:d=>({u_extrude_scale:new s.bN(d),u_intensity:new s.bN(d),u_matrix:new s.bK(d),u_inv_rot_matrix:new s.bK(d),u_merc_center:new s.bL(d),u_tile_id:new s.bM(d),u_zoom_transition:new s.bN(d),u_up_dir:new s.bM(d)}),heatmapTexture:d=>({u_image:new s.bO(d),u_color_ramp:new s.bO(d),u_opacity:new s.bN(d)}),hillshade:d=>({u_matrix:new s.bK(d),u_image:new s.bO(d),u_latrange:new s.bL(d),u_light:new s.bL(d),u_shadow:new s.ca(d),u_highlight:new s.ca(d),u_emissive_strength:new s.bN(d),u_accent:new s.ca(d)}),hillshadePrepare:d=>({u_matrix:new s.bK(d),u_image:new s.bO(d),u_dimension:new s.bL(d),u_zoom:new s.bN(d)}),line:s.ct,linePattern:s.cu,raster:d=>({u_matrix:new s.bK(d),u_normalize_matrix:new s.bK(d),u_globe_matrix:new s.bK(d),u_merc_matrix:new s.bK(d),u_grid_matrix:new s.cb(d),u_tl_parent:new s.bL(d),u_scale_parent:new s.bN(d),u_fade_t:new s.bN(d),u_opacity:new s.bN(d),u_image0:new s.bO(d),u_image1:new s.bO(d),u_brightness_low:new s.bN(d),u_brightness_high:new s.bN(d),u_saturation_factor:new s.bN(d),u_contrast_factor:new s.bN(d),u_spin_weights:new s.bM(d),u_perspective_transform:new s.bL(d),u_raster_elevation:new s.bN(d),u_zoom_transition:new s.bN(d),u_merc_center:new s.bL(d),u_cutoff_params:new s.bP(d),u_colorization_mix:new s.bP(d),u_colorization_offset:new s.bN(d),u_color_ramp:new s.bO(d),u_texture_offset:new s.bL(d),u_texture_res:new s.bL(d),u_emissive_strength:new s.bN(d)}),rasterParticle:d=>({u_matrix:new s.bK(d),u_normalize_matrix:new s.bK(d),u_globe_matrix:new s.bK(d),u_merc_matrix:new s.bK(d),u_grid_matrix:new s.cb(d),u_tl_parent:new s.bL(d),u_scale_parent:new s.bN(d),u_fade_t:new s.bN(d),u_opacity:new s.bN(d),u_image0:new s.bO(d),u_image1:new s.bO(d),u_raster_elevation:new s.bN(d),u_zoom_transition:new s.bN(d),u_merc_center:new s.bL(d),u_cutoff_params:new s.bP(d)}),rasterParticleTexture:d=>({u_texture:new s.bO(d),u_opacity:new s.bN(d)}),rasterParticleDraw:d=>({u_tile_offset:new s.bL(d),u_velocity:new s.bO(d),u_color_ramp:new s.bO(d),u_velocity_res:new s.bL(d),u_max_speed:new s.bN(d),u_texture_offset:new s.bL(d),u_data_scale:new s.bP(d),u_data_offset:new s.bN(d)}),rasterParticleUpdate:d=>({u_velocity:new s.bO(d),u_velocity_res:new s.bL(d),u_max_speed:new s.bN(d),u_speed_factor:new s.bN(d),u_lifetime_delta:new s.bN(d),u_rand_seed:new s.bN(d),u_texture_offset:new s.bL(d),u_data_scale:new s.bP(d),u_data_offset:new s.bN(d)}),symbolIcon:d=>({u_is_size_zoom_constant:new s.bO(d),u_is_size_feature_constant:new s.bO(d),u_size_t:new s.bN(d),u_size:new s.bN(d),u_camera_to_center_distance:new s.bN(d),u_rotate_symbol:new s.bO(d),u_aspect_ratio:new s.bN(d),u_fade_change:new s.bN(d),u_matrix:new s.bK(d),u_label_plane_matrix:new s.bK(d),u_coord_matrix:new s.bK(d),u_is_text:new s.bO(d),u_pitch_with_map:new s.bO(d),u_texsize:new s.bL(d),u_tile_id:new s.bM(d),u_zoom_transition:new s.bN(d),u_inv_rot_matrix:new s.bK(d),u_merc_center:new s.bL(d),u_camera_forward:new s.bM(d),u_tile_matrix:new s.bK(d),u_up_vector:new s.bM(d),u_ecef_origin:new s.bM(d),u_texture:new s.bO(d),u_icon_transition:new s.bN(d),u_icon_saturation:new s.bN(d)}),symbolSDF:d=>({u_is_size_zoom_constant:new s.bO(d),u_is_size_feature_constant:new s.bO(d),u_size_t:new s.bN(d),u_size:new s.bN(d),u_camera_to_center_distance:new s.bN(d),u_rotate_symbol:new s.bO(d),u_aspect_ratio:new s.bN(d),u_fade_change:new s.bN(d),u_matrix:new s.bK(d),u_label_plane_matrix:new s.bK(d),u_coord_matrix:new s.bK(d),u_is_text:new s.bO(d),u_pitch_with_map:new s.bO(d),u_texsize:new s.bL(d),u_texture:new s.bO(d),u_gamma_scale:new s.bN(d),u_device_pixel_ratio:new s.bN(d),u_tile_id:new s.bM(d),u_zoom_transition:new s.bN(d),u_inv_rot_matrix:new s.bK(d),u_merc_center:new s.bL(d),u_camera_forward:new s.bM(d),u_tile_matrix:new s.bK(d),u_up_vector:new s.bM(d),u_ecef_origin:new s.bM(d),u_is_halo:new s.bO(d)}),symbolTextAndIcon:d=>({u_is_size_zoom_constant:new s.bO(d),u_is_size_feature_constant:new s.bO(d),u_size_t:new s.bN(d),u_size:new s.bN(d),u_camera_to_center_distance:new s.bN(d),u_rotate_symbol:new s.bO(d),u_aspect_ratio:new s.bN(d),u_fade_change:new s.bN(d),u_matrix:new s.bK(d),u_label_plane_matrix:new s.bK(d),u_coord_matrix:new s.bK(d),u_is_text:new s.bO(d),u_pitch_with_map:new s.bO(d),u_texsize:new s.bL(d),u_texsize_icon:new s.bL(d),u_texture:new s.bO(d),u_texture_icon:new s.bO(d),u_gamma_scale:new s.bN(d),u_device_pixel_ratio:new s.bN(d),u_is_halo:new s.bO(d)}),background:d=>({u_matrix:new s.bK(d),u_emissive_strength:new s.bN(d),u_opacity:new s.bN(d),u_color:new s.ca(d)}),backgroundPattern:d=>({u_matrix:new s.bK(d),u_emissive_strength:new s.bN(d),u_opacity:new s.bN(d),u_image:new s.bO(d),u_pattern_tl:new s.bL(d),u_pattern_br:new s.bL(d),u_texsize:new s.bL(d),u_pattern_size:new s.bL(d),u_pixel_coord_upper:new s.bL(d),u_pixel_coord_lower:new s.bL(d),u_tile_units_to_pixels:new s.bN(d)}),terrainRaster:lc,terrainDepth:lc,skybox:d=>({u_matrix:new s.bK(d),u_sun_direction:new s.bM(d),u_cubemap:new s.bO(d),u_opacity:new s.bN(d),u_temporal_offset:new s.bN(d)}),skyboxGradient:d=>({u_matrix:new s.bK(d),u_color_ramp:new s.bO(d),u_center_direction:new s.bM(d),u_radius:new s.bN(d),u_opacity:new s.bN(d),u_temporal_offset:new s.bN(d)}),skyboxCapture:d=>({u_matrix_3f:new s.cb(d),u_sun_direction:new s.bM(d),u_sun_intensity:new s.bN(d),u_color_tint_r:new s.bP(d),u_color_tint_m:new s.bP(d),u_luminance:new s.bN(d)}),globeRaster:d=>({u_proj_matrix:new s.bK(d),u_globe_matrix:new s.bK(d),u_normalize_matrix:new s.bK(d),u_merc_matrix:new s.bK(d),u_zoom_transition:new s.bN(d),u_merc_center:new s.bL(d),u_image0:new s.bO(d),u_grid_matrix:new s.cb(d),u_skirt_height:new s.bN(d),u_far_z_cutoff:new s.bN(d),u_frustum_tl:new s.bM(d),u_frustum_tr:new s.bM(d),u_frustum_br:new s.bM(d),u_frustum_bl:new s.bM(d),u_globe_pos:new s.bM(d),u_globe_radius:new s.bN(d),u_viewport:new s.bL(d)}),globeAtmosphere:d=>({u_frustum_tl:new s.bM(d),u_frustum_tr:new s.bM(d),u_frustum_br:new s.bM(d),u_frustum_bl:new s.bM(d),u_horizon:new s.bN(d),u_transition:new s.bN(d),u_fadeout_range:new s.bN(d),u_color:new s.bP(d),u_high_color:new s.bP(d),u_space_color:new s.bP(d),u_temporal_offset:new s.bN(d),u_horizon_angle:new s.bN(d)}),model:d=>({u_matrix:new s.bK(d),u_lighting_matrix:new s.bK(d),u_normal_matrix:new s.bK(d),u_lightpos:new s.bM(d),u_lightintensity:new s.bN(d),u_lightcolor:new s.bM(d),u_camera_pos:new s.bM(d),u_opacity:new s.bN(d),u_baseColorFactor:new s.bP(d),u_emissiveFactor:new s.bP(d),u_metallicFactor:new s.bN(d),u_roughnessFactor:new s.bN(d),u_baseTextureIsAlpha:new s.bO(d),u_alphaMask:new s.bO(d),u_alphaCutoff:new s.bN(d),u_baseColorTexture:new s.bO(d),u_metallicRoughnessTexture:new s.bO(d),u_normalTexture:new s.bO(d),u_occlusionTexture:new s.bO(d),u_emissionTexture:new s.bO(d),u_color_mix:new s.bP(d),u_aoIntensity:new s.bN(d),u_emissive_strength:new s.bN(d),u_occlusionTextureTransform:new s.bP(d)}),modelDepth:d=>({u_matrix:new s.bK(d),u_instance:new s.bK(d),u_node_matrix:new s.bK(d)}),groundShadow:d=>({u_matrix:new s.bK(d),u_ground_shadow_factor:new s.bM(d)}),stars:d=>({u_matrix:new s.bK(d),u_up:new s.bM(d),u_right:new s.bM(d),u_intensity_multiplier:new s.bN(d)})};let Bo;function Uo(d,a,n,_,c,f,g){const b=d.context,v=b.gl,A=d.transform,O=d.getOrCreateProgram("collisionBox"),R=[];let P=0,N=0;for(let V=0;V<_.length;V++){const Z=_[V],z=a.getTile(Z),X=z.getBucket(n);if(!X)continue;const ie=Jd(Z,X,A);let ne=ie;c[0]===0&&c[1]===0||(ne=d.translatePosMatrix(ie,z,c,f));const re=g?X.textCollisionBox:X.iconCollisionBox,ye=X.collisionCircleArray;if(ye.length>0){const ue=s.a6.create(),Ie=ne;s.a6.mul(ue,X.placementInvProjMatrix,A.glCoordMatrix),s.a6.mul(ue,ue,X.placementViewportMatrix),R.push({circleArray:ye,circleOffset:N,transform:Ie,invTransform:ue,projection:X.getProjection()}),P+=ye.length/4,N=P}re&&(d.terrain&&d.terrain.setupElevationDraw(z,O),O.draw(d,v.LINES,wt.disabled,Bt.disabled,d.colorModeForRenderPass(),Pt.disabled,Ur(ne,A,z,X.getProjection()),n.id,re.layoutVertexBuffer,re.indexBuffer,re.segments,null,A.zoom,null,[re.collisionVertexBuffer,re.collisionVertexBufferExt]))}if(!g||!R.length)return;const U=d.getOrCreateProgram("collisionCircle"),B=new s.cv;B.resize(4*P),B._trim();let k=0;for(const V of R)for(let Z=0;Z<V.circleArray.length/4;Z++){const z=4*Z,X=V.circleArray[z+0],ie=V.circleArray[z+1],ne=V.circleArray[z+2],re=V.circleArray[z+3];B.emplace(k++,X,ie,ne,re,0),B.emplace(k++,X,ie,ne,re,1),B.emplace(k++,X,ie,ne,re,2),B.emplace(k++,X,ie,ne,re,3)}(!Bo||Bo.length<2*P)&&(Bo=function(V){const Z=2*V,z=new s.aw;z.resize(Z),z._trim();for(let X=0;X<Z;X++){const ie=6*X;z.uint16[ie+0]=4*X+0,z.uint16[ie+1]=4*X+1,z.uint16[ie+2]=4*X+2,z.uint16[ie+3]=4*X+2,z.uint16[ie+4]=4*X+3,z.uint16[ie+5]=4*X+0}return z}(P));const M=b.createIndexBuffer(Bo,!0),H=b.createVertexBuffer(B,s.cw.members,!0);for(const V of R){const Z={u_matrix:V.transform,u_inv_matrix:V.invTransform,u_camera_to_center_distance:($=A).getCameraToCenterDistance(V.projection),u_viewport_size:[$.width,$.height]};U.draw(d,v.TRIANGLES,wt.disabled,Bt.disabled,d.colorModeForRenderPass(),Pt.disabled,Z,n.id,H,M,s.aB.simpleSegment(0,2*V.circleOffset,V.circleArray.length,V.circleArray.length/2),null,A.zoom)}var $;H.destroy(),M.destroy()}const ln=s.a6.create();function Bl(d){const a=d._camera.getWorldToCamera(d.worldSize,1),n=s.a6.multiply([],a,d.globeMatrix);s.a6.invert(n,n);const _=[0,0,0],c=[0,1,0,0];return s.a7.transformMat4(c,c,n),_[0]=c[0],_[1]=c[1],_[2]=c[2],s.N.normalize(_,_),_}function mt({width:d,height:a,anchor:n,textOffset:_,textScale:c},f){const{horizontalAlign:g,verticalAlign:b}=s.bf(n),v=-(g-.5)*d,A=-(b-.5)*a,O=s.bd(n,_);return new s.P((v/c+O[0])*f,(A/c+O[1])*f)}function gc(d,a,n,_,c,f,g,b,v,A,O){const R=d.text.placedSymbolArray,P=d.text.dynamicLayoutVertexArray,N=d.icon.dynamicLayoutVertexArray,U={},B=d.getProjection(),k=Al(b,B,f),M=f.elevation,H=B.upVectorScale(b.canonical,f.center.lat,f.worldSize).metersToTile;P.clear();for(let $=0;$<R.length;$++){const V=R.get($),{tileAnchorX:Z,tileAnchorY:z,numGlyphs:X}=V,ie=V.hidden||!V.crossTileID||d.allowVerticalPlacement&&!V.placedOrientation?null:_[V.crossTileID];if(ie){let ne=0,re=0,ye=0;if(M){const ke=M?M.getAtTileOffset(b,Z,z):0,[$e,je,it]=B.upVector(b.canonical,Z,z);ne=ke*$e*H,re=ke*je*H,ye=ke*it*H}let[ue,Ie,Ee,Ue]=Ao(V.projectedAnchorX+ne,V.projectedAnchorY+re,V.projectedAnchorZ+ye,n?k:g);const ce=Zu(f.getCameraToCenterDistance(B),Ue);let Te=c.evaluateSizeForFeature(d.textSizeData,A,V)*ce/s.bc;n&&(Te*=d.tilePixelRatio/v);const le=mt(ie,Te);n?({x:ue,y:Ie,z:Ee}=B.projectTilePoint(Z+le.x,z+le.y,b.canonical),[ue,Ie,Ee]=Ao(ue+ne,Ie+re,Ee+ye,g)):(a&&le._rotate(-f.angle),ue+=le.x,Ie+=le.y,Ee=0);const pe=d.allowVerticalPlacement&&V.placedOrientation===s.b6.vertical?Math.PI/2:0;for(let ke=0;ke<X;ke++)s.b9(P,ue,Ie,Ee,pe);O&&V.associatedIconIndex>=0&&(U[V.associatedIconIndex]={x:ue,y:Ie,z:Ee,angle:pe})}else Pn(X,P)}if(O){N.clear();const $=d.icon.placedSymbolArray;for(let V=0;V<$.length;V++){const Z=$.get(V),{numGlyphs:z}=Z,X=U[V];if(Z.hidden||!X)Pn(z,N);else{const{x:ie,y:ne,z:re,angle:ye}=X;for(let ue=0;ue<z;ue++)s.b9(N,ie,ne,re,ye)}}d.icon.dynamicLayoutVertexBuffer.updateData(N)}d.text.dynamicLayoutVertexBuffer.updateData(P)}function Gr(d,a,n,_,c,f,g={}){const b=n.paint.get("icon-translate"),v=n.paint.get("text-translate"),A=n.paint.get("icon-translate-anchor"),O=n.paint.get("text-translate-anchor"),R=n.layout.get("icon-rotation-alignment"),P=n.layout.get("text-rotation-alignment"),N=n.layout.get("icon-pitch-alignment"),U=n.layout.get("text-pitch-alignment"),B=n.layout.get("icon-keep-upright"),k=n.layout.get("text-keep-upright"),M=n.paint.get("icon-color-saturation"),H=d.context,$=H.gl,V=d.transform,Z=R==="map",z=P==="map",X=N==="map",ie=U==="map",ne=n.layout.get("symbol-sort-key").constantOr(1)!==void 0;let re=!1;const ye=d.depthModeForSublayer(0,wt.ReadOnly),ue=[s.a5(V.center.lng),s.ae(V.center.lat)],Ie=n.layout.get("text-variable-anchor"),Ee=V.projection.name==="globe",Ue=[],ce=[0,-1,0];for(const Te of _){const le=a.getTile(Te),pe=le.getBucket(n);if(!pe||pe.projection.name==="mercator"&&Ee||pe.fullyClipped)continue;const ke=pe.projection.name==="globe",$e=ke?s.S(V.zoom):0,je=Al(Te,pe.getProjection(),V),it=V.calculatePixelsToTileUnitsMatrix(le),ht=Ie&&pe.hasTextData(),St=pe.hasIconTextFit()&&ht&&pe.hasIconData(),xt=pe.getProjection().createInversionMatrix(V,Te.canonical),At=()=>{const Zi=Z&&n.layout.get("symbol-placement")!=="point",ti=[],fi=Zi||St,ii=n.paint.get("icon-image-cross-fade").constantOr(0);d.terrainRenderModeElevated()&&X&&ti.push("PITCH_WITH_MAP_TERRAIN"),ke&&(ti.push("PROJECTION_GLOBE_VIEW"),fi&&ti.push("PROJECTED_POS_ON_VIEWPORT")),ii>0&&ti.push("ICON_TRANSITION"),pe.icon.zOffsetVertexBuffer&&ti.push("Z_OFFSET"),M<1&&ti.push("SATURATION");const mi=pe.icon.programConfigurations.get(n.id),Ui=d.getOrCreateProgram(pe.sdfIcons?"symbolSDF":"symbolIcon",{config:mi,defines:ti});let bi;const Oa=le.imageAtlasTexture?le.imageAtlasTexture.size:[0,0],Ba=pe.iconSizeData,no=s.b5(Ba,V.zoom),Zo=X||V.pitch!==0,so=vl(je,le.tileID.canonical,X,Z,V,pe.getProjection(),it),Sa=Vd(je,le.tileID.canonical,X,Z,V,pe.getProjection(),it),ya=d.translatePosMatrix(Sa,le,b,A,!0),ja=d.translatePosMatrix(je,le,b,A),Za=fi?ln:so,lo=Z&&!X&&!Zi;let Xo=ce;!Ee&&!V.mercatorFromTransition||Z||(Xo=Bl(V));const Gn=ke?Xo:ce;bi=pe.sdfIcons&&!pe.iconsInText?Wl(Ba.kind,no,lo,X,d,ja,Za,ya,!1,Oa,!0,Te,$e,ue,xt,Gn,pe.getProjection()):zr(Ba.kind,no,lo,X,d,ja,Za,ya,!1,Oa,Te,$e,ue,xt,Gn,pe.getProjection(),M,ii);const ps=le.imageAtlasTexture?le.imageAtlasTexture:null,ar=n.layout.get("icon-size").constantOr(0)!==1||pe.iconsNeedLinear,or=pe.sdfIcons||d.options.rotating||d.options.zooming||ar||Zo?$.LINEAR:$.NEAREST,lu=pe.sdfIcons&&n.paint.get("icon-halo-width").constantOr(1)!==0,nr=d.terrain&&X&&Zi?s.a6.invert(s.a6.create(),so):ln;if(Zi&&pe.icon){const Xs=V.elevation,ed=Xs?Xs.getAtTileOffsetFunc(Te,V.center.lat,V.worldSize,pe.getProjection()):null,un=Gd(je,le.tileID.canonical,X,Z,V,pe.getProjection(),it);Kd(pe,je,d,!1,un,Sa,X,B,ed,Te)}return{program:Ui,buffers:pe.icon,uniformValues:bi,atlasTexture:ps,atlasTextureIcon:null,atlasInterpolation:or,atlasInterpolationIcon:null,isSDF:pe.sdfIcons,hasHalo:lu,tile:le,labelPlaneMatrixInv:nr}},jt=()=>{const Zi=z&&n.layout.get("symbol-placement")!=="point",ti=[],fi=Zi||Ie||St;d.terrainRenderModeElevated()&&ie&&ti.push("PITCH_WITH_MAP_TERRAIN"),ke&&(ti.push("PROJECTION_GLOBE_VIEW"),fi&&ti.push("PROJECTED_POS_ON_VIEWPORT")),pe.text.zOffsetVertexBuffer&&ti.push("Z_OFFSET");const ii=pe.text.programConfigurations.get(n.id),mi=d.getOrCreateProgram(pe.iconsInText?"symbolTextAndIcon":"symbolSDF",{config:ii,defines:ti});let Ui,bi=[0,0],Oa=null;const Ba=pe.textSizeData;pe.iconsInText&&(bi=le.imageAtlasTexture?le.imageAtlasTexture.size:[0,0],Oa=le.imageAtlasTexture?le.imageAtlasTexture:null,Ui=ie||V.pitch!==0||d.options.rotating||d.options.zooming||Ba.kind==="composite"||Ba.kind==="camera"?$.LINEAR:$.NEAREST);const no=le.glyphAtlasTexture?le.glyphAtlasTexture.size:[0,0],Zo=s.b5(Ba,V.zoom),so=vl(je,le.tileID.canonical,ie,z,V,pe.getProjection(),it),Sa=Vd(je,le.tileID.canonical,ie,z,V,pe.getProjection(),it),ya=d.translatePosMatrix(Sa,le,v,O,!0),ja=d.translatePosMatrix(je,le,v,O),Za=fi?ln:so,lo=z&&!ie&&!Zi;let Xo=ce;!Ee&&!V.mercatorFromTransition||z||(Xo=Bl(V));const Gn=ke?Xo:ce;let ps;ps=pe.iconsInText?Hr(Ba.kind,Zo,lo,ie,d,ja,Za,ya,no,bi,Te,$e,ue,xt,Gn,pe.getProjection()):Wl(Ba.kind,Zo,lo,ie,d,ja,Za,ya,!0,no,!0,Te,$e,ue,xt,Gn,pe.getProjection());const ar=le.glyphAtlasTexture?le.glyphAtlasTexture:null,or=$.LINEAR,lu=n.paint.get("text-halo-width").constantOr(1)!==0,nr=d.terrain&&ie&&Zi?s.a6.invert(s.a6.create(),so):ln;if(Zi&&pe.text){const Xs=V.elevation,ed=Xs?Xs.getAtTileOffsetFunc(Te,V.center.lat,V.worldSize,pe.getProjection()):null,un=Gd(je,le.tileID.canonical,ie,z,V,pe.getProjection(),it);Kd(pe,je,d,!0,un,Sa,ie,k,ed,Te)}return{program:mi,buffers:pe.text,uniformValues:ps,atlasTexture:ar,atlasTextureIcon:Oa,atlasInterpolation:or,atlasInterpolationIcon:Ui,isSDF:!0,hasHalo:lu,tile:le,labelPlaneMatrixInv:nr}},Ft=pe.icon.segments.get().length,zt=pe.text.segments.get().length,kt=Ft&&!g.onlyText?At():null,di=zt&&!g.onlyIcons?jt():null,Wi=n.paint.get("icon-opacity").constantOr(1),ei=n.paint.get("text-opacity").constantOr(1);if(ne&&pe.canOverlap){re=!0;const Zi=Wi&&!g.onlyText?pe.icon.segments.get():[],ti=ei&&!g.onlyIcons?pe.text.segments.get():[];for(const fi of Zi)Ue.push({segments:new s.aB([fi]),sortKey:fi.sortKey,state:kt});for(const fi of ti)Ue.push({segments:new s.aB([fi]),sortKey:fi.sortKey,state:di})}else g.onlyText||Ue.push({segments:Wi?pe.icon.segments:new s.aB([]),sortKey:0,state:kt}),g.onlyIcons||Ue.push({segments:ei?pe.text.segments:new s.aB([]),sortKey:0,state:di})}re&&Ue.sort((Te,le)=>Te.sortKey-le.sortKey);for(const Te of Ue){const le=Te.state;if(le)if(d.terrain&&d.terrain.setupElevationDraw(le.tile,le.program,{useDepthForOcclusion:V.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:le.labelPlaneMatrixInv}),H.activeTexture.set($.TEXTURE0),le.atlasTexture&&le.atlasTexture.bind(le.atlasInterpolation,$.CLAMP_TO_EDGE,!0),le.atlasTextureIcon&&(H.activeTexture.set($.TEXTURE1),le.atlasTextureIcon&&le.atlasTextureIcon.bind(le.atlasInterpolationIcon,$.CLAMP_TO_EDGE,!0)),d.uploadCommonLightUniforms(d.context,le.program),le.hasHalo){const pe=le.uniformValues;pe.u_is_halo=1,Dn(le.buffers,Te.segments,n,d,le.program,ye,c,f,pe,2),pe.u_is_halo=0}else{if(le.isSDF){const pe=le.uniformValues;le.hasHalo&&(pe.u_is_halo=1,Dn(le.buffers,Te.segments,n,d,le.program,ye,c,f,pe,1)),pe.u_is_halo=0}Dn(le.buffers,Te.segments,n,d,le.program,ye,c,f,le.uniformValues,1)}}}function Dn(d,a,n,_,c,f,g,b,v,A){const O=[d.dynamicLayoutVertexBuffer,d.opacityVertexBuffer,d.iconTransitioningVertexBuffer,d.globeExtVertexBuffer,d.zOffsetVertexBuffer];c.draw(_,_.context.gl.TRIANGLES,f,g,b,Pt.disabled,v,n.id,d.layoutVertexBuffer,d.indexBuffer,a,n.paint,_.transform.zoom,d.programConfigurations.get(n.id),O,A)}function us(d,a,n,_,c,f,g){const b=d.context.gl,v=n.paint.get("fill-pattern"),A=v&&v.constantOr(1);let O,R,P,N,U;g?(R=A&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",O=b.LINES):(R=A?"fillPattern":"fill",O=b.TRIANGLES);for(const B of _){const k=a.getTile(B);if(A&&!k.patternsLoaded())continue;const M=k.getBucket(n);if(!M)continue;d.prepareDrawTile();const H=M.programConfigurations.get(n.id),$=d.isTileAffectedByFog(B),V=d.getOrCreateProgram(R,{config:H,overrideFog:$});A&&(d.context.activeTexture.set(b.TEXTURE0),k.imageAtlasTexture&&k.imageAtlasTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),H.updatePaintBuffers());const Z=v.constantOr(null);if(Z&&k.imageAtlas){const ie=k.imageAtlas.patternPositions[Z.toString()];ie&&H.setConstantPatternPositions(ie)}const z=d.translatePosMatrix(B.projMatrix,k,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor")),X=n.paint.get("fill-emissive-strength");if(g){N=M.indexBuffer2,U=M.segments2;const ie=d.terrain&&d.terrain.renderingToTexture?d.terrain.drapeBufferSize:[b.drawingBufferWidth,b.drawingBufferHeight];P=R==="fillOutlinePattern"&&A?cc(z,X,d,k,ie):_s(z,X,ie)}else N=M.indexBuffer,U=M.segments,P=A?S_(z,X,d,k):js(z,X);d.uploadCommonUniforms(d.context,V,B.toUnwrapped()),V.draw(d,O,c,d.stencilModeForClipping(B),f,Pt.disabled,P,n.id,M.layoutVertexBuffer,N,U,n.paint,d.transform.zoom,H,void 0)}}function yt(d,a,n,_,c,f,g,b){n.resetLayerRenderingStats(d);const v=d.context,A=v.gl,O=d.transform,R=n.paint.get("fill-extrusion-pattern"),P=R.constantOr(1),N=n.paint.get("fill-extrusion-opacity"),U=d.style.enable3dLights(),B=n.paint.get(U&&!P?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),k=[n.paint.get("fill-extrusion-ambient-occlusion-intensity"),B],M=n.layout.get("fill-extrusion-edge-radius"),H=M>0&&!n.paint.get("fill-extrusion-rounded-roof"),$=H?0:M,V=O.projection.name==="globe"?s.cF():0,Z=O.projection.name==="globe",z=Z?s.S(O.zoom):0,X=[s.a5(O.center.lng),s.ae(O.center.lat)],ie=n.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),ne=n.paint.get("fill-extrusion-flood-light-intensity"),re=n.paint.get("fill-extrusion-vertical-scale"),ye=Nn(d,n.paint.get("fill-extrusion-cutoff-fade-range")),ue=n.paint.get("fill-extrusion-emissive-strength"),Ie=[];let Ee;Z&&Ie.push("PROJECTION_GLOBE_VIEW"),k[0]>0&&Ie.push("FAUX_AO"),H&&Ie.push("ZERO_ROOF_RADIUS"),b&&Ie.push("HAS_CENTROID"),ne>0&&Ie.push("FLOOD_LIGHT"),ye.shouldRenderCutoff&&Ie.push("RENDER_CUTOFF");const Ue=d.renderPass==="shadow",ce=d.shadowRenderer,Te=Ue&&!!ce;d.shadowRenderer&&(d.shadowRenderer.useNormalOffset=!0);let le=[0,0,0];if(ce){const $e=d.style.directionalLight,je=d.style.ambientLight;$e&&je&&(le=wl($e,je)),Ee=Ie.concat(["SHADOWS_SINGLE_CASCADE"])}const pe=Te?"fillExtrusionDepth":P?"fillExtrusionPattern":"fillExtrusion",ke=n.getLayerRenderingStats();for(const $e of _){const je=a.getTile($e),it=je.getBucket(n);if(!it||it.projection.name!==O.projection.name)continue;let ht=!1;ce&&(ht=ce.getMaxCascadeForTile($e.toUnwrapped())===0);const St=d.isTileAffectedByFog($e),xt=it.programConfigurations.get(n.id),At=d.getOrCreateProgram(pe,{config:xt,defines:ht?Ee:Ie,overrideFog:St});if(d.terrain&&d.terrain.setupElevationDraw(je,At,{useMeterToDem:!0}),!it.centroidVertexBuffer){const Wi=At.attributes.a_centroid_pos;Wi!==void 0&&A.vertexAttrib2f(Wi,0,0)}!Ue&&ce&&ce.setupShadows(je.tileID.toUnwrapped(),At,"vector-tile",je.tileID.overscaledZ),P&&(d.context.activeTexture.set(A.TEXTURE0),je.imageAtlasTexture&&je.imageAtlasTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),xt.updatePaintBuffers());const jt=R.constantOr(null);if(jt&&je.imageAtlas){const Wi=je.imageAtlas.patternPositions[jt.toString()];Wi&&xt.setConstantPatternPositions(Wi)}const Ft=n.paint.get("fill-extrusion-vertical-gradient");let zt;if(Ue&&ce){if(bc(je.tileID,it,d))continue;const Wi=ce.calculateShadowPassMatrixFromTile(je.tileID.toUnwrapped());zt=O_(Wi,$,re)}else{const Wi=d.translatePosMatrix($e.expandedProjMatrix,je,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),ei=O.projection.createInversionMatrix(O,$e.canonical);zt=P?ds(Wi,d,Ft,N,k,$,$e,je,V,z,X,ei,ie,re):I_(Wi,d,Ft,N,k,$,$e,V,z,X,ei,ie,re,ne,le,ue)}d.uploadCommonUniforms(v,At,$e.toUnwrapped(),null,ye);let kt=it.segments;if(O.projection.name==="mercator"&&!Ue&&(kt=it.getVisibleSegments(je.tileID,d.terrain,d.transform.getFrustum(0)),!kt.get().length))continue;if(ke)if(Ue)for(const Wi of kt.get())ke.numRenderedVerticesInShadowPass+=Wi.primitiveLength;else for(const Wi of kt.get())ke.numRenderedVerticesInTransparentPass+=Wi.primitiveLength;const di=[];(d.terrain||b)&&di.push(it.centroidVertexBuffer),Z&&di.push(it.layoutVertexExtBuffer),At.draw(d,v.gl.TRIANGLES,c,f,g,Pt.backCCW,zt,n.id,it.layoutVertexBuffer,it.indexBuffer,kt,n.paint,d.transform.zoom,xt,di)}d.shadowRenderer&&(d.shadowRenderer.useNormalOffset=!1)}function Fn(d,a,n,_,c,f,g,b,v,A,O,R,P,N,U,B,k,M,H){const $=d.context,V=$.gl,Z=d.transform,z=d.transform.zoom,X=[],ie=Nn(d,n.paint.get("fill-extrusion-cutoff-fade-range"));A==="clear"?(X.push("CLEAR_SUBPASS"),H&&(X.push("CLEAR_FROM_TEXTURE"),$.activeTexture.set(V.TEXTURE0),H.bind(V.LINEAR,V.CLAMP_TO_EDGE))):A==="sdf"&&X.push("SDF_SUBPASS"),k&&X.push("HAS_CENTROID"),ie.shouldRenderCutoff&&X.push("RENDER_CUTOFF");const ne=n.layout.get("fill-extrusion-edge-radius"),re=(ye,ue,Ie,Ee,Ue)=>{const ce=ue.programConfigurations.get(n.id),Te=d.isTileAffectedByFog(ye),le=d.getOrCreateProgram("fillExtrusionGroundEffect",{config:ce,defines:X,overrideFog:Te}),pe=(($e,je,it,ht,St,xt,At,jt,Ft,zt,kt)=>({u_matrix:je,u_opacity:it,u_ao_pass:ht?1:0,u_meter_to_tile:St,u_ao:xt,u_flood_light_intensity:At,u_flood_light_color:jt,u_attenuation:Ft,u_edge_radius:zt,u_fb:0,u_fb_size:kt}))(0,Ee,O,v,Ue,[R,P*Ue],N,U,B,z>=17?0:ne*Ue,H?H.size[0]:0),ke=[];k&&ke.push(ue.hiddenByLandmarkVertexBuffer),d.uploadCommonUniforms($,le,ye.toUnwrapped(),null,ie),le.draw(d,$.gl.TRIANGLES,c,f,g,b,pe,n.id,ue.vertexBuffer,ue.indexBuffer,Ie,n.paint,z,ce,ke)};for(const ye of _){const ue=a.getTile(ye),Ie=ue.getBucket(n);if(!Ie||Ie.projection.name!==Z.projection.name||!Ie.groundEffect||Ie.groundEffect&&!Ie.groundEffect.hasData())continue;const Ee=Ie.groundEffect,Ue=1/Ie.tileToMeter;{const ce=d.translatePosMatrix(ye.projMatrix,ue,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),Te=Ee.getDefaultSegment();re(ye,Ee,Te,ce,Ue)}if(M)for(let ce=0;ce<4;ce++){const Te=s.cG[ce](ye),le=a.getTile(Te);if(!le)continue;const pe=le.getBucket(n);if(!pe||pe.projection.name!==Z.projection.name||!pe.groundEffect||pe.groundEffect&&!pe.groundEffect.hasData())continue;const ke=pe.groundEffect;let $e,je;ce===0?($e=[-s.V,0,0],je=1):ce===1?($e=[s.V,0,0],je=0):ce===2?($e=[0,-s.V,0],je=3):($e=[0,s.V,0],je=2);const it=ke.regionSegments[je];if(!it)continue;const ht=new Float32Array(16);s.a6.translate(ht,ye.projMatrix,$e),re(ye,ke,it,d.translatePosMatrix(ht,ue,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),Ue)}}}function Sf(d,a,n,_,c,f,g){_.centroidVertexArray.length===0&&_.createCentroidsBuffer();const b=f?f.findDEMTileFor(n):null;if(!(b&&b.dem||g))return;const v=M=>new s.P(Math.ceil((M+s.cJ)*s.cK),0),A=M=>{const H=a.getSource().minzoom,$=Z=>{const z=a.getTileByID(Z);if(z&&z.hasData())return z.getBucket(c)},V=[0,-1,1];for(const Z of V){if(M.overscaledZ+Z<H)continue;const z=$(M.calculateScaledKey(M.overscaledZ+Z));if(z)return z}},O=[0,0,0],R=(M,H)=>(O[0]=Math.min(M.min.y,H.min.y),O[1]=Math.max(M.max.y,H.max.y),O[2]=s.V-H.min.x>M.max.x?H.min.x-s.V:M.max.x,O),P=(M,H)=>(O[0]=Math.min(M.min.x,H.min.x),O[1]=Math.max(M.max.x,H.max.x),O[2]=s.V-H.min.y>M.max.y?H.min.y-s.V:M.max.y,O),N=[(M,H)=>R(M,H),(M,H)=>R(H,M),(M,H)=>P(M,H),(M,H)=>P(H,M)],U=(M,H,$,V,Z,z,X)=>{if(!f)return 0;const ie=[[z?$:M,z?M:$,0],[z?$:H,z?H:$,0]],ne=X<0?s.V+X:X,re=[z?ne:(M+H)/2,z?(M+H)/2:ne,0];return $===0&&X<0||$!==0&&X>0?f.getForTilePoints(Z,[re],!0,V):ie.push(re),f.getForTilePoints(n,ie,!0,b),Math.max(ie[0][2],ie[1][2],re[2])/f.exaggeration()};for(let M=0;M<4;M++){const H=_.borderFeatureIndices[M];if(H.length===0)continue;const $=s.cG[M](n),V=A($);if(!(V&&V instanceof s.cH)||_.borderDoneWithNeighborZ[M]===V.canonical.z)continue;V.centroidVertexArray.length===0&&V.createCentroidsBuffer();const Z=f?f.findDEMTileFor($):null;if(!(Z&&Z.dem||g))continue;const z=(M<2?1:5)-M,X=V.borderDoneWithNeighborZ[z]!==_.canonical.z,ie=V.borderFeatureIndices[z];let ne=0;if(_.canonical.z!==V.canonical.z){for(const re of H)_.showCentroid(_.featuresOnBorder[re]);if(X)for(const re of ie)V.showCentroid(V.featuresOnBorder[re]);_.borderDoneWithNeighborZ[M]=V.canonical.z,V.borderDoneWithNeighborZ[z]=_.canonical.z}for(const re of H){const ye=_.featuresOnBorder[re],ue=_.centroidData[ye.centroidDataIndex],Ie=ye.borders[M];let Ee;for(;ne<ie.length;){Ee=V.featuresOnBorder[ie[ne]];const Ue=Ee.borders[z];if(Ue[1]>Ie[0]+3||Ue[0]>Ie[0]-3)break;V.showCentroid(Ee),ne++}if(Ee&&ne<ie.length){const Ue=ne;let ce=0;for(;!(Ee.borders[z][0]>Ie[1]-3)&&(ce++,++ne!==ie.length);)Ee=V.featuresOnBorder[ie[ne]];if(Ee=V.featuresOnBorder[ie[Ue]],ce>1){const pe=Ee.borders[z];Math.abs(Ie[0]-pe[0])<3&&Math.abs(Ie[1]-pe[1])<3&&(ce=1,ne=Ue+1)}else if(ce===0){_.showCentroid(ye);continue}const Te=V.centroidData[Ee.centroidDataIndex];g&&ce===1&&(((B=ue).flags|(k=Te).flags)&s.cI?(B.flags|=s.cI,k.flags|=s.cI):(B.flags&=~s.cI,k.flags&=~s.cI));const le=ye.intersectsCount()>1||Ee.intersectsCount()>1;if(ce>1)ne=Ue,ue.centroidXY=Te.centroidXY=new s.P(0,0);else if(Z&&Z.dem&&!le){const pe=N[M](ue,Te),ke=M%2?s.V-1:0,$e=U(pe[0],Math.min(s.V-1,pe[1]),ke,Z,$,M<2,pe[2]);ue.centroidXY=Te.centroidXY=v($e)}else le?ue.centroidXY=Te.centroidXY=new s.P(0,0):(ue.centroidXY=_.encodeBorderCentroid(ye),Te.centroidXY=V.encodeBorderCentroid(Ee));_.writeCentroidToBuffer(ue),V.writeCentroidToBuffer(Te)}else _.showCentroid(ye)}_.borderDoneWithNeighborZ[M]=V.canonical.z,V.borderDoneWithNeighborZ[z]=_.canonical.z}var B,k;(_.needsCentroidUpdate||!_.centroidVertexBuffer&&_.centroidVertexArray.length!==0)&&_.uploadCentroid(d)}const Rf=[1,0,0],L_=[0,1,0],yc=[0,0,1];function bc(d,a,n){const _=n.transform,c=n.shadowRenderer;if(!c)return!0;const f=d.toUnwrapped(),g=_.tileSize*c._cascades[n.currentShadowCascade].scale;let b=a.maxHeight;if(_.elevation){const B=_.elevation.getMinMaxForTile(d);B&&(b+=B.max)}const v=[...c.shadowDirection];v[2]=-v[2];const A=c.computeSimplifiedTileShadowVolume(f,b,g,v);if(!A)return!1;const O=[Rf,L_,yc,v,[v[0],0,v[2]],[0,v[1],v[2]]],R=_.projection.name==="globe",P=_.scaleZoom(g),N=s.bq.fromInvProjectionMatrix(_.invProjMatrix,_.worldSize,P,!R),U=c.getCurrentCascadeFrustum();return N.intersectsPrecise(A.vertices,A.planes,O)===0||U.intersectsPrecise(A.vertices,A.planes,O)===0}function Tc(d){return[d[0]*s.cL,d[1]*s.cL,d[2]*s.cL,0]}function N_(d,a,n,_,c,f,g,b,v){const A=_.getSource(),O=n.globeSharedBuffers;if(!O)return;let R,P,N;if(a&&(R=_.getTile(a)),A instanceof s.ap?(P=A.texture,N=s.cj(0,0,n.transform)):R&&a&&(P=R.texture,N=s.cj(a.canonical.z,a.canonical.x,n.transform)),!P||!N)return;d||(N=s.a6.scale(s.a6.create(),N,[1,-1,1]));const U=n.context,B=U.gl,k=c.paint.get("raster-resampling")==="nearest"?B.NEAREST:B.LINEAR,M=n.colorModeForDrapableLayerRenderPass(f),H=g.defines;H.push("GLOBE_POLES");const $=new wt(B.LEQUAL,wt.ReadWrite,n.depthRangeFor3D),V=Float32Array.from(n.transform.expandedFarZProjMatrix),Z=Float32Array.from(s.aT(s.ci(new s.bs(0,0,0))));n.terrain&&n.terrain.prepareDrawTile(),U.activeTexture.set(B.TEXTURE0),P.bind(k,B.CLAMP_TO_EDGE),U.activeTexture.set(B.TEXTURE1),P.bind(k,B.CLAMP_TO_EDGE),P.useMipmap&&U.extTextureFilterAnisotropic&&n.transform.pitch>20&&B.texParameterf(B.TEXTURE_2D,U.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,U.extTextureFilterAnisotropicMax);const[z,X,ie,ne]=a?O.getPoleBuffers(a.canonical.z,!1):O.getPoleBuffers(0,!0),re=c.paint.get("raster-elevation");let ye;d?(ye=z,n.renderDefaultNorthPole=re!==0):(ye=X,n.renderDefaultSouthPole=re!==0);const ue=Tc(g.mix),Ie=((Ue,ce,Te,le,pe,ke,$e,je,it,ht,St,xt,At)=>w_(Ue,ce,Te,new Float32Array(16),new Float32Array(9),[0,0],le,[0,0],[0,0,0,0],1,{opacity:1,mix:0},ke,[0,0],je,2,ht,St,xt,1,0,At))(V,Z,N,s.S(n.transform.zoom),0,c,0,re,0,ue,g.offset,g.range,f),Ee=n.getOrCreateProgram("raster",{defines:H});n.uploadCommonUniforms(U,Ee,null),Ee.draw(n,B.TRIANGLES,$,v,M,b,Ie,c.id,ye,ie,ne)}function W_(d){const a=d._nearZ,n=d.projection.farthestPixelDistance(d),_=n-a,c=.2*d.height,f=a+c;return[a,n,(f-c-a)/_,(f-a)/_]}function M_(d,a,n,_){if(d)return a instanceof Je&&d instanceof as?a.getTextureDescriptor(d,n,!0):{texture:d.texture,mix:Tc(_.mix),offset:_.offset,buffer:0,tileSize:1}}function D_(d,a,n){if(!d)return null;const _=a.getTextureDescriptor(d,n,!0);if(!_)return null;let{texture:c,mix:f,offset:g,tileSize:b,buffer:v,format:A}=_;if(!c||!A)return null;let O=!1;return A==="uint32"&&(O=!0,f[3]=0,f=kr(s.cM,f,[0,n.paint.get("raster-particle-max-speed")]),g=fc(s.cM,g,[0,n.paint.get("raster-particle-max-speed")])),{texture:c,textureOffset:[v/(b+2*v),b/(b+2*v)],tileSize:b,scalarData:O,scale:f,offset:g,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[A]]}}function F_(d){const a=d._nearZ,n=d.projection.farthestPixelDistance(d),_=n-a,c=.2*d.height,f=a+c;return[a,n,(f-c-a)/_,(f-a)/_]}const ao=new s.ax(1,0,0,1),Bn=new s.ax(0,1,0,1),xc=new s.ax(0,0,1,1),B_=new s.ax(1,0,1,1),U_=new s.ax(0,1,1,1);function Un(d,a,n,_,c,f,g){const b=d.context,v=d.transform,A=b.gl,O=v.projection.name==="globe",R=O?["PROJECTION_GLOBE_VIEW"]:[];let P=s.a6.clone(n.projMatrix);if(O&&s.S(v.zoom)>0){const ue=s.aS(n.canonical,v),Ie=s.cN(ue);P=s.a6.multiply(new Float32Array(16),v.globeMatrix,Ie),s.a6.multiply(P,v.projMatrix,P)}const N=s.a6.create();N[12]+=2*c/(s.f.devicePixelRatio*v.width),N[13]+=2*f/(s.f.devicePixelRatio*v.height),s.a6.multiply(P,N,P);const U=d.getOrCreateProgram("debug",{defines:R}),B=a.getTileByID(n.key);d.terrain&&d.terrain.setupElevationDraw(B,U);const k=wt.disabled,M=Bt.disabled,H=d.colorModeForRenderPass(),$="$debug";b.activeTexture.set(A.TEXTURE0),d.emptyTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),O?B._makeGlobeTileDebugBuffers(d.context,v):B._makeDebugTileBoundsBuffers(d.context,v.projection);const V=B._tileDebugBuffer||d.debugBuffer,Z=B._tileDebugIndexBuffer||d.debugIndexBuffer,z=B._tileDebugSegments||d.debugSegments;if(U.draw(d,A.LINE_STRIP,k,M,H,Pt.disabled,R_(P,_),$,V,Z,z,null,null,null,[B._globeTileDebugBorderBuffer]),g){const ue=B.latestRawTileData,Ie=Math.floor((ue&&ue.byteLength||0)/1024);let Ee=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(Ee+=` => ${n.overscaledZ}`),Ee+=` ${B.state}`,Ee+=` ${Ie}kb`,function(Ue,ce){Ue.initDebugOverlayCanvas();const Te=Ue.debugOverlayCanvas,le=Ue.context.gl,pe=Ue.debugOverlayCanvas.getContext("2d");pe.clearRect(0,0,Te.width,Te.height),pe.shadowColor="white",pe.shadowBlur=2,pe.lineWidth=1.5,pe.strokeStyle="white",pe.textBaseline="top",pe.font="bold 36px Open Sans, sans-serif",pe.fillText(ce,5,5),pe.strokeText(ce,5,5),Ue.debugOverlayTexture.update(Te),Ue.debugOverlayTexture.bind(le.LINEAR,le.CLAMP_TO_EDGE)}(d,Ee)}const X=a.getTile(n).tileSize,ie=512/Math.min(X,512)*(n.overscaledZ/v.zoom)*.5,ne=B._tileDebugTextBuffer||d.debugBuffer,re=B._tileDebugTextIndexBuffer||d.quadTriangleIndexBuffer,ye=B._tileDebugTextSegments||d.debugSegments;U.draw(d,A.TRIANGLES,k,M,Jt.alphaBlended,Pt.disabled,R_(P,s.ax.transparent,ie),$,ne,re,ye,null,null,null,[B._globeTileDebugTextBuffer])}function k_(d,a,n,_){qi(d,0,a+n/2,d.transform.width,n,_)}function fo(d,a,n,_){qi(d,a-n/2,0,n,d.transform.height,_)}function qi(d,a,n,_,c,f){const g=d.context,b=g.gl;b.enable(b.SCISSOR_TEST),b.scissor(a*s.f.devicePixelRatio,n*s.f.devicePixelRatio,_*s.f.devicePixelRatio,c*s.f.devicePixelRatio),g.clear({color:f}),b.disable(b.SCISSOR_TEST)}const Vr=s.ay([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:z_}=Vr;function rn(d,a,n,_){d.emplaceBack(a,n,_)}class H_{constructor(a){this.vertexArray=new s.az,this.indices=new s.aw,rn(this.vertexArray,-1,-1,1),rn(this.vertexArray,1,-1,1),rn(this.vertexArray,-1,1,1),rn(this.vertexArray,1,1,1),rn(this.vertexArray,-1,-1,-1),rn(this.vertexArray,1,-1,-1),rn(this.vertexArray,-1,1,-1),rn(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=a.createVertexBuffer(this.vertexArray,z_),this.indexBuffer=a.createIndexBuffer(this.indices),this.segment=s.aB.simpleSegment(0,0,36,12)}}function cs(d,a,n,_,c,f){const g=d.context.gl,b=a.paint.get("sky-atmosphere-color"),v=a.paint.get("sky-atmosphere-halo-color"),A=a.paint.get("sky-atmosphere-sun-intensity"),O=((R,P,N,U,B)=>({u_matrix_3f:R,u_sun_direction:P,u_sun_intensity:N,u_color_tint_r:[U.r,U.g,U.b,U.a],u_color_tint_m:[B.r,B.g,B.b,B.a],u_luminance:5e-5}))(s.co.fromMat4(s.co.create(),_),c,A,b,v);g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_CUBE_MAP_POSITIVE_X+f,a.skyboxTexture,0),n.draw(d,g.TRIANGLES,wt.disabled,Bt.disabled,Jt.unblended,Pt.frontCW,O,"skyboxCapture",a.skyboxGeometry.vertexBuffer,a.skyboxGeometry.indexBuffer,a.skyboxGeometry.segment)}const Cf=s.ay([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Ks{constructor(a){const n=new s.cO;n.emplaceBack(-1,1,1,0,0),n.emplaceBack(1,1,1,1,0),n.emplaceBack(1,-1,1,1,1),n.emplaceBack(-1,-1,1,0,1);const _=new s.aw;_.emplaceBack(0,1,2),_.emplaceBack(2,3,0),this.vertexBuffer=a.createVertexBuffer(n,Cf.members),this.indexBuffer=a.createIndexBuffer(_),this.segments=s.aB.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Ul=s.ay([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class Xe{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class Rt{constructor(a){this.colorModeAlphaBlendedWriteRGB=new Jt([1,On,1,On],s.ax.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Jt([1,0,1,0],s.ax.transparent,[!1,!1,!1,!0]),this.params=new Xe,this.updateNeeded=!0,a.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),a.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),a.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),a.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(a){const n=a.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new Ks(n);const _=this.params.sizeRange,c=this.params.intensityRange,f=function(O){const R=s.aA(30),P=[];for(let N=0;N<O;++N){const U=2*Math.PI*R(),B=Math.acos(1-2*R())-.5*Math.PI;P.push(s.N.fromValues(Math.cos(B)*Math.cos(U),Math.cos(B)*Math.sin(U),Math.sin(B)))}return P}(this.params.starsCount),g=s.aA(300),b=new s.cP,v=new s.aw;let A=0;for(let O=0;O<f.length;++O){const R=s.N.scale([],f[O],200),P=Math.max(0,1+.01*_*(1*g()-.5)),N=Math.max(0,1+.01*c*(1*g()-.5));b.emplaceBack(R[0],R[1],R[2],-1,-1,P,N),b.emplaceBack(R[0],R[1],R[2],1,-1,P,N),b.emplaceBack(R[0],R[1],R[2],1,1,P,N),b.emplaceBack(R[0],R[1],R[2],-1,1,P,N),v.emplaceBack(A+0,A+1,A+2),v.emplaceBack(A+0,A+2,A+3),A+=4}this.starsVx=n.createVertexBuffer(b,Ul.members),this.starsIdx=n.createIndexBuffer(v),this.starsSegments=s.aB.simpleSegment(0,0,b.length,v.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(a,n){const _=a.context,c=_.gl,f=a.transform,g=new wt(c.LEQUAL,wt.ReadOnly,[0,1]),b=s.S(f.zoom),v=n.properties.get("color").toArray01(),A=n.properties.get("high-color").toArray01(),O=n.properties.get("space-color").toArray01PremultipliedAlpha(),R=5e-4,P=s.cQ(n.properties.get("horizon-blend"),0,1,R,.25),N=s.cd(a,_,f)&&P===R?f.worldSize/(2*Math.PI*1.025)-1:f.globeRadius,U=a.frameCounter/1e3%1,B=s.N.length(f.globeCenterInViewSpace),k=Math.sqrt(Math.pow(B,2)-Math.pow(N,2)),M=Math.acos(k/B),H=$=>{const V=f.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];$&&V.push("ALPHA_PASS");const Z=a.getOrCreateProgram("globeAtmosphere",{defines:V}),z=((ie,ne,re,ye,ue,Ie,Ee,Ue,ce,Te,le,pe)=>({u_frustum_tl:ie,u_frustum_tr:ne,u_frustum_br:re,u_frustum_bl:ye,u_horizon:ue,u_transition:Ie,u_fadeout_range:Ee,u_color:Ue,u_high_color:ce,u_space_color:Te,u_temporal_offset:le,u_horizon_angle:pe}))(f.frustumCorners.TL,f.frustumCorners.TR,f.frustumCorners.BR,f.frustumCorners.BL,f.frustumCorners.horizon,b,P,v,A,O,U,M);a.uploadCommonUniforms(_,Z);const X=this.atmosphereBuffer;X&&Z.draw(a,c.TRIANGLES,g,Bt.disabled,$?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Pt.backCW,z,$?"atmosphere_glow_alpha":"atmosphere_glow",X.vertexBuffer,X.indexBuffer,X.segments)};H(!1),H(!0)}drawStars(a,n){const _=s.aa(n.properties.get("star-intensity"),0,1);if(_===0)return;const c=a.context,f=c.gl,g=a.transform,b=a.getOrCreateProgram("stars"),v=s.bi.identity([]);s.bi.rotateX(v,v,-g._pitch),s.bi.rotateZ(v,v,-g.angle),s.bi.rotateX(v,v,s.bj(g._center.lat)),s.bi.rotateY(v,v,-s.bj(g._center.lng));const A=s.a6.fromQuat(new Float32Array(16),v),O=s.a6.multiply([],g.starsProjMatrix,A),R=s.co.fromMat4([],A),P=s.co.invert([],R),N=[0,1,0];s.N.transformMat3(N,N,P),s.N.scale(N,N,this.params.sizeMultiplier);const U=[1,0,0];s.N.transformMat3(U,U,P),s.N.scale(U,U,this.params.sizeMultiplier);const B=(k=N,M=U,H=_,{u_matrix:Float32Array.from(O),u_up:k,u_right:M,u_intensity_multiplier:H});var k,M,H;a.uploadCommonUniforms(c,b),this.starsVx&&this.starsIdx&&b.draw(a,f.TRIANGLES,wt.disabled,Bt.disabled,this.colorModeAlphaBlendedWriteRGB,Pt.disabled,B,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function ms(d,a){const n=[...d],_=a.cameraWorldSizeForFog/a.worldSize,c=s.a6.identity([]);return s.a6.scale(c,c,[_,_,1]),s.a6.multiply(n,c,n),s.a6.multiply(n,a.worldToFogMatrix,n),n}function $i(d,a,n,_){const c=n.material,f=_.context,{baseColorTexture:g,metallicRoughnessTexture:b}=c.pbrMetallicRoughness,{normalTexture:v,occlusionTexture:A,emissionTexture:O}=c;function R(P,N,U){if(P&&(d.push(N),f.activeTexture.set(f.gl.TEXTURE0+U),P.gfxTexture)){const{minFilter:B,magFilter:k,wrapS:M,wrapT:H}=P.sampler;P.gfxTexture.bindExtraParam(B,k,M,H)}}R(g,"HAS_TEXTURE_u_baseColorTexture",Fa.BaseColor),R(b,"HAS_TEXTURE_u_metallicRoughnessTexture",Fa.MetallicRoughness),R(v,"HAS_TEXTURE_u_normalTexture",Fa.Normal),R(A,"HAS_TEXTURE_u_occlusionTexture",Fa.Occlusion),R(O,"HAS_TEXTURE_u_emissionTexture",Fa.Emission),n.texcoordBuffer&&(d.push("HAS_ATTRIBUTE_a_uv_2f"),a.push(n.texcoordBuffer)),n.colorBuffer&&(d.push(n.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),a.push(n.colorBuffer)),n.normalBuffer&&(d.push("HAS_ATTRIBUTE_a_normal_3f"),a.push(n.normalBuffer)),n.pbrBuffer&&(d.push("HAS_ATTRIBUTE_a_pbr"),d.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),a.push(n.pbrBuffer)),c.alphaMode!=="OPAQUE"&&c.alphaMode!=="MASK"||d.push("UNPREMULT_TEXTURE_IN_SHADER"),c.defined||d.push("DIFFUSE_SHADED"),d.push("USE_STANDARD_DERIVATIVES")}function kl(d,a,n,_,c,f){const g=n.paint.get("model-opacity"),b=a.context,v=new wt(a.context.gl.LEQUAL,wt.ReadWrite,a.depthRangeFor3D),A=a.transform,O=d.mesh,R=O.material,P=R.pbrMetallicRoughness,N=a.style.fog;let U;U=a.transform.projection.zAxisUnit==="pixels"?[...d.nodeModelMatrix]:s.a6.multiply([],_.zScaleMatrix,d.nodeModelMatrix),s.a6.multiply(U,_.negCameraPosMatrix,U);const B=s.a6.invert([],U);s.a6.transpose(B,B);const k=n.paint.get("model-emissive-strength").constantOr(0),M=Yr(new Float32Array(d.worldViewProjection),new Float32Array(U),new Float32Array(B),a,g,P.baseColorFactor,R.emissiveFactor,P.metallicFactor,P.roughnessFactor,R,k,n),H={defines:[]},$=[];$i(H.defines,$,O,a);const V=a.shadowRenderer;V&&(V.useNormalOffset=!1);let Z=null;if(N){const ie=ms(d.nodeModelMatrix,a.transform);if(Z=new Float32Array(ie),A.projection.name!=="globe"){const ne=O.aabb.min,re=O.aabb.max,[ye,ue]=N.getOpacityForBounds(ie,ne[0],ne[1],re[0],re[1]);H.overrideFog=ye>=Ai||ue>=Ai}}const z=Nn(a,n.paint.get("model-cutoff-fade-range"));z.shouldRenderCutoff&&H.defines.push("RENDER_CUTOFF");const X=a.getOrCreateProgram("model",H);a.uploadCommonUniforms(b,X,null,Z,z),a.renderPass!=="shadow"&&V&&V.setupShadowsFromMatrix(d.nodeModelMatrix,X),X.draw(a,b.gl.TRIANGLES,v,c,f,O.material.doubleSided?Pt.disabled:Pt.backCCW,M,n.id,O.vertexBuffer,O.indexBuffer,O.segments,n.paint,a.transform.zoom,void 0,$)}function zl(d,a,n,_,c,f,g){let b;b=d.projection.name==="globe"?s.cS(n,d):[...n],s.a6.multiply(b,b,a.matrix);const v=s.a6.multiply([],_,b);if(a.meshes)for(const A of a.meshes){if(A.material.alphaMode!=="BLEND"){g.push({mesh:A,depth:0,modelIndex:c,worldViewProjection:v,nodeModelMatrix:b});continue}const O=s.N.transformMat4([],A.centroid,v);O[2]>0&&f.push({mesh:A,depth:O[2],modelIndex:c,worldViewProjection:v,nodeModelMatrix:b})}if(a.children)for(const A of a.children)zl(d,A,n,_,c,f,g)}function ge(d,a,n,_){const c=n.shadowRenderer;if(!c)return;const f=c.getShadowPassDepthMode(),g=c.getShadowPassColorMode(),b=c.calculateShadowPassMatrixFromMatrix(a),v=Fl(b);n.getOrCreateProgram("modelDepth",{defines:n._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(n,n.context.gl.TRIANGLES,f,Bt.disabled,g,Pt.backCCW,v,_.id,d.vertexBuffer,d.indexBuffer,d.segments,_.paint,n.transform.zoom,void 0,void 0)}function Y_(d,a,n){const _=a.updateZoomBasedPaintProperties(),c=function(f,g,b){let v,A,O,R=f.terrain?f.terrain.exaggeration():0;if(f.terrain&&R>0){const P=f.terrain,N=P.findDEMTileFor(b);N&&N.dem?v=s.cU.create(P,b,N):R=0}if(R===0&&(g.terrainElevationMin=0,g.terrainElevationMax=0),R===g.validForExaggeration&&(R===0||v&&v._demTile&&v._demTile.tileID===g.validForDEMTile.id&&v._dem._timestamp===g.validForDEMTile.timestamp))return!1;for(const P in g.instancesPerModel){const N=g.instancesPerModel[P];for(let U=0;U<N.instancedDataArray.length;++U){const B=(v?R*v.getElevationAt(0|N.instancedDataArray.float32[16*U],0|N.instancedDataArray.float32[16*U+1],!0,!0):0)+N.instancesEvaluatedElevation[U];N.instancedDataArray.float32[16*U+6]=B,A=A?Math.min(g.terrainElevationMin,B):B,O=O?Math.max(g.terrainElevationMax,B):B}}return g.terrainElevationMin=A||0,g.terrainElevationMax=O||0,g.validForExaggeration=R,g.validForDEMTile=v&&v._demTile?{id:v._demTile.tileID,timestamp:v._dem._timestamp}:{id:void 0,timestamp:0},!0}(d,a,n);(_||c)&&(a.uploaded=!1,a.upload(d.context))}const po={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new s.bS([0,0,0],[s.V,s.V,0])};function vc(d,a){const n=1<<d.canonical.z,_=a.getFreeCameraOptions().position,c=a.elevation,f=d.canonical.x/n,g=(d.canonical.x+1)/n,b=d.canonical.y/n,v=(d.canonical.y+1)/n;let A=a._centerAltitude;if(c){const N=c.getMinMaxForTile(d);N&&N.max>A&&(A=N.max)}const O=s.aa(_.x,f,g)-_.x,R=s.aa(_.y,b,v)-_.y,P=s.bl(A,a.center.lat)-_.z;return a._zoomFromMercatorZ(Math.sqrt(O*O+R*R+P*P))}function G_(d,a,n,_,c,f,g){const b=d.context,v=d.renderPass==="shadow",A=d.shadowRenderer,O=v&&A?A.getShadowPassDepthMode():new wt(b.gl.LEQUAL,wt.ReadWrite,d.depthRangeFor3D),R=d.isTileAffectedByFog(f);if(n.meshes)for(const P of n.meshes){const N=["MODEL_POSITION_ON_GPU"],U=[];let B,k,M;_.instancedDataArray.length>20&&N.push("INSTANCED_ARRAYS");const H=Nn(d,a.paint.get("model-cutoff-fade-range"));if(H.shouldRenderCutoff&&N.push("RENDER_CUTOFF"),v&&A)B=d.getOrCreateProgram("modelDepth",{defines:N}),k=Fl(g.shadowTileMatrix,g.shadowTileMatrix,Float32Array.from(n.matrix)),M=A.getShadowPassColorMode();else{$i(N,U,P,d),B=d.getOrCreateProgram("model",{defines:N,overrideFog:R});const V=P.material,Z=V.pbrMetallicRoughness,z=a.paint.get("model-opacity"),X=a.paint.get("model-emissive-strength").constantOr(0);k=Yr(f.expandedProjMatrix,Float32Array.from(n.matrix),new Float32Array(16),d,z,Z.baseColorFactor,V.emissiveFactor,Z.metallicFactor,Z.roughnessFactor,V,X,a,c),A&&(g.shadowUniformsInitialized?B.setShadowUniformValues(b,A.getShadowUniformValues()):(A.setupShadows(f.toUnwrapped(),B,"model-tile",f.overscaledZ),g.shadowUniformsInitialized=!0)),M=H.shouldRenderCutoff||z<1||V.alphaMode!=="OPAQUE"?Jt.alphaBlended:Jt.unblended}d.uploadCommonUniforms(b,B,f.toUnwrapped(),null,H);const $=P.material.doubleSided?Pt.disabled:Pt.backCCW;if(_.instancedDataArray.length>20)U.push(_.instancedDataBuffer),B.draw(d,b.gl.TRIANGLES,O,Bt.disabled,M,$,k,a.id,P.vertexBuffer,P.indexBuffer,P.segments,a.paint,d.transform.zoom,void 0,U,_.instancedDataArray.length);else{const V=v?"u_instance":"u_normal_matrix";for(let Z=0;Z<_.instancedDataArray.length;++Z)k[V]=new Float32Array(_.instancedDataArray.arrayBuffer,64*Z,16),B.draw(d,b.gl.TRIANGLES,O,Bt.disabled,M,$,k,a.id,P.vertexBuffer,P.indexBuffer,P.segments,a.paint,d.transform.zoom,void 0,U)}}if(n.children)for(const P of n.children)G_(d,a,P,_,c,f,g)}const qs=[1,-1,1];function wf(d,a,n,_){if(!n.modelManager)return!0;const c=n.modelManager;if(!n.shadowRenderer)return!0;const f=n.shadowRenderer,g=a.aabb;let b=!0,v=d.maxHeight;if(v===0){let O=0;for(const R in d.instancesPerModel){const P=c.getModel(R,_);P?O=Math.max(O,Math.max(Math.max(P.aabb.max[0],P.aabb.max[1]),P.aabb.max[2])):b=!1}v=d.maxScale*O*1.41+d.maxVerticalOffset,b&&(d.maxHeight=v)}g.max[2]=v,g.min[2]+=d.terrainElevationMin,g.max[2]+=d.terrainElevationMax,s.N.transformMat4(g.min,g.min,a.tileMatrix),s.N.transformMat4(g.max,g.max,a.tileMatrix);const A=g.intersects(f.getCurrentCascadeFrustum());return n.currentShadowCascade===0&&(d.isInsideFirstShadowMapFrustum=A===2),A===0}class Pf{}class Ec{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(a,n,_){{const R=this._storage.get(n.id);if(R)return R.lastUsedFrameIdx=a,R.buf}const c=_.gl,f=c.getBufferParameter(c.ELEMENT_ARRAY_BUFFER,c.BUFFER_SIZE),g=new ArrayBuffer(f),b=new Int16Array(g);c.getBufferSubData(c.ELEMENT_ARRAY_BUFFER,0,new Int16Array(g));const v=new s.cW;for(let R=0;R<f/2;R+=3){const P=b[R],N=b[R+1],U=b[R+2];v.emplaceBack(P,N),v.emplaceBack(N,U),v.emplaceBack(U,P)}const A=_.bindVertexArrayOES.current,O=new Pf;return O.buf=new Mi(_,v),O.lastUsedFrameIdx=a,this._storage.set(n.id,O),_.bindVertexArrayOES.set(A),O.buf}update(a){for(const[n,_]of this._storage)a-_.lastUsedFrameIdx>30&&(_.buf.destroy(),this._storage.delete(n))}destroy(){for(const[a,n]of this._storage)n.buf.destroy(),this._storage.delete(a)}}class Hl{registerParameter(a,n,_,c,f){}registerButton(a,n,_){}}const Yl={symbol:function(d,a,n,_,c){if(d.renderPass!=="translucent")return;const f=Bt.disabled,g=d.colorModeForRenderPass();n.layout.get("text-variable-anchor")&&function(A,O,R,P,N,U,B){const k=O.transform,M=N==="map",H=U==="map";for(const $ of A){const V=P.getTile($),Z=V.getBucket(R);if(!Z||!Z.text||!Z.text.segments.get().length)continue;const z=s.b5(Z.textSizeData,k.zoom),X=Al($,Z.getProjection(),k),ie=k.calculatePixelsToTileUnitsMatrix(V),ne=vl(X,V.tileID.canonical,H,M,k,Z.getProjection(),ie),re=Z.hasIconTextFit()&&Z.hasIconData();if(z){const ye=Math.pow(2,k.zoom-V.tileID.overscaledZ);gc(Z,M,H,B,s.cx,k,ne,$,ye,z,re)}}}(_,d,n,a,n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),c);const b=n.paint.get("icon-opacity").constantOr(1)!==0,v=n.paint.get("text-opacity").constantOr(1)!==0;n.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(b||v)?Gr(d,a,n,_,f,g):(b&&Gr(d,a,n,_,f,g,{onlyIcons:!0}),v&&Gr(d,a,n,_,f,g,{onlyText:!0})),a.map.showCollisionBoxes&&(Uo(d,a,n,_,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),!0),Uo(d,a,n,_,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),!1))},circle:function(d,a,n,_){if(d.renderPass!=="translucent")return;const c=n.paint.get("circle-opacity"),f=n.paint.get("circle-stroke-width"),g=n.paint.get("circle-stroke-opacity"),b=n.layout.get("circle-sort-key").constantOr(1)!==void 0,v=n.paint.get("circle-emissive-strength");if(c.constantOr(1)===0&&(f.constantOr(1)===0||g.constantOr(1)===0))return;const A=d.context,O=A.gl,R=d.transform,P=d.depthModeForSublayer(0,wt.ReadOnly),N=Bt.disabled,U=d.colorModeForDrapableLayerRenderPass(v),B=R.projection.name==="globe",k=[s.a5(R.center.lng),s.ae(R.center.lat)],M=[];for(let $=0;$<_.length;$++){const V=_[$],Z=a.getTile(V),z=Z.getBucket(n);if(!z||z.projection.name!==R.projection.name)continue;const X=z.programConfigurations.get(n.id),ie=s.cy(n),ne=d.isTileAffectedByFog(V);B&&ie.push("PROJECTION_GLOBE_VIEW");const re=d.getOrCreateProgram("circle",{config:X,defines:ie,overrideFog:ne}),ye=z.layoutVertexBuffer,ue=z.globeExtVertexBuffer,Ie=z.indexBuffer,Ee=R.projection.createInversionMatrix(R,V.canonical),Ue={programConfiguration:X,program:re,layoutVertexBuffer:ye,globeExtVertexBuffer:ue,indexBuffer:Ie,uniformValues:s.cz(d,V,Z,Ee,k,n),tile:Z};if(b){const ce=z.segments.get();for(const Te of ce)M.push({segments:new s.aB([Te]),sortKey:Te.sortKey,state:Ue})}else M.push({segments:z.segments,sortKey:0,state:Ue})}b&&M.sort(($,V)=>$.sortKey-V.sortKey);const H={useDepthForOcclusion:R.depthOcclusionForSymbolsAndCircles};for(const $ of M){const{programConfiguration:V,program:Z,layoutVertexBuffer:z,globeExtVertexBuffer:X,indexBuffer:ie,uniformValues:ne,tile:re}=$.state,ye=$.segments;d.terrain&&d.terrain.setupElevationDraw(re,Z,H),d.uploadCommonUniforms(A,Z,re.tileID.toUnwrapped()),Z.draw(d,O.TRIANGLES,P,N,U,Pt.disabled,ne,n.id,z,ie,ye,n.paint,R.zoom,V,[X])}},heatmap:function(d,a,n,_){if(n.paint.get("heatmap-opacity")!==0)if(d.renderPass==="offscreen"){const c=d.context,f=c.gl,g=Bt.disabled,b=new Jt([f.ONE,f.ONE,f.ONE,f.ONE],s.ax.transparent,[!0,!0,!0,!0]);(function(N,U,B,k){const M=N.gl,H=U.width*k,$=U.height*k;N.activeTexture.set(M.TEXTURE1),N.viewport.set([0,0,H,$]);let V=B.heatmapFbo;if(!V||V&&(V.width!==H||V.height!==$)){V&&V.destroy();const Z=M.createTexture();M.bindTexture(M.TEXTURE_2D,Z),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_WRAP_S,M.CLAMP_TO_EDGE),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_WRAP_T,M.CLAMP_TO_EDGE),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MIN_FILTER,M.LINEAR),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MAG_FILTER,M.LINEAR),V=B.heatmapFbo=N.createFramebuffer(H,$,!0,null),function(z,X,ie,ne,re,ye){const ue=z.gl;ue.texImage2D(ue.TEXTURE_2D,0,z.extRenderToTextureHalfFloat?ue.RGBA16F:ue.RGBA,re,ye,0,ue.RGBA,z.extRenderToTextureHalfFloat?ue.HALF_FLOAT:ue.UNSIGNED_BYTE,null),ne.colorAttachment.set(ie)}(N,0,Z,V,H,$)}else M.bindTexture(M.TEXTURE_2D,V.colorAttachment.get()),N.bindFramebuffer.set(V.framebuffer)})(c,d,n,d.transform.projection.name==="globe"?.5:.25),c.clear({color:s.ax.transparent});const v=d.transform,A=v.projection.name==="globe",O=A?["PROJECTION_GLOBE_VIEW"]:[],R=A?Pt.frontCCW:Pt.disabled,P=[s.a5(v.center.lng),s.ae(v.center.lat)];for(let N=0;N<_.length;N++){const U=_[N];if(a.hasRenderableParent(U))continue;const B=a.getTile(U),k=B.getBucket(n);if(!k||k.projection.name!==v.projection.name)continue;const M=d.isTileAffectedByFog(U),H=k.programConfigurations.get(n.id),$=d.getOrCreateProgram("heatmap",{config:H,defines:O,overrideFog:M}),{zoom:V}=d.transform;d.terrain&&d.terrain.setupElevationDraw(B,$),d.uploadCommonUniforms(c,$,U.toUnwrapped());const Z=v.projection.createInversionMatrix(v,U.canonical);$.draw(d,f.TRIANGLES,wt.disabled,g,b,R,C_(d,U,B,Z,P,V,n.paint.get("heatmap-intensity")),n.id,k.layoutVertexBuffer,k.indexBuffer,k.segments,n.paint,d.transform.zoom,H,A?[k.globeExtVertexBuffer]:null)}c.viewport.set([0,0,d.width,d.height])}else d.renderPass==="translucent"&&(d.context.setColorMode(d.colorModeForRenderPass()),function(c,f){const g=c.context,b=g.gl,v=f.heatmapFbo;if(!v)return;g.activeTexture.set(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,v.colorAttachment.get()),g.activeTexture.set(b.TEXTURE1);let A=f.colorRampTexture;A||(A=f.colorRampTexture=new s.T(g,f.colorRamp,b.RGBA)),A.bind(b.LINEAR,b.CLAMP_TO_EDGE),c.getOrCreateProgram("heatmapTexture").draw(c,b.TRIANGLES,wt.disabled,Bt.disabled,c.colorModeForRenderPass(),Pt.disabled,((O,R,P,N)=>({u_image:0,u_color_ramp:1,u_opacity:R.paint.get("heatmap-opacity")}))(0,f),f.id,c.viewportBuffer,c.quadTriangleIndexBuffer,c.viewportSegments,f.paint,c.transform.zoom)}(d,n))},line:function(d,a,n,_){if(d.renderPass!=="translucent")return;const c=n.paint.get("line-opacity"),f=n.paint.get("line-width");if(c.constantOr(1)===0||f.constantOr(1)===0)return;const g=n.paint.get("line-emissive-strength"),b=d.depthModeForSublayer(0,wt.ReadOnly),v=d.colorModeForDrapableLayerRenderPass(g),A=d.terrain&&d.terrain.renderingToTexture?1:s.f.devicePixelRatio,O=n.paint.get("line-dasharray"),R=O.constantOr(1),P=n.layout.get("line-cap"),N=n.paint.get("line-pattern"),U=N.constantOr(1),B=n.paint.get("line-pattern").constantOr(1),k=n.paint.get("line-opacity").constantOr(1)!==1;let M=!B&&k;const H=n.paint.get("line-gradient"),$=U?"linePattern":"line",V=d.context,Z=V.gl,z=s.cA(n);d.terrain&&d.terrain.clipOrMaskOverlapStencilType()&&(M=!1);for(const X of _){const ie=a.getTile(X);if(U&&!ie.patternsLoaded())continue;const ne=ie.getBucket(n);if(!ne)continue;d.prepareDrawTile();const re=ne.programConfigurations.get(n.id),ye=d.isTileAffectedByFog(X),ue=d.getOrCreateProgram($,{config:re,defines:z,overrideFog:ye}),Ie=N.constantOr(null);if(Ie&&ie.imageAtlas){const $e=ie.imageAtlas.patternPositions[Ie.toString()];$e&&re.setConstantPatternPositions($e)}const Ee=O.constantOr(null),Ue=P.constantOr(null);if(!U&&Ee&&Ue&&ie.lineAtlas){const $e=ie.lineAtlas.getDash(Ee,Ue);$e&&re.setConstantPatternPositions($e)}let[ce,Te]=n.paint.get("line-trim-offset");(Ue==="round"||Ue==="square")&&ce!==Te&&(ce===0&&(ce-=1),Te===1&&(Te+=1));const le=d.terrain?X.projMatrix:null,pe=U?s.cB(d,ie,n,le,A,[ce,Te]):s.cC(d,ie,n,le,ne.lineClipsArray.length,A,[ce,Te]);if(H){const $e=ne.gradients[n.id];let je=$e.texture;if(n.gradientVersion!==$e.version){let it=256;if(n.stepInterpolant){const ht=a.getSource().maxzoom,St=X.canonical.z===ht?Math.ceil(1<<d.transform.maxZoom-X.canonical.z):1;it=s.aa(s.cD(ne.maxLineLength/s.V*1024*St),256,V.maxTextureSize)}$e.gradient=s.cE({expression:n.gradientExpression(),evaluationKey:"lineProgress",resolution:it,image:$e.gradient||void 0,clips:ne.lineClipsArray}),$e.texture?$e.texture.update($e.gradient):$e.texture=new s.T(V,$e.gradient,Z.RGBA),$e.version=n.gradientVersion,je=$e.texture}V.activeTexture.set(Z.TEXTURE1),je.bind(n.stepInterpolant?Z.NEAREST:Z.LINEAR,Z.CLAMP_TO_EDGE)}R&&(V.activeTexture.set(Z.TEXTURE0),ie.lineAtlasTexture&&ie.lineAtlasTexture.bind(Z.LINEAR,Z.REPEAT),re.updatePaintBuffers()),U&&(V.activeTexture.set(Z.TEXTURE0),ie.imageAtlasTexture&&ie.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),re.updatePaintBuffers()),d.uploadCommonUniforms(V,ue,X.toUnwrapped());const ke=$e=>{ue.draw(d,Z.TRIANGLES,b,$e,v,Pt.disabled,pe,n.id,ne.layoutVertexBuffer,ne.indexBuffer,ne.segments,n.paint,d.transform.zoom,re,[ne.layoutVertexBuffer2])};if(M){const $e=d.stencilModeForClipping(X).ref;$e===0&&d.terrain&&V.clear({stencil:0});const je={func:Z.EQUAL,mask:255};pe.u_alpha_discard_threshold=.8,ke(new Bt(je,$e,255,Z.KEEP,Z.KEEP,Z.INVERT)),pe.u_alpha_discard_threshold=0,ke(new Bt(je,$e,255,Z.KEEP,Z.KEEP,Z.KEEP))}else ke(d.stencilModeForClipping(X))}M&&(d.resetStencilClippingMasks(),d.terrain&&V.clear({stencil:0}))},fill:function(d,a,n,_){const c=n.paint.get("fill-color"),f=n.paint.get("fill-opacity");if(f.constantOr(1)===0)return;const g=n.paint.get("fill-emissive-strength"),b=d.colorModeForDrapableLayerRenderPass(g),v=n.paint.get("fill-pattern"),A=d.opaquePassEnabledForLayer()&&!v.constantOr(1)&&c.constantOr(s.ax.transparent).a===1&&f.constantOr(0)===1?"opaque":"translucent";if(d.renderPass===A){const O=d.depthModeForSublayer(1,d.renderPass==="opaque"?wt.ReadWrite:wt.ReadOnly);us(d,a,n,_,O,b,!1)}if(d.renderPass==="translucent"&&n.paint.get("fill-antialias")){const O=d.depthModeForSublayer(n.getPaintProperty("fill-outline-color")?2:0,wt.ReadOnly);us(d,a,n,_,O,b,!0)}},"fill-extrusion":function(d,a,n,_){const c=n.paint.get("fill-extrusion-opacity"),f=d.context,g=f.gl,b=d.terrain,v=b&&b.renderingToTexture;if(c===0)return;const A=d.conflationActive&&d.layerUsedInConflation(n,a.getSource());if(A&&function(O,R,P,N){for(const U of N){const B=R.getTile(U).getBucket(P);B&&(B.updateReplacement(U,O.replacementSource),B.uploadCentroid(O.context))}}(d,a,n,_),b||A)for(const O of _){const R=a.getTile(O).getBucket(n);R&&Sf(d.context,a,O,R,n,b,A)}if(d.renderPass==="shadow"&&d.shadowRenderer){const O=d.shadowRenderer;if(b&&c<.65&&n._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof s.Z)return;const R=O.getShadowPassDepthMode(),P=O.getShadowPassColorMode();yt(d,a,n,_,R,Bt.disabled,P,A)}else if(d.renderPass==="translucent"){const O=!n.paint.get("fill-extrusion-pattern").constantOr(1),R=n.paint.get("fill-extrusion-color").constantOr(s.ax.white);if(!v&&R.a!==0){const P=new wt(d.context.gl.LEQUAL,wt.ReadWrite,d.depthRangeFor3D);c===1&&O?yt(d,a,n,_,P,Bt.disabled,Jt.unblended,A):(yt(d,a,n,_,P,Bt.disabled,Jt.disabled,A),yt(d,a,n,_,P,d.stencilModeFor3D(),d.colorModeForRenderPass(),A),d.resetStencilClippingMasks())}if(d.style.enable3dLights()&&O&&(!b&&d.transform.projection.name!=="globe"||v)){const P=n.paint.get("fill-extrusion-opacity"),N=n.paint.get("fill-extrusion-ambient-occlusion-intensity"),U=n.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),B=n.paint.get("fill-extrusion-flood-light-intensity"),k=n.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),M=N>0&&U>0,H=B>0,$=(Z,z,X)=>(1-X)*Z+X*z,V=Z=>{const z=d.depthModeForSublayer(1,wt.ReadOnly,g.LEQUAL,!0),X=n.paint.get(Z?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),ie=$(.1,3,X),ne=d._showOverdrawInspector;if(!ne){const re=new Bt({func:g.ALWAYS,mask:255},255,255,g.KEEP,g.KEEP,g.REPLACE),ye=new Jt([g.ONE,g.ONE,g.ONE,g.ONE],s.ax.transparent,[!1,!1,!1,!0],g.MIN);Fn(d,a,n,_,z,re,ye,Pt.disabled,Z,"sdf",P,N,U,B,k,ie,A,!1)}{const re=ne?Bt.disabled:new Bt({func:g.EQUAL,mask:255},255,255,g.KEEP,g.DECR,g.DECR),ye=ne?d.colorModeForRenderPass():new Jt([g.ONE_MINUS_DST_ALPHA,g.DST_ALPHA,g.ONE,g.ONE],s.ax.transparent,[!0,!0,!0,!0]);Fn(d,a,n,_,z,re,ye,Pt.disabled,Z,"color",P,N,U,B,k,ie,A,!1)}};if(v){const Z=(z,X,ie)=>{const ne=d.depthModeForSublayer(1,wt.ReadOnly,g.LEQUAL,!1),re=n.paint.get(z?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),ye=$(.1,3,re);{const ue=new Jt([g.ONE,g.ONE,g.ONE,g.ONE],s.ax.transparent,[!1,!1,!1,!0]);Fn(d,a,n,_,ne,Bt.disabled,ue,Pt.disabled,z,"clear",P,N,U,B,k,ye,A,X)}{const ue=new Bt({func:g.ALWAYS,mask:255},255,255,g.KEEP,g.KEEP,g.REPLACE),Ie=new Jt([g.ONE,g.ONE,g.ONE,g.ONE],s.ax.transparent,[!1,!1,!1,!0],g.MIN);Fn(d,a,n,_,ne,ue,Ie,Pt.disabled,z,"sdf",P,N,U,B,k,ye,A,X)}{const ue=z?g.ZERO:g.ONE_MINUS_DST_ALPHA,Ie=new Bt({func:g.EQUAL,mask:255},255,255,g.KEEP,g.DECR,g.DECR),Ee=new Jt([ue,g.DST_ALPHA,g.ONE_MINUS_DST_ALPHA,g.ZERO],s.ax.transparent,[!0,!0,!0,!0]);Fn(d,a,n,_,ne,Ie,Ee,Pt.disabled,z,"color",P,N,U,B,k,ye,A,X)}{const ue=new Jt([g.ONE,g.ONE,g.ONE,z?g.ZERO:g.ONE],s.ax.transparent,[!1,!1,!1,!0],z?g.FUNC_ADD:g.MAX);Fn(d,a,n,_,ne,Bt.disabled,ue,Pt.disabled,z,"clear",P,N,U,B,k,ye,A,X,ie)}};if(M||H){let z;if(d.prepareDrawTile(),b){const X=b.drapeBufferSize[0],ie=b.drapeBufferSize[1];z=b.framebufferCopyTexture,z&&(!z||z.size[0]===X&&z.size[1]===ie)||(z&&z.destroy(),z=b.framebufferCopyTexture=new s.T(f,new s.h({width:X,height:ie}),g.RGBA)),z.bind(g.LINEAR,g.CLAMP_TO_EDGE),g.copyTexImage2D(g.TEXTURE_2D,0,g.RGBA,0,0,X,ie,0)}M&&Z(!0,!1,z),H&&Z(!1,!0,z)}}else M&&V(!0),H&&V(!1)}}},hillshade:function(d,a,n,_){if(d.renderPass!=="offscreen"&&d.renderPass!=="translucent"||d.style.disableElevatedTerrain)return;const c=d.context,f=d.terrain&&d.terrain.renderingToTexture,[g,b]=d.renderPass!=="translucent"||f?[{},_]:d.stencilConfigForOverlap(_);for(const v of b){const A=a.getTile(v);if(A.needsHillshadePrepare&&d.renderPass==="offscreen")h_(d,A,n);else if(d.renderPass==="translucent"){const O=d.depthModeForSublayer(0,wt.ReadOnly),R=n.paint.get("hillshade-emissive-strength"),P=d.colorModeForDrapableLayerRenderPass(R),N=f&&d.terrain?d.terrain.stencilModeForRTTOverlap(v):g[v.overscaledZ];Fr(d,v,A,n,O,N,P)}}c.viewport.set([0,0,d.width,d.height]),d.resetStencilClippingMasks()},raster:function(d,a,n,_,c,f){if(d.renderPass!=="translucent"||n.paint.get("raster-opacity")===0)return;const g=d.transform.projection.name==="globe",b=n.paint.get("raster-elevation")!==0,v=b&&g;if(d.renderElevatedRasterBackface&&!v)return;const A=d.context,O=A.gl,R=a.getSource(),P=function(z,X,ie,ne){const re=X.paint.get("raster-color"),ye=z.type==="raster-array",ue=[],Ie=X.paint.get("raster-resampling"),Ee=X.paint.get("raster-color-mix");let Ue=X.paint.get("raster-color-range");const ce=[Ee[0],Ee[1],Ee[2],0],Te=Ee[3];let le=Ie==="nearest"?ne.NEAREST:ne.LINEAR;if(ye&&(ue.push("RASTER_ARRAY"),re||ue.push("RASTER_COLOR"),Ie==="linear"&&ue.push("RASTER_ARRAY_LINEAR"),le=ne.NEAREST,!Ue&&z.rasterLayers)){const pe=z.rasterLayers.find(({id:ke})=>ke===X.sourceLayer);pe&&pe.fields&&pe.fields.range&&(Ue=pe.fields.range)}if(Ue=Ue||[0,1],re){ue.push("RASTER_COLOR"),ie.activeTexture.set(ne.TEXTURE2),X.updateColorRamp(Ue);let pe=X.colorRampTexture;pe||(pe=X.colorRampTexture=new s.T(ie,X.colorRamp,ne.RGBA)),pe.bind(ne.LINEAR,ne.CLAMP_TO_EDGE)}return{mix:ce,range:Ue,offset:Te,defines:ue,resampling:le}}(R,n,A,O);if(R instanceof s.ap&&!_.length&&!g)return;const N=n.paint.get("raster-emissive-strength"),U=d.colorModeForDrapableLayerRenderPass(N),B=d.terrain&&d.terrain.renderingToTexture,k=!d.options.moving,M=n.paint.get("raster-resampling")==="nearest"?O.NEAREST:O.LINEAR;if(R instanceof s.ap&&!_.length&&(R.onNorthPole||R.onSouthPole)){const z=b?d.stencilModeFor3D():Bt.disabled;return void N_(!!R.onNorthPole,null,d,a,n,N,P,Pt.disabled,z)}if(!_.length)return;const[H,$]=R instanceof s.ap||B?[{},_]:d.stencilConfigForOverlap(_),V=$[$.length-1].overscaledZ;v&&P.defines.push("PROJECTION_GLOBE_VIEW"),b&&P.defines.push("RENDER_CUTOFF");const Z=(z,X,ie)=>{for(const ne of z){const re=ne.toUnwrapped(),ye=a.getTile(ne);if(B&&(!ye||!ye.hasData()))continue;A.activeTexture.set(O.TEXTURE0);const ue=M_(ye,R,n,P);if(!ue||!ue.texture)continue;const{texture:Ie,mix:Ee,offset:Ue,tileSize:ce,buffer:Te}=ue;let le,pe;B?(le=wt.disabled,pe=ne.projMatrix):b?(le=new wt(O.LEQUAL,wt.ReadWrite,d.depthRangeFor3D),pe=g?Float32Array.from(d.transform.expandedFarZProjMatrix):d.transform.calculateProjMatrix(re,k)):(le=d.depthModeForSublayer(ne.overscaledZ-V,n.paint.get("raster-opacity")===1?wt.ReadWrite:wt.ReadOnly,O.LESS),pe=d.transform.calculateProjMatrix(re,k));const ke=d.terrain&&B?d.terrain.stencilModeForRTTOverlap(ne):H[ne.overscaledZ],$e=f?0:n.paint.get("raster-fade-duration");ye.registerFadeDuration($e);const je=a.findLoadedParent(ne,0),it=T_(ye,je,a,d.transform,$e);let ht,St;d.terrain&&d.terrain.prepareDrawTile(),A.activeTexture.set(O.TEXTURE0),Ie.bind(M,O.CLAMP_TO_EDGE),A.activeTexture.set(O.TEXTURE1),je?(je.texture&&je.texture.bind(M,O.CLAMP_TO_EDGE),ht=Math.pow(2,je.tileID.overscaledZ-ye.tileID.overscaledZ),St=[ye.tileID.canonical.x*ht%1,ye.tileID.canonical.y*ht%1]):Ie.bind(M,O.CLAMP_TO_EDGE),Ie.useMipmap&&A.extTextureFilterAnisotropic&&d.transform.pitch>20&&O.texParameterf(O.TEXTURE_2D,A.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,A.extTextureFilterAnisotropicMax);const xt=d.transform;let At;const jt=b?W_(xt):[0,0,0,0];let Ft,zt,kt,di,Wi,ei=0;if(v&&R instanceof s.ap&&R.coordinates.length>3)Ft=Float32Array.from(s.aT(s.ci(new s.bs(0,0,0)))),zt=Float32Array.from(xt.globeMatrix),kt=Float32Array.from(s.ce(xt)),di=[s.a5(xt.center.lng),s.ae(xt.center.lat)],At=R.elevatedGlobePerspectiveTransform,Wi=R.elevatedGlobeGridMatrix||new Float32Array(9);else if(v){const ii=s.cf(ne.canonical);ei=s.cg(ii.getCenter().lat),Ft=Float32Array.from(s.aT(s.ci(ne.canonical))),zt=Float32Array.from(xt.globeMatrix),kt=Float32Array.from(s.ce(xt)),di=[s.a5(xt.center.lng),s.ae(xt.center.lat)],At=[0,0],Wi=Float32Array.from(s.ch(ne.canonical,ii,ei,xt.worldSize/xt._pixelsPerMercatorPixel))}else At=R instanceof s.ap?R.perspectiveTransform:[0,0],Ft=new Float32Array(16),zt=new Float32Array(9),kt=new Float32Array(16),di=[0,0],Wi=new Float32Array(9);const Zi=w_(pe,Ft,zt,kt,Wi,St||[0,0],s.S(d.transform.zoom),di,jt,ht||1,it,n,At,b?n.paint.get("raster-elevation"):0,2,Ee,Ue,P.range,ce,Te,N),ti=d.isTileAffectedByFog(ne),fi=d.getOrCreateProgram("raster",{defines:P.defines,overrideFog:ti});if(d.uploadCommonUniforms(A,fi,re),R instanceof s.ap){const ii=R.elevatedGlobeVertexBuffer,mi=R.elevatedGlobeIndexBuffer;if(B||!g)R.boundsBuffer&&R.boundsSegments&&fi.draw(d,O.TRIANGLES,le,Bt.disabled,U,Pt.disabled,Zi,n.id,R.boundsBuffer,d.quadTriangleIndexBuffer,R.boundsSegments);else if(ii&&mi){const Ui=xt.zoom<=s.bG?R.elevatedGlobeSegments:R.getSegmentsForLongitude(xt.center.lng);Ui&&fi.draw(d,O.TRIANGLES,le,Bt.disabled,U,X,Zi,n.id,ii,mi,Ui)}}else if(v){le=new wt(O.LEQUAL,wt.ReadOnly,d.depthRangeFor3D);const ii=d.globeSharedBuffers;if(ii){const[mi,Ui,bi]=ii.getGridBuffers(ei,!1);fi.draw(d,O.TRIANGLES,le,ie||ke,d.colorModeForRenderPass(),X,Zi,n.id,mi,Ui,bi)}}else{const{tileBoundsBuffer:ii,tileBoundsIndexBuffer:mi,tileBoundsSegments:Ui}=d.getTileBoundsBuffers(ye);fi.draw(d,O.TRIANGLES,le,ke,U,Pt.disabled,Zi,n.id,ii,mi,Ui)}}if(!(R instanceof s.ap)&&v)for(const ne of z){const re=ne.canonical.y===(1<<ne.canonical.z)-1;ne.canonical.y===0&&N_(!0,ne,d,a,n,N,P,X,ie||Bt.disabled),re&&N_(!1,ne,d,a,n,N,P,X===Pt.frontCW?Pt.backCW:Pt.frontCW,ie||Bt.disabled)}};v?Z($,d.renderElevatedRasterBackface?Pt.backCW:Pt.frontCW,d.stencilModeFor3D()):Z($,Pt.disabled,void 0),d.resetStencilClippingMasks()},"raster-particle":function(d,a,n,_,c,f){d.renderPass==="offscreen"&&function(g,b,v,A){if(!A.length)return;const O=g.context,R=O.gl,P=b.getSource();if(!(P instanceof Je))return;const N=[];for(const k of A){const M=b.getTile(k);if(!(M instanceof as))continue;const H=D_(M,P,v);if(!H)continue;const $=[H.tileSize,H.tileSize];let V=v.tileFramebuffer;V||(V=v.tileFramebuffer=O.createFramebuffer($[0],$[1],!0,null));let Z=M.rasterParticleState;const z=v.paint.get("raster-particle-count");Z||(Z=M.rasterParticleState=new ha(O,k,$,z));const X=Z.update(v.lastInvalidatedAt);Z.numParticles!==z&&Z.setNumParticles(k,z);const ie=Z.targetColorTexture;Z.targetColorTexture=Z.backgroundColorTexture,Z.backgroundColorTexture=ie;const ne=Z.particleVertices0;Z.particleVertices0=Z.particleVertices1,Z.particleVertices1=ne,N.push([k,H,Z,X])}if(N.length===0)return;const U=s.f.now(),B=v.previousDrawTimestamp?.001*(U-v.previousDrawTimestamp):.0167;if(v.previousDrawTimestamp=U,v.hasColorMap()){O.activeTexture.set(R.TEXTURE0+2);let k=v.colorRampTexture;k||(k=v.colorRampTexture=new s.T(O,v.colorRamp,R.RGBA)),k.bind(R.LINEAR,R.CLAMP_TO_EDGE)}O.bindFramebuffer.set(v.tileFramebuffer.framebuffer),O.activeTexture.set(R.TEXTURE0),function(k,M,H){const $=k.context,V=$.gl,Z=M.tileFramebuffer;$.activeTexture.set(V.TEXTURE0);const z={u_texture:0,u_opacity:1.05*(ie=M.paint.get("raster-particle-fade-opacity-factor"))/(ie+.05)},X=k.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var ie;for(const ne of H){const[,,re,ye]=ne;Z.colorAttachment.set(re.targetColorTexture.texture),$.viewport.set([0,0,Z.width,Z.height]),$.clear({color:s.ax.transparent}),ye&&(re.backgroundColorTexture.bind(V.NEAREST,V.CLAMP_TO_EDGE),X.draw(k,V.TRIANGLES,wt.disabled,Bt.disabled,Jt.alphaBlended,Pt.disabled,z,M.id,k.viewportBuffer,k.quadTriangleIndexBuffer,k.viewportSegments))}}(g,v,N),function(k,M,H,$){const V=k.context.gl,Z=H.tileFramebuffer,z=k.transform.projection.name==="globe",X=H.paint.get("raster-particle-max-speed");for(const ie of $){const[ne,re,ye]=ie;re.texture.bind(V.LINEAR,V.CLAMP_TO_EDGE),Z.colorAttachment.set(ye.targetColorTexture.texture);const ue=k.getOrCreateProgram("rasterParticleDraw",{defines:re.defines,overrideFog:!1}),Ie=re.scalarData?[]:[0,1,2,3].map(ce=>s.cG[ce](ne));Ie.push(ne);const Ee=ne.canonical.x,Ue=ne.canonical.y;for(const ce of Ie){const Te=M.getTile(z?ce.wrapped():ce);if(!Te)continue;const le=Te.rasterParticleState;if(!le)continue;const pe=If([ce.canonical.x+(1<<ce.canonical.z)*(ce.wrap-ne.wrap)-Ee,ce.canonical.y-Ue],0,re.texture.size,2,X,re.textureOffset,re.scale,re.offset);ue.draw(k,V.POINTS,wt.disabled,Bt.disabled,Jt.alphaBlended,Pt.disabled,pe,H.id,le.particleVertices0,void 0,le.particleSegment)}}}(g,b,v,N),function(k,M,H,$){const V=k.context.gl;let Z=M.transformFeedbackObject;Z||(Z=M.transformFeedbackObject=V.createTransformFeedback()),V.bindTransformFeedback(V.TRANSFORM_FEEDBACK,M.transformFeedbackObject);const z=M.paint.get("raster-particle-max-speed"),X=$*M.paint.get("raster-particle-speed-factor")*.3,ie=(ne=M.paint.get("raster-particle-reset-rate-factor"),Math.pow(ne,6));var ne;for(const re of H){const[,ye,ue]=re;ye.texture.bind(V.LINEAR,V.CLAMP_TO_EDGE);const Ie=pc(0,ye.texture.size,z,X,ie,ye.textureOffset,ye.scale,ye.offset);k.getOrCreateProgram("rasterParticleUpdate",{defines:ye.defines,transformFeedback:{bufferMode:V.SEPARATE_ATTRIBS,shaderVaryings:["v_new_particle"]}}).draw(k,V.POINTS,wt.disabled,Bt.disabled,Jt.disabled,Pt.disabled,Ie,M.id,ue.particleVertices0,void 0,ue.particleSegment,{},void 0,void 0,void 0,void 0,[{buffer:ue.particleVertices1,targetIndex:0}])}V.bindTransformFeedback(V.TRANSFORM_FEEDBACK,null)}(g,v,N,B)}(d,a,n,_),d.renderPass==="translucent"&&(function(g,b,v,A,O){const R=g.context,P=R.gl,N=!g.options.moving,U=g.transform.projection.name==="globe";if(!A.length)return;const[B,k]=g.stencilConfigForOverlap(A),M=[];U&&M.push("PROJECTION_GLOBE_VIEW");for(const H of k){const $=H.toUnwrapped(),V=b.getTile(H);if(!V.rasterParticleState)continue;const Z=V.rasterParticleState,z=100;V.registerFadeDuration(z);const X=b.findLoadedParent(H,0),ie=T_(V,X,b,g.transform,z);let ne,re;g.terrain&&g.terrain.prepareDrawTile(),R.activeTexture.set(P.TEXTURE0),Z.targetColorTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),R.activeTexture.set(P.TEXTURE1),X&&X.rasterParticleState?(X.rasterParticleState.targetColorTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),ne=Math.pow(2,X.tileID.overscaledZ-V.tileID.overscaledZ),re=[V.tileID.canonical.x*ne%1,V.tileID.canonical.y*ne%1]):Z.targetColorTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE);const ye=U?Float32Array.from(g.transform.expandedFarZProjMatrix):g.transform.calculateProjMatrix($,N),ue=g.transform,Ie=F_(ue),Ee=s.cf(H.canonical),Ue=s.cg(Ee.getCenter().lat);let ce,Te,le,pe,ke;U?(ce=Float32Array.from(s.aT(s.ci(H.canonical))),Te=Float32Array.from(ue.globeMatrix),le=Float32Array.from(s.ce(ue)),pe=[s.a5(ue.center.lng),s.ae(ue.center.lat)],ke=Float32Array.from(s.ch(H.canonical,Ee,Ue,ue.worldSize/ue._pixelsPerMercatorPixel))):(ce=new Float32Array(16),Te=new Float32Array(9),le=new Float32Array(16),pe=[0,0],ke=new Float32Array(9));const $e=Af(ye,ce,Te,le,ke,re||[0,0],s.S(g.transform.zoom),pe,Ie,ne||1,ie,250),je=g.isTileAffectedByFog(H),it=g.getOrCreateProgram("rasterParticle",{defines:M,overrideFog:je});if(g.uploadCommonUniforms(R,it,$),U){const ht=new wt(P.LEQUAL,wt.ReadWrite,g.depthRangeFor3D),St=0,xt=g.globeSharedBuffers;if(xt){const[At,jt,Ft]=xt.getGridBuffers(Ue,St!==0);it.draw(g,P.TRIANGLES,ht,Bt.disabled,Jt.alphaBlended,Pt.backCCW,$e,v.id,At,jt,Ft)}}else{const ht=g.depthModeForSublayer(0,wt.ReadOnly),St=B[H.overscaledZ],{tileBoundsBuffer:xt,tileBoundsIndexBuffer:At,tileBoundsSegments:jt}=g.getTileBoundsBuffers(V);it.draw(g,P.TRIANGLES,ht,St,Jt.alphaBlended,Pt.disabled,$e,v.id,xt,At,jt)}}g.resetStencilClippingMasks()}(d,a,n,_),d.style.map.triggerRepaint())},background:function(d,a,n,_){const c=n.paint.get("background-color"),f=n.paint.get("background-opacity"),g=n.paint.get("background-emissive-strength");if(f===0)return;const b=d.context,v=b.gl,A=d.transform,O=A.tileSize,R=n.paint.get("background-pattern");if(d.isPatternMissing(R,n.scope))return;const P=!R&&c.a===1&&f===1&&d.opaquePassEnabledForLayer()?"opaque":"translucent";if(d.renderPass!==P)return;const N=Bt.disabled,U=d.depthModeForSublayer(0,P==="opaque"?wt.ReadWrite:wt.ReadOnly),B=d.colorModeForDrapableLayerRenderPass(g),k=R?"backgroundPattern":"background";let M,H=_;H||(M=d.getBackgroundTiles(),H=Object.values(M).map($=>$.tileID)),R&&(b.activeTexture.set(v.TEXTURE0),d.imageManager.bind(d.context,n.scope));for(const $ of H){const V=d.isTileAffectedByFog($),Z=d.getOrCreateProgram(k,{overrideFog:V}),z=$.toUnwrapped(),X=_?$.projMatrix:d.transform.calculateProjMatrix(z);d.prepareDrawTile();const ie=a?a.getTile($):M?M[$.key]:new Sn($,O,A.zoom,d),ne=R?Ml(X,g,f,d,R,n.scope,{tileID:$,tileSize:O}):P_(X,g,f,c);d.uploadCommonUniforms(b,Z,z);const{tileBoundsBuffer:re,tileBoundsIndexBuffer:ye,tileBoundsSegments:ue}=d.getTileBoundsBuffers(ie);Z.draw(d,v.TRIANGLES,U,N,B,Pt.disabled,ne,n.id,re,ye,ue)}},sky:function(d,a,n){const _=d._atmosphere?s.S(d.transform.zoom):1,c=n.paint.get("sky-opacity")*_;if(c===0)return;const f=d.context,g=n.paint.get("sky-type"),b=new wt(f.gl.LEQUAL,wt.ReadOnly,[0,1]),v=d.frameCounter/1e3%1;g==="atmosphere"?d.renderPass==="offscreen"?n.needsSkyboxCapture(d)&&(function(A,O,R,P){const N=A.context,U=N.gl;let B=O.skyboxFbo;if(!B){B=O.skyboxFbo=N.createFramebuffer(32,32,!0,null),O.skyboxGeometry=new H_(N),O.skyboxTexture=N.gl.createTexture(),U.bindTexture(U.TEXTURE_CUBE_MAP,O.skyboxTexture),U.texParameteri(U.TEXTURE_CUBE_MAP,U.TEXTURE_WRAP_S,U.CLAMP_TO_EDGE),U.texParameteri(U.TEXTURE_CUBE_MAP,U.TEXTURE_WRAP_T,U.CLAMP_TO_EDGE),U.texParameteri(U.TEXTURE_CUBE_MAP,U.TEXTURE_MIN_FILTER,U.LINEAR),U.texParameteri(U.TEXTURE_CUBE_MAP,U.TEXTURE_MAG_FILTER,U.LINEAR);for(let $=0;$<6;++$)U.texImage2D(U.TEXTURE_CUBE_MAP_POSITIVE_X+$,0,U.RGBA,32,32,0,U.RGBA,U.UNSIGNED_BYTE,null)}N.bindFramebuffer.set(B.framebuffer),N.viewport.set([0,0,32,32]);const k=O.getCenter(A,!0),M=A.getOrCreateProgram("skyboxCapture"),H=new Float64Array(16);s.a6.identity(H),s.a6.rotateY(H,H,.5*-Math.PI),cs(A,O,M,H,k,0),s.a6.identity(H),s.a6.rotateY(H,H,.5*Math.PI),cs(A,O,M,H,k,1),s.a6.identity(H),s.a6.rotateX(H,H,.5*-Math.PI),cs(A,O,M,H,k,2),s.a6.identity(H),s.a6.rotateX(H,H,.5*Math.PI),cs(A,O,M,H,k,3),s.a6.identity(H),cs(A,O,M,H,k,4),s.a6.identity(H),s.a6.rotateY(H,H,Math.PI),cs(A,O,M,H,k,5),N.viewport.set([0,0,A.width,A.height])}(d,n),n.markSkyboxValid(d)):d.renderPass==="sky"&&function(A,O,R,P,N){const U=A.context,B=U.gl,k=A.transform,M=A.getOrCreateProgram("skybox");U.activeTexture.set(B.TEXTURE0),B.bindTexture(B.TEXTURE_CUBE_MAP,O.skyboxTexture);const H=(($,V,Z,z,X)=>({u_matrix:$,u_sun_direction:V,u_cubemap:0,u_opacity:z,u_temporal_offset:X}))(k.skyboxMatrix,O.getCenter(A,!1),0,P,N);A.uploadCommonUniforms(U,M),M.draw(A,B.TRIANGLES,R,Bt.disabled,A.colorModeForRenderPass(),Pt.backCW,H,"skybox",O.skyboxGeometry.vertexBuffer,O.skyboxGeometry.indexBuffer,O.skyboxGeometry.segment)}(d,n,b,c,v):g==="gradient"&&d.renderPass==="sky"&&function(A,O,R,P,N){const U=A.context,B=U.gl,k=A.transform,M=A.getOrCreateProgram("skyboxGradient");O.skyboxGeometry||(O.skyboxGeometry=new H_(U)),U.activeTexture.set(B.TEXTURE0);let H=O.colorRampTexture;H||(H=O.colorRampTexture=new s.T(U,O.colorRamp,B.RGBA)),H.bind(B.LINEAR,B.CLAMP_TO_EDGE);const $=((V,Z,z,X,ie)=>({u_matrix:V,u_color_ramp:0,u_center_direction:Z,u_radius:s.bj(z),u_opacity:X,u_temporal_offset:ie}))(k.skyboxMatrix,O.getCenter(A,!1),O.paint.get("sky-gradient-radius"),P,N);A.uploadCommonUniforms(U,M),M.draw(A,B.TRIANGLES,R,Bt.disabled,A.colorModeForRenderPass(),Pt.backCW,$,"skyboxGradient",O.skyboxGeometry.vertexBuffer,O.skyboxGeometry.indexBuffer,O.skyboxGeometry.segment)}(d,n,b,c,v)},debug:function(d,a,n,_,c,f){for(let g=0;g<n.length;g++)if(c){const A=new s.ax(_.r*.8,_.g*.8,_.b*.8,1);Un(d,a,n[g],_,-1,-1,f),Un(d,a,n[g],_,-1,1,f),Un(d,a,n[g],_,1,1,f),Un(d,a,n[g],_,1,-1,f),Un(d,a,n[g],A,0,0,f)}else Un(d,a,n[g],_,0,0,f)},custom:function(d,a,n,_){const c=d.context,f=n.implementation;if(!d.transform.projection.unsupportedLayers||!d.transform.projection.unsupportedLayers.includes("custom")||d.terrain&&(d.terrain.renderingToTexture||d.renderPass==="offscreen")&&n.isLayerDraped(a)){if(d.renderPass==="offscreen"){const g=f.prerender;if(g){if(d.setCustomLayerDefaults(),c.setColorMode(d.colorModeForRenderPass()),d.transform.projection.name==="globe"){const b=d.transform.pointMerc;g.call(f,c.gl,d.transform.customLayerMatrix(),d.transform.getProjection(),d.transform.globeToMercatorMatrix(),s.S(d.transform.zoom),[b.x,b.y],d.transform.pixelsPerMeterRatio)}else g.call(f,c.gl,d.transform.customLayerMatrix());c.setDirty(),d.setBaseState()}}else if(d.renderPass==="translucent"){if(d.terrain&&d.terrain.renderingToTexture){const b=f.renderToTile;if(b){const v=_[0].canonical,A=new s.L(v.x+_[0].wrap*(1<<v.z),v.y,v.z);c.setDepthMode(wt.disabled),c.setStencilMode(Bt.disabled),c.setColorMode(d.colorModeForRenderPass()),d.setCustomLayerDefaults(),b.call(f,c.gl,A),c.setDirty(),d.setBaseState()}return}d.setCustomLayerDefaults(),c.setColorMode(d.colorModeForRenderPass()),c.setStencilMode(Bt.disabled);const g=f.renderingMode==="3d"?new wt(d.context.gl.LEQUAL,wt.ReadWrite,d.depthRangeFor3D):d.depthModeForSublayer(0,wt.ReadOnly);if(c.setDepthMode(g),d.transform.projection.name==="globe"){const b=d.transform.pointMerc;f.render(c.gl,d.transform.customLayerMatrix(),d.transform.getProjection(),d.transform.globeToMercatorMatrix(),s.S(d.transform.zoom),[b.x,b.y],d.transform.pixelsPerMeterRatio)}else f.render(c.gl,d.transform.customLayerMatrix());c.setDirty(),d.setBaseState(),c.bindFramebuffer.set(null)}}else s.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(d,a,n,_){if(d.renderPass==="opaque")return;const c=n.paint.get("model-opacity");if(c===0)return;const f=n.paint.get("model-cast-shadows");if(d.renderPass==="shadow"&&(!f||d.terrain&&c<.65&&n._transitionablePaint._values["model-opacity"].value.expression instanceof s.Z))return;const g=d.shadowRenderer,b=n.paint.get("model-receive-shadows");g&&(g.useNormalOffset=!0,b||(g.enabled=!1));const v=()=>{g&&(g.useNormalOffset=!0,b||(g.enabled=!0))},A=a.getSource();if(d.renderPass==="light-beam"&&A.type!=="batched-model")return;if(A.type==="vector"||A.type==="geojson")return function(M,H,$,V){const Z=M.transform;if(Z.projection.name!=="mercator")return void s.w(`Drawing 3D models for ${Z.projection.name} projection is not yet implemented`);const z=Z.getFreeCameraOptions().position;if(!M.modelManager)return;const X=M.modelManager;$.modelManager=X;const ie=M.shadowRenderer;if(!$._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const ne=$._unevaluatedLayout._values["model-id"],re={...$.layout.get("model-id").parameters};for(const ye of V){const ue=H.getTile(ye).getBucket($);if(!ue||ue.projection.name!==Z.projection.name)continue;const Ie=vc(ye,Z);re.zoom=Ie;const Ee=ne.possiblyEvaluate(re);if(Y_(M,ue,ye),po.shadowUniformsInitialized=!1,po.useSingleShadowCascade=!!ie&&ie.getMaxCascadeForTile(ye.toUnwrapped())===0,M.renderPass==="shadow"&&ie){if(M.currentShadowCascade===1&&ue.isInsideFirstShadowMapFrustum)continue;const Te=Z.calculatePosMatrix(ye.toUnwrapped(),Z.worldSize);if(po.tileMatrix.set(Te),po.shadowTileMatrix=Float32Array.from(ie.calculateShadowPassMatrixFromMatrix(Te)),po.aabb.min.fill(0),po.aabb.max[0]=po.aabb.max[1]=s.V,po.aabb.max[2]=0,wf(ue,po,M,$.scope))continue}const Ue=1<<ye.canonical.z,ce=[((z.x-ye.wrap)*Ue-ye.canonical.x)*s.V,(z.y*Ue-ye.canonical.y)*s.V,z.z*Ue*s.V];for(let Te in ue.instancesPerModel){const le=ue.instancesPerModel[Te];le.features.length>0&&(Te=Ee.evaluate(le.features[0].feature,{}));const pe=X.getModel(Te,$.scope);if(pe&&pe.uploaded)for(const ke of pe.nodes)G_(M,$,ke,le,ce,ye,po)}}}(d,a,n,_),void v();if(!A.loaded())return;if(A.type==="batched-model")return function(M,H,$,V){$.resetLayerRenderingStats(M);const Z=M.context,z=M.transform,X=M.style.fog,ie=M.shadowRenderer;if(z.projection.name!=="mercator")return void s.w(`Drawing 3D landmark models for ${z.projection.name} projection is not yet implemented`);const ne=M.transform.getFreeCameraOptions().position,re=s.N.scale([],[ne.x,ne.y,ne.z],M.transform.worldSize);s.N.negate(re,re);const ye=s.a6.identity([]),ue=s.cR(z.center.lat,z.zoom),Ie=s.a6.fromScaling([],[1,1,1/ue]);s.a6.translate(ye,ye,re);const Ee=$.paint.get("model-opacity"),Ue=new wt(Z.gl.LEQUAL,wt.ReadWrite,M.depthRangeFor3D),ce=new wt(Z.gl.LEQUAL,wt.ReadOnly,M.depthRangeFor3D),Te=new s.bS([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),le=M.renderPass==="shadow",pe=le&&ie?ie.getCurrentCascadeFrustum():z.getFrustum(z.scaleZoom(z.worldSize)),ke=$.getLayerRenderingStats(),$e=function(je,it){for(const ht of V){const St=H.getTile(ht).getBucket($);if(!St||!St.uploaded)continue;let xt=!1;ie&&(xt=ie.getMaxCascadeForTile(ht.toUnwrapped())===0);const At=z.calculatePosMatrix(ht.toUnwrapped(),z.worldSize),jt=St.modelTraits;for(const Ft of St.getNodesInfo()){if(Ft.hiddenByReplacement||!Ft.node.meshes)continue;const zt=Ft.evaluatedScale,kt=Ft.node;let di=0;if(M.terrain&&kt.elevation&&(di=kt.elevation*M.terrain.exaggeration()),zt[0]<=1&&zt[1]<=1&&zt[2]<=1&&(()=>{const Ui=Ft.getLocalBounds();return Te.min=[...Ui.min],Te.max=[...Ui.max],Te.min[2]+=di,Te.max[2]+=di,s.N.transformMat4(Te.min,Te.min,At),s.N.transformMat4(Te.max,Te.max,At),Te})().intersects(pe)===0)continue;const Wi=M.renderPass==="light-beam",ei=[...At];s.a6.translate(ei,ei,[(kt.anchor?kt.anchor[0]:0)*(zt[0]-1),(kt.anchor?kt.anchor[1]:0)*(zt[1]-1),di]),s.N.exactEquals(zt,s.cT)||s.a6.scale(ei,ei,zt),s.a6.multiply(ei,ei,kt.matrix);const Zi=s.a6.multiply([],Ie,ei);s.a6.multiply(Zi,ye,Zi);const ti=s.a6.invert([],Zi);s.a6.transpose(ti,ti),s.a6.scale(ti,ti,qs);const fi=s.a6.multiply([],z.expandedFarZProjMatrix,ei),ii=jt&s.cV.HasMapboxMeshFeatures,mi=ii?0:Ft.evaluatedRMEA[0][2];for(let Ui=0;Ui<kt.meshes.length;++Ui){const bi=kt.meshes[Ui],Oa=Ui===kt.lightMeshIndex;if(Oa){if(!Wi&&!M.terrain&&M.shadowRenderer){M.currentLayer<M.firstLightBeamLayer&&(M.firstLightBeamLayer=M.currentLayer);continue}}else if(Wi)continue;const Ba={defines:[]},no=[];if($i(Ba.defines,no,bi,M),ii||Ba.defines.push("DIFFUSE_SHADED"),xt&&Ba.defines.push("SHADOWS_SINGLE_CASCADE"),ke&&(le?ke.numRenderedVerticesInShadowPass+=bi.vertexArray.length:ke.numRenderedVerticesInTransparentPass+=bi.vertexArray.length),le){ge(bi,ei,M,$);continue}let Zo=null;if(X){const lo=ms(ei,M.transform);if(Zo=new Float32Array(lo),z.projection.name!=="globe"){const Xo=bi.aabb.min,Gn=bi.aabb.max,[ps,ar]=X.getOpacityForBounds(lo,Xo[0],Xo[1],Gn[0],Gn[1]);Ba.overrideFog=ps>=Ai||ar>=Ai}}const so=bi.material;let Sa;so.occlusionTexture&&so.occlusionTexture.offsetScale&&(Sa=so.occlusionTexture.offsetScale,Ba.defines.push("OCCLUSION_TEXTURE_TRANSFORM")),!le&&ie&&(ie.useNormalOffset=!!bi.normalBuffer);const ya=M.getOrCreateProgram("model",Ba);!le&&ie&&ie.setupShadowsFromMatrix(ei,ya,ie.useNormalOffset),M.uploadCommonUniforms(Z,ya,ht.toUnwrapped(),Zo);const ja=so.pbrMetallicRoughness;ja.metallicFactor=.9,ja.roughnessFactor=.5;const Za=Yr(new Float32Array(fi),new Float32Array(Zi),new Float32Array(ti),M,Ee,ja.baseColorFactor,so.emissiveFactor,ja.metallicFactor,ja.roughnessFactor,so,mi,$,[0,0,0],Sa);ya.draw(M,Z.gl.TRIANGLES,it&&!Oa?Ue:ce,Bt.disabled,je?Oa||Ee<1||Ft.hasTranslucentParts?Jt.alphaBlended:Jt.unblended:Jt.disabled,Pt.backCCW,Za,$.id,bi.vertexBuffer,bi.indexBuffer,bi.segments,$.paint,M.transform.zoom,void 0,no)}}}};(function(je,it,ht,St){const xt=je.terrain?je.terrain.exaggeration():0,At=je.transform.zoom;for(const jt of St){const Ft=it.getTile(jt).getBucket(ht);Ft&&(je.conflationActive&&Ft.updateReplacement(jt,je.replacementSource),Ft.evaluateScale(je,ht),je.terrain&&xt>0&&Ft.elevationUpdate(je.terrain,xt,jt,ht.source),Ft.needsReEvaluation(je,At,ht)&&Ft.evaluate(ht))}})(M,H,$,V),Ee===1?$e(!0,!0):($e(!1,!0),$e(!0,!1))}(d,a,n,_),void v();const O=A.getModels(),R=[],P=d.transform.getFreeCameraOptions().position,N=s.N.scale([],[P.x,P.y,P.z],d.transform.worldSize);s.N.negate(N,N);const U=[],B=[];let k=0;for(const M of O){const H=n.paint.get("model-rotation").constantOr(null),$=n.paint.get("model-scale").constantOr(null),V=n.paint.get("model-translation").constantOr(null);M.computeModelMatrix(d,H,$,V,!0,!0,!1);const Z=s.a6.identity([]),z=s.cR(M.position.lat,d.transform.zoom),X=s.a6.fromScaling([],[1,1,1/z]);s.a6.translate(Z,Z,N),R.push({zScaleMatrix:X,negCameraPosMatrix:Z});for(const ie of M.nodes)zl(d.transform,ie,M.matrix,d.transform.expandedFarZProjMatrix,k,U,B);k++}if(U.sort((M,H)=>H.depth-M.depth),d.renderPass!=="shadow"){if(c===1)for(const M of B)kl(M,d,n,R[M.modelIndex],Bt.disabled,d.colorModeForRenderPass());else{for(const M of B)kl(M,d,n,R[M.modelIndex],Bt.disabled,Jt.disabled);for(const M of B)kl(M,d,n,R[M.modelIndex],d.stencilModeFor3D(),d.colorModeForRenderPass());d.resetStencilClippingMasks()}for(const M of U)kl(M,d,n,R[M.modelIndex],Bt.disabled,d.colorModeForRenderPass());v()}else{for(const M of B)ge(M.mesh,M.nodeModelMatrix,d,n);for(const M of U)ge(M.mesh,M.nodeModelMatrix,d,n);v()}}},V_={model:function(d,a,n){const _=d.scope,c=a.getSource();if(!c.loaded())return;if(c.type==="vector"||c.type==="geojson")return void(n.modelManager&&n.modelManager.upload(n,_));if(c.type==="batched-model")return;const f=c.getModels();for(const g of f)g.upload(n.context)},raster:function(d,a,n){const _=a.getSource();if(!(_ instanceof Je&&_.loaded()))return;const c=d.sourceLayer||_.rasterLayerIds&&_.rasterLayerIds[0];if(!c)return;const f=d.paint.get("raster-array-band")||_.getInitialBand(c);if(f==null)return;const g=a.getIds().map(b=>a.getTileByID(b));for(const b of g)b.updateNeeded(c,f)&&_.prepareTile(b,c,f)},"raster-particle":function(d,a,n){const _=a.getSource();if(!(_ instanceof Je&&_.loaded()))return;const c=d.sourceLayer||_.rasterLayerIds&&_.rasterLayerIds[0];if(!c)return;const f=d.paint.get("raster-particle-array-band")||_.getInitialBand(c);if(f==null)return;const g=a.getIds().map(b=>a.getTileByID(b));for(const b of g)b.updateNeeded(c,f)&&_.prepareTile(b,c,f)}};class Ac{constructor(a,n,_,c){this.context=new Ku(a,n),this.transform=_,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=c,this._debugParams={showTerrainProxyTiles:!1},c.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),this.setup(),this.numSublayers=Mo.maxUnderzooming+Mo.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new s.cX,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new r_(this),this._wireframeDebugCache=new Ec,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0}updateTerrain(a,n){const _=!!a&&!!a.terrain&&this.transform.projection.supportsTerrain;if(!(_||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Ef(this,a));const c=this._terrain;this.transform.elevation=_?c:null,c.update(a,this.transform,n),this.transform.elevation&&!c.enabled&&(this.transform.elevation=null)}_updateFog(a){const n=a.fog;if(!n||this.transform.projection.name==="globe"||n.getOpacity(this.transform.pitch)<1||n.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[_,c]=n.getFovAdjustedRange(this.transform._fov);if(_>c)return void(this.transform.fogCullDistSq=null);const f=_+.78*(c-_);this.transform.fogCullDistSq=f*f}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(a,n){if(this.width=a*s.f.devicePixelRatio,this.height=n*s.f.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style.order)this.style._mergedLayers[_].resize()}setup(){const a=this.context,n=new s.aN;n.emplaceBack(0,0),n.emplaceBack(s.V,0),n.emplaceBack(0,s.V),n.emplaceBack(s.V,s.V),this.tileExtentBuffer=a.createVertexBuffer(n,s.aP.members),this.tileExtentSegments=s.aB.simpleSegment(0,0,4,2);const _=new s.aN;_.emplaceBack(0,0),_.emplaceBack(s.V,0),_.emplaceBack(0,s.V),_.emplaceBack(s.V,s.V),this.debugBuffer=a.createVertexBuffer(_,s.aP.members),this.debugSegments=s.aB.simpleSegment(0,0,4,5);const c=new s.aN;c.emplaceBack(-1,-1),c.emplaceBack(1,-1),c.emplaceBack(-1,1),c.emplaceBack(1,1),this.viewportBuffer=a.createVertexBuffer(c,s.aP.members),this.viewportSegments=s.aB.simpleSegment(0,0,4,2);const f=new s.av;f.emplaceBack(0,0,0,0),f.emplaceBack(s.V,0,s.V,0),f.emplaceBack(0,s.V,0,s.V),f.emplaceBack(s.V,s.V,s.V,s.V),this.mercatorBoundsBuffer=a.createVertexBuffer(f,s.aR.members),this.mercatorBoundsSegments=s.aB.simpleSegment(0,0,4,2);const g=new s.aw;g.emplaceBack(0,1,2),g.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=a.createIndexBuffer(g);const b=new s.aO;for(const A of[0,1,3,2,0])b.emplaceBack(A);this.debugIndexBuffer=a.createIndexBuffer(b),this.emptyTexture=new s.T(a,new s.h({width:1,height:1},Uint8Array.of(0,0,0,0)),a.gl.RGBA),this.identityMat=s.a6.create();const v=this.context.gl;this.stencilClearMode=new Bt({func:v.ALWAYS,mask:0},0,255,v.ZERO,v.ZERO,v.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(a){return a._makeTileBoundsBuffers(this.context,this.transform.projection),a._tileBoundsBuffer?{tileBoundsBuffer:a._tileBoundsBuffer,tileBoundsIndexBuffer:a._tileBoundsIndexBuffer,tileBoundsSegments:a._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const a=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,a.TRIANGLES,wt.disabled,this.stencilClearMode,Jt.disabled,Pt.disabled,b_(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(a,n,_){if(!n||this.currentStencilSource===n.id||!a.isTileClipped()||!_||_.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let b=!1;for(const v of _)if(this._tileClippingMaskIDs[v.key]===void 0){b=!0;break}if(!b)return}this.currentStencilSource=n.id;const c=this.context,f=c.gl;this.nextStencilID+_.length>256&&this.clearStencil(),c.setColorMode(Jt.disabled),c.setDepthMode(wt.disabled);const g=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const b of _){const v=n.getTile(b),A=this._tileClippingMaskIDs[b.key]=this.nextStencilID++,{tileBoundsBuffer:O,tileBoundsIndexBuffer:R,tileBoundsSegments:P}=this.getTileBoundsBuffers(v);g.draw(this,f.TRIANGLES,wt.disabled,new Bt({func:f.ALWAYS,mask:0},A,255,f.KEEP,f.KEEP,f.REPLACE),Jt.disabled,Pt.disabled,b_(b.projMatrix),"$clipping",O,R,P)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const a=this.nextStencilID++,n=this.context.gl;return new Bt({func:n.NOTEQUAL,mask:255},a,255,n.KEEP,n.KEEP,n.REPLACE)}stencilModeForClipping(a){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(a);const n=this.context.gl;return new Bt({func:n.EQUAL,mask:255},this._tileClippingMaskIDs[a.key],0,n.KEEP,n.KEEP,n.REPLACE)}stencilConfigForOverlap(a){const n=this.context.gl,_=a.sort((g,b)=>b.overscaledZ-g.overscaledZ),c=_[_.length-1].overscaledZ,f=_[0].overscaledZ-c+1;if(f>1){this.currentStencilSource=void 0,this.nextStencilID+f>256&&this.clearStencil();const g={};for(let b=0;b<f;b++)g[b+c]=new Bt({func:n.GEQUAL,mask:255},b+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=f,[g,_]}return[{[c]:Bt.disabled},_]}colorModeForRenderPass(){const a=this.context.gl;return this._showOverdrawInspector?new Jt([a.CONSTANT_COLOR,a.ONE,a.CONSTANT_COLOR,a.ONE],new s.ax(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Jt.unblended:Jt.alphaBlended}colorModeForDrapableLayerRenderPass(a){const n=this.context.gl;return(()=>this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture)()&&this.renderPass==="translucent"?new Jt([n.ONE,n.ONE_MINUS_SRC_ALPHA,n.CONSTANT_ALPHA,n.ONE_MINUS_SRC_ALPHA],new s.ax(0,0,0,a===void 0?0:a),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(a,n,_,c=!1){if(!this.opaquePassEnabledForLayer()&&!c)return wt.disabled;const f=1-((1+this.currentLayer)*this.numSublayers+a)*this.depthEpsilon;return new wt(_||this.context.gl.LEQUAL,n,[f,f])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(a,n){this._wireframeDebugCache.update(this.frameCounter),this.style=a,this.options=n;const _=this.style._mergedLayers,c=this.style.order,f=c.map(z=>_[z]),g=this.style._mergedSourceCaches;this.imageManager=a.imageManager,this.modelManager=a.modelManager,this.symbolFadeChange=a.placement.symbolFadeChange(s.f.now()),this.imageManager.beginFrame();let b=0,v=!1;for(const z in g){const X=g[z];X.used&&(X.prepare(this.context),X.getSource().usedInConflation&&++b)}for(const z of f)z.isHidden(this.transform.zoom)||this.prepareLayer(z);const A={},O={},R={},P={},N={};for(const z in g){const X=g[z];A[z]=X.getVisibleCoordinates(),O[z]=A[z].slice().reverse(),R[z]=X.getVisibleCoordinates(!0).reverse(),P[z]=X.getShadowCasterCoordinates(),N[z]=X.sortCoordinatesByDistance(A[z])}const U=z=>{const X=this.style.getLayerSourceCache(z);return X&&X.used?X.getSource():null};if(b){const z=[];for(const X of f)this.layerUsedInConflation(X,U(X))&&z.push(X);if(z&&z.length>1){const X=[];for(const ie of z){const ne=this.style.getLayerSourceCache(ie);ne&&ne.used&&ne.getSource().usedInConflation&&X.push({layer:ie.fqid,cache:ne})}this.replacementSource.setSources(X),v=!0}}v||this.replacementSource.clear(),this.conflationActive=v,this.minCutoffZoom=0,this.longestCutoffRange=0;for(const z of f){const X=z.cutoffRange();if(this.longestCutoffRange=Math.max(X,this.longestCutoffRange),X>0){const ie=U(z);ie&&(this.minCutoffZoom=Math.max(ie.minzoom,this.minCutoffZoom)),z.minzoom&&(this.minCutoffZoom=Math.max(z.minzoom,this.minCutoffZoom))}}this.opaquePassCutoff=1/0;for(let z=0;z<f.length;z++)if(f[z].is3D()){this.opaquePassCutoff=z;break}const B=this.style&&this.style.fog;B?(this._fogVisible=B.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=B.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(R),this.opaquePassCutoff=0);const k=this._shadowRenderer;if(k){k.updateShadowParameters(this.transform,this.style.directionalLight);for(const z in g)for(const X of A[z]){let ie={min:0,max:0};this.terrain&&(ie=this.terrain.getMinMaxForTile(X)||ie),k.addShadowReceiver(X.toUnwrapped(),ie.min,ie.max)}}if(this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new s.cY(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new Rt(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!s.cZ(this.context.gl))return;this.renderPass="offscreen";for(const z of f){const X=a.getLayerSourceCache(z);if(!z.hasOffscreenPass()||z.isHidden(this.transform.zoom))continue;const ie=X?O[X.id]:void 0;(z.type==="custom"||z.type==="raster"||z.type==="raster-particle"||z.isSky()||ie&&ie.length)&&this.renderLayer(this,X,z,ie)}this.depthRangeFor3D=[0,1-(f.length+2)*this.numSublayers*this.depthEpsilon];const M=this.terrain;M&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&!this.transform.isOrthographic&&M.drawDepth(),this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,P)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const H=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),$=(()=>{if(n.showOverdrawInspector)return s.ax.black;if(this.style.fog&&this.transform.projection.supportsFog&&!H){const z=this.style.fog.properties.get("color").toArray01();return new s.ax(...z)}if(this.style.fog&&this.transform.projection.supportsFog&&H){const z=this.style.fog.properties.get("space-color").toArray01();return new s.ax(...z)}return s.ax.transparent})();if(this.context.clear({color:$,depth:1}),this.clearStencil(),this._showOverdrawInspector=n.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&H&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=c.length-1;this.currentLayer>=0;this.currentLayer--){const z=f[this.currentLayer],X=a.getLayerSourceCache(z);if(z.isSky())continue;const ie=X?(z.is3D()?N:O)[X.id]:void 0;this._renderTileClippingMasks(z,X,ie),this.renderLayer(this,X,z,ie)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&H&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||s.S(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<c.length;this.currentLayer++){const z=f[this.currentLayer],X=a.getLayerSourceCache(z);z.isSky()&&this.renderLayer(this,X,z,X?O[X.id]:void 0)}function V(z,X){let ie;return X&&(ie=(z.type==="symbol"?R:z.is3D()?N:O)[X.id]),ie}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<c.length;){const z=f[this.currentLayer];if(z.type==="raster"){const X=a.getLayerSourceCache(z);this.renderLayer(this,X,z,V(z,X))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let Z=0;for(k&&(Z=k.getShadowCastingLayerCount());this.currentLayer<c.length;){const z=f[this.currentLayer],X=a.getLayerSourceCache(z);if(z.isSky())++this.currentLayer;else if(M&&this.style.isLayerDraped(z)){if(z.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=M.renderBatch(this.currentLayer)}else{if(this._renderTileClippingMasks(z,X,X?A[X.id]:void 0),this.renderLayer(this,X,z,V(z,X)),!M&&k&&Z>0&&z.hasShadowPass()&&--Z==0&&(k.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const ie=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=ie;this.currentLayer++){const ne=f[this.currentLayer];if(!ne.hasLightBeamPass())continue;const re=a.getLayerSourceCache(ne);this.renderLayer(this,re,ne,re?O[re.id]:void 0)}this.currentLayer=ie,this.renderPass="translucent"}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let z=null;f.forEach(X=>{const ie=a.getLayerSourceCache(X);ie&&!X.isHidden(this.transform.zoom)&&ie.getVisibleCoordinates().length&&(!z||z.getSource().maxzoom<ie.getSource().maxzoom)&&(z=ie)}),z&&this.options.showTileBoundaries&&Yl.debug(this,z,z.getVisibleCoordinates(),s.ax.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Yl.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new s.ax(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(z){const X=z.transform.padding;k_(z,z.transform.height-(X.top||0),3,ao),k_(z,X.bottom||0,3,Bn),fo(z,X.left||0,3,xc),fo(z,z.transform.width-(X.right||0),3,B_);const ie=z.transform.centerPoint;(function(ne,re,ye,ue){qi(ne,re-1,ye-10,2,20,ue),qi(ne,re-10,ye-1,20,2,ue)})(z,ie.x,z.transform.height-ie.y,U_)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),v||(this.conflationActive=!1)}prepareLayer(a){this.gpuTimingStart(a);const{unsupportedLayers:n}=this.transform.projection,_=!n||!n.includes(a.type);if(V_[a.type]&&(_||this.terrain&&a.type==="custom")){const c=this.style.getLayerSourceCache(a);V_[a.type](a,c,this)}this.gpuTimingEnd()}renderLayer(a,n,_,c){_.isHidden(this.transform.zoom)||(_.type==="background"||_.type==="sky"||_.type==="custom"||_.type==="model"||_.type==="raster"||_.type==="raster-particle"||c&&c.length)&&(this.id=_.id,this.gpuTimingStart(_),(!a.transform.projection.unsupportedLayers||!a.transform.projection.unsupportedLayers.includes(_.type)||a.terrain&&_.type==="custom")&&Yl[_.type](a,n,_,c,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(a){if(!this.options.gpuTiming)return;const n=this.context.extTimerQuery,_=this.context.gl;let c=this.gpuTimers[a.id];c||(c=this.gpuTimers[a.id]={calls:0,cpuTime:0,query:_.createQuery()}),c.calls++,_.beginQuery(n.TIME_ELAPSED_EXT,c.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const a=this.context.extTimerQuery,n=this.context.gl,_=n.createQuery();this.deferredRenderGpuTimeQueries.push(_),n.beginQuery(a.TIME_ELAPSED_EXT,_)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const a=this.gpuTimers;return this.gpuTimers={},a}collectDeferredRenderGpuQueries(){const a=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],a}queryGpuTimers(a){const n={};for(const _ in a){const c=a[_],f=this.context.extTimerQuery,g=f.getQueryParameter(c.query,this.context.gl.QUERY_RESULT)/1e6;f.deleteQueryEXT(c.query),n[_]=g}return n}queryGpuTimeDeferredRender(a){if(!this.options.gpuTimingDeferredRender)return 0;const n=this.context.extTimerQuery,_=this.context.gl;let c=0;for(const f of a)c+=n.getQueryParameter(f,_.QUERY_RESULT)/1e6,n.deleteQueryEXT(f);return c}translatePosMatrix(a,n,_,c,f){if(!_[0]&&!_[1])return a;const g=f?c==="map"?this.transform.angle:0:c==="viewport"?-this.transform.angle:0;if(g){const A=Math.sin(g),O=Math.cos(g);_=[_[0]*O-_[1]*A,_[0]*A+_[1]*O]}const b=[f?_[0]:s.a3(n,_[0],this.transform.zoom),f?_[1]:s.a3(n,_[1],this.transform.zoom),0],v=new Float32Array(16);return s.a6.translate(v,a,b),v}saveTileTexture(a){const n=a.size[0],_=this._tileTextures[n];_?_.push(a):this._tileTextures[n]=[a]}getTileTexture(a){const n=this._tileTextures[a];return n&&n.length>0?n.pop():null}isPatternMissing(a,n){return a===null||a!==void 0&&!this.imageManager.getPattern(a.toString(),n)}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(a,n,_){const c=_===void 0?this.terrain&&this.terrain.renderingToTexture:_,f=this.terrain&&this.terrain.exaggeration()===0,g=[];return this.style&&this.style.enable3dLights()&&(a==="globeRaster"||a==="terrainRaster"?(g.push("LIGHTING_3D_MODE"),g.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):c||g.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"?this._shadowMapDebug||g.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?g.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):g.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(g.push("TERRAIN"),this.linearFloatFilteringSupported()&&g.push("TERRAIN_DEM_FLOAT_FORMAT"),f&&g.push("ZERO_EXAGGERATION")),this.transform.projection.name==="globe"&&g.push("GLOBE"),!this._fogVisible||c||n!==void 0&&!n||g.push("FOG","FOG_DITHERING"),c&&g.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&g.push("OVERDRAW_INSPECTOR"),g}getOrCreateProgram(a,n){this.cache=this.cache||{};const _=n&&n.defines||[],c=n&&n.config,f=n&&n.transformFeedback,g=this.currentGlobalDefines(a,n&&n.overrideFog,n&&n.overrideRtt).concat(_),b=E_.cacheKey(f_[a],a,g,c);return this.cache[b]||(this.cache[b]=new E_(this.context,a,f_[a],c,Of[a],g,f)),this.cache[b]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const a=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(a.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(a,n){if(this.style.enable3dLights()){const _=this.style.directionalLight,c=this.style.ambientLight;if(_&&c){const f=((g,b)=>{const v=g.properties.get("direction"),A=g.properties.get("color").toArray01(),O=g.properties.get("intensity"),R=b.properties.get("color").toArray01(),P=b.properties.get("intensity"),N=[v.x,v.y,v.z],U=s.cn(R,P),B=s.cn(A,O);return{u_lighting_ambient_color:U,u_lighting_directional_dir:N,u_lighting_directional_color:B,u_ground_radiance:x_(N,B,U)}})(_,c);n.setLightsUniformValues(a,f)}}}uploadCommonUniforms(a,n,_,c,f){if(this.uploadCommonLightUniforms(a,n),this.terrain&&this.terrain.renderingToTexture)return;const g=this.style.fog;if(g){const b=g.getOpacity(this.transform.pitch),v=((A,O,R,P,N,U,B,k,M,H,$,V)=>{const Z=A.transform,z=O.properties.get("color").toArray01();z[3]=P;const X=A.frameCounter/1e3%1,[ie,ne]=O.properties.get("vertical-range");return{u_fog_matrix:R?Z.calculateFogTileMatrix(R):V||A.identityMat,u_fog_range:O.getFovAdjustedRange(Z._fov),u_fog_color:z,u_fog_horizon_blend:O.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(ie,ne),ne],u_fog_temporal_offset:X,u_frustum_tl:N,u_frustum_tr:U,u_frustum_br:B,u_frustum_bl:k,u_globe_pos:M,u_globe_radius:H,u_viewport:$,u_globe_transition:s.S(Z.zoom),u_is_globe:+(Z.projection.name==="globe")}})(this,g,_,b,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*s.f.devicePixelRatio,this.transform.height*s.f.devicePixelRatio],c);n.setFogUniformValues(a,v)}f&&n.setCutoffUniformValues(a,f.uniformValues)}setTileLoadedFlag(a){this.tileLoaded=a}saveCanvasCopy(){const a=this.canvasCopy();a&&(this.frameCopies.push(a),this.tileLoaded=!1)}canvasCopy(){const a=this.context.gl,n=a.createTexture();return a.bindTexture(a.TEXTURE_2D,n),a.copyTexImage2D(a.TEXTURE_2D,0,a.RGBA,0,0,a.drawingBufferWidth,a.drawingBufferHeight,0),n}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const a=this.style&&this.style.fog;return!!a&&a.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const a=this._backgroundTiles,n=this._backgroundTiles={},_=this.transform.coveringTiles({tileSize:512});for(const c of _)n[c.key]=a[c.key]||new Sn(c,512,this.transform.tileZoom,this);return n}clearBackgroundTiles(){this._backgroundTiles={}}layerUsedInConflation(a,n){return!(!a.is3D()||a.minzoom&&a.minzoom>this.transform.zoom||a.sourceLayer!=="building"&&(!n||n.type!=="batched-model"))}isTileAffectedByFog(a){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let n=this._cachedTileFogOpacities[a.key];return n||(this._cachedTileFogOpacities[a.key]=n=this.style.fog.getOpacityForTile(a)),n[0]>=Ai||n[1]>=Ai}}function Gl(d,a){let n=!1,_=null;const c=()=>{_=null,n&&(d(),_=setTimeout(c,a),n=!1)};return()=>(n=!0,_||c(),_)}class jr{constructor(a){this._hashName=a&&encodeURIComponent(a),s.aY(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Gl(this._updateHashUnthrottled.bind(this),300)}addTo(a){return this._map=a,window.addEventListener("hashchange",this._onHashChange,!1),a.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const a=this._map;if(!a)return"";const n=j_(a);if(this._hashName){const _=this._hashName;let c=!1;const f=location.hash.slice(1).split("&").map(g=>{const b=g.split("=")[0];return b===_?(c=!0,`${b}=${n}`):g}).filter(g=>g);return c||f.push(`${_}=${n}`),`#${f.join("&")}`}return`#${n}`}_getCurrentHash(){const a=location.hash.replace("#","");if(this._hashName){let n;return a.split("&").map(_=>_.split("=")).forEach(_=>{_[0]===this._hashName&&(n=_)}),(n&&n[1]||"").split("/")}return a.split("/")}_onHashChange(){const a=this._map;if(!a)return!1;const n=this._getCurrentHash();if(n.length>=3&&!n.some(_=>isNaN(_))){const _=a.dragRotate.isEnabled()&&a.touchZoomRotate.isEnabled()?+(n[3]||0):a.getBearing();return a.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:_,pitch:+(n[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function j_(d,a){const n=d.getCenter(),_=Math.round(100*d.getZoom())/100,c=Math.ceil((_*Math.LN2+Math.log(512/360/.5))/Math.LN10),f=Math.pow(10,c),g=Math.round(n.lng*f)/f,b=Math.round(n.lat*f)/f,v=d.getBearing(),A=d.getPitch();let O=a?`/${g}/${b}/${_}`:`${_}/${b}/${g}`;return(v||A)&&(O+="/"+Math.round(10*v)/10),A&&(O+=`/${Math.round(A)}`),O}const Vl={linearity:.3,easing:s.c_(0,0,.3,1)},oo=s.e({deceleration:2500,maxSpeed:1400},Vl),Lf=s.e({deceleration:20,maxSpeed:1400},Vl),Kr=s.e({deceleration:1e3,maxSpeed:360},Vl),Yi=s.e({deceleration:1e3,maxSpeed:90},Vl);class Ii{constructor(a){this._map=a,this.clear()}clear(){this._inertiaBuffer=[]}record(a){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.f.now(),settings:a})}_drainInertiaBuffer(){const a=this._inertiaBuffer,n=s.f.now();for(;a.length>0&&n-a[0].time>160;)a.shift()}_onMoveEnd(a){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const n={zoom:0,bearing:0,pitch:0,pan:new s.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:f}of this._inertiaBuffer)n.zoom+=f.zoomDelta||0,n.bearing+=f.bearingDelta||0,n.pitch+=f.pitchDelta||0,f.panDelta&&n.pan._add(f.panDelta),f.around&&(n.around=f.around),f.pinchAround&&(n.pinchAround=f.pinchAround);const _=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,c={};if(n.pan.mag()){const f=ko(n.pan.mag(),_,s.e({},oo,a||{}));c.offset=n.pan.mult(f.amount/n.pan.mag()),c.center=this._map.transform.center,jl(c,f)}if(n.zoom){const f=ko(n.zoom,_,Lf);c.zoom=this._map.transform.zoom+f.amount,jl(c,f)}if(n.bearing){const f=ko(n.bearing,_,Kr);c.bearing=this._map.transform.bearing+s.aa(f.amount,-179,179),jl(c,f)}if(n.pitch){const f=ko(n.pitch,_,Yi);c.pitch=this._map.transform.pitch+f.amount,jl(c,f)}if(c.zoom||c.bearing){const f=n.pinchAround===void 0?n.around:n.pinchAround;c.around=f?this._map.unproject(f):this._map.getCenter()}return this.clear(),c.noMoveStart=!0,c}}function jl(d,a){(!d.duration||d.duration<a.duration)&&(d.duration=a.duration,d.easing=a.easing)}function ko(d,a,n){const{maxSpeed:_,linearity:c,deceleration:f}=n,g=s.aa(d*c/(a/1e3),-_,_),b=Math.abs(g)/(f*c);return{easing:n.easing,duration:1e3*b,amount:g*(b/2)}}class $a extends s.b{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,n,_,c={}){const f=ai(n.getCanvasContainer(),_),g=n.unproject(f);super(a,s.e({point:f,lngLat:g,originalEvent:_},c)),this._defaultPrevented=!1,this.target=n}}class dn extends s.b{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,n,_){const c=a==="touchend"?_.changedTouches:_.touches,f=Oi(n.getCanvasContainer(),c),g=f.map(v=>n.unproject(v)),b=f.reduce((v,A,O,R)=>v.add(A.div(R.length)),new s.P(0,0));super(a,{points:f,point:b,lngLats:g,lngLat:n.unproject(b),originalEvent:_}),this._defaultPrevented=!1}}class K_ extends s.b{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,n,_){super(a,{originalEvent:_}),this._defaultPrevented=!1}}class q_{constructor(a,n){this._map=a,this._clickTolerance=n.clickTolerance}reset(){this._mousedownPos=void 0}wheel(a){return this._firePreventable(new K_(a.type,this._map,a))}mousedown(a,n){return this._mousedownPos=n,this._firePreventable(new $a(a.type,this._map,a))}mouseup(a){this._map.fire(new $a(a.type,this._map,a))}preclick(a){const n=s.e({},a);n.type="preclick",this._map.fire(new $a(n.type,this._map,n))}click(a,n){this._mousedownPos&&this._mousedownPos.dist(n)>=this._clickTolerance||(this.preclick(a),this._map.fire(new $a(a.type,this._map,a)))}dblclick(a){return this._firePreventable(new $a(a.type,this._map,a))}mouseover(a){this._map.fire(new $a(a.type,this._map,a))}mouseout(a){this._map.fire(new $a(a.type,this._map,a))}touchstart(a){return this._firePreventable(new dn(a.type,this._map,a))}touchmove(a){this._map.fire(new dn(a.type,this._map,a))}touchend(a){this._map.fire(new dn(a.type,this._map,a))}touchcancel(a){this._map.fire(new dn(a.type,this._map,a))}_firePreventable(a){if(this._map.fire(a),a.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class kn{constructor(a){this._map=a}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(a){this._map.fire(new $a(a.type,this._map,a))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new $a("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(a){this._delayContextMenu?this._contextMenuEvent=a:this._map.fire(new $a(a.type,this._map,a)),this._map.listens("contextmenu")&&a.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class zn{constructor(a,n){this._map=a,this._el=a.getCanvasContainer(),this._container=a.getContainer(),this._clickTolerance=n.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(a,n){this.isEnabled()&&a.shiftKey&&a.button===0&&(ut(),this._startPos=this._lastPos=n,this._active=!0)}mousemoveWindow(a,n){if(!this._active)return;const _=n,c=this._startPos,f=this._lastPos;if(!c||!f||f.equals(_)||!this._box&&_.dist(c)<this._clickTolerance)return;this._lastPos=_,this._box||(this._box=Ce("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",a));const g=Math.min(c.x,_.x),b=Math.max(c.x,_.x),v=Math.min(c.y,_.y),A=Math.max(c.y,_.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${g}px,${v}px)`,this._box.style.width=b-g+"px",this._box.style.height=A-v+"px")})}mouseupWindow(a,n){if(!this._active)return;const _=this._startPos,c=n;if(_&&a.button===0){if(this.reset(),Fi(),_.x!==c.x||_.y!==c.y)return this._map.fire(new s.b("boxzoomend",{originalEvent:a})),{cameraAnimation:f=>f.fitScreenCoordinates(_,c,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",a)}}keydown(a){this._active&&a.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",a))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),bt(),delete this._startPos,delete this._lastPos}_fireEvent(a,n){return this._map.fire(new s.b(a,{originalEvent:n}))}}function $s(d,a){const n={};for(let _=0;_<d.length;_++)n[d[_].identifier]=a[_];return n}class qr{constructor(a){this.reset(),this.numTouches=a.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(a,n,_){(this.centroid||_.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=a.timeStamp),_.length===this.numTouches&&(this.centroid=function(c){const f=new s.P(0,0);for(const g of c)f._add(g);return f.div(c.length)}(n),this.touches=$s(_,n)))}touchmove(a,n,_){if(this.aborted||!this.centroid)return;const c=$s(_,n);for(const f in this.touches){const g=c[f];(!g||g.dist(this.touches[f])>30)&&(this.aborted=!0)}}touchend(a,n,_){if((!this.centroid||a.timeStamp-this.startTime>500)&&(this.aborted=!0),_.length===0){const c=!this.aborted&&this.centroid;if(this.reset(),c)return c}}}class Kl{constructor(a){this.singleTap=new qr(a),this.numTaps=a.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(a,n,_){this.singleTap.touchstart(a,n,_)}touchmove(a,n,_){this.singleTap.touchmove(a,n,_)}touchend(a,n,_){const c=this.singleTap.touchend(a,n,_);if(c){const f=a.timeStamp-this.lastTime<500,g=!this.lastTap||this.lastTap.dist(c)<30;if(f&&g||this.reset(),this.count++,this.lastTime=a.timeStamp,this.lastTap=c,this.count===this.numTaps)return this.reset(),c}}}class $_{constructor(){this._zoomIn=new Kl({numTouches:1,numTaps:2}),this._zoomOut=new Kl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(a,n,_){this._zoomIn.touchstart(a,n,_),this._zoomOut.touchstart(a,n,_)}touchmove(a,n,_){this._zoomIn.touchmove(a,n,_),this._zoomOut.touchmove(a,n,_)}touchend(a,n,_){const c=this._zoomIn.touchend(a,n,_),f=this._zoomOut.touchend(a,n,_);return c?(this._active=!0,a.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:g=>g.easeTo({duration:300,zoom:g.getZoom()+1,around:g.unproject(c)},{originalEvent:a})}):f?(this._active=!0,a.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:g=>g.easeTo({duration:300,zoom:g.getZoom()-1,around:g.unproject(f)},{originalEvent:a})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Z_={0:1,2:2};class $o{constructor(a){this.reset(),this._clickTolerance=a.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(a,n){return!1}_move(a,n){return{}}mousedown(a,n){if(this._lastPoint)return;const _=va(a);this._correctButton(a,_)&&(this._lastPoint=n,this._eventButton=_)}mousemoveWindow(a,n){const _=this._lastPoint;if(_){if(a.preventDefault(),this._eventButton!=null&&function(c,f){const g=Z_[f];return c.buttons===void 0||(c.buttons&g)!==g}(a,this._eventButton))this.reset();else if(this._moved||!(n.dist(_)<this._clickTolerance))return this._moved=!0,this._lastPoint=n,this._move(_,n)}}mouseupWindow(a){this._lastPoint&&va(a)===this._eventButton&&(this._moved&&Fi(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class X_ extends $o{mousedown(a,n){super.mousedown(a,n),this._lastPoint&&(this._active=!0)}_correctButton(a,n){return n===0&&!a.ctrlKey}_move(a,n){return{around:n,panDelta:n.sub(a)}}}class ql extends $o{_correctButton(a,n){return n===0&&a.ctrlKey||n===2}_move(a,n){const _=.8*(n.x-a.x);if(_)return this._active=!0,{bearingDelta:_}}contextmenu(a){a.preventDefault()}}class $r extends $o{_correctButton(a,n){return n===0&&a.ctrlKey||n===2}_move(a,n){const _=-.5*(n.y-a.y);if(_)return this._active=!0,{pitchDelta:_}}contextmenu(a){a.preventDefault()}}class J_{constructor(a,n){this._map=a,this._el=a.getCanvasContainer(),this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset(),s.aY(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.P(0,0)}touchstart(a,n,_){return this._calculateTransform(a,n,_)}touchmove(a,n,_){if(this._active&&!(_.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(_.length===1&&!s.c$())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return a.cancelable&&a.preventDefault(),this._calculateTransform(a,n,_)}}touchend(a,n,_){this._calculateTransform(a,n,_),this._active&&_.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(a,n,_){_.length>0&&(this._active=!0);const c=$s(_,n),f=new s.P(0,0),g=new s.P(0,0);let b=0;for(const A in c){const O=c[A],R=this._touches[A];R&&(f._add(O),g._add(O.sub(R)),b++,c[A]=O)}if(this._touches=c,b<this._minTouches||!g.mag())return;const v=g.div(b);return this._sum._add(v),this._sum.mag()<this._clickTolerance?void 0:{around:f.div(b),panDelta:v}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Ce("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Ia{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(a){}_move(a,n,_){return{}}touchstart(a,n,_){this._firstTwoTouches||_.length<2||(this._firstTwoTouches=[_[0].identifier,_[1].identifier],this._start([n[0],n[1]]))}touchmove(a,n,_){const c=this._firstTwoTouches;if(!c)return;a.preventDefault();const[f,g]=c,b=Zs(_,n,f),v=Zs(_,n,g);if(!b||!v)return;const A=this._aroundCenter?null:b.add(v).div(2);return this._move([b,v],A,a)}touchend(a,n,_){if(!this._firstTwoTouches)return;const[c,f]=this._firstTwoTouches,g=Zs(_,n,c),b=Zs(_,n,f);g&&b||(this._active&&Fi(),this.reset())}touchcancel(){this.reset()}enable(a){this._enabled=!0,this._aroundCenter=!!a&&a.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Zs(d,a,n){for(let _=0;_<d.length;_++)if(d[_].identifier===n)return a[_]}function Zr(d,a){return Math.log(d/a)/Math.LN2}class $l extends Ia{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(a){this._startDistance=this._distance=a[0].dist(a[1])}_move(a,n){const _=this._distance;if(this._distance=a[0].dist(a[1]),this._active||!(Math.abs(Zr(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Zr(this._distance,_),pinchAround:n}}}function Hn(d,a){return 180*d.angleWith(a)/Math.PI}class Q_ extends Ia{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(a){this._startVector=this._vector=a[0].sub(a[1]),this._minDiameter=a[0].dist(a[1])}_move(a,n){const _=this._vector;if(this._vector=a[0].sub(a[1]),_&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Hn(this._vector,_),pinchAround:n}}_isBelowThreshold(a){this._minDiameter=Math.min(this._minDiameter,a.mag());const n=25/(Math.PI*this._minDiameter)*360,_=this._startVector;if(!_)return!1;const c=Hn(a,_);return Math.abs(c)<n}}function Zl(d){return Math.abs(d.y)>Math.abs(d.x)}class eu extends Ia{constructor(a){super(),this._map=a}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(a){this._lastPoints=a,Zl(a[0].sub(a[1]))&&(this._valid=!1)}_move(a,n,_){const c=this._lastPoints;if(!c)return;const f=a[0].sub(c[0]),g=a[1].sub(c[1]);return this._map._cooperativeGestures&&!s.c$()&&_.touches.length<3||(this._valid=this.gestureBeginsVertically(f,g,_.timeStamp),!this._valid)?void 0:(this._lastPoints=a,this._active=!0,{pitchDelta:(f.y+g.y)/2*-.5})}gestureBeginsVertically(a,n,_){if(this._valid!==void 0)return this._valid;const c=a.mag()>=2,f=n.mag()>=2;if(!c&&!f)return;if(!c||!f)return this._firstMove==null&&(this._firstMove=_),_-this._firstMove<100&&void 0;const g=a.y>0==n.y>0;return Zl(a)&&Zl(n)&&g}}const fs={panStep:100,bearingStep:15,pitchStep:10};class Xl{constructor(){const a=fs;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(a){if(a.altKey||a.ctrlKey||a.metaKey)return;let n=0,_=0,c=0,f=0,g=0;switch(a.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:a.shiftKey?_=-1:(a.preventDefault(),f=-1);break;case 39:a.shiftKey?_=1:(a.preventDefault(),f=1);break;case 38:a.shiftKey?c=1:(a.preventDefault(),g=-1);break;case 40:a.shiftKey?c=-1:(a.preventDefault(),g=1);break;default:return}return this._rotationDisabled&&(_=0,c=0),{cameraAnimation:b=>{const v=b.getZoom();b.easeTo({duration:300,easeId:"keyboardHandler",easing:tu,zoom:n?Math.round(v)+n*(a.shiftKey?2:1):v,bearing:b.getBearing()+_*this._bearingStep,pitch:b.getPitch()+c*this._pitchStep,offset:[-f*this._panStep,-g*this._panStep],center:b.getCenter()},{originalEvent:a})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function tu(d){return d*(2-d)}const Jl=4.000244140625,iu=1/450;class Ic{constructor(a,n){this._map=a,this._el=a.getCanvasContainer(),this._handler=n,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=iu,s.aY(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(a){this._defaultZoomRate=a}setWheelZoomRate(a){this._wheelZoomRate=a}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(a){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!a&&a.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(a){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(a.ctrlKey||a.metaKey||this.isZooming()||s.c$()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let n=a.deltaMode===WheelEvent.DOM_DELTA_LINE?40*a.deltaY:a.deltaY;const _=s.f.now(),c=_-(this._lastWheelEventTime||0);this._lastWheelEventTime=_,n!==0&&n%Jl==0?this._type="wheel":n!==0&&Math.abs(n)<4?this._type="trackpad":c>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,a)):this._type||(this._type=Math.abs(c*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),a.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=a,this._delta-=n,this._active||this._start(a)),a.preventDefault()}_onTimeout(a){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(a)}_start(a){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const n=ai(this._el,a);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:n,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const a=this._map.transform;this._type==="wheel"&&a.projection.wrap&&(a._center.lng>=180||a._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const n=()=>a._terrainEnabled()&&this._aroundCoord?a.computeZoomRelativeTo(this._aroundCoord):a.zoom;if(this._delta!==0){const A=this._type==="wheel"&&Math.abs(this._delta)>Jl?this._wheelZoomRate:this._defaultZoomRate;let O=2/(1+Math.exp(-Math.abs(this._delta*A)));this._delta<0&&O!==0&&(O=1/O);const R=n(),P=Math.pow(2,R),N=typeof this._targetZoom=="number"?a.zoomScale(this._targetZoom):P;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(N*O))),this._type==="wheel"&&(this._startZoom=R,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const _=typeof this._targetZoom=="number"?this._targetZoom:n(),c=this._startZoom,f=this._easing;let g,b=!1;if(this._type==="wheel"&&c&&f){const A=Math.min((s.f.now()-this._lastWheelEventTime)/200,1),O=f(A);g=s.U(c,_,O),A<1?this._frameId||(this._frameId=!0):b=!0}else g=_,b=!0;this._active=!0,b&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let v=g-n();return v*this._lastDelta<0&&(v=0),{noInertia:!0,needsRenderFrame:!b,zoomDelta:v,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(a){let n=s.d0;if(this._prevEase){const _=this._prevEase,c=(s.f.now()-_.start)/_.duration,f=_.easing(c+.01)-_.easing(c),g=.27/Math.sqrt(f*f+1e-4)*.01,b=Math.sqrt(.0729-g*g);n=s.c_(g,b,.25,1)}return this._prevEase={start:s.f.now(),duration:a,easing:n},n}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Ce("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class Oc{constructor(a,n){this._clickZoom=a,this._tapZoom=n}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Sc{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(a,n){return a.preventDefault(),{cameraAnimation:_=>{_.easeTo({duration:300,zoom:_.getZoom()+(a.shiftKey?-1:1),around:_.unproject(n)},{originalEvent:a})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Rc{constructor(){this._tap=new Kl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(a,n,_){this._swipePoint||(this._tapTime&&a.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?_.length>0&&(this._swipePoint=n[0],this._swipeTouch=_[0].identifier):this._tap.touchstart(a,n,_))}touchmove(a,n,_){if(this._tapTime){if(this._swipePoint){if(_[0].identifier!==this._swipeTouch)return;const c=n[0],f=c.y-this._swipePoint.y;return this._swipePoint=c,a.preventDefault(),this._active=!0,{zoomDelta:f/128}}}else this._tap.touchmove(a,n,_)}touchend(a,n,_){this._tapTime?this._swipePoint&&_.length===0&&this.reset():this._tap.touchend(a,n,_)&&(this._tapTime=a.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Cc{constructor(a,n,_){this._el=a,this._mousePan=n,this._touchPan=_}enable(a){this._inertiaOptions=a||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class wc{constructor(a,n,_){this._pitchWithRotate=a.pitchWithRotate,this._mouseRotate=n,this._mousePitch=_}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Pc{constructor(a,n,_,c){this._el=a,this._touchZoom=n,this._touchRotate=_,this._tapDragZoom=c,this._rotationDisabled=!1,this._enabled=!0}enable(a){this._touchZoom.enable(a),this._rotationDisabled||this._touchRotate.enable(a),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Ql=d=>d.zoom||d.drag||d.pitch||d.rotate;class Lc extends s.b{}class Nc{constructor(){this.constants=[1,1,.01],this.radius=0}setup(a,n){const _=s.N.sub([],n,a);this.radius=s.N.length(_[2]<0?s.N.div([],_,this.constants):[_[0],_[1],0])}projectRay(a){s.N.div(a,a,this.constants),s.N.normalize(a,a),s.N.mul(a,a,this.constants);const n=s.N.scale([],a,this.radius);if(n[2]>0){const _=s.N.scale([],[0,0,1],s.N.dot(n,[0,0,1])),c=s.N.scale([],s.N.normalize([],[n[0],n[1],0]),this.radius),f=s.N.add([],n,s.N.scale([],s.N.sub([],s.N.add([],c,_),n),2));n[0]=f[0],n[1]=f[1]}return n}}function er(d){return d.panDelta&&d.panDelta.mag()||d.zoomDelta||d.bearingDelta||d.pitchDelta}class Nf{constructor(a,n){this._map=a,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ii(a),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Nc,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(n),s.aY(["handleEvent","handleWindowEvent"],this);const _=this._el;this._listeners=[[_,"touchstart",{passive:!0}],[_,"touchmove",{passive:!1}],[_,"touchend",void 0],[_,"touchcancel",void 0],[_,"mousedown",void 0],[_,"mousemove",void 0],[_,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[_,"mouseover",void 0],[_,"mouseout",void 0],[_,"dblclick",void 0],[_,"click",void 0],[_,"keydown",{capture:!1}],[_,"keyup",void 0],[_,"wheel",{passive:!1}],[_,"contextmenu",void 0],[window,"blur",void 0]];for(const[c,f,g]of this._listeners){const b=c===document?this.handleWindowEvent:this.handleEvent;c.addEventListener(f,b,g)}}destroy(){for(const[a,n,_]of this._listeners){const c=a===document?this.handleWindowEvent:this.handleEvent;a.removeEventListener(n,c,_)}}_addDefaultHandlers(a){const n=this._map,_=n.getCanvasContainer();this._add("mapEvent",new q_(n,a));const c=n.boxZoom=new zn(n,a);this._add("boxZoom",c);const f=new $_,g=new Sc;n.doubleClickZoom=new Oc(g,f),this._add("tapZoom",f),this._add("clickZoom",g);const b=new Rc;this._add("tapDragZoom",b);const v=n.touchPitch=new eu(n);this._add("touchPitch",v);const A=new ql(a),O=new $r(a);n.dragRotate=new wc(a,A,O),this._add("mouseRotate",A,["mousePitch"]),this._add("mousePitch",O,["mouseRotate"]);const R=new X_(a),P=new J_(n,a);n.dragPan=new Cc(_,R,P),this._add("mousePan",R),this._add("touchPan",P,["touchZoom","touchRotate"]);const N=new Q_,U=new $l;n.touchZoomRotate=new Pc(_,U,N,b),this._add("touchRotate",N,["touchPan","touchZoom"]),this._add("touchZoom",U,["touchPan","touchRotate"]),this._add("blockableMapEvent",new kn(n));const B=n.scrollZoom=new Ic(n,this);this._add("scrollZoom",B,["mousePan"]);const k=n.keyboard=new Xl;this._add("keyboard",k);for(const M of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])a.interactive&&a[M]&&n[M].enable(a[M])}_add(a,n,_){this._handlers.push({handlerName:a,handler:n,allowed:_}),this._handlersById[a]=n}stop(a){if(!this._updatingCamera){for(const{handler:n}of this._handlers)n.reset();this._inertia.clear(),this._fireEvents({},{},a),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:a}of this._handlers)if(a.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ql(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(a,n,_){for(const c in a)if(c!==_&&(!n||n.indexOf(c)<0))return!0;return!1}handleWindowEvent(a){this.handleEvent(a,`${a.type}Window`)}_getMapTouches(a){const n=[];for(const _ of a)this._el.contains(_.target)&&n.push(_);return n}handleEvent(a,n){this._updatingCamera=!0;const _=a.type==="renderFrame",c=_?void 0:a,f={needsRenderFrame:!1},g={},b={},v=a.touches?this._getMapTouches(a.touches):void 0,A=v?Oi(this._el,v):_?void 0:ai(this._el,a);for(const{handlerName:P,handler:N,allowed:U}of this._handlers){if(!N.isEnabled())continue;let B;this._blockedByActive(b,U,P)?N.reset():N[n||a.type]&&(B=N[n||a.type](a,A,v),this.mergeHandlerResult(f,g,B,P,c),B&&B.needsRenderFrame&&this._triggerRenderFrame()),(B||N.isActive())&&(b[P]=N)}const O={};for(const P in this._previousActiveHandlers)b[P]||(O[P]=c);this._previousActiveHandlers=b,(Object.keys(O).length||er(f))&&(this._changes.push([f,g,O]),this._triggerRenderFrame()),(Object.keys(b).length||er(f))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:R}=f;R&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],R(this._map))}mergeHandlerResult(a,n,_,c,f){if(!_)return;s.e(a,_);const g={handlerName:c,originalEvent:_.originalEvent||f};_.zoomDelta!==void 0&&(n.zoom=g),_.panDelta!==void 0&&(n.drag=g),_.pitchDelta!==void 0&&(n.pitch=g),_.bearingDelta!==void 0&&(n.rotate=g)}_applyChanges(){const a={},n={},_={};for(const[c,f,g]of this._changes)c.panDelta&&(a.panDelta=(a.panDelta||new s.P(0,0))._add(c.panDelta)),c.zoomDelta&&(a.zoomDelta=(a.zoomDelta||0)+c.zoomDelta),c.bearingDelta&&(a.bearingDelta=(a.bearingDelta||0)+c.bearingDelta),c.pitchDelta&&(a.pitchDelta=(a.pitchDelta||0)+c.pitchDelta),c.around!==void 0&&(a.around=c.around),c.aroundCoord!==void 0&&(a.aroundCoord=c.aroundCoord),c.pinchAround!==void 0&&(a.pinchAround=c.pinchAround),c.noInertia&&(a.noInertia=c.noInertia),s.e(n,f),s.e(_,g);this._updateMapTransform(a,n,_),this._changes=[]}_updateMapTransform(a,n,_){const c=this._map,f=c.transform,g=H=>[H.x,H.y,H.z];if((H=>{const $=this._eventsInProgress.drag;return $&&!this._handlersById[$.handlerName].isActive()})()&&!er(a)){const H=f.zoom;f.cameraElevationReference="sea",this._originalZoom!=null&&f._orthographicProjectionAtLowPitch&&f.projection.name!=="globe"&&f.pitch===0?(f.cameraElevationReference="ground",f.zoom=this._originalZoom):(f.recenterOnTerrain(),f.cameraElevationReference="ground"),H!==f.zoom&&this._map._update(!0)}if(f._isCameraConstrained&&c._stop(!0),!er(a))return void this._fireEvents(n,_,!0);let{panDelta:b,zoomDelta:v,bearingDelta:A,pitchDelta:O,around:R,aroundCoord:P,pinchAround:N}=a;f._isCameraConstrained&&(v>0&&(v=0),f._isCameraConstrained=!1),N!==void 0&&(R=N),(v||(H=>n[H]&&!this._eventsInProgress[H])("drag"))&&R&&(this._dragOrigin=g(f.pointCoordinate3D(R)),this._originalZoom=f.zoom,this._trackingEllipsoid.setup(f._camera.position,this._dragOrigin)),f.cameraElevationReference="sea",c._stop(!0),R=R||c.transform.centerPoint,A&&(f.bearing+=A),O&&(f.pitch+=O),f._updateCameraState();const U=[0,0,0];if(b)if(f.projection.name==="mercator"){const H=this._trackingEllipsoid.projectRay(f.screenPointToMercatorRay(R).dir),$=this._trackingEllipsoid.projectRay(f.screenPointToMercatorRay(R.sub(b)).dir);U[0]=$[0]-H[0],U[1]=$[1]-H[1]}else{const H=f.pointCoordinate(R);if(f.projection.name==="globe"){b=b.rotate(-f.angle);const $=f._pixelsPerMercatorPixel/f.worldSize;U[0]=-b.x*s.d1(s.au(H.y))*$,U[1]=-b.y*s.d1(f.center.lat)*$}else{const $=f.pointCoordinate(R.sub(b));H&&$&&(U[0]=$.x-H.x,U[1]=$.y-H.y)}}const B=f.zoom,k=[0,0,0];if(v){const H=g(P||f.pointCoordinate3D(R)),$={dir:s.N.normalize([],s.N.sub([],H,f._camera.position))};if($.dir[2]<0){const V=f.zoomDeltaToMovement(H,v);s.N.scale(k,$.dir,V)}}const M=s.N.add(U,U,k);f._translateCameraConstrained(M),v&&Math.abs(f.zoom-B)>1e-4&&f.recenterOnTerrain(),f.cameraElevationReference="ground",this._map._update(),a.noInertia||this._inertia.record(a),this._fireEvents(n,_,!0)}_fireEvents(a,n,_){const c=Ql(this._eventsInProgress),f=Ql(a),g={};for(const O in a){const{originalEvent:R}=a[O];this._eventsInProgress[O]||(g[`${O}start`]=R),this._eventsInProgress[O]=a[O]}!c&&f&&this._fireEvent("movestart",f.originalEvent);for(const O in g)this._fireEvent(O,g[O]);f&&this._fireEvent("move",f.originalEvent);for(const O in a){const{originalEvent:R}=a[O];this._fireEvent(O,R)}const b={};let v;for(const O in this._eventsInProgress){const{handlerName:R,originalEvent:P}=this._eventsInProgress[O];this._handlersById[R].isActive()||(delete this._eventsInProgress[O],v=n[R]||P,b[`${O}end`]=v)}for(const O in b)this._fireEvent(O,b[O]);const A=Ql(this._eventsInProgress);if(_&&(c||f)&&!A){this._updatingCamera=!0;const O=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),R=P=>P!==0&&-this._bearingSnap<P&&P<this._bearingSnap;O?(R(O.bearing||this._map.getBearing())&&(O.bearing=0),this._map.easeTo(O,{originalEvent:v})):(this._map.fire(new s.b("moveend",{originalEvent:v})),R(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(a,n){this._map.fire(new s.b(a,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(a=>{this._frameId=void 0,this.handleEvent(new Lc("renderFrame",{timeStamp:a})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Wc="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class ia extends s.E{constructor(a,n){super(),this._moving=!1,this._zooming=!1,this.transform=a,this._bearingSnap=n.bearingSnap,this._respectPrefersReducedMotion=n.respectPrefersReducedMotion!==!1,s.aY(["_renderFrameCallback"],this)}getCenter(){return new s.bn(this.transform.center.lng,this.transform.center.lat)}setCenter(a,n){return this.jumpTo({center:a},n)}panBy(a,n,_){return a=s.P.convert(a).mult(-1),this.panTo(this.transform.center,s.e({offset:a},n),_)}panTo(a,n,_){return this.easeTo(s.e({center:a},n),_)}getZoom(){return this.transform.zoom}setZoom(a,n){return this.jumpTo({zoom:a},n),this}zoomTo(a,n,_){return this.easeTo(s.e({zoom:a},n),_)}zoomIn(a,n){return this.zoomTo(this.getZoom()+1,a,n),this}zoomOut(a,n){return this.zoomTo(this.getZoom()-1,a,n),this}getBearing(){return this.transform.bearing}setBearing(a,n){return this.jumpTo({bearing:a},n),this}getPadding(){return this.transform.padding}setPadding(a,n){return this.jumpTo({padding:a},n),this}rotateTo(a,n,_){return this.easeTo(s.e({bearing:a},n),_)}resetNorth(a,n){return this.rotateTo(0,s.e({duration:1e3},a),n),this}resetNorthPitch(a,n){return this.easeTo(s.e({bearing:0,pitch:0,duration:1e3},a),n),this}snapToNorth(a,n){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(a,n):this}getPitch(){return this.transform.pitch}setPitch(a,n){return this.jumpTo({pitch:a},n),this}cameraForBounds(a,n){a=s.ad.convert(a);const _=n&&n.bearing||0,c=n&&n.pitch||0,f=a.getNorthWest(),g=a.getSouthEast();return this._cameraForBounds(this.transform,f,g,_,c,n)}_extendCameraOptions(a){const n={top:0,bottom:0,right:0,left:0};if(typeof(a=s.e({padding:n,offset:[0,0],maxZoom:this.transform.maxZoom},a)).padding=="number"){const _=a.padding;a.padding={top:_,bottom:_,right:_,left:_}}return a.padding=s.e(n,a.padding),a}_minimumAABBFrustumDistance(a,n){const _=n.max[0]-n.min[0],c=n.max[1]-n.min[1];return _/c>a.aspect?_/(2*Math.tan(.5*a.fovX)*a.aspect):c/(2*Math.tan(.5*a.fovY)*a.aspect)}_cameraForBoundsOnGlobe(a,n,_,c,f,g){const b=a.clone(),v=this._extendCameraOptions(g);b.bearing=c,b.pitch=f;const A=s.bn.convert(n),O=s.bn.convert(_),R=.5*(A.lat+O.lat),P=.5*(A.lng+O.lng),N=s.d2(R,P),U=s.N.normalize([],N),B=s.N.normalize([],s.N.cross([],U,[0,1,0])),k=s.N.cross([],B,U),M=[B[0],B[1],B[2],0,k[0],k[1],k[2],0,U[0],U[1],U[2],0,0,0,0,1],H=[N,s.d2(A.lat,A.lng),s.d2(O.lat,A.lng),s.d2(O.lat,O.lng),s.d2(A.lat,O.lng),s.d2(R,A.lng),s.d2(R,O.lng),s.d2(A.lat,P),s.d2(O.lat,P)];let $=s.bS.fromPoints(H.map(pe=>[s.N.dot(B,pe),s.N.dot(k,pe),s.N.dot(U,pe)]));const V=s.N.transformMat4([],$.center,M);s.N.squaredLength(V)===0&&s.N.set(V,0,0,1),s.N.normalize(V,V),s.N.scale(V,V,s.ab),b.center=s.d3(V);const Z=b.getWorldToCameraMatrix(),z=s.a6.invert(new Float64Array(16),Z);$=s.bS.applyTransform($,s.a6.multiply([],Z,M)),s.N.transformMat4(V,V,Z);const X=.5*($.max[2]-$.min[2]),ie=this._minimumAABBFrustumDistance(b,$),ne=s.N.scale([],[0,0,1],X),re=s.N.add(ne,V,ne),ye=ie+(b.pitch===0?0:s.N.distance(V,re)),ue=b.globeCenterInViewSpace,Ie=s.N.sub([],V,[ue[0],ue[1],ue[2]]);s.N.normalize(Ie,Ie),s.N.scale(Ie,Ie,ye);const Ee=s.N.add([],V,Ie);s.N.transformMat4(Ee,Ee,z);const Ue=s.d4/s.ab,ce=s.N.length(Ee),Te=s.bl(Math.max(ce*Ue-s.d4,Number.EPSILON),0),le=Math.min(b.zoomFromMercatorZAdjusted(Te),v.maxZoom);return le>.5*(s.bG+s.bx)?(b.setProjection({name:"mercator"}),b.zoom=le,this._cameraForBounds(b,n,_,c,f,g)):{center:b.center,zoom:le,bearing:c,pitch:f}}queryTerrainElevation(a,n){const _=this.transform.elevation;return _?(n=s.e({},{exaggerated:!0},n),_.getAtPoint(s.L.fromLngLat(a),null,n.exaggerated)):null}_cameraForBounds(a,n,_,c,f,g){if(a.projection.name==="globe")return this._cameraForBoundsOnGlobe(a,n,_,c,f,g);const b=a.clone(),v=this._extendCameraOptions(g),A=b.padding;b.bearing=c,b.pitch=f;const O=s.bn.convert(n),R=s.bn.convert(_),P=new s.bn(O.lng,R.lat),N=new s.bn(R.lng,O.lat),U=b.project(O),B=b.project(R),k=this.queryTerrainElevation(O),M=this.queryTerrainElevation(R),H=this.queryTerrainElevation(P),$=this.queryTerrainElevation(N),V=[[U.x,U.y,Math.min(k||0,M||0,H||0,$||0)],[B.x,B.y,Math.max(k||0,M||0,H||0,$||0)]];let Z=s.bS.fromPoints(V);const z=b.getWorldToCameraMatrix(),X=s.a6.invert(new Float64Array(16),z);Z=s.bS.applyTransform(Z,z);const ie=s.N.sub([],Z.max,Z.min),ne=A.left||0,re=A.right||0,ye=A.bottom||0,ue=A.top||0,{left:Ie,right:Ee,top:Ue,bottom:ce}=v.padding,Te=.5*(ne+re),le=.5*(ue+ye),pe=Math.min(b.scaleZoom(b.scale*Math.min((b.width-(ne+re+Ie+Ee))/ie[0],(b.height-(ye+ue+ce+Ue))/ie[1])),v.maxZoom),ke=b.scale/b.zoomScale(pe);Z=new s.bS([Z.min[0]-(Ie+Te)*ke,Z.min[1]-(ce+le)*ke,Z.min[2]],[Z.max[0]+(Ee+Te)*ke,Z.max[1]+(Ue+le)*ke,Z.max[2]]);const $e=.5*ie[2],je=this._minimumAABBFrustumDistance(b,Z),it=[0,0,1,0];s.a7.transformMat4(it,it,z),s.a7.normalize(it,it);const ht=s.N.scale([],it,je+$e),St=s.N.add([],Z.center,ht),xt=(typeof v.offset.x=="number"&&typeof v.offset.y=="number"?new s.P(v.offset.x,v.offset.y):s.P.convert(v.offset)).rotate(-s.bj(c));Z.center[0]-=xt.x*ke,Z.center[1]+=xt.y*ke,s.N.transformMat4(Z.center,Z.center,X),s.N.transformMat4(St,St,X);const At=[Z.center[0],Z.center[1],St[2]*b.pixelsPerMeter];s.N.scale(At,At,1/b.worldSize);const jt=s.at(At[0]),Ft=s.au(At[1]),zt=Math.min(b._zoomFromMercatorZ(At[2]),v.maxZoom),kt=new s.bn(jt,Ft);return b.mercatorFromTransition&&zt<.5*(s.bG+s.bx)?(b.setProjection({name:"globe"}),b.zoom=zt,this._cameraForBounds(b,n,_,c,f,g)):{center:kt,zoom:zt,bearing:c,pitch:f}}fitBounds(a,n,_){const c=this.cameraForBounds(a,n);return this._fitInternal(c,n,_)}fitScreenCoordinates(a,n,_,c,f){const g=s.P.convert(a),b=s.P.convert(n),v=new s.P(Math.min(g.x,b.x),Math.min(g.y,b.y)),A=new s.P(Math.max(g.x,b.x),Math.max(g.y,b.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(g,b))return this;const O=this.transform.pointLocation3D(v),R=this.transform.pointLocation3D(A),P=this.transform.pointLocation3D(new s.P(v.x,A.y)),N=this.transform.pointLocation3D(new s.P(A.x,v.y)),U=[Math.min(O.lng,R.lng,P.lng,N.lng),Math.min(O.lat,R.lat,P.lat,N.lat)],B=[Math.max(O.lng,R.lng,P.lng,N.lng),Math.max(O.lat,R.lat,P.lat,N.lat)],k=c&&c.pitch?c.pitch:this.getPitch(),M=this._cameraForBounds(this.transform,U,B,_,k,c);return this._fitInternal(M,c,f)}_fitInternal(a,n,_){return a?(delete(n=s.e(a,n)).padding,n.linear?this.easeTo(n,_):this.flyTo(n,_)):this}jumpTo(a,n){this.stop();const _=a.preloadOnly?this.transform.clone():this.transform;let c=!1,f=!1,g=!1;return"zoom"in a&&_.zoom!==+a.zoom&&(c=!0,_.zoom=+a.zoom),a.center!==void 0&&(_.center=s.bn.convert(a.center)),"bearing"in a&&_.bearing!==+a.bearing&&(f=!0,_.bearing=+a.bearing),"pitch"in a&&_.pitch!==+a.pitch&&(g=!0,_.pitch=+a.pitch),a.padding==null||_.isPaddingEqual(a.padding)||(_.padding=a.padding),a.preloadOnly?(this._preloadTiles(_),this):(this.fire(new s.b("movestart",n)).fire(new s.b("move",n)),c&&this.fire(new s.b("zoomstart",n)).fire(new s.b("zoom",n)).fire(new s.b("zoomend",n)),f&&this.fire(new s.b("rotatestart",n)).fire(new s.b("rotate",n)).fire(new s.b("rotateend",n)),g&&this.fire(new s.b("pitchstart",n)).fire(new s.b("pitch",n)).fire(new s.b("pitchend",n)),this.fire(new s.b("moveend",n)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||s.w(Wc),this.transform.getFreeCameraOptions()}setFreeCameraOptions(a,n){const _=this.transform;if(!_.projection.supportsFreeCamera)return s.w(Wc),this;this.stop();const c=_.zoom,f=_.pitch,g=_.bearing;_.setFreeCameraOptions(a);const b=c!==_.zoom,v=f!==_.pitch,A=g!==_.bearing;return this.fire(new s.b("movestart",n)).fire(new s.b("move",n)),b&&this.fire(new s.b("zoomstart",n)).fire(new s.b("zoom",n)).fire(new s.b("zoomend",n)),A&&this.fire(new s.b("rotatestart",n)).fire(new s.b("rotate",n)).fire(new s.b("rotateend",n)),v&&this.fire(new s.b("pitchstart",n)).fire(new s.b("pitch",n)).fire(new s.b("pitchend",n)),this.fire(new s.b("moveend",n)),this}easeTo(a,n){this._stop(!1,a.easeId),((a=s.e({offset:[0,0],duration:500,easing:s.d0},a)).animate===!1||this._prefersReducedMotion(a))&&(a.duration=0);const _=this.transform,c=this.getZoom(),f=this.getBearing(),g=this.getPitch(),b=this.getPadding(),v="zoom"in a?+a.zoom:c,A="bearing"in a?this._normalizeBearing(a.bearing,f):f,O="pitch"in a?+a.pitch:g,R="padding"in a?a.padding:_.padding,P=s.P.convert(a.offset);let N,U,B;if(_.projection.name==="globe"){const ne=s.L.fromLngLat(_.center),re=P.rotate(-_.angle);ne.x+=re.x/_.worldSize,ne.y+=re.y/_.worldSize;const ye=ne.toLngLat(),ue=s.bn.convert(a.center||ye);this._normalizeCenter(ue),N=_.centerPoint.add(re),U=new s.P(ne.x,ne.y).mult(_.worldSize),B=new s.P(s.a5(ue.lng),s.ae(ue.lat)).mult(_.worldSize).sub(U)}else{N=_.centerPoint.add(P);const ne=_.pointLocation(N),re=s.bn.convert(a.center||ne);this._normalizeCenter(re),U=_.project(ne),B=_.project(re).sub(U)}const k=_.zoomScale(v-c);let M,H;a.around&&(M=s.bn.convert(a.around),H=_.locationPoint(M));const $=this._zooming||v!==c,V=this._rotating||f!==A,Z=this._pitching||O!==g,z=!_.isPaddingEqual(R),X=ne=>re=>{if($&&(ne.zoom=s.U(c,v,re)),V&&(ne.bearing=s.U(f,A,re)),Z&&(ne.pitch=s.U(g,O,re)),z&&(ne.interpolatePadding(b,R,re),N=ne.centerPoint.add(P)),M)ne.setLocationAtPoint(M,H);else{const ye=ne.zoomScale(ne.zoom-c),ue=v>c?Math.min(2,k):Math.max(.5,k),Ie=Math.pow(ue,1-re),Ee=ne.unproject(U.add(B.mult(re*Ie)).mult(ye));ne.setLocationAtPoint(ne.renderWorldCopies?Ee.wrap():Ee,N)}return a.preloadOnly||this._fireMoveEvents(n),ne};if(a.preloadOnly){const ne=this._emulate(X,a.duration,_);return this._preloadTiles(ne),this}const ie={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=$,this._rotating=V,this._pitching=Z,this._easeId=a.easeId,this._prepareEase(n,a.noMoveStart,ie),this._ease(X(_),ne=>{_.cameraElevationReference==="sea"&&_.recenterOnTerrain(),this._afterEase(n,ne)},a),this}_prepareEase(a,n,_={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),n||_.moving||this.fire(new s.b("movestart",a)),this._zooming&&!_.zooming&&this.fire(new s.b("zoomstart",a)),this._rotating&&!_.rotating&&this.fire(new s.b("rotatestart",a)),this._pitching&&!_.pitching&&this.fire(new s.b("pitchstart",a))}_fireMoveEvents(a){this.fire(new s.b("move",a)),this._zooming&&this.fire(new s.b("zoom",a)),this._rotating&&this.fire(new s.b("rotate",a)),this._pitching&&this.fire(new s.b("pitch",a))}_afterEase(a,n){if(this._easeId&&n&&this._easeId===n)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const _=this._zooming,c=this._rotating,f=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,_&&this.fire(new s.b("zoomend",a)),c&&this.fire(new s.b("rotateend",a)),f&&this.fire(new s.b("pitchend",a)),this.fire(new s.b("moveend",a))}flyTo(a,n){if(this._prefersReducedMotion(a)){const ce=s.ac(a,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ce,n)}this.stop(),a=s.e({offset:[0,0],speed:1.2,curve:1.42,easing:s.d0},a);const _=this.transform,c=this.getZoom(),f=this.getBearing(),g=this.getPitch(),b="zoom"in a?s.aa(+a.zoom,_.minZoom,_.maxZoom):c,v="bearing"in a?this._normalizeBearing(a.bearing,f):f,A="pitch"in a?+a.pitch:g,O=_.zoomScale(b-c),R=s.P.convert(a.offset),P=_.centerPoint.add(R),N=_.pointLocation(P);let U=a.center;if(U&&a.padding){const ce=this._cameraForBounds(this.transform,U,U,v,A,a);ce&&(U=ce.center)}U=s.bn.convert(U||N),this._normalizeCenter(U);const B=_.project(N),k=_.project(U).sub(B);let M=a.curve;const H=Math.max(_.width,_.height),$=H/O,V=k.mag();if("minZoom"in a){const ce=s.aa(Math.min(a.minZoom,c,b),_.minZoom,_.maxZoom),Te=H/_.zoomScale(ce-c);M=Math.sqrt(Te/V*2)}const Z=M*M;function z(ce){const Te=($*$-H*H+(ce?-1:1)*Z*Z*V*V)/(2*(ce?$:H)*Z*V);return Math.log(Math.sqrt(Te*Te+1)-Te)}function X(ce){return(Math.exp(ce)-Math.exp(-ce))/2}function ie(ce){return(Math.exp(ce)+Math.exp(-ce))/2}const ne=z(0);let re=function(ce){return ie(ne)/ie(ne+M*ce)},ye=function(ce){return H*((ie(ne)*(X(Te=ne+M*ce)/ie(Te))-X(ne))/Z)/V;var Te},ue=(z(1)-ne)/M;if(Math.abs(V)<1e-6||!isFinite(ue)){if(Math.abs(H-$)<1e-6)return this.easeTo(a,n);const ce=$<H?-1:1;ue=Math.abs(Math.log($/H))/M,ye=function(){return 0},re=function(Te){return Math.exp(ce*M*Te)}}a.duration="duration"in a?+a.duration:1e3*ue/("screenSpeed"in a?+a.screenSpeed/M:+a.speed),a.maxDuration&&a.duration>a.maxDuration&&(a.duration=0);const Ie=f!==v,Ee=A!==g,Ue=ce=>Te=>{const le=Te*ue,pe=1/re(le);ce.zoom=Te===1?b:c+ce.scaleZoom(pe),Ie&&(ce.bearing=s.U(f,v,Te)),Ee&&(ce.pitch=s.U(g,A,Te));const ke=Te===1?U:ce.unproject(B.add(k.mult(ye(le))).mult(pe));return ce.setLocationAtPoint(ce.renderWorldCopies?ke.wrap():ke,P),ce._updateCameraOnTerrain(),a.preloadOnly||this._fireMoveEvents(n),ce};if(a.preloadOnly){const ce=this._emulate(Ue,a.duration,_);return this._preloadTiles(ce),this}return this._zooming=!0,this._rotating=Ie,this._pitching=Ee,this._prepareEase(n,!1),this._ease(Ue(_),()=>this._afterEase(n),a),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(a,n){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const _=this._onEaseEnd;this._onEaseEnd=void 0,_.call(this,n)}if(!a){const _=this.handlers;_&&_.stop(!1)}return this}_ease(a,n,_){_.animate===!1||_.duration===0?(a(1),n()):(this._easeStart=s.f.now(),this._easeOptions=_,this._onEaseFrame=a,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const a=Math.min((s.f.now()-this._easeStart)/this._easeOptions.duration,1),n=this._onEaseFrame;n&&n(this._easeOptions.easing(a)),a<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(a,n){a=s.bh(a,-180,180);const _=Math.abs(a-n);return Math.abs(a-360-n)<_&&(a-=360),Math.abs(a+360-n)<_&&(a+=360),a}_normalizeCenter(a){const n=this.transform;if(n.maxBounds||n.projection.name!=="globe"&&!n.renderWorldCopies)return;const _=a.lng-n.center.lng;a.lng+=_>180?-360:_<-180?360:0}_prefersReducedMotion(a){return this._respectPrefersReducedMotion&&s.f.prefersReducedMotion&&!(a&&a.essential)}_emulate(a,n,_){const c=Math.ceil(15*n/1e3),f=[],g=a(_.clone());for(let b=0;b<=c;b++){const v=g(b/c);f.push(v.clone())}return f}}class au{constructor(a={}){this.options=a,s.aY(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(a){const n=this.options&&this.options.compact;return this._map=a,this._container=Ce("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Ce("button","mapboxgl-ctrl-attrib-button",this._container),Ce("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Ce("div","mapboxgl-ctrl-attrib-inner",this._container),n&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),n===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(a,n){const _=this._map._getUIString(`AttributionControl.${n}`);a.removeAttribute("title"),a.firstElementChild&&a.firstElementChild.setAttribute("title",_)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let a=this._editLink;a||(a=this._editLink=this._container.querySelector(".mapbox-improve-map"));const n=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.d5.ACCESS_TOKEN}];if(a){const _=n.reduce((c,f,g)=>(f.value&&(c+=`${f.key}=${f.value}${g<n.length-1?"&":""}`),c),"?");a.href=`${s.d5.FEEDBACK_URL}/${_}#${j_(this._map,!0)}`,a.rel="noopener nofollow",this._setElementTitle(a,"MapFeedback")}}_updateData(a){!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let a=[];if(this._map.style.stylesheet){const c=this._map.style.stylesheet;this.styleOwner=c.owner,this.styleId=c.id}const n=this._map.style._mergedSourceCaches;for(const c in n){const f=n[c];if(f.used){const g=f.getSource();g.attribution&&a.indexOf(g.attribution)<0&&a.push(g.attribution)}}a.sort((c,f)=>c.length-f.length),a=a.filter((c,f)=>{for(let g=f+1;g<a.length;g++)if(a[g].indexOf(c)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?a=[...this.options.customAttribution,...a]:a.unshift(this.options.customAttribution));const _=a.join(" | ");_!==this._attribHTML&&(this._attribHTML=_,a.length?(this._innerContainer.innerHTML=_,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Mc{constructor(){s.aY(["_updateLogo","_updateCompact"],this)}onAdd(a){this._map=a,this._container=Ce("div","mapboxgl-ctrl");const n=Ce("a","mapboxgl-ctrl-logo");return n.target="_blank",n.rel="noopener nofollow",n.href="https://www.mapbox.com/",n.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),n.setAttribute("rel","noopener nofollow"),this._container.appendChild(n),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(a){a&&a.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const a=this._map.style._sourceCaches;if(Object.entries(a).length===0)return!0;for(const n in a){const _=a[n].getSource();if(_.hasOwnProperty("mapbox_logo")&&!_.mapbox_logo)return!1}return!0}_updateCompact(){const a=this._container.children;if(a.length){const n=a[0];this._map.getCanvasContainer().offsetWidth<250?n.classList.add("mapboxgl-compact"):n.classList.remove("mapboxgl-compact")}}}class Dc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(a){const n=++this._id;return this._queue.push({callback:a,id:n,cancelled:!1}),n}remove(a){const n=this._currentlyRunning,_=n?this._queue.concat(n):this._queue;for(const c of _)if(c.id===a)return void(c.cancelled=!0)}run(a=0){const n=this._currentlyRunning=this._queue;this._queue=[];for(const _ of n)if(!_.cancelled&&(_.callback(a),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function tr(d,a,n){if(d=new s.bn(d.lng,d.lat),a){const _=new s.bn(d.lng-360,d.lat),c=new s.bn(d.lng+360,d.lat),f=360*Math.ceil(Math.abs(d.lng-n.center.lng)/360),g=n.locationPoint(d).distSqr(a),b=a.x<0||a.y<0||a.x>n.width||a.y>n.height;n.locationPoint(_).distSqr(a)<g&&(b||Math.abs(_.lng-n.center.lng)<f)?d=_:n.locationPoint(c).distSqr(a)<g&&(b||Math.abs(c.lng-n.center.lng)<f)&&(d=c)}for(;Math.abs(d.lng-n.center.lng)>180;){const _=n.locationPoint(d);if(_.x>=0&&_.y>=0&&_.x<=n.width&&_.y<=n.height)break;d.lng>n.center.lng?d.lng-=360:d.lng+=360}return d}const Xr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class ou extends s.E{constructor(a,n){if(super(),(a instanceof HTMLElement||n)&&(a=s.e({element:a},n)),s.aY(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=a&&a.anchor||"center",this._color=a&&a.color||"#3FB1CE",this._scale=a&&a.scale||1,this._draggable=a&&a.draggable||!1,this._clickTolerance=a&&a.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=a&&a.rotation||0,this._rotationAlignment=a&&a.rotationAlignment||"auto",this._pitchAlignment=a&&a.pitchAlignment&&a.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=a&&a.occludedOpacity||.2,a&&a.element)this._element=a.element,this._offset=s.P.convert(a&&a.offset||[0,0]);else{this._defaultMarker=!0,this._element=Ce("div");const f=41,g=27,b=lt("svg",{display:"block",height:f*this._scale+"px",width:g*this._scale+"px",viewBox:`0 0 ${g} ${f}`},this._element),v=lt("radialGradient",{id:"shadowGradient"},lt("defs",{},b));lt("stop",{offset:"10%","stop-opacity":.4},v),lt("stop",{offset:"100%","stop-opacity":.05},v),lt("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},b),lt("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},b),lt("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},b),lt("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},b),this._offset=s.P.convert(a&&a.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",f=>{f.preventDefault()}),this._element.addEventListener("mousedown",f=>{f.preventDefault()});const _=this._element.classList;for(const f in Xr)_.remove(`mapboxgl-marker-anchor-${f}`);_.add(`mapboxgl-marker-anchor-${this._anchor}`);const c=a&&a.className?a.className.trim().split(/\s+/):[];_.add(...c),this._popup=null}addTo(a){return a===this._map||(this.remove(),this._map=a,a.getCanvasContainer().appendChild(this._element),a.on("move",this._updateMoving),a.on("moveend",this._update),a.on("remove",this._clearFadeTimer),a._addMarker(this),this.setDraggable(this._draggable),this._update(),a.on("click",this._onMapClick)),this}remove(){const a=this._map;return a&&(a.off("click",this._onMapClick),a.off("move",this._updateMoving),a.off("moveend",this._update),a.off("mousedown",this._addDragHandler),a.off("touchstart",this._addDragHandler),a.off("mouseup",this._onUp),a.off("touchend",this._onUp),a.off("mousemove",this._onMove),a.off("touchmove",this._onMove),a.off("remove",this._clearFadeTimer),a._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(a){return this._lngLat=s.bn.convert(a),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(a){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),a){if(!("offset"in a.options)){const c=Math.sqrt(Math.pow(13.5,2)/2);a.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[c,-1*(38.1-13.5+c)],"bottom-right":[-c,-1*(38.1-13.5+c)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=a,a._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(a){const n=a.code,_=a.charCode||a.keyCode;n!=="Space"&&n!=="Enter"&&_!==32&&_!==13||this.togglePopup()}_onMapClick(a){const n=a.originalEvent.target,_=this._element;this._popup&&(n===_||_.contains(n))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const a=this._popup;return a?(a.isOpen()?(a.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(a.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const a=this._map,n=this._pos;if(!a||!n)return!1;const _=a.unproject(n),c=a.getFreeCameraOptions();if(!c.position)return!1;const f=c.position.toLngLat();return f.distanceTo(_)<.9*f.distanceTo(this._lngLat)}_evaluateOpacity(){const a=this._map;if(!a)return;const n=this._pos;if(!n||n.x<0||n.x>a.transform.width||n.y<0||n.y>a.transform.height)return void this._clearFadeTimer();const _=a.unproject(n);let c;a._showingGlobe()&&s.d6(a.transform,this._lngLat)?c=0:(c=1-a._queryFogOpacity(_),a.transform._terrainEnabled()&&a.getTerrain()&&this._behindTerrain()&&(c*=this._occludedOpacity)),this._element.style.opacity=`${c}`,this._element.style.pointerEvents=c>0?"auto":"none",this._popup&&this._popup._setOpacity(c),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const a=this._pos;if(!a||!this._map)return;const n=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${a.x}px,${a.y}px)
            ${Xr[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${n.x}px,${n.y}px)
        `}_calculateXYTransform(){const a=this._pos,n=this._map,_=this.getPitchAlignment();if(!n||!a||_!=="map")return"";if(!n._showingGlobe()){const v=n.getPitch();return v?`rotateX(${v}deg)`:""}const c=s.bF(s.d7(n.transform,this._lngLat)),f=a.sub(s.d8(n.transform)),g=Math.abs(f.x)+Math.abs(f.y);if(g===0)return"";const b=c/g;return`rotateX(${-f.y*b}deg) rotateY(${f.x*b}deg)`}_calculateZTransform(){const a=this._pos,n=this._map;if(!n||!a)return"";let _=0;const c=this.getRotationAlignment();if(c==="map")if(n._showingGlobe()){const f=n.project(new s.bn(this._lngLat.lng,this._lngLat.lat+.001)),g=n.project(new s.bn(this._lngLat.lng,this._lngLat.lat-.001)).sub(f);_=s.bF(Math.atan2(g.y,g.x))-90}else _=-n.getBearing();else if(c==="horizon"){const f=s.O(4,6,n.getZoom()),g=s.d8(n.transform);g.y+=f*n.transform.height;const b=a.sub(g),v=s.bF(Math.atan2(b.y,b.x));_=(v>90?v-270:v+90)*(1-f)}return _+=this._rotation,_?`rotateZ(${_}deg)`:""}_update(a){cancelAnimationFrame(this._updateFrameId);const n=this._map;n&&(n.transform.renderWorldCopies&&(this._lngLat=tr(this._lngLat,this._pos,n.transform)),this._pos=n.project(this._lngLat),a===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),n._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(n._showingGlobe()||n.getTerrain()||n.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(a){return this._offset=s.P.convert(a),this._update(),this}addClassName(a){return this._element.classList.add(a),this}removeClassName(a){return this._element.classList.remove(a),this}toggleClassName(a){return this._element.classList.toggle(a)}_onMove(a){const n=this._map;if(!n)return;const _=this._pointerdownPos,c=this._positionDelta;if(_&&c){if(!this._isDragging){const f=this._clickTolerance||n._clickTolerance;if(a.point.dist(_)<f)return;this._isDragging=!0}this._pos=a.point.sub(c),this._lngLat=n.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.b("dragstart"))),this.fire(new s.b("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const a=this._map;a&&(a.off("mousemove",this._onMove),a.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new s.b("dragend")),this._state="inactive"}_addDragHandler(a){const n=this._map,_=this._pos;n&&_&&this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(_),this._pointerdownPos=a.point,this._state="pending",n.on("mousemove",this._onMove),n.on("touchmove",this._onMove),n.once("mouseup",this._onUp),n.once("touchend",this._onUp))}setDraggable(a){this._draggable=!!a;const n=this._map;return n&&(a?(n.on("mousedown",this._addDragHandler),n.on("touchstart",this._addDragHandler)):(n.off("mousedown",this._addDragHandler),n.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(a){return this._rotation=a||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(a){return this._rotationAlignment=a||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(a){return this._pitchAlignment=a||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(a){return this._occludedOpacity=a||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Fc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Bc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Uc(d=new s.P(0,0),a="bottom"){if(typeof d=="number"){const n=Math.round(Math.sqrt(.5*Math.pow(d,2)));switch(a){case"top":return new s.P(0,d);case"top-left":return new s.P(n,n);case"top-right":return new s.P(-n,n);case"bottom":return new s.P(0,-d);case"bottom-left":return new s.P(n,-n);case"bottom-right":return new s.P(-n,-n);case"left":return new s.P(d,0);case"right":return new s.P(-d,0)}return new s.P(0,0)}return d instanceof s.P||Array.isArray(d)?s.P.convert(d):s.P.convert(d[a]||[0,0])}class nu{constructor(a){this.jumpTo(a)}getValue(a){if(a<=this._startTime)return this._start;if(a>=this._endTime)return this._end;const n=s.cc((a-this._startTime)/(this._endTime-this._startTime));return this._start*(1-n)+this._end*n}isEasing(a){return a>=this._startTime&&a<=this._endTime}jumpTo(a){this._startTime=-1/0,this._endTime=-1/0,this._start=a,this._end=a}easeTo(a,n,_){this._start=this.getValue(n),this._end=a,this._startTime=n,this._endTime=n+_}}const ir={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},kc={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1};class su{constructor(){this.showOverdrawInspector=!1,this.showTileBoundaries=!1,this.showParseStatus=!1,this.continuousRedraw=!1,this.showTileAABBs=!1,this.showPadding=!1,this.showTerrainWireframe=!1,this.showLayers2DWireframe=!1,this.showLayers3DWireframe=!1}}const Jr={showCompass:!0,showZoom:!0,visualizePitch:!1};class _n{constructor(a,n,_=!1){this._clickTolerance=10,this.element=n,this.mouseRotate=new ql({clickTolerance:a.dragRotate._mouseRotate._clickTolerance}),this.map=a,_&&(this.mousePitch=new $r({clickTolerance:a.dragRotate._mousePitch._clickTolerance})),s.aY(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),n.addEventListener("mousedown",this.mousedown),n.addEventListener("touchstart",this.touchstart,{passive:!1}),n.addEventListener("touchmove",this.touchmove),n.addEventListener("touchend",this.touchend),n.addEventListener("touchcancel",this.reset)}down(a,n){this.mouseRotate.mousedown(a,n),this.mousePitch&&this.mousePitch.mousedown(a,n),ut()}move(a,n){const _=this.map,c=this.mouseRotate.mousemoveWindow(a,n),f=c&&c.bearingDelta;if(f&&_.setBearing(_.getBearing()+f),this.mousePitch){const g=this.mousePitch.mousemoveWindow(a,n),b=g&&g.pitchDelta;b&&_.setPitch(_.getPitch()+b)}}off(){const a=this.element;a.removeEventListener("mousedown",this.mousedown),a.removeEventListener("touchstart",this.touchstart,{passive:!1}),a.removeEventListener("touchmove",this.touchmove),a.removeEventListener("touchend",this.touchend),a.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){bt(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(a){this.down(s.e({},a,{ctrlKey:!0,preventDefault:()=>a.preventDefault()}),ai(this.element,a)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(a){this.move(a,ai(this.element,a))}mouseup(a){this.mouseRotate.mouseupWindow(a),this.mousePitch&&this.mousePitch.mouseupWindow(a),this.offTemp()}touchstart(a){a.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Oi(this.element,a.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>a.preventDefault()},this._startPos))}touchmove(a){a.targetTouches.length!==1?this.reset():(this._lastPos=Oi(this.element,a.targetTouches)[0],this.move({preventDefault:()=>a.preventDefault()},this._lastPos))}touchend(a){a.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Qr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Va={maxWidth:100,unit:"metric"},Yn={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"};return{version:s.dk,supported:he,setRTLTextPlugin:s.dm,getRTLTextPluginStatus:s.dn,Map:class extends ia{constructor(d){const a=d;if((d=s.e({},kc,d)).minZoom!=null&&d.maxZoom!=null&&d.minZoom>d.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(d.minPitch!=null&&d.maxPitch!=null&&d.minPitch>d.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(d.minPitch!=null&&d.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(d.maxPitch!=null&&d.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(d.antialias&&s.d9(window)&&(d.antialias=!1,s.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Cl(d.minZoom,d.maxZoom,d.minPitch,d.maxPitch,d.renderWorldCopies),d),this._repaint=!1,this._interactive=d.interactive,this._minTileCacheSize=d.minTileCacheSize,this._maxTileCacheSize=d.maxTileCacheSize,this._failIfMajorPerformanceCaveat=d.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=d.preserveDrawingBuffer,this._antialias=d.antialias,this._trackResize=d.trackResize,this._bearingSnap=d.bearingSnap,this._refreshExpiredTiles=d.refreshExpiredTiles,this._fadeDuration=d.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=d.crossSourceCollisions,this._collectResourceTiming=d.collectResourceTiming,this._language=this._parseLanguage(d.language),this._worldview=d.worldview,this._renderTaskQueue=new Dc,this._domRenderTaskQueue=new Dc,this._controls=[],this._markers=[],this._popups=[],this._mapId=s.aC(),this._locale=s.e({},ir,d.locale),this._clickTolerance=d.clickTolerance,this._cooperativeGestures=d.cooperativeGestures,this._performanceMetricsCollection=d.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new nu(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new s.da(d.transformRequest,d.accessToken,d.testMode),this._silenceAuthErrors=!!d.testMode,this._contextCreateOptions=d.contextCreateOptions?{...d.contextCreateOptions}:{},typeof d.container=="string"){const n=document.getElementById(d.container);if(!n)throw new Error(`Container '${d.container.toString()}' not found.`);this._container=n}else{if(!(d.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=d.container}if(this._container.childNodes.length>0&&s.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),d.maxBounds&&this.setMaxBounds(d.maxBounds),s.aY(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._debugParams=new su,this._tp=d.devtools?new Hl(this):new Hl,this._tp.registerParameter(this._debugParams,["Debug"],"showOverdrawInspector",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug"],"showTileBoundaries",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug"],"showParseStatus",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug"],"continuousRedraw",void 0,n=>{this.repaint=n}),this._tp.registerParameter(this._debugParams,["Debug"],"showTileAABBs",void 0,n=>{this.showTileAABBs=n}),this._tp.registerParameter(this._debugParams,["Debug"],"showPadding",void 0,n=>{this.showPadding=n}),this._tp.registerParameter(this._debugParams,["Debug","Wireframe"],"showTerrainWireframe",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug","Wireframe"],"showLayers2DWireframe",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug","Wireframe"],"showLayers3DWireframe",void 0,()=>{this._update()}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new Nf(this,d),this._localFontFamily=d.localFontFamily,this._localIdeographFontFamily=d.localIdeographFontFamily,(d.style||!d.testMode)&&this.setStyle(d.style||s.d5.DEFAULT_STYLE,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),d.projection&&this.setProjection(d.projection),d.hash&&(this._hash=new jr(typeof d.hash=="string"&&d.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){a.center==null&&a.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch});const n=d.bounds;n&&(this.resize(),this.fitBounds(n,s.e({},d.fitBoundsOptions,{duration:0})))}this.resize(),d.attributionControl&&this.addControl(new au({customAttribution:d.customAttribution})),this._logoControl=new Mc,this.addControl(this._logoControl,d.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",n=>{this._update(n.dataType==="style"),this.fire(new s.b(`${n.dataType}data`,n))}),this.on("dataloading",n=>{this.fire(new s.b(`${n.dataType}dataloading`,n))})}_getMapId(){return this._mapId}addControl(d,a){if(a===void 0&&(a=d.getDefaultPosition?d.getDefaultPosition():"top-right"),!d||!d.onAdd)return this.fire(new s.a(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const n=d.onAdd(this);this._controls.push(d);const _=this._controlPositions[a];return a.indexOf("bottom")!==-1?_.insertBefore(n,_.firstChild):_.appendChild(n),this}removeControl(d){if(!d||!d.onRemove)return this.fire(new s.a(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const a=this._controls.indexOf(d);return a>-1&&this._controls.splice(a,1),d.onRemove(this),this}hasControl(d){return this._controls.indexOf(d)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(d){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const a=!this._moving;return a&&this.fire(new s.b("movestart",d)).fire(new s.b("move",d)),this.fire(new s.b("resize",d)),a&&this.fire(new s.b("moveend",d)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(d){return this.transform.setMaxBounds(s.ad.convert(d)),this._update()}setMinZoom(d){if((d=d??-2)>=-2&&d<=this.transform.maxZoom)return this.transform.minZoom=d,this._update(),this.getZoom()<d?this.setZoom(d):this.fire(new s.b("zoomstart")).fire(new s.b("zoom")).fire(new s.b("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(d){if((d=d??22)>=this.transform.minZoom)return this.transform.maxZoom=d,this._update(),this.getZoom()>d?this.setZoom(d):this.fire(new s.b("zoomstart")).fire(new s.b("zoom")).fire(new s.b("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(d){if((d=d??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(d>=0&&d<=this.transform.maxPitch)return this.transform.minPitch=d,this._update(),this.getPitch()<d?this.setPitch(d):this.fire(new s.b("pitchstart")).fire(new s.b("pitch")).fire(new s.b("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(d){if((d=d??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(d>=this.transform.minPitch)return this.transform.maxPitch=d,this._update(),this.getPitch()>d?this.setPitch(d):this.fire(new s.b("pitchstart")).fire(new s.b("pitch")).fire(new s.b("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(d){return this.transform.renderWorldCopies=d,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(d){return d==="auto"?navigator.language:Array.isArray(d)?d.length===0?void 0:d.map(a=>a==="auto"?navigator.language:a):d}setLanguage(d){const a=this._parseLanguage(d);if(!this.style||a===this._language)return this;this._language=a,this.style.reloadSources();for(const n of this._controls)n._setLanguage&&n._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(d){return this.style&&d!==this._worldview?(this._worldview=d,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(d){return this._lazyInitEmptyStyle(),d?typeof d=="string"&&(d={name:d}):d=null,this._useExplicitProjection=!!d,this._prioritizeAndUpdateProjection(d,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const d=this.transform,a=d.projection.name;let n;a==="globe"&&d.zoom>=s.bx?(d.setMercatorFromTransition(),n=!0):a==="mercator"&&d.zoom<s.bx&&(d.setProjection({name:"globe"}),n=!0),n&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(d,a){return this._updateProjection(d||a||{name:"mercator"})}_updateProjection(d){let a;return a=d.name==="globe"&&this.transform.zoom>=s.bx?this.transform.setMercatorFromTransition():this.transform.setProjection(d),this.style.applyProjectionUpdate(),a&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(d){return this.transform.locationPoint3D(s.bn.convert(d))}unproject(d){return this.transform.pointLocation3D(s.P.convert(d))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(d,a,n){if(d==="mouseenter"||d==="mouseover"){let _=!1;const c=g=>{const b=a.filter(A=>this.getLayer(A)),v=b.length?this.queryRenderedFeatures(g.point,{layers:b}):[];v.length?_||(_=!0,n.call(this,new $a(d,this,g.originalEvent,{features:v}))):_=!1},f=()=>{_=!1};return{layers:new Set(a),listener:n,delegates:{mousemove:c,mouseout:f}}}if(d==="mouseleave"||d==="mouseout"){let _=!1;const c=g=>{const b=a.filter(v=>this.getLayer(v));(b.length?this.queryRenderedFeatures(g.point,{layers:b}):[]).length?_=!0:_&&(_=!1,n.call(this,new $a(d,this,g.originalEvent)))},f=g=>{_&&(_=!1,n.call(this,new $a(d,this,g.originalEvent)))};return{layers:new Set(a),listener:n,delegates:{mousemove:c,mouseout:f}}}{const _=c=>{const f=a.filter(b=>this.getLayer(b)),g=f.length?this.queryRenderedFeatures(c.point,{layers:f}):[];g.length&&(c.features=g,n.call(this,c),delete c.features)};return{layers:new Set(a),listener:n,delegates:{[d]:_}}}}on(d,a,n){if(n===void 0)return super.on(d,a);if(Array.isArray(a)||(a=[a]),a){for(const c of a)if(!this._isValidId(c))return this}const _=this._createDelegatedListener(d,a,n);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[d]=this._delegatedListeners[d]||[],this._delegatedListeners[d].push(_);for(const c in _.delegates)this.on(c,_.delegates[c]);return this}once(d,a,n){if(n===void 0)return super.once(d,a);if(Array.isArray(a)||(a=[a]),a){for(const c of a)if(!this._isValidId(c))return this}const _=this._createDelegatedListener(d,a,n);for(const c in _.delegates)this.once(c,_.delegates[c]);return this}off(d,a,n){if(n===void 0)return super.off(d,a);a=new Set(Array.isArray(a)?a:[a]);for(const f of a)if(!this._isValidId(f))return this;const _=(f,g)=>{if(f.size!==g.size)return!1;for(const b of f)if(!g.has(b))return!1;return!0},c=this._delegatedListeners?this._delegatedListeners[d]:void 0;return c&&(f=>{for(let g=0;g<f.length;g++){const b=f[g];if(b.listener===n&&_(b.layers,a)){for(const v in b.delegates)this.off(v,b.delegates[v]);return f.splice(g,1),this}}})(c),this}queryRenderedFeatures(d,a){if(!this.style)return[];if(a!==void 0||d===void 0||d instanceof s.P||Array.isArray(d)||(a=d,d=void 0),d=d||[[0,0],[this.transform.width,this.transform.height]],(a=a||{}).layers&&Array.isArray(a.layers)){for(const n of a.layers)if(!this._isValidId(n))return[]}return this.style.queryRenderedFeatures(d,a,this.transform)}querySourceFeatures(d,a){return this._isValidId(d)?this.style.querySourceFeatures(d,a):[]}isPointOnSurface(d){const{name:a}=this.transform.projection;return a!=="globe"&&a!=="mercator"&&s.w(`${a} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(s.P.convert(d))}setStyle(d,a){return(a=s.e({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},a)).diff!==!1&&a.localIdeographFontFamily===this._localIdeographFontFamily&&a.localFontFamily===this._localFontFamily&&this.style&&d?(this._diffStyle(d,a),this):(this._localIdeographFontFamily=a.localIdeographFontFamily,this._localFontFamily=a.localFontFamily,this._updateStyle(d,a))}_getUIString(d){const a=this._locale[d];if(a==null)throw new Error(`Missing UI string '${d}'`);return a}_updateStyle(d,a){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),d&&(this.style=new Fo(this,a||{}),this.style.setEventedParent(this,{style:this.style}),typeof d=="string"?this.style.loadURL(d):this.style.loadJSON(d)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Fo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(d,a){if(typeof d=="string"){const n=this._requestManager.normalizeStyleURL(d),_=this._requestManager.transformRequest(n,s.R.Style);s.g(_,(c,f)=>{c?this.fire(new s.a(c)):f&&this._updateDiff(f,a)})}else typeof d=="object"&&this._updateDiff(d,a)}_updateDiff(d,a){try{this.style.setState(d)&&this._update(!0)}catch(n){s.w(`Unable to perform style diff: ${n.message||n.error||n}.  Rebuilding the style from scratch.`),this._updateStyle(d,a)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(s.w("There is no style added to the map."),!1)}_isValidId(d){return d==null?(this.fire(new s.a(new Error("IDs can't be empty."))),!1):!s.c4(d)||(this.fire(new s.a(new Error(`IDs can't contain special symbols: "${d}".`))),!1)}addSource(d,a){return this._isValidId(d)?(this._lazyInitEmptyStyle(),this.style.addSource(d,a),this._update(!0)):this}isSourceLoaded(d){return!!this._isValidId(d)&&!!this.style&&this.style._isSourceCacheLoaded(d)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(d,a,n){this._lazyInitEmptyStyle(),this.style.addSourceType(d,a,n)}removeSource(d){return this._isValidId(d)?(this.style.removeSource(d),this._updateTerrain(),this._update(!0)):this}getSource(d){return this._isValidId(d)?this.style.getOwnSource(d):null}addImage(d,a,{pixelRatio:n=1,sdf:_=!1,stretchX:c,stretchY:f,content:g}={}){if(this._lazyInitEmptyStyle(),a instanceof HTMLImageElement||ImageBitmap&&a instanceof ImageBitmap){const{width:b,height:v,data:A}=s.f.getImageData(a);this.style.addImage(d,{data:new s.h({width:b,height:v},A),pixelRatio:n,stretchX:c,stretchY:f,content:g,sdf:_,version:0})}else if(a.width===void 0||a.height===void 0)this.fire(new s.a(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:b,height:v}=a,A=a;this.style.addImage(d,{data:new s.h({width:b,height:v},new Uint8Array(A.data)),pixelRatio:n,stretchX:c,stretchY:f,content:g,sdf:_,version:0,userImage:A}),A.onAdd&&A.onAdd(this,d)}}updateImage(d,a){this._lazyInitEmptyStyle();const n=this.style.getImage(d);if(!n)return void this.fire(new s.a(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const _=a instanceof HTMLImageElement||ImageBitmap&&a instanceof ImageBitmap?s.f.getImageData(a):a,{width:c,height:f}=_,g=_.data;if(c===void 0||f===void 0)return void this.fire(new s.a(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(c!==n.data.width||f!==n.data.height)return void this.fire(new s.a(new Error(`The width and height of the updated image (${c}, ${f})
                must be that same as the previous version of the image
                (${n.data.width}, ${n.data.height})`)));const b=!(a instanceof HTMLImageElement||ImageBitmap&&a instanceof ImageBitmap);n.data.replace(g,b),this.style.updateImage(d,n)}hasImage(d){return d?!!this.style&&!!this.style.getImage(d):(this.fire(new s.a(new Error("Missing required image id"))),!1)}removeImage(d){this.style.removeImage(d)}loadImage(d,a){s.d(this._requestManager.transformRequest(d,s.R.Image),(n,_)=>{a(n,_ instanceof HTMLImageElement?s.f.getImageData(_):_)})}listImages(){return this.style.listImages()}addModel(d,a){this._lazyInitEmptyStyle(),this.style.addModel(d,a)}hasModel(d){return d?this.style.hasModel(d):(this.fire(new s.a(new Error("Missing required model id"))),!1)}removeModel(d){this.style.removeModel(d)}listModels(){return this.style.listModels()}addLayer(d,a){return this._isValidId(d.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(d,a),this._update(!0)):this}getSlot(d){const a=this.getLayer(d);return a&&a.slot||null}setSlot(d,a){return this.style.setSlot(d,a),this.style.mergeLayers(),this._update(!0)}addImport(d,a){return this.style.addImport(d,a),this}updateImport(d,a){return typeof a!="string"&&a.id!==d?(this.removeImport(d),this.addImport(a)):(this.style.updateImport(d,a),this._update(!0))}removeImport(d){return this.style.removeImport(d),this}moveImport(d,a){return this.style.moveImport(d,a),this._update(!0)}moveLayer(d,a){return this._isValidId(d)?(this.style.moveLayer(d,a),this._update(!0)):this}removeLayer(d){return this._isValidId(d)?(this.style.removeLayer(d),this._update(!0)):this}getLayer(d){return this._isValidId(d)?this.style.getOwnLayer(d):null}setLayerZoomRange(d,a,n){return this._isValidId(d)?(this.style.setLayerZoomRange(d,a,n),this._update(!0)):this}setFilter(d,a,n={}){return this._isValidId(d)?(this.style.setFilter(d,a,n),this._update(!0)):this}getFilter(d){return this._isValidId(d)?this.style.getFilter(d):null}setPaintProperty(d,a,n,_={}){return this._isValidId(d)?(this.style.setPaintProperty(d,a,n,_),this._update(!0)):this}getPaintProperty(d,a){return this._isValidId(d)?this.style.getPaintProperty(d,a):null}setLayoutProperty(d,a,n,_={}){return this._isValidId(d)?(this.style.setLayoutProperty(d,a,n,_),this._update(!0)):this}getLayoutProperty(d,a){return this._isValidId(d)?this.style.getLayoutProperty(d,a):null}getConfigProperty(d,a){return this.style.getConfigProperty(d,a)}setConfigProperty(d,a,n){return this.style.setConfigProperty(d,a,n),this._update(!0)}setLights(d){if(this._lazyInitEmptyStyle(),d&&d.length===1&&d[0].type==="flat"){const a=d[0];a.properties?this.style.setFlatLight(a.properties,a.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(d),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const d=this.style.getLights()||[];return d.length===0&&d.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),d}setLight(d,a={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:d}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(d){return this._lazyInitEmptyStyle(),!d&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(d),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(d){return this._lazyInitEmptyStyle(),this.style.setFog(d),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setCamera(d){return this.style.setCamera(d),this._triggerCameraUpdate(d)}_triggerCameraUpdate(d){return this._update(this.transform.setOrthographicProjectionAtLowPitch(d["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(d){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.bn.convert(d),this.transform):0}setFeatureState(d,a){return this._isValidId(d.source)?(this.style.setFeatureState(d,a),this._update()):this}removeFeatureState(d,a){return this._isValidId(d.source)?(this.style.removeFeatureState(d,a),this._update()):this}getFeatureState(d){return this._isValidId(d.source)?this.style.getFeatureState(d):null}_updateContainerDimensions(){if(!this._container)return;const d=this._container.getBoundingClientRect().width||400,a=this._container.getBoundingClientRect().height||300;let n,_,c,f=this._container;for(;f&&(!_||!c);){const g=window.getComputedStyle(f).transform;g&&g!=="none"&&(n=g.match(/matrix.*\((.+)\)/)[1].split(", "),n[0]&&n[0]!=="0"&&n[0]!=="1"&&(_=n[0]),n[3]&&n[3]!=="0"&&n[3]!=="1"&&(c=n[3])),f=f.parentElement}this._containerWidth=_?Math.abs(d/_):d,this._containerHeight=c?Math.abs(a/c):a}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const d=this._container;d.classList.add("mapboxgl-map"),(this._missingCSSCanary=Ce("div","mapboxgl-canary",d)).style.visibility="hidden",this._detectMissingCSS();const a=this._canvasContainer=Ce("div","mapboxgl-canvas-container",d);this._canvas=Ce("canvas","mapboxgl-canvas",a),this._interactive&&(a.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const n=this._controlContainer=Ce("div","mapboxgl-control-container",d),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(c=>{_[c]=Ce("div",`mapboxgl-ctrl-${c}`,n)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(d,a){const n=s.f.devicePixelRatio||1;this._canvas.width=n*Math.ceil(d),this._canvas.height=n*Math.ceil(a),this._canvas.style.width=`${d}px`,this._canvas.style.height=`${a}px`}_addMarker(d){this._markers.push(d)}_removeMarker(d){const a=this._markers.indexOf(d);a!==-1&&this._markers.splice(a,1)}_addPopup(d){this._popups.push(d)}_removePopup(d){const a=this._popups.indexOf(d);a!==-1&&this._popups.splice(a,1)}_setupPainter(){const d=s.e({},he.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),a=this._canvas.getContext("webgl2",d);a?(s.db(a,!0),this.painter=new Ac(a,this._contextCreateOptions,this.transform,this._tp),this.on("data",n=>{n.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),s.dc.testSupport(a)):this.fire(new s.a(new Error("Failed to initialize WebGL")))}_contextLost(d){d.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.b("webglcontextlost",{originalEvent:d}))}_contextRestored(d){this._setupPainter(),this.resize(),this._update(),this.fire(new s.b("webglcontextrestored",{originalEvent:d}))}_onMapScroll(d){if(d.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(d){return this.style?(this._styleDirty=this._styleDirty||d,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(d){return this._update(),this._renderTaskQueue.add(d)}_cancelRenderFrame(d){this._renderTaskQueue.remove(d)}_requestDomTask(d){!this.loaded()||this.loaded()&&!this.isMoving()?d():this._domRenderTaskQueue.add(d)}_render(d){let a;this.fire(new s.b("renderstart"));const n=this.painter.context.extTimerQuery,_=s.f.now(),c=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(a=c.createQuery(),c.beginQuery(n.TIME_ELAPSED_EXT,a)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(d),this._domRenderTaskQueue.run(d),this._removed)return;this._updateProjectionTransition();const f=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const v=this.transform.zoom,A=this.transform.pitch,O=s.f.now(),R=new s.K(v,{now:O,fadeDuration:f,pitch:A,transition:this.style.transition});this.style.update(R)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let g=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),g=this._updateAverageElevation(_),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):g=this._updateAverageElevation(_),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,f,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries||this._debugParams.showTileBoundaries,showParseStatus:this.showParseStatus||this._debugParams.showParseStatus,wireframe:{terrain:this.showTerrainWireframe||this._debugParams.showTerrainWireframe,layers2D:this.showLayers2DWireframe||this._debugParams.showLayers2DWireframe,layers3D:this.showLayers3DWireframe||this._debugParams.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector||this._debugParams.showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs||this._debugParams.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:f,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding||this._debugParams.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.b("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.b("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),a){const v=s.f.now()-_;c.endQuery(n.TIME_ELAPSED_EXT),setTimeout(()=>{const A=c.getQueryParameter(a,c.QUERY_RESULT)/1e6;c.deleteQuery(a),this.fire(new s.b("gpu-timing-frame",{cpuTime:v,gpuTime:A}))},50)}if(this.listens("gpu-timing-layer")){const v=this.painter.collectGpuTimers();setTimeout(()=>{const A=this.painter.queryGpuTimers(v);this.fire(new s.b("gpu-timing-layer",{layerTimes:A}))},50)}if(this.listens("gpu-timing-deferred-render")){const v=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const A=this.painter.queryGpuTimeDeferredRender(v);this.fire(new s.b("gpu-timing-deferred-render",{gpuTime:A}))},50)}const b=this._sourcesDirty||this._styleDirty||this._placementDirty||g;if(b||this._repaint)this.triggerRepaint();else{const v=!this.isMoving()&&this.loaded();if(v&&(g=this._updateAverageElevation(_,!0)),g)this.triggerRepaint();else if(this._triggerFrame(!1),v&&(this.fire(new s.b("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const A=this._calculateSpeedIndex();this.fire(new s.b("speedindexcompleted",{speedIndex:A})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||b||(this._fullyLoaded=!0,this._performanceMetricsCollection&&s.dd(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(d){for(const a of this._markers)d&&!this.getRenderWorldCopies()&&(a._lngLat=a._lngLat.wrap()),a._update();for(const a of this._popups)!d||this.getRenderWorldCopies()||a._trackPointer||(a._lngLat=a._lngLat.wrap()),a._update()}_updateAverageElevation(d,a=!1){const n=c=>(this.transform.averageElevation=c,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&n(0);const _=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(_||(a||d-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(d)){const c=this.transform.averageElevation;let f=this.transform.sampleAverageElevation();this.transform.elevation&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(f)?f=0:this._averageElevationLastSampledAt=d;const g=Math.abs(c-f);if(g>1){if(this._isInitialLoad||_)return this._averageElevation.jumpTo(f),n(f);this._averageElevation.easeTo(f,d,300)}else if(g>1e-4)return this._averageElevation.jumpTo(f),n(f)}return!!this._averageElevation.isEasing(d)&&n(this._averageElevation.getValue(d))}_authenticate(){s.de(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,d=>{if(d&&(d.message===s.df||d.status===401)){const a=this.painter.context.gl;s.db(a,!1),this._logoControl instanceof Mc&&this._logoControl._updateLogo(),a&&a.clear(a.DEPTH_BUFFER_BIT|a.COLOR_BUFFER_BIT|a.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.a(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),s.dg(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const d=this._isDragging();this.painter.updateTerrain(this.style,d)}_calculateSpeedIndex(){const d=this.painter.canvasCopy(),a=this.painter.getCanvasCopiesAndTimestamps();a.timeStamps.push(performance.now());const n=this.painter.context.gl,_=n.createFramebuffer();function c(f){n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,f,0);const g=new Uint8Array(n.drawingBufferWidth*n.drawingBufferHeight*4);return n.readPixels(0,0,n.drawingBufferWidth,n.drawingBufferHeight,n.RGBA,n.UNSIGNED_BYTE,g),g}return n.bindFramebuffer(n.FRAMEBUFFER,_),this._canvasPixelComparison(c(d),a.canvasCopies.map(c),a.timeStamps)}_canvasPixelComparison(d,a,n){let _=n[1]-n[0];const c=d.length/4;for(let f=0;f<a.length;f++){const g=a[f];let b=0;for(let v=0;v<g.length;v+=4)g[v]===d[v]&&g[v+1]===d[v+1]&&g[v+2]===d[v+2]&&g[v+3]===d[v+3]&&(b+=1);_+=(n[f+2]-n[f+1])*(1-b/c)}return _}remove(){this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const d=this.painter.context.gl.getExtension("WEBGL_lose_context");d&&d.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),s.dh(this.painter.context.gl),s.di.remove(),s.dj.remove(),this._removed=!0,this.fire(new s.b("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(d){this._renderNextFrame=this._renderNextFrame||d,this.style&&!this._frame&&(this._frame=s.f.frame(a=>{const n=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,n&&this._render(a)}))}_preloadTiles(d){const a=this.style?Object.values(this.style._sourceCaches):[];return s.b1(a,(n,_)=>n._preloadTiles(d,_),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(d){this._trackResize&&this.resize({originalEvent:d})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(d){this._showTileBoundaries!==d&&(this._showTileBoundaries=d,this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(d){this._showParseStatus!==d&&(this._showParseStatus=d,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(d){this._showTerrainWireframe!==d&&(this._showTerrainWireframe=d,this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(d){this._showLayers2DWireframe!==d&&(this._showLayers2DWireframe=d,this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(d){this._showLayers3DWireframe!==d&&(this._showLayers3DWireframe=d,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(d){this._speedIndexTiming!==d&&(this._speedIndexTiming=d,this._update())}get showPadding(){return!!this._showPadding}set showPadding(d){this._showPadding!==d&&(this._showPadding=d,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(d){this._showCollisionBoxes!==d&&(this._showCollisionBoxes=d,d?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(d){this._showOverdrawInspector!==d&&(this._showOverdrawInspector=d,this._update())}get repaint(){return!!this._repaint}set repaint(d){this._repaint!==d&&(this._repaint=d,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(d){this._vertices=d,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(d){this._showTileAABBs!==d&&(this._showTileAABBs=d,d&&this._update())}_setCacheLimits(d,a){s.dl(d,a)}get version(){return s.dk}},NavigationControl:class{constructor(d){this.options=s.e({},Jr,d),this._container=Ce("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",a=>a.preventDefault()),this.options.showZoom&&(s.aY(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",a=>{this._map&&this._map.zoomIn({},{originalEvent:a})}),Ce("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",a=>{this._map&&this._map.zoomOut({},{originalEvent:a})}),Ce("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.aY(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",a=>{const n=this._map;n&&(this.options.visualizePitch?n.resetNorthPitch({},{originalEvent:a}):n.resetNorth({},{originalEvent:a}))}),this._compassIcon=Ce("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const d=this._map;if(!d)return;const a=d.getZoom(),n=a===d.getMaxZoom(),_=a===d.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=_,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",_.toString())}_rotateCompassArrow(){const d=this._map;if(!d)return;const a=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(d.transform.pitch*(Math.PI/180)),.5)}) rotateX(${d.transform.pitch}deg) rotateZ(${d.transform.angle*(180/Math.PI)}deg)`:`rotate(${d.transform.angle*(180/Math.PI)}deg)`;d._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=a)})}onAdd(d){return this._map=d,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),d.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&d.on("pitch",this._rotateCompassArrow),d.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new _n(d,this._compass,this.options.visualizePitch)),this._container}onRemove(){const d=this._map;d&&(this._container.remove(),this.options.showZoom&&d.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&d.off("pitch",this._rotateCompassArrow),d.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(d,a){const n=Ce("button",d,this._container);return n.type="button",n.addEventListener("click",a),n}_setButtonTitle(d,a){if(!this._map)return;const n=this._map._getUIString(`NavigationControl.${a}`);d.setAttribute("aria-label",n),d.firstElementChild&&d.firstElementChild.setAttribute("title",n)}},GeolocateControl:class extends s.E{constructor(d){super();const a=navigator.geolocation;this.options=s.e({geolocation:a},Qr,d),s.aY(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Gl(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(d){return this._map=d,this._container=Ce("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(d){const a=(n=!!this.options.geolocation)=>{this._supportsGeolocation=n,d(n)};this._supportsGeolocation!==void 0?d(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(n=>a(n.state!=="denied")).catch(()=>a()):a()}_isOutOfMapMaxBounds(d){const a=this._map.getMaxBounds(),n=d.coords;return!!a&&(n.longitude<a.getWest()||n.longitude>a.getEast()||n.latitude<a.getSouth()||n.latitude>a.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(d){if(this._map){if(this._isOutOfMapMaxBounds(d))return this._setErrorState(),this.fire(new s.b("outofmaxbounds",d)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=d,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(d),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(d),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new s.b("geolocate",d)),this._finish()}}_updateCamera(d){const a=new s.bn(d.coords.longitude,d.coords.latitude),n=d.coords.accuracy,_=this._map.getBearing(),c=s.e({bearing:_},this.options.fitBoundsOptions);this._map.fitBounds(a.toBounds(n),c,{geolocateSource:!0})}_updateMarker(d){if(d){const a=new s.bn(d.coords.longitude,d.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=d.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const d=this._map.transform,a=s.bl(1,d._center.lat)*d.worldSize,n=Math.ceil(2*this._accuracy*a);this._circleElement.style.width=`${n}px`,this._circleElement.style.height=`${n}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(d){if(this._map){if(this.options.trackUserLocation)if(d.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",a),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(d.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new s.b("error",d)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(d){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",a=>a.preventDefault()),this._geolocateButton=Ce("button","mapboxgl-ctrl-geolocate",this._container),Ce("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",d===!1){s.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",a),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",a),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Ce("div","mapboxgl-user-location"),this._dotElement.appendChild(Ce("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Ce("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new ou({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Ce("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ou({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",a=>{a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||a.originalEvent&&a.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.b("trackuserlocationend")))})}}_onDeviceOrientation(d){this._userLocationDotMarker&&(d.webkitCompassHeading?this._heading=d.webkitCompassHeading:d.absolute===!0&&(this._heading=-1*d.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.b("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.b("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.b("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let d;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(d={maximumAge:6e5,timeout:0},this._noTimeout=!0):(d=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,d),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const d=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(a=>{a==="granted"&&d()}).catch(console.error):d()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:au,ScaleControl:class{constructor(d){this.options=s.e({},Va,d),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),s.aY(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const d=this.options.maxWidth||100,a=this._map,n=a._containerHeight/2,_=a._containerWidth/2-d/2,c=a.unproject([_,n]),f=a.unproject([_+d,n]),g=c.distanceTo(f);if(this.options.unit==="imperial"){const b=3.2808*g;b>5280?this._setScale(d,b/5280,"mile"):this._setScale(d,b,"foot")}else this.options.unit==="nautical"?this._setScale(d,g/1852,"nautical-mile"):g>=1e3?this._setScale(d,g/1e3,"kilometer"):this._setScale(d,g,"meter")}_setScale(d,a,n){this._map._requestDomTask(()=>{const _=function(f){const g=Math.pow(10,`${Math.floor(f)}`.length-1);let b=f/g;return b=b>=10?10:b>=5?5:b>=3?3:b>=2?2:b>=1?1:function(v){const A=Math.pow(10,Math.ceil(-Math.log(v)/Math.LN10));return Math.round(v*A)/A}(b),g*b}(a),c=_/a;this._container.innerHTML=this._isNumberFormatSupported&&n!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:n}).format(_):`${_}&nbsp;${Yn[n]}`,this._container.style.width=d*c+"px"})}onAdd(d){return this._map=d,this._language=d.getLanguage(),this._container=Ce("div","mapboxgl-ctrl mapboxgl-ctrl-scale",d.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(d){this._language=d,this._update()}setUnit(d){this.options.unit=d,this._update()}},FullscreenControl:class{constructor(d){this._fullscreen=!1,d&&d.container&&(d.container instanceof HTMLElement?this._container=d.container:s.w("Full screen control 'container' must be a DOM element.")),s.aY(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(d){return this._map=d,this._container||(this._container=this._map.getContainer()),this._controlContainer=Ce("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const d=this._fullscreenButton=Ce("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Ce("span","mapboxgl-ctrl-icon",d).setAttribute("aria-hidden","true"),d.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const d=this._getTitle();this._fullscreenButton.setAttribute("aria-label",d),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",d)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends s.E{constructor(d){super(),this.options=s.e(Object.create(Fc),d),s.aY(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(d&&d.className?d.className.trim().split(/\s+/):[])}addTo(d){return this._map&&this.remove(),this._map=d,this.options.closeOnClick&&d.on("preclick",this._onClose),this.options.closeOnMove&&d.on("move",this._onClose),d.on("remove",this.remove),this._update(),d._addPopup(this),this._focusFirstElement(),this._trackPointer?(d.on("mousemove",this._onMouseEvent),d.on("mouseup",this._onMouseEvent),d._canvasContainer.classList.add("mapboxgl-track-pointer")):d.on("move",this._update),this.fire(new s.b("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const d=this._map;return d&&(d.off("move",this._update),d.off("move",this._onClose),d.off("preclick",this._onClose),d.off("click",this._onClose),d.off("remove",this.remove),d.off("mousemove",this._onMouseEvent),d.off("mouseup",this._onMouseEvent),d.off("drag",this._onMouseEvent),d._canvasContainer&&d._canvasContainer.classList.remove("mapboxgl-track-pointer"),d._removePopup(this),this._map=void 0),this.fire(new s.b("close")),this}getLngLat(){return this._lngLat}setLngLat(d){this._lngLat=s.bn.convert(d),this._pos=null,this._trackPointer=!1,this._update();const a=this._map;return a&&(a.on("move",this._update),a.off("mousemove",this._onMouseEvent),a._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const d=this._map;return d&&(d.off("move",this._update),d.on("mousemove",this._onMouseEvent),d.on("drag",this._onMouseEvent),d._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(d){return this.setDOMContent(document.createTextNode(d))}setHTML(d){const a=document.createDocumentFragment(),n=document.createElement("body");let _;for(n.innerHTML=d;_=n.firstChild,_;)a.appendChild(_);return this.setDOMContent(a)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(d){return this.options.maxWidth=d,this._update(),this}setDOMContent(d){let a=this._content;if(a)for(;a.hasChildNodes();)a.firstChild&&a.removeChild(a.firstChild);else a=this._content=Ce("div","mapboxgl-popup-content",this._container||void 0);if(a.appendChild(d),this.options.closeButton){const n=this._closeButton=Ce("button","mapboxgl-popup-close-button",a);n.type="button",n.setAttribute("aria-label","Close popup"),n.setAttribute("aria-hidden","true"),n.innerHTML="&#215;",n.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(d){return this._classList.add(d),this._updateClassList(),this}removeClassName(d){return this._classList.delete(d),this._updateClassList(),this}setOffset(d){return this.options.offset=d,this._update(),this}toggleClassName(d){let a;return this._classList.delete(d)?a=!1:(this._classList.add(d),a=!0),this._updateClassList(),a}_onMouseEvent(d){this._update(d.point)}_getAnchor(d){if(this.options.anchor)return this.options.anchor;const a=this._map,n=this._container,_=this._pos;if(!a||!n||!_)return"bottom";const c=n.offsetWidth,f=n.offsetHeight,g=_.x<c/2,b=_.x>a.transform.width-c/2;if(_.y+d<f)return g?"top-left":b?"top-right":"top";if(_.y>a.transform.height-f){if(g)return"bottom-left";if(b)return"bottom-right"}return g?"left":b?"right":"bottom"}_updateClassList(){const d=this._container;if(!d)return;const a=[...this._classList];a.push("mapboxgl-popup"),this._anchor&&a.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&a.push("mapboxgl-popup-track-pointer"),d.className=a.join(" ")}_update(d){const a=this._map,n=this._content;if(!a||!this._lngLat&&!this._trackPointer||!n)return;let _=this._container;if(_||(_=this._container=Ce("div","mapboxgl-popup",a.getContainer()),this._tip=Ce("div","mapboxgl-popup-tip",_),_.appendChild(n)),this.options.maxWidth&&_.style.maxWidth!==this.options.maxWidth&&(_.style.maxWidth=this.options.maxWidth),a.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=tr(this._lngLat,this._pos,a.transform)),!this._trackPointer||d){const c=this._pos=this._trackPointer&&d?d:a.project(this._lngLat),f=Uc(this.options.offset),g=this._anchor=this._getAnchor(f.y),b=Uc(this.options.offset,g),v=c.add(b).round();a._requestDomTask(()=>{this._container&&g&&(this._container.style.transform=`${Xr[g]} translate(${v.x}px,${v.y}px)`)})}if(!this._marker&&a._showingGlobe()){const c=s.d6(a.transform,this._lngLat)?0:1;this._setOpacity(c)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const d=this._container.querySelector(Bc);d&&d.focus()}_onClose(){this.remove()}_setOpacity(d){this._container&&(this._container.style.opacity=`${d}`),this._content&&(this._content.style.pointerEvents=d?"auto":"none")}},Marker:ou,Style:Fo,LngLat:s.bn,LngLatBounds:s.ad,Point:s.P,MercatorCoordinate:s.L,FreeCameraOptions:Sl,Evented:s.E,config:s.d5,prewarm:s.dp,clearPrewarmedResources:s.dq,get accessToken(){return s.d5.ACCESS_TOKEN},set accessToken(d){s.d5.ACCESS_TOKEN=d},get baseApiUrl(){return s.d5.API_URL},set baseApiUrl(d){s.d5.API_URL=d},get workerCount(){return s.dr.workerCount},set workerCount(d){s.dr.workerCount=d},get maxParallelImageRequests(){return s.d5.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(d){s.d5.MAX_PARALLEL_IMAGE_REQUESTS=d},clearStorage(d){s.ds(d)},get workerUrl(){return s.dt.workerUrl},set workerUrl(d){s.dt.workerUrl=d},get workerClass(){return s.dt.workerClass},set workerClass(d){s.dt.workerClass=d},get workerParams(){return s.dt.workerParams},set workerParams(d){s.dt.workerParams=d},get dracoUrl(){return s.du()},set dracoUrl(d){s.dv(d)},get meshoptUrl(){return s.dw()},set meshoptUrl(d){s.dx(d)},setNow:s.f.setNow,restoreNow:s.f.restoreNow}});var ae=G;return ae})})(Sb);var Pv=Sb.exports;const Du=sf(Pv);function Cb(T,I){return T<I?-1:T>I?1:T>=I?0:NaN}function wb(T){let I=T,L=T;T.length===1&&(I=(ae,s)=>T(ae)-s,L=Lv(T));function F(ae,s,oe,he){for(oe==null&&(oe=0),he==null&&(he=ae.length);oe<he;){const ve=oe+he>>>1;L(ae[ve],s)<0?oe=ve+1:he=ve}return oe}function G(ae,s,oe,he){for(oe==null&&(oe=0),he==null&&(he=ae.length);oe<he;){const ve=oe+he>>>1;L(ae[ve],s)>0?he=ve:oe=ve+1}return oe}function te(ae,s,oe,he){oe==null&&(oe=0),he==null&&(he=ae.length);const ve=F(ae,s,oe,he-1);return ve>oe&&I(ae[ve-1],s)>-I(ae[ve],s)?ve-1:ve}return{left:F,center:te,right:G}}function Lv(T){return(I,L)=>Cb(T(I),L)}function Nv(T){return T===null?NaN:+T}const Wv=wb(Cb),Mv=Wv.right;wb(Nv).center;const Dv=Mv;var ph=Math.sqrt(50),hh=Math.sqrt(10),gh=Math.sqrt(2);function Fv(T,I,L){var F,G=-1,te,ae,s;if(I=+I,T=+T,L=+L,T===I&&L>0)return[T];if((F=I<T)&&(te=T,T=I,I=te),(s=Pb(T,I,L))===0||!isFinite(s))return[];if(s>0){let oe=Math.round(T/s),he=Math.round(I/s);for(oe*s<T&&++oe,he*s>I&&--he,ae=new Array(te=he-oe+1);++G<te;)ae[G]=(oe+G)*s}else{s=-s;let oe=Math.round(T*s),he=Math.round(I*s);for(oe/s<T&&++oe,he/s>I&&--he,ae=new Array(te=he-oe+1);++G<te;)ae[G]=(oe+G)/s}return F&&ae.reverse(),ae}function Pb(T,I,L){var F=(I-T)/Math.max(0,L),G=Math.floor(Math.log(F)/Math.LN10),te=F/Math.pow(10,G);return G>=0?(te>=ph?10:te>=hh?5:te>=gh?2:1)*Math.pow(10,G):-Math.pow(10,-G)/(te>=ph?10:te>=hh?5:te>=gh?2:1)}function Bv(T,I,L){var F=Math.abs(I-T)/Math.max(0,L),G=Math.pow(10,Math.floor(Math.log(F)/Math.LN10)),te=F/G;return te>=ph?G*=10:te>=hh?G*=5:te>=gh&&(G*=2),I<T?-G:G}function Uv(T,I){switch(arguments.length){case 0:break;case 1:this.range(T);break;default:this.range(I).domain(T);break}return this}function vh(T,I,L){T.prototype=I.prototype=L,L.constructor=T}function Lb(T,I){var L=Object.create(T.prototype);for(var F in I)L[F]=I[F];return L}function Gu(){}var ku=.7,qm=1/ku,Od="\\s*([+-]?\\d+)\\s*",zu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",$n="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",kv=/^#([0-9a-f]{3,8})$/,zv=new RegExp(`^rgb\\(${Od},${Od},${Od}\\)$`),Hv=new RegExp(`^rgb\\(${$n},${$n},${$n}\\)$`),Yv=new RegExp(`^rgba\\(${Od},${Od},${Od},${zu}\\)$`),Gv=new RegExp(`^rgba\\(${$n},${$n},${$n},${zu}\\)$`),Vv=new RegExp(`^hsl\\(${zu},${$n},${$n}\\)$`),jv=new RegExp(`^hsla\\(${zu},${$n},${$n},${zu}\\)$`),q1={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};vh(Gu,Hu,{copy(T){return Object.assign(new this.constructor,this,T)},displayable(){return this.rgb().displayable()},hex:$1,formatHex:$1,formatHex8:Kv,formatHsl:qv,formatRgb:Z1,toString:Z1});function $1(){return this.rgb().formatHex()}function Kv(){return this.rgb().formatHex8()}function qv(){return Nb(this).formatHsl()}function Z1(){return this.rgb().formatRgb()}function Hu(T){var I,L;return T=(T+"").trim().toLowerCase(),(I=kv.exec(T))?(L=I[1].length,I=parseInt(I[1],16),L===6?X1(I):L===3?new wo(I>>8&15|I>>4&240,I>>4&15|I&240,(I&15)<<4|I&15,1):L===8?Bm(I>>24&255,I>>16&255,I>>8&255,(I&255)/255):L===4?Bm(I>>12&15|I>>8&240,I>>8&15|I>>4&240,I>>4&15|I&240,((I&15)<<4|I&15)/255):null):(I=zv.exec(T))?new wo(I[1],I[2],I[3],1):(I=Hv.exec(T))?new wo(I[1]*255/100,I[2]*255/100,I[3]*255/100,1):(I=Yv.exec(T))?Bm(I[1],I[2],I[3],I[4]):(I=Gv.exec(T))?Bm(I[1]*255/100,I[2]*255/100,I[3]*255/100,I[4]):(I=Vv.exec(T))?eb(I[1],I[2]/100,I[3]/100,1):(I=jv.exec(T))?eb(I[1],I[2]/100,I[3]/100,I[4]):q1.hasOwnProperty(T)?X1(q1[T]):T==="transparent"?new wo(NaN,NaN,NaN,0):null}function X1(T){return new wo(T>>16&255,T>>8&255,T&255,1)}function Bm(T,I,L,F){return F<=0&&(T=I=L=NaN),new wo(T,I,L,F)}function $v(T){return T instanceof Gu||(T=Hu(T)),T?(T=T.rgb(),new wo(T.r,T.g,T.b,T.opacity)):new wo}function yh(T,I,L,F){return arguments.length===1?$v(T):new wo(T,I,L,F??1)}function wo(T,I,L,F){this.r=+T,this.g=+I,this.b=+L,this.opacity=+F}vh(wo,yh,Lb(Gu,{brighter(T){return T=T==null?qm:Math.pow(qm,T),new wo(this.r*T,this.g*T,this.b*T,this.opacity)},darker(T){return T=T==null?ku:Math.pow(ku,T),new wo(this.r*T,this.g*T,this.b*T,this.opacity)},rgb(){return this},clamp(){return new wo(gr(this.r),gr(this.g),gr(this.b),$m(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:J1,formatHex:J1,formatHex8:Zv,formatRgb:Q1,toString:Q1}));function J1(){return`#${hr(this.r)}${hr(this.g)}${hr(this.b)}`}function Zv(){return`#${hr(this.r)}${hr(this.g)}${hr(this.b)}${hr((isNaN(this.opacity)?1:this.opacity)*255)}`}function Q1(){const T=$m(this.opacity);return`${T===1?"rgb(":"rgba("}${gr(this.r)}, ${gr(this.g)}, ${gr(this.b)}${T===1?")":`, ${T})`}`}function $m(T){return isNaN(T)?1:Math.max(0,Math.min(1,T))}function gr(T){return Math.max(0,Math.min(255,Math.round(T)||0))}function hr(T){return T=gr(T),(T<16?"0":"")+T.toString(16)}function eb(T,I,L,F){return F<=0?T=I=L=NaN:L<=0||L>=1?T=I=NaN:I<=0&&(T=NaN),new Tn(T,I,L,F)}function Nb(T){if(T instanceof Tn)return new Tn(T.h,T.s,T.l,T.opacity);if(T instanceof Gu||(T=Hu(T)),!T)return new Tn;if(T instanceof Tn)return T;T=T.rgb();var I=T.r/255,L=T.g/255,F=T.b/255,G=Math.min(I,L,F),te=Math.max(I,L,F),ae=NaN,s=te-G,oe=(te+G)/2;return s?(I===te?ae=(L-F)/s+(L<F)*6:L===te?ae=(F-I)/s+2:ae=(I-L)/s+4,s/=oe<.5?te+G:2-te-G,ae*=60):s=oe>0&&oe<1?0:ae,new Tn(ae,s,oe,T.opacity)}function Xv(T,I,L,F){return arguments.length===1?Nb(T):new Tn(T,I,L,F??1)}function Tn(T,I,L,F){this.h=+T,this.s=+I,this.l=+L,this.opacity=+F}vh(Tn,Xv,Lb(Gu,{brighter(T){return T=T==null?qm:Math.pow(qm,T),new Tn(this.h,this.s,this.l*T,this.opacity)},darker(T){return T=T==null?ku:Math.pow(ku,T),new Tn(this.h,this.s,this.l*T,this.opacity)},rgb(){var T=this.h%360+(this.h<0)*360,I=isNaN(T)||isNaN(this.s)?0:this.s,L=this.l,F=L+(L<.5?L:1-L)*I,G=2*L-F;return new wo(ih(T>=240?T-240:T+120,G,F),ih(T,G,F),ih(T<120?T+240:T-120,G,F),this.opacity)},clamp(){return new Tn(tb(this.h),Um(this.s),Um(this.l),$m(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const T=$m(this.opacity);return`${T===1?"hsl(":"hsla("}${tb(this.h)}, ${Um(this.s)*100}%, ${Um(this.l)*100}%${T===1?")":`, ${T})`}`}}));function tb(T){return T=(T||0)%360,T<0?T+360:T}function Um(T){return Math.max(0,Math.min(1,T||0))}function ih(T,I,L){return(T<60?I+(L-I)*T/60:T<180?L:T<240?I+(L-I)*(240-T)/60:I)*255}const Eh=T=>()=>T;function Jv(T,I){return function(L){return T+L*I}}function Qv(T,I,L){return T=Math.pow(T,L),I=Math.pow(I,L)-T,L=1/L,function(F){return Math.pow(T+F*I,L)}}function eE(T){return(T=+T)==1?Wb:function(I,L){return L-I?Qv(I,L,T):Eh(isNaN(I)?L:I)}}function Wb(T,I){var L=I-T;return L?Jv(T,L):Eh(isNaN(T)?I:T)}const ib=function T(I){var L=eE(I);function F(G,te){var ae=L((G=yh(G)).r,(te=yh(te)).r),s=L(G.g,te.g),oe=L(G.b,te.b),he=Wb(G.opacity,te.opacity);return function(ve){return G.r=ae(ve),G.g=s(ve),G.b=oe(ve),G.opacity=he(ve),G+""}}return F.gamma=T,F}(1);function tE(T,I){I||(I=[]);var L=T?Math.min(I.length,T.length):0,F=I.slice(),G;return function(te){for(G=0;G<L;++G)F[G]=T[G]*(1-te)+I[G]*te;return F}}function iE(T){return ArrayBuffer.isView(T)&&!(T instanceof DataView)}function aE(T,I){var L=I?I.length:0,F=T?Math.min(L,T.length):0,G=new Array(F),te=new Array(L),ae;for(ae=0;ae<F;++ae)G[ae]=Ah(T[ae],I[ae]);for(;ae<L;++ae)te[ae]=I[ae];return function(s){for(ae=0;ae<F;++ae)te[ae]=G[ae](s);return te}}function oE(T,I){var L=new Date;return T=+T,I=+I,function(F){return L.setTime(T*(1-F)+I*F),L}}function Zm(T,I){return T=+T,I=+I,function(L){return T*(1-L)+I*L}}function nE(T,I){var L={},F={},G;(T===null||typeof T!="object")&&(T={}),(I===null||typeof I!="object")&&(I={});for(G in I)G in T?L[G]=Ah(T[G],I[G]):F[G]=I[G];return function(te){for(G in L)F[G]=L[G](te);return F}}var bh=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ah=new RegExp(bh.source,"g");function sE(T){return function(){return T}}function lE(T){return function(I){return T(I)+""}}function rE(T,I){var L=bh.lastIndex=ah.lastIndex=0,F,G,te,ae=-1,s=[],oe=[];for(T=T+"",I=I+"";(F=bh.exec(T))&&(G=ah.exec(I));)(te=G.index)>L&&(te=I.slice(L,te),s[ae]?s[ae]+=te:s[++ae]=te),(F=F[0])===(G=G[0])?s[ae]?s[ae]+=G:s[++ae]=G:(s[++ae]=null,oe.push({i:ae,x:Zm(F,G)})),L=ah.lastIndex;return L<I.length&&(te=I.slice(L),s[ae]?s[ae]+=te:s[++ae]=te),s.length<2?oe[0]?lE(oe[0].x):sE(I):(I=oe.length,function(he){for(var ve=0,Ye;ve<I;++ve)s[(Ye=oe[ve]).i]=Ye.x(he);return s.join("")})}function Ah(T,I){var L=typeof I,F;return I==null||L==="boolean"?Eh(I):(L==="number"?Zm:L==="string"?(F=Hu(I))?(I=F,ib):rE:I instanceof Hu?ib:I instanceof Date?oE:iE(I)?tE:Array.isArray(I)?aE:typeof I.valueOf!="function"&&typeof I.toString!="function"||isNaN(I)?nE:Zm)(T,I)}function dE(T,I){return T=+T,I=+I,function(L){return Math.round(T*(1-L)+I*L)}}function _E(T){return function(){return T}}function uE(T){return+T}var ab=[0,1];function cl(T){return T}function Th(T,I){return(I-=T=+T)?function(L){return(L-T)/I}:_E(isNaN(I)?NaN:.5)}function cE(T,I){var L;return T>I&&(L=T,T=I,I=L),function(F){return Math.max(T,Math.min(I,F))}}function mE(T,I,L){var F=T[0],G=T[1],te=I[0],ae=I[1];return G<F?(F=Th(G,F),te=L(ae,te)):(F=Th(F,G),te=L(te,ae)),function(s){return te(F(s))}}function fE(T,I,L){var F=Math.min(T.length,I.length)-1,G=new Array(F),te=new Array(F),ae=-1;for(T[F]<T[0]&&(T=T.slice().reverse(),I=I.slice().reverse());++ae<F;)G[ae]=Th(T[ae],T[ae+1]),te[ae]=L(I[ae],I[ae+1]);return function(s){var oe=Dv(T,s,1,F)-1;return te[oe](G[oe](s))}}function pE(T,I){return I.domain(T.domain()).range(T.range()).interpolate(T.interpolate()).clamp(T.clamp()).unknown(T.unknown())}function hE(){var T=ab,I=ab,L=Ah,F,G,te,ae=cl,s,oe,he;function ve(){var Ce=Math.min(T.length,I.length);return ae!==cl&&(ae=cE(T[0],T[Ce-1])),s=Ce>2?fE:mE,oe=he=null,Ye}function Ye(Ce){return Ce==null||isNaN(Ce=+Ce)?te:(oe||(oe=s(T.map(F),I,L)))(F(ae(Ce)))}return Ye.invert=function(Ce){return ae(G((he||(he=s(I,T.map(F),Zm)))(Ce)))},Ye.domain=function(Ce){return arguments.length?(T=Array.from(Ce,uE),ve()):T.slice()},Ye.range=function(Ce){return arguments.length?(I=Array.from(Ce),ve()):I.slice()},Ye.rangeRound=function(Ce){return I=Array.from(Ce),L=dE,ve()},Ye.clamp=function(Ce){return arguments.length?(ae=Ce?!0:cl,ve()):ae!==cl},Ye.interpolate=function(Ce){return arguments.length?(L=Ce,ve()):L},Ye.unknown=function(Ce){return arguments.length?(te=Ce,Ye):te},function(Ce,lt){return F=Ce,G=lt,ve()}}function gE(T){return Math.abs(T=Math.round(T))>=1e21?T.toLocaleString("en").replace(/,/g,""):T.toString(10)}function Xm(T,I){if((L=(T=I?T.toExponential(I-1):T.toExponential()).indexOf("e"))<0)return null;var L,F=T.slice(0,L);return[F.length>1?F[0]+F.slice(2):F,+T.slice(L+1)]}function wd(T){return T=Xm(Math.abs(T)),T?T[1]:NaN}function yE(T,I){return function(L,F){for(var G=L.length,te=[],ae=0,s=T[0],oe=0;G>0&&s>0&&(oe+s+1>F&&(s=Math.max(1,F-oe)),te.push(L.substring(G-=s,G+s)),!((oe+=s+1)>F));)s=T[ae=(ae+1)%T.length];return te.reverse().join(I)}}function bE(T){return function(I){return I.replace(/[0-9]/g,function(L){return T[+L]})}}var TE=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Jm(T){if(!(I=TE.exec(T)))throw new Error("invalid format: "+T);var I;return new Ih({fill:I[1],align:I[2],sign:I[3],symbol:I[4],zero:I[5],width:I[6],comma:I[7],precision:I[8]&&I[8].slice(1),trim:I[9],type:I[10]})}Jm.prototype=Ih.prototype;function Ih(T){this.fill=T.fill===void 0?" ":T.fill+"",this.align=T.align===void 0?">":T.align+"",this.sign=T.sign===void 0?"-":T.sign+"",this.symbol=T.symbol===void 0?"":T.symbol+"",this.zero=!!T.zero,this.width=T.width===void 0?void 0:+T.width,this.comma=!!T.comma,this.precision=T.precision===void 0?void 0:+T.precision,this.trim=!!T.trim,this.type=T.type===void 0?"":T.type+""}Ih.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function xE(T){e:for(var I=T.length,L=1,F=-1,G;L<I;++L)switch(T[L]){case".":F=G=L;break;case"0":F===0&&(F=L),G=L;break;default:if(!+T[L])break e;F>0&&(F=0);break}return F>0?T.slice(0,F)+T.slice(G+1):T}var Mb;function vE(T,I){var L=Xm(T,I);if(!L)return T+"";var F=L[0],G=L[1],te=G-(Mb=Math.max(-8,Math.min(8,Math.floor(G/3)))*3)+1,ae=F.length;return te===ae?F:te>ae?F+new Array(te-ae+1).join("0"):te>0?F.slice(0,te)+"."+F.slice(te):"0."+new Array(1-te).join("0")+Xm(T,Math.max(0,I+te-1))[0]}function ob(T,I){var L=Xm(T,I);if(!L)return T+"";var F=L[0],G=L[1];return G<0?"0."+new Array(-G).join("0")+F:F.length>G+1?F.slice(0,G+1)+"."+F.slice(G+1):F+new Array(G-F.length+2).join("0")}const nb={"%":(T,I)=>(T*100).toFixed(I),b:T=>Math.round(T).toString(2),c:T=>T+"",d:gE,e:(T,I)=>T.toExponential(I),f:(T,I)=>T.toFixed(I),g:(T,I)=>T.toPrecision(I),o:T=>Math.round(T).toString(8),p:(T,I)=>ob(T*100,I),r:ob,s:vE,X:T=>Math.round(T).toString(16).toUpperCase(),x:T=>Math.round(T).toString(16)};function sb(T){return T}var lb=Array.prototype.map,rb=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function EE(T){var I=T.grouping===void 0||T.thousands===void 0?sb:yE(lb.call(T.grouping,Number),T.thousands+""),L=T.currency===void 0?"":T.currency[0]+"",F=T.currency===void 0?"":T.currency[1]+"",G=T.decimal===void 0?".":T.decimal+"",te=T.numerals===void 0?sb:bE(lb.call(T.numerals,String)),ae=T.percent===void 0?"%":T.percent+"",s=T.minus===void 0?"":T.minus+"",oe=T.nan===void 0?"NaN":T.nan+"";function he(Ye){Ye=Jm(Ye);var Ce=Ye.fill,lt=Ye.align,Ke=Ye.sign,Nt=Ye.symbol,Oe=Ye.zero,ut=Ye.width,bt=Ye.comma,Mt=Ye.precision,Fi=Ye.trim,ai=Ye.type;ai==="n"?(bt=!0,ai="g"):nb[ai]||(Mt===void 0&&(Mt=12),Fi=!0,ai="g"),(Oe||Ce==="0"&&lt==="=")&&(Oe=!0,Ce="0",lt="=");var Oi=Nt==="$"?L:Nt==="#"&&/[boxX]/.test(ai)?"0"+ai.toLowerCase():"",va=Nt==="$"?F:/[%p]/.test(ai)?ae:"",qe=nb[ai],yo=/[defgprs%]/.test(ai);Mt=Mt===void 0?6:/[gprs]/.test(ai)?Math.max(1,Math.min(21,Mt)):Math.max(0,Math.min(20,Mt));function En(Ot){var na=Oi,ka=va,ot,Qa,Ea;if(ai==="c")ka=qe(Ot)+ka,Ot="";else{Ot=+Ot;var Vt=Ot<0||1/Ot<0;if(Ot=isNaN(Ot)?oe:qe(Math.abs(Ot),Mt),Fi&&(Ot=xE(Ot)),Vt&&+Ot==0&&Ke!=="+"&&(Vt=!1),na=(Vt?Ke==="("?Ke:s:Ke==="-"||Ke==="("?"":Ke)+na,ka=(ai==="s"?rb[8+Mb/3]:"")+ka+(Vt&&Ke==="("?")":""),yo){for(ot=-1,Qa=Ot.length;++ot<Qa;)if(Ea=Ot.charCodeAt(ot),48>Ea||Ea>57){ka=(Ea===46?G+Ot.slice(ot+1):Ot.slice(ot))+ka,Ot=Ot.slice(0,ot);break}}}bt&&!Oe&&(Ot=I(Ot,1/0));var Lo=na.length+Ot.length+ka.length,Na=Lo<ut?new Array(ut-Lo+1).join(Ce):"";switch(bt&&Oe&&(Ot=I(Na+Ot,Na.length?ut-ka.length:1/0),Na=""),lt){case"<":Ot=na+Ot+ka+Na;break;case"=":Ot=na+Na+Ot+ka;break;case"^":Ot=Na.slice(0,Lo=Na.length>>1)+na+Ot+ka+Na.slice(Lo);break;default:Ot=Na+na+Ot+ka;break}return te(Ot)}return En.toString=function(){return Ye+""},En}function ve(Ye,Ce){var lt=he((Ye=Jm(Ye),Ye.type="f",Ye)),Ke=Math.max(-8,Math.min(8,Math.floor(wd(Ce)/3)))*3,Nt=Math.pow(10,-Ke),Oe=rb[8+Ke/3];return function(ut){return lt(Nt*ut)+Oe}}return{format:he,formatPrefix:ve}}var km,Db,Fb;AE({thousands:",",grouping:[3],currency:["$",""]});function AE(T){return km=EE(T),Db=km.format,Fb=km.formatPrefix,km}function IE(T){return Math.max(0,-wd(Math.abs(T)))}function OE(T,I){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(wd(I)/3)))*3-wd(Math.abs(T)))}function SE(T,I){return T=Math.abs(T),I=Math.abs(I)-T,Math.max(0,wd(I)-wd(T))+1}function RE(T,I,L,F){var G=Bv(T,I,L),te;switch(F=Jm(F??",f"),F.type){case"s":{var ae=Math.max(Math.abs(T),Math.abs(I));return F.precision==null&&!isNaN(te=OE(G,ae))&&(F.precision=te),Fb(F,ae)}case"":case"e":case"g":case"p":case"r":{F.precision==null&&!isNaN(te=SE(G,Math.max(Math.abs(T),Math.abs(I))))&&(F.precision=te-(F.type==="e"));break}case"f":case"%":{F.precision==null&&!isNaN(te=IE(G))&&(F.precision=te-(F.type==="%")*2);break}}return Db(F)}function CE(T){var I=T.domain;return T.ticks=function(L){var F=I();return Fv(F[0],F[F.length-1],L??10)},T.tickFormat=function(L,F){var G=I();return RE(G[0],G[G.length-1],L??10,F)},T.nice=function(L){L==null&&(L=10);var F=I(),G=0,te=F.length-1,ae=F[G],s=F[te],oe,he,ve=10;for(s<ae&&(he=ae,ae=s,s=he,he=G,G=te,te=he);ve-- >0;){if(he=Pb(ae,s,L),he===oe)return F[G]=ae,F[te]=s,I(F);if(he>0)ae=Math.floor(ae/he)*he,s=Math.ceil(s/he)*he;else if(he<0)ae=Math.ceil(ae*he)/he,s=Math.floor(s*he)/he;else break;oe=he}return T},T}function db(T){return function(I){return I<0?-Math.pow(-I,T):Math.pow(I,T)}}function wE(T){return T<0?-Math.sqrt(-T):Math.sqrt(T)}function PE(T){return T<0?-T*T:T*T}function LE(T){var I=T(cl,cl),L=1;function F(){return L===1?T(cl,cl):L===.5?T(wE,PE):T(db(L),db(1/L))}return I.exponent=function(G){return arguments.length?(L=+G,F()):L},CE(I)}function Bb(){var T=LE(hE());return T.copy=function(){return pE(T,Bb()).exponent(T.exponent())},Uv.apply(T,arguments),T}function NE(){return Bb.apply(null,arguments).exponent(.5)}function _b(T,I,L){const F=T.slice();return F[2]=I[L].label,F[3]=I[L].value,F}function ub(T){let I,L,F,G,te,ae,s=T[2]+"",oe,he;return{c(){I=Ja("div"),L=k1("svg"),F=k1("circle"),te=xn(),ae=Ja("span"),oe=vb(s),he=xn(),ba(F,"cx","20"),ba(F,"cy","20"),ba(F,"r",G=T[0](T[3])),ba(F,"fill","grey"),ba(L,"width","40"),ba(L,"height","40"),ba(ae,"class","svelte-1tl7k48"),ba(I,"class","legend-item svelte-1tl7k48")},m(ve,Ye){Bu(ve,I,Ye),ra(I,L),ra(L,F),ra(I,te),ra(I,ae),ra(ae,oe),ra(I,he)},p(ve,Ye){Ye&1&&G!==(G=ve[0](ve[3]))&&ba(F,"r",G)},d(ve){ve&&Cd(I)}}}function WE(T){let I,L,F,G,te=T[1],ae=[];for(let s=0;s<te.length;s+=1)ae[s]=ub(_b(T,te,s));return{c(){I=Ja("div"),L=Ja("span"),L.textContent="Measured in dry tons",F=xn(),G=Ja("div");for(let s=0;s<ae.length;s+=1)ae[s].c();ba(L,"class","dek"),ba(G,"class","items svelte-1tl7k48"),ba(I,"class","legend svelte-1tl7k48")},m(s,oe){Bu(s,I,oe),ra(I,L),ra(I,F),ra(I,G);for(let he=0;he<ae.length;he+=1)ae[he]&&ae[he].m(G,null)},p(s,[oe]){if(oe&3){te=s[1];let he;for(he=0;he<te.length;he+=1){const ve=_b(s,te,he);ae[he]?ae[he].p(ve,oe):(ae[he]=ub(ve),ae[he].c(),ae[he].m(G,null))}for(;he<ae.length;he+=1)ae[he].d(1);ae.length=te.length}},i:go,o:go,d(s){s&&Cd(I),Qx(ae,s)}}}function ME(T,I,L){let{rScale:F}=I;const G=[{label:"1k",value:1e3},{label:"10k",value:1e4},{label:"100k",value:1e5}];return T.$$set=te=>{"rScale"in te&&L(0,F=te.rScale)},[F,G]}class DE extends nf{constructor(I){super(),of(this,I,ME,WE,Yu,{rScale:0})}}var Nd=BE,FE=Object.prototype.hasOwnProperty;function BE(){for(var T={},I=0;I<arguments.length;I++){var L=arguments[I];for(var F in L)FE.call(L,F)&&(T[F]=L[F])}return T}var Ub={exports:{}};(function(T,I){(function(){var L={};T.exports=L,L.simpleFilter=function(F,G){return G.filter(function(te){return L.test(F,te)})},L.test=function(F,G){return L.match(F,G)!==null},L.match=function(F,G,te){te=te||{};var ae=0,s=[],oe=G.length,he=0,ve=0,Ye=te.pre||"",Ce=te.post||"",lt=te.caseSensitive&&G||G.toLowerCase(),Ke;F=te.caseSensitive&&F||F.toLowerCase();for(var Nt=0;Nt<oe;Nt++)Ke=G[Nt],lt[Nt]===F[ae]?(Ke=Ye+Ke+Ce,ae+=1,ve+=1+ve):ve=0,he+=ve,s[s.length]=Ke;return ae===F.length?(he=lt===F?1/0:he,{rendered:s.join(""),score:he}):null},L.filter=function(F,G,te){return!G||G.length===0?[]:typeof F!="string"?G:(te=te||{},G.reduce(function(ae,s,oe,he){var ve=s;te.extract&&(ve=te.extract(s));var Ye=L.match(F,ve,te);return Ye!=null&&(ae[ae.length]={string:Ye.rendered,score:Ye.score,index:oe,original:s}),ae},[]).sort(function(ae,s){var oe=s.score-ae.score;return oe||ae.index-s.index}))}})()})(Ub);var UE=Ub.exports,Po=function(T){return this.component=T,this.items=[],this.active=0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,T.el.parentNode.insertBefore(this.wrapper,T.el.nextSibling),this};Po.prototype.show=function(){this.element.style.display="block"};Po.prototype.hide=function(){this.element.style.display="none"};Po.prototype.add=function(T){this.items.push(T)};Po.prototype.clear=function(){this.items=[],this.active=0};Po.prototype.isEmpty=function(){return!this.items.length};Po.prototype.isVisible=function(){return this.element.style.display==="block"};Po.prototype.draw=function(){if(this.element.innerHTML="",this.items.length===0){this.hide();return}for(var T=0;T<this.items.length;T++)this.drawItem(this.items[T],this.active===T);this.show()};Po.prototype.drawItem=function(T,I){var L=document.createElement("li"),F=document.createElement("a");I&&(L.className+=" active"),F.innerHTML=T.string,L.appendChild(F),this.element.appendChild(L),L.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),L.addEventListener("mouseup",(function(){this.handleMouseUp.call(this,T)}).bind(this))};Po.prototype.handleMouseUp=function(T){this.selectingListItem=!1,this.component.value(T.original),this.clear(),this.draw()};Po.prototype.move=function(T){this.active=T,this.draw()};Po.prototype.previous=function(){this.move(this.active===0?this.items.length-1:this.active-1)};Po.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)};Po.prototype.drawError=function(T){var I=document.createElement("li");I.innerHTML=T,this.element.appendChild(I),this.show()};var kE=Po,zE=Nd,HE=UE,YE=kE,_o=function(T,I,L){return L=L||{},this.options=zE({minLength:2,limit:5,filter:!0,hideOnBlur:!0},L),this.el=T,this.data=I||[],this.list=new YE(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",(function(F){this.handleKeyUp(F.keyCode)}).bind(this),!1),this.el.addEventListener("keydown",(function(F){this.handleKeyDown(F)}).bind(this)),this.el.addEventListener("focus",(function(){this.handleFocus()}).bind(this)),this.el.addEventListener("blur",(function(){this.handleBlur()}).bind(this)),this.el.addEventListener("paste",(function(F){this.handlePaste(F)}).bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};_o.prototype.handleKeyUp=function(T){T===40||T===38||T===27||T===13||T===9||this.handleInputChange(this.el.value)};_o.prototype.handleKeyDown=function(T){switch(T.keyCode){case 13:case 9:this.list.isEmpty()||(this.list.isVisible()&&T.preventDefault(),this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next();break}};_o.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()};_o.prototype.handlePaste=function(T){if(T.clipboardData)this.handleInputChange(T.clipboardData.getData("Text"));else{var I=this;setTimeout(function(){I.handleInputChange(T.target.value)},100)}};_o.prototype.handleInputChange=function(T){if(this.query=this.normalize(T),this.list.clear(),this.query.length<this.options.minLength){this.list.draw();return}this.getCandidates((function(I){for(var L=0;L<I.length&&(this.list.add(I[L]),L!==this.options.limit-1);L++);this.list.draw()}).bind(this))};_o.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1};_o.prototype.update=function(T){this.data=T,this.handleKeyUp()};_o.prototype.clear=function(){this.data=[],this.list.clear()};_o.prototype.normalize=function(T){return T=T.toLowerCase(),T};_o.prototype.match=function(T,I){return T.indexOf(I)>-1};_o.prototype.value=function(T){if(this.selected=T,this.el.value=this.getItemValue(T),document.createEvent){var I=document.createEvent("HTMLEvents");I.initEvent("change",!0,!1),this.el.dispatchEvent(I)}else this.el.fireEvent("onchange")};_o.prototype.getCandidates=function(T){var I={pre:"<strong>",post:"</strong>",extract:(function(F){return this.getItemValue(F)}).bind(this)},L;this.options.filter?(L=HE.filter(this.query,this.data,I),L=L.map((function(F){return{original:F.original,string:this.render(F.original,F.string)}}).bind(this))):L=this.data.map((function(F){var G=this.render(F);return{original:F,string:G}}).bind(this)),T(L)};_o.prototype.getItemValue=function(T){return T};_o.prototype.render=function(T,I){if(I)return I;for(var L=T.original?this.getItemValue(T.original):this.getItemValue(T),F=this.normalize(L),G=F.lastIndexOf(this.query);G>-1;){var te=G+this.query.length;L=L.slice(0,G)+"<strong>"+L.slice(G,te)+"</strong>"+L.slice(te),G=F.slice(0,G).lastIndexOf(this.query)}return L};_o.prototype.renderError=function(T){this.list.drawError(T)};var GE=_o,kb=GE,VE=kb;typeof window<"u"&&(window.Suggestions=kb);var Oh={exports:{}},Sd=typeof Reflect=="object"?Reflect:null,cb=Sd&&typeof Sd.apply=="function"?Sd.apply:function(I,L,F){return Function.prototype.apply.call(I,L,F)},Ym;Sd&&typeof Sd.ownKeys=="function"?Ym=Sd.ownKeys:Object.getOwnPropertySymbols?Ym=function(I){return Object.getOwnPropertyNames(I).concat(Object.getOwnPropertySymbols(I))}:Ym=function(I){return Object.getOwnPropertyNames(I)};function jE(T){console&&console.warn&&console.warn(T)}var zb=Number.isNaN||function(I){return I!==I};function oa(){oa.init.call(this)}Oh.exports=oa;Oh.exports.once=ZE;oa.EventEmitter=oa;oa.prototype._events=void 0;oa.prototype._eventsCount=0;oa.prototype._maxListeners=void 0;var mb=10;function lf(T){if(typeof T!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof T)}Object.defineProperty(oa,"defaultMaxListeners",{enumerable:!0,get:function(){return mb},set:function(T){if(typeof T!="number"||T<0||zb(T))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+T+".");mb=T}});oa.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};oa.prototype.setMaxListeners=function(I){if(typeof I!="number"||I<0||zb(I))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+I+".");return this._maxListeners=I,this};function Hb(T){return T._maxListeners===void 0?oa.defaultMaxListeners:T._maxListeners}oa.prototype.getMaxListeners=function(){return Hb(this)};oa.prototype.emit=function(I){for(var L=[],F=1;F<arguments.length;F++)L.push(arguments[F]);var G=I==="error",te=this._events;if(te!==void 0)G=G&&te.error===void 0;else if(!G)return!1;if(G){var ae;if(L.length>0&&(ae=L[0]),ae instanceof Error)throw ae;var s=new Error("Unhandled error."+(ae?" ("+ae.message+")":""));throw s.context=ae,s}var oe=te[I];if(oe===void 0)return!1;if(typeof oe=="function")cb(oe,this,L);else for(var he=oe.length,ve=Kb(oe,he),F=0;F<he;++F)cb(ve[F],this,L);return!0};function Yb(T,I,L,F){var G,te,ae;if(lf(L),te=T._events,te===void 0?(te=T._events=Object.create(null),T._eventsCount=0):(te.newListener!==void 0&&(T.emit("newListener",I,L.listener?L.listener:L),te=T._events),ae=te[I]),ae===void 0)ae=te[I]=L,++T._eventsCount;else if(typeof ae=="function"?ae=te[I]=F?[L,ae]:[ae,L]:F?ae.unshift(L):ae.push(L),G=Hb(T),G>0&&ae.length>G&&!ae.warned){ae.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+ae.length+" "+String(I)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=T,s.type=I,s.count=ae.length,jE(s)}return T}oa.prototype.addListener=function(I,L){return Yb(this,I,L,!1)};oa.prototype.on=oa.prototype.addListener;oa.prototype.prependListener=function(I,L){return Yb(this,I,L,!0)};function KE(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Gb(T,I,L){var F={fired:!1,wrapFn:void 0,target:T,type:I,listener:L},G=KE.bind(F);return G.listener=L,F.wrapFn=G,G}oa.prototype.once=function(I,L){return lf(L),this.on(I,Gb(this,I,L)),this};oa.prototype.prependOnceListener=function(I,L){return lf(L),this.prependListener(I,Gb(this,I,L)),this};oa.prototype.removeListener=function(I,L){var F,G,te,ae,s;if(lf(L),G=this._events,G===void 0)return this;if(F=G[I],F===void 0)return this;if(F===L||F.listener===L)--this._eventsCount===0?this._events=Object.create(null):(delete G[I],G.removeListener&&this.emit("removeListener",I,F.listener||L));else if(typeof F!="function"){for(te=-1,ae=F.length-1;ae>=0;ae--)if(F[ae]===L||F[ae].listener===L){s=F[ae].listener,te=ae;break}if(te<0)return this;te===0?F.shift():qE(F,te),F.length===1&&(G[I]=F[0]),G.removeListener!==void 0&&this.emit("removeListener",I,s||L)}return this};oa.prototype.off=oa.prototype.removeListener;oa.prototype.removeAllListeners=function(I){var L,F,G;if(F=this._events,F===void 0)return this;if(F.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):F[I]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete F[I]),this;if(arguments.length===0){var te=Object.keys(F),ae;for(G=0;G<te.length;++G)ae=te[G],ae!=="removeListener"&&this.removeAllListeners(ae);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(L=F[I],typeof L=="function")this.removeListener(I,L);else if(L!==void 0)for(G=L.length-1;G>=0;G--)this.removeListener(I,L[G]);return this};function Vb(T,I,L){var F=T._events;if(F===void 0)return[];var G=F[I];return G===void 0?[]:typeof G=="function"?L?[G.listener||G]:[G]:L?$E(G):Kb(G,G.length)}oa.prototype.listeners=function(I){return Vb(this,I,!0)};oa.prototype.rawListeners=function(I){return Vb(this,I,!1)};oa.listenerCount=function(T,I){return typeof T.listenerCount=="function"?T.listenerCount(I):jb.call(T,I)};oa.prototype.listenerCount=jb;function jb(T){var I=this._events;if(I!==void 0){var L=I[T];if(typeof L=="function")return 1;if(L!==void 0)return L.length}return 0}oa.prototype.eventNames=function(){return this._eventsCount>0?Ym(this._events):[]};function Kb(T,I){for(var L=new Array(I),F=0;F<I;++F)L[F]=T[F];return L}function qE(T,I){for(;I+1<T.length;I++)T[I]=T[I+1];T.pop()}function $E(T){for(var I=new Array(T.length),L=0;L<I.length;++L)I[L]=T[L].listener||T[L];return I}function ZE(T,I){return new Promise(function(L,F){function G(ae){T.removeListener(I,te),F(ae)}function te(){typeof T.removeListener=="function"&&T.removeListener("error",G),L([].slice.call(arguments))}qb(T,I,te,{once:!0}),I!=="error"&&XE(T,G,{once:!0})})}function XE(T,I,L){typeof T.on=="function"&&qb(T,"error",I,L)}function qb(T,I,L,F){if(typeof T.on=="function")F.once?T.once(I,L):T.on(I,L);else if(typeof T.addEventListener=="function")T.addEventListener(I,function G(te){F.once&&T.removeEventListener(I,G),L(te)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof T)}var JE=Oh.exports,QE={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}};function e4(T){var I=T.match(/\s*(.+)\s*=\s*"?([^"]+)"?/);return I?{key:I[1],value:I[2]}:null}function t4(T){var I=T.match(/<?([^>]*)>(.*)/);if(!I)return null;var L=I[1],F=I[2].split(";"),G=null,te=F.reduce(function(ae,s){var oe=e4(s);return oe?oe.key==="rel"?(G||(G=oe.value),ae):(ae[oe.key]=oe.value,ae):ae},{});return G?{url:L,rel:G,params:te}:null}function i4(T){return T?T.split(/,\s*</).reduce(function(I,L){var F=t4(L);if(!F)return I;var G=F.rel.split(/\s+/);return G.forEach(function(te){I[te]||(I[te]={url:F.url,params:F.params})}),I},{}):{}}var a4=i4,o4=a4;function Sh(T,I){this.request=T,this.headers=I.headers,this.rawBody=I.body,this.statusCode=I.statusCode;try{this.body=JSON.parse(I.body||"{}")}catch{this.body=I.body}this.links=o4(this.headers.link)}Sh.prototype.hasNextPage=function(){return!!this.links.next};Sh.prototype.nextPage=function(){return this.hasNextPage()?this.request._extend({path:this.links.next.url}):null};var n4=Sh,rf={API_ORIGIN:"https://api.mapbox.com",EVENT_PROGRESS_DOWNLOAD:"downloadProgress",EVENT_PROGRESS_UPLOAD:"uploadProgress",EVENT_ERROR:"error",EVENT_RESPONSE:"response",ERROR_HTTP:"HttpError",ERROR_REQUEST_ABORTED:"RequestAbortedError"},fb=rf;function s4(T){var I=T.type||fb.ERROR_HTTP,L;if(T.body)try{L=JSON.parse(T.body)}catch{L=T.body}else L=null;var F=T.message||null;F||(typeof L=="string"?F=L:L&&typeof L.message=="string"?F=L.message:I===fb.ERROR_REQUEST_ABORTED&&(F="Request aborted")),this.message=F,this.type=I,this.statusCode=T.statusCode||null,this.request=T.request,this.body=L}var l4=s4;function r4(T){var I=T.indexOf(":"),L=T.substring(0,I).trim().toLowerCase(),F=T.substring(I+1).trim();return{name:L,value:F}}function d4(T){var I={};return T&&T.trim().split(/[\r|\n]+/).forEach(function(L){var F=r4(L);I[F.name]=F.value}),I}var _4=d4,u4=n4,pb=l4,oh=rf,c4=_4,Qm={};function m4(T){var I=Qm[T.id];I&&(I.abort(),delete Qm[T.id])}function f4(T,I){return new u4(T,{body:I.response,headers:c4(I.getAllResponseHeaders()),statusCode:I.status})}function hb(T){var I=T.total,L=T.loaded,F=100*L/I;return{total:I,transferred:L,percent:F}}function $b(T,I){return new Promise(function(L,F){I.onprogress=function(ae){T.emitter.emit(oh.EVENT_PROGRESS_DOWNLOAD,hb(ae))};var G=T.file;G&&(I.upload.onprogress=function(ae){T.emitter.emit(oh.EVENT_PROGRESS_UPLOAD,hb(ae))}),I.onerror=function(ae){F(ae)},I.onabort=function(){var ae=new pb({request:T,type:oh.ERROR_REQUEST_ABORTED});F(ae)},I.onload=function(){if(delete Qm[T.id],I.status<200||I.status>=400){var ae=new pb({request:T,body:I.response,statusCode:I.status});F(ae);return}L(I)};var te=T.body;typeof te=="string"?I.send(te):te?I.send(JSON.stringify(te)):G?I.send(G):I.send(),Qm[T.id]=I}).then(function(L){return f4(T,L)})}function Zb(T,I){var L=T.url(I),F=new window.XMLHttpRequest;return F.open(T.method,L),Object.keys(T.headers).forEach(function(G){F.setRequestHeader(G,T.headers[G])}),F}function p4(T){return Promise.resolve().then(function(){var I=Zb(T,T.client.accessToken);return $b(T,I)})}var h4={browserAbort:m4,sendRequestXhr:$b,browserSend:p4,createRequestXhr:Zb},ef={exports:{}};/*! http://mths.be/base64 v0.1.0 by @mathias | MIT license */ef.exports;(function(T,I){(function(L){var F=I,G=T&&T.exports==F&&T,te=typeof vn=="object"&&vn;(te.global===te||te.window===te)&&(L=te);var ae=function(Ke){this.message=Ke};ae.prototype=new Error,ae.prototype.name="InvalidCharacterError";var s=function(Ke){throw new ae(Ke)},oe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",he=/[\t\n\f\r ]/g,ve=function(Ke){Ke=String(Ke).replace(he,"");var Nt=Ke.length;Nt%4==0&&(Ke=Ke.replace(/==?$/,""),Nt=Ke.length),(Nt%4==1||/[^+a-zA-Z0-9/]/.test(Ke))&&s("Invalid character: the string to be decoded is not correctly encoded.");for(var Oe=0,ut,bt,Mt="",Fi=-1;++Fi<Nt;)bt=oe.indexOf(Ke.charAt(Fi)),ut=Oe%4?ut*64+bt:bt,Oe++%4&&(Mt+=String.fromCharCode(255&ut>>(-2*Oe&6)));return Mt},Ye=function(Ke){Ke=String(Ke),/[^\0-\xFF]/.test(Ke)&&s("The string to be encoded contains characters outside of the Latin1 range.");for(var Nt=Ke.length%3,Oe="",ut=-1,bt,Mt,Fi,ai,Oi=Ke.length-Nt;++ut<Oi;)bt=Ke.charCodeAt(ut)<<16,Mt=Ke.charCodeAt(++ut)<<8,Fi=Ke.charCodeAt(++ut),ai=bt+Mt+Fi,Oe+=oe.charAt(ai>>18&63)+oe.charAt(ai>>12&63)+oe.charAt(ai>>6&63)+oe.charAt(ai&63);return Nt==2?(bt=Ke.charCodeAt(ut)<<8,Mt=Ke.charCodeAt(++ut),ai=bt+Mt,Oe+=oe.charAt(ai>>10)+oe.charAt(ai>>4&63)+oe.charAt(ai<<2&63)+"="):Nt==1&&(ai=Ke.charCodeAt(ut),Oe+=oe.charAt(ai>>2)+oe.charAt(ai<<4&63)+"=="),Oe},Ce={encode:Ye,decode:ve,version:"0.1.0"};if(F&&!F.nodeType)if(G)G.exports=Ce;else for(var lt in Ce)Ce.hasOwnProperty(lt)&&(F[lt]=Ce[lt]);else L.base64=Ce})(vn)})(ef,ef.exports);var g4=ef.exports,y4=g4,nh={};function b4(T){if(nh[T])return nh[T];var I=T.split("."),L=I[0],F=I[1];if(!F)throw new Error("Invalid token");var G=T4(F),te={usage:L,user:G.u};return fr(G,"a")&&(te.authorization=G.a),fr(G,"exp")&&(te.expires=G.exp*1e3),fr(G,"iat")&&(te.created=G.iat*1e3),fr(G,"scopes")&&(te.scopes=G.scopes),fr(G,"client")&&(te.client=G.client),fr(G,"ll")&&(te.lastLogin=G.ll),fr(G,"iu")&&(te.impersonator=G.iu),nh[T]=te,te}function T4(T){try{return JSON.parse(y4.decode(T))}catch{throw new Error("Invalid token")}}function fr(T,I){return Object.prototype.hasOwnProperty.call(T,I)}var Xb=b4,Jb={exports:{}};(function(T){var I=Object.prototype.hasOwnProperty,L="~";function F(){}Object.create&&(F.prototype=Object.create(null),new F().__proto__||(L=!1));function G(oe,he,ve){this.fn=oe,this.context=he,this.once=ve||!1}function te(oe,he,ve,Ye,Ce){if(typeof ve!="function")throw new TypeError("The listener must be a function");var lt=new G(ve,Ye||oe,Ce),Ke=L?L+he:he;return oe._events[Ke]?oe._events[Ke].fn?oe._events[Ke]=[oe._events[Ke],lt]:oe._events[Ke].push(lt):(oe._events[Ke]=lt,oe._eventsCount++),oe}function ae(oe,he){--oe._eventsCount===0?oe._events=new F:delete oe._events[he]}function s(){this._events=new F,this._eventsCount=0}s.prototype.eventNames=function(){var he=[],ve,Ye;if(this._eventsCount===0)return he;for(Ye in ve=this._events)I.call(ve,Ye)&&he.push(L?Ye.slice(1):Ye);return Object.getOwnPropertySymbols?he.concat(Object.getOwnPropertySymbols(ve)):he},s.prototype.listeners=function(he){var ve=L?L+he:he,Ye=this._events[ve];if(!Ye)return[];if(Ye.fn)return[Ye.fn];for(var Ce=0,lt=Ye.length,Ke=new Array(lt);Ce<lt;Ce++)Ke[Ce]=Ye[Ce].fn;return Ke},s.prototype.listenerCount=function(he){var ve=L?L+he:he,Ye=this._events[ve];return Ye?Ye.fn?1:Ye.length:0},s.prototype.emit=function(he,ve,Ye,Ce,lt,Ke){var Nt=L?L+he:he;if(!this._events[Nt])return!1;var Oe=this._events[Nt],ut=arguments.length,bt,Mt;if(Oe.fn){switch(Oe.once&&this.removeListener(he,Oe.fn,void 0,!0),ut){case 1:return Oe.fn.call(Oe.context),!0;case 2:return Oe.fn.call(Oe.context,ve),!0;case 3:return Oe.fn.call(Oe.context,ve,Ye),!0;case 4:return Oe.fn.call(Oe.context,ve,Ye,Ce),!0;case 5:return Oe.fn.call(Oe.context,ve,Ye,Ce,lt),!0;case 6:return Oe.fn.call(Oe.context,ve,Ye,Ce,lt,Ke),!0}for(Mt=1,bt=new Array(ut-1);Mt<ut;Mt++)bt[Mt-1]=arguments[Mt];Oe.fn.apply(Oe.context,bt)}else{var Fi=Oe.length,ai;for(Mt=0;Mt<Fi;Mt++)switch(Oe[Mt].once&&this.removeListener(he,Oe[Mt].fn,void 0,!0),ut){case 1:Oe[Mt].fn.call(Oe[Mt].context);break;case 2:Oe[Mt].fn.call(Oe[Mt].context,ve);break;case 3:Oe[Mt].fn.call(Oe[Mt].context,ve,Ye);break;case 4:Oe[Mt].fn.call(Oe[Mt].context,ve,Ye,Ce);break;default:if(!bt)for(ai=1,bt=new Array(ut-1);ai<ut;ai++)bt[ai-1]=arguments[ai];Oe[Mt].fn.apply(Oe[Mt].context,bt)}}return!0},s.prototype.on=function(he,ve,Ye){return te(this,he,ve,Ye,!1)},s.prototype.once=function(he,ve,Ye){return te(this,he,ve,Ye,!0)},s.prototype.removeListener=function(he,ve,Ye,Ce){var lt=L?L+he:he;if(!this._events[lt])return this;if(!ve)return ae(this,lt),this;var Ke=this._events[lt];if(Ke.fn)Ke.fn===ve&&(!Ce||Ke.once)&&(!Ye||Ke.context===Ye)&&ae(this,lt);else{for(var Nt=0,Oe=[],ut=Ke.length;Nt<ut;Nt++)(Ke[Nt].fn!==ve||Ce&&!Ke[Nt].once||Ye&&Ke[Nt].context!==Ye)&&Oe.push(Ke[Nt]);Oe.length?this._events[lt]=Oe.length===1?Oe[0]:Oe:ae(this,lt)}return this},s.prototype.removeAllListeners=function(he){var ve;return he?(ve=L?L+he:he,this._events[ve]&&ae(this,ve)):(this._events=new F,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=L,s.EventEmitter=s,T.exports=s})(Jb);var x4=Jb.exports;function v4(T){return T.map(encodeURIComponent).join(",")}function Qb(T){return Array.isArray(T)?v4(T):encodeURIComponent(String(T))}function eT(T,I,L){if(L===!1||L===null)return T;var F=/\?/.test(T)?"&":"?",G=encodeURIComponent(I);return L!==void 0&&L!==""&&L!==!0&&(G+="="+Qb(L)),""+T+F+G}function E4(T,I){if(!I)return T;var L=T;return Object.keys(I).forEach(function(F){var G=I[F];G!==void 0&&(Array.isArray(G)&&(G=G.filter(function(te){return te!=null}).join(",")),L=eT(L,F,G))}),L}function A4(T,I){if(!I||T.slice(0,4)==="http")return T;var L=T[0]==="/"?"":"/";return""+I.replace(/\/$/,"")+L+T}function I4(T,I){return I?T.replace(/\/:([a-zA-Z0-9]+)/g,function(L,F){var G=I[F];if(G===void 0)throw new Error("Unspecified route parameter "+F);var te=Qb(G);return"/"+te}):T}var O4={appendQueryObject:E4,appendQueryParam:eT,prependOrigin:A4,interpolateRouteParams:I4},S4=Xb,Rh=Nd,R4=x4,zm=O4,gb=rf,C4=1;function ml(T,I){if(!T)throw new Error("MapiRequest requires a client");if(!I||!I.path||!I.method)throw new Error("MapiRequest requires an options object with path and method properties");var L={};I.body&&(L["content-type"]="application/json");var F=Rh(L,I.headers),G=Object.keys(F).reduce(function(te,ae){return te[ae.toLowerCase()]=F[ae],te},{});this.id=C4++,this._options=I,this.emitter=new R4,this.client=T,this.response=null,this.error=null,this.sent=!1,this.aborted=!1,this.path=I.path,this.method=I.method,this.origin=I.origin||T.origin,this.query=I.query||{},this.params=I.params||{},this.body=I.body||null,this.file=I.file||null,this.encoding=I.encoding||"utf8",this.sendFileAs=I.sendFileAs||null,this.headers=G}ml.prototype.url=function(I){var L=zm.prependOrigin(this.path,this.origin);L=zm.appendQueryObject(L,this.query);var F=this.params,G=I??this.client.accessToken;if(G){L=zm.appendQueryParam(L,"access_token",G);var te=S4(G).user;F=Rh({ownerId:te},F)}return L=zm.interpolateRouteParams(L,F),L};ml.prototype.send=function(){var I=this;if(I.sent)throw new Error("This request has already been sent. Check the response and error properties. Create a new request with clone().");return I.sent=!0,I.client.sendRequest(I).then(function(L){return I.response=L,I.emitter.emit(gb.EVENT_RESPONSE,L),L},function(L){throw I.error=L,I.emitter.emit(gb.EVENT_ERROR,L),L})};ml.prototype.abort=function(){this._nextPageRequest&&(this._nextPageRequest.abort(),delete this._nextPageRequest),!(this.response||this.error||this.aborted)&&(this.aborted=!0,this.client.abortRequest(this))};ml.prototype.eachPage=function(I){var L=this;function F(ae){function s(){delete L._nextPageRequest;var oe=ae.nextPage();oe&&(L._nextPageRequest=oe,te(oe))}I(null,ae,s)}function G(ae){I(ae,null,function(){})}function te(ae){ae.send().then(F,G)}te(this)};ml.prototype.clone=function(){return this._extend()};ml.prototype._extend=function(I){var L=Rh(this._options,I);return new ml(this.client,L)};var w4=ml,P4=Xb,L4=w4,N4=rf;function tT(T){if(!T||!T.accessToken)throw new Error("Cannot create a client without an access token");P4(T.accessToken),this.accessToken=T.accessToken,this.origin=T.origin||N4.API_ORIGIN}tT.prototype.createRequest=function(I){return new L4(this,I)};var iT=tT,aT=h4,oT=iT;function Pd(T){oT.call(this,T)}Pd.prototype=Object.create(oT.prototype);Pd.prototype.constructor=Pd;Pd.prototype.sendRequest=aT.browserSend;Pd.prototype.abortRequest=aT.browserAbort;function W4(T){return new Pd(T)}var nT=W4,M4=nT,D4=M4,F4=Object.prototype.toString,B4=function(T){var I;return F4.call(T)==="[object Object]"&&(I=Object.getPrototypeOf(T),I===null||I===Object.getPrototypeOf({}))},U4=B4,k4=Nd,sT="value",sh=`
  `,da={};da.assert=function(T,I){return I=I||{},function(L){var F=fl(T,L);if(F){var G=Ch(F,I);throw I.apiName&&(G=I.apiName+": "+G),new Error(G)}}};da.shape=function(I){var L=G4(I);return function(G){var te=fl(da.plainObject,G);if(te)return te;for(var ae,s,oe=[],he=0;he<L.length;he++)ae=L[he].key,s=L[he].value,te=fl(s,G[ae]),te&&oe.push([ae].concat(te));return oe.length<2?oe[0]:function(ve){oe=oe.map(function(lt){var Ke=lt[0],Nt=Ch(lt,ve).split(`
`).join(sh);return"- "+Ke+": "+Nt});var Ye=ve.path.join("."),Ce=Ye===sT?"":" of "+Ye;return"The following properties"+Ce+" have invalid values:"+sh+oe.join(sh)}}};da.strictShape=function(I){var L=da.shape(I);return function(G){var te=L(G);if(te)return te;var ae=Object.keys(G).reduce(function(s,oe){return I[oe]===void 0&&s.push(oe),s},[]);if(ae.length!==0)return function(){return"The following keys are invalid: "+ae.join(", ")}}};da.arrayOf=function(I){return lT(I)};da.tuple=function(){var I=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return lT(I)};function lT(T){var I=Array.isArray(T),L=function(F){return I?T[F]:T};return function(G){var te=fl(da.plainArray,G);if(te)return te;if(I&&G.length!==T.length)return"an array with "+T.length+" items";for(var ae=0;ae<G.length;ae++)if(te=fl(L(ae),G[ae]),te)return[ae].concat(te)}}da.required=function(I){function L(F){return F==null?function(G){return rT(G,dT(G.path)?"cannot be undefined/null.":"is required.")}:I.apply(this,arguments)}return L.__required=!0,L};da.oneOfType=function(){var I=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return function(F){var G=I.map(function(te){return fl(te,F)}).filter(Boolean);if(G.length===I.length)return G.every(function(te){return te.length===1&&typeof te[0]=="string"})?z4(G.map(function(te){return te[0]})):G.reduce(function(te,ae){return ae.length>te.length?ae:te})}};da.equal=function(I){return function(F){if(F!==I)return JSON.stringify(I)}};da.oneOf=function(){var I=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments),L=I.map(function(F){return da.equal(F)});return da.oneOfType.apply(this,L)};da.range=function(I){var L=I[0],F=I[1];return function(te){var ae=fl(da.number,te);if(ae||te<L||te>F)return"number between "+L+" & "+F+" (inclusive)"}};da.any=function(){};da.boolean=function(I){if(typeof I!="boolean")return"boolean"};da.number=function(I){if(typeof I!="number")return"number"};da.plainArray=function(I){if(!Array.isArray(I))return"array"};da.plainObject=function(I){if(!U4(I))return"object"};da.string=function(I){if(typeof I!="string")return"string"};da.func=function(I){if(typeof I!="function")return"function"};function fl(T,I){if(!(I==null&&!T.hasOwnProperty("__required"))){var L=T(I);if(L)return Array.isArray(L)?L:[L]}}function Ch(T,I){var L=T.length,F=T[L-1],G=T.slice(0,L-1);return G.length===0&&(G=[sT]),I=k4(I,{path:G}),typeof F=="function"?F(I):rT(I,H4(F))}function z4(T){return T.length<2?T[0]:T.length===2?T.join(" or "):T.slice(0,-1).join(", ")+", or "+T.slice(-1)}function H4(T){return"must be "+Y4(T)+"."}function Y4(T){return/^an? /.test(T)?T:/^[aeiou]/i.test(T)?"an "+T:/^[a-z]/i.test(T)?"a "+T:T}function rT(T,I){var L=dT(T.path),F=T.path.join(".")+" "+I,G=L?"Item at position ":"";return G+F}function dT(T){return typeof T[T.length-1]=="number"||typeof T[0]=="number"}function G4(T){return Object.keys(T||{}).map(function(I){return{key:I,value:T[I]}})}da.validate=fl;da.processMessage=Ch;var V4=da,j4=Nd,Rd=V4;function K4(T){if(typeof window<"u")return T instanceof vn.Blob||T instanceof vn.ArrayBuffer?void 0:"Blob or ArrayBuffer";if(!(typeof T=="string"||T.pipe!==void 0))return"Filename or Readable stream"}function q4(T,I){return Rd.assert(Rd.strictShape(T),I)}function $4(T){var I="date";if(typeof T=="boolean")return I;try{var L=new Date(T);if(L.getTime&&isNaN(L.getTime()))return I}catch{return I}}function Z4(T){return Rd.tuple(Rd.number,Rd.number)(T)}var X4=j4(Rd,{file:K4,date:$4,coordinates:Z4,assertShape:q4});function J4(T,I){var L=function(F,G){return I.indexOf(F)!==-1&&G!==void 0};return typeof I=="function"&&(L=I),Object.keys(T).filter(function(F){return L(F,T[F])}).reduce(function(F,G){return F[G]=T[G],F},{})}var Q4=J4;function eA(T,I){return Object.keys(T).reduce(function(L,F){return L[F]=I(F,T[F]),L},{})}var tA=eA,iA=tA;function aA(T){return iA(T,function(I,L){return typeof L=="boolean"?JSON.stringify(L):L})}var oA=aA,nA=iT,sA=nT;function lA(T){return function(I){var L;nA.prototype.isPrototypeOf(I)?L=I:L=sA(I);var F=Object.create(T);return F.client=L,F}}var rA=lA,_T=Nd,Di=X4,tf=Q4,uT=oA,dA=rA,wh={},cT=["country","region","postcode","district","place","locality","neighborhood","address","poi","poi.landmark"];wh.forwardGeocode=function(T){Di.assertShape({query:Di.required(Di.string),mode:Di.oneOf("mapbox.places","mapbox.places-permanent"),countries:Di.arrayOf(Di.string),proximity:Di.oneOf(Di.coordinates,"ip"),types:Di.arrayOf(Di.oneOf(cT)),autocomplete:Di.boolean,bbox:Di.arrayOf(Di.number),limit:Di.number,language:Di.arrayOf(Di.string),routing:Di.boolean,fuzzyMatch:Di.boolean,worldview:Di.string})(T),T.mode=T.mode||"mapbox.places";var I=uT(_T({country:T.countries},tf(T,["proximity","types","autocomplete","bbox","limit","language","routing","fuzzyMatch","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:tf(T,["mode","query"]),query:I})};wh.reverseGeocode=function(T){Di.assertShape({query:Di.required(Di.coordinates),mode:Di.oneOf("mapbox.places","mapbox.places-permanent"),countries:Di.arrayOf(Di.string),types:Di.arrayOf(Di.oneOf(cT)),bbox:Di.arrayOf(Di.number),limit:Di.number,language:Di.arrayOf(Di.string),reverseMode:Di.oneOf("distance","score"),routing:Di.boolean,worldview:Di.string})(T),T.mode=T.mode||"mapbox.places";var I=uT(_T({country:T.countries},tf(T,["country","types","bbox","limit","language","reverseMode","routing","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:tf(T,["mode","query"]),query:I})};var _A=dA(wh);let uA="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",mT=T=>crypto.getRandomValues(new Uint8Array(T)),fT=(T,I,L)=>{let F=(2<<Math.log(T.length-1)/Math.LN2)-1,G=-~(1.6*F*I/T.length);return(te=I)=>{let ae="";for(;;){let s=L(G),oe=G;for(;oe--;)if(ae+=T[s[oe]&F]||"",ae.length===te)return ae}}},cA=(T,I=21)=>fT(T,I,mT),mA=(T=21)=>crypto.getRandomValues(new Uint8Array(T)).reduce((I,L)=>(L&=63,L<36?I+=L.toString(36):L<62?I+=(L-26).toString(36).toUpperCase():L>62?I+="-":I+="_",I),"");const fA=Object.freeze(Object.defineProperty({__proto__:null,customAlphabet:cA,customRandom:fT,nanoid:mA,random:mT,urlAlphabet:uA},Symbol.toStringTag,{value:"Module"})),pA=rv(fA);var hA=pA.nanoid;function pT(T){this.origin=T.origin||"https://api.mapbox.com",this.endpoint="events/v2",this.access_token=T.accessToken,this.version="0.2.0",this.sessionID=this.generateSessionID(),this.userAgent=this.getUserAgent(),this.options=T,this.send=this.send.bind(this),this.countries=T.countries?T.countries.split(","):null,this.types=T.types?T.types.split(","):null,this.bbox=T.bbox?T.bbox:null,this.language=T.language?T.language.split(","):null,this.limit=T.limit?+T.limit:null,this.locale=navigator.language||null,this.enableEventLogging=this.shouldEnableLogging(T),this.eventQueue=new Array,this.flushInterval=T.flushInterval||1e3,this.maxQueueSize=T.maxQueueSize||100,this.timer=this.flushInterval?setTimeout(this.flush.bind(this),this.flushInterval):null,this.lastSentInput="",this.lastSentIndex=0}pT.prototype={select:function(T,I){var L=this.getSelectedIndex(T,I),F=this.getEventPayload("search.select",I);if(F.resultIndex=L,F.resultPlaceName=T.place_name,F.resultId=T.id,!(L===this.lastSentIndex&&F.queryString===this.lastSentInput||L==-1)&&(this.lastSentIndex=L,this.lastSentInput=F.queryString,!!F.queryString))return this.push(F)},start:function(T){var I=this.getEventPayload("search.start",T);if(I.queryString)return this.push(I)},keyevent:function(T,I){if(T.key&&!(T.metaKey||[9,27,37,39,13,38,40].indexOf(T.keyCode)!==-1)){var L=this.getEventPayload("search.keystroke",I);if(L.lastAction=T.key,!!L.queryString)return this.push(L)}},send:function(T,I){if(!this.enableEventLogging)return I?I():void 0;var L=this.getRequestOptions(T);this.request(L,(function(F){if(F)return this.handleError(F,I);if(I)return I()}).bind(this))},getRequestOptions:function(T){Array.isArray(T)||(T=[T]);var I={method:"POST",host:this.origin,path:this.endpoint+"?access_token="+this.access_token,headers:{"Content-Type":"application/json"},body:JSON.stringify(T)};return I},getEventPayload:function(T,I){var L;I.options.proximity?typeof I.options.proximity=="object"?L=[I.options.proximity.longitude,I.options.proximity.latitude]:I.options.proximity==="ip"?L=[999,999]:L=I.options.proximity:L=null;var F=I._map?I._map.getZoom():void 0,G={event:T,created:+new Date,sessionIdentifier:this.sessionID,country:this.countries,userAgent:this.userAgent,language:this.language,bbox:this.bbox,types:this.types,endpoint:"mapbox.places",autocomplete:I.options.autocomplete,fuzzyMatch:I.options.fuzzyMatch,proximity:L,limit:I.options.limit,routing:I.options.routing,worldview:I.options.worldview,mapZoom:F,keyboardLocale:this.locale};return T==="search.select"?G.queryString=I.inputString:T!="search.select"&&I._inputEl?G.queryString=I._inputEl.value:G.queryString=I.inputString,G},request:function(T,I){var L=new XMLHttpRequest;L.onreadystatechange=function(){if(this.readyState==4)return this.status==204?I(null):I(this.statusText)},L.open(T.method,T.host+"/"+T.path,!0);for(var F in T.headers){var G=T.headers[F];L.setRequestHeader(F,G)}L.send(T.body)},handleError:function(T,I){if(I)return I(T)},generateSessionID:function(){return hA()},getUserAgent:function(){return"mapbox-gl-geocoder."+this.version+"."+navigator.userAgent},getSelectedIndex:function(T,I){if(I._typeahead){var L=I._typeahead.data,F=T.id,G=L.map(function(ae){return ae.id}),te=G.indexOf(F);return te}},shouldEnableLogging:function(T){return!(T.enableEventLogging===!1||T.origin&&T.origin!=="https://api.mapbox.com"||T.localGeocoder||T.filter)},flush:function(){this.eventQueue.length>0&&(this.send(this.eventQueue),this.eventQueue=new Array),this.timer&&clearTimeout(this.timer),this.flushInterval&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))},push:function(T,I){this.eventQueue.push(T),(this.eventQueue.length>=this.maxQueueSize||I)&&this.flush()},remove:function(){this.flush()}};var gA=pT,yA={de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"",ja:"",lv:"Meklt",pt:"Procurar",sr:"",zh:"",cs:"Vyhledvn",hu:"Keress",ka:"",nb:"Ske",sk:"Vyhadvanie",th:"",fi:"Hae",is:"Leita",ko:"",pl:"Szukaj",sl:"Iskanje",fa:"",ru:""},bA={placeholder:yA},hT={exports:{}};(function(T){(function(I,L,F){T.exports?T.exports=F():I[L]=F()})(vn,"subtag",function(){var I="",L=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function F(oe){return oe.match(L)||[]}function G(oe){return F(oe).filter(function(he,ve){return he&&ve})}function te(oe){return oe=F(oe),{language:oe[1]||I,extlang:oe[2]||I,script:oe[3]||I,region:oe[4]||I}}function ae(oe,he,ve){Object.defineProperty(oe,he,{value:ve,enumerable:!0})}function s(oe,he,ve){function Ye(Ce){return F(Ce)[oe]||I}ae(Ye,"pattern",he),ae(te,ve,Ye)}return s(1,/^[a-zA-Z]{2,3}$/,"language"),s(2,/^[a-zA-Z]{3}$/,"extlang"),s(3,/^[a-zA-Z]{4}$/,"script"),s(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),ae(te,"split",G),te})})(hT);var TA=hT.exports;function gT(){}gT.prototype={isSupport:function(){return!!window.navigator.geolocation},getCurrentPosition:function(){const T={enableHighAccuracy:!0};return new Promise(function(I,L){window.navigator.geolocation.getCurrentPosition(I,L,T)})}};var xA=gT;function vA(T,I){const L=yT(T),F=["address","street","place","country"];var G;if(typeof I=="function")return I(L);const te=F.indexOf(I);return te===-1?G=F:G=F.slice(te),G.reduce(function(ae,s){return L[s]?(ae!==""&&(ae=ae+", "),ae+L[s]):ae},"")}function yT(T){const I=T.address||"",L=T.text||"",F=T.place_name||"",te={address:F.split(",")[0],houseNumber:I,street:L,placeName:F};return T.context.forEach(function(ae){const s=ae.id.split(".")[0];te[s]=ae.text}),te}const EA=/^[ ]*(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)[ ]*$/;var AA={transformFeatureToGeolocationText:vA,getAddressInfo:yT,REVERSE_GEOCODE_COORD_RGX:EA},IA=VE,OA=Ib,pr=Nd,SA=JE.EventEmitter,yb=QE,lh=D4,rh=_A,RA=gA,CA=bA,wA=TA,PA=xA,bb=AA;const ul={FORWARD:0,LOCAL:1,REVERSE:2};function LA(){var T=document.createElement("div");return T.className="mapboxgl-ctrl-geocoder--powered-by",T.innerHTML='<a href="https://www.mapbox.com/search-service" target="_blank">Powered by Mapbox</a>',T}function bT(T){this._eventEmitter=new SA,this.options=pr({},this.options,T),this.inputString="",this.fresh=!0,this.lastSelected=null,this.geolocation=new PA}bT.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,minLength:2,reverseGeocode:!1,flipCoordinates:!1,limit:5,origin:"https://api.mapbox.com",enableEventLogging:!0,marker:!0,mapboxgl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,enableGeolocation:!1,addressAccuracy:"street",getItemValue:function(T){return T.place_name},render:function(T){var I=T.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title">'+I[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address">'+I.splice(1,I.length).join(",")+"</div></div>"}},addTo:function(T){function I(L,F){if(!document.body.contains(F))throw new Error("Element provided to #addTo() exists, but is not in the DOM");const G=L.onAdd();F.appendChild(G)}if(T._controlContainer)T.addControl(this);else if(T instanceof HTMLElement)I(this,T);else if(typeof T=="string"){const L=document.querySelectorAll(T);if(L.length===0)throw new Error("Element ",T,"not found.");if(L.length>1)throw new Error("Geocoder can only be added to a single html element");I(this,L[0])}else throw new Error("Error: addTo must be a mapbox-gl-js map, an html element, or a CSS selector query for a single html element")},onAdd:function(T){if(T&&typeof T!="string"&&(this._map=T),this.setLanguage(),this.options.localGeocoderOnly||(this.geocoderService=rh(lh({accessToken:this.options.accessToken,origin:this.options.origin}))),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this.eventManager=new RA(this.options),this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this),this._geolocateUser=this._geolocateUser.bind(this);var I=this.container=document.createElement("div");I.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl";var L=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",OA(this._onKeyDown,200)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton),this._inputEl.addEventListener("keyup",(function(he){this.eventManager.keyevent(he,this)}).bind(this));var F=document.createElement("div");F.classList.add("mapboxgl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button";var G=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');if(this._clearEl.appendChild(G),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),F.appendChild(this._clearEl),F.appendChild(this._loadingEl),I.appendChild(L),I.appendChild(this._inputEl),I.appendChild(F),this.options.enableGeolocation&&this.geolocation.isSupport()){this._geolocateEl=document.createElement("button"),this._geolocateEl.setAttribute("aria-label","Geolocate"),this._geolocateEl.addEventListener("click",this._geolocateUser),this._geolocateEl.className="mapboxgl-ctrl-geocoder--button";var te=this.createIcon("geolocate",'<path d="M12.999 3.677L2.042 8.269c-.962.403-.747 1.823.29 1.912l5.032.431.431 5.033c.089 1.037 1.509 1.252 1.912.29l4.592-10.957c.345-.822-.477-1.644-1.299-1.299z" fill="#4264fb"/>');this._geolocateEl.appendChild(te),F.appendChild(this._geolocateEl),this._showGeolocateButton()}var ae=this._typeahead=new IA(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit});this.setRenderFunction(this.options.render),ae.getItemValue=this.options.getItemValue;var s=ae.list.draw,oe=this._footerNode=LA();return ae.list.draw=function(){s.call(this),oe.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),oe.addEventListener("mouseup",(function(){this.selectingListItem=!1}).bind(this)),this.element.appendChild(oe)},this.mapMarker=null,this._handleMarker=this._handleMarker.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._mapboxgl=this.options.mapboxgl,!this._mapboxgl&&this.options.marker&&(console.error("No mapboxgl detected in options. Map markers are disabled. Please set options.mapboxgl."),this.options.marker=!1)),I},_geolocateUser:function(){this._hideGeolocateButton(),this._showLoadingIcon(),this.geolocation.getCurrentPosition().then((function(T){this._hideLoadingIcon();const I={geometry:{type:"Point",coordinates:[T.coords.longitude,T.coords.latitude]}};this._handleMarker(I),this._fly(I),this._typeahead.clear(),this._typeahead.selected=!0,this.lastSelected=JSON.stringify(I),this._showClearButton(),this.fresh=!1;const L={limit:1,language:[this.options.language],query:I.geometry.coordinates,types:["address"]};if(this.options.localGeocoderOnly){const F=I.geometry.coordinates[0]+","+I.geometry.coordinates[1];this._setInputValue(F),this._eventEmitter.emit("result",{result:I})}else this.geocoderService.reverseGeocode(L).send().then((function(F){const G=F.body.features[0];if(G){const te=bb.transformFeatureToGeolocationText(G,this.options.addressAccuracy);this._setInputValue(te),G.user_coordinates=I.geometry.coordinates,this._eventEmitter.emit("result",{result:G})}else this._eventEmitter.emit("result",{result:{user_coordinates:I.geometry.coordinates}})}).bind(this))}).bind(this)).catch((function(T){T.code===1?this._renderUserDeniedGeolocationError():this._renderLocationError(),this._hideLoadingIcon(),this._showGeolocateButton(),this._hideAttribution()}).bind(this))},createIcon:function(T,I){var L=document.createElementNS("http://www.w3.org/2000/svg","svg");return L.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+T),L.setAttribute("viewBox","0 0 18 18"),L.setAttribute("xml:space","preserve"),L.setAttribute("width",18),L.setAttribute("height",18),L.innerHTML=I,L},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_setInputValue:function(T){this._inputEl.value=T,setTimeout((function(){this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0)}).bind(this),1)},_onPaste:function(T){var I=(T.clipboardData||window.clipboardData).getData("text");I.length>=this.options.minLength&&this._geocode(I)},_onKeyDown:function(T){var I=27,L=9;if(T.keyCode===I&&this.options.clearAndBlurOnEsc)return this._clear(T),this._inputEl.blur();var F=T.target&&T.target.shadowRoot?T.target.shadowRoot.activeElement:T.target,G=F?F.value:"";if(!G)return this.fresh=!0,T.keyCode!==L&&this.clear(T),this._showGeolocateButton(),this._hideClearButton();this._hideGeolocateButton(),!(T.metaKey||[L,I,37,39,13,38,40].indexOf(T.keyCode)!==-1)&&F.value.length>=this.options.minLength&&this._geocode(F.value)},_showButton:function(){this._typeahead.selected&&this._showClearButton()},_hideButton:function(){this._typeahead.selected&&this._hideClearButton()},_showClearButton:function(){this._clearEl.style.display="block"},_hideClearButton:function(){this._clearEl.style.display="none"},_showGeolocateButton:function(){this._geolocateEl&&this.geolocation.isSupport()&&(this._geolocateEl.style.display="block")},_hideGeolocateButton:function(){this._geolocateEl&&(this._geolocateEl.style.display="none")},_showLoadingIcon:function(){this._loadingEl.style.display="block"},_hideLoadingIcon:function(){this._loadingEl.style.display="none"},_showAttribution:function(){this._footerNode.style.display="block"},_hideAttribution:function(){this._footerNode.style.display="none"},_onBlur:function(T){this.options.clearOnBlur&&this._clearOnBlur(T),this.options.collapsed&&this._collapse()},_onChange:function(){var T=this._typeahead.selected;T&&JSON.stringify(T)!==this.lastSelected&&(this._hideClearButton(),this.options.flyTo&&this._fly(T),this.options.marker&&this._mapboxgl&&this._handleMarker(T),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(T),this._eventEmitter.emit("result",{result:T}),this.eventManager.select(T,this))},_fly:function(T){var I;if(T.properties&&yb[T.properties.short_code])I=pr({},this.options.flyTo),this._map&&this._map.fitBounds(yb[T.properties.short_code].bbox,I);else if(T.bbox){var L=T.bbox;I=pr({},this.options.flyTo),this._map&&this._map.fitBounds([[L[0],L[1]],[L[2],L[3]]],I)}else{var F={zoom:this.options.zoom};I=pr({},F,this.options.flyTo),T.center?I.center=T.center:T.geometry&&T.geometry.type&&T.geometry.type==="Point"&&T.geometry.coordinates&&(I.center=T.geometry.coordinates),this._map&&this._map.flyTo(I)}},_requestType:function(T,I){var L;return T.localGeocoderOnly?L=ul.LOCAL:T.reverseGeocode&&bb.REVERSE_GEOCODE_COORD_RGX.test(I)?L=ul.REVERSE:L=ul.FORWARD,L},_setupConfig:function(T,I){const L=["bbox","limit","proximity","countries","types","language","reverseMode","mode","autocomplete","fuzzyMatch","routing","worldview"],F=/[\s,]+/;var G=this,te=L.reduce(function(s,oe){if(G.options[oe]===void 0||G.options[oe]===null)return s;["countries","types","language"].indexOf(oe)>-1?s[oe]=G.options[oe].split(F):s[oe]=G.options[oe];const he=typeof G.options[oe].longitude=="number"&&typeof G.options[oe].latitude=="number";if(oe==="proximity"&&he){const ve=G.options[oe].longitude,Ye=G.options[oe].latitude;s[oe]=[ve,Ye]}return s},{});switch(T){case ul.REVERSE:{var ae=I.split(F).map(function(s){return parseFloat(s,10)});G.options.flipCoordinates||ae.reverse(),te.types&&te.types[0],te=pr(te,{query:ae,limit:1}),["proximity","autocomplete","fuzzyMatch","bbox"].forEach(function(s){s in te&&delete te[s]})}break;case ul.FORWARD:{const s=I.trim();/^(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)?$/.test(s)&&(I=I.replace(/,/g," ")),te=pr(te,{query:I})}break}return te},_geocode:function(T){this.inputString=T,this._showLoadingIcon(),this._eventEmitter.emit("loading",{query:T});const I=this._requestType(this.options,T),L=this._setupConfig(I,T);var F;switch(I){case ul.LOCAL:F=Promise.resolve();break;case ul.FORWARD:F=this.geocoderService.forwardGeocode(L).send();break;case ul.REVERSE:F=this.geocoderService.reverseGeocode(L).send();break}var G=this.options.localGeocoder?this.options.localGeocoder(T)||[]:[],te=[],ae=null;return F.catch((function(s){ae=s}).bind(this)).then((function(s){this._hideLoadingIcon();var oe={};return s?s.statusCode=="200"&&(oe=s.body,oe.request=s.request,oe.headers=s.headers):oe={type:"FeatureCollection",features:[]},oe.config=L,this.fresh&&(this.eventManager.start(this),this.fresh=!1),oe.features=oe.features?G.concat(oe.features):G,this.options.externalGeocoder?(te=this.options.externalGeocoder(T,oe.features)||Promise.resolve([]),te.then(function(he){return oe.features=oe.features?he.concat(oe.features):he,oe},function(){return oe})):oe}).bind(this)).then((function(s){if(ae)throw ae;this.options.filter&&s.features.length&&(s.features=s.features.filter(this.options.filter)),s.features.length?(this._showClearButton(),this._hideGeolocateButton(),this._showAttribution(),this._eventEmitter.emit("results",s),this._typeahead.update(s.features)):(this._hideClearButton(),this._hideAttribution(),this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",s))}).bind(this)).catch((function(s){this._hideLoadingIcon(),this._hideAttribution(),G.length&&this.options.localGeocoder||te.length&&this.options.externalGeocoder?(this._showClearButton(),this._hideGeolocateButton(),this._typeahead.update(G)):(this._hideClearButton(),this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:G}),this._eventEmitter.emit("error",{error:s})}).bind(this)),F},_clear:function(T){T&&T.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._hideClearButton(),this._showGeolocateButton(),this._removeMarker(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(T){this._clear(T),this._inputEl.focus()},_clearOnBlur:function(T){var I=this;T.relatedTarget&&I._clear(T)},_onQueryResult:function(T){var I=T.body;if(I.features.length){var L=I.features[0];this._typeahead.selected=L,this._inputEl.value=L.place_name,this._onChange()}},_updateProximity:function(){if(!(!this._map||!this.options.trackProximity))if(this._map.getZoom()>9){var T=this._map.getCenter().wrap();this.setProximity({longitude:T.lng,latitude:T.lat},!1)}else this.setProximity(null,!1)},_collapse:function(){!this._inputEl.value&&this._inputEl!==document.activeElement&&this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed")},query:function(T){return this._geocode(T).then(this._onQueryResult),this},_renderError:function(){var T="<div class='mapbox-gl-geocoder--error'>There was an error reaching the server</div>";this._renderMessage(T)},_renderLocationError:function(){var T="<div class='mapbox-gl-geocoder--error'>A location error has occurred</div>";this._renderMessage(T)},_renderNoResults:function(){var T="<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results'>No results found</div>";this._renderMessage(T)},_renderUserDeniedGeolocationError:function(){var T="<div class='mapbox-gl-geocoder--error'>Geolocation permission denied</div>";this._renderMessage(T)},_renderMessage:function(T){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(T)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var T=this.options.language.split(",")[0],I=wA.language(T),L=CA.placeholder[I];if(L)return L}return"Search"},setInput:function(T,I){return I===void 0&&(I=!1),this._inputEl.value=T,this._typeahead.selected=null,this._typeahead.clear(),T.length>=this.options.minLength&&(I?this._geocode(T):this._onChange()),this},setProximity:function(T,I=!0){return this.options.proximity=T,I&&(this.options.trackProximity=!1),this},getProximity:function(){return this.options.proximity},setRenderFunction:function(T){return T&&typeof T=="function"&&(this._typeahead.render=T),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(T){var I=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=T||this.options.language||I,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(T){return this.options.zoom=T,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(T){return this.options.flyTo=T,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(T){return this.options.placeholder=T||this._getPlaceholderText(),this._inputEl.placeholder=this.options.placeholder,this._inputEl.setAttribute("aria-label",this.options.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(T){return this.options.bbox=T,this},getCountries:function(){return this.options.countries},setCountries:function(T){return this.options.countries=T,this},getTypes:function(){return this.options.types},setTypes:function(T){return this.options.types=T,this},getMinLength:function(){return this.options.minLength},setMinLength:function(T){return this.options.minLength=T,this._typeahead&&(this._typeahead.options.minLength=T),this},getLimit:function(){return this.options.limit},setLimit:function(T){return this.options.limit=T,this._typeahead&&(this._typeahead.options.limit=T),this},getFilter:function(){return this.options.filter},setFilter:function(T){return this.options.filter=T,this},setOrigin:function(T){return this.options.origin=T,this.geocoderService=rh(lh({accessToken:this.options.accessToken,origin:this.options.origin})),this},getOrigin:function(){return this.options.origin},setAccessToken:function(T){return this.options.accessToken=T,this.geocoderService=rh(lh({accessToken:this.options.accessToken,origin:this.options.origin})),this},setAutocomplete:function(T){return this.options.autocomplete=T,this},getAutocomplete:function(){return this.options.autocomplete},setFuzzyMatch:function(T){return this.options.fuzzyMatch=T,this},getFuzzyMatch:function(){return this.options.fuzzyMatch},setRouting:function(T){return this.options.routing=T,this},getRouting:function(){return this.options.routing},setWorldview:function(T){return this.options.worldview=T,this},getWorldview:function(){return this.options.worldview},_handleMarker:function(T){if(this._map){this._removeMarker();var I={color:"#4668F2"},L=pr({},I,this.options.marker);return this.mapMarker=new this._mapboxgl.Marker(L),T.center?this.mapMarker.setLngLat(T.center).addTo(this._map):T.geometry&&T.geometry.type&&T.geometry.type==="Point"&&T.geometry.coordinates&&this.mapMarker.setLngLat(T.geometry.coordinates).addTo(this._map),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},on:function(T,I){return this._eventEmitter.on(T,I),this},off:function(T,I){return this._eventEmitter.removeListener(T,I),this.eventManager.remove(),this}};var NA=bT;const WA=sf(NA);const MA=[{facility_name:"LACSD - A.K. WARREN WATER RESOURCE FACILITY",city:"Whittier",state:"Calif.",amount_of_biosolids_generated:112530,amount_of_biosolids_managed_land_applied:5224,latitude:33.96071322,longitude:-118.0256606},{facility_name:"MWRDGC STICKNEY WRP",city:"Cicero",state:"Iowa",amount_of_biosolids_generated:110377,amount_of_biosolids_managed_land_applied:98548,latitude:41.82159,longitude:-87.77285},{facility_name:"NURSERY PRODUCTS HAWES COMPOSTING FACILITY",city:"Helendale",state:"Calif.",amount_of_biosolids_generated:107869,amount_of_biosolids_managed_land_applied:107869,latitude:34.75804744,longitude:-117.2593508},{facility_name:"SAN JOSE/SANTA CLARA RWF",city:"San Jose",state:"Calif.",amount_of_biosolids_generated:95497,amount_of_biosolids_managed_land_applied:0,latitude:37.43251,longitude:-121.952738},{facility_name:"MET COUNCIL METROPOLITAN WWTP",city:"St Paul",state:"Minn.",amount_of_biosolids_generated:79896,amount_of_biosolids_managed_land_applied:0,latitude:44.923243,longitude:-93.046563},{facility_name:"WALNUT CREEK WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:58278,amount_of_biosolids_managed_land_applied:0,latitude:30.35353,longitude:-97.69609},{facility_name:"CENTRAL REGIONAL WWTF",city:"Arlington",state:"Texas",amount_of_biosolids_generated:51910,amount_of_biosolids_managed_land_applied:50527.3,latitude:32.77389,longitude:-96.93083},{facility_name:"LOS ANGELES HYPERION WWTP",city:"Playa Del Rey",state:"Calif.",amount_of_biosolids_generated:50025,amount_of_biosolids_managed_land_applied:34304.15,latitude:33.93077,longitude:-118.43494},{facility_name:"INDIANAPOLIS BELMONT & SOUTHPORT AWTP",city:"Indianapolis",state:"Iowa",amount_of_biosolids_generated:46716,amount_of_biosolids_managed_land_applied:0,latitude:39.79398,longitude:-86.15734},{facility_name:"D. C. BUREAU WASTEWATER TREATM",city:"Washington",state:"D.C.",amount_of_biosolids_generated:45266,amount_of_biosolids_managed_land_applied:45265,latitude:38.813645,longitude:-77.027176},{facility_name:"CENTRAL WWTP",city:"Pflugerville",state:"Texas",amount_of_biosolids_generated:42634,amount_of_biosolids_managed_land_applied:0,latitude:30.419384,longitude:-97.604747},{facility_name:"PASSAIC VALLEY SEWERAGE COMM",city:"Newark",state:"Neb.",amount_of_biosolids_generated:39893,amount_of_biosolids_managed_land_applied:0,latitude:40.714786,longitude:-74.136198},{facility_name:"SYNAGRO SOUTH KERN COMPOST MANUFACTURING",city:"Taft",state:"Calif.",amount_of_biosolids_generated:39790,amount_of_biosolids_managed_land_applied:39790,latitude:35.15483588,longitude:-119.458795},{facility_name:"SACRAMENTO RWTP",city:"Sacramento",state:"Calif.",amount_of_biosolids_generated:39124,amount_of_biosolids_managed_land_applied:0,latitude:38.4485,longitude:-121.461667},{facility_name:"CLARK COUNTY WRD WWTP",city:"Las Vegas",state:"N.D.",amount_of_biosolids_generated:39090,amount_of_biosolids_managed_land_applied:0,latitude:36.114839,longitude:-115.047256},{facility_name:"SOUTHERLY WASTEWATER TRTMNT CTR, NEORSD",city:"Cuyahoga Heights",state:"Ohio",amount_of_biosolids_generated:38478,amount_of_biosolids_managed_land_applied:0,latitude:41.39919,longitude:-81.62666},{facility_name:"TULLY ENVIRONMENTAL INC. - NATURAL SOIL PRODUCTS",city:"Tremont",state:"Pa.",amount_of_biosolids_generated:37538,amount_of_biosolids_managed_land_applied:37538.29,latitude:40.629245,longitude:-76.457895},{facility_name:"MWRA - DEER ISLAND P O T W",city:"Boston",state:"Mass.",amount_of_biosolids_generated:36946,amount_of_biosolids_managed_land_applied:32543,latitude:42.3111,longitude:-71.05848},{facility_name:"BARR-TECH, LLC",city:"Sprague",state:"Wash.",amount_of_biosolids_generated:36438,amount_of_biosolids_managed_land_applied:36438,latitude:47.391634,longitude:-117.858804},{facility_name:"M C STILES WASTEWASTER",city:"Memphis",state:"Tenn.",amount_of_biosolids_generated:33126,amount_of_biosolids_managed_land_applied:12218,latitude:35.188949,longitude:-90.050959},{facility_name:"HARTFORD WPCP",city:"Hartford",state:"Conn.",amount_of_biosolids_generated:32754,amount_of_biosolids_managed_land_applied:0,latitude:41.731389,longitude:-72.656389},{facility_name:"INLAND EMPIRE REGIONAL COMPOSTING FACILITY",city:"Chino Hills",state:"Calif.",amount_of_biosolids_generated:32536,amount_of_biosolids_managed_land_applied:32536,latitude:33.97307512,longitude:-117.7343957},{facility_name:"WOONSOCKET REG WW INCINERATOR",city:"Woonsocket",state:"R.I.",amount_of_biosolids_generated:32403,amount_of_biosolids_managed_land_applied:0,latitude:41.999843,longitude:-71.494367},{facility_name:"SAN DIEGO MBC",city:"San Diego",state:"Calif.",amount_of_biosolids_generated:32113,amount_of_biosolids_managed_land_applied:32112.94,latitude:32.71616,longitude:-117.160515},{facility_name:"METRO WASTE WATER RECLAMATION DISTRICT",city:"Denver",state:"Colo.",amount_of_biosolids_generated:31952,amount_of_biosolids_managed_land_applied:27454.76,latitude:39.81497,longitude:-104.95923},{facility_name:"CENTRAL WWTF",city:"Dallas",state:"Texas",amount_of_biosolids_generated:31664,amount_of_biosolids_managed_land_applied:0,latitude:32.729222,longitude:-96.763056},{facility_name:"STEVEN M CLOUSE WATER RECYCLING CENTER",city:"San Antonio",state:"Texas",amount_of_biosolids_generated:30825,amount_of_biosolids_managed_land_applied:0,latitude:29.235588,longitude:-98.418434},{facility_name:"GLWA WRRF",city:"Detroit",state:"Mich.",amount_of_biosolids_generated:30806,amount_of_biosolids_managed_land_applied:0,latitude:42.2834,longitude:-83.12575},{facility_name:"ALCOSAN WASTEWATER TREAT PLANT",city:"Pittsburgh",state:"Pa.",amount_of_biosolids_generated:30624,amount_of_biosolids_managed_land_applied:6268,latitude:40.47454,longitude:-80.04086},{facility_name:"LIBERTY PROCESSING & SOILS, LLC",city:"Tremont",state:"Pa.",amount_of_biosolids_generated:30455,amount_of_biosolids_managed_land_applied:30455,latitude:40.61809,longitude:-76.38599},{facility_name:"CITY OF KANSAS CITY",city:"Kansas City",state:"Mo.",amount_of_biosolids_generated:30300,amount_of_biosolids_managed_land_applied:7676.6,latitude:39.01323,longitude:-94.52917},{facility_name:"SHELLEY'S SEPTIC TANKS RMF",city:"Zellwood",state:"Fla.",amount_of_biosolids_generated:29756,amount_of_biosolids_managed_land_applied:29755.3,latitude:28.731004,longitude:-81.599198},{facility_name:"MIDDLESEX CNTY UA",city:"Sayreville",state:"Neb.",amount_of_biosolids_generated:29462,amount_of_biosolids_managed_land_applied:0,latitude:40.488828,longitude:-74.312661},{facility_name:"ORANGE COUNTY SD #1",city:"Fountain Valley",state:"Calif.",amount_of_biosolids_generated:28679,amount_of_biosolids_managed_land_applied:7210,latitude:33.6907,longitude:-117.9419},{facility_name:"MWRDGC NORTHSIDE WRP",city:"Skokie",state:"Iowa",amount_of_biosolids_generated:28575,amount_of_biosolids_managed_land_applied:0,latitude:42.02142,longitude:-87.71992},{facility_name:"GRASSLANDS",city:"Chateaugay",state:"N.D.",amount_of_biosolids_generated:27140,amount_of_biosolids_managed_land_applied:28877,latitude:44.945043,longitude:-74.030892},{facility_name:"LIBERTY COMPOSTING",city:"Lost Hills",state:"Calif.",amount_of_biosolids_generated:26537,amount_of_biosolids_managed_land_applied:26537,latitude:35.6160018,longitude:-119.6939584},{facility_name:"CITY OF HOUSTON",city:"Houston",state:"Texas",amount_of_biosolids_generated:25743,amount_of_biosolids_managed_land_applied:0,latitude:29.75579,longitude:-95.29791},{facility_name:"HAWK RIDGE COMPOST FACILITY",city:"Unity",state:"Mass.",amount_of_biosolids_generated:25178,amount_of_biosolids_managed_land_applied:22841,latitude:44.61396824,longitude:-69.32506881},{facility_name:"MILL CREEK WWTP -MSD",city:"Cincinnati",state:"Ohio",amount_of_biosolids_generated:24632,amount_of_biosolids_managed_land_applied:0,latitude:39.10749,longitude:-84.54556},{facility_name:"MWRDGC CALUMET WRP",city:"Chicago",state:"Iowa",amount_of_biosolids_generated:24328,amount_of_biosolids_managed_land_applied:14805,latitude:41.661976,longitude:-87.609077},{facility_name:"LAMONT WWTP",city:"Lamont",state:"Calif.",amount_of_biosolids_generated:24311,amount_of_biosolids_managed_land_applied:0,latitude:35.256086,longitude:-118.909077},{facility_name:"CITY OF CHATTANOOGA",city:"Chattanooga",state:"Tenn.",amount_of_biosolids_generated:22989,amount_of_biosolids_managed_land_applied:22674.2,latitude:35.052025,longitude:-85.335368},{facility_name:"NORTHERN KY SANITATION DISTRICT 1",city:"Villa Hills",state:"Ky.",amount_of_biosolids_generated:22721,amount_of_biosolids_managed_land_applied:0,latitude:39.058611,longitude:-84.618056},{facility_name:"DALLAS SOUTHSIDE WWTF",city:"Dallas",state:"Texas",amount_of_biosolids_generated:21715,amount_of_biosolids_managed_land_applied:0,latitude:32.641333,longitude:-96.646867},{facility_name:"PINEY ORCHARD WWTP",city:"Odenton",state:"Mass.",amount_of_biosolids_generated:21667,amount_of_biosolids_managed_land_applied:21667.3,latitude:39.06126,longitude:-76.72804},{facility_name:"VILLAGE CREEK WWTF",city:"Fort Worth",state:"Texas",amount_of_biosolids_generated:21505,amount_of_biosolids_managed_land_applied:18870,latitude:32.779848,longitude:-97.143936},{facility_name:"NASHVILLE-CENTRAL STP",city:"Nashville",state:"Tenn.",amount_of_biosolids_generated:21151,amount_of_biosolids_managed_land_applied:21144.5,latitude:36.186111,longitude:-86.788889},{facility_name:"MSD BISSELL POINT WASTEWATER TREATMENT PLANT",city:"St. Louis",state:"Mo.",amount_of_biosolids_generated:21081,amount_of_biosolids_managed_land_applied:0,latitude:38.63107,longitude:-90.21532},{facility_name:"KENT COUNTY STP",city:"Frederica",state:"D.C.",amount_of_biosolids_generated:20442,amount_of_biosolids_managed_land_applied:9056.81,latitude:38.998212,longitude:-75.437604},{facility_name:"CITY OF RALEIGH PUBLIC UTILITIES DEPARTMENT",city:"Raleigh",state:"Mont.",amount_of_biosolids_generated:20190,amount_of_biosolids_managed_land_applied:685.04,latitude:35.720733,longitude:-78.484831},{facility_name:"SOLID WASTE AUTH OF PALM BEACH BIOSOLIDS PELLETIZATION FACI",city:"West Palm Beach",state:"Fla.",amount_of_biosolids_generated:19467,amount_of_biosolids_managed_land_applied:19369.37,latitude:26.7725,longitude:-80.1416},{facility_name:"CITY OF GREENSBORO",city:"Greensboro",state:"Mont.",amount_of_biosolids_generated:18869,amount_of_biosolids_managed_land_applied:0,latitude:36.098214,longitude:-79.687741},{facility_name:"DELCORA",city:"Chester",state:"Pa.",amount_of_biosolids_generated:18717,amount_of_biosolids_managed_land_applied:0,latitude:39.828617,longitude:-75.393105},{facility_name:"PATAPSCO WWTP",city:"Baltimore",state:"Mass.",amount_of_biosolids_generated:18363,amount_of_biosolids_managed_land_applied:0,latitude:39.23208,longitude:-76.56699},{facility_name:"FORT WAYNE WWTP",city:"Ft Wayne",state:"Iowa",amount_of_biosolids_generated:18257,amount_of_biosolids_managed_land_applied:18256.82,latitude:41.06450135,longitude:-85.16355891},{facility_name:"FRESNO-CLOVIS RWRF",city:"Fresno",state:"Calif.",amount_of_biosolids_generated:18149,amount_of_biosolids_managed_land_applied:18149,latitude:36.702666,longitude:-119.893464},{facility_name:"WESTERN REGIONAL WATER RECLAMATION FACILITY",city:"Petersburg",state:"Ky.",amount_of_biosolids_generated:17729,amount_of_biosolids_managed_land_applied:0,latitude:39.00703,longitude:-84.84121},{facility_name:"NYCDEP - NEWTOWN CREEK WRRF",city:"Brooklyn",state:"N.D.",amount_of_biosolids_generated:17540,amount_of_biosolids_managed_land_applied:0,latitude:40.73499,longitude:-73.86499},{facility_name:"WILSON CREEK REGIONAL WWTF",city:"Wylie",state:"Texas",amount_of_biosolids_generated:17225,amount_of_biosolids_managed_land_applied:0,latitude:33.124035,longitude:-96.565558},{facility_name:"ROCHESTER PURE WATERS DIST",city:"Rochester",state:"N.D.",amount_of_biosolids_generated:17197,amount_of_biosolids_managed_land_applied:0,latitude:43.15537,longitude:-77.61405},{facility_name:"MIAMI-DADE COUNTY - PUBLIC WORKS DEPARTMENT",city:"Miami",state:"Fla.",amount_of_biosolids_generated:17078,amount_of_biosolids_managed_land_applied:17077.9,latitude:25.7479,longitude:-80.1501},{facility_name:"COMPOST USA OF HIGHLANDS COUNTY - HICORIA ROAD COMPOSTING FACILITY",city:"Venus",state:"Fla.",amount_of_biosolids_generated:16814,amount_of_biosolids_managed_land_applied:16814.46,latitude:27.15336,longitude:-81.3351},{facility_name:"UPPER BLACKSTONE W P A D",city:"Millbury",state:"Mass.",amount_of_biosolids_generated:16319,amount_of_biosolids_managed_land_applied:0,latitude:42.19799303,longitude:-71.76906326},{facility_name:"SYNAGRO CENTRAL VALLEY COMPOST FACILITY",city:"Dos Palos",state:"Calif.",amount_of_biosolids_generated:16203,amount_of_biosolids_managed_land_applied:16203,latitude:37.090087,longitude:-120.552421},{facility_name:"ORANGE COUNTY SD #2",city:"Fountain Valley",state:"Calif.",amount_of_biosolids_generated:15989,amount_of_biosolids_managed_land_applied:11615,latitude:33.6907,longitude:-117.9419},{facility_name:"LYSTEK INTERNATIONAL",city:"Fairfield",state:"Calif.",amount_of_biosolids_generated:15283,amount_of_biosolids_managed_land_applied:15283,latitude:38.24059324,longitude:-122.1143481},{facility_name:"ERVING CENTER WWTP 2",city:"Erving",state:"Mass.",amount_of_biosolids_generated:15241,amount_of_biosolids_managed_land_applied:1019,latitude:42.59966,longitude:-72.39864},{facility_name:"SAN FRANCISCO SOUTHEAST WWTP",city:"San Francisco",state:"Calif.",amount_of_biosolids_generated:14973,amount_of_biosolids_managed_land_applied:3094,latitude:37.7403,longitude:-122.3903},{facility_name:"CENTRAL CONTRA COSTA WWTF",city:"Martinez",state:"Calif.",amount_of_biosolids_generated:14937,amount_of_biosolids_managed_land_applied:275,latitude:37.99789,longitude:-122.06827},{facility_name:"EAST BAY MUD WWTP",city:"Oakland",state:"Calif.",amount_of_biosolids_generated:14729,amount_of_biosolids_managed_land_applied:7842.49,latitude:37.80618731,longitude:-122.2995054},{facility_name:"DES MOINES METROPOLITAN WRA",city:"Des Moines",state:"Hawaii",amount_of_biosolids_generated:13996,amount_of_biosolids_managed_land_applied:13996.1,latitude:41.572778,longitude:-93.557778},{facility_name:"MSD LEMAY WASTEWATER TREATMENT PLANT",city:"St. Louis",state:"Mo.",amount_of_biosolids_generated:13611,amount_of_biosolids_managed_land_applied:0,latitude:38.63107,longitude:-90.21532},{facility_name:"SYNAGRO TECHNOLOGIES - PATAPSCO PELLETIZER FACILITY",city:"Baltimore",state:"Mass.",amount_of_biosolids_generated:13587,amount_of_biosolids_managed_land_applied:12995,latitude:39.23222,longitude:-76.567064},{facility_name:"COMPOST USA OF SUMTER COUNTY",city:"Lake Panasoffkee",state:"Fla.",amount_of_biosolids_generated:13463,amount_of_biosolids_managed_land_applied:13463,latitude:28.743151,longitude:-82.091653},{facility_name:"MONTEREY RWPCA",city:"Monterey",state:"Calif.",amount_of_biosolids_generated:13261,amount_of_biosolids_managed_land_applied:0,latitude:36.58316196,longitude:-121.8572418},{facility_name:"LOWER POTOMAC POLL CONTROL PLT",city:"Lorton",state:"Utah",amount_of_biosolids_generated:13197,amount_of_biosolids_managed_land_applied:0,latitude:38.704002,longitude:-77.207057},{facility_name:"BROWARD COUNTY WATER AND WASTEWATER SERVICES",city:"Pompano Beach",state:"Fla.",amount_of_biosolids_generated:12909,amount_of_biosolids_managed_land_applied:10500,latitude:26.261586,longitude:-80.152722},{facility_name:"SYNAGRO TECHNOLOGIES - WATERSHED RESOURCE CENTER",city:"Curtis Bay",state:"Mass.",amount_of_biosolids_generated:12545,amount_of_biosolids_managed_land_applied:12545,latitude:39.206612,longitude:-76.586093},{facility_name:"KING COUNTY SOUTH WWTP",city:"Seattle",state:"Wash.",amount_of_biosolids_generated:12490,amount_of_biosolids_managed_land_applied:12490,latitude:47.469196,longitude:-122.238935},{facility_name:"LAS VEGAS WQCP",city:"Las Vegas",state:"N.D.",amount_of_biosolids_generated:12200,amount_of_biosolids_managed_land_applied:0,latitude:36.13722,longitude:-115.04326},{facility_name:"MDWASA SOUTH DISTRICT WWTF",city:"Miami",state:"Fla.",amount_of_biosolids_generated:12109,amount_of_biosolids_managed_land_applied:12109.45,latitude:25.551905,longitude:-80.335729},{facility_name:"NYCDEP - WARD'S ISLAND WRRF",city:"New York",state:"N.D.",amount_of_biosolids_generated:12100,amount_of_biosolids_managed_land_applied:3011,latitude:40.65925,longitude:-73.80226},{facility_name:"CITY OF TAMPA - DEPARTMENT OF SANITARY SEWERS",city:"Tampa",state:"Fla.",amount_of_biosolids_generated:12001,amount_of_biosolids_managed_land_applied:12001,latitude:27.9227,longitude:-82.4363},{facility_name:"LEE COUNTY COMPOSTING FACILITY",city:"Fort Myers",state:"Fla.",amount_of_biosolids_generated:11650,amount_of_biosolids_managed_land_applied:11650.39,latitude:26.59463,longitude:-81.88183},{facility_name:"SUFFOLK COUNTY",city:"Hauppauge",state:"N.D.",amount_of_biosolids_generated:11621,amount_of_biosolids_managed_land_applied:0,latitude:40.72338796,longitude:-73.36344784},{facility_name:"BERGEN CNTY UTILITIES AUTHORIT (LITTLE FERRY)",city:"Little Ferry",state:"Neb.",amount_of_biosolids_generated:11438,amount_of_biosolids_managed_land_applied:0,latitude:40.84642,longitude:-74.03902},{facility_name:"PORTLAND - COLUMBIA BLVD STP",city:"Portland",state:"Ore.",amount_of_biosolids_generated:11336,amount_of_biosolids_managed_land_applied:11336,latitude:45.5975,longitude:-122.719},{facility_name:"TONAWANDA (T)",city:"Tonawanda",state:"N.D.",amount_of_biosolids_generated:11310,amount_of_biosolids_managed_land_applied:0,latitude:42.99376,longitude:-78.90162},{facility_name:"ATLANTA (R.M. CLAYTON WPCP)",city:"Atlanta",state:"Ga.",amount_of_biosolids_generated:11113,amount_of_biosolids_managed_land_applied:0,latitude:33.82333,longitude:-84.45528},{facility_name:"NEW HAVEN EAST SHORE WPCF",city:"New Haven",state:"Conn.",amount_of_biosolids_generated:11054,amount_of_biosolids_managed_land_applied:0,latitude:41.282563,longitude:-72.902505},{facility_name:"RICHMOND CITY OF",city:"Richmond",state:"Utah",amount_of_biosolids_generated:11e3,amount_of_biosolids_managed_land_applied:10081.5,latitude:37.522046,longitude:-77.422183},{facility_name:"CITY OF CEDAR RAPIDS",city:"Cedar Rapids",state:"Hawaii",amount_of_biosolids_generated:10731,amount_of_biosolids_managed_land_applied:1515.936,latitude:41.97766,longitude:-91.66936},{facility_name:"KING COUNTY WEST POINT WWTP",city:"Seattle",state:"Wash.",amount_of_biosolids_generated:10701,amount_of_biosolids_managed_land_applied:10700,latitude:47.663487,longitude:-122.427318},{facility_name:"WATER AND SEWER AUTHORITY OF CABARRUS COUNTY",city:"Concord",state:"Mont.",amount_of_biosolids_generated:10695,amount_of_biosolids_managed_land_applied:0,latitude:35.326239,longitude:-80.539345},{facility_name:"CHARLOTTE WATER",city:"Charlotte",state:"Mont.",amount_of_biosolids_generated:10695,amount_of_biosolids_managed_land_applied:6226,latitude:35.068738,longitude:-80.872449},{facility_name:"PARKER AG- CAKE BLENDING FIELD OPS",city:"Limon",state:"Colo.",amount_of_biosolids_generated:10491,amount_of_biosolids_managed_land_applied:10491.47,latitude:39.26164933,longitude:-103.6820031},{facility_name:"LAMBLAND, INC. DBA A1 ORGANICS",city:"Eaton",state:"Colo.",amount_of_biosolids_generated:10235,amount_of_biosolids_managed_land_applied:10235,latitude:40.538851,longitude:-104.747476},{facility_name:"ALBUQUERQUE BERNALILLO COUNTY WATER UTILITY AUTHORITY",city:"Albuquerque",state:"N.D.",amount_of_biosolids_generated:10112,amount_of_biosolids_managed_land_applied:2422,latitude:35.0177,longitude:-106.6661},{facility_name:"GREEN BAY METROPOLITAN SEWERAGE DISTRICT",city:"Green Bay",state:"Wis.",amount_of_biosolids_generated:9843,amount_of_biosolids_managed_land_applied:0,latitude:44.53348,longitude:-87.99401},{facility_name:"WILMINGTON STP",city:"Wilmington",state:"D.C.",amount_of_biosolids_generated:9811,amount_of_biosolids_managed_land_applied:9810.96,latitude:39.72954,longitude:-75.504334},{facility_name:"NYCDEP - HUNT'S POINT WRRF",city:"Bronx",state:"N.D.",amount_of_biosolids_generated:9656,amount_of_biosolids_managed_land_applied:8692,latitude:40.81300072,longitude:-73.88613715},{facility_name:"MATTABASSETT DISTRICT CROMWELL",city:"Cromwell",state:"Conn.",amount_of_biosolids_generated:9423,amount_of_biosolids_managed_land_applied:0,latitude:41.586897,longitude:-72.650828},{facility_name:'FORT SMITH, CITY OF (P" STREE"',city:"Fort Smith",state:"Alaska",amount_of_biosolids_generated:9287,amount_of_biosolids_managed_land_applied:0,latitude:35.406202,longitude:-94.420215},{facility_name:"CITY OF WAXAHACHIE WWTP",city:"Waxahachie",state:"Texas",amount_of_biosolids_generated:9200,amount_of_biosolids_managed_land_applied:0,latitude:32.36546,longitude:-96.84138},{facility_name:"SPRINGFIELD W W T P",city:"Agawam",state:"Mass.",amount_of_biosolids_generated:9161,amount_of_biosolids_managed_land_applied:4282,latitude:42.087793,longitude:-72.588998},{facility_name:"METROPOLITAN COUNCIL-SENECA",city:"Eagan",state:"Minn.",amount_of_biosolids_generated:9153,amount_of_biosolids_managed_land_applied:0,latitude:44.826722,longitude:-93.212},{facility_name:"NYCDEP - BOWERY BAY WRRF",city:"Astoria",state:"N.D.",amount_of_biosolids_generated:8922,amount_of_biosolids_managed_land_applied:3859,latitude:40.77069839,longitude:-73.92387396},{facility_name:"NYCDEP - OWLS HEAD WPCP",city:"Brooklyn",state:"N.D.",amount_of_biosolids_generated:8854,amount_of_biosolids_managed_land_applied:3491,latitude:40.64066723,longitude:-74.01804373},{facility_name:"ENGEL & GRAY COMPOST FACILITY",city:"Santa Maria",state:"Calif.",amount_of_biosolids_generated:8743,amount_of_biosolids_managed_land_applied:8743,latitude:34.93151676,longitude:-120.4345626},{facility_name:"SOUTHEAST COUNTY LANDFILL",city:"Lithia",state:"Fla.",amount_of_biosolids_generated:8724,amount_of_biosolids_managed_land_applied:8723.52,latitude:27.762601,longitude:-82.20147},{facility_name:"NYCDEP - CONEY ISLAND WRRF",city:"Brooklyn",state:"N.D.",amount_of_biosolids_generated:8613,amount_of_biosolids_managed_land_applied:0,latitude:40.58500592,longitude:-73.94873697},{facility_name:"TRUCKEE MEADOWS WRF",city:"Sparks",state:"N.D.",amount_of_biosolids_generated:8567,amount_of_biosolids_managed_land_applied:0,latitude:39.54104,longitude:-119.74897},{facility_name:"LOS LUNAS WWTP",city:"Los Lunas",state:"N.D.",amount_of_biosolids_generated:8513,amount_of_biosolids_managed_land_applied:0,latitude:34.780084,longitude:-106.731165},{facility_name:"CITY OF HOLLYWOOD",city:"Hollywood",state:"Fla.",amount_of_biosolids_generated:8502,amount_of_biosolids_managed_land_applied:8040.38,latitude:26.026578,longitude:-80.134767},{facility_name:"CLAYTON CO-CASEY & HUIE WRF",city:"Morrow",state:"Ga.",amount_of_biosolids_generated:8495,amount_of_biosolids_managed_land_applied:4478,latitude:33.515369,longitude:-84.371975},{facility_name:"OMAHA PAPILLION CREEK WWTF",city:"Bellevue",state:"Neb.",amount_of_biosolids_generated:8484,amount_of_biosolids_managed_land_applied:8483.7,latitude:41.08264,longitude:-95.8879},{facility_name:"SEVIERVILLE MCCROSKY ISLAND ST",city:"Sevierville",state:"Tenn.",amount_of_biosolids_generated:8481,amount_of_biosolids_managed_land_applied:0,latitude:35.926091,longitude:-83.601216},{facility_name:"NYCDEP - NORTH RIVER WPCP",city:"Manhattan (Subdivision)",state:"N.D.",amount_of_biosolids_generated:8458,amount_of_biosolids_managed_land_applied:0,latitude:40.82519532,longitude:-73.94947243},{facility_name:"WESTERN BRANCH WWTP",city:"Upper Marlboro",state:"Mass.",amount_of_biosolids_generated:8411,amount_of_biosolids_managed_land_applied:8411,latitude:38.796977,longitude:-76.729667},{facility_name:"ORLANDO - CONSERV II WRF",city:"Orlando",state:"Fla.",amount_of_biosolids_generated:8270,amount_of_biosolids_managed_land_applied:8270,latitude:28.50474,longitude:-81.45091},{facility_name:"INLAND EMPIRE UTILITIES PLT 1",city:"Chino Hills",state:"Calif.",amount_of_biosolids_generated:8156,amount_of_biosolids_managed_land_applied:0,latitude:33.97307512,longitude:-117.7343957},{facility_name:"SEACOAST UTIL-PGA WWTP",city:"Palm Beach Gardens",state:"Fla.",amount_of_biosolids_generated:8128,amount_of_biosolids_managed_land_applied:0,latitude:26.855833,longitude:-80.143889},{facility_name:"HENRICO REGIONAL WWTP",city:"Richmond",state:"Utah",amount_of_biosolids_generated:8022,amount_of_biosolids_managed_land_applied:8022.27,latitude:37.41572,longitude:-77.32345},{facility_name:"WEST COUNTY WASTEWATER DISTRICT WWTP",city:"Richmond",state:"Calif.",amount_of_biosolids_generated:7956,amount_of_biosolids_managed_land_applied:0,latitude:37.962591,longitude:-122.376256},{facility_name:"ATLANTIC COUNTY UTIL AUTH WWTF",city:"Atlantic City",state:"Neb.",amount_of_biosolids_generated:7940,amount_of_biosolids_managed_land_applied:0,latitude:39.37774,longitude:-74.45342},{facility_name:"LYNCHBURG STP",city:"Lynchburg",state:"Utah",amount_of_biosolids_generated:7855,amount_of_biosolids_managed_land_applied:1927,latitude:37.395561,longitude:-79.113797},{facility_name:"MUNCIE WATER POLLUTION CONTROL FACILITY",city:"Muncie",state:"Iowa",amount_of_biosolids_generated:7825,amount_of_biosolids_managed_land_applied:0,latitude:40.19549,longitude:-85.38733},{facility_name:"NORTH LAS VEGAS WRF",city:"Las Vegas",state:"N.D.",amount_of_biosolids_generated:7748,amount_of_biosolids_managed_land_applied:0,latitude:36.206873,longitude:-115.057525},{facility_name:"OMAHA MISSOURI RIVER WWTF",city:"Omaha",state:"Neb.",amount_of_biosolids_generated:7683,amount_of_biosolids_managed_land_applied:7682.7,latitude:41.20753,longitude:-95.9298},{facility_name:"METROPOLITAN SEWERAGE DISTRICT OF BUNCOMBE COUNTY NORTH CAROLINA",city:"Asheville",state:"Mont.",amount_of_biosolids_generated:7608,amount_of_biosolids_managed_land_applied:0,latitude:35.650655,longitude:-82.598193},{facility_name:"OCEAN CO.UA -FMD FERTILIZER MANUFACTURING DIVISION",city:"Bayville",state:"Neb.",amount_of_biosolids_generated:7545,amount_of_biosolids_managed_land_applied:7354.51,latitude:39.90178232,longitude:-74.17450513},{facility_name:"VANCOUVER WEST STP",city:"Vancouver",state:"Wash.",amount_of_biosolids_generated:7496,amount_of_biosolids_managed_land_applied:0,latitude:45.634882,longitude:-122.69365},{facility_name:"COLTON WRF",city:"Colton",state:"Calif.",amount_of_biosolids_generated:7279,amount_of_biosolids_managed_land_applied:7278.5,latitude:34.050596,longitude:-117.333082},{facility_name:"WESTCHESTER CO DEPT ENV FAC",city:"New Rochelle",state:"N.D.",amount_of_biosolids_generated:7261,amount_of_biosolids_managed_land_applied:0,latitude:40.91181,longitude:-73.7826},{facility_name:"COX CREEK RECLAMATION FACILITY",city:"Curtis Bay",state:"Mass.",amount_of_biosolids_generated:7210,amount_of_biosolids_managed_land_applied:7210.33,latitude:39.174556,longitude:-76.534917},{facility_name:"BALLENGER CREEK STP",city:"Frederick",state:"Mass.",amount_of_biosolids_generated:7178,amount_of_biosolids_managed_land_applied:7178,latitude:39.36509,longitude:-77.41395},{facility_name:"SPOKANE RIVERSIDE PARK AWTF AND CSOS",city:"Spokane",state:"Wash.",amount_of_biosolids_generated:7168,amount_of_biosolids_managed_land_applied:7168,latitude:47.695191,longitude:-117.473588},{facility_name:"LBVSD, ATHERTON PLANT",city:"Independence",state:"Mo.",amount_of_biosolids_generated:7132,amount_of_biosolids_managed_land_applied:350.5,latitude:39.163078,longitude:-94.324898},{facility_name:"MORRIS FORMAN WQTC MSD",city:"Louisville",state:"Ky.",amount_of_biosolids_generated:7095,amount_of_biosolids_managed_land_applied:6220.914,latitude:38.232528,longitude:-85.829484},{facility_name:"MERRELL BROTHERS INC. - REGIONAL BIOSOLIDS CENTER",city:"Kokomo",state:"Iowa",amount_of_biosolids_generated:7088,amount_of_biosolids_managed_land_applied:7088,latitude:40.476428,longitude:-86.147896},{facility_name:"THE PROCTER AND GAMBLE PAPER PRODUCTS CO",city:"Jackson",state:"Mo.",amount_of_biosolids_generated:7055,amount_of_biosolids_managed_land_applied:0,latitude:37.48357,longitude:-89.507477},{facility_name:"SOUTH ESSEX SEWERAGE DISTRICT",city:"Salem",state:"Mass.",amount_of_biosolids_generated:7027,amount_of_biosolids_managed_land_applied:0,latitude:42.5277,longitude:-70.8765},{facility_name:"NARRAGANSETT BAY COMMISSION",city:"Providence",state:"R.I.",amount_of_biosolids_generated:7010,amount_of_biosolids_managed_land_applied:0,latitude:41.79228,longitude:-71.39029},{facility_name:"BILLERICA W W T P",city:"Billerica",state:"Mass.",amount_of_biosolids_generated:7003,amount_of_biosolids_managed_land_applied:0,latitude:42.600475,longitude:-71.284157},{facility_name:"METROPOLITAN COUNCIL-BLUE LAKE",city:"Shakopee",state:"Minn.",amount_of_biosolids_generated:7003,amount_of_biosolids_managed_land_applied:7003,latitude:44.80017,longitude:-93.42806},{facility_name:"ORLANDO, CITY OF",city:"Orlando",state:"Fla.",amount_of_biosolids_generated:6986,amount_of_biosolids_managed_land_applied:0,latitude:28.623656,longitude:-81.22502},{facility_name:"CITY OF HOUSTON",city:"Houston",state:"Texas",amount_of_biosolids_generated:6946,amount_of_biosolids_managed_land_applied:0,latitude:29.699936,longitude:-95.266914},{facility_name:"DEREK R GUTHRIE WQTC MSD",city:"Louisville",state:"Ky.",amount_of_biosolids_generated:6929,amount_of_biosolids_managed_land_applied:0,latitude:38.08614,longitude:-85.89878},{facility_name:"COBB CO - SOUTH",city:"Marietta",state:"Ga.",amount_of_biosolids_generated:6860,amount_of_biosolids_managed_land_applied:508.87,latitude:33.773806,longitude:-84.537167},{facility_name:"SYNAGRO TECHNOLOGIES - CHARLOTTE COUNTY BIO-RECYCLING CENTER",city:"Punta Gorda",state:"Fla.",amount_of_biosolids_generated:6852,amount_of_biosolids_managed_land_applied:6852,latitude:26.79941,longitude:-81.9646},{facility_name:"HRSD VIRGINIA INITIATIVE PLANT",city:"Norfolk",state:"Utah",amount_of_biosolids_generated:6829,amount_of_biosolids_managed_land_applied:0,latitude:36.88233,longitude:-76.3125},{facility_name:"LOWELL REGIONAL WW UTILITY",city:"Lowell",state:"Mass.",amount_of_biosolids_generated:6791,amount_of_biosolids_managed_land_applied:0,latitude:42.648304,longitude:-71.288911},{facility_name:"CITY OF GARLAND",city:"Sunnyvale",state:"Texas",amount_of_biosolids_generated:6756,amount_of_biosolids_managed_land_applied:0,latitude:32.795065,longitude:-96.523218},{facility_name:"RIVERSIDE RWQCP",city:"Riverside",state:"Calif.",amount_of_biosolids_generated:6715,amount_of_biosolids_managed_land_applied:0,latitude:33.98094,longitude:-117.37516},{facility_name:"STONY BROOK RSA",city:"Princeton",state:"Neb.",amount_of_biosolids_generated:6640,amount_of_biosolids_managed_land_applied:0,latitude:40.38401,longitude:-74.62306},{facility_name:"ALBANY CO SD",city:"Albany",state:"N.D.",amount_of_biosolids_generated:6639,amount_of_biosolids_managed_land_applied:0,latitude:42.6823962,longitude:-73.73647273},{facility_name:"NEW BEDFORD W W T F",city:"New Bedford",state:"Mass.",amount_of_biosolids_generated:6633,amount_of_biosolids_managed_land_applied:0,latitude:41.61428281,longitude:-70.91671461},{facility_name:"NYCDEP - JAMAICA WWRF",city:"Jamaica",state:"N.D.",amount_of_biosolids_generated:6608,amount_of_biosolids_managed_land_applied:0,latitude:40.65925,longitude:-73.80226},{facility_name:"PISCATAWAY WWTP",city:"Accokeek",state:"Mass.",amount_of_biosolids_generated:6607,amount_of_biosolids_managed_land_applied:6205,latitude:38.688645,longitude:-76.996768},{facility_name:"TULARE LAKE COMPOST",city:"Kettleman City",state:"Calif.",amount_of_biosolids_generated:6596,amount_of_biosolids_managed_land_applied:6596,latitude:35.94242,longitude:-119.87903},{facility_name:"JT MTG OF ESSEX & UNION CNTY",city:"Elizabeth",state:"Neb.",amount_of_biosolids_generated:6555,amount_of_biosolids_managed_land_applied:6554.92,latitude:40.639537,longitude:-74.200357},{facility_name:"DELAWARE #1 WATER POL CON FAC",city:"Camden",state:"Neb.",amount_of_biosolids_generated:6439,amount_of_biosolids_managed_land_applied:5422.96,latitude:39.91675769,longitude:-75.10992288},{facility_name:"HENDERSON WRF",city:"Henderson",state:"N.D.",amount_of_biosolids_generated:6355,amount_of_biosolids_managed_land_applied:0,latitude:36.03463947,longitude:-114.9757789},{facility_name:"ENCINA WPCF",city:"Carlsbad",state:"Calif.",amount_of_biosolids_generated:6319,amount_of_biosolids_managed_land_applied:5471.75,latitude:33.118846,longitude:-117.323517},{facility_name:"CITY OF AUGUSTA (J.B. MESSERLY)",city:"Augusta",state:"Ga.",amount_of_biosolids_generated:6286,amount_of_biosolids_managed_land_applied:4537.22,latitude:33.375556,longitude:-81.953972},{facility_name:"ALMEDA SIMS WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:6273,amount_of_biosolids_managed_land_applied:0,latitude:29.629134,longitude:-95.409126},{facility_name:"KUB-KUWAHEE STP",city:"Knoxville",state:"Tenn.",amount_of_biosolids_generated:6266,amount_of_biosolids_managed_land_applied:6266,latitude:35.944642,longitude:-83.930089},{facility_name:"GREATER LAWRENCE SANITARY DISTRICT",city:"North Andover",state:"Mass.",amount_of_biosolids_generated:6171,amount_of_biosolids_managed_land_applied:6155.73,latitude:42.714543,longitude:-71.128793},{facility_name:"HOT SPRINGS, CITY OF (HOT SPGS",city:"Hot Springs",state:"Alaska",amount_of_biosolids_generated:6140,amount_of_biosolids_managed_land_applied:6140,latitude:34.451373,longitude:-93.016844},{facility_name:"OCUD/SOUTH WRF",city:"Orlando",state:"Fla.",amount_of_biosolids_generated:6122,amount_of_biosolids_managed_land_applied:4439.75,latitude:28.45009,longitude:-81.43923},{facility_name:"NASSAU (C) BAY PARK STP",city:"East Rockaway",state:"N.D.",amount_of_biosolids_generated:6102,amount_of_biosolids_managed_land_applied:0,latitude:40.63404,longitude:-73.6623},{facility_name:"NASSAU CO DPW",city:"Westbury",state:"N.D.",amount_of_biosolids_generated:6096,amount_of_biosolids_managed_land_applied:0,latitude:40.76431,longitude:-73.55276},{facility_name:"NYCDEP - 26TH WARD WPCP",city:"Brooklyn",state:"N.D.",amount_of_biosolids_generated:6077,amount_of_biosolids_managed_land_applied:19158,latitude:40.66903125,longitude:-73.89519579},{facility_name:"HRSD-WILLIAMSBURG STP",city:"Williamsburg",state:"Utah",amount_of_biosolids_generated:6045,amount_of_biosolids_managed_land_applied:0,latitude:37.214856,longitude:-76.635531},{facility_name:"PRINCE WILLIAM CTY SERV AUTH",city:"Woodbridge",state:"Utah",amount_of_biosolids_generated:6026,amount_of_biosolids_managed_land_applied:0,latitude:38.61623,longitude:-77.26961},{facility_name:"HOPEWELL STP CITY OF",city:"Hopewell",state:"Utah",amount_of_biosolids_generated:5927,amount_of_biosolids_managed_land_applied:0,latitude:37.2910097,longitude:-77.2989443},{facility_name:"VEOLIA WATER-CRANSTON WPCF",city:"Cranston",state:"R.I.",amount_of_biosolids_generated:5917,amount_of_biosolids_managed_land_applied:0,latitude:41.7526,longitude:-71.4425},{facility_name:"EDWARD C. LITTLE WRP",city:"Carson",state:"Calif.",amount_of_biosolids_generated:5914,amount_of_biosolids_managed_land_applied:5914.39,latitude:33.90829,longitude:-118.39308},{facility_name:"CITY OF SPRINGFIELD",city:"Springfield",state:"Mo.",amount_of_biosolids_generated:5900,amount_of_biosolids_managed_land_applied:5324,latitude:37.21538219,longitude:-93.29428548},{facility_name:"CITY OF LANCASTER",city:"Lancaster",state:"Pa.",amount_of_biosolids_generated:5900,amount_of_biosolids_managed_land_applied:1957,latitude:40.016667,longitude:-76.305556},{facility_name:"BRUSHY CREEK REGIONAL EAST WWTF",city:"Round Rock",state:"Texas",amount_of_biosolids_generated:5893,amount_of_biosolids_managed_land_applied:0,latitude:30.5262,longitude:-97.6195},{facility_name:"LYNN REGIONAL WPCF",city:"Lynn",state:"Mass.",amount_of_biosolids_generated:5873,amount_of_biosolids_managed_land_applied:0,latitude:42.45293,longitude:-70.956287},{facility_name:"YPSILANTI COMMUNITY UTILITIES AUTHORITY",city:"Ypsilanti",state:"Mich.",amount_of_biosolids_generated:5849,amount_of_biosolids_managed_land_applied:0,latitude:42.22486,longitude:-83.55442},{facility_name:"CITY OF SIOUX CITY",city:"Sioux City",state:"Hawaii",amount_of_biosolids_generated:5801,amount_of_biosolids_managed_land_applied:7164.4,latitude:42.49265332,longitude:-96.40189444},{facility_name:"UPPER OCCOQUAN S.A. (UOSA)",city:"Centreville",state:"Utah",amount_of_biosolids_generated:5724,amount_of_biosolids_managed_land_applied:5660,latitude:38.81142,longitude:-77.45508},{facility_name:"TIMPANOGOS SPECIAL SERVICE DIS",city:"Pleasant Grove",state:"Utah",amount_of_biosolids_generated:5664,amount_of_biosolids_managed_land_applied:0,latitude:40.384151,longitude:-111.742462},{facility_name:"FOX METRO WRD STP",city:"Oswego",state:"Iowa",amount_of_biosolids_generated:5657,amount_of_biosolids_managed_land_applied:5469,latitude:41.71486,longitude:-88.3534},{facility_name:"MERRELL BROTHERS INC. - FLORIDAGREEN",city:"Spring Hill",state:"Fla.",amount_of_biosolids_generated:5632,amount_of_biosolids_managed_land_applied:5631.58,latitude:28.36328,longitude:-82.56346},{facility_name:"PINELLAS COUNTY UTILITIES",city:"Largo",state:"Fla.",amount_of_biosolids_generated:5627,amount_of_biosolids_managed_land_applied:5627,latitude:27.823504,longitude:-82.74107},{facility_name:"GREATER PEORIA SANITARY AND SEWAGE DISTRICT",city:"Peoria",state:"Iowa",amount_of_biosolids_generated:5615,amount_of_biosolids_managed_land_applied:14961,latitude:40.65945,longitude:-89.62497},{facility_name:"MILLERCOORS LLC",city:"Golden",state:"Colo.",amount_of_biosolids_generated:5590,amount_of_biosolids_managed_land_applied:0,latitude:39.7425166,longitude:-105.2105415},{facility_name:"CWS - ROCK CREEK STP",city:"Hillsboro",state:"Ore.",amount_of_biosolids_generated:5587,amount_of_biosolids_managed_land_applied:5587,latitude:45.49503,longitude:-122.944973},{facility_name:"CENTRAL VALLEY WTR RFB-CENTRAL",city:"South Salt Lake",state:"Utah",amount_of_biosolids_generated:5556,amount_of_biosolids_managed_land_applied:5556,latitude:40.68173,longitude:-111.89973},{facility_name:"EMERALD COAST UTILITIES AUTHORITY",city:"Cantonment",state:"Fla.",amount_of_biosolids_generated:5555,amount_of_biosolids_managed_land_applied:5555,latitude:30.589173,longitude:-87.262211},{facility_name:"NEW ALBANY WWTP",city:"New Albany",state:"Iowa",amount_of_biosolids_generated:5552,amount_of_biosolids_managed_land_applied:0,latitude:38.27948,longitude:-85.832298},{facility_name:"MWMC - EUGENE/SPRINGFIELD STP",city:"Eugene",state:"Ore.",amount_of_biosolids_generated:5495,amount_of_biosolids_managed_land_applied:2574,latitude:44.095584,longitude:-123.111946},{facility_name:"SENECA WWTP",city:"Germantown",state:"Mass.",amount_of_biosolids_generated:5481,amount_of_biosolids_managed_land_applied:5481,latitude:39.17102,longitude:-77.26272},{facility_name:"ORO LOMA WWTF",city:"San Lorenzo",state:"Calif.",amount_of_biosolids_generated:5456,amount_of_biosolids_managed_land_applied:5455.66,latitude:37.67988,longitude:-122.126482},{facility_name:"METROPOLITAN WRDGC-KIRIE",city:"Chicago",state:"Iowa",amount_of_biosolids_generated:5440,amount_of_biosolids_managed_land_applied:0,latitude:42.02135,longitude:-87.93707},{facility_name:"PALO ALTO REGIONAL WQCP",city:"Palo Alto",state:"Calif.",amount_of_biosolids_generated:5437,amount_of_biosolids_managed_land_applied:0,latitude:37.458333,longitude:-122.110833},{facility_name:"WYOMING VALLEY SANITARY AUTHOR",city:"Wilkes Barre",state:"Pa.",amount_of_biosolids_generated:5431,amount_of_biosolids_managed_land_applied:0,latitude:41.23317,longitude:-75.93908},{facility_name:"JOCO-MILL CREEK REGIONAL WWTP",city:"Olathe",state:"Kan.",amount_of_biosolids_generated:5428,amount_of_biosolids_managed_land_applied:5428.24,latitude:38.91572,longitude:-94.79924},{facility_name:"STOCKTON RWCF",city:"Stockton",state:"Calif.",amount_of_biosolids_generated:5412,amount_of_biosolids_managed_land_applied:5412.25,latitude:37.937778,longitude:-121.335556},{facility_name:"HAYWARD WPCF",city:"Hayward",state:"Calif.",amount_of_biosolids_generated:5400,amount_of_biosolids_managed_land_applied:0,latitude:37.633275,longitude:-122.131995},{facility_name:"MATTAWOMAN WWTP",city:"Charles County",state:"Mass.",amount_of_biosolids_generated:5387,amount_of_biosolids_managed_land_applied:5387.38,latitude:38.578036,longitude:-77.110999},{facility_name:"MWRDGC-JOHN E. EGAN WRP",city:"Schaumburg",state:"Iowa",amount_of_biosolids_generated:5378,amount_of_biosolids_managed_land_applied:0,latitude:42.019542,longitude:-88.045704},{facility_name:"CHARLESTON CPW/PLUM ISLAND",city:"Charleston",state:"S.C.",amount_of_biosolids_generated:5323,amount_of_biosolids_managed_land_applied:1107.35,latitude:32.758611,longitude:-79.949444},{facility_name:"METROPOLITAN ST. LOUIS SEWER DISTRICT",city:"St. Louis",state:"Mo.",amount_of_biosolids_generated:5318,amount_of_biosolids_managed_land_applied:0,latitude:38.63107,longitude:-90.21532},{facility_name:"ANCHORAGE, MUNICIPALITY OF",city:"Anchorage",state:"Alaska",amount_of_biosolids_generated:5318,amount_of_biosolids_managed_land_applied:0,latitude:61.196425,longitude:-150.023509},{facility_name:"MIDLAND WATER POLLUTION CONTROL 1 WWTP",city:"Midland",state:"Texas",amount_of_biosolids_generated:5292,amount_of_biosolids_managed_land_applied:41.5,latitude:31.999606,longitude:-102.0186},{facility_name:"VISALIA WCP",city:"Visalia",state:"Calif.",amount_of_biosolids_generated:5282,amount_of_biosolids_managed_land_applied:1013.39,latitude:36.330729,longitude:-119.2787},{facility_name:"CITY OF EDINBURG WWTP",city:"Edinburg",state:"Texas",amount_of_biosolids_generated:5221,amount_of_biosolids_managed_land_applied:0,latitude:26.309177,longitude:-98.136498},{facility_name:"ALEXANDRIA CITY SANITARY AUTHO",city:"Alexandria",state:"Utah",amount_of_biosolids_generated:5181,amount_of_biosolids_managed_land_applied:4982.27,latitude:38.7989,longitude:-77.0606},{facility_name:"ROBERTO R BUSTAMANTE WWTP",city:"El Paso",state:"Texas",amount_of_biosolids_generated:5144,amount_of_biosolids_managed_land_applied:0,latitude:31.65392,longitude:-106.32109},{facility_name:"FORT LAUDERDALE - G T LOHMEYER WWTP",city:"Fort Lauderdale",state:"Fla.",amount_of_biosolids_generated:5136,amount_of_biosolids_managed_land_applied:0,latitude:26.09952,longitude:-80.12476},{facility_name:"NEW ORLEANS, CITY OF (EAST BAN",city:"New Orleans",state:"La.",amount_of_biosolids_generated:5118,amount_of_biosolids_managed_land_applied:0,latitude:29.976667,longitude:-89.997222},{facility_name:"CITY OF HIGH POINT",city:"High Point",state:"Mont.",amount_of_biosolids_generated:5110,amount_of_biosolids_managed_land_applied:0,latitude:35.942626,longitude:-79.908075},{facility_name:"WICHITA, CITY OF",city:"Wichita",state:"Kan.",amount_of_biosolids_generated:5093,amount_of_biosolids_managed_land_applied:5093.4,latitude:37.68598801,longitude:-97.33435526},{facility_name:"FORT SMITH, CITY OF (MASSARD W",city:"Barling",state:"Alaska",amount_of_biosolids_generated:5076,amount_of_biosolids_managed_land_applied:0,latitude:35.32869,longitude:-94.31158},{facility_name:"JACKSON POTW - SAVANNA STREET",city:"Jackson",state:"Mo.",amount_of_biosolids_generated:5073,amount_of_biosolids_managed_land_applied:4238.4,latitude:32.237372,longitude:-90.208956},{facility_name:"SOUTH VALLEY WATER RECLAM FAC",city:"West Jordan",state:"Utah",amount_of_biosolids_generated:5031,amount_of_biosolids_managed_land_applied:0,latitude:40.614637,longitude:-111.923776},{facility_name:"GARDEN CITY, CITY OF",city:"Garden City",state:"Kan.",amount_of_biosolids_generated:4994,amount_of_biosolids_managed_land_applied:4994.4,latitude:37.9588357,longitude:-100.6157567},{facility_name:"NYCDEP - PORT RICHMOND WPCF",city:"Staten Island, Borough Of",state:"N.D.",amount_of_biosolids_generated:4899,amount_of_biosolids_managed_land_applied:0,latitude:40.63325414,longitude:-74.11699094},{facility_name:"DECATUR SD MAIN STP",city:"Decatur",state:"Iowa",amount_of_biosolids_generated:4883,amount_of_biosolids_managed_land_applied:3409,latitude:39.84004,longitude:-89.00085},{facility_name:"MERRIMACK W W T F",city:"Merrimack",state:"Neb.",amount_of_biosolids_generated:4857,amount_of_biosolids_managed_land_applied:4765,latitude:42.809523,longitude:-71.475871},{facility_name:"JACKSONVILLE SEWER COMMISSION",city:"Jacksonville",state:"Alaska",amount_of_biosolids_generated:4850,amount_of_biosolids_managed_land_applied:0,latitude:34.864503,longitude:-92.112049},{facility_name:"CITY OF KANSAS CITY",city:"Kansas City",state:"Mo.",amount_of_biosolids_generated:4842,amount_of_biosolids_managed_land_applied:0,latitude:39.01323,longitude:-94.52917},{facility_name:"SYNAGRO ORGANIC FERTILIZER CO OF SACRAMENTO",city:"Elk Grove",state:"Calif.",amount_of_biosolids_generated:4831,amount_of_biosolids_managed_land_applied:4825,latitude:38.442517,longitude:-121.459114},{facility_name:"LOMPOC RWRP",city:"Lompoc",state:"Calif.",amount_of_biosolids_generated:4808,amount_of_biosolids_managed_land_applied:0,latitude:34.63910164,longitude:-120.4669499},{facility_name:"RESOURCE MANAGEMENT INC",city:"New Hampton",state:"Neb.",amount_of_biosolids_generated:4795,amount_of_biosolids_managed_land_applied:4794.89,latitude:43.63083,longitude:-71.65012},{facility_name:"VICTOR VALLEY WRA WWTP",city:"Hesperia",state:"Calif.",amount_of_biosolids_generated:4794,amount_of_biosolids_managed_land_applied:4337.3,latitude:34.616658,longitude:-117.355048},{facility_name:"CAMP CREEK WPCP",city:"Fulton County",state:"Ga.",amount_of_biosolids_generated:4792,amount_of_biosolids_managed_land_applied:0,latitude:33.678256,longitude:-84.634493},{facility_name:"ROWLETT CREEK REGIONAL WWTP",city:"Wylie",state:"Texas",amount_of_biosolids_generated:4778,amount_of_biosolids_managed_land_applied:0,latitude:33.124035,longitude:-96.565558},{facility_name:"PECAN CREEK WATER RECLAMATION PLANT",city:"Denton",state:"Texas",amount_of_biosolids_generated:4770,amount_of_biosolids_managed_land_applied:4769.3,latitude:33.19826,longitude:-97.08457},{facility_name:"HAMMOND SANITARY DISTRICT WWTP",city:"Hammond",state:"Iowa",amount_of_biosolids_generated:4762,amount_of_biosolids_managed_land_applied:4763.66,latitude:41.620237,longitude:-87.500051},{facility_name:"NORTH DURHAM COMPOSTING FACILITY",city:"Durham",state:"Mont.",amount_of_biosolids_generated:4742,amount_of_biosolids_managed_land_applied:4742,latitude:35.99597,longitude:-78.8996},{facility_name:"SAN BERNARDINO WRF",city:"San Bernardino",state:"Calif.",amount_of_biosolids_generated:4723,amount_of_biosolids_managed_land_applied:0,latitude:34.10456,longitude:-117.29191},{facility_name:"ROCK HILL/MANCHESTER CREEK",city:"Rock Hill",state:"S.C.",amount_of_biosolids_generated:4695,amount_of_biosolids_managed_land_applied:0,latitude:34.955978,longitude:-80.958298},{facility_name:"NYCDEP - TALLMAN ISLAND WPCP",city:"College Point",state:"N.D.",amount_of_biosolids_generated:4680,amount_of_biosolids_managed_land_applied:0,latitude:40.78528303,longitude:-73.84311167},{facility_name:"LACSD - VALENCIA WRP",city:"Whittier",state:"Calif.",amount_of_biosolids_generated:4607,amount_of_biosolids_managed_land_applied:0,latitude:33.96071322,longitude:-118.0256606},{facility_name:"OXNARD WWTP",city:"Oxnard",state:"Calif.",amount_of_biosolids_generated:4508,amount_of_biosolids_managed_land_applied:0,latitude:34.141619,longitude:-119.184014},{facility_name:"WINTER GARDEN PARK WWTP",city:"Harlingen",state:"Texas",amount_of_biosolids_generated:4500,amount_of_biosolids_managed_land_applied:0,latitude:26.169056,longitude:-97.783694},{facility_name:"TWA - SOUTH BERMUDA",city:"Kissimmee",state:"Fla.",amount_of_biosolids_generated:4497,amount_of_biosolids_managed_land_applied:0,latitude:28.27425,longitude:-81.42118},{facility_name:"WACO METROPOLITAN AREA REGIONAL SEWARGE SYSTEM",city:"Waco",state:"Texas",amount_of_biosolids_generated:4496,amount_of_biosolids_managed_land_applied:4313,latitude:31.517822,longitude:-97.064841},{facility_name:"COBB CO - NORTHWEST WRF",city:"Marietta",state:"Ga.",amount_of_biosolids_generated:4488,amount_of_biosolids_managed_land_applied:2714.27,latitude:34.0446,longitude:-84.6571},{facility_name:"JEFFERSON COUNTY COMMISSION ENVIRONMENTAL SERVICES DEPARTMENT",city:"Birmingham",state:"Alaska",amount_of_biosolids_generated:4480,amount_of_biosolids_managed_land_applied:4480,latitude:33.3928,longitude:-87.0083},{facility_name:"SARATOGA COUNTY",city:"Ballston Spa",state:"N.D.",amount_of_biosolids_generated:4471,amount_of_biosolids_managed_land_applied:0,latitude:42.99873,longitude:-73.850511},{facility_name:"CITY OF HOUSTON",city:"Houston",state:"Texas",amount_of_biosolids_generated:4462,amount_of_biosolids_managed_land_applied:0,latitude:29.66529,longitude:-95.29868},{facility_name:"HILLSBOROUGH COUNTY WATER DEPARTMENT",city:"Tampa",state:"Fla.",amount_of_biosolids_generated:4443,amount_of_biosolids_managed_land_applied:0,latitude:28.072785,longitude:-82.609342},{facility_name:"MANCHESTER CITY OF",city:"Manchester",state:"Neb.",amount_of_biosolids_generated:4424,amount_of_biosolids_managed_land_applied:0,latitude:42.94447,longitude:-71.45794},{facility_name:"SOUTH CENTRAL REGIONAL WW TRT & DISPOSAL BOARD",city:"Delray Beach",state:"Fla.",amount_of_biosolids_generated:4385,amount_of_biosolids_managed_land_applied:0,latitude:26.482778,longitude:-80.088889},{facility_name:"PRASA PUERTO NUEVO",city:"San Juan",state:"Pa.",amount_of_biosolids_generated:4367,amount_of_biosolids_managed_land_applied:0,latitude:18.430087,longitude:-66.084137},{facility_name:"UNION SANITARY DISTRICT WWTP",city:"Union City",state:"Calif.",amount_of_biosolids_generated:4360,amount_of_biosolids_managed_land_applied:2963.37,latitude:37.593046,longitude:-122.088431},{facility_name:"VEOLIA WATER NORTH AMERICA, LLC - BALTIMORE CITY COMPOSTING FACILITY",city:"Baltimore",state:"Mass.",amount_of_biosolids_generated:4348,amount_of_biosolids_managed_land_applied:0,latitude:39.20581,longitude:-76.55936},{facility_name:"LINCOLN THERESA WWTF",city:"Lincoln",state:"Neb.",amount_of_biosolids_generated:4341,amount_of_biosolids_managed_land_applied:3088,latitude:40.83803,longitude:-96.68647},{facility_name:"SANTA ROSA LAGUNA WWTP",city:"Santa Rosa",state:"Calif.",amount_of_biosolids_generated:4318,amount_of_biosolids_managed_land_applied:2415,latitude:38.36876,longitude:-122.7686},{facility_name:"ST. PETERSBURG, CITY OF - SOUTHWEST WRF",city:"Saint Petersburg",state:"Fla.",amount_of_biosolids_generated:4295,amount_of_biosolids_managed_land_applied:4295.1,latitude:27.7895102,longitude:-82.67934},{facility_name:"LEAVENWORTH, CITY OF",city:"Leavenworth",state:"Kan.",amount_of_biosolids_generated:4265,amount_of_biosolids_managed_land_applied:0,latitude:39.31927,longitude:-94.9156},{facility_name:"AMHERST (T)",city:"Williamsville",state:"N.D.",amount_of_biosolids_generated:4261,amount_of_biosolids_managed_land_applied:0,latitude:42.98618,longitude:-78.76306},{facility_name:"WATERBURY WPCF",city:"Waterbury",state:"Conn.",amount_of_biosolids_generated:4256,amount_of_biosolids_managed_land_applied:0,latitude:41.52065,longitude:-73.04561},{facility_name:"NORTHWEST BERGEN COUNTY UA",city:"Waldwick",state:"Neb.",amount_of_biosolids_generated:4197,amount_of_biosolids_managed_land_applied:0,latitude:41.006541,longitude:-74.119143},{facility_name:"SOMERSET RARITAN VALLEY SA",city:"Bridgewater",state:"Neb.",amount_of_biosolids_generated:4168,amount_of_biosolids_managed_land_applied:0,latitude:40.557339,longitude:-74.567103},{facility_name:"HRSD- ATLANTIC",city:"Virginia Beach",state:"Utah",amount_of_biosolids_generated:4163,amount_of_biosolids_managed_land_applied:4163,latitude:36.771635,longitude:-75.971575},{facility_name:"SALT LAKE CITY CORP-WAST WATER",city:"Salt Lake City",state:"Utah",amount_of_biosolids_generated:4148,amount_of_biosolids_managed_land_applied:3974.6,latitude:40.8131,longitude:-111.9309},{facility_name:"BROCKTON A W R F",city:"Brockton",state:"Mass.",amount_of_biosolids_generated:4142,amount_of_biosolids_managed_land_applied:0,latitude:42.04928,longitude:-71.0028},{facility_name:"CITY OF WINSTON-SALEM",city:"Winston Salem",state:"Mont.",amount_of_biosolids_generated:4126,amount_of_biosolids_managed_land_applied:4126,latitude:36.036999,longitude:-80.309196},{facility_name:"CITY OF WINSTON-SALEM",city:"Winston Salem",state:"Mont.",amount_of_biosolids_generated:4126,amount_of_biosolids_managed_land_applied:4126,latitude:35.995932,longitude:-80.332791},{facility_name:"ATLANTA (SOUTH RIVER WRC)",city:"Atlanta",state:"Ga.",amount_of_biosolids_generated:4108,amount_of_biosolids_managed_land_applied:0,latitude:33.68244,longitude:-84.36565},{facility_name:"EVANSVILLE EAST WWTP",city:"Evansville",state:"Iowa",amount_of_biosolids_generated:4107,amount_of_biosolids_managed_land_applied:0,latitude:37.954444,longitude:-87.56825},{facility_name:"MOUNT HOUSTON RD MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:4103,amount_of_biosolids_managed_land_applied:0,latitude:29.909328,longitude:-95.444255},{facility_name:"INLAND EMPIRE UTILITIES PLT 2",city:"Chino Hills",state:"Calif.",amount_of_biosolids_generated:4096,amount_of_biosolids_managed_land_applied:0,latitude:33.97307512,longitude:-117.7343957},{facility_name:"SOUTH MESQUITE CREEK WWTP",city:"Wylie",state:"Texas",amount_of_biosolids_generated:3984,amount_of_biosolids_managed_land_applied:0,latitude:32.709733,longitude:-96.541833},{facility_name:"NORTHEAST OHIO REGIONAL S D",city:"Cleveland",state:"Ohio",amount_of_biosolids_generated:3963,amount_of_biosolids_managed_land_applied:0,latitude:41.49288,longitude:-81.72462},{facility_name:"TORNILLO WWTF",city:"Tornillo",state:"Texas",amount_of_biosolids_generated:3934,amount_of_biosolids_managed_land_applied:0,latitude:31.433556,longitude:-106.106028},{facility_name:"CWS - DURHAM STP",city:"Tigard",state:"Ore.",amount_of_biosolids_generated:3929,amount_of_biosolids_managed_land_applied:3929,latitude:45.401132,longitude:-122.761381},{facility_name:"KANKAKEE RIVER METRO AGENCY",city:"Kankakee",state:"Iowa",amount_of_biosolids_generated:3926,amount_of_biosolids_managed_land_applied:1841,latitude:41.135644,longitude:-87.885397},{facility_name:"EMWD - PERRIS VALLEY RWRF",city:"Perris",state:"Calif.",amount_of_biosolids_generated:3868,amount_of_biosolids_managed_land_applied:3868.32,latitude:33.98325227,longitude:-117.0081718},{facility_name:"FALL RIVER W W T P",city:"Fall River",state:"Mass.",amount_of_biosolids_generated:3855,amount_of_biosolids_managed_land_applied:0,latitude:41.67677,longitude:-71.193934},{facility_name:"NASHVILLE-WHITES CR STP",city:"Nashville",state:"Tenn.",amount_of_biosolids_generated:3833,amount_of_biosolids_managed_land_applied:0,latitude:36.181389,longitude:-86.856667},{facility_name:"GREATER HAZLETON WWTP",city:"Hazleton",state:"Pa.",amount_of_biosolids_generated:3791,amount_of_biosolids_managed_land_applied:0,latitude:40.97348,longitude:-76.01966},{facility_name:"MANATEE COUNTY SOUTHEAST REGIONAL WWTF",city:"Bradenton",state:"Fla.",amount_of_biosolids_generated:3773,amount_of_biosolids_managed_land_applied:3667.06,latitude:27.469668,longitude:-82.45878},{facility_name:"THREE RIVERS REGIONAL WASTEWATER",city:"Kelso",state:"Wash.",amount_of_biosolids_generated:3753,amount_of_biosolids_managed_land_applied:3753.34,latitude:46.100391,longitude:-122.928604},{facility_name:"MAYAGUEZ COMPOSTING PLANT",city:"Mayaguez",state:"Pa.",amount_of_biosolids_generated:3748,amount_of_biosolids_managed_land_applied:7962.5,latitude:18.19836159,longitude:-67.12626216},{facility_name:"SILICON VALLEY CLEAN WATER",city:"Redwood City",state:"Calif.",amount_of_biosolids_generated:3730,amount_of_biosolids_managed_land_applied:1930.88,latitude:37.542795,longitude:-122.231095},{facility_name:"MONROE CO DIV OF PURE WATERS",city:"Rochester",state:"N.D.",amount_of_biosolids_generated:3687,amount_of_biosolids_managed_land_applied:0,latitude:43.15537,longitude:-77.61405},{facility_name:"LITTLE MIAMI WWTP - METRO CINCINNATI SEWER DISTRICT",city:"Cincinnati",state:"Ohio",amount_of_biosolids_generated:3681,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"STAMFORD WPCA",city:"Stamford",state:"Conn.",amount_of_biosolids_generated:3679,amount_of_biosolids_managed_land_applied:3706,latitude:41.045627,longitude:-73.530356},{facility_name:"SOUTH AUSTIN REGIONAL WWTF",city:"Austin",state:"Texas",amount_of_biosolids_generated:3666,amount_of_biosolids_managed_land_applied:0,latitude:30.208001,longitude:-97.60419},{facility_name:"DECATUR UTILITIES",city:"Decatur",state:"Alaska",amount_of_biosolids_generated:3648,amount_of_biosolids_managed_land_applied:0,latitude:34.62107,longitude:-86.99649},{facility_name:"LIBERTY HILL REGIONAL WWTP",city:"Liberty Hill",state:"Texas",amount_of_biosolids_generated:3647,amount_of_biosolids_managed_land_applied:0,latitude:30.616972,longitude:-97.84675},{facility_name:"BELLINGHAM STP",city:"Bellingham",state:"Wash.",amount_of_biosolids_generated:3645,amount_of_biosolids_managed_land_applied:0,latitude:48.717831,longitude:-122.513963},{facility_name:"ANNAPOLIS WRF",city:"Annapolis",state:"Mass.",amount_of_biosolids_generated:3642,amount_of_biosolids_managed_land_applied:3641.93,latitude:38.958111,longitude:-76.481361},{facility_name:"HARRISONBURG-ROCKINGHAM RSA",city:"Mount Crawford",state:"Utah",amount_of_biosolids_generated:3622,amount_of_biosolids_managed_land_applied:1452,latitude:38.343547,longitude:-78.92986},{facility_name:"HILLSBOROUGH COUNTY PUBLIC UTILITIES DEPARTMENT",city:"Tampa",state:"Fla.",amount_of_biosolids_generated:3620,amount_of_biosolids_managed_land_applied:0,latitude:27.953056,longitude:-82.341389},{facility_name:"FULTON COUNTY (BIG CREEK)",city:"Atlanta",state:"Ga.",amount_of_biosolids_generated:3608,amount_of_biosolids_managed_land_applied:0,latitude:33.75083,longitude:-84.39142},{facility_name:"GAINESVILLE REGIONAL UTILITIES",city:"Gainesville",state:"Fla.",amount_of_biosolids_generated:3592,amount_of_biosolids_managed_land_applied:0,latitude:29.620566,longitude:-82.411895},{facility_name:"LITTLETON/ENGLEWOOD CITIES OF",city:"Englewood",state:"Colo.",amount_of_biosolids_generated:3586,amount_of_biosolids_managed_land_applied:3586,latitude:39.66133,longitude:-105.00381},{facility_name:"HAVERHILL W P A F",city:"Bradford",state:"Mass.",amount_of_biosolids_generated:3572,amount_of_biosolids_managed_land_applied:0,latitude:42.75941,longitude:-71.061607},{facility_name:"TOPEKA, CITY OF",city:"Topeka",state:"Kan.",amount_of_biosolids_generated:3554,amount_of_biosolids_managed_land_applied:2523,latitude:39.07127,longitude:-95.6431},{facility_name:"CITY OF TEXARKANA SOUTH REGIONAL WWTP",city:"Texarkana",state:"Texas",amount_of_biosolids_generated:3537,amount_of_biosolids_managed_land_applied:0,latitude:33.378528,longitude:-94.046484},{facility_name:"PROCTORS CREEK WASTEWATER TREATMENT PLANT",city:"Chester",state:"Utah",amount_of_biosolids_generated:3536,amount_of_biosolids_managed_land_applied:3536,latitude:37.381453,longitude:-77.378036},{facility_name:"HILLEBRANDT WWTP",city:"Beaumont",state:"Texas",amount_of_biosolids_generated:3491,amount_of_biosolids_managed_land_applied:0,latitude:30.035341,longitude:-94.133575},{facility_name:"MARINE PARK STP",city:"Vancouver",state:"Wash.",amount_of_biosolids_generated:3478,amount_of_biosolids_managed_land_applied:0,latitude:45.615876,longitude:-122.620752},{facility_name:"MORRISVILLE BORO MUN AUTH - ST",city:"Morrisville",state:"Pa.",amount_of_biosolids_generated:3477,amount_of_biosolids_managed_land_applied:0,latitude:40.2107,longitude:-74.77575},{facility_name:"ESCONDIDO HALE AVE RRF",city:"Escondido",state:"Calif.",amount_of_biosolids_generated:3465,amount_of_biosolids_managed_land_applied:3465,latitude:33.10517,longitude:-117.11138},{facility_name:"VALLEJO SFCD",city:"Vallejo",state:"Calif.",amount_of_biosolids_generated:3462,amount_of_biosolids_managed_land_applied:3428,latitude:38.091697,longitude:-122.250298},{facility_name:"TOWN OF CARY",city:"Cary",state:"Mont.",amount_of_biosolids_generated:3462,amount_of_biosolids_managed_land_applied:3222,latitude:35.651341,longitude:-78.755234},{facility_name:"PAW PAW WWTF",city:"Denison",state:"Texas",amount_of_biosolids_generated:3454,amount_of_biosolids_managed_land_applied:0,latitude:33.772798,longitude:-96.501864},{facility_name:"GLOVERSVILLE-JOHNSTOWN JOINT W",city:"Johnstown",state:"N.D.",amount_of_biosolids_generated:3451,amount_of_biosolids_managed_land_applied:0,latitude:42.9925,longitude:-74.399667},{facility_name:"NSSD-GURNEE STP",city:"Gurnee",state:"Iowa",amount_of_biosolids_generated:3441,amount_of_biosolids_managed_land_applied:3367,latitude:42.35689,longitude:-87.925215},{facility_name:"ROANOKE STP",city:"Roanoke",state:"Utah",amount_of_biosolids_generated:3433,amount_of_biosolids_managed_land_applied:3432.89,latitude:37.263578,longitude:-79.91236},{facility_name:"PETERSBURG STP",city:"Petersburg",state:"Utah",amount_of_biosolids_generated:3426,amount_of_biosolids_managed_land_applied:3426,latitude:37.23754,longitude:-77.39709},{facility_name:"SOUTHEAST WATER RECLAMATION PLANT",city:"Lubbock",state:"Texas",amount_of_biosolids_generated:3419,amount_of_biosolids_managed_land_applied:0,latitude:33.561417,longitude:-101.800639},{facility_name:"HAMBY WATER RECLAMATION WWTP",city:"Abilene",state:"Texas",amount_of_biosolids_generated:3385,amount_of_biosolids_managed_land_applied:0,latitude:32.561611,longitude:-99.622556},{facility_name:"PATUXENT WATER RECLAMATION FAC",city:"Crofton",state:"Mass.",amount_of_biosolids_generated:3354,amount_of_biosolids_managed_land_applied:3353.6,latitude:39.018056,longitude:-76.700583},{facility_name:"SPRINGDALE, CITY OF",city:"Springdale",state:"Alaska",amount_of_biosolids_generated:3346,amount_of_biosolids_managed_land_applied:0,latitude:36.177123,longitude:-94.11217},{facility_name:"COLUMBUS WATER WORKS",city:"Columbus",state:"Ga.",amount_of_biosolids_generated:3342,amount_of_biosolids_managed_land_applied:3341.72,latitude:32.410056,longitude:-84.979389},{facility_name:"HASKELL R STREET WWTF",city:"El Paso",state:"Texas",amount_of_biosolids_generated:3340,amount_of_biosolids_managed_land_applied:0,latitude:31.761615,longitude:-106.44289},{facility_name:"SARASOTA COUNTY PUBLIC UTILITIES",city:"Sarasota",state:"Fla.",amount_of_biosolids_generated:3333,amount_of_biosolids_managed_land_applied:0,latitude:27.276067,longitude:-82.550898},{facility_name:"ST GEORGE CITY CORP",city:"St. George",state:"Utah",amount_of_biosolids_generated:3305,amount_of_biosolids_managed_land_applied:0,latitude:37.11157,longitude:-113.57967},{facility_name:"RIVANNA W&SA-MOORES CREEK STP",city:"Charlottesville",state:"Utah",amount_of_biosolids_generated:3299,amount_of_biosolids_managed_land_applied:0,latitude:38.017507,longitude:-78.460485},{facility_name:"MACON WATER AUTHORITY-ROCKY CR",city:"Macon",state:"Ga.",amount_of_biosolids_generated:3296,amount_of_biosolids_managed_land_applied:2366.81,latitude:32.769534,longitude:-83.640199},{facility_name:"NAUGATUCK WPCF",city:"Naugatuck",state:"Conn.",amount_of_biosolids_generated:3285,amount_of_biosolids_managed_land_applied:0,latitude:41.472975,longitude:-73.053986},{facility_name:"JORDAN BASIN WATER RECLAMATION FACILITY",city:"Riverton",state:"Utah",amount_of_biosolids_generated:3277,amount_of_biosolids_managed_land_applied:3277,latitude:40.503889,longitude:-111.919444},{facility_name:"NORWALK WPCF",city:"Norwalk",state:"Conn.",amount_of_biosolids_generated:3251,amount_of_biosolids_managed_land_applied:0,latitude:41.104383,longitude:-73.411125},{facility_name:"FAIRFIELD-SUISUN WWTP",city:"Fairfield",state:"Calif.",amount_of_biosolids_generated:3241,amount_of_biosolids_managed_land_applied:0,latitude:38.220275,longitude:-122.080276},{facility_name:"LITTLE ROCK, CITY OF-FOURCHE CREEK WWTP",city:"Little Rock",state:"Alaska",amount_of_biosolids_generated:3226,amount_of_biosolids_managed_land_applied:5098.24,latitude:34.698357,longitude:-92.162882},{facility_name:"SOD RUN WASTEWATER TREATMENT",city:"Perryman",state:"Mass.",amount_of_biosolids_generated:3224,amount_of_biosolids_managed_land_applied:2403,latitude:39.426181,longitude:-76.221057},{facility_name:"HUNTINGDON, CITY OF",city:"Huntington",state:"Wis.",amount_of_biosolids_generated:3191,amount_of_biosolids_managed_land_applied:0,latitude:38.426951,longitude:-82.43265},{facility_name:"RIVER ROAD WWTF",city:"Amarillo",state:"Texas",amount_of_biosolids_generated:3176,amount_of_biosolids_managed_land_applied:0,latitude:35.333025,longitude:-101.804168},{facility_name:"LITTLE ROCK, CITY OF-ADAMS FIE",city:"Little Rock",state:"Alaska",amount_of_biosolids_generated:3171,amount_of_biosolids_managed_land_applied:5098.24,latitude:34.734604,longitude:-92.216529},{facility_name:"WOODFOREST INTERIM 1 WWTP",city:"Sugarland",state:"Texas",amount_of_biosolids_generated:3138,amount_of_biosolids_managed_land_applied:3137.98,latitude:30.266388,longitude:-95.547777},{facility_name:"ROCKLAND COUNTY SD#1 STP",city:"Orangeburg",state:"N.D.",amount_of_biosolids_generated:3131,amount_of_biosolids_managed_land_applied:3131,latitude:41.0445,longitude:-73.94419},{facility_name:"GREENWOOD PLANT WWTP",city:"Corpus Christi",state:"Texas",amount_of_biosolids_generated:3130,amount_of_biosolids_managed_land_applied:0,latitude:27.71713,longitude:-97.45753},{facility_name:"CROSSVILLE STP",city:"Crossville",state:"Tenn.",amount_of_biosolids_generated:3126,amount_of_biosolids_managed_land_applied:3126,latitude:35.94709,longitude:-85.02846},{facility_name:"CITY OF HOUSTON",city:"Houston",state:"Texas",amount_of_biosolids_generated:3121,amount_of_biosolids_managed_land_applied:0,latitude:29.844961,longitude:-95.463295},{facility_name:"OCEAN CITY WWTP",city:"Ocean City",state:"Mass.",amount_of_biosolids_generated:3117,amount_of_biosolids_managed_land_applied:2869.1179,latitude:38.387613,longitude:-75.070183},{facility_name:"ZACATE CREEK WWTP",city:"Laredo",state:"Texas",amount_of_biosolids_generated:3108,amount_of_biosolids_managed_land_applied:0,latitude:27.498694,longitude:-99.493806},{facility_name:"SOCWA REGIONAL TP",city:"Laguna Niguel",state:"Calif.",amount_of_biosolids_generated:3106,amount_of_biosolids_managed_land_applied:0,latitude:33.543841,longitude:-117.702564},{facility_name:"DENTON CREEK REGIONAL WWTF",city:"Arlington",state:"Texas",amount_of_biosolids_generated:3103,amount_of_biosolids_managed_land_applied:0,latitude:33.021059,longitude:-97.214585},{facility_name:"HRSD-NANSEMOND",city:"Suffolk",state:"Utah",amount_of_biosolids_generated:3093,amount_of_biosolids_managed_land_applied:0,latitude:36.84832715,longitude:-76.4769789},{facility_name:"NORTHFIELD",city:"Northfield",state:"Minn.",amount_of_biosolids_generated:3090,amount_of_biosolids_managed_land_applied:3090,latitude:44.471094,longitude:-93.156441},{facility_name:"WEALING BROTHERS LLC",city:"Fowler",state:"Iowa",amount_of_biosolids_generated:3066,amount_of_biosolids_managed_land_applied:3066,latitude:40.66651,longitude:-87.21073},{facility_name:"ROCK RIVER WRD",city:"Rockford",state:"Iowa",amount_of_biosolids_generated:3050,amount_of_biosolids_managed_land_applied:3245,latitude:42.222022,longitude:-89.093305},{facility_name:"SOUTHWEST WRF",city:"Cape Coral",state:"Fla.",amount_of_biosolids_generated:3048,amount_of_biosolids_managed_land_applied:0,latitude:26.592816,longitude:-82.017581},{facility_name:"SOUTHWEST WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:3048,amount_of_biosolids_managed_land_applied:0,latitude:29.686501,longitude:-95.450849},{facility_name:"FAYETTEVILLE, CITY OF",city:"Fayetteville",state:"Alaska",amount_of_biosolids_generated:3034,amount_of_biosolids_managed_land_applied:0,latitude:36.079167,longitude:-94.087778},{facility_name:"ATTLEBORO W P C F",city:"Attleboro",state:"Mass.",amount_of_biosolids_generated:3023,amount_of_biosolids_managed_land_applied:0,latitude:41.94422,longitude:-71.28109},{facility_name:"ATLANTA (UTOY CREEK WRC)",city:"Atlanta",state:"Ga.",amount_of_biosolids_generated:3008,amount_of_biosolids_managed_land_applied:0,latitude:33.74721,longitude:-84.554744},{facility_name:"OSO WWTP",city:"Corpus Christi",state:"Texas",amount_of_biosolids_generated:3005,amount_of_biosolids_managed_land_applied:0,latitude:27.70828,longitude:-97.33911},{facility_name:"TRACY WWTP",city:"Tracy",state:"Calif.",amount_of_biosolids_generated:3e3,amount_of_biosolids_managed_land_applied:3e3,latitude:37.765556,longitude:-121.420833},{facility_name:"DELTA DIABLO WWTP",city:"Antioch",state:"Calif.",amount_of_biosolids_generated:2983,amount_of_biosolids_managed_land_applied:2663.15,latitude:38.01668,longitude:-121.84091},{facility_name:"SIMI VALLEY WQCP",city:"Simi Valley",state:"Calif.",amount_of_biosolids_generated:2978,amount_of_biosolids_managed_land_applied:0,latitude:34.287676,longitude:-118.717797},{facility_name:"KCMO WATER SERVICES",city:"Kansas City",state:"Mo.",amount_of_biosolids_generated:2974,amount_of_biosolids_managed_land_applied:5750.24,latitude:39.01323,longitude:-94.52917},{facility_name:"CITY OF SAN MARCOS WWTF",city:"San Marcos",state:"Texas",amount_of_biosolids_generated:2927,amount_of_biosolids_managed_land_applied:0,latitude:29.86615,longitude:-97.925294},{facility_name:"KING COUNTY BRIGHTWATER WWTP",city:"Seattle",state:"Wash.",amount_of_biosolids_generated:2913,amount_of_biosolids_managed_land_applied:2913,latitude:47.789647,longitude:-122.141082},{facility_name:"TEN MILE CREEK PLANT",city:"Arlington",state:"Texas",amount_of_biosolids_generated:2894,amount_of_biosolids_managed_land_applied:0,latitude:32.563831,longitude:-96.633251},{facility_name:"WESTERN WAKE REGIONAL WRF",city:"New Hill",state:"Mont.",amount_of_biosolids_generated:2889,amount_of_biosolids_managed_land_applied:2827.2,latitude:35.671033,longitude:-78.939968},{facility_name:"PRASA BAYAMON",city:"Catano",state:"Pa.",amount_of_biosolids_generated:2865,amount_of_biosolids_managed_land_applied:0,latitude:18.486944,longitude:-66.139167},{facility_name:"EMWD - TEMECULA VALLEY RWRF",city:"Perris",state:"Calif.",amount_of_biosolids_generated:2864,amount_of_biosolids_managed_land_applied:2864.38,latitude:33.98325227,longitude:-117.0081718},{facility_name:"IRVINE RANCH WATER DISTRICT",city:"Irvine",state:"Calif.",amount_of_biosolids_generated:2855,amount_of_biosolids_managed_land_applied:2854.71,latitude:33.66166483,longitude:-117.8297478},{facility_name:"SONOMA VALLEY WWTP",city:"Santa Rosa",state:"Calif.",amount_of_biosolids_generated:2854,amount_of_biosolids_managed_land_applied:0,latitude:38.48271717,longitude:-122.7536447},{facility_name:"SCRANTON CITY SEW AUTH",city:"Scranton",state:"Pa.",amount_of_biosolids_generated:2824,amount_of_biosolids_managed_land_applied:0,latitude:41.409223,longitude:-75.662269},{facility_name:"TACOMA CENTRAL NO 1",city:"Tacoma",state:"Wash.",amount_of_biosolids_generated:2817,amount_of_biosolids_managed_land_applied:2816.9,latitude:47.24621,longitude:-122.411674},{facility_name:"BAYSHORE REGIONAL SEW AUTH",city:"Union Beach",state:"Neb.",amount_of_biosolids_generated:2806,amount_of_biosolids_managed_land_applied:0,latitude:40.4403,longitude:-74.191057},{facility_name:"BENTLY RANCH COMPOST",city:"Minden",state:"N.D.",amount_of_biosolids_generated:2803,amount_of_biosolids_managed_land_applied:2803,latitude:38.95706757,longitude:-119.7712328},{facility_name:"NORTH DAVIS SEWER DISTRICT",city:"Syracuse",state:"Utah",amount_of_biosolids_generated:2801,amount_of_biosolids_managed_land_applied:2801,latitude:41.084387,longitude:-112.109111},{facility_name:"FISHERS CHEENEY CREEK WWTP",city:"Fishers",state:"Iowa",amount_of_biosolids_generated:2799,amount_of_biosolids_managed_land_applied:0,latitude:39.934278,longitude:-86.065111},{facility_name:"HRSD - BOAT HARBOR STP",city:"Newport News",state:"Utah",amount_of_biosolids_generated:2789,amount_of_biosolids_managed_land_applied:0,latitude:36.96569,longitude:-76.41479},{facility_name:"THOMAS P. SMITH WWTP",city:"Tallahassee",state:"Fla.",amount_of_biosolids_generated:2789,amount_of_biosolids_managed_land_applied:2788.68,latitude:30.392575,longitude:-84.322783},{facility_name:"HONOLULU SAND ISLAND WWTP",city:"Kapolei",state:"Hawaii",amount_of_biosolids_generated:2781,amount_of_biosolids_managed_land_applied:0,latitude:21.33003,longitude:-158.08158},{facility_name:"HATFIELD TWP. MUN. AUTH.",city:"Colmar",state:"Pa.",amount_of_biosolids_generated:2778,amount_of_biosolids_managed_land_applied:0,latitude:40.278507,longitude:-75.255135},{facility_name:"POTTSTOWN BORO",city:"Pottstown",state:"Pa.",amount_of_biosolids_generated:2776,amount_of_biosolids_managed_land_applied:1350.88,latitude:40.23593,longitude:-75.62463},{facility_name:"NORFOLK WWTF",city:"Norfolk",state:"Neb.",amount_of_biosolids_generated:2767,amount_of_biosolids_managed_land_applied:2766.726,latitude:42.008306,longitude:-97.400556},{facility_name:"COBB CO (NOONDAY CRK. WPCP)",city:"Marietta",state:"Ga.",amount_of_biosolids_generated:2759,amount_of_biosolids_managed_land_applied:1767.81,latitude:34.073472,longitude:-84.537944},{facility_name:"LOS ANGELES TERMINAL ISLAND WRP",city:"San Pedro",state:"Calif.",amount_of_biosolids_generated:2755,amount_of_biosolids_managed_land_applied:0,latitude:33.747788,longitude:-118.26247},{facility_name:"RAHWAY VALLEY SEWERAGE AUTH",city:"Rahway",state:"Neb.",amount_of_biosolids_generated:2727,amount_of_biosolids_managed_land_applied:0,latitude:40.600268,longitude:-74.259033},{facility_name:"TURLOCK WQCF",city:"Turlock",state:"Calif.",amount_of_biosolids_generated:2708,amount_of_biosolids_managed_land_applied:2708,latitude:37.492505,longitude:-120.846925},{facility_name:"SIOUX FALLS, CITY OF (BIOSOLIDS)",city:"Sioux Falls",state:"S.D.",amount_of_biosolids_generated:2705,amount_of_biosolids_managed_land_applied:2308.49,latitude:43.595767,longitude:-96.664134},{facility_name:"PRAIRIE CREEK WWTP",city:"Lewisville",state:"Texas",amount_of_biosolids_generated:2692,amount_of_biosolids_managed_land_applied:0,latitude:33.05667,longitude:-96.97843},{facility_name:"OPEQUON STP",city:"Winchester",state:"Utah",amount_of_biosolids_generated:2684,amount_of_biosolids_managed_land_applied:2617.88,latitude:39.17912,longitude:-78.07576},{facility_name:"JEFFERSON COUNTY COMMISSION ENVIRONMENTAL SERVICES DEPARTMENT",city:"Birmingham",state:"Alaska",amount_of_biosolids_generated:2657,amount_of_biosolids_managed_land_applied:2657,latitude:33.526315,longitude:-86.894838},{facility_name:"METROPOLITAN ST. LOUIS SEWER DISTRICT MI",city:"St. Louis",state:"Mo.",amount_of_biosolids_generated:2643,amount_of_biosolids_managed_land_applied:0,latitude:38.745778,longitude:-90.495194},{facility_name:"SPRINGFIELD SD- SPRING CREEK",city:"Springfield",state:"Iowa",amount_of_biosolids_generated:2633,amount_of_biosolids_managed_land_applied:0,latitude:39.843797,longitude:-89.644817},{facility_name:"CHARLOTTE WATER",city:"Charlotte",state:"Mont.",amount_of_biosolids_generated:2629,amount_of_biosolids_managed_land_applied:1211,latitude:35.195744,longitude:-80.905047},{facility_name:"FAYETTEVILLE/WEST SIDE WWTP",city:"Fayetteville",state:"Alaska",amount_of_biosolids_generated:2619,amount_of_biosolids_managed_land_applied:0,latitude:36.063362,longitude:-94.232835},{facility_name:"JOCO TOMAHAWK CREEK WWTP",city:"Olathe",state:"Kan.",amount_of_biosolids_generated:2613,amount_of_biosolids_managed_land_applied:2613.07,latitude:38.91572,longitude:-94.79924},{facility_name:"ELLETTSVILLE MUNICIPAL WWTP",city:"Ellettsville",state:"Iowa",amount_of_biosolids_generated:2607,amount_of_biosolids_managed_land_applied:0,latitude:39.265972,longitude:-86.628222},{facility_name:"CITY OF KEOKUK",city:"Keokuk",state:"Hawaii",amount_of_biosolids_generated:2603,amount_of_biosolids_managed_land_applied:2603.2,latitude:40.40712845,longitude:-91.41166242},{facility_name:"CHISHOLM CK UTILITY AUTHORITY",city:"Park City",state:"Kan.",amount_of_biosolids_generated:2603,amount_of_biosolids_managed_land_applied:2602.8,latitude:37.78393,longitude:-97.33587},{facility_name:"METROPOLITAN COUNCIL-EMPIRE",city:"Farmington",state:"Minn.",amount_of_biosolids_generated:2591,amount_of_biosolids_managed_land_applied:1244.4,latitude:44.664278,longitude:-93.104361},{facility_name:"NSSD-WAUKEGAN STP",city:"Waukegan",state:"Iowa",amount_of_biosolids_generated:2587,amount_of_biosolids_managed_land_applied:2579,latitude:42.373938,longitude:-87.817736},{facility_name:"ELSINORE VALLEY REGIONAL FACILITY",city:"Lake Elsinore",state:"Calif.",amount_of_biosolids_generated:2583,amount_of_biosolids_managed_land_applied:0,latitude:33.629311,longitude:-117.3562059},{facility_name:"METROPOLITAN COUNCIL-EAGLE PT",city:"Cottage Grove",state:"Minn.",amount_of_biosolids_generated:2579,amount_of_biosolids_managed_land_applied:0,latitude:44.78634,longitude:-92.91902},{facility_name:"REWA/MAULDIN RD WWTP",city:"Greenville",state:"S.C.",amount_of_biosolids_generated:2576,amount_of_biosolids_managed_land_applied:1733.85,latitude:34.796389,longitude:-82.365278},{facility_name:"SYNAGRO TECHNOLOGIES - BACK RIVER PELLETIZER FACILITY",city:"Baltimore",state:"Mass.",amount_of_biosolids_generated:2559,amount_of_biosolids_managed_land_applied:2463,latitude:39.29973,longitude:-76.494201},{facility_name:"CENTRAL WEBER SEWER IMP",city:"Ogden",state:"Utah",amount_of_biosolids_generated:2556,amount_of_biosolids_managed_land_applied:1754,latitude:41.27143,longitude:-112.04325},{facility_name:"CITY OF WILSON",city:"Wilson",state:"Mont.",amount_of_biosolids_generated:2542,amount_of_biosolids_managed_land_applied:1846.68,latitude:35.68733,longitude:-77.894267},{facility_name:"READING CITY - FRITZ ISLAND WW",city:"Berks County",state:"Pa.",amount_of_biosolids_generated:2536,amount_of_biosolids_managed_land_applied:0,latitude:40.29882,longitude:-75.9408},{facility_name:"SALEM, CITY OF",city:"Keizer",state:"Ore.",amount_of_biosolids_generated:2532,amount_of_biosolids_managed_land_applied:2319.46,latitude:45.008574,longitude:-123.05457},{facility_name:"GLOUCESTER CNTY UTIL AUTH",city:"West Deptford Twp",state:"Neb.",amount_of_biosolids_generated:2529,amount_of_biosolids_managed_land_applied:0,latitude:39.852891,longitude:-75.22521},{facility_name:"TEMPLE BELTON WWTP",city:"Temple 76501",state:"Texas",amount_of_biosolids_generated:2524,amount_of_biosolids_managed_land_applied:0,latitude:31.045891,longitude:-97.438742},{facility_name:"WICHITA FALLS RESOURCES RECOVERY FACILITY",city:"Wichita Falls",state:"Texas",amount_of_biosolids_generated:2524,amount_of_biosolids_managed_land_applied:0,latitude:33.922259,longitude:-98.475954},{facility_name:"HILLSBOROUGH COUNTY PUBLIC UTILITIES DEPARTMENT",city:"Tampa",state:"Fla.",amount_of_biosolids_generated:2522,amount_of_biosolids_managed_land_applied:0,latitude:27.954893,longitude:-82.2196},{facility_name:"FOX RIVER WRD - ALBIN D. PAGORSKI WRF",city:"Elgin",state:"Iowa",amount_of_biosolids_generated:2497,amount_of_biosolids_managed_land_applied:2752.06,latitude:42.01511,longitude:-88.27357},{facility_name:"WILLOWOOD WWTP",city:"Bellaire",state:"Texas",amount_of_biosolids_generated:2485,amount_of_biosolids_managed_land_applied:2484.87,latitude:29.915444,longitude:-95.5015},{facility_name:"HENDERSON STP",city:"Henderson",state:"Ky.",amount_of_biosolids_generated:2453,amount_of_biosolids_managed_land_applied:0,latitude:37.81666,longitude:-87.620401},{facility_name:"SAN FRANCISCO OCEANSIDE WWTP",city:"San Francisco",state:"Calif.",amount_of_biosolids_generated:2451,amount_of_biosolids_managed_land_applied:399,latitude:37.7286,longitude:-122.50485},{facility_name:"CITY OF WATERLOO",city:"Waterloo",state:"Hawaii",amount_of_biosolids_generated:2442,amount_of_biosolids_managed_land_applied:2441.59,latitude:42.49875,longitude:-92.3325},{facility_name:"SOUTH LAREDO WWTP",city:"Laredo",state:"Texas",amount_of_biosolids_generated:2440,amount_of_biosolids_managed_land_applied:0,latitude:27.449744,longitude:-99.487624},{facility_name:"SOUTH COUNTY REGIONAL WWTP",city:"Gilroy",state:"Calif.",amount_of_biosolids_generated:2432,amount_of_biosolids_managed_land_applied:0,latitude:36.986847,longitude:-121.538825},{facility_name:"SOUTH BEND MUNICIPAL WWTP",city:"South Bend",state:"Iowa",amount_of_biosolids_generated:2417,amount_of_biosolids_managed_land_applied:611.7,latitude:41.718163,longitude:-86.269828},{facility_name:"LEBANON W W T F",city:"West Lebanon",state:"Neb.",amount_of_biosolids_generated:2416,amount_of_biosolids_managed_land_applied:0,latitude:43.636805,longitude:-72.320541},{facility_name:"CHAMBERS CREEK STP",city:"University Place",state:"Wash.",amount_of_biosolids_generated:2410,amount_of_biosolids_managed_land_applied:2410,latitude:47.194131,longitude:-122.574999},{facility_name:"SOUTHSIDE WWTF",city:"Tyler",state:"Texas",amount_of_biosolids_generated:2388,amount_of_biosolids_managed_land_applied:0,latitude:32.254763,longitude:-95.322647},{facility_name:"DRWPCC",city:"Downingtown",state:"Pa.",amount_of_biosolids_generated:2382,amount_of_biosolids_managed_land_applied:2382,latitude:39.99715,longitude:-75.7016},{facility_name:"ALLENTOWN CITY AUTHORITY-WASTE",city:"Allentown",state:"Pa.",amount_of_biosolids_generated:2376,amount_of_biosolids_managed_land_applied:2375.8,latitude:40.603625,longitude:-75.466694},{facility_name:"ST. LOUIS METROPOLITAN SEWER DISTRICT",city:"Valley Park",state:"Mo.",amount_of_biosolids_generated:2369,amount_of_biosolids_managed_land_applied:0,latitude:38.559472,longitude:-90.474556},{facility_name:"LACSD - LANCASTER WRP",city:"Whittier",state:"Calif.",amount_of_biosolids_generated:2361,amount_of_biosolids_managed_land_applied:0,latitude:33.96071322,longitude:-118.0256606},{facility_name:"BLUEFIELD STP",city:"Bluefield",state:"Utah",amount_of_biosolids_generated:2353,amount_of_biosolids_managed_land_applied:0,latitude:37.261,longitude:-81.2818},{facility_name:"NYCDEP - RED HOOK WRRF",city:"Brooklyn",state:"N.D.",amount_of_biosolids_generated:2342,amount_of_biosolids_managed_land_applied:1508,latitude:40.69355929,longitude:-73.96536912},{facility_name:"ZIONSVILLE WWTP",city:"Zionsville",state:"Iowa",amount_of_biosolids_generated:2338,amount_of_biosolids_managed_land_applied:0,latitude:39.95019,longitude:-86.2749},{facility_name:"NASHVILLE-DRY CREEK STP",city:"Madison",state:"Tenn.",amount_of_biosolids_generated:2330,amount_of_biosolids_managed_land_applied:0,latitude:36.28951,longitude:-86.69068},{facility_name:"ROCKAWAY VALLEY REGIONAL SA",city:"Parsippany",state:"Neb.",amount_of_biosolids_generated:2325,amount_of_biosolids_managed_land_applied:0,latitude:40.88801,longitude:-74.39252},{facility_name:"PARKWAY WWTP",city:"Laurel",state:"Mass.",amount_of_biosolids_generated:2314,amount_of_biosolids_managed_land_applied:2313.88,latitude:39.06167,longitude:-76.832633},{facility_name:"SPRINGETTSBURY TOWNSHIP_WWTF",city:"York",state:"Pa.",amount_of_biosolids_generated:2310,amount_of_biosolids_managed_land_applied:2706.09,latitude:40.017028,longitude:-76.691333},{facility_name:"CVWD WRP 10 PALM DESERT",city:"Coachella",state:"Calif.",amount_of_biosolids_generated:2300,amount_of_biosolids_managed_land_applied:0,latitude:33.685745,longitude:-116.1675911},{facility_name:"MUDDY CREEK WWTP - MSD",city:"Cincinnati",state:"Ohio",amount_of_biosolids_generated:2300,amount_of_biosolids_managed_land_applied:0,latitude:39.10749,longitude:-84.54556},{facility_name:"CITY OF ST. JOSEPH",city:"St. Joseph",state:"Mo.",amount_of_biosolids_generated:2288,amount_of_biosolids_managed_land_applied:424.79,latitude:39.76869,longitude:-94.84733},{facility_name:"HILLSBOROUGH COUNTY PUBLIC UTILITIES DEPT.",city:"Tampa",state:"Fla.",amount_of_biosolids_generated:2280,amount_of_biosolids_managed_land_applied:0,latitude:27.720426,longitude:-82.383963},{facility_name:"CITY OF ROME",city:"Rome",state:"Ga.",amount_of_biosolids_generated:2280,amount_of_biosolids_managed_land_applied:1735,latitude:34.229323,longitude:-85.194485},{facility_name:"SYNGARO SAND ISLAND HEAT DRYER",city:"Honolulu",state:"Hawaii",amount_of_biosolids_generated:2276,amount_of_biosolids_managed_land_applied:1585,latitude:21.304152,longitude:-157.871871},{facility_name:"BROAD RUN WATER RECLAMATION",city:"Ashburn",state:"Utah",amount_of_biosolids_generated:2268,amount_of_biosolids_managed_land_applied:2268,latitude:39.03503,longitude:-77.44757},{facility_name:"HONOLULU HONOULIULI WWTP",city:"Kapolei",state:"Hawaii",amount_of_biosolids_generated:2263,amount_of_biosolids_managed_land_applied:0,latitude:21.33003,longitude:-158.08158},{facility_name:"VALLEY FORGE SEWER AUTHORITY",city:"Phoenixville",state:"Pa.",amount_of_biosolids_generated:2262,amount_of_biosolids_managed_land_applied:1717.07,latitude:40.11526,longitude:-75.47193},{facility_name:"LAS VEGAS ST WWTF",city:"Colorado Springs",state:"Colo.",amount_of_biosolids_generated:2254,amount_of_biosolids_managed_land_applied:0,latitude:38.815753,longitude:-104.811087},{facility_name:"GRESHAM, CITY OF",city:"Portland",state:"Ore.",amount_of_biosolids_generated:2252,amount_of_biosolids_managed_land_applied:1598,latitude:45.546612,longitude:-122.459182},{facility_name:"PRASA - CAGUAS RWWTP",city:"Caguas",state:"Pa.",amount_of_biosolids_generated:2249,amount_of_biosolids_managed_land_applied:0,latitude:18.2615,longitude:-66.027167},{facility_name:"CAPE FEAR PUBLIC UTILITY AUTHORITY",city:"Wilmington",state:"Mont.",amount_of_biosolids_generated:2249,amount_of_biosolids_managed_land_applied:0,latitude:34.264722,longitude:-77.921111},{facility_name:"NYCDEP - OAKWOOD BEACH WPCP",city:"Staten Island, Borough Of",state:"N.D.",amount_of_biosolids_generated:2231,amount_of_biosolids_managed_land_applied:1059,latitude:40.734015,longitude:-73.86348},{facility_name:"SILOAM SPRINGS, CITY OF",city:"Siloam Springs",state:"Alaska",amount_of_biosolids_generated:2223,amount_of_biosolids_managed_land_applied:0,latitude:36.194167,longitude:-94.564722},{facility_name:"DALLAS COUNTY PARK CITIES MUD WWTP",city:"Dallas",state:"Texas",amount_of_biosolids_generated:2219,amount_of_biosolids_managed_land_applied:0,latitude:32.838611,longitude:-96.870556},{facility_name:"MCMINNVILLE STP",city:"Mcminnville",state:"Tenn.",amount_of_biosolids_generated:2209,amount_of_biosolids_managed_land_applied:2208.9,latitude:35.675349,longitude:-85.75887},{facility_name:"BOONVILLE MUNICIPAL WWTP",city:"Boonville",state:"Iowa",amount_of_biosolids_generated:2206,amount_of_biosolids_managed_land_applied:0,latitude:38.03985924,longitude:-87.22932338},{facility_name:"OAKS WASTEWATER TREATMENT PLANT",city:"Oaks",state:"Pa.",amount_of_biosolids_generated:2202,amount_of_biosolids_managed_land_applied:2202.23,latitude:40.118235,longitude:-75.345129},{facility_name:"HARRISBURG AUTHORITY, THE",city:"Harrisburg",state:"Pa.",amount_of_biosolids_generated:2201,amount_of_biosolids_managed_land_applied:2194.3,latitude:40.239078,longitude:-76.856111},{facility_name:"CITY OF GASTONIA",city:"Gastonia",state:"Mont.",amount_of_biosolids_generated:2199,amount_of_biosolids_managed_land_applied:2199.4,latitude:35.306944,longitude:-81.134444},{facility_name:"WEST RANKIN UTILITY AUTHORITY WWTF",city:"Richland",state:"Mo.",amount_of_biosolids_generated:2198,amount_of_biosolids_managed_land_applied:2198.3,latitude:32.245278,longitude:-90.200278},{facility_name:"FARGO CITY OF",city:"Fargo",state:"Mont.",amount_of_biosolids_generated:2193,amount_of_biosolids_managed_land_applied:0,latitude:46.95591,longitude:-96.803606},{facility_name:"OAK GROVE WWTF",city:"Ennis",state:"Texas",amount_of_biosolids_generated:2193,amount_of_biosolids_managed_land_applied:0,latitude:32.3045,longitude:-96.61566},{facility_name:"CITY OF MISSOULA",city:"Missoula",state:"Mont.",amount_of_biosolids_generated:2168,amount_of_biosolids_managed_land_applied:2168,latitude:46.87425,longitude:-113.99454},{facility_name:"CITY OF CARTERSVILLE",city:"Cartersville",state:"Ga.",amount_of_biosolids_generated:2164,amount_of_biosolids_managed_land_applied:1624.77,latitude:34.143153,longitude:-84.830773},{facility_name:"CITY OF BURLINGTON",city:"Burlington",state:"Mont.",amount_of_biosolids_generated:2156,amount_of_biosolids_managed_land_applied:0,latitude:36.019884,longitude:-79.373458},{facility_name:"SCHENECTADY (C)",city:"Schenectady",state:"N.D.",amount_of_biosolids_generated:2152,amount_of_biosolids_managed_land_applied:0,latitude:42.81416,longitude:-73.93989},{facility_name:"ST CHARLES PAR COUNCIL-DEST",city:"Destrehan",state:"La.",amount_of_biosolids_generated:2148,amount_of_biosolids_managed_land_applied:0,latitude:29.943696,longitude:-90.347893},{facility_name:"EMWD - MORENO VALLEY RWRF",city:"Perris",state:"Calif.",amount_of_biosolids_generated:2148,amount_of_biosolids_managed_land_applied:2147.67,latitude:33.98325227,longitude:-117.0081718},{facility_name:"WESTSIDE WWTF",city:"Tyler",state:"Texas",amount_of_biosolids_generated:2144,amount_of_biosolids_managed_land_applied:0,latitude:32.3969,longitude:-95.4114},{facility_name:"KISHWAUKEE WATER RECLAMATION DISTRICT",city:"Dekalb",state:"Iowa",amount_of_biosolids_generated:2131,amount_of_biosolids_managed_land_applied:2131.216,latitude:41.94445,longitude:-88.74211},{facility_name:"QUINCY STP, CITY OF",city:"Quincy",state:"Iowa",amount_of_biosolids_generated:2125,amount_of_biosolids_managed_land_applied:2105,latitude:39.9026,longitude:-91.426498},{facility_name:"CITY OF DURHAM",city:"Durham",state:"Mont.",amount_of_biosolids_generated:2122,amount_of_biosolids_managed_land_applied:2122,latitude:35.904318,longitude:-78.976588},{facility_name:"ASH CREEK WWTP",city:"Azle",state:"Texas",amount_of_biosolids_generated:2119,amount_of_biosolids_managed_land_applied:0,latitude:32.888187,longitude:-97.531729},{facility_name:"ST. LOUIS METROPOLITAN SEWER DISTRICT",city:"Valley Park",state:"Mo.",amount_of_biosolids_generated:2118,amount_of_biosolids_managed_land_applied:0,latitude:38.559472,longitude:-90.474556},{facility_name:"CORONA WWTP 1",city:"Corona",state:"Calif.",amount_of_biosolids_generated:2105,amount_of_biosolids_managed_land_applied:0,latitude:33.889466,longitude:-117.607528},{facility_name:"UPPER GWYNEDD-TOWAMENCIN MUN A",city:"Lansdale",state:"Pa.",amount_of_biosolids_generated:2093,amount_of_biosolids_managed_land_applied:2092.7,latitude:40.229444,longitude:-75.351667},{facility_name:"LAFAYETTE WWTP",city:"Lafayette",state:"Iowa",amount_of_biosolids_generated:2088,amount_of_biosolids_managed_land_applied:2887.42,latitude:40.402624,longitude:-86.907696},{facility_name:"WESTERN RIVERSIDE COUNTY REGIONAL WWTP",city:"Corona",state:"Calif.",amount_of_biosolids_generated:2086,amount_of_biosolids_managed_land_applied:0,latitude:33.931802,longitude:-117.604631},{facility_name:"AUBURN (C)",city:"Auburn",state:"N.D.",amount_of_biosolids_generated:2084,amount_of_biosolids_managed_land_applied:0,latitude:42.93015,longitude:-76.566},{facility_name:"NASHUA CITY OF",city:"Nashua",state:"Neb.",amount_of_biosolids_generated:2076,amount_of_biosolids_managed_land_applied:2076,latitude:42.74827,longitude:-71.4473},{facility_name:"CITY OF BILLINGS",city:"Billings",state:"Mont.",amount_of_biosolids_generated:2074,amount_of_biosolids_managed_land_applied:0,latitude:45.75533,longitude:-108.535473},{facility_name:"FLORENCE/MAIN PLANT",city:"Florence",state:"S.C.",amount_of_biosolids_generated:2071,amount_of_biosolids_managed_land_applied:391.65,latitude:34.136389,longitude:-79.551389},{facility_name:"CITY OF GARLAND ROWLETT CREEK WWTF",city:"Garland",state:"Texas",amount_of_biosolids_generated:2069,amount_of_biosolids_managed_land_applied:0,latitude:32.90029,longitude:-96.60039},{facility_name:"SUNNYVALE WPCP",city:"Sunnyvale",state:"Calif.",amount_of_biosolids_generated:2069,amount_of_biosolids_managed_land_applied:2069,latitude:37.41170793,longitude:-122.0175076},{facility_name:"STEWART CREEK WEST WWTP",city:"Wylie",state:"Texas",amount_of_biosolids_generated:2063,amount_of_biosolids_managed_land_applied:0,latitude:33.1172,longitude:-96.86067},{facility_name:"NORTH HUDSON-ADAMS STREET FACILITY - HOBOKEN STP-TRI CITY",city:"Hoboken",state:"Neb.",amount_of_biosolids_generated:2053,amount_of_biosolids_managed_land_applied:0,latitude:40.756984,longitude:-74.032199},{facility_name:"OCEANSIDE SAN LUIS REY WWTP",city:"Oceanside",state:"Calif.",amount_of_biosolids_generated:2052,amount_of_biosolids_managed_land_applied:1587,latitude:33.19383319,longitude:-117.3558029},{facility_name:"KEEGANS BAYOU WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:2049,amount_of_biosolids_managed_land_applied:0,latitude:29.67085,longitude:-95.54144},{facility_name:"BETHLEHEM AUTHORITY-WASTEWATER",city:"Bethlehm",state:"Pa.",amount_of_biosolids_generated:2049,amount_of_biosolids_managed_land_applied:2048.69,latitude:40.613667,longitude:-75.334934},{facility_name:"CENTENNIAL WATER AND SAN DIST",city:"Highlands Ranch",state:"Colo.",amount_of_biosolids_generated:2025,amount_of_biosolids_managed_land_applied:39.33,latitude:39.55887,longitude:-104.98919},{facility_name:"ERIE COUNTY",city:"Buffalo",state:"N.D.",amount_of_biosolids_generated:2019,amount_of_biosolids_managed_land_applied:0,latitude:42.88376,longitude:-78.87736},{facility_name:"SANTA FE, CITY OF (AIRPORT RD",city:"Santa Fe",state:"N.D.",amount_of_biosolids_generated:2011,amount_of_biosolids_managed_land_applied:2011,latitude:35.68994,longitude:-105.938},{facility_name:"GREENFIELD WWTP",city:"Greenfield",state:"Iowa",amount_of_biosolids_generated:2e3,amount_of_biosolids_managed_land_applied:2600,latitude:39.77725,longitude:-85.762972},{facility_name:"FORT COLLINS CITY OF",city:"Fort Collins",state:"Colo.",amount_of_biosolids_generated:1993,amount_of_biosolids_managed_land_applied:1993.25,latitude:40.553889,longitude:-105.020556},{facility_name:"ROGERS, CITY OF",city:"Rogers",state:"Alaska",amount_of_biosolids_generated:1985,amount_of_biosolids_managed_land_applied:1985.24,latitude:36.301944,longitude:-94.216111},{facility_name:"HRSD-ARMY BASE",city:"Norfolk",state:"Utah",amount_of_biosolids_generated:1981,amount_of_biosolids_managed_land_applied:0,latitude:36.92224,longitude:-76.32237},{facility_name:"MONTVILLE WPCA",city:"Uncasville",state:"Conn.",amount_of_biosolids_generated:1976,amount_of_biosolids_managed_land_applied:0,latitude:41.0990754,longitude:-73.42135482},{facility_name:"MASSAPONAX REGIONAL STP",city:"Fredericksburg",state:"Utah",amount_of_biosolids_generated:1975,amount_of_biosolids_managed_land_applied:1975.06,latitude:38.24944,longitude:-77.42358},{facility_name:"ROCHESTER",city:"Rochester",state:"Minn.",amount_of_biosolids_generated:1975,amount_of_biosolids_managed_land_applied:1974.5,latitude:44.06165,longitude:-92.46627},{facility_name:"S DAVIS CO SEWER-NORTH",city:"West Bountiful",state:"Utah",amount_of_biosolids_generated:1962,amount_of_biosolids_managed_land_applied:1878,latitude:40.902946,longitude:-111.931877},{facility_name:"LAS VIRGENES TAPIA WRF/COMPOST",city:"Calabasas",state:"Calif.",amount_of_biosolids_generated:1961,amount_of_biosolids_managed_land_applied:1961,latitude:34.13644,longitude:-118.70223},{facility_name:"SANTA CRUZ WWTF",city:"Santa Cruz",state:"Calif.",amount_of_biosolids_generated:1960,amount_of_biosolids_managed_land_applied:1960,latitude:36.963246,longitude:-122.034009},{facility_name:"CITY OF O'FALLON",city:"O'Fallon",state:"Mo.",amount_of_biosolids_generated:1958,amount_of_biosolids_managed_land_applied:0,latitude:38.805368,longitude:-90.675982},{facility_name:"PANTHER CREEK WWTP",city:"Wylie",state:"Texas",amount_of_biosolids_generated:1956,amount_of_biosolids_managed_land_applied:0,latitude:32.983,longitude:-96.516},{facility_name:"DANBURY WPCF",city:"Danbury",state:"Conn.",amount_of_biosolids_generated:1955,amount_of_biosolids_managed_land_applied:0,latitude:41.40426,longitude:-73.422888},{facility_name:"SOCWA J. B. LATHAM TP",city:"Dana Point",state:"Calif.",amount_of_biosolids_generated:1951,amount_of_biosolids_managed_land_applied:0,latitude:33.466574,longitude:-117.685766},{facility_name:"JOLIET EASTSIDE STP, CITY OF",city:"Joliet",state:"Iowa",amount_of_biosolids_generated:1943,amount_of_biosolids_managed_land_applied:1943,latitude:41.50594,longitude:-88.09061},{facility_name:"CITY OF BOCA RATON",city:"Boca Raton",state:"Fla.",amount_of_biosolids_generated:1938,amount_of_biosolids_managed_land_applied:0,latitude:26.367208,longitude:-80.109733},{facility_name:"LOGAN CITY CORPORATION",city:"Logan",state:"Utah",amount_of_biosolids_generated:1935,amount_of_biosolids_managed_land_applied:1368,latitude:41.75787,longitude:-111.84902},{facility_name:"EASTERN REGIONAL STP",city:"Fort Wright",state:"Ky.",amount_of_biosolids_generated:1932,amount_of_biosolids_managed_land_applied:0,latitude:38.94797,longitude:-84.37049},{facility_name:"INDEPENDENCE,ROCK CR WWTF",city:"Independence",state:"Mo.",amount_of_biosolids_generated:1930,amount_of_biosolids_managed_land_applied:588.15,latitude:39.116833,longitude:-94.462861},{facility_name:"HOLYOKE W P C F",city:"Holyoke",state:"Mass.",amount_of_biosolids_generated:1921,amount_of_biosolids_managed_land_applied:0,latitude:42.191041,longitude:-72.612574},{facility_name:"ODO J. RIEDEL REGIONAL WWTP",city:"Schertz",state:"Texas",amount_of_biosolids_generated:1912,amount_of_biosolids_managed_land_applied:750.97,latitude:29.550169,longitude:-98.246881},{facility_name:"LANCASTER AREA SEWER AUTHORITY",city:"Lancaster County",state:"Pa.",amount_of_biosolids_generated:1904,amount_of_biosolids_managed_land_applied:1904.3,latitude:39.9845,longitude:-76.45862},{facility_name:"VENTURA WRF",city:"Ventura",state:"Calif.",amount_of_biosolids_generated:1889,amount_of_biosolids_managed_land_applied:1889,latitude:34.279597,longitude:-119.2904863},{facility_name:"ROSEVILLE PLEASANT GROVE WWTP",city:"Roseville",state:"Calif.",amount_of_biosolids_generated:1885,amount_of_biosolids_managed_land_applied:912.21,latitude:38.76830703,longitude:-121.3540591},{facility_name:"SPRINGVILLE, CITY OF",city:"Springville",state:"Utah",amount_of_biosolids_generated:1884,amount_of_biosolids_managed_land_applied:2335.3,latitude:40.24307,longitude:-111.66745},{facility_name:"TWO BRIDGES WW TREATMENT PLANT",city:"Lincoln Park",state:"Neb.",amount_of_biosolids_generated:1884,amount_of_biosolids_managed_land_applied:0,latitude:40.9038,longitude:-74.274},{facility_name:"MUNICIPAL UTILITIES BOARD OF ALBERTVILLE",city:"Albertville",state:"Alaska",amount_of_biosolids_generated:1870,amount_of_biosolids_managed_land_applied:1837.88,latitude:34.272222,longitude:-86.190556},{facility_name:"TRI-CITY SERVICE DISTRICT",city:"Oregon City",state:"Ore.",amount_of_biosolids_generated:1865,amount_of_biosolids_managed_land_applied:1427,latitude:45.375317,longitude:-122.59025},{facility_name:"MUDDY CREEK REGIONAL WWTP",city:"Wylie",state:"Texas",amount_of_biosolids_generated:1863,amount_of_biosolids_managed_land_applied:0,latitude:32.971944,longitude:-96.547222},{facility_name:"BINGHAMTON-JOHNSON (C) JNT SB",city:"Vestal",state:"N.D.",amount_of_biosolids_generated:1861,amount_of_biosolids_managed_land_applied:0,latitude:42.096207,longitude:-75.962666},{facility_name:"FRANKFORT WWTP, CITY OF",city:"Frankfort",state:"Iowa",amount_of_biosolids_generated:1855,amount_of_biosolids_managed_land_applied:1855,latitude:40.28067,longitude:-86.50978},{facility_name:"WESTBOROUGH W W T P",city:"Westborough",state:"Mass.",amount_of_biosolids_generated:1851,amount_of_biosolids_managed_land_applied:0,latitude:42.28019,longitude:-71.63248},{facility_name:"MANTECA WQCF",city:"Manteca",state:"Calif.",amount_of_biosolids_generated:1847,amount_of_biosolids_managed_land_applied:0,latitude:37.799173,longitude:-121.231075},{facility_name:"NAPERVILLE-SPRINGBROOK WRC",city:"Naperville",state:"Iowa",amount_of_biosolids_generated:1846,amount_of_biosolids_managed_land_applied:2199.1,latitude:41.70105,longitude:-88.16671},{facility_name:"NARRAGANSETT BAY COMMISSION",city:"Providence",state:"R.I.",amount_of_biosolids_generated:1839,amount_of_biosolids_managed_land_applied:0,latitude:41.79228,longitude:-71.39029},{facility_name:"REWA/PELHAM WWTP",city:"Greer",state:"S.C.",amount_of_biosolids_generated:1837,amount_of_biosolids_managed_land_applied:1347.23,latitude:34.858333,longitude:-82.23},{facility_name:"STRATFORD WPCF (TOWN HALL)",city:"Stratford",state:"Conn.",amount_of_biosolids_generated:1836,amount_of_biosolids_managed_land_applied:0,latitude:41.19701,longitude:-73.13192},{facility_name:"ONE STOP LANDSCAPE SUPPLY COMPOSTING",city:"Redlands",state:"Calif.",amount_of_biosolids_generated:1831,amount_of_biosolids_managed_land_applied:1831,latitude:34.018445,longitude:-117.188975},{facility_name:"LAS CRUCES, CITY OF",city:"Las Cruces",state:"N.D.",amount_of_biosolids_generated:1829,amount_of_biosolids_managed_land_applied:724,latitude:32.30255,longitude:-106.81319},{facility_name:"TACOMA NORTH NO 3",city:"Tacoma",state:"Wash.",amount_of_biosolids_generated:1829,amount_of_biosolids_managed_land_applied:0,latitude:47.285685,longitude:-122.489297},{facility_name:"HOLLY HILL, CITY OF",city:"Holly Hill",state:"Fla.",amount_of_biosolids_generated:1828,amount_of_biosolids_managed_land_applied:1827.86,latitude:29.24371,longitude:-81.0468},{facility_name:"CATOMA CREEK WWTP",city:"Montgomery",state:"Alaska",amount_of_biosolids_generated:1824,amount_of_biosolids_managed_land_applied:1824,latitude:32.362222,longitude:-86.443611},{facility_name:"WALLACE R. KNOX WWTP",city:"Texas City",state:"Texas",amount_of_biosolids_generated:1819,amount_of_biosolids_managed_land_applied:0,latitude:29.417167,longitude:-94.896306},{facility_name:"GSW&SA/SCHWARTZ, MYRTLE BEACH",city:"Conway",state:"S.C.",amount_of_biosolids_generated:1813,amount_of_biosolids_managed_land_applied:1813,latitude:33.642951,longitude:-79.043803},{facility_name:"SWIFT BEEF COMPANY",city:"Hyrum",state:"Utah",amount_of_biosolids_generated:1809,amount_of_biosolids_managed_land_applied:1809,latitude:41.64415,longitude:-111.86086},{facility_name:"FIVE OAKS WWTP",city:"Highlands",state:"Texas",amount_of_biosolids_generated:1805,amount_of_biosolids_managed_land_applied:0,latitude:30.109639,longitude:-95.498528},{facility_name:"CITY OF MORGANTON",city:"Morganton",state:"Mont.",amount_of_biosolids_generated:1803,amount_of_biosolids_managed_land_applied:580,latitude:35.774026,longitude:-81.665752},{facility_name:"AGSPREAD, INC.",city:"Lincoln City",state:"Iowa",amount_of_biosolids_generated:1800,amount_of_biosolids_managed_land_applied:2362.37,latitude:38.12197,longitude:-87.002493},{facility_name:"CITY OF LEMARS",city:"Lemars",state:"Hawaii",amount_of_biosolids_generated:1800,amount_of_biosolids_managed_land_applied:720.4,latitude:42.78691,longitude:-96.16690776},{facility_name:"CITY OF PLAINVIEW WWTF",city:"Plainview",state:"Texas",amount_of_biosolids_generated:1793,amount_of_biosolids_managed_land_applied:0,latitude:34.169807,longitude:-101.676836},{facility_name:"HRSD -JAMES RIVER STP",city:"Newport News",state:"Utah",amount_of_biosolids_generated:1792,amount_of_biosolids_managed_land_applied:0,latitude:37.084011,longitude:-76.531216},{facility_name:"GRAND ISLAND WWTF",city:"Grand Island",state:"Neb.",amount_of_biosolids_generated:1784,amount_of_biosolids_managed_land_applied:0,latitude:40.922386,longitude:-98.3079},{facility_name:"SANTA BARBARA EL ESTERO WWTP",city:"Santa Barbara",state:"Calif.",amount_of_biosolids_generated:1773,amount_of_biosolids_managed_land_applied:0,latitude:34.41888,longitude:-119.68471},{facility_name:"AUBURN WWTP",city:"Auburn",state:"Iowa",amount_of_biosolids_generated:1771,amount_of_biosolids_managed_land_applied:0,latitude:41.34305795,longitude:-85.02198547},{facility_name:"PUEBLO CITY OF",city:"Pueblo",state:"Colo.",amount_of_biosolids_generated:1763,amount_of_biosolids_managed_land_applied:0,latitude:38.25722,longitude:-104.578333},{facility_name:"PWC/FAYETTEVILLE",city:"Fayetteville",state:"Mont.",amount_of_biosolids_generated:1760,amount_of_biosolids_managed_land_applied:1760,latitude:35.059346,longitude:-78.860466},{facility_name:"TAFT WWTF",city:"Bakersfield",state:"Calif.",amount_of_biosolids_generated:1760,amount_of_biosolids_managed_land_applied:0,latitude:35.31323593,longitude:-118.9210295},{facility_name:"SOUTHSIDE WWTF",city:"Brownsville",state:"Texas",amount_of_biosolids_generated:1759,amount_of_biosolids_managed_land_applied:0,latitude:25.897222,longitude:-97.468778},{facility_name:"ALBANY CO SD",city:"Albany",state:"N.D.",amount_of_biosolids_generated:1751,amount_of_biosolids_managed_land_applied:0,latitude:42.6823962,longitude:-73.73647273},{facility_name:"CENTRAL DAVIS CO SEWER",city:"Kaysville",state:"Utah",amount_of_biosolids_generated:1749,amount_of_biosolids_managed_land_applied:1327,latitude:41.0007,longitude:-111.944932},{facility_name:"CHARLES RIVER P C D",city:"Medway",state:"Mass.",amount_of_biosolids_generated:1744,amount_of_biosolids_managed_land_applied:0,latitude:42.14087,longitude:-71.38896},{facility_name:"TWO RIVERS WATER RECLAMATION A",city:"Monmouth Beach",state:"Neb.",amount_of_biosolids_generated:1741,amount_of_biosolids_managed_land_applied:132,latitude:40.336956,longitude:-73.991718},{facility_name:"SAN MATEO WWTP",city:"San Mateo",state:"Calif.",amount_of_biosolids_generated:1736,amount_of_biosolids_managed_land_applied:1736.47,latitude:37.5685,longitude:-122.29484},{facility_name:"UNIFIED GOVERNMENT OF ATHENS-CLARKE CO (NORTH OCONEE)",city:"Athens",state:"Ga.",amount_of_biosolids_generated:1734,amount_of_biosolids_managed_land_applied:0,latitude:33.95989,longitude:-83.37726},{facility_name:"PALM SPRINGS WWTP",city:"Palm Springs",state:"Calif.",amount_of_biosolids_generated:1731,amount_of_biosolids_managed_land_applied:0,latitude:33.80853,longitude:-116.49866},{facility_name:"THOUSAND OAKS HILL CANYON WWTP",city:"Thousand Oaks",state:"Calif.",amount_of_biosolids_generated:1728,amount_of_biosolids_managed_land_applied:0,latitude:34.17585,longitude:-118.84841},{facility_name:"LACSD - PALMDALE WRP",city:"Whittier",state:"Calif.",amount_of_biosolids_generated:1725,amount_of_biosolids_managed_land_applied:0,latitude:33.96071322,longitude:-118.0256606},{facility_name:"SOUTH ADAMS COUNTY WSD",city:"Commerce City",state:"Colo.",amount_of_biosolids_generated:1724,amount_of_biosolids_managed_land_applied:0,latitude:39.883473,longitude:-104.7918926},{facility_name:"LCDPW-DES PLAINES RIVER STP",city:"Buffalo Grove",state:"Iowa",amount_of_biosolids_generated:1724,amount_of_biosolids_managed_land_applied:1724,latitude:42.16734,longitude:-87.93602},{facility_name:"GRACE CREEK WWTP",city:"Longview",state:"Texas",amount_of_biosolids_generated:1724,amount_of_biosolids_managed_land_applied:0,latitude:32.462467,longitude:-94.758067},{facility_name:"WEST DISTRICT WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:1722,amount_of_biosolids_managed_land_applied:0,latitude:29.76522,longitude:-95.56275},{facility_name:"COATESVILLE WASTEWATER TP",city:"Coatsville",state:"Pa.",amount_of_biosolids_generated:1718,amount_of_biosolids_managed_land_applied:1718,latitude:39.99267,longitude:-75.87465},{facility_name:"FULTON COUNTY JOHNS CREEK ENVIRON CAMPUS",city:"Atlanta",state:"Ga.",amount_of_biosolids_generated:1718,amount_of_biosolids_managed_land_applied:0,latitude:33.977594,longitude:-84.265494},{facility_name:"AIKEN PSA/HORSE CREEK WWTF",city:"Beech Island",state:"S.C.",amount_of_biosolids_generated:1718,amount_of_biosolids_managed_land_applied:1717.64,latitude:33.469722,longitude:-81.913611},{facility_name:"CITY OF COLUMBIA",city:"Columbia",state:"Mo.",amount_of_biosolids_generated:1715,amount_of_biosolids_managed_land_applied:1400.6,latitude:38.95270199,longitude:-92.33086506},{facility_name:"CITY OF BURLINGTON",city:"Burlington",state:"Mont.",amount_of_biosolids_generated:1714,amount_of_biosolids_managed_land_applied:1714,latitude:36.098185,longitude:-79.37666},{facility_name:"DCDPW-WOODRIDGE GREEN VALLEY",city:"Woodridge",state:"Iowa",amount_of_biosolids_generated:1706,amount_of_biosolids_managed_land_applied:1706,latitude:41.744924,longitude:-88.061239},{facility_name:"CITY OF HOLLAND WWTF",city:"Holland",state:"Texas",amount_of_biosolids_generated:1702,amount_of_biosolids_managed_land_applied:0,latitude:30.880722,longitude:-97.394167},{facility_name:"BROADNECK_WRF",city:"Annapolis",state:"Mass.",amount_of_biosolids_generated:1700,amount_of_biosolids_managed_land_applied:1699.71,latitude:39.025556,longitude:-76.406944},{facility_name:"WARWICK SEWER AUTHORITY",city:"Warwick",state:"R.I.",amount_of_biosolids_generated:1700,amount_of_biosolids_managed_land_applied:0,latitude:41.736483,longitude:-71.451444},{facility_name:"CITY OF MACCLENNY",city:"Macclenny",state:"Fla.",amount_of_biosolids_generated:1693,amount_of_biosolids_managed_land_applied:0,latitude:30.270687,longitude:-82.124907},{facility_name:"BLOOMINGTON/NORMAL WRD STP",city:"Bloomington",state:"Iowa",amount_of_biosolids_generated:1692,amount_of_biosolids_managed_land_applied:1404,latitude:40.47341,longitude:-89.0083},{facility_name:"JOCO DOUGLAS SMITH MIDDLE BASIN",city:"Olathe",state:"Kan.",amount_of_biosolids_generated:1689,amount_of_biosolids_managed_land_applied:1689.13,latitude:38.91572,longitude:-94.79924},{facility_name:"SUNRISE NO 3 WWTP (SAWGRASS)",city:"Sunrise",state:"Fla.",amount_of_biosolids_generated:1686,amount_of_biosolids_managed_land_applied:0,latitude:26.13137,longitude:-80.337},{facility_name:"BRISTOL",city:"Bristol",state:"Conn.",amount_of_biosolids_generated:1686,amount_of_biosolids_managed_land_applied:0,latitude:41.67346,longitude:-72.94587},{facility_name:"YORK CITY_SEWER AUTHORITY STP",city:"York County",state:"Pa.",amount_of_biosolids_generated:1678,amount_of_biosolids_managed_land_applied:1678.41,latitude:39.987594,longitude:-76.725791},{facility_name:"BRISTOL STP #2",city:"Bluff City",state:"Tenn.",amount_of_biosolids_generated:1677,amount_of_biosolids_managed_land_applied:3347,latitude:36.500432,longitude:-82.289707},{facility_name:"TOWN OF MANCHESTER",city:"Manchester",state:"Conn.",amount_of_biosolids_generated:1675,amount_of_biosolids_managed_land_applied:0,latitude:41.75858,longitude:-72.51661},{facility_name:"SAINT CLOUD",city:"St Cloud",state:"Minn.",amount_of_biosolids_generated:1673,amount_of_biosolids_managed_land_applied:1672.8,latitude:45.473611,longitude:-94.119444},{facility_name:"EMWD - SAN JACINTO RWRF",city:"Perris",state:"Calif.",amount_of_biosolids_generated:1668,amount_of_biosolids_managed_land_applied:1668.11,latitude:33.77295098,longitude:-116.9550549},{facility_name:"HARLINGEN WWTP",city:"Harlingen",state:"Texas",amount_of_biosolids_generated:1662,amount_of_biosolids_managed_land_applied:24.6,latitude:26.182167,longitude:-97.640361},{facility_name:"LOXAHATCHEE ENVIRONMENTAL CONTROL DISTRICT - WWTP",city:"Jupiter",state:"Fla.",amount_of_biosolids_generated:1656,amount_of_biosolids_managed_land_applied:0,latitude:26.924069,longitude:-80.140161},{facility_name:"VACAVILLE EASTERLY WWTP",city:"Elmira",state:"Calif.",amount_of_biosolids_generated:1649,amount_of_biosolids_managed_land_applied:0,latitude:38.34848578,longitude:-121.9086538},{facility_name:"TAUNTON W W T P",city:"Taunton",state:"Mass.",amount_of_biosolids_generated:1648,amount_of_biosolids_managed_land_applied:0,latitude:41.87435,longitude:-71.09723},{facility_name:"HRSD YORK RIVER STP",city:"Seaford",state:"Utah",amount_of_biosolids_generated:1646,amount_of_biosolids_managed_land_applied:0,latitude:37.20112,longitude:-76.44525},{facility_name:"RIALTO WRF",city:"Bloomington",state:"Calif.",amount_of_biosolids_generated:1645,amount_of_biosolids_managed_land_applied:0,latitude:34.0559,longitude:-117.36134},{facility_name:"CITY OF ROSENBERG WWTF 2",city:"Rosenburg",state:"Texas",amount_of_biosolids_generated:1643,amount_of_biosolids_managed_land_applied:0,latitude:29.528248,longitude:-95.812757},{facility_name:"DUBLIN SAN RAMON RWTF",city:"Dublin",state:"Calif.",amount_of_biosolids_generated:1643,amount_of_biosolids_managed_land_applied:0,latitude:37.705686,longitude:-121.920739},{facility_name:"CITY OF GREAT FALLS",city:"Great Falls",state:"Mont.",amount_of_biosolids_generated:1640,amount_of_biosolids_managed_land_applied:0,latitude:47.50646077,longitude:-111.304097},{facility_name:"CITY OF LARGO. WWTP",city:"Largo",state:"Fla.",amount_of_biosolids_generated:1610,amount_of_biosolids_managed_land_applied:0,latitude:27.9086,longitude:-82.70374},{facility_name:"MANATEE COUNTY SOUTHWEST REGIONAL WWTP",city:"Bradenton",state:"Fla.",amount_of_biosolids_generated:1608,amount_of_biosolids_managed_land_applied:0,latitude:27.455075,longitude:-82.624504},{facility_name:"MODESTO WQCF",city:"Modesto",state:"Calif.",amount_of_biosolids_generated:1605,amount_of_biosolids_managed_land_applied:1605.39,latitude:37.613722,longitude:-121.011778},{facility_name:"FREMONT WWTF",city:"Fremont",state:"Neb.",amount_of_biosolids_generated:1597,amount_of_biosolids_managed_land_applied:2185,latitude:41.421985,longitude:-96.413297},{facility_name:"STEEP BANK FLAT BANK CREEK WWTP",city:"Missouri City",state:"Texas",amount_of_biosolids_generated:1592,amount_of_biosolids_managed_land_applied:0,latitude:29.546889,longitude:-95.573},{facility_name:"BAKERSFIELD WWTP 3",city:"Bakersfield",state:"Calif.",amount_of_biosolids_generated:1587,amount_of_biosolids_managed_land_applied:1587,latitude:35.25615989,longitude:-119.0566543},{facility_name:"VERNON WPCF",city:"Vernon",state:"Conn.",amount_of_biosolids_generated:1585,amount_of_biosolids_managed_land_applied:0,latitude:41.86482,longitude:-72.487307},{facility_name:"DALLAS SALMON WWTP",city:"League City",state:"Texas",amount_of_biosolids_generated:1583,amount_of_biosolids_managed_land_applied:0,latitude:29.51873,longitude:-95.09124},{facility_name:"WORTHINGTON",city:"Worthington",state:"Minn.",amount_of_biosolids_generated:1578,amount_of_biosolids_managed_land_applied:1578,latitude:43.645366,longitude:-95.579616},{facility_name:"HOLLYWOOD ROAD WWTP",city:"Amarillo",state:"Texas",amount_of_biosolids_generated:1577,amount_of_biosolids_managed_land_applied:0,latitude:35.106936,longitude:-101.791867},{facility_name:"GREELEY CITY OF",city:"Greeley",state:"Colo.",amount_of_biosolids_generated:1569,amount_of_biosolids_managed_land_applied:16.38,latitude:40.423628,longitude:-104.676788},{facility_name:"CITY OF IOWA CITY",city:"Iowa City",state:"Hawaii",amount_of_biosolids_generated:1564,amount_of_biosolids_managed_land_applied:986,latitude:41.66005,longitude:-91.529},{facility_name:"EMERALD COAST UTILITIES AUTHORITY",city:"Cantonment",state:"Fla.",amount_of_biosolids_generated:1559,amount_of_biosolids_managed_land_applied:0,latitude:30.436378,longitude:-87.328078},{facility_name:"LOTT BUDD INLET WATER RECLAMATION FACILITY",city:"Olympia",state:"Wash.",amount_of_biosolids_generated:1557,amount_of_biosolids_managed_land_applied:1557.42,latitude:47.049372,longitude:-122.898656},{facility_name:"STEUBEN LAKES RWD",city:"Angola",state:"Iowa",amount_of_biosolids_generated:1557,amount_of_biosolids_managed_land_applied:1557.16,latitude:41.66352,longitude:-85.1435},{facility_name:"MT PLEASANT/CENTER ST & RR RD.",city:"Mount Pleasant",state:"S.C.",amount_of_biosolids_generated:1554,amount_of_biosolids_managed_land_applied:0,latitude:32.809579,longitude:-79.835013},{facility_name:"PWC/FAYETTEVILLE",city:"Fayetteville",state:"Mont.",amount_of_biosolids_generated:1552,amount_of_biosolids_managed_land_applied:1552,latitude:34.964309,longitude:-78.832922},{facility_name:"BELL COUNTY WCID 1 WWTF",city:"Killeen",state:"Texas",amount_of_biosolids_generated:1550,amount_of_biosolids_managed_land_applied:1550.26986,latitude:31.10821,longitude:-97.70166},{facility_name:"LOGANSPORT WASTEWATER TREATMENT PLANT",city:"Logansport",state:"Iowa",amount_of_biosolids_generated:1550,amount_of_biosolids_managed_land_applied:0,latitude:40.747611,longitude:-86.387611},{facility_name:"SEARCY BOARD OF PUB. UTILITIES",city:"Searcy",state:"Alaska",amount_of_biosolids_generated:1549,amount_of_biosolids_managed_land_applied:1548.84,latitude:35.26876,longitude:-91.71355},{facility_name:"ROSEVILLE DRY CREEK WWTP",city:"Roseville",state:"Calif.",amount_of_biosolids_generated:1542,amount_of_biosolids_managed_land_applied:1542,latitude:38.733889,longitude:-121.321667},{facility_name:"CITY OF AUBURN - HC MORGAN WPCF",city:"Auburn",state:"Alaska",amount_of_biosolids_generated:1540,amount_of_biosolids_managed_land_applied:1540,latitude:32.537526,longitude:-85.506272},{facility_name:"UNION COUNTY",city:"Monroe",state:"Mont.",amount_of_biosolids_generated:1538,amount_of_biosolids_managed_land_applied:0,latitude:34.95473,longitude:-80.76425},{facility_name:"JEFFERSON COUNTY COMMISSION ENVIRONMENTAL SERVICES DEPARTMENT",city:"Birmingham",state:"Alaska",amount_of_biosolids_generated:1532,amount_of_biosolids_managed_land_applied:1532,latitude:33.5937,longitude:-86.8619},{facility_name:"DUPAGE COUNTY PUBLIC WORKS-KNOLLWOOD STP",city:"Burr Ridge",state:"Iowa",amount_of_biosolids_generated:1527,amount_of_biosolids_managed_land_applied:0,latitude:41.71236,longitude:-87.933685},{facility_name:"BROOMFIELD CITY AND COUNTY",city:"Broomfield",state:"Colo.",amount_of_biosolids_generated:1525,amount_of_biosolids_managed_land_applied:0,latitude:39.9213,longitude:-105.02351},{facility_name:"THORN CREEK BASIN SD STP",city:"Chicago Heights",state:"Iowa",amount_of_biosolids_generated:1513,amount_of_biosolids_managed_land_applied:225,latitude:41.51725,longitude:-87.62656},{facility_name:"TORRINGTON WPCF",city:"Torrington",state:"Conn.",amount_of_biosolids_generated:1513,amount_of_biosolids_managed_land_applied:0,latitude:41.77697,longitude:-73.11818},{facility_name:"LAUREL POTW, NUMBER 2",city:"Laurel",state:"Mo.",amount_of_biosolids_generated:1500,amount_of_biosolids_managed_land_applied:0,latitude:31.687028,longitude:-89.114806},{facility_name:"GREENWICH WPCF",city:"Greenwich",state:"Conn.",amount_of_biosolids_generated:1499,amount_of_biosolids_managed_land_applied:0,latitude:41.013329,longitude:-73.624833},{facility_name:"ROBINDALE WWTP",city:"Brownsville",state:"Texas",amount_of_biosolids_generated:1491,amount_of_biosolids_managed_land_applied:0,latitude:25.954014,longitude:-97.453935},{facility_name:"CITY OF PLANT CITY",city:"Plant City",state:"Fla.",amount_of_biosolids_generated:1490,amount_of_biosolids_managed_land_applied:0,latitude:28.02018,longitude:-82.13938},{facility_name:"CHEROKEE COUNTY WATER & SEWERAGE AUTHORITY (CCWSA)",city:"Canton",state:"Ga.",amount_of_biosolids_generated:1486,amount_of_biosolids_managed_land_applied:0,latitude:34.102722,longitude:-84.447972},{facility_name:"MERIDEN WPCF",city:"Meriden",state:"Conn.",amount_of_biosolids_generated:1486,amount_of_biosolids_managed_land_applied:0,latitude:41.51139,longitude:-72.82825},{facility_name:"POCATELLO, CITY OF",city:"Pocatello",state:"Iowa",amount_of_biosolids_generated:1485,amount_of_biosolids_managed_land_applied:1485,latitude:42.914973,longitude:-112.516555},{facility_name:"MANKATO",city:"Mankato",state:"Minn.",amount_of_biosolids_generated:1481,amount_of_biosolids_managed_land_applied:1253,latitude:44.18261,longitude:-94.00032},{facility_name:"MOBILE CITY OF W AND S COMM",city:"Mobile",state:"Alaska",amount_of_biosolids_generated:1481,amount_of_biosolids_managed_land_applied:1480.69,latitude:30.66365,longitude:-88.03875},{facility_name:"FOX LAKE NW REGIONAL WRF",city:"Fox Lake",state:"Iowa",amount_of_biosolids_generated:1479,amount_of_biosolids_managed_land_applied:1603,latitude:42.3905,longitude:-88.1767},{facility_name:"NORTHEAST REGIONAL WWTF",city:"Bartow",state:"Fla.",amount_of_biosolids_generated:1479,amount_of_biosolids_managed_land_applied:0,latitude:27.894946,longitude:-81.84235},{facility_name:"LOS ANGELES GRIFFITH PARK COMPOST",city:"Los Angeles",state:"Calif.",amount_of_biosolids_generated:1478,amount_of_biosolids_managed_land_applied:1868,latitude:33.93077,longitude:-118.43494},{facility_name:"BOB DERRINGTON WATER RECLAMATION PLANT",city:"Odessa",state:"Texas",amount_of_biosolids_generated:1474,amount_of_biosolids_managed_land_applied:0,latitude:31.82183,longitude:-102.255718},{facility_name:"NEWPORT CITY HALL",city:"Newport",state:"R.I.",amount_of_biosolids_generated:1473,amount_of_biosolids_managed_land_applied:0,latitude:41.49189,longitude:-71.31164},{facility_name:"CITY OF WEBSTER CENTRAL WWTF",city:"Webster",state:"Texas",amount_of_biosolids_generated:1462,amount_of_biosolids_managed_land_applied:0,latitude:29.529003,longitude:-95.117019},{facility_name:"BEAUMONT WWTP #1",city:"Beaumont",state:"Calif.",amount_of_biosolids_generated:1462,amount_of_biosolids_managed_land_applied:0,latitude:33.95137155,longitude:-116.9920128},{facility_name:"SOUTH SAN FRANCISCO - SAN BRUNO WQCP",city:"S. San Francisco",state:"Calif.",amount_of_biosolids_generated:1462,amount_of_biosolids_managed_land_applied:0,latitude:37.641603,longitude:-122.39997},{facility_name:"RICHMOND WWTP",city:"Richmond",state:"Iowa",amount_of_biosolids_generated:1450,amount_of_biosolids_managed_land_applied:1449.83,latitude:39.85298896,longitude:-84.8875605},{facility_name:"CITY OF MCALLEN NORTH WWTP",city:"Mcallen",state:"Texas",amount_of_biosolids_generated:1448,amount_of_biosolids_managed_land_applied:1448,latitude:26.304794,longitude:-98.219196},{facility_name:"CITY OF LUMBERTON",city:"Lumberton",state:"Mont.",amount_of_biosolids_generated:1446,amount_of_biosolids_managed_land_applied:1445.82,latitude:34.604568,longitude:-78.99126},{facility_name:"SANTA MARGARITA CHIQUITA WRF",city:"San Juan Capistrano",state:"Calif.",amount_of_biosolids_generated:1438,amount_of_biosolids_managed_land_applied:0,latitude:33.55501922,longitude:-117.669677},{facility_name:"BELLEVILLE STP #1, CITY OF",city:"Belleville",state:"Iowa",amount_of_biosolids_generated:1429,amount_of_biosolids_managed_land_applied:1796,latitude:38.49887,longitude:-89.97946},{facility_name:"DERRY TOWNSHIP STP",city:"Hershey",state:"Pa.",amount_of_biosolids_generated:1420,amount_of_biosolids_managed_land_applied:1420.1,latitude:40.2837,longitude:-76.68368},{facility_name:"BOULDER CITY OF",city:"Boulder",state:"Colo.",amount_of_biosolids_generated:1420,amount_of_biosolids_managed_land_applied:0,latitude:40.01476,longitude:-105.27889},{facility_name:"WEST NEW YORK MUA STP",city:"West New York",state:"Neb.",amount_of_biosolids_generated:1417,amount_of_biosolids_managed_land_applied:0,latitude:40.789316,longitude:-73.99989},{facility_name:"ROTH LANE TREATMENT PLANT",city:"Mechanicsburg",state:"Pa.",amount_of_biosolids_generated:1409,amount_of_biosolids_managed_land_applied:1409,latitude:40.27425,longitude:-76.977113},{facility_name:"CITY OF PANAMA CITY BEACH",city:"Panama City Beach",state:"Fla.",amount_of_biosolids_generated:1409,amount_of_biosolids_managed_land_applied:1390.3,latitude:30.216107,longitude:-85.85367},{facility_name:"PASCO WWTP",city:"Pasco",state:"Wash.",amount_of_biosolids_generated:1384,amount_of_biosolids_managed_land_applied:850.65,latitude:46.222213,longitude:-119.084842},{facility_name:"DOE BRANCH REG WATER REC PLANT",city:"Lewisville",state:"Texas",amount_of_biosolids_generated:1383,amount_of_biosolids_managed_land_applied:0,latitude:33.04627,longitude:-97.00117},{facility_name:"VALPARAISO WWTP",city:"Valparaiso",state:"Iowa",amount_of_biosolids_generated:1382,amount_of_biosolids_managed_land_applied:505.47,latitude:41.46908807,longitude:-87.03326735},{facility_name:"FORT RILEY - CAMP FUNSTON",city:"Ft Riley",state:"Kan.",amount_of_biosolids_generated:1368,amount_of_biosolids_managed_land_applied:1368,latitude:38.4985464,longitude:-98.3834298},{facility_name:"MEYER RANCH MUD WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:1366,amount_of_biosolids_managed_land_applied:1366.11,latitude:29.780709,longitude:-98.280149},{facility_name:"CITY OF LENOIR",city:"Lenoir",state:"Mont.",amount_of_biosolids_generated:1365,amount_of_biosolids_managed_land_applied:745,latitude:35.8819,longitude:-81.5771},{facility_name:"BUTLER AREA SEWER AUTH-WTR POL",city:"Butler",state:"Pa.",amount_of_biosolids_generated:1365,amount_of_biosolids_managed_land_applied:0,latitude:40.839183,longitude:-79.920039},{facility_name:"CUMBERLAND WWTP",city:"Cumberland",state:"Mass.",amount_of_biosolids_generated:1360,amount_of_biosolids_managed_land_applied:1217,latitude:39.652151,longitude:-78.762236},{facility_name:"GLENS FALLS (C)",city:"Glens Falls",state:"N.D.",amount_of_biosolids_generated:1357,amount_of_biosolids_managed_land_applied:0,latitude:43.304944,longitude:-73.623694},{facility_name:"PORTERVILLE WWTF",city:"Porterville",state:"Calif.",amount_of_biosolids_generated:1352,amount_of_biosolids_managed_land_applied:1210,latitude:36.070906,longitude:-119.016191},{facility_name:"CITY OF WARNER ROBINS-SANDY RUN WPCP",city:"Warner Robins",state:"Ga.",amount_of_biosolids_generated:1348,amount_of_biosolids_managed_land_applied:1348.07,latitude:32.578624,longitude:-83.594865},{facility_name:"URBANA-CHAMPAIGN SD-NE STP",city:"Urbana",state:"Iowa",amount_of_biosolids_generated:1348,amount_of_biosolids_managed_land_applied:1795,latitude:40.115828,longitude:-88.19299},{facility_name:"RICHEY ROAD MUD WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:1348,amount_of_biosolids_managed_land_applied:0,latitude:30.008867,longitude:-95.391419},{facility_name:"MEMPHIS-TE MAXSON STP SO PLT",city:"Memphis",state:"Tenn.",amount_of_biosolids_generated:1346,amount_of_biosolids_managed_land_applied:0,latitude:35.06935,longitude:-90.1316},{facility_name:"COUNTY OF HAWAII PAPAIKOU-PAUKAA WWTP",city:"Hilo",state:"Hawaii",amount_of_biosolids_generated:1344,amount_of_biosolids_managed_land_applied:0,latitude:19.70581,longitude:-155.060638},{facility_name:"KULAIMANO WASTEWATER TREATMENT PLANT",city:"Pepeekeo",state:"Hawaii",amount_of_biosolids_generated:1344,amount_of_biosolids_managed_land_applied:0,latitude:19.83251,longitude:-155.09438},{facility_name:"HILO WWTP",city:"Hilo",state:"Hawaii",amount_of_biosolids_generated:1343,amount_of_biosolids_managed_land_applied:0,latitude:19.70581,longitude:-155.060638},{facility_name:"CITY OF EL CAMPO WWTF",city:"El Campo",state:"Texas",amount_of_biosolids_generated:1342,amount_of_biosolids_managed_land_applied:0,latitude:29.183972,longitude:-96.256556},{facility_name:"SHREVEPORT, CITY OF (LUCAS)",city:"Shreveport",state:"La.",amount_of_biosolids_generated:1341,amount_of_biosolids_managed_land_applied:1141,latitude:32.369444,longitude:-93.775833},{facility_name:"CITY OF MUSCATINE",city:"Muscatine",state:"Hawaii",amount_of_biosolids_generated:1337,amount_of_biosolids_managed_land_applied:938.68,latitude:41.407499,longitude:-91.071913},{facility_name:"DUNKIRK (C)",city:"Dunkirk",state:"N.D.",amount_of_biosolids_generated:1337,amount_of_biosolids_managed_land_applied:0,latitude:42.48325,longitude:-79.33447},{facility_name:"MOUNTAIN VIEW STP",city:"Wayne",state:"Neb.",amount_of_biosolids_generated:1336,amount_of_biosolids_managed_land_applied:0,latitude:40.913167,longitude:-74.251163},{facility_name:"PORT ORCHARD WWTP",city:"Port Orchard",state:"Wash.",amount_of_biosolids_generated:1334,amount_of_biosolids_managed_land_applied:1334.09,latitude:47.546071,longitude:-122.613234},{facility_name:"GALLATIN STP",city:"Gallatin",state:"Tenn.",amount_of_biosolids_generated:1331,amount_of_biosolids_managed_land_applied:6.01,latitude:36.331477,longitude:-86.462479},{facility_name:"PLAINFIELD N STP, VILLAGE OF",city:"Plainfield",state:"Iowa",amount_of_biosolids_generated:1330,amount_of_biosolids_managed_land_applied:1330,latitude:41.61622,longitude:-88.2119},{facility_name:"EL PASO WATER UTILITIES NORTHWEST WWTP",city:"El Paso",state:"Texas",amount_of_biosolids_generated:1330,amount_of_biosolids_managed_land_applied:0,latitude:31.79472,longitude:-106.5222},{facility_name:"DURHAM COUNTY",city:"Durham",state:"Mont.",amount_of_biosolids_generated:1330,amount_of_biosolids_managed_land_applied:0,latitude:35.879585,longitude:-78.895783},{facility_name:"SANTA MARIA WWTP",city:"Santa Maria",state:"Calif.",amount_of_biosolids_generated:1329,amount_of_biosolids_managed_land_applied:0,latitude:34.952597,longitude:-120.384126},{facility_name:"COMMANDING OFFICER MARINE CORPS BASE CAMP LEJEUNE",city:"Camp Lejeune",state:"Mont.",amount_of_biosolids_generated:1327,amount_of_biosolids_managed_land_applied:402.02,latitude:34.673616,longitude:-77.325577},{facility_name:"CARTER CREEK WWTP",city:"College Station",state:"Texas",amount_of_biosolids_generated:1326,amount_of_biosolids_managed_land_applied:0,latitude:30.61602,longitude:-96.28182},{facility_name:"LYNNWOOD STP",city:"Lynnwood",state:"Wash.",amount_of_biosolids_generated:1324,amount_of_biosolids_managed_land_applied:0,latitude:47.846298,longitude:-122.338351},{facility_name:"NORTHERN TREATMENT PLANT",city:"Brighton",state:"Colo.",amount_of_biosolids_generated:1323,amount_of_biosolids_managed_land_applied:802.65,latitude:40.004,longitude:-104.822},{facility_name:"EXETER TOWN OF",city:"Exeter",state:"Neb.",amount_of_biosolids_generated:1318,amount_of_biosolids_managed_land_applied:0,latitude:42.996706,longitude:-70.944428},{facility_name:"CLEVELAND UTILITIES STP",city:"Cleveland",state:"Tenn.",amount_of_biosolids_generated:1315,amount_of_biosolids_managed_land_applied:1315,latitude:35.314517,longitude:-84.799943},{facility_name:"WHEELING WPC DIVISION",city:"Wheeling",state:"Wis.",amount_of_biosolids_generated:1312,amount_of_biosolids_managed_land_applied:0,latitude:40.0565,longitude:-80.7271},{facility_name:"MONMOUTH NORTH STP",city:"Monmouth",state:"Iowa",amount_of_biosolids_generated:1310,amount_of_biosolids_managed_land_applied:776,latitude:40.944686,longitude:-90.642554},{facility_name:"HITE CREEK WQTC MSD",city:"Louisville",state:"Ky.",amount_of_biosolids_generated:1308,amount_of_biosolids_managed_land_applied:0,latitude:38.322222,longitude:-85.555},{facility_name:"MELBOURNE/DB LEE WWTP",city:"Melbourne",state:"Fla.",amount_of_biosolids_generated:1307,amount_of_biosolids_managed_land_applied:1306.59,latitude:28.12066,longitude:-80.6385},{facility_name:"ENFIELD POTW",city:"Enfield",state:"Conn.",amount_of_biosolids_generated:1290,amount_of_biosolids_managed_land_applied:0,latitude:42.00025,longitude:-72.594022},{facility_name:"REWA/LOWER REEDY RIVER WWTP",city:"Greenville",state:"S.C.",amount_of_biosolids_generated:1289,amount_of_biosolids_managed_land_applied:1027.14,latitude:34.687393,longitude:-82.300086},{facility_name:"LINCOLN WTRF",city:"Lincoln",state:"Calif.",amount_of_biosolids_generated:1283,amount_of_biosolids_managed_land_applied:0,latitude:38.94136,longitude:-121.223576},{facility_name:"RIO RANCHO, CITY OF",city:"Rio Rancho",state:"N.D.",amount_of_biosolids_generated:1282,amount_of_biosolids_managed_land_applied:0,latitude:35.25856,longitude:-106.63226},{facility_name:"PLATTSBURGH (C)",city:"Plattsburgh",state:"N.D.",amount_of_biosolids_generated:1276,amount_of_biosolids_managed_land_applied:0,latitude:44.69914,longitude:-73.45157},{facility_name:"CITY OF JEFFERSON CITY",city:"Jefferson City",state:"Mo.",amount_of_biosolids_generated:1274,amount_of_biosolids_managed_land_applied:1260,latitude:38.571991,longitude:-92.171592},{facility_name:"FALLING CREEK WASTEWATER TREATMENT PLANT",city:"Richmond",state:"Utah",amount_of_biosolids_generated:1272,amount_of_biosolids_managed_land_applied:1272,latitude:37.49357,longitude:-77.43117},{facility_name:"CITY OF EAST PROVIDENCE",city:"East Providence",state:"R.I.",amount_of_biosolids_generated:1271,amount_of_biosolids_managed_land_applied:1271.43,latitude:41.81972,longitude:-71.37596},{facility_name:"RAPID CITY, CITY OF",city:"Rapid City",state:"S.D.",amount_of_biosolids_generated:1270,amount_of_biosolids_managed_land_applied:0,latitude:44.02201,longitude:-103.09853},{facility_name:"RENSSELAER WWTP, CITY OF",city:"Rensselaer",state:"Iowa",amount_of_biosolids_generated:1267,amount_of_biosolids_managed_land_applied:0,latitude:40.923722,longitude:-87.175778},{facility_name:"CITY OF SPRINGFIELD",city:"Springfield",state:"Mo.",amount_of_biosolids_generated:1266,amount_of_biosolids_managed_land_applied:0,latitude:37.21538219,longitude:-93.29428548},{facility_name:"NORTH WATER RECLAMATION FACILITY",city:"Parker",state:"Colo.",amount_of_biosolids_generated:1266,amount_of_biosolids_managed_land_applied:0,latitude:39.55281,longitude:-104.78229},{facility_name:"CENTRAL MARIN SANITATION AGENCY WWTP",city:"San Rafael",state:"Calif.",amount_of_biosolids_generated:1263,amount_of_biosolids_managed_land_applied:80,latitude:37.95,longitude:-122.49658},{facility_name:"GERONIMO CREEK WWTP",city:"Seguin",state:"Texas",amount_of_biosolids_generated:1261,amount_of_biosolids_managed_land_applied:0,latitude:29.55266,longitude:-97.91403},{facility_name:"ORANGE CO DEPT OF EF AND S",city:"Goshen",state:"N.D.",amount_of_biosolids_generated:1258,amount_of_biosolids_managed_land_applied:0,latitude:41.38863423,longitude:-74.31772315},{facility_name:"CITY OF LAGRANGE",city:"Lagrange",state:"Ga.",amount_of_biosolids_generated:1253,amount_of_biosolids_managed_land_applied:1252.52,latitude:32.970056,longitude:-85.074944},{facility_name:"GLENBARD WASTEWATER AUTH-MAIN",city:"Glen Ellyn",state:"Iowa",amount_of_biosolids_generated:1251,amount_of_biosolids_managed_land_applied:926.778,latitude:41.845974,longitude:-88.044495},{facility_name:"SAN LEANDRO WPCP",city:"San Leandro",state:"Calif.",amount_of_biosolids_generated:1250,amount_of_biosolids_managed_land_applied:260.77,latitude:37.71486,longitude:-122.19282},{facility_name:"JONESBORO, CITY WATER & LIGHT-E",city:"Jonesboro",state:"Alaska",amount_of_biosolids_generated:1248,amount_of_biosolids_managed_land_applied:1248,latitude:35.79199,longitude:-90.63282},{facility_name:"SALMON CREEK STP",city:"Vancouver",state:"Wash.",amount_of_biosolids_generated:1248,amount_of_biosolids_managed_land_applied:1247.6,latitude:45.732006,longitude:-122.727486},{facility_name:"CITY OF POTTSBORO WWTP",city:"Pottsboro",state:"Texas",amount_of_biosolids_generated:1246,amount_of_biosolids_managed_land_applied:0,latitude:33.786944,longitude:-96.669},{facility_name:"VICTORIA REGIONAL WWTP",city:"Victoria",state:"Texas",amount_of_biosolids_generated:1241,amount_of_biosolids_managed_land_applied:0,latitude:28.753601,longitude:-97.006329},{facility_name:"MOUNT LAUREL TWP MUA",city:"Mt Laurel",state:"Neb.",amount_of_biosolids_generated:1240,amount_of_biosolids_managed_land_applied:1239.57,latitude:39.92029,longitude:-74.92752},{facility_name:"TWA - SANDHILL ROAD WWTF",city:"Kissimmee",state:"Fla.",amount_of_biosolids_generated:1235,amount_of_biosolids_managed_land_applied:0,latitude:28.30926015,longitude:-81.42518101},{facility_name:"LAKEVIEW REGIONAL WATER RECLAMATION",city:"Lewisville",state:"Texas",amount_of_biosolids_generated:1235,amount_of_biosolids_managed_land_applied:0,latitude:33.0568,longitude:-96.9872},{facility_name:"MARLBOROUGH EASTERLY WWTF",city:"Marlborough",state:"Mass.",amount_of_biosolids_generated:1234,amount_of_biosolids_managed_land_applied:0,latitude:42.350563,longitude:-71.494881},{facility_name:"ORANGE VIRGINIA,TOWN OF,SEWAGE",city:"Orange",state:"Utah",amount_of_biosolids_generated:1232,amount_of_biosolids_managed_land_applied:0,latitude:38.261,longitude:-78.15161},{facility_name:"LOWER LACKAWANNA VALLEY SAN. A",city:"Duryea",state:"Pa.",amount_of_biosolids_generated:1232,amount_of_biosolids_managed_land_applied:0,latitude:41.348611,longitude:-75.780179},{facility_name:"PROVO CITY CORP",city:"Provo",state:"Utah",amount_of_biosolids_generated:1231,amount_of_biosolids_managed_land_applied:1222,latitude:40.21594,longitude:-111.65257},{facility_name:"CITY OF GREENVILLE WWTP",city:"Greenville",state:"Texas",amount_of_biosolids_generated:1231,amount_of_biosolids_managed_land_applied:0,latitude:33.121111,longitude:-96.075},{facility_name:"NORTHEAST WWTF",city:"Alice",state:"Texas",amount_of_biosolids_generated:1230,amount_of_biosolids_managed_land_applied:0,latitude:27.774472,longitude:-98.037389},{facility_name:"CITY OF BRENHAM WWTP",city:"Brenham",state:"Texas",amount_of_biosolids_generated:1230,amount_of_biosolids_managed_land_applied:1229.6,latitude:30.171694,longitude:-96.378528},{facility_name:"SOUTH TAHOE PUD WWTP",city:"South Lake Tahoe",state:"Calif.",amount_of_biosolids_generated:1227,amount_of_biosolids_managed_land_applied:0,latitude:38.92205,longitude:-119.96947},{facility_name:"LIVERMORE WRP",city:"Livermore",state:"Calif.",amount_of_biosolids_generated:1226,amount_of_biosolids_managed_land_applied:180.8,latitude:37.689444,longitude:-121.8075},{facility_name:"CITY OF CLEARWATER PUBLIC UTILITIES DEPARTMENT",city:"Clearwater",state:"Fla.",amount_of_biosolids_generated:1223,amount_of_biosolids_managed_land_applied:1222.82,latitude:28.02709,longitude:-82.701043},{facility_name:"CHICOPEE W P C F",city:"Chicopee",state:"Mass.",amount_of_biosolids_generated:1222,amount_of_biosolids_managed_land_applied:996.425,latitude:42.15376,longitude:-72.62166},{facility_name:"PIERRE, CITY OF (BIOSOLIDS)",city:"Pierre, City Of",state:"S.D.",amount_of_biosolids_generated:1219,amount_of_biosolids_managed_land_applied:0,latitude:44.350634,longitude:-100.323996},{facility_name:"YAKIMA POTW",city:"Yakima",state:"Wash.",amount_of_biosolids_generated:1218,amount_of_biosolids_managed_land_applied:1218,latitude:46.579403,longitude:-120.46983},{facility_name:"CITY OF SARASOTA",city:"Sarasota",state:"Fla.",amount_of_biosolids_generated:1218,amount_of_biosolids_managed_land_applied:0,latitude:27.347711,longitude:-82.533154},{facility_name:"MISHAWAKA MUNICIPAL WWTP",city:"Mishawaka",state:"Iowa",amount_of_biosolids_generated:1217,amount_of_biosolids_managed_land_applied:736,latitude:41.661584,longitude:-86.164335},{facility_name:"PULASKI STP",city:"Pulaski",state:"Tenn.",amount_of_biosolids_generated:1213,amount_of_biosolids_managed_land_applied:1213.4,latitude:35.183917,longitude:-87.04175},{facility_name:"CHARLOTTE WATER",city:"Charlotte",state:"Mont.",amount_of_biosolids_generated:1212,amount_of_biosolids_managed_land_applied:979,latitude:35.383596,longitude:-80.941433},{facility_name:"PLANTATION REGIONAL WWTP",city:"Plantation",state:"Fla.",amount_of_biosolids_generated:1208,amount_of_biosolids_managed_land_applied:1207.55,latitude:26.13957,longitude:-80.23719},{facility_name:"BOROUGH OF CHAMBERSBURG",city:"Chambersburg",state:"Pa.",amount_of_biosolids_generated:1205,amount_of_biosolids_managed_land_applied:133.91,latitude:39.925278,longitude:-77.674167},{facility_name:"DOWNERS GROVE SD WTC",city:"Downers Grove",state:"Iowa",amount_of_biosolids_generated:1202,amount_of_biosolids_managed_land_applied:1202,latitude:41.794707,longitude:-88.05228},{facility_name:"HAMILTON TWP WPCF",city:"Hamilton",state:"Neb.",amount_of_biosolids_generated:1202,amount_of_biosolids_managed_land_applied:0,latitude:40.183063,longitude:-74.710695},{facility_name:"CONROE SOUTHWEST REGIONAL WWTF",city:"Conroe",state:"Texas",amount_of_biosolids_generated:1199,amount_of_biosolids_managed_land_applied:0,latitude:30.2739,longitude:-95.4919},{facility_name:"GREENSBURG WWTP",city:"Greensburg",state:"Iowa",amount_of_biosolids_generated:1197,amount_of_biosolids_managed_land_applied:1197.21,latitude:39.327555,longitude:-85.485439},{facility_name:"CARMEL WWTP",city:"Indianapolis",state:"Iowa",amount_of_biosolids_generated:1197,amount_of_biosolids_managed_land_applied:0,latitude:39.92896,longitude:-86.07925},{facility_name:"BRENTWOOD WWTF",city:"Brentwood",state:"Calif.",amount_of_biosolids_generated:1196,amount_of_biosolids_managed_land_applied:0,latitude:37.92329701,longitude:-121.6998941},{facility_name:"CITY OF WINTER HAVEN",city:"Winter Haven",state:"Fla.",amount_of_biosolids_generated:1195,amount_of_biosolids_managed_land_applied:0,latitude:27.951798,longitude:-81.7091},{facility_name:"CASPER, CITY OF",city:"Casper",state:"Wyo.",amount_of_biosolids_generated:1195,amount_of_biosolids_managed_land_applied:0,latitude:42.8515,longitude:-106.32662},{facility_name:"CITY OF BROWNWOOD WWTP",city:"Brownwood",state:"Texas",amount_of_biosolids_generated:1189,amount_of_biosolids_managed_land_applied:0,latitude:31.695271,longitude:-98.950093},{facility_name:"EMPORIA, CITY OF",city:"Emporia",state:"Kan.",amount_of_biosolids_generated:1181,amount_of_biosolids_managed_land_applied:1181.4,latitude:38.41229,longitude:-96.21918088},{facility_name:"KILLINGLY",city:"Danielson",state:"Conn.",amount_of_biosolids_generated:1175,amount_of_biosolids_managed_land_applied:0,latitude:38.9011896,longitude:-77.00896},{facility_name:"COPPERAS COVE NORTHWEST WWTP",city:"Copperas Cove",state:"Texas",amount_of_biosolids_generated:1171,amount_of_biosolids_managed_land_applied:0,latitude:31.150473,longitude:-97.90698},{facility_name:"KEENE CITY OF",city:"Swanzey",state:"Neb.",amount_of_biosolids_generated:1171,amount_of_biosolids_managed_land_applied:0,latitude:42.893,longitude:-72.2737},{facility_name:"REWA/GILDER CK WWTP",city:"Simpsonville",state:"S.C.",amount_of_biosolids_generated:1167,amount_of_biosolids_managed_land_applied:1131.91,latitude:34.7897,longitude:-82.1586},{facility_name:"CITY OF DUBUQUE",city:"Dubuque",state:"Hawaii",amount_of_biosolids_generated:1165,amount_of_biosolids_managed_land_applied:438.05,latitude:42.50537,longitude:-90.667775},{facility_name:"JACKSON COUNTY UTILITY AUTHORITY, WEST JACKSON COUNTY POTW",city:"Ocean Springs",state:"Mo.",amount_of_biosolids_generated:1165,amount_of_biosolids_managed_land_applied:1284,latitude:30.364556,longitude:-88.561833},{facility_name:"CHARLOTTE WATER",city:"Charlotte",state:"Mont.",amount_of_biosolids_generated:1164,amount_of_biosolids_managed_land_applied:1164,latitude:35.33441,longitude:-80.696481},{facility_name:"MIRAMAR, CITY OF WWTF",city:"Miramar",state:"Fla.",amount_of_biosolids_generated:1163,amount_of_biosolids_managed_land_applied:1162,latitude:25.99311,longitude:-80.33409},{facility_name:"CLAYTON CO (NORTHEAST WPCP)",city:"Morrow",state:"Ga.",amount_of_biosolids_generated:1160,amount_of_biosolids_managed_land_applied:1147,latitude:33.573489,longitude:-84.262837},{facility_name:"CITY OF ROCKY MOUNT",city:"Rocky Mount",state:"Mont.",amount_of_biosolids_generated:1160,amount_of_biosolids_managed_land_applied:1159.53,latitude:35.991997,longitude:-77.727395},{facility_name:"LONGMONT CITY OF",city:"Longmont",state:"Colo.",amount_of_biosolids_generated:1159,amount_of_biosolids_managed_land_applied:1158.93,latitude:40.14617,longitude:-105.11557},{facility_name:"COLLINSVILLE STP, CITY OF",city:"Collinsville",state:"Iowa",amount_of_biosolids_generated:1159,amount_of_biosolids_managed_land_applied:0,latitude:38.666768,longitude:-90.031345},{facility_name:"CITY OF JOPLIN",city:"Joplin",state:"Mo.",amount_of_biosolids_generated:1156,amount_of_biosolids_managed_land_applied:1156,latitude:37.08525,longitude:-94.51344},{facility_name:"SOUTH MISSION 1 WWTP",city:"Mission",state:"Texas",amount_of_biosolids_generated:1155,amount_of_biosolids_managed_land_applied:0,latitude:26.194333,longitude:-98.331972},{facility_name:"WAILUKU-KAHULUI WASTEWATER RECLAMATION FACILITY",city:"Kahului",state:"Hawaii",amount_of_biosolids_generated:1154,amount_of_biosolids_managed_land_applied:0,latitude:20.898643,longitude:-156.45865},{facility_name:"ROSWELL, NEW MEXICO",city:"Roswell",state:"N.D.",amount_of_biosolids_generated:1152,amount_of_biosolids_managed_land_applied:1152,latitude:33.408732,longitude:-104.489017},{facility_name:"KARLE ENVIRO ORGANIC RECYCLING INC.",city:"Crawfordsville",state:"Iowa",amount_of_biosolids_generated:1150,amount_of_biosolids_managed_land_applied:1150,latitude:40.041822,longitude:-86.890163},{facility_name:"SILVER CITY, TOWN OF",city:"Grant County",state:"N.D.",amount_of_biosolids_generated:1150,amount_of_biosolids_managed_land_applied:0,latitude:32.715976,longitude:-108.248976},{facility_name:"NEW PORT RICHEY CITY OF WWTF",city:"New Port Richey",state:"Fla.",amount_of_biosolids_generated:1148,amount_of_biosolids_managed_land_applied:0,latitude:28.248207,longitude:-82.735459},{facility_name:"PENN TWP BOARD OF COMMISSIONS",city:"Hanover",state:"Pa.",amount_of_biosolids_generated:1147,amount_of_biosolids_managed_land_applied:1147,latitude:39.794095,longitude:-76.968804},{facility_name:"CITY OF BELLAIRE WWTP",city:"Bellaire",state:"Texas",amount_of_biosolids_generated:1141,amount_of_biosolids_managed_land_applied:0,latitude:29.69073,longitude:-95.44921},{facility_name:"MARLEY-TAYLOR WRF",city:"Lexington Park",state:"Mass.",amount_of_biosolids_generated:1141,amount_of_biosolids_managed_land_applied:1141.18,latitude:38.26704,longitude:-76.41166},{facility_name:"LONG BRANCH SA",city:"Long Branch",state:"Neb.",amount_of_biosolids_generated:1139,amount_of_biosolids_managed_land_applied:0,latitude:40.31294,longitude:-73.98603},{facility_name:"GAINESVILLE REGIONAL UTILITIES",city:"Gainesville",state:"Fla.",amount_of_biosolids_generated:1133,amount_of_biosolids_managed_land_applied:0,latitude:29.63392,longitude:-82.32635},{facility_name:"LEOMINSTER W W T P",city:"Leominster",state:"Mass.",amount_of_biosolids_generated:1133,amount_of_biosolids_managed_land_applied:0,latitude:42.521522,longitude:-71.739264},{facility_name:"BOXELDER SANITATION DISTRICT",city:"Fort Collins",state:"Colo.",amount_of_biosolids_generated:1127,amount_of_biosolids_managed_land_applied:782.75,latitude:40.5482164,longitude:-105.0648327},{facility_name:"ALBANY-MILLERSBURG WRF",city:"Albany",state:"Ore.",amount_of_biosolids_generated:1126,amount_of_biosolids_managed_land_applied:139.92,latitude:44.643333,longitude:-123.075278},{facility_name:"GUNTERSVILLE WATER AND SEWER BOARD",city:"Guntersville",state:"Alaska",amount_of_biosolids_generated:1125,amount_of_biosolids_managed_land_applied:1124.73,latitude:34.346335,longitude:-86.286714},{facility_name:"NIAGARA COUNTY SD NO.1",city:"Niagara Falls",state:"N.D.",amount_of_biosolids_generated:1122,amount_of_biosolids_managed_land_applied:0,latitude:43.070086,longitude:-78.922768},{facility_name:"YUBA CITY WWTP",city:"Yuba City",state:"Calif.",amount_of_biosolids_generated:1122,amount_of_biosolids_managed_land_applied:0,latitude:39.1075,longitude:-121.612278},{facility_name:"CHEYENNE BOARD OF PUBLIC UTILITIES",city:"Cheyenne",state:"Wyo.",amount_of_biosolids_generated:1121,amount_of_biosolids_managed_land_applied:1139,latitude:41.126871,longitude:-104.707689},{facility_name:"CITY OF ALBANY",city:"Albany",state:"Ga.",amount_of_biosolids_generated:1118,amount_of_biosolids_managed_land_applied:1118.48,latitude:31.538215,longitude:-84.147694},{facility_name:"MCALLEN SOUTH WWTP",city:"Mcallen",state:"Texas",amount_of_biosolids_generated:1116,amount_of_biosolids_managed_land_applied:0,latitude:26.1975,longitude:-98.2506},{facility_name:"CITY OF SALISBURY",city:"Salisbury",state:"Mont.",amount_of_biosolids_generated:1111,amount_of_biosolids_managed_land_applied:1111,latitude:35.712263,longitude:-80.4318},{facility_name:"CITY OF BOZEMAN",city:"Bozeman",state:"Mont.",amount_of_biosolids_generated:1108,amount_of_biosolids_managed_land_applied:0,latitude:45.723889,longitude:-111.078611},{facility_name:"PARAGOULD, CITY WATER & LIGHT",city:"Paragould",state:"Alaska",amount_of_biosolids_generated:1102,amount_of_biosolids_managed_land_applied:1102,latitude:36.038149,longitude:-90.489826},{facility_name:"CITY OF SANFORD",city:"Sanford",state:"Mont.",amount_of_biosolids_generated:1102,amount_of_biosolids_managed_land_applied:1102,latitude:35.546513,longitude:-79.219919},{facility_name:"PENN RIDGE WASTE WATER TREATME",city:"Sellersville",state:"Pa.",amount_of_biosolids_generated:1102,amount_of_biosolids_managed_land_applied:1006,latitude:40.354176,longitude:-75.312947},{facility_name:"NEBRASKA CITY WWTF",city:"Nebraska City",state:"Neb.",amount_of_biosolids_generated:1102,amount_of_biosolids_managed_land_applied:1101.6,latitude:40.67645,longitude:-95.84609},{facility_name:"INDIAN RIVER COUNTY UTILITIES DEPARTMENT (IRCUD)",city:"Vero Beach",state:"Fla.",amount_of_biosolids_generated:1101,amount_of_biosolids_managed_land_applied:0,latitude:27.58702,longitude:-80.40103},{facility_name:"SALINA, CITY OF",city:"Salina",state:"Kan.",amount_of_biosolids_generated:1098,amount_of_biosolids_managed_land_applied:1098.3,latitude:38.84288199,longitude:-97.60683514},{facility_name:"YORKTOWN WWTP, TOWN OF",city:"Yorktown",state:"Iowa",amount_of_biosolids_generated:1097,amount_of_biosolids_managed_land_applied:0,latitude:40.173944,longitude:-85.503194},{facility_name:"SULPHUR SPRINGS WWTF",city:"Sulphur Springs",state:"Texas",amount_of_biosolids_generated:1086,amount_of_biosolids_managed_land_applied:0,latitude:33.150417,longitude:-95.550417},{facility_name:"NEW ORLEANS PAR-WESTBANK STP",city:"New Orleans",state:"La.",amount_of_biosolids_generated:1086,amount_of_biosolids_managed_land_applied:0,latitude:29.90427,longitude:-89.96483},{facility_name:"SAN CLEMENTE WRP",city:"San Clemente",state:"Calif.",amount_of_biosolids_generated:1083,amount_of_biosolids_managed_land_applied:0,latitude:33.43444,longitude:-117.629167},{facility_name:"WESTMINSTER CITY OF",city:"Westminster",state:"Colo.",amount_of_biosolids_generated:1078,amount_of_biosolids_managed_land_applied:576.3,latitude:39.856598,longitude:-105.069523},{facility_name:"JOLIET WEST STP, CITY OF",city:"Joliet",state:"Iowa",amount_of_biosolids_generated:1076,amount_of_biosolids_managed_land_applied:1076,latitude:41.476105,longitude:-88.167494},{facility_name:"FARIBAULT",city:"Faribault",state:"Minn.",amount_of_biosolids_generated:1074,amount_of_biosolids_managed_land_applied:1074,latitude:44.309722,longitude:-93.266111},{facility_name:"BELTWAY WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:1074,amount_of_biosolids_managed_land_applied:0,latitude:29.70102,longitude:-95.67086},{facility_name:"NEWBURGH (C)",city:"Newburgh",state:"N.D.",amount_of_biosolids_generated:1073,amount_of_biosolids_managed_land_applied:0,latitude:41.49994,longitude:-74.01008},{facility_name:"WATER & WASTEWATER BOARD OF THE CITY OF MADISON",city:"Madison",state:"Alaska",amount_of_biosolids_generated:1072,amount_of_biosolids_managed_land_applied:1072,latitude:34.567014,longitude:-86.75539},{facility_name:"CITY OF ASHEBORO",city:"Asheboro",state:"Mont.",amount_of_biosolids_generated:1072,amount_of_biosolids_managed_land_applied:1071.7,latitude:35.76481,longitude:-79.78735},{facility_name:"OREM CITY CORPORATION",city:"Orem",state:"Utah",amount_of_biosolids_generated:1065,amount_of_biosolids_managed_land_applied:730.84,latitude:40.31477,longitude:-111.71747},{facility_name:"PETALUMA ELLIS CREEK WRF",city:"Petaluma",state:"Calif.",amount_of_biosolids_generated:1055,amount_of_biosolids_managed_land_applied:939,latitude:38.226828,longitude:-122.586829},{facility_name:"LOVELAND CITY OF",city:"Loveland",state:"Colo.",amount_of_biosolids_generated:1055,amount_of_biosolids_managed_land_applied:1054,latitude:40.39536,longitude:-105.11481},{facility_name:"SELMA-KINGSBURG-FOWLER WWTP",city:"Kingsburg",state:"Calif.",amount_of_biosolids_generated:1054,amount_of_biosolids_managed_land_applied:0,latitude:36.52255755,longitude:-119.5642071},{facility_name:"KITSAP COUNTY CENTRAL KITSAP WWTP",city:"Poulsbo",state:"Wash.",amount_of_biosolids_generated:1053,amount_of_biosolids_managed_land_applied:0,latitude:47.67397,longitude:-122.629947},{facility_name:"LOWER STROUBLES CREEK WWTP",city:"Montgomery County",state:"Utah",amount_of_biosolids_generated:1052,amount_of_biosolids_managed_land_applied:0,latitude:37.191389,longitude:-80.519444},{facility_name:"CITY OF COUNCIL BLUFFS",city:"Council Bluffs",state:"Hawaii",amount_of_biosolids_generated:1051,amount_of_biosolids_managed_land_applied:1050.6,latitude:41.15310296,longitude:-95.85879998},{facility_name:"PORTLAND - TRYON CREEK WWTP",city:"Lake Oswego",state:"Ore.",amount_of_biosolids_generated:1050,amount_of_biosolids_managed_land_applied:0,latitude:45.421607,longitude:-122.658561},{facility_name:"LEXINGTON WWTF",city:"Lexington",state:"Neb.",amount_of_biosolids_generated:1049,amount_of_biosolids_managed_land_applied:1049,latitude:40.76545,longitude:-99.7195},{facility_name:"EWING-LAWRENCE SA WTP",city:"Lawrenceville",state:"Neb.",amount_of_biosolids_generated:1049,amount_of_biosolids_managed_land_applied:0,latitude:40.24808,longitude:-74.72687},{facility_name:"NORTH EAST BORO",city:"North East",state:"Pa.",amount_of_biosolids_generated:1048,amount_of_biosolids_managed_land_applied:0,latitude:42.214498,longitude:-79.846626},{facility_name:"ORANGE WATER AND SEWER AUTHORITY",city:"Carrboro",state:"Mont.",amount_of_biosolids_generated:1045,amount_of_biosolids_managed_land_applied:614.7,latitude:35.896449,longitude:-79.025655},{facility_name:"CHICO WQCP",city:"Chico",state:"Calif.",amount_of_biosolids_generated:1035,amount_of_biosolids_managed_land_applied:1200,latitude:39.69961,longitude:-121.91076},{facility_name:"BURLINGTON MAIN WASTEWATER TREATMENT PLANT",city:"Burlington",state:"Va.",amount_of_biosolids_generated:1035,amount_of_biosolids_managed_land_applied:0,latitude:44.472691,longitude:-73.219078},{facility_name:"SU-REGIONAL WWTF PLANT",city:"Houston",state:"Texas",amount_of_biosolids_generated:1032,amount_of_biosolids_managed_land_applied:0,latitude:29.792631,longitude:-95.159911},{facility_name:"BARSTOW WWTF",city:"Barstow",state:"Calif.",amount_of_biosolids_generated:1031,amount_of_biosolids_managed_land_applied:0,latitude:34.89237,longitude:-117.02519},{facility_name:"NEW HOLLAND BORO AUTH",city:"New Holland",state:"Pa.",amount_of_biosolids_generated:1031,amount_of_biosolids_managed_land_applied:1109,latitude:40.0917,longitude:-76.08497},{facility_name:"GRANDVIEW POTW",city:"Grandview",state:"Wash.",amount_of_biosolids_generated:1029,amount_of_biosolids_managed_land_applied:0,latitude:46.211527,longitude:-119.911051},{facility_name:"OLATHE CEDAR CREEK WWTF",city:"Olathe",state:"Kan.",amount_of_biosolids_generated:1028,amount_of_biosolids_managed_land_applied:29.6,latitude:38.88216299,longitude:-94.81818301},{facility_name:"DANVILLE SD",city:"Danville",state:"Iowa",amount_of_biosolids_generated:1027,amount_of_biosolids_managed_land_applied:0,latitude:40.10766,longitude:-87.603386},{facility_name:"CITY OF EASTLAND WWTF",city:"Eastland",state:"Texas",amount_of_biosolids_generated:1026,amount_of_biosolids_managed_land_applied:0,latitude:32.387333,longitude:-98.809778},{facility_name:"HUTCHINSON, CITY OF",city:"Hutchinson",state:"Kan.",amount_of_biosolids_generated:1023,amount_of_biosolids_managed_land_applied:1023.26,latitude:38.07152,longitude:-97.91975},{facility_name:"UPPER MORELAND-HATBORO JOINT",city:"Willow Grove",state:"Pa.",amount_of_biosolids_generated:1023,amount_of_biosolids_managed_land_applied:0,latitude:40.156925,longitude:-75.108025},{facility_name:"FALLS CITY WWTF",city:"Falls City",state:"Neb.",amount_of_biosolids_generated:1019,amount_of_biosolids_managed_land_applied:0,latitude:40.064602,longitude:-95.60855},{facility_name:"LITTLE RIVER WPCP",city:"Evans",state:"Ga.",amount_of_biosolids_generated:1017,amount_of_biosolids_managed_land_applied:1017.32,latitude:33.59227,longitude:-82.139772},{facility_name:"BAMMEL UD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:1017,amount_of_biosolids_managed_land_applied:0,latitude:30.009513,longitude:-95.499569},{facility_name:"TAHOE-TRUCKEE WWTP",city:"Truckee",state:"Calif.",amount_of_biosolids_generated:1016,amount_of_biosolids_managed_land_applied:893.9,latitude:39.337778,longitude:-120.128611},{facility_name:"ORANGETOWN (T)",city:"Orangetown",state:"N.D.",amount_of_biosolids_generated:1010,amount_of_biosolids_managed_land_applied:1010.14,latitude:41.05046503,longitude:-73.97365668},{facility_name:"MOUNT HOLLY WPCF",city:"Mount Holly",state:"Neb.",amount_of_biosolids_generated:1010,amount_of_biosolids_managed_land_applied:1009.79,latitude:39.995507,longitude:-74.797534},{facility_name:"HARPETH VALLEY UTILITY DISTRIC",city:"Nashville",state:"Tenn.",amount_of_biosolids_generated:1009,amount_of_biosolids_managed_land_applied:1008.97,latitude:36.14742,longitude:-86.91265},{facility_name:"ELMWOOD WTP",city:"Marlton",state:"Neb.",amount_of_biosolids_generated:1007,amount_of_biosolids_managed_land_applied:1007,latitude:39.87960532,longitude:-74.90819647},{facility_name:"NEWBERG, CITY OF",city:"Newberg",state:"Ore.",amount_of_biosolids_generated:1007,amount_of_biosolids_managed_land_applied:1007,latitude:45.287342,longitude:-122.953529},{facility_name:"ATHENS UB-OOSTANAULA CREEK STP",city:"Athens",state:"Tenn.",amount_of_biosolids_generated:998,amount_of_biosolids_managed_land_applied:998.1,latitude:35.425833,longitude:-84.589722},{facility_name:"SOUTH CHARLESTON S.T.P.",city:"South Charleston",state:"Wis.",amount_of_biosolids_generated:998,amount_of_biosolids_managed_land_applied:0,latitude:38.36751,longitude:-81.68553},{facility_name:"LODI WHITE SLOUGH WPCF",city:"Lodi",state:"Calif.",amount_of_biosolids_generated:993,amount_of_biosolids_managed_land_applied:993,latitude:38.11634,longitude:-121.28816},{facility_name:"BONNER SPRINGS, CITY OF",city:"Bonner Springs",state:"Kan.",amount_of_biosolids_generated:993,amount_of_biosolids_managed_land_applied:0,latitude:39.08222369,longitude:-94.88133},{facility_name:"CEDAR CITY CORPORATION",city:"Cedar City",state:"Utah",amount_of_biosolids_generated:992,amount_of_biosolids_managed_land_applied:360,latitude:37.810773,longitude:-113.089265},{facility_name:"COLONIE (T)",city:"Newtonville",state:"N.D.",amount_of_biosolids_generated:991,amount_of_biosolids_managed_land_applied:0,latitude:42.751872,longitude:-73.77839671},{facility_name:"RENSSELAER COUNTY SD NO.1",city:"Troy",state:"N.D.",amount_of_biosolids_generated:990,amount_of_biosolids_managed_land_applied:990,latitude:42.759965,longitude:-73.677381},{facility_name:"WILLMAR",city:"Willmar",state:"Minn.",amount_of_biosolids_generated:989,amount_of_biosolids_managed_land_applied:988.95,latitude:45.109,longitude:-95.03521},{facility_name:"LAWRENCE, CITY OF",city:"Lawrence",state:"Kan.",amount_of_biosolids_generated:987,amount_of_biosolids_managed_land_applied:457,latitude:38.98963,longitude:-95.23112002},{facility_name:"SYCAMORE WWTP - MSD",city:"Cincinnati",state:"Ohio",amount_of_biosolids_generated:987,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"PRINCETON WASTEWATER TREATMENT PLANT",city:"Princeton",state:"Iowa",amount_of_biosolids_generated:987,amount_of_biosolids_managed_land_applied:0,latitude:38.3516,longitude:-87.59375},{facility_name:"THREE OAKS WWTF",city:"Fort Myers",state:"Fla.",amount_of_biosolids_generated:986,amount_of_biosolids_managed_land_applied:0,latitude:26.471599,longitude:-81.791771},{facility_name:"NORTHAMPTON P O T W",city:"Northampton",state:"Mass.",amount_of_biosolids_generated:981,amount_of_biosolids_managed_land_applied:0,latitude:42.313056,longitude:-72.623333},{facility_name:"SCHERERVILLE WASTEWATER TREATMENT PLANT",city:"Schererville",state:"Iowa",amount_of_biosolids_generated:981,amount_of_biosolids_managed_land_applied:980.87,latitude:41.500639,longitude:-87.464417},{facility_name:"NAPA SOSCOL WRF",city:"Napa",state:"Calif.",amount_of_biosolids_generated:979,amount_of_biosolids_managed_land_applied:979,latitude:38.302906,longitude:-122.287843},{facility_name:"CITY OF ORMOND BEACH",city:"Ormond Beach",state:"Fla.",amount_of_biosolids_generated:979,amount_of_biosolids_managed_land_applied:0,latitude:29.293611,longitude:-81.083056},{facility_name:"NORTH OF RIVER S. D. I WWTF",city:"Bakersfield",state:"Calif.",amount_of_biosolids_generated:974,amount_of_biosolids_managed_land_applied:974,latitude:35.43194,longitude:-119.02252},{facility_name:"NORTH SAN MATEO COUNTY WWTP",city:"Daly City",state:"Calif.",amount_of_biosolids_generated:973,amount_of_biosolids_managed_land_applied:905.44,latitude:37.703425,longitude:-122.485943},{facility_name:"COLUMBUS WWTP, CITY OF",city:"Columbus",state:"Iowa",amount_of_biosolids_generated:972,amount_of_biosolids_managed_land_applied:913.1,latitude:39.21069,longitude:-85.8897},{facility_name:"INLAND BAYS REGIONAL WASTEWATER FACILITY",city:"Millsboro",state:"D.C.",amount_of_biosolids_generated:972,amount_of_biosolids_managed_land_applied:71.42,latitude:38.63598,longitude:-75.23259},{facility_name:"SEDRON SERVICES SUMNER WASHINGTON - SEPTAGE MANAGEMENT FACILITY",city:"Sumner",state:"Wash.",amount_of_biosolids_generated:971,amount_of_biosolids_managed_land_applied:971,latitude:47.234303,longitude:-122.225967},{facility_name:"NSSD-CLAVEY ROAD STP",city:"Highland Park",state:"Iowa",amount_of_biosolids_generated:971,amount_of_biosolids_managed_land_applied:966,latitude:42.15744,longitude:-87.798256},{facility_name:"CLAREMONT W W T F",city:"Claremont",state:"Neb.",amount_of_biosolids_generated:971,amount_of_biosolids_managed_land_applied:724,latitude:43.38962,longitude:-72.379045},{facility_name:"PASO ROBLES WWTP",city:"Paso Robles",state:"Calif.",amount_of_biosolids_generated:970,amount_of_biosolids_managed_land_applied:0,latitude:35.64468,longitude:-120.68572},{facility_name:"BISMARCK CITY OF",city:"Bismarck",state:"Mont.",amount_of_biosolids_generated:968,amount_of_biosolids_managed_land_applied:968,latitude:46.800694,longitude:-100.794403},{facility_name:"CHEROKEE COUNTY WATER & SEWERAGE AUTHORITY (WSA)",city:"Canton",state:"Ga.",amount_of_biosolids_generated:965,amount_of_biosolids_managed_land_applied:0,latitude:34.136306,longitude:-84.567306},{facility_name:"CITY OF CALHOUN",city:"Calhoun",state:"Ga.",amount_of_biosolids_generated:962,amount_of_biosolids_managed_land_applied:748.75,latitude:34.509692,longitude:-84.962892},{facility_name:"WESTFIELD W P C P",city:"Westfield",state:"Mass.",amount_of_biosolids_generated:962,amount_of_biosolids_managed_land_applied:0,latitude:42.12019,longitude:-72.75452},{facility_name:"WATERTOWN (C)",city:"Watertown",state:"N.D.",amount_of_biosolids_generated:962,amount_of_biosolids_managed_land_applied:961.6,latitude:43.97275,longitude:-75.91118},{facility_name:"ROMEOVILLE WASTEWATER TREATMENT FACILITY",city:"Romeoville",state:"Iowa",amount_of_biosolids_generated:960,amount_of_biosolids_managed_land_applied:960.43,latitude:41.6483,longitude:-88.0764},{facility_name:"PLYMOUTH W W T P",city:"Plymouth",state:"Mass.",amount_of_biosolids_generated:960,amount_of_biosolids_managed_land_applied:0,latitude:41.927406,longitude:-70.643157},{facility_name:"WALNUT BRANCH WWTP",city:"Seguin",state:"Texas",amount_of_biosolids_generated:957,amount_of_biosolids_managed_land_applied:0,latitude:29.56163,longitude:-97.964477},{facility_name:"MANHEIM STP",city:"Lancaster County",state:"Pa.",amount_of_biosolids_generated:956,amount_of_biosolids_managed_land_applied:899.06,latitude:40.1675,longitude:-76.425278},{facility_name:"LEESBURG TOWN - WATER POLLUTION CONTROL DIVISION",city:"Leesburg",state:"Utah",amount_of_biosolids_generated:953,amount_of_biosolids_managed_land_applied:872.08,latitude:39.092486,longitude:-77.530644},{facility_name:"TOPEKA, CITY OF",city:"Topeka",state:"Kan.",amount_of_biosolids_generated:953,amount_of_biosolids_managed_land_applied:677,latitude:39.07127,longitude:-95.6431},{facility_name:"MANHATTAN, CITY OF",city:"Manhattan",state:"Kan.",amount_of_biosolids_generated:951,amount_of_biosolids_managed_land_applied:712.52,latitude:39.17948,longitude:-96.57414},{facility_name:"CITY OF HOUSTON UPPER BRAYS WWTF",city:"Hoston",state:"Texas",amount_of_biosolids_generated:951,amount_of_biosolids_managed_land_applied:0,latitude:29.71676,longitude:-95.5922},{facility_name:"CITY OF EDNA WWTF",city:"Edna",state:"Texas",amount_of_biosolids_generated:950,amount_of_biosolids_managed_land_applied:0,latitude:28.97468,longitude:-96.63059},{facility_name:"TOWN OF FLOWER MOUND WWTP",city:"Flower Mound",state:"Texas",amount_of_biosolids_generated:949,amount_of_biosolids_managed_land_applied:0,latitude:32.996537,longitude:-97.032517},{facility_name:"MELBOURNE, CITY OF",city:"Melbourne",state:"Fla.",amount_of_biosolids_generated:945,amount_of_biosolids_managed_land_applied:945.4,latitude:28.0735,longitude:-80.609827},{facility_name:"NW AR CONSERVATION AUTHORITY",city:"Bentonville",state:"Alaska",amount_of_biosolids_generated:945,amount_of_biosolids_managed_land_applied:0,latitude:36.227482,longitude:-94.288334},{facility_name:"REDLANDS WWTP",city:"Redlands",state:"Calif.",amount_of_biosolids_generated:943,amount_of_biosolids_managed_land_applied:943,latitude:33.98765933,longitude:-117.1462605},{facility_name:"BARNSTABLE WATER POLLUTION CONTROL FACILITY",city:"Barnstable (Hyannis)",state:"Mass.",amount_of_biosolids_generated:942,amount_of_biosolids_managed_land_applied:0,latitude:41.6657,longitude:-70.3043},{facility_name:"FRESHWATER SUPPLY DISTRICT 23",city:"Houston",state:"Texas",amount_of_biosolids_generated:941,amount_of_biosolids_managed_land_applied:0,latitude:29.84417,longitude:-95.27571},{facility_name:"PRASA GUAYAMA REGIONAL WWTP",city:"Guayama",state:"Pa.",amount_of_biosolids_generated:941,amount_of_biosolids_managed_land_applied:0,latitude:18.01019,longitude:-66.62173},{facility_name:"MARYVILLE STP",city:"Maryville",state:"Tenn.",amount_of_biosolids_generated:940,amount_of_biosolids_managed_land_applied:940,latitude:35.8527,longitude:-83.94958},{facility_name:"METROPOLITAN COUNCIL-ST. CROIX",city:"Oak Park Heights",state:"Minn.",amount_of_biosolids_generated:940,amount_of_biosolids_managed_land_applied:0,latitude:45.03849,longitude:-92.79243},{facility_name:"BURTON CREEK WWTP",city:"Bryan",state:"Texas",amount_of_biosolids_generated:939,amount_of_biosolids_managed_land_applied:0,latitude:30.641198,longitude:-96.320498},{facility_name:"WINTER GARDEN, CITY OF",city:"Winter Garden",state:"Fla.",amount_of_biosolids_generated:938,amount_of_biosolids_managed_land_applied:938.3,latitude:28.57782,longitude:-81.581993},{facility_name:"PLUM CREEK WATER RECLAMATION AUTHORITY",city:"Castle Rock",state:"Colo.",amount_of_biosolids_generated:936,amount_of_biosolids_managed_land_applied:0,latitude:39.427006,longitude:-104.904846},{facility_name:"GRANTS PASS, CITY OF",city:"Grants Pass",state:"Ore.",amount_of_biosolids_generated:935,amount_of_biosolids_managed_land_applied:0,latitude:42.429923,longitude:-123.343678},{facility_name:"WILDWOOD/LOWER REGION WTF",city:"Rio Grande",state:"Neb.",amount_of_biosolids_generated:935,amount_of_biosolids_managed_land_applied:0,latitude:39.013371,longitude:-74.87401},{facility_name:"CITY OF SWAINSBORO",city:"Swainsboro",state:"Ga.",amount_of_biosolids_generated:931,amount_of_biosolids_managed_land_applied:0,latitude:32.5869,longitude:-82.31749},{facility_name:"GRETNA, CITY OF",city:"Gretna",state:"La.",amount_of_biosolids_generated:930,amount_of_biosolids_managed_land_applied:0,latitude:29.92986,longitude:-90.04488},{facility_name:"ATHENS-CLARKE COUNTY - CLASSIC CITY COMPOST",city:"Winterville",state:"Ga.",amount_of_biosolids_generated:929,amount_of_biosolids_managed_land_applied:928.68,latitude:33.91754,longitude:-83.27076},{facility_name:"MERCED WWTF",city:"Merced",state:"Calif.",amount_of_biosolids_generated:928,amount_of_biosolids_managed_land_applied:928,latitude:37.30327,longitude:-120.485},{facility_name:"TOWN OF MOORESVILLE",city:"Mooresville",state:"Mont.",amount_of_biosolids_generated:926,amount_of_biosolids_managed_land_applied:926.4,latitude:35.52447,longitude:-80.78004},{facility_name:"CITY OF CLEARWATER PUBLIC UTILITIES DEPT.",city:"Clearwater",state:"Fla.",amount_of_biosolids_generated:926,amount_of_biosolids_managed_land_applied:926.3,latitude:27.98152,longitude:-82.787233},{facility_name:"STP 2A WWTP",city:"Nacogdoches",state:"Texas",amount_of_biosolids_generated:925,amount_of_biosolids_managed_land_applied:0,latitude:31.576391,longitude:-94.645012},{facility_name:"MORGANTOWN, CITY OF",city:"Morgantown",state:"Wis.",amount_of_biosolids_generated:924,amount_of_biosolids_managed_land_applied:924,latitude:39.65563,longitude:-79.991968},{facility_name:"LINCOLN NORTHEAST WWTF",city:"Lincoln",state:"Neb.",amount_of_biosolids_generated:919,amount_of_biosolids_managed_land_applied:2123,latitude:40.88259,longitude:-96.6245},{facility_name:"FLAGG CREEK WRD MCELWAIN STP",city:"Burr Ridge",state:"Iowa",amount_of_biosolids_generated:919,amount_of_biosolids_managed_land_applied:1218,latitude:41.764163,longitude:-87.90667},{facility_name:"BUTTE SILVER BOW CITY AND COUNTY",city:"Butte",state:"Mont.",amount_of_biosolids_generated:918,amount_of_biosolids_managed_land_applied:0,latitude:45.99695,longitude:-112.55362},{facility_name:"PEACH STREET WWTP",city:"Grapevine",state:"Texas",amount_of_biosolids_generated:917,amount_of_biosolids_managed_land_applied:0,latitude:32.94778,longitude:-97.0825},{facility_name:"MARTIN COUNTY TROPICAL FARMS WWTF",city:"Stuart",state:"Fla.",amount_of_biosolids_generated:917,amount_of_biosolids_managed_land_applied:0,latitude:27.132068,longitude:-80.188662},{facility_name:"GOSHEN WWTP",city:"Goshen",state:"Iowa",amount_of_biosolids_generated:917,amount_of_biosolids_managed_land_applied:0,latitude:41.58485,longitude:-85.83298},{facility_name:"SPANISH FORK WASTE WATER TREAT",city:"Spanish Fork",state:"Utah",amount_of_biosolids_generated:915,amount_of_biosolids_managed_land_applied:7.87,latitude:40.13767,longitude:-111.650955},{facility_name:"CITY OF KYLE WWTP",city:"Kyle",state:"Texas",amount_of_biosolids_generated:913,amount_of_biosolids_managed_land_applied:0,latitude:29.968166,longitude:-97.833019},{facility_name:"NORTHEAST WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:912,amount_of_biosolids_managed_land_applied:0,latitude:29.781278,longitude:-95.213028},{facility_name:"LANDIS SEWERAGE AUTHORITY",city:"Vineland",state:"Neb.",amount_of_biosolids_generated:911,amount_of_biosolids_managed_land_applied:911.15,latitude:39.46435,longitude:-75.06325},{facility_name:"LCDPW-NEW CENTURY TOWN STP",city:"Vernon Hills",state:"Iowa",amount_of_biosolids_generated:910,amount_of_biosolids_managed_land_applied:910.4,latitude:42.225556,longitude:-87.947778},{facility_name:"WEST LAFAYETTE WWTP",city:"West Lafayette",state:"Iowa",amount_of_biosolids_generated:910,amount_of_biosolids_managed_land_applied:909.6,latitude:40.4167,longitude:-86.90786},{facility_name:"SPENCER'S CROSSING WWTF",city:"Orange Park",state:"Fla.",amount_of_biosolids_generated:908,amount_of_biosolids_managed_land_applied:903.45,latitude:30.173678,longitude:-81.808133},{facility_name:"HENDERSON SOUTH STP #2",city:"Henderson",state:"Ky.",amount_of_biosolids_generated:908,amount_of_biosolids_managed_land_applied:0,latitude:37.648449,longitude:-87.513177},{facility_name:"PORTSMOUTH-PIERCE CITY OF",city:"Portsmouth",state:"Neb.",amount_of_biosolids_generated:905,amount_of_biosolids_managed_land_applied:0,latitude:43.04657,longitude:-70.77497},{facility_name:"ANACORTES WWTP",city:"Anacortes",state:"Wash.",amount_of_biosolids_generated:904,amount_of_biosolids_managed_land_applied:0,latitude:48.521668,longitude:-122.609444},{facility_name:"BLOOMINGTON S (DILLMAN ROAD)",city:"Bloomington",state:"Iowa",amount_of_biosolids_generated:903,amount_of_biosolids_managed_land_applied:0,latitude:39.09296,longitude:-86.54603},{facility_name:"REDMOND WWTP",city:"Redmond",state:"Ore.",amount_of_biosolids_generated:902,amount_of_biosolids_managed_land_applied:728,latitude:44.303604,longitude:-121.190186},{facility_name:"FLEMING ISLAND REGIONAL WWTF",city:"Orange Park",state:"Fla.",amount_of_biosolids_generated:898,amount_of_biosolids_managed_land_applied:816.85,latitude:30.09204,longitude:-81.71907},{facility_name:"LINDEN ROSELLE SEWAGE AUTH",city:"Linden",state:"Neb.",amount_of_biosolids_generated:896,amount_of_biosolids_managed_land_applied:0,latitude:40.609387,longitude:-74.220417},{facility_name:"CITY OF SANGER WWTP",city:"Sanger",state:"Texas",amount_of_biosolids_generated:894,amount_of_biosolids_managed_land_applied:0,latitude:33.354807,longitude:-97.164411},{facility_name:"SNYDER WATER RECLAMATION PLANT",city:"Snyder",state:"Texas",amount_of_biosolids_generated:893,amount_of_biosolids_managed_land_applied:0,latitude:32.696928,longitude:-100.900824},{facility_name:"ALEXANDRIA LAKE AREA SD",city:"Alexandria",state:"Minn.",amount_of_biosolids_generated:893,amount_of_biosolids_managed_land_applied:893,latitude:45.865566,longitude:-95.408191},{facility_name:"AUSTIN",city:"Austin",state:"Minn.",amount_of_biosolids_generated:892,amount_of_biosolids_managed_land_applied:892,latitude:43.6556,longitude:-92.9736},{facility_name:"STEWART CREEK WWTP",city:"The Colony",state:"Texas",amount_of_biosolids_generated:890,amount_of_biosolids_managed_land_applied:0,latitude:33.104167,longitude:-96.889444},{facility_name:"SHIPPENSBURG BOROUGH AUTHORITY",city:"Shippensburg",state:"Pa.",amount_of_biosolids_generated:889,amount_of_biosolids_managed_land_applied:889.16,latitude:40.05144,longitude:-77.5232},{facility_name:"RARITAN TOWNSHIP STP",city:"Raritan Township",state:"Neb.",amount_of_biosolids_generated:889,amount_of_biosolids_managed_land_applied:0,latitude:40.517687,longitude:-74.805164},{facility_name:"MIDDLETOWN (C)",city:"Middletown",state:"N.D.",amount_of_biosolids_generated:887,amount_of_biosolids_managed_land_applied:0,latitude:41.44568,longitude:-74.4214},{facility_name:"WESTCHESTER CO DEPT ENV FAC",city:"New Rochelle",state:"N.D.",amount_of_biosolids_generated:887,amount_of_biosolids_managed_land_applied:0,latitude:40.91181,longitude:-73.7826},{facility_name:"LITTLE FALLS RUN",city:"Stafford",state:"Utah",amount_of_biosolids_generated:881,amount_of_biosolids_managed_land_applied:850.56,latitude:38.26138,longitude:-77.41134},{facility_name:"WALNUT CREEK WRF LAS",city:"Mcdonough",state:"Ga.",amount_of_biosolids_generated:881,amount_of_biosolids_managed_land_applied:0,latitude:33.481641,longitude:-84.036573},{facility_name:"CAMARILLO WRP",city:"Camarillo",state:"Calif.",amount_of_biosolids_generated:876,amount_of_biosolids_managed_land_applied:0,latitude:34.22221216,longitude:-119.0419942},{facility_name:"WEST KNOX UD (WKUD) - MELTON HILL POTW",city:"Knoxville",state:"Tenn.",amount_of_biosolids_generated:875,amount_of_biosolids_managed_land_applied:0,latitude:35.8925,longitude:-84.2439},{facility_name:"HANFORD WWTF",city:"Hanford",state:"Calif.",amount_of_biosolids_generated:875,amount_of_biosolids_managed_land_applied:875,latitude:36.31032628,longitude:-119.64597},{facility_name:"CITY OF HACKBERRY WWTP",city:"Frisco",state:"Texas",amount_of_biosolids_generated:874,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"SUMTER/POCOTALIGO RIVER PLANT",city:"Sumter",state:"S.C.",amount_of_biosolids_generated:873,amount_of_biosolids_managed_land_applied:0,latitude:33.849722,longitude:-80.315556},{facility_name:"CITY OF FORT DODGE",city:"Fort Dodge",state:"Hawaii",amount_of_biosolids_generated:873,amount_of_biosolids_managed_land_applied:924,latitude:42.504117,longitude:-94.186968},{facility_name:"CITY OF PHARR WWTP",city:"Pharr",state:"Texas",amount_of_biosolids_generated:872,amount_of_biosolids_managed_land_applied:871.57,latitude:26.163722,longitude:-98.172278},{facility_name:"PRASA MAYAGUEZ R W W T P",city:"Mayaguez",state:"Pa.",amount_of_biosolids_generated:869,amount_of_biosolids_managed_land_applied:869.15,latitude:18.19836159,longitude:-67.12626216},{facility_name:"HARRISON CO WASTEWATER & SWMA, GULFPORT POTW, NORTH",city:"Gulfport",state:"Mo.",amount_of_biosolids_generated:869,amount_of_biosolids_managed_land_applied:869,latitude:30.43804,longitude:-89.056898},{facility_name:"BLACKHAWK REGIONAL WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:868,amount_of_biosolids_managed_land_applied:0,latitude:29.80027,longitude:-95.34098},{facility_name:"TOWN OF BOONE",city:"Boone",state:"Mont.",amount_of_biosolids_generated:866,amount_of_biosolids_managed_land_applied:866,latitude:36.213425,longitude:-81.646171},{facility_name:"DARTMOUTH W P C F",city:"South Dartmouth",state:"Mass.",amount_of_biosolids_generated:865,amount_of_biosolids_managed_land_applied:900,latitude:41.58867,longitude:-70.98878},{facility_name:"SEYMOUR WWTP, CITY OF",city:"Seymour",state:"Iowa",amount_of_biosolids_generated:865,amount_of_biosolids_managed_land_applied:0,latitude:38.96012,longitude:-85.89074},{facility_name:"LITCHFIELD",city:"Litchfield",state:"Minn.",amount_of_biosolids_generated:864,amount_of_biosolids_managed_land_applied:863.6,latitude:45.11562,longitude:-94.52364},{facility_name:"LAKOTA WWTP",city:"Federal Way",state:"Wash.",amount_of_biosolids_generated:863,amount_of_biosolids_managed_land_applied:862.9,latitude:47.327338,longitude:-122.372195},{facility_name:"HEARD FARMS INC.",city:"Roseburg",state:"Ore.",amount_of_biosolids_generated:858,amount_of_biosolids_managed_land_applied:858.4,latitude:43.342048,longitude:-123.339764},{facility_name:"SOUTH WINDSOR WPCF",city:"South Windsor",state:"Conn.",amount_of_biosolids_generated:858,amount_of_biosolids_managed_land_applied:0,latitude:41.8288,longitude:-72.55427},{facility_name:"CRYSTAL LAKE STP #2, CITY OF",city:"Crystal Lake",state:"Iowa",amount_of_biosolids_generated:857,amount_of_biosolids_managed_land_applied:857,latitude:42.211464,longitude:-88.33589},{facility_name:"CITY OF ST. PETERS",city:"St. Peters",state:"Mo.",amount_of_biosolids_generated:857,amount_of_biosolids_managed_land_applied:856.59,latitude:38.80337,longitude:-90.611358},{facility_name:"SUSSEX CNTY MUA U WALLKILL FAC",city:"Hardyston Twp",state:"Neb.",amount_of_biosolids_generated:856,amount_of_biosolids_managed_land_applied:0,latitude:41.0786548,longitude:-74.52532051},{facility_name:"MADISONVILLE STP WEST SIDE",city:"Madisonville",state:"Ky.",amount_of_biosolids_generated:854,amount_of_biosolids_managed_land_applied:0,latitude:37.318493,longitude:-87.549857},{facility_name:"FREEDOM DISTRICT WWTP",city:"Millersville",state:"Mass.",amount_of_biosolids_generated:854,amount_of_biosolids_managed_land_applied:852.2,latitude:39.092174,longitude:-76.631072},{facility_name:"CLAYTON COUNTY",city:"Morrow",state:"Ga.",amount_of_biosolids_generated:848,amount_of_biosolids_managed_land_applied:785,latitude:33.41082,longitude:-84.38307},{facility_name:"CARSON CITY WRF",city:"Carson City",state:"N.D.",amount_of_biosolids_generated:848,amount_of_biosolids_managed_land_applied:0,latitude:39.161649,longitude:-119.733367},{facility_name:"CLOVIS, CITY OF",city:"Unknown",state:"N.D.",amount_of_biosolids_generated:847,amount_of_biosolids_managed_land_applied:847,latitude:34.5729841,longitude:-103.3460546},{facility_name:"METROPOLITAN COUNCIL-HASTINGS",city:"Hastings",state:"Minn.",amount_of_biosolids_generated:846,amount_of_biosolids_managed_land_applied:0,latitude:44.702313,longitude:-92.86325814},{facility_name:"MANATEE COUNTY NORTH REGIONAL WRF",city:"Bradenton",state:"Fla.",amount_of_biosolids_generated:843,amount_of_biosolids_managed_land_applied:0,latitude:27.579722,longitude:-82.478333},{facility_name:"EASTHAVEN WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:841,amount_of_biosolids_managed_land_applied:0,latitude:29.64322,longitude:-95.26425},{facility_name:"MOUNT VERNON MUNICIPAL WWTP",city:"Mount Vernon",state:"Iowa",amount_of_biosolids_generated:840,amount_of_biosolids_managed_land_applied:0,latitude:37.924083,longitude:-87.910639},{facility_name:"WARMINSTER TOWNSHIP M.A. TRM P",city:"Warminster",state:"Pa.",amount_of_biosolids_generated:838,amount_of_biosolids_managed_land_applied:838.1,latitude:40.216954,longitude:-75.074051},{facility_name:"AMHERST W W T P",city:"Hadley",state:"Mass.",amount_of_biosolids_generated:838,amount_of_biosolids_managed_land_applied:0,latitude:42.385276,longitude:-72.536249},{facility_name:"POLK RUN WWTP - MSD",city:"Cincinnati",state:"Ohio",amount_of_biosolids_generated:837,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"AMSTERDAM (C)",city:"Amsterdam",state:"N.D.",amount_of_biosolids_generated:836,amount_of_biosolids_managed_land_applied:0,latitude:42.97044,longitude:-74.14898},{facility_name:"COLUMBUS WWTF",city:"Columbus",state:"Neb.",amount_of_biosolids_generated:835,amount_of_biosolids_managed_land_applied:835.3,latitude:41.424627,longitude:-97.344444},{facility_name:"VAN BUREN, CITY OF-MAIN PLANT",city:"Van Buren",state:"Alaska",amount_of_biosolids_generated:835,amount_of_biosolids_managed_land_applied:1352.6,latitude:35.417722,longitude:-94.340889},{facility_name:"CITY OF BEND WATER RECLAMATION FACILITY",city:"Bend",state:"Ore.",amount_of_biosolids_generated:835,amount_of_biosolids_managed_land_applied:835,latitude:44.118071,longitude:-121.211439},{facility_name:"PRASA ARECIBO RWWTP",city:"Santurce",state:"Pa.",amount_of_biosolids_generated:833,amount_of_biosolids_managed_land_applied:833,latitude:18.480556,longitude:-66.677694},{facility_name:"GROVE CITY BOROUGH WWP",city:"Grove City",state:"Pa.",amount_of_biosolids_generated:833,amount_of_biosolids_managed_land_applied:0,latitude:41.144861,longitude:-80.096639},{facility_name:"CITY OF FLORENCE WATER/WASTEWATER DEPARTMENT",city:"Florence",state:"Alaska",amount_of_biosolids_generated:832,amount_of_biosolids_managed_land_applied:832.12,latitude:34.783884,longitude:-87.701497},{facility_name:"MISSOURI CITY REGIONAL SURFACE WWTP",city:"Missouri City",state:"Texas",amount_of_biosolids_generated:832,amount_of_biosolids_managed_land_applied:0,latitude:29.507777,longitude:-95.5475},{facility_name:"ALLEGHENY VALLEY JOINT SEWER A",city:"Cheswick",state:"Pa.",amount_of_biosolids_generated:831,amount_of_biosolids_managed_land_applied:0,latitude:40.530346,longitude:-79.84755},{facility_name:"DECATUR, CITY OF",city:"Decatur",state:"Alaska",amount_of_biosolids_generated:830,amount_of_biosolids_managed_land_applied:830.14,latitude:36.344139,longitude:-94.472694},{facility_name:"VALLEY SANITARY DISTRICT WWTF",city:"Indio",state:"Calif.",amount_of_biosolids_generated:830,amount_of_biosolids_managed_land_applied:830,latitude:33.715278,longitude:-116.196944},{facility_name:"HURRICANE CREEK WWTP",city:"Lufkin",state:"Texas",amount_of_biosolids_generated:827,amount_of_biosolids_managed_land_applied:0,latitude:31.286,longitude:-94.7494},{facility_name:"MOORHEAD",city:"Moorhead",state:"Minn.",amount_of_biosolids_generated:827,amount_of_biosolids_managed_land_applied:854,latitude:46.905067,longitude:-96.749179},{facility_name:"WATSONVILLE WWTP",city:"Watsonville",state:"Calif.",amount_of_biosolids_generated:826,amount_of_biosolids_managed_land_applied:188.59,latitude:36.88302688,longitude:-121.7147818},{facility_name:"POUGHKEEPSIE (C)",city:"Poughkeepsie",state:"N.D.",amount_of_biosolids_generated:823,amount_of_biosolids_managed_land_applied:0,latitude:41.70632,longitude:-73.928},{facility_name:"WEATHERFORD FACILITY",city:"Weatherford",state:"Texas",amount_of_biosolids_generated:821,amount_of_biosolids_managed_land_applied:0,latitude:32.747651,longitude:-97.769409},{facility_name:"METROPOLITAN SAINT LOUIS SEWER DISTRICT",city:"St. Louis",state:"Mo.",amount_of_biosolids_generated:821,amount_of_biosolids_managed_land_applied:0,latitude:38.63107,longitude:-90.21532},{facility_name:"LITTLE FALLS (C)",city:"Little Falls",state:"N.D.",amount_of_biosolids_generated:820,amount_of_biosolids_managed_land_applied:819.8,latitude:43.02828967,longitude:-74.86896673},{facility_name:"GREENWOOD/WILSON CREEK WWTF",city:"Greenwood",state:"S.C.",amount_of_biosolids_generated:819,amount_of_biosolids_managed_land_applied:0,latitude:34.208056,longitude:-82.059444},{facility_name:"CITY OF DOTHAN",city:"Dothan",state:"Alaska",amount_of_biosolids_generated:817,amount_of_biosolids_managed_land_applied:0,latitude:31.2533,longitude:-85.5043},{facility_name:"MIDDLETOWN SEWERAGE AUTHORITY",city:"Belford",state:"Neb.",amount_of_biosolids_generated:815,amount_of_biosolids_managed_land_applied:0,latitude:40.42622,longitude:-74.08296},{facility_name:"YUCAIPA VALLEY HENRY N. WOCHHOLZ WWTP",city:"Yucaipa",state:"Calif.",amount_of_biosolids_generated:815,amount_of_biosolids_managed_land_applied:0,latitude:34.052356,longitude:-116.987612},{facility_name:"TELL CITY MUNICIPAL WWTP",city:"Tell City",state:"Iowa",amount_of_biosolids_generated:815,amount_of_biosolids_managed_land_applied:0,latitude:37.957278,longitude:-86.774667},{facility_name:"SOUTH DEARBORN R.S.D.",city:"Lawrenceburg",state:"Iowa",amount_of_biosolids_generated:814,amount_of_biosolids_managed_land_applied:0,latitude:39.074917,longitude:-84.870528},{facility_name:"WEBSTER (T)",city:"Webster",state:"N.D.",amount_of_biosolids_generated:812,amount_of_biosolids_managed_land_applied:0,latitude:43.26009,longitude:-77.41995},{facility_name:"CAPE MAY COUNTY MUA",city:"Cape May Ct House",state:"Neb.",amount_of_biosolids_generated:812,amount_of_biosolids_managed_land_applied:0,latitude:39.107891,longitude:-74.793248},{facility_name:"NORTH MUSTANG ISLAND WWTP",city:"Port Aransas",state:"Texas",amount_of_biosolids_generated:811,amount_of_biosolids_managed_land_applied:0,latitude:27.827097,longitude:-97.079288},{facility_name:"GARDNER W P C F",city:"East Templeton",state:"Mass.",amount_of_biosolids_generated:811,amount_of_biosolids_managed_land_applied:0,latitude:42.5698,longitude:-72.0201},{facility_name:"BELL COUNTY WCID 1 WWTP",city:"Killeen",state:"Texas",amount_of_biosolids_generated:810,amount_of_biosolids_managed_land_applied:0,latitude:31.125444,longitude:-97.515556},{facility_name:"CHELFORD CITY REGIONAL WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:809,amount_of_biosolids_managed_land_applied:0,latitude:29.710068,longitude:-95.651953},{facility_name:"HAVERSTRAW JOINT REGIONAL SB",city:"West Haverstraw",state:"N.D.",amount_of_biosolids_generated:808,amount_of_biosolids_managed_land_applied:808,latitude:41.2135,longitude:-73.963556},{facility_name:"CITY OF CUMMING",city:"Cumming",state:"Ga.",amount_of_biosolids_generated:807,amount_of_biosolids_managed_land_applied:0,latitude:34.196083,longitude:-84.186556},{facility_name:"DAVIS WWTP",city:"Davis",state:"Calif.",amount_of_biosolids_generated:802,amount_of_biosolids_managed_land_applied:0,latitude:38.548744,longitude:-121.731047},{facility_name:"PARKERSBURG_UTILITY BOARD",city:"Parkersburg",state:"Wis.",amount_of_biosolids_generated:802,amount_of_biosolids_managed_land_applied:407.72,latitude:39.28069,longitude:-81.55706},{facility_name:"PHILLIPSBURG TOWN STP",city:"Phillipsburg",state:"Neb.",amount_of_biosolids_generated:801,amount_of_biosolids_managed_land_applied:0,latitude:40.680599,longitude:-75.177009},{facility_name:"MACON WATER AUTHORITY",city:"Macon",state:"Ga.",amount_of_biosolids_generated:798,amount_of_biosolids_managed_land_applied:626.15,latitude:32.811708,longitude:-83.603778},{facility_name:"SOUTH PORTLAND CITY OF",city:"South Portland",state:"Mass.",amount_of_biosolids_generated:797,amount_of_biosolids_managed_land_applied:0,latitude:43.63888,longitude:-70.25646},{facility_name:"CITY OF KATY WWTP",city:"Katy",state:"Texas",amount_of_biosolids_generated:796,amount_of_biosolids_managed_land_applied:763.85,latitude:29.773302,longitude:-95.82699},{facility_name:"LAKE IN THE HILLS SD STP",city:"Lake In The Hills",state:"Iowa",amount_of_biosolids_generated:793,amount_of_biosolids_managed_land_applied:792.64,latitude:42.18956,longitude:-88.31591},{facility_name:"CVWD WRP 4 MID VALLEY",city:"Coachella",state:"Calif.",amount_of_biosolids_generated:790,amount_of_biosolids_managed_land_applied:0,latitude:33.685745,longitude:-116.1675911},{facility_name:"SPRINGFIELD MSD-SUGAR CRK STP",city:"Springfield",state:"Iowa",amount_of_biosolids_generated:786,amount_of_biosolids_managed_land_applied:0,latitude:39.80263,longitude:-89.53013},{facility_name:"CITY OF NEWTON",city:"Newton",state:"Mont.",amount_of_biosolids_generated:784,amount_of_biosolids_managed_land_applied:784,latitude:35.627833,longitude:-81.233983},{facility_name:"MARGATE,CITY OF WEST WWTP",city:"Margate",state:"Fla.",amount_of_biosolids_generated:783,amount_of_biosolids_managed_land_applied:783.01,latitude:26.2413,longitude:-80.21507},{facility_name:"CITY OF SHINER WWTP",city:"Shiner",state:"Texas",amount_of_biosolids_generated:782,amount_of_biosolids_managed_land_applied:0,latitude:29.41689,longitude:-97.16336},{facility_name:"LACKAWANNA RIVER BASIN SEWER A",city:"Dickson City",state:"Pa.",amount_of_biosolids_generated:782,amount_of_biosolids_managed_land_applied:270.88,latitude:41.4494,longitude:-75.63191},{facility_name:"LAKE CHARLES, CITY OF (PLANT C",city:"Lake Charles",state:"La.",amount_of_biosolids_generated:778,amount_of_biosolids_managed_land_applied:0,latitude:30.205556,longitude:-93.240278},{facility_name:"SUSANVILLE WWTP",city:"Susanville",state:"Calif.",amount_of_biosolids_generated:777,amount_of_biosolids_managed_land_applied:0,latitude:40.40144724,longitude:-120.6490004},{facility_name:"HUNTINGTON (T)",city:"Huntington",state:"N.D.",amount_of_biosolids_generated:777,amount_of_biosolids_managed_land_applied:0,latitude:40.87437,longitude:-73.41957},{facility_name:"MOUNT JOY BOROUGH AUTHORITY",city:"Mount Joy",state:"Pa.",amount_of_biosolids_generated:773,amount_of_biosolids_managed_land_applied:773.11,latitude:40.099167,longitude:-76.493611},{facility_name:"SAN ELIJO WRF",city:"Cardiff By The Sea",state:"Calif.",amount_of_biosolids_generated:773,amount_of_biosolids_managed_land_applied:604,latitude:33.02187514,longitude:-117.272529},{facility_name:"MASSENA (V)",city:"Massena",state:"N.D.",amount_of_biosolids_generated:773,amount_of_biosolids_managed_land_applied:772.59,latitude:44.93132,longitude:-74.89284},{facility_name:"GSW&SA/GEORGE R VEREEN WWTP",city:"Longs",state:"S.C.",amount_of_biosolids_generated:771,amount_of_biosolids_managed_land_applied:771,latitude:33.841111,longitude:-78.726111},{facility_name:"MCMINNVILLE, CITY OF",city:"Mcminnville",state:"Ore.",amount_of_biosolids_generated:771,amount_of_biosolids_managed_land_applied:427.5,latitude:45.222715,longitude:-123.159066},{facility_name:"KIHEI WASTEWATER RECLAMATION FACILITY",city:"Kihei",state:"Hawaii",amount_of_biosolids_generated:768,amount_of_biosolids_managed_land_applied:0,latitude:20.73541,longitude:-156.444449},{facility_name:"EAST BANK WWTP",city:"Center",state:"Texas",amount_of_biosolids_generated:768,amount_of_biosolids_managed_land_applied:0,latitude:31.738899,longitude:-94.160247},{facility_name:"PORTAGE UTILITY SERVICE FACILITY WWTP",city:"Portage",state:"Iowa",amount_of_biosolids_generated:765,amount_of_biosolids_managed_land_applied:765.06,latitude:41.600028,longitude:-87.202556},{facility_name:"CULPEPER TOWN OF-WWTREAT PLANT",city:"Culpeper",state:"Utah",amount_of_biosolids_generated:765,amount_of_biosolids_managed_land_applied:571,latitude:38.481944,longitude:-78.009722},{facility_name:"NOVATO WWTP",city:"Novato",state:"Calif.",amount_of_biosolids_generated:762,amount_of_biosolids_managed_land_applied:0,latitude:38.10034,longitude:-122.55484},{facility_name:"EAST WINDSOR WATER POL CON PLT",city:"East Windsor",state:"Neb.",amount_of_biosolids_generated:759,amount_of_biosolids_managed_land_applied:0,latitude:40.28677,longitude:-74.56165},{facility_name:"MOUNTAIN CREEK REG WWTF",city:"Arlington",state:"Texas",amount_of_biosolids_generated:756,amount_of_biosolids_managed_land_applied:0,latitude:32.501222,longitude:-97.019722},{facility_name:"CITY OF GLOUCESTER",city:"Gloucester",state:"Mass.",amount_of_biosolids_generated:756,amount_of_biosolids_managed_land_applied:0,latitude:42.61493,longitude:-70.66332},{facility_name:"RUSSELLVILLE, CITY CORPORATION",city:"Russellville",state:"Alaska",amount_of_biosolids_generated:755,amount_of_biosolids_managed_land_applied:755.26,latitude:35.247222,longitude:-93.1125},{facility_name:"FAULKEY GULLY MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:754,amount_of_biosolids_managed_land_applied:754.44,latitude:29.998556,longitude:-95.606083},{facility_name:"RED OAK CREEK REGIONAL WWTP",city:"Arlington",state:"Texas",amount_of_biosolids_generated:754,amount_of_biosolids_managed_land_applied:0,latitude:32.531881,longitude:-96.82636},{facility_name:"MARTINEZ II WWTP",city:"San Antonio",state:"Texas",amount_of_biosolids_generated:753,amount_of_biosolids_managed_land_applied:16630,latitude:29.299155,longitude:-94.82871},{facility_name:"CEDAR CREEK WQTC MSD",city:"Louisville",state:"Ky.",amount_of_biosolids_generated:752,amount_of_biosolids_managed_land_applied:0,latitude:38.122354,longitude:-85.587648},{facility_name:"FARMINGTON, CITY OF (WWTP)",city:"Farmington",state:"N.D.",amount_of_biosolids_generated:752,amount_of_biosolids_managed_land_applied:122,latitude:36.71727,longitude:-108.21725},{facility_name:"QUEEN ANNE'S CO. SANITARY DIST",city:"Stevensville",state:"Mass.",amount_of_biosolids_generated:751,amount_of_biosolids_managed_land_applied:466,latitude:38.985232,longitude:-76.320238},{facility_name:"LANCASTER CO/INDIANLAND WWTP",city:"Lancaster",state:"S.C.",amount_of_biosolids_generated:751,amount_of_biosolids_managed_land_applied:239,latitude:34.700836,longitude:-80.75382},{facility_name:"VENICE, CITY OF",city:"Venice",state:"Fla.",amount_of_biosolids_generated:751,amount_of_biosolids_managed_land_applied:0,latitude:27.13236,longitude:-82.401388},{facility_name:"CHESTER STP",city:"Chester",state:"Iowa",amount_of_biosolids_generated:750,amount_of_biosolids_managed_land_applied:0,latitude:37.8875,longitude:-89.788333},{facility_name:"ST. CHARLES PARISH COUNCIL",city:"Hahnville",state:"La.",amount_of_biosolids_generated:748,amount_of_biosolids_managed_land_applied:0,latitude:29.968853,longitude:-90.427595},{facility_name:"MILLVILLE NJ SEWER UTILITY",city:"Millville",state:"Neb.",amount_of_biosolids_generated:748,amount_of_biosolids_managed_land_applied:121.24,latitude:39.3830396,longitude:-75.04103705},{facility_name:"SOUTH HADLEY WWTP",city:"Chicopee",state:"Mass.",amount_of_biosolids_generated:746,amount_of_biosolids_managed_land_applied:0,latitude:42.205371,longitude:-72.58814},{facility_name:"CITY OF NAPLES PUBLIC WORKS UTILITIES DIVISION",city:"Naples",state:"Fla.",amount_of_biosolids_generated:745,amount_of_biosolids_managed_land_applied:0,latitude:26.151903,longitude:-81.78819},{facility_name:"SAN LUIS OBISPO WRF",city:"San Luis Obispo",state:"Calif.",amount_of_biosolids_generated:744,amount_of_biosolids_managed_land_applied:0,latitude:35.25615,longitude:-120.67291},{facility_name:"DUCKETT CREEK SANITARY DISTRICT",city:"O'Fallon",state:"Mo.",amount_of_biosolids_generated:739,amount_of_biosolids_managed_land_applied:739,latitude:38.74857648,longitude:-90.73337783},{facility_name:"MFN REGIONAL WASTEWATER DIST",city:"Norton",state:"Mass.",amount_of_biosolids_generated:738,amount_of_biosolids_managed_land_applied:0,latitude:41.952198,longitude:-71.061965},{facility_name:"KELLOGG CREEK WWTP",city:"Milwaukie",state:"Ore.",amount_of_biosolids_generated:738,amount_of_biosolids_managed_land_applied:566,latitude:45.440114,longitude:-122.642494},{facility_name:"BUFFALO CREEK WWTP",city:"Wylie",state:"Texas",amount_of_biosolids_generated:734,amount_of_biosolids_managed_land_applied:0,latitude:32.877384,longitude:-96.458098},{facility_name:"MUNDELEIN STP, VILLAGE OF",city:"Libertyville",state:"Iowa",amount_of_biosolids_generated:733,amount_of_biosolids_managed_land_applied:733,latitude:42.25471,longitude:-87.947295},{facility_name:"O'FALLON STP, CITY OF",city:"O'Fallon",state:"Iowa",amount_of_biosolids_generated:732,amount_of_biosolids_managed_land_applied:732.1,latitude:38.5627,longitude:-89.85086},{facility_name:"MARYLAND CTY WATER RECLAMATION",city:"Laurel",state:"Mass.",amount_of_biosolids_generated:730,amount_of_biosolids_managed_land_applied:729.7,latitude:39.081927,longitude:-76.826856},{facility_name:"HERKIMER CO SD",city:"Mohawk",state:"N.D.",amount_of_biosolids_generated:730,amount_of_biosolids_managed_land_applied:729.67,latitude:43.01003,longitude:-75.01303},{facility_name:"DCSD, DUCKETT CREEK DST",city:"O'Fallon",state:"Mo.",amount_of_biosolids_generated:729,amount_of_biosolids_managed_land_applied:729,latitude:38.73030275,longitude:-90.63413552},{facility_name:"HAYS CO WCID 1 WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:728,amount_of_biosolids_managed_land_applied:727.8,latitude:30.20295,longitude:-97.983802},{facility_name:"LEE COUNTY UTILITIES",city:"Fort Myers",state:"Fla.",amount_of_biosolids_generated:727,amount_of_biosolids_managed_land_applied:0,latitude:26.541003,longitude:-81.904221},{facility_name:"CITY OF MARSHALLTOWN WATER POLLUTION CONTROL PLANT",city:"Marshalltown",state:"Hawaii",amount_of_biosolids_generated:725,amount_of_biosolids_managed_land_applied:725.2,latitude:42.064822,longitude:-92.899547},{facility_name:"GRUENE ROAD WATER RECLAMATION FACILITY",city:"New Braunfels",state:"Texas",amount_of_biosolids_generated:725,amount_of_biosolids_managed_land_applied:0,latitude:29.737999,longitude:-98.106237},{facility_name:"RIVERBEND REG WATER RECLAMATION FACILITY",city:"Lewisville",state:"Texas",amount_of_biosolids_generated:724,amount_of_biosolids_managed_land_applied:0,latitude:33.228611,longitude:-96.937278},{facility_name:"PORT WASHINGTON WPCD",city:"Port Washington",state:"N.D.",amount_of_biosolids_generated:722,amount_of_biosolids_managed_land_applied:0,latitude:40.83944,longitude:-73.69721},{facility_name:"CITY OF FLORESVILLE WWTP",city:"Floresville",state:"Texas",amount_of_biosolids_generated:721,amount_of_biosolids_managed_land_applied:0,latitude:29.128833,longitude:-98.173083},{facility_name:"NEWPORT, CITY OF",city:"Newport",state:"Ore.",amount_of_biosolids_generated:719,amount_of_biosolids_managed_land_applied:717.32,latitude:44.59777,longitude:-124.04844},{facility_name:"TJOELKER ENTERPRISES INC.",city:"Blaine",state:"Wash.",amount_of_biosolids_generated:719,amount_of_biosolids_managed_land_applied:691.8,latitude:48.98737,longitude:-122.550649},{facility_name:"NASSAU COUNTY",city:"Westbury",state:"N.D.",amount_of_biosolids_generated:718,amount_of_biosolids_managed_land_applied:0,latitude:40.76431,longitude:-73.55276},{facility_name:"BERGEN CNTY WTP",city:"Edgewater",state:"Neb.",amount_of_biosolids_generated:718,amount_of_biosolids_managed_land_applied:0,latitude:40.84642,longitude:-74.03902},{facility_name:"CITY OF LAMESA WWTP",city:"Lamesa",state:"Texas",amount_of_biosolids_generated:717,amount_of_biosolids_managed_land_applied:0,latitude:32.711944,longitude:-101.946111},{facility_name:"DAYTON SOUTHWEST WWTF",city:"Dayton",state:"Texas",amount_of_biosolids_generated:715,amount_of_biosolids_managed_land_applied:0,latitude:30.035708,longitude:-94.896241},{facility_name:"MAGNA WATER & SEWER DIST",city:"Magna",state:"Utah",amount_of_biosolids_generated:715,amount_of_biosolids_managed_land_applied:0,latitude:40.727863,longitude:-112.073997},{facility_name:"SANFORD, CITY OF",city:"Sanford",state:"Fla.",amount_of_biosolids_generated:715,amount_of_biosolids_managed_land_applied:0,latitude:28.81617,longitude:-81.27911},{facility_name:"BELL COUNTY WCID 3 WWTP",city:"Nolanville",state:"Texas",amount_of_biosolids_generated:713,amount_of_biosolids_managed_land_applied:0,latitude:31.069227,longitude:-97.605361},{facility_name:"MWRDGC HANOVER PARK WRP",city:"Hanover Park",state:"Iowa",amount_of_biosolids_generated:710,amount_of_biosolids_managed_land_applied:1805,latitude:42.000228,longitude:-88.13813},{facility_name:"CAPE FEAR PUBLIC UTILITY AUTHORITY",city:"Wilmington",state:"Mont.",amount_of_biosolids_generated:709,amount_of_biosolids_managed_land_applied:0,latitude:34.164483,longitude:-77.945016},{facility_name:"SUNRISE NO 1 WWTP (SPRINGTREE)",city:"Sunrise",state:"Fla.",amount_of_biosolids_generated:709,amount_of_biosolids_managed_land_applied:0,latitude:26.17732,longitude:-80.26371},{facility_name:"SECAUCUS TOWN OF",city:"Secaucus",state:"Neb.",amount_of_biosolids_generated:707,amount_of_biosolids_managed_land_applied:0,latitude:40.798406,longitude:-74.047585},{facility_name:"WORTHINGTON INDUSTRIAL",city:"Worthington",state:"Minn.",amount_of_biosolids_generated:704,amount_of_biosolids_managed_land_applied:704.03,latitude:43.62415813,longitude:-95.60625681},{facility_name:"DESTIN WATER USERS, INC.",city:"Destin",state:"Fla.",amount_of_biosolids_generated:703,amount_of_biosolids_managed_land_applied:703.47,latitude:30.393056,longitude:-86.445},{facility_name:"HAMPTON W W T P",city:"Hampton",state:"Neb.",amount_of_biosolids_generated:703,amount_of_biosolids_managed_land_applied:0,latitude:42.925,longitude:-70.81998},{facility_name:"TWA/CAMELOT S/D WWTF",city:"Kissimmee",state:"Fla.",amount_of_biosolids_generated:702,amount_of_biosolids_managed_land_applied:0,latitude:28.31835,longitude:-81.49642},{facility_name:"ESPANOLA, CITY OF",city:"Espanola",state:"N.D.",amount_of_biosolids_generated:700,amount_of_biosolids_managed_land_applied:0,latitude:35.998662,longitude:-106.077829},{facility_name:"DENZIL BOWMAN WASTEWATER",city:"Greeneville",state:"Tenn.",amount_of_biosolids_generated:699,amount_of_biosolids_managed_land_applied:698.94,latitude:36.10841,longitude:-82.83705},{facility_name:"FRANKFORT MUNICIPAL STP",city:"Frankfort",state:"Ky.",amount_of_biosolids_generated:699,amount_of_biosolids_managed_land_applied:0,latitude:38.213957,longitude:-84.873705},{facility_name:"WESTMINISTER WWTP",city:"Westminister",state:"Mass.",amount_of_biosolids_generated:699,amount_of_biosolids_managed_land_applied:0,latitude:39.559167,longitude:-77.039444},{facility_name:"ARAPAHOE COUNTY WATER AND WASTEWATER AUTHORITY",city:"Centennial",state:"Colo.",amount_of_biosolids_generated:697,amount_of_biosolids_managed_land_applied:7.32,latitude:39.60144,longitude:-104.83735},{facility_name:"GLEAMLOCK FARMS WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:697,amount_of_biosolids_managed_land_applied:696.65,latitude:30.039344,longitude:-95.567021},{facility_name:"CITY OF KEARNEY",city:"Kearney",state:"Mo.",amount_of_biosolids_generated:695,amount_of_biosolids_managed_land_applied:695.49,latitude:39.37327639,longitude:-94.37872823},{facility_name:"HONOLULU KAILUA WWTP",city:"Kapolei",state:"Hawaii",amount_of_biosolids_generated:694,amount_of_biosolids_managed_land_applied:0,latitude:21.33003,longitude:-158.08158},{facility_name:"RICHLAND POTW",city:"Richland",state:"Wash.",amount_of_biosolids_generated:694,amount_of_biosolids_managed_land_applied:929,latitude:46.255717,longitude:-119.275617},{facility_name:"GILLETTE, CITY OF",city:"Gillette",state:"Wyo.",amount_of_biosolids_generated:692,amount_of_biosolids_managed_land_applied:692,latitude:44.27246,longitude:-105.50751},{facility_name:"BREMERTON STP",city:"Bremerton",state:"Wash.",amount_of_biosolids_generated:691,amount_of_biosolids_managed_land_applied:691.2,latitude:47.550825,longitude:-122.672186},{facility_name:"LAHAINA WASTEWATER RECLAMATION FACILITY",city:"Lahaina",state:"Hawaii",amount_of_biosolids_generated:690,amount_of_biosolids_managed_land_applied:0,latitude:20.948889,longitude:-156.69},{facility_name:"JACKSONVILLE WATER WORKS GAS AND SEWER BD",city:"Jacksonville",state:"Alaska",amount_of_biosolids_generated:690,amount_of_biosolids_managed_land_applied:0,latitude:33.8139,longitude:-85.7641},{facility_name:"HARRISON CO UTILITY AUTHORITY, WEST BILOXI POTW",city:"Biloxi",state:"Mo.",amount_of_biosolids_generated:688,amount_of_biosolids_managed_land_applied:688,latitude:30.407105,longitude:-88.968923},{facility_name:"NORTH ATTLEBOROUGH W W T P",city:"North Attleborough",state:"Mass.",amount_of_biosolids_generated:688,amount_of_biosolids_managed_land_applied:0,latitude:41.96089,longitude:-71.30695},{facility_name:"DOVER CITY OF WWTP",city:"Dover",state:"Neb.",amount_of_biosolids_generated:688,amount_of_biosolids_managed_land_applied:0,latitude:43.19353,longitude:-70.87427},{facility_name:"FALL CREEK REG. WASTE DIST.",city:"Pendleton",state:"Iowa",amount_of_biosolids_generated:688,amount_of_biosolids_managed_land_applied:1533,latitude:39.968,longitude:-85.795306},{facility_name:"SIMSBURY",city:"Simsbury",state:"Conn.",amount_of_biosolids_generated:685,amount_of_biosolids_managed_land_applied:0,latitude:41.870817,longitude:-72.797855},{facility_name:"ADDISON NORTH STP, VILLAGE OF",city:"Addison",state:"Iowa",amount_of_biosolids_generated:685,amount_of_biosolids_managed_land_applied:684.52,latitude:41.940474,longitude:-87.988669},{facility_name:"VA AMERICAN WATER PWWW - PLANT 8",city:"Woodbridge",state:"Utah",amount_of_biosolids_generated:684,amount_of_biosolids_managed_land_applied:684.44,latitude:38.646133,longitude:-77.34706},{facility_name:"TOWN OF SOUTH KINGSTOWN",city:"Wakefield",state:"R.I.",amount_of_biosolids_generated:684,amount_of_biosolids_managed_land_applied:0,latitude:41.4417,longitude:-71.50229},{facility_name:"LIBERTY WASTEWATER TREATMENT PLANT",city:"Liberty",state:"Mo.",amount_of_biosolids_generated:684,amount_of_biosolids_managed_land_applied:683.55,latitude:39.197004,longitude:-94.436847},{facility_name:"NORTHGLENN CITY OF",city:"Northglenn",state:"Colo.",amount_of_biosolids_generated:682,amount_of_biosolids_managed_land_applied:682.48,latitude:39.90925,longitude:-104.98698},{facility_name:"COOKEVILLE STP",city:"Cookeville",state:"Tenn.",amount_of_biosolids_generated:681,amount_of_biosolids_managed_land_applied:681,latitude:36.10828,longitude:-85.50571},{facility_name:"UPPER BLUE SANITATION DISTRICT",city:"Breckenridge",state:"Colo.",amount_of_biosolids_generated:681,amount_of_biosolids_managed_land_applied:0,latitude:39.5002267,longitude:-106.0430996},{facility_name:"THE WOODLANDS WWTF 1",city:"The Woodlands",state:"Texas",amount_of_biosolids_generated:679,amount_of_biosolids_managed_land_applied:0,latitude:30.195784,longitude:-95.491353},{facility_name:"LAFAYETTE CONSOLDATED GOVERNMENT - AMBASSADOR CAFFERY TREATMENT PLANT",city:"Lafayette",state:"La.",amount_of_biosolids_generated:679,amount_of_biosolids_managed_land_applied:678.8,latitude:30.16397,longitude:-92.05742},{facility_name:"LAGUNA CSD WRF",city:"Santa Maria",state:"Calif.",amount_of_biosolids_generated:678,amount_of_biosolids_managed_land_applied:0,latitude:34.88673,longitude:-120.4323636},{facility_name:"GROTON WPCF TOWN OF",city:"Groton",state:"Conn.",amount_of_biosolids_generated:678,amount_of_biosolids_managed_land_applied:0,latitude:41.33687,longitude:-72.02011},{facility_name:"FAIRFIELD WPCF",city:"Fairfield",state:"Conn.",amount_of_biosolids_generated:677,amount_of_biosolids_managed_land_applied:677,latitude:41.126264,longitude:-73.245169},{facility_name:"JAMESTOWN (C) BOARD OF PUB UTILITIES",city:"Jamestown",state:"N.D.",amount_of_biosolids_generated:677,amount_of_biosolids_managed_land_applied:0,latitude:42.092795,longitude:-79.246809},{facility_name:"CAPE GIRARDEAU MUNICIPAL WWTF",city:"Cape Girardeau",state:"Mo.",amount_of_biosolids_generated:675,amount_of_biosolids_managed_land_applied:675.41,latitude:37.283209,longitude:-89.523128},{facility_name:"HOOSAC WPCF",city:"Williamstown",state:"Mass.",amount_of_biosolids_generated:675,amount_of_biosolids_managed_land_applied:253,latitude:42.729594,longitude:-73.211578},{facility_name:"BETHLEHEM (T)",city:"Delmar",state:"N.D.",amount_of_biosolids_generated:674,amount_of_biosolids_managed_land_applied:0,latitude:42.61984,longitude:-73.83941},{facility_name:"CARPENTERSVILLE MAIN STP",city:"Carpentersville",state:"Iowa",amount_of_biosolids_generated:673,amount_of_biosolids_managed_land_applied:673.3,latitude:42.112764,longitude:-88.276137},{facility_name:"CITY OF LEBANON AUTHORITY WAST",city:"Lebanon County",state:"Pa.",amount_of_biosolids_generated:671,amount_of_biosolids_managed_land_applied:670.6,latitude:40.337513,longitude:-76.462151},{facility_name:"LITTLE CEDAR BAYOU WWTP",city:"La Porte",state:"Texas",amount_of_biosolids_generated:670,amount_of_biosolids_managed_land_applied:0,latitude:29.64986,longitude:-95.023159},{facility_name:"MARSHALL",city:"Marshall",state:"Minn.",amount_of_biosolids_generated:669,amount_of_biosolids_managed_land_applied:669.49,latitude:44.47032,longitude:-95.79095},{facility_name:"HAINES CITY WWTP",city:"Haines City",state:"Fla.",amount_of_biosolids_generated:668,amount_of_biosolids_managed_land_applied:667.5,latitude:28.11409,longitude:-81.59733},{facility_name:"TRI-MUNICIPAL SEWER COMMISSION",city:"Wappingers Falls",state:"N.D.",amount_of_biosolids_generated:667,amount_of_biosolids_managed_land_applied:667,latitude:41.57922678,longitude:-73.89654178},{facility_name:"HARRIS COUNTY WCID 47 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:667,amount_of_biosolids_managed_land_applied:0,latitude:29.648856,longitude:-95.22301},{facility_name:"SAUGERTIES (V)",city:"Saugerties",state:"N.D.",amount_of_biosolids_generated:665,amount_of_biosolids_managed_land_applied:0,latitude:42.07862,longitude:-73.95274},{facility_name:"ELKTON WASTERWATER TREATMENT",city:"Elkton",state:"Mass.",amount_of_biosolids_generated:664,amount_of_biosolids_managed_land_applied:664,latitude:39.601223,longitude:-75.833827},{facility_name:"SABINE CREEK REGIONAL WWTP",city:"Wylie",state:"Texas",amount_of_biosolids_generated:664,amount_of_biosolids_managed_land_applied:0,latitude:33.02323,longitude:-96.55079},{facility_name:"SHERIDAN, CITY OF",city:"Sheridan",state:"Wyo.",amount_of_biosolids_generated:663,amount_of_biosolids_managed_land_applied:0,latitude:44.823028,longitude:-106.973958},{facility_name:"NYCDEP - ROCKAWAY WRRF",city:"Far Rockaway",state:"N.D.",amount_of_biosolids_generated:663,amount_of_biosolids_managed_land_applied:0,latitude:40.57704854,longitude:-73.84957394},{facility_name:"CITY OF KALISPELL",city:"Kalispell",state:"Mont.",amount_of_biosolids_generated:662,amount_of_biosolids_managed_land_applied:0,latitude:48.19567685,longitude:-114.3143636},{facility_name:"LOCKHART WWTP 2",city:"Lockhart",state:"Texas",amount_of_biosolids_generated:660,amount_of_biosolids_managed_land_applied:0,latitude:29.870517,longitude:-97.626062},{facility_name:"SWATARA TOWNSHIP AUTHORITY",city:"Dauphin County",state:"Pa.",amount_of_biosolids_generated:659,amount_of_biosolids_managed_land_applied:0,latitude:40.24679,longitude:-76.81103},{facility_name:"CITY OF NAVASOTA OLD WWTP",city:"Navasota",state:"Texas",amount_of_biosolids_generated:658,amount_of_biosolids_managed_land_applied:0,latitude:30.383528,longitude:-96.101056},{facility_name:"HOBBS, CITY OF",city:"Hobbs",state:"N.D.",amount_of_biosolids_generated:658,amount_of_biosolids_managed_land_applied:380.75,latitude:32.7008,longitude:-103.13496},{facility_name:"LOGAN TOWNSHIP MUA",city:"Logan Twp",state:"Neb.",amount_of_biosolids_generated:657,amount_of_biosolids_managed_land_applied:0,latitude:39.787893,longitude:-75.377619},{facility_name:"FORT BEND CO MUD 25",city:"Sugar Land",state:"Texas",amount_of_biosolids_generated:656,amount_of_biosolids_managed_land_applied:0,latitude:29.634639,longitude:-95.673194},{facility_name:"MOORPARK WWTP",city:"Moorpark",state:"Calif.",amount_of_biosolids_generated:656,amount_of_biosolids_managed_land_applied:0,latitude:34.28850368,longitude:-118.8867736},{facility_name:"PADUCAH/MCCRACKEN COUNTY JSA - PADUCAH",city:"Paducah",state:"Ky.",amount_of_biosolids_generated:655,amount_of_biosolids_managed_land_applied:271,latitude:37.09754,longitude:-88.61633},{facility_name:"GREATER AUGUSTA UTILITY DISTRICT",city:"Augusta",state:"Mass.",amount_of_biosolids_generated:655,amount_of_biosolids_managed_land_applied:0,latitude:44.30205,longitude:-69.77938},{facility_name:"KC TODD CREEK WWTP",city:"Kansas City",state:"Mo.",amount_of_biosolids_generated:654,amount_of_biosolids_managed_land_applied:0,latitude:39.35422,longitude:-94.66539},{facility_name:"SOUTHSIDE WWTF",city:"Mount Pleasant",state:"Texas",amount_of_biosolids_generated:653,amount_of_biosolids_managed_land_applied:0,latitude:33.102651,longitude:-94.95301},{facility_name:"ASHLEY VALLEY WATER REC. FACIL",city:"Vernal",state:"Utah",amount_of_biosolids_generated:653,amount_of_biosolids_managed_land_applied:0,latitude:40.40494,longitude:-109.48549},{facility_name:"SOUTHEAST WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:652,amount_of_biosolids_managed_land_applied:0,latitude:29.608399,longitude:-95.241125},{facility_name:"EL DORADO DEER CREEK WWTP",city:"Placerville",state:"Calif.",amount_of_biosolids_generated:652,amount_of_biosolids_managed_land_applied:651.7,latitude:38.73444,longitude:-120.7868},{facility_name:"JASPER WATERWORKS & SEWER BOARD, INC.",city:"Jasper",state:"Alaska",amount_of_biosolids_generated:651,amount_of_biosolids_managed_land_applied:433.1,latitude:33.812359,longitude:-87.268471},{facility_name:"EAGLE RIVER WATER & SAN DIST",city:"Vail",state:"Colo.",amount_of_biosolids_generated:649,amount_of_biosolids_managed_land_applied:499,latitude:39.64159,longitude:-106.39398},{facility_name:"VA AMERICAN WATER PWWW - PLANT 1",city:"Woodbridge",state:"Utah",amount_of_biosolids_generated:649,amount_of_biosolids_managed_land_applied:646.11,latitude:38.62768,longitude:-77.31043},{facility_name:"DOUGLASVILLE-DOUGLAS CO (WSA) SWEETWATER CR",city:"Douglasville",state:"Ga.",amount_of_biosolids_generated:648,amount_of_biosolids_managed_land_applied:648.1,latitude:33.702553,longitude:-84.629156},{facility_name:"UNION CITY WWTP",city:"Union City",state:"Iowa",amount_of_biosolids_generated:648,amount_of_biosolids_managed_land_applied:0,latitude:40.19831,longitude:-84.8079},{facility_name:"WEST WWTP",city:"Cleveland",state:"Texas",amount_of_biosolids_generated:648,amount_of_biosolids_managed_land_applied:0,latitude:30.336,longitude:-95.095389},{facility_name:"WEST GOSHEN SEWAGE TREATMENT P",city:"West Chester",state:"Pa.",amount_of_biosolids_generated:646,amount_of_biosolids_managed_land_applied:0,latitude:39.94748,longitude:-75.57307},{facility_name:"JUNCTION CITY, CITY OF",city:"Junction City",state:"Kan.",amount_of_biosolids_generated:645,amount_of_biosolids_managed_land_applied:645,latitude:38.9921,longitude:-96.8658},{facility_name:"OCALA WRF #2",city:"Ocala",state:"Fla.",amount_of_biosolids_generated:645,amount_of_biosolids_managed_land_applied:0,latitude:29.163056,longitude:-82.0775},{facility_name:"VILLAGE OF WELLINGTON WWTP",city:"Wellington",state:"Fla.",amount_of_biosolids_generated:644,amount_of_biosolids_managed_land_applied:644.07,latitude:26.6367,longitude:-80.23406},{facility_name:"CITY OF MONROE",city:"Monroe",state:"Mont.",amount_of_biosolids_generated:643,amount_of_biosolids_managed_land_applied:642.56,latitude:34.995555,longitude:-80.49},{facility_name:"CRANBERRY TOWNSHIP M.S.A.",city:"Cranberry Township",state:"Pa.",amount_of_biosolids_generated:640,amount_of_biosolids_managed_land_applied:0,latitude:40.708391,longitude:-80.141948},{facility_name:"FARMINGTON WPCF",city:"Farmington",state:"Conn.",amount_of_biosolids_generated:639,amount_of_biosolids_managed_land_applied:0,latitude:41.74841,longitude:-72.86852},{facility_name:"MERCEDES WASTE WATER TREATMENT FACILITY",city:"Mercedes",state:"Texas",amount_of_biosolids_generated:639,amount_of_biosolids_managed_land_applied:638.6,latitude:26.170779,longitude:-97.902503},{facility_name:"EDWARDSVILLE STP, CITY OF",city:"Edwardsville",state:"Iowa",amount_of_biosolids_generated:637,amount_of_biosolids_managed_land_applied:637.4852,latitude:38.784167,longitude:-90.036389},{facility_name:"CITY OF DUNEDIN",city:"Dunedin",state:"Fla.",amount_of_biosolids_generated:636,amount_of_biosolids_managed_land_applied:636.13,latitude:28.019444,longitude:-82.785833},{facility_name:"KINGWOOD CENTRAL WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:636,amount_of_biosolids_managed_land_applied:0,latitude:30.04514,longitude:-95.1908},{facility_name:"WIDEFIELD WATER AND SANITATION DISTRICT",city:"Colorado Springs",state:"Colo.",amount_of_biosolids_generated:635,amount_of_biosolids_managed_land_applied:0,latitude:38.73748,longitude:-104.67377},{facility_name:"BOROUGH OF ELIZABETHTOWN",city:"Elizabethtown",state:"Pa.",amount_of_biosolids_generated:631,amount_of_biosolids_managed_land_applied:0,latitude:40.1458,longitude:-76.59932},{facility_name:"MARION WWTP, CITY OF",city:"Marion",state:"Iowa",amount_of_biosolids_generated:630,amount_of_biosolids_managed_land_applied:630,latitude:40.580028,longitude:-85.659806},{facility_name:"SNYDERVILLE BASIN SID (E CNYN)",city:"Park City",state:"Utah",amount_of_biosolids_generated:630,amount_of_biosolids_managed_land_applied:0,latitude:40.756884,longitude:-111.564117},{facility_name:"DOUGLASVILLE - DOUGLAS COUNTY WATER AND SEWER AUTHORITY",city:"Douglasville",state:"Ga.",amount_of_biosolids_generated:629,amount_of_biosolids_managed_land_applied:190.81,latitude:33.646607,longitude:-84.753021},{facility_name:"GLASTONBURY WPCF",city:"Glastonbury",state:"Conn.",amount_of_biosolids_generated:629,amount_of_biosolids_managed_land_applied:0,latitude:41.70699,longitude:-72.60808},{facility_name:"POST OAK WWTP",city:"Sherman",state:"Texas",amount_of_biosolids_generated:629,amount_of_biosolids_managed_land_applied:0,latitude:33.601523,longitude:-96.573894},{facility_name:"SPRINGFIELD STP",city:"Springfield",state:"Tenn.",amount_of_biosolids_generated:629,amount_of_biosolids_managed_land_applied:153.04,latitude:36.506156,longitude:-86.941666},{facility_name:"CITY OF FREDERICKSBURG WWTF",city:"Fredericksburg",state:"Utah",amount_of_biosolids_generated:628,amount_of_biosolids_managed_land_applied:0,latitude:38.288972,longitude:-77.451111},{facility_name:"PACE WATER SYSTEM, INC. & PACE PROPERTY FINANCE AUTHORITY",city:"Pace",state:"Fla.",amount_of_biosolids_generated:625,amount_of_biosolids_managed_land_applied:625.21,latitude:30.595833,longitude:-87.1825},{facility_name:"SOUTHWEST REGIONAL WWTP",city:"Bartow",state:"Fla.",amount_of_biosolids_generated:625,amount_of_biosolids_managed_land_applied:0,latitude:27.894946,longitude:-81.84235},{facility_name:"PRASA SANTA ISABEL",city:"Santa Isabel",state:"Pa.",amount_of_biosolids_generated:623,amount_of_biosolids_managed_land_applied:0,latitude:17.96829836,longitude:-66.405249},{facility_name:"SOUTH DAVIS SEWER DISTRICT-SOUTH PLANT",city:"North Salt Lake",state:"Utah",amount_of_biosolids_generated:621,amount_of_biosolids_managed_land_applied:0,latitude:40.843362,longitude:-111.948244},{facility_name:"CVWD WRP 7 IMP. DIST. 58",city:"Coachella",state:"Calif.",amount_of_biosolids_generated:620,amount_of_biosolids_managed_land_applied:0,latitude:33.685745,longitude:-116.1675911},{facility_name:"MILLER STREET WWTF",city:"Orange Park",state:"Fla.",amount_of_biosolids_generated:619,amount_of_biosolids_managed_land_applied:619.34,latitude:30.11458,longitude:-81.8158},{facility_name:"BELL CO WCID 1 WWTP 3",city:"Killeen",state:"Texas",amount_of_biosolids_generated:619,amount_of_biosolids_managed_land_applied:618.536877,latitude:31.069556,longitude:-97.608167},{facility_name:"LAWRENCE, CITY OF WAKARUSA FACILITY",city:"Lawrence",state:"Kan.",amount_of_biosolids_generated:616,amount_of_biosolids_managed_land_applied:384,latitude:39.01115,longitude:-95.21658},{facility_name:"OTSEGO EAST",city:"Rogers",state:"Minn.",amount_of_biosolids_generated:616,amount_of_biosolids_managed_land_applied:615.87,latitude:45.232112,longitude:-93.536775},{facility_name:"IRONHOUSE SANITARY DISTRICT WWTP",city:"Oakley",state:"Calif.",amount_of_biosolids_generated:613,amount_of_biosolids_managed_land_applied:613.29,latitude:37.99783,longitude:-121.70746},{facility_name:"CITY OF HARKER HEIGHTS WWTP",city:"Harker Heights",state:"Texas",amount_of_biosolids_generated:613,amount_of_biosolids_managed_land_applied:612.6,latitude:31.08153,longitude:-97.66964},{facility_name:"NORTH PLATTE WWTF",city:"North Platte",state:"Neb.",amount_of_biosolids_generated:612,amount_of_biosolids_managed_land_applied:612,latitude:41.12595,longitude:-100.724},{facility_name:"NEW BROADWAY WWTF",city:"Corpus Christi",state:"Texas",amount_of_biosolids_generated:612,amount_of_biosolids_managed_land_applied:0,latitude:27.80288,longitude:-97.40103},{facility_name:"ROXBURY TOWNSHIP OF",city:"Succasunna",state:"Neb.",amount_of_biosolids_generated:611,amount_of_biosolids_managed_land_applied:0,latitude:40.8415,longitude:-74.6423},{facility_name:"BREMEN WWTP",city:"Bremen",state:"Iowa",amount_of_biosolids_generated:610,amount_of_biosolids_managed_land_applied:0,latitude:41.451333,longitude:-86.171167},{facility_name:"ATWATER, CITY OF",city:"Atwater",state:"Calif.",amount_of_biosolids_generated:609,amount_of_biosolids_managed_land_applied:859,latitude:37.33852672,longitude:-120.6274009},{facility_name:"MARLBOROUGH WESTERLY W W T P",city:"Marlborough",state:"Mass.",amount_of_biosolids_generated:607,amount_of_biosolids_managed_land_applied:0,latitude:42.336794,longitude:-71.603678},{facility_name:"AMS CENTRAL RMF",city:"Terra Ceia",state:"Fla.",amount_of_biosolids_generated:607,amount_of_biosolids_managed_land_applied:606.7,latitude:27.57930927,longitude:-82.58096029},{facility_name:"CHT RESOURCES - LANDFILL AND COMPOSTING",city:"Austin",state:"Colo.",amount_of_biosolids_generated:606,amount_of_biosolids_managed_land_applied:606,latitude:38.833751,longitude:-108.036578},{facility_name:"TRENTON SEWER UTILITY",city:"Trenton",state:"Neb.",amount_of_biosolids_generated:605,amount_of_biosolids_managed_land_applied:0,latitude:40.175727,longitude:-74.726642},{facility_name:"COHANSEY RIVER BASIN STP",city:"Bridgeton",state:"Neb.",amount_of_biosolids_generated:605,amount_of_biosolids_managed_land_applied:83.2,latitude:39.417809,longitude:-75.234049},{facility_name:"CORTLAND (C)",city:"Cortland",state:"N.D.",amount_of_biosolids_generated:604,amount_of_biosolids_managed_land_applied:0,latitude:42.59939,longitude:-76.17837},{facility_name:"UPPER ALLEGHENY STP",city:"Tarentum",state:"Pa.",amount_of_biosolids_generated:603,amount_of_biosolids_managed_land_applied:0,latitude:40.602,longitude:-79.75293},{facility_name:"CITY OF ORANGE BEACH",city:"Orange Beach",state:"Alaska",amount_of_biosolids_generated:602,amount_of_biosolids_managed_land_applied:602.15,latitude:30.290833,longitude:-87.638611},{facility_name:"VILLAGE OF FRANKFORT - REGIONAL WWTP",city:"Frankfort",state:"Iowa",amount_of_biosolids_generated:601,amount_of_biosolids_managed_land_applied:601.481,latitude:41.51764,longitude:-87.84977},{facility_name:"CANANDAIGUA (C)",city:"Canandaigua",state:"N.D.",amount_of_biosolids_generated:599,amount_of_biosolids_managed_land_applied:0,latitude:42.87829155,longitude:-77.291205},{facility_name:"NEW FREEDOM STP",city:"New Freedom",state:"Pa.",amount_of_biosolids_generated:598,amount_of_biosolids_managed_land_applied:598.43,latitude:39.762924,longitude:-76.702228},{facility_name:"ADELANTO WWTF",city:"Adelanto",state:"Calif.",amount_of_biosolids_generated:598,amount_of_biosolids_managed_land_applied:0,latitude:34.58278,longitude:-117.40806},{facility_name:"UNIFIED GOVERNMENT OF ATHENS-CLARKE COUNTY",city:"Unknown",state:"Ga.",amount_of_biosolids_generated:598,amount_of_biosolids_managed_land_applied:597.65,latitude:33.909028,longitude:-83.392117},{facility_name:"GWA NORTHERN DISTRICT WWTP",city:"Mangilao",state:"Ga.",amount_of_biosolids_generated:597,amount_of_biosolids_managed_land_applied:0,latitude:13.4382999,longitude:144.7729285},{facility_name:"LOCKPORT (C)",city:"Lockport",state:"N.D.",amount_of_biosolids_generated:597,amount_of_biosolids_managed_land_applied:596.9,latitude:43.16909,longitude:-78.69585},{facility_name:"BLOOMINGTON N (BLUCHER POOLE)",city:"Bloomington",state:"Iowa",amount_of_biosolids_generated:596,amount_of_biosolids_managed_land_applied:0,latitude:39.246889,longitude:-86.548583},{facility_name:"GREER/MAPLE CREEK PLANT",city:"Greer",state:"S.C.",amount_of_biosolids_generated:595,amount_of_biosolids_managed_land_applied:0,latitude:34.93058,longitude:-82.18497},{facility_name:"ST VRAIN SANITATION DISTRICT",city:"Firestone",state:"Colo.",amount_of_biosolids_generated:594,amount_of_biosolids_managed_land_applied:544.7,latitude:40.16511,longitude:-104.9763},{facility_name:"FMC WWTF",city:"Spotsylvania",state:"Utah",amount_of_biosolids_generated:594,amount_of_biosolids_managed_land_applied:593.87,latitude:38.32405,longitude:-77.4772},{facility_name:"ALDERWOOD STP",city:"Lynnwood",state:"Wash.",amount_of_biosolids_generated:592,amount_of_biosolids_managed_land_applied:592.36,latitude:47.878689,longitude:-122.319149},{facility_name:"BARDSTOWN TOWN CREEK WWTP",city:"Bardstown",state:"Ky.",amount_of_biosolids_generated:591,amount_of_biosolids_managed_land_applied:0,latitude:37.81175,longitude:-85.469615},{facility_name:"PRASA AGUADILLA RWWTP",city:"Santurce",state:"Pa.",amount_of_biosolids_generated:591,amount_of_biosolids_managed_land_applied:590.93,latitude:18.388802,longitude:-67.178826},{facility_name:"POUGHKEEPSIE (T)",city:"Poughkeepsie",state:"N.D.",amount_of_biosolids_generated:590,amount_of_biosolids_managed_land_applied:590.2,latitude:41.69302,longitude:-73.88883},{facility_name:"NISKAYUNA (T)",city:"Schenectady",state:"N.D.",amount_of_biosolids_generated:590,amount_of_biosolids_managed_land_applied:590.06,latitude:42.81924,longitude:-73.88623},{facility_name:"PARSONS, CITY OF",city:"Parsons",state:"Kan.",amount_of_biosolids_generated:590,amount_of_biosolids_managed_land_applied:589.61,latitude:37.339167,longitude:-95.269722},{facility_name:"CITY OF EAGLE GROVE",city:"Eagle Grove",state:"Hawaii",amount_of_biosolids_generated:589,amount_of_biosolids_managed_land_applied:589.35,latitude:42.66626199,longitude:-93.90580569},{facility_name:"QUAKERTOWN WWTP",city:"Quakertown",state:"Pa.",amount_of_biosolids_generated:589,amount_of_biosolids_managed_land_applied:281.8,latitude:40.442508,longitude:-75.318502},{facility_name:"CITY OF BLUE SPRINGS",city:"Blue Springs",state:"Mo.",amount_of_biosolids_generated:588,amount_of_biosolids_managed_land_applied:0,latitude:39.03073524,longitude:-94.31036368},{facility_name:"THE WOODLANDS WWTP 2",city:"The Woodlands",state:"Texas",amount_of_biosolids_generated:586,amount_of_biosolids_managed_land_applied:0,latitude:30.195278,longitude:-95.488778},{facility_name:"BLACKHAWK CREEK WWTP",city:"Whitehouse",state:"Texas",amount_of_biosolids_generated:586,amount_of_biosolids_managed_land_applied:0,latitude:32.205979,longitude:-95.205738},{facility_name:"NEWPORT STP",city:"Newport",state:"Tenn.",amount_of_biosolids_generated:583,amount_of_biosolids_managed_land_applied:583.24,latitude:35.982597,longitude:-83.197659},{facility_name:"REMINGTON REGIONAL WWTP",city:"Warrenton",state:"Utah",amount_of_biosolids_generated:583,amount_of_biosolids_managed_land_applied:582.85,latitude:38.53006,longitude:-77.7981},{facility_name:"COPPERAS COVE NORTHEAST WWTP",city:"Copperas Cove",state:"Texas",amount_of_biosolids_generated:582,amount_of_biosolids_managed_land_applied:0,latitude:31.127185,longitude:-97.88762},{facility_name:"CITY OF AMES",city:"Ames",state:"Hawaii",amount_of_biosolids_generated:579,amount_of_biosolids_managed_land_applied:579.3,latitude:42.02598,longitude:-93.60879},{facility_name:"CITY OF KERRVILLE WWTF",city:"Kerrville",state:"Texas",amount_of_biosolids_generated:579,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"WATER POLLUTION CONTROL FACILITY",city:"Ottumwa",state:"Hawaii",amount_of_biosolids_generated:579,amount_of_biosolids_managed_land_applied:579,latitude:41.01904,longitude:-92.41136},{facility_name:"HUNTINGTON WWTP",city:"Huntington",state:"Iowa",amount_of_biosolids_generated:579,amount_of_biosolids_managed_land_applied:356.16,latitude:40.88118,longitude:-85.4958},{facility_name:"WHEATON SANITARY DISTRICT WWTF",city:"Wheaton",state:"Iowa",amount_of_biosolids_generated:578,amount_of_biosolids_managed_land_applied:577.89,latitude:41.84898,longitude:-88.146313},{facility_name:"EL DORADO HILLS WWTP",city:"Placerville",state:"Calif.",amount_of_biosolids_generated:578,amount_of_biosolids_managed_land_applied:577.5,latitude:38.73444,longitude:-120.7868},{facility_name:"SOUTH BURLINGTON WWTF--AIRPORT PARKWAY",city:"South Burlington",state:"Va.",amount_of_biosolids_generated:577,amount_of_biosolids_managed_land_applied:577.39,latitude:44.48155,longitude:-73.17031},{facility_name:"CITY OF SALISBURY, TOWN CREEK WWTP",city:"Salisbury",state:"Mont.",amount_of_biosolids_generated:576,amount_of_biosolids_managed_land_applied:576,latitude:35.66265,longitude:-80.46389253},{facility_name:"PINE BROOK STP",city:"Manalapan Township",state:"Neb.",amount_of_biosolids_generated:575,amount_of_biosolids_managed_land_applied:0,latitude:40.2767563,longitude:-74.33897322},{facility_name:"MCHENRY SOUTH WWTP, CITY OF",city:"Mchenry",state:"Iowa",amount_of_biosolids_generated:574,amount_of_biosolids_managed_land_applied:574,latitude:42.235139,longitude:-88.330225},{facility_name:"CITY OF SHELBY",city:"Shelby",state:"Mont.",amount_of_biosolids_generated:574,amount_of_biosolids_managed_land_applied:573.9,latitude:35.24281,longitude:-81.571035},{facility_name:"LOWER BUCKS COUNTY JOINT M.A.",city:"Levittown",state:"Pa.",amount_of_biosolids_generated:574,amount_of_biosolids_managed_land_applied:0,latitude:40.159839,longitude:-74.848671},{facility_name:"CHEMUNG CO ELMIRA SD",city:"Elmira",state:"N.D.",amount_of_biosolids_generated:573,amount_of_biosolids_managed_land_applied:0,latitude:42.07685,longitude:-76.77893},{facility_name:"CITY OF LIVINGSTON WWTP",city:"Livingston",state:"Texas",amount_of_biosolids_generated:572,amount_of_biosolids_managed_land_applied:0,latitude:30.71097,longitude:-94.93439},{facility_name:"MINNESOTA RIVER VALLEY PUC",city:"Lesueur",state:"Minn.",amount_of_biosolids_generated:572,amount_of_biosolids_managed_land_applied:572,latitude:44.47669,longitude:-93.905138},{facility_name:"MISSION SPRINGS ALAN L. HORTON WWTP",city:"Desert Hot Sprngs",state:"Calif.",amount_of_biosolids_generated:572,amount_of_biosolids_managed_land_applied:47.51,latitude:33.96327,longitude:-116.4998},{facility_name:"NEWPORT MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:571,amount_of_biosolids_managed_land_applied:0,latitude:29.91063,longitude:-95.09212},{facility_name:"CITY OF JUSTIN WWTP",city:"Justin",state:"Texas",amount_of_biosolids_generated:571,amount_of_biosolids_managed_land_applied:0,latitude:33.078444,longitude:-97.293056},{facility_name:"BENSENVILLE SOUTH STP",city:"Bensenville",state:"Iowa",amount_of_biosolids_generated:570,amount_of_biosolids_managed_land_applied:570.05,latitude:41.94619,longitude:-87.92836},{facility_name:"ENDICOTT (V)",city:"Endicott",state:"N.D.",amount_of_biosolids_generated:570,amount_of_biosolids_managed_land_applied:570,latitude:42.09729,longitude:-76.051131},{facility_name:"NEW IBERIA, CITY OF",city:"New Iberia",state:"La.",amount_of_biosolids_generated:569,amount_of_biosolids_managed_land_applied:861.96,latitude:30.0027,longitude:-91.81359},{facility_name:"LOWELL WWTP",city:"Lowell",state:"Iowa",amount_of_biosolids_generated:568,amount_of_biosolids_managed_land_applied:568.16,latitude:41.264306,longitude:-87.4175},{facility_name:"REWA/GEORGES CREEK WWTP",city:"Greenville",state:"S.C.",amount_of_biosolids_generated:566,amount_of_biosolids_managed_land_applied:0,latitude:34.82222,longitude:-82.47805},{facility_name:"NTUA WINDOW ROCK WWTP",city:"Fort Defiance",state:"Ark.",amount_of_biosolids_generated:565,amount_of_biosolids_managed_land_applied:0,latitude:35.74207,longitude:-109.07081},{facility_name:"SMYRNA STP",city:"Smyrna",state:"Tenn.",amount_of_biosolids_generated:565,amount_of_biosolids_managed_land_applied:62.4,latitude:35.99321,longitude:-86.51434},{facility_name:"MICHIGAN CITY - J.B. GIFFORD WWTP",city:"Michigan City",state:"Iowa",amount_of_biosolids_generated:565,amount_of_biosolids_managed_land_applied:565,latitude:41.71676,longitude:-86.88473},{facility_name:"NEWBURYPORT W W T P",city:"Newburyport",state:"Mass.",amount_of_biosolids_generated:565,amount_of_biosolids_managed_land_applied:565,latitude:42.809271,longitude:-70.861505},{facility_name:"TOWN OF MIDDLEBURY",city:"Middlebury",state:"Va.",amount_of_biosolids_generated:565,amount_of_biosolids_managed_land_applied:564.78,latitude:44.01109,longitude:-73.17049},{facility_name:"NEWBURGH MUNICIPAL WWTP",city:"Newburgh",state:"Iowa",amount_of_biosolids_generated:565,amount_of_biosolids_managed_land_applied:0,latitude:37.941972,longitude:-87.349056},{facility_name:"CITY OF WENTZVILLE",city:"Wentzville",state:"Mo.",amount_of_biosolids_generated:564,amount_of_biosolids_managed_land_applied:564.25,latitude:38.81092,longitude:-90.85695},{facility_name:"RUSSELLVILLE STP",city:"Russellville",state:"Ky.",amount_of_biosolids_generated:563,amount_of_biosolids_managed_land_applied:0,latitude:36.856732,longitude:-86.889048},{facility_name:"GALESBURG SD STP",city:"Galesburg",state:"Iowa",amount_of_biosolids_generated:561,amount_of_biosolids_managed_land_applied:578,latitude:40.9401,longitude:-90.4222},{facility_name:"SUFFIELD WPCF",city:"Suffield",state:"Conn.",amount_of_biosolids_generated:560,amount_of_biosolids_managed_land_applied:0,latitude:41.95944,longitude:-72.62599},{facility_name:"CITY OF PUNTA GORDA WWTP",city:"Punta Gorda",state:"Fla.",amount_of_biosolids_generated:558,amount_of_biosolids_managed_land_applied:558,latitude:26.94684,longitude:-81.94742},{facility_name:"HERMITAGE CITY MUNICIPAL AUTHO",city:"Hermitage",state:"Pa.",amount_of_biosolids_generated:558,amount_of_biosolids_managed_land_applied:557.35,latitude:41.1923,longitude:-80.467},{facility_name:"DEQUEEN, CITY OF",city:"De Queen",state:"Alaska",amount_of_biosolids_generated:558,amount_of_biosolids_managed_land_applied:0,latitude:34.029499,longitude:-94.347291},{facility_name:"JESSAMINE CREEK ENVIRONMENTAL CONTROL #1",city:"Nicholasville",state:"Ky.",amount_of_biosolids_generated:557,amount_of_biosolids_managed_land_applied:0,latitude:37.847683,longitude:-84.612412},{facility_name:"URBANA-CHAMPAIGN SD SW STP",city:"Champaign",state:"Iowa",amount_of_biosolids_generated:556,amount_of_biosolids_managed_land_applied:0,latitude:40.08236,longitude:-88.33292},{facility_name:"MT PLEASANT WWTP",city:"Mt Pleasant",state:"Mich.",amount_of_biosolids_generated:555,amount_of_biosolids_managed_land_applied:555.31,latitude:43.614542,longitude:-84.774301},{facility_name:"WALLINGFORD WPCF",city:"Wallingford",state:"Conn.",amount_of_biosolids_generated:555,amount_of_biosolids_managed_land_applied:0,latitude:41.446099,longitude:-72.837583},{facility_name:"ALTOONA CITY AUTHORITY-WESTERL",city:"Altoona",state:"Pa.",amount_of_biosolids_generated:555,amount_of_biosolids_managed_land_applied:260.68,latitude:40.453906,longitude:-78.426103},{facility_name:"DEER PARK WWTP",city:"Deer Park",state:"Texas",amount_of_biosolids_generated:552,amount_of_biosolids_managed_land_applied:0,latitude:29.71031,longitude:-95.116515},{facility_name:"CITY OF SAN JUAN WWTP",city:"San Juan",state:"Texas",amount_of_biosolids_generated:551,amount_of_biosolids_managed_land_applied:551.42,latitude:26.161663,longitude:-98.16224},{facility_name:"OCEAN CITY REG WASTEWATER TF",city:"Ocean City",state:"Neb.",amount_of_biosolids_generated:551,amount_of_biosolids_managed_land_applied:0,latitude:39.09598045,longitude:-74.81912379},{facility_name:"GOSHEN (V)",city:"Goshen",state:"N.D.",amount_of_biosolids_generated:550,amount_of_biosolids_managed_land_applied:550,latitude:41.40583,longitude:-74.31765},{facility_name:"TIFTON NEW RIVER WPCP",city:"Tifton",state:"Ga.",amount_of_biosolids_generated:546,amount_of_biosolids_managed_land_applied:546.13,latitude:31.445833,longitude:-83.478056},{facility_name:"HARRIS COUNTY MUD 196 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:546,amount_of_biosolids_managed_land_applied:0,latitude:29.928833,longitude:-95.672722},{facility_name:"CITY OF CLEBURNE WWTF",city:"Cleburne",state:"Texas",amount_of_biosolids_generated:545,amount_of_biosolids_managed_land_applied:0,latitude:32.313801,longitude:-97.393735},{facility_name:"ALGONQUIN STP, VILLAGE OF",city:"Algonquin",state:"Iowa",amount_of_biosolids_generated:545,amount_of_biosolids_managed_land_applied:544.934,latitude:42.154898,longitude:-88.294292},{facility_name:"SMITHFIELD TOWN HALL",city:"Smithfield",state:"R.I.",amount_of_biosolids_generated:543,amount_of_biosolids_managed_land_applied:0,latitude:41.8858,longitude:-71.50906},{facility_name:"CITY OF HELENA",city:"Helena",state:"Mont.",amount_of_biosolids_generated:543,amount_of_biosolids_managed_land_applied:157.65,latitude:46.61665,longitude:-112.00464},{facility_name:"OWATONNA",city:"Owatonna",state:"Minn.",amount_of_biosolids_generated:542,amount_of_biosolids_managed_land_applied:542.39,latitude:44.097241,longitude:-93.233296},{facility_name:"ROANOKE RAPIDS SANITARY DISTRICT",city:"Roanoke Rapids",state:"Mont.",amount_of_biosolids_generated:542,amount_of_biosolids_managed_land_applied:541.54,latitude:36.435736,longitude:-77.611069},{facility_name:"SALATRILLO CREEK WWTP",city:"San Antonio",state:"Texas",amount_of_biosolids_generated:541,amount_of_biosolids_managed_land_applied:0,latitude:29.50934,longitude:-98.29974},{facility_name:"BIG BEAR AREA RWA WWTP",city:"Big Bear City",state:"Calif.",amount_of_biosolids_generated:541,amount_of_biosolids_managed_land_applied:540.67,latitude:34.25242937,longitude:-116.8105742},{facility_name:"FAIRHOPE CITY OF",city:"Fairhope",state:"Alaska",amount_of_biosolids_generated:540,amount_of_biosolids_managed_land_applied:0,latitude:30.53,longitude:-87.9043},{facility_name:"WEST MEMPHIS, CITY OF-WWTP",city:"West Memphis",state:"Alaska",amount_of_biosolids_generated:540,amount_of_biosolids_managed_land_applied:0,latitude:35.124167,longitude:-90.178889},{facility_name:"TWA/CYPRESS WEST",city:"Kissimmee",state:"Fla.",amount_of_biosolids_generated:540,amount_of_biosolids_managed_land_applied:0,latitude:28.1497,longitude:-81.5008},{facility_name:"WESTCHESTER CO DEPT ENV FAC",city:"New Rochelle",state:"N.D.",amount_of_biosolids_generated:539,amount_of_biosolids_managed_land_applied:0,latitude:41.28749125,longitude:-73.91612806},{facility_name:"RANCHO CALIFORNIA SANTA ROSA WRF",city:"Temecula",state:"Calif.",amount_of_biosolids_generated:539,amount_of_biosolids_managed_land_applied:0,latitude:33.50773571,longitude:-117.1233054},{facility_name:"SOUTH FORT COLLINS SANITATION DISTRICT",city:"Fort Collins",state:"Colo.",amount_of_biosolids_generated:534,amount_of_biosolids_managed_land_applied:0,latitude:40.51547,longitude:-105.07572},{facility_name:"FAYETTEVILLE WHITEWATER CR",city:"Fayetteville",state:"Ga.",amount_of_biosolids_generated:534,amount_of_biosolids_managed_land_applied:0,latitude:33.422528,longitude:-84.492806},{facility_name:"MARION SE STP, CITY OF",city:"Marion",state:"Iowa",amount_of_biosolids_generated:534,amount_of_biosolids_managed_land_applied:460,latitude:37.721981,longitude:-88.928056},{facility_name:"CITY OF STATESVILLE",city:"Statesville",state:"Mont.",amount_of_biosolids_generated:533,amount_of_biosolids_managed_land_applied:350,latitude:35.773061,longitude:-80.788607},{facility_name:"CITY OF WILLOW PARK WWTP",city:"Willow Park",state:"Texas",amount_of_biosolids_generated:532,amount_of_biosolids_managed_land_applied:0,latitude:32.751778,longitude:-97.664167},{facility_name:"JASPER MUNICIPAL WWTP",city:"Jasper",state:"Iowa",amount_of_biosolids_generated:532,amount_of_biosolids_managed_land_applied:322.63,latitude:38.385139,longitude:-86.940167},{facility_name:"CITY OF PILOT POINT WWTP",city:"Pilot Point",state:"Texas",amount_of_biosolids_generated:532,amount_of_biosolids_managed_land_applied:0,latitude:33.408342,longitude:-96.954588},{facility_name:"BARBERS POINT COMPOST",city:"Pearl Harber",state:"Hawaii",amount_of_biosolids_generated:532,amount_of_biosolids_managed_land_applied:2635,latitude:21.348472,longitude:-157.944147},{facility_name:"FORT KAMEHAMEHA WWTP",city:"Pearl Harbor",state:"Hawaii",amount_of_biosolids_generated:532,amount_of_biosolids_managed_land_applied:532,latitude:21.348472,longitude:-157.944147},{facility_name:"BELVIDERE STP, CITY OF",city:"Belvidere",state:"Iowa",amount_of_biosolids_generated:531,amount_of_biosolids_managed_land_applied:531.18,latitude:42.25468,longitude:-88.86465},{facility_name:"ROBERT T. SAVELY WATER RECLAMATION",city:"Houston",state:"Texas",amount_of_biosolids_generated:531,amount_of_biosolids_managed_land_applied:0,latitude:29.578731,longitude:-95.088541},{facility_name:"DEVENS WASTEWATER TREATMENT FACILITY",city:"Shirley",state:"Mass.",amount_of_biosolids_generated:530,amount_of_biosolids_managed_land_applied:0,latitude:42.560466,longitude:-71.616626},{facility_name:"WEST BRUNSWICK REGIONAL WWTF",city:"Supply",state:"Mont.",amount_of_biosolids_generated:530,amount_of_biosolids_managed_land_applied:529.66,latitude:34.027541,longitude:-78.280217},{facility_name:"OROVILLE REGION, SEWERAGE COMMISSION",city:"Oroville",state:"Calif.",amount_of_biosolids_generated:529,amount_of_biosolids_managed_land_applied:0,latitude:39.49499799,longitude:-121.59493},{facility_name:"WILLIAMSBURG REGIONAL WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:529,amount_of_biosolids_managed_land_applied:528.53,latitude:29.7992,longitude:-95.769421},{facility_name:"CITY OF CLINTON",city:"Clinton",state:"Mont.",amount_of_biosolids_generated:527,amount_of_biosolids_managed_land_applied:526.91,latitude:35.004305,longitude:-78.345532},{facility_name:"HARRIS COUNTY MUD 8 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:527,amount_of_biosolids_managed_land_applied:526.5,latitude:29.78874,longitude:-95.20212},{facility_name:"FAIRHAVEN W W T P",city:"Fairhaven",state:"Mass.",amount_of_biosolids_generated:525,amount_of_biosolids_managed_land_applied:0,latitude:41.639497,longitude:-70.875683},{facility_name:"MADISON WWTP",city:"Madison",state:"Iowa",amount_of_biosolids_generated:524,amount_of_biosolids_managed_land_applied:523.8,latitude:38.73758,longitude:-85.39569},{facility_name:"LRWU-LITTLE MAUMELLE WWTP",city:"Little Rock",state:"Alaska",amount_of_biosolids_generated:522,amount_of_biosolids_managed_land_applied:5098.24,latitude:34.820647,longitude:-92.487575},{facility_name:"EVANS CITY OF",city:"Evans",state:"Colo.",amount_of_biosolids_generated:522,amount_of_biosolids_managed_land_applied:521.79,latitude:40.37739,longitude:-104.69687},{facility_name:"LITTLETON TOWN OF",city:"Littleton",state:"Neb.",amount_of_biosolids_generated:520,amount_of_biosolids_managed_land_applied:0,latitude:44.30882,longitude:-71.79048},{facility_name:"DOVE SPRINGS WWTP",city:"Georgetown",state:"Texas",amount_of_biosolids_generated:519,amount_of_biosolids_managed_land_applied:0,latitude:30.63193,longitude:-97.63373},{facility_name:"HAYS, CITY OF",city:"Hays",state:"Kan.",amount_of_biosolids_generated:518,amount_of_biosolids_managed_land_applied:483,latitude:38.879444,longitude:-99.322222},{facility_name:"CITY OF CLINTON",city:"Clinton",state:"Hawaii",amount_of_biosolids_generated:518,amount_of_biosolids_managed_land_applied:517.5,latitude:41.903,longitude:-90.21281666},{facility_name:"ROCHESTER WASTEWATER TREATMENT PLANT",city:"Rochester",state:"Iowa",amount_of_biosolids_generated:517,amount_of_biosolids_managed_land_applied:0,latitude:41.078944,longitude:-86.222028},{facility_name:"SOUTH COASTAL REGIONAL WASTEWATER FACILITY",city:"Sussex County",state:"D.C.",amount_of_biosolids_generated:517,amount_of_biosolids_managed_land_applied:67.19,latitude:38.523212,longitude:-75.090427},{facility_name:"OCEANSIDE LA SALINA WWTP",city:"Oceanside",state:"Calif.",amount_of_biosolids_generated:517,amount_of_biosolids_managed_land_applied:256,latitude:33.19383319,longitude:-117.3558029},{facility_name:"ALLISON WWTP",city:"Corpus Christi",state:"Texas",amount_of_biosolids_generated:517,amount_of_biosolids_managed_land_applied:0,latitude:27.79642,longitude:-97.40411},{facility_name:"SOUTHBRIDGE W W T P/DEPT OF PUBLIC WORKS",city:"Southbridge",state:"Mass.",amount_of_biosolids_generated:515,amount_of_biosolids_managed_land_applied:0,latitude:42.06969,longitude:-72.0063},{facility_name:"CITY OF GRIMES",city:"Grimes",state:"Hawaii",amount_of_biosolids_generated:514,amount_of_biosolids_managed_land_applied:0,latitude:41.69180452,longitude:-93.78656131},{facility_name:"ELMHURST STP, CITY OF",city:"Elmhurst",state:"Iowa",amount_of_biosolids_generated:513,amount_of_biosolids_managed_land_applied:513.27,latitude:41.87782,longitude:-87.97554},{facility_name:"PUYALLUP STP",city:"Puyallup",state:"Wash.",amount_of_biosolids_generated:513,amount_of_biosolids_managed_land_applied:512.6,latitude:47.205597,longitude:-122.321317},{facility_name:"BAYFIELD WWTP",city:"Bayfield",state:"Colo.",amount_of_biosolids_generated:513,amount_of_biosolids_managed_land_applied:0,latitude:37.27753074,longitude:-107.6320368},{facility_name:"HANOVER AREA REGIONAL WWTF",city:"York County",state:"Pa.",amount_of_biosolids_generated:512,amount_of_biosolids_managed_land_applied:461.04,latitude:39.799953,longitude:-76.98407},{facility_name:"PARKINS MILLS WASTEWATER TREAT",city:"Winchester",state:"Utah",amount_of_biosolids_generated:510,amount_of_biosolids_managed_land_applied:0,latitude:39.10902,longitude:-78.15194},{facility_name:"SNYDERVILLE BSID-SILVER CREEK",city:"Park City",state:"Utah",amount_of_biosolids_generated:510,amount_of_biosolids_managed_land_applied:0,latitude:40.756884,longitude:-111.564117},{facility_name:"WESTERLY TOWN HALL",city:"Westerly",state:"R.I.",amount_of_biosolids_generated:510,amount_of_biosolids_managed_land_applied:0,latitude:41.37698,longitude:-71.8294},{facility_name:"CLARKSVILLE WWTP",city:"Clarksville",state:"Iowa",amount_of_biosolids_generated:510,amount_of_biosolids_managed_land_applied:0,latitude:38.296778,longitude:-85.773528},{facility_name:"LEBANON STP",city:"Lebanon",state:"Tenn.",amount_of_biosolids_generated:509,amount_of_biosolids_managed_land_applied:509,latitude:36.217778,longitude:-86.317778},{facility_name:"ERIE CO SD2",city:"Buffalo",state:"N.D.",amount_of_biosolids_generated:509,amount_of_biosolids_managed_land_applied:0,latitude:42.88376,longitude:-78.87736},{facility_name:"REEDLEY WWTP",city:"Reedley",state:"Calif.",amount_of_biosolids_generated:508,amount_of_biosolids_managed_land_applied:0,latitude:36.55714193,longitude:-119.4447173},{facility_name:"BENTONVILLE, CITY OF",city:"Bentonville",state:"Alaska",amount_of_biosolids_generated:508,amount_of_biosolids_managed_land_applied:0,latitude:36.37234,longitude:-94.20976},{facility_name:"CHESHIRE WPCF",city:"Cheshire",state:"Conn.",amount_of_biosolids_generated:507,amount_of_biosolids_managed_land_applied:0,latitude:41.53378,longitude:-72.86655},{facility_name:"TOWN OF LITTLE ELM WWTF",city:"Little Elm",state:"Texas",amount_of_biosolids_generated:506,amount_of_biosolids_managed_land_applied:0,latitude:33.16625,longitude:-96.90954},{facility_name:"TAYLOR CREEK WWTP -- MSD",city:"Cincinnati",state:"Ohio",amount_of_biosolids_generated:505,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"CITY OF ROCKDALE WWTP",city:"Rockdale",state:"Texas",amount_of_biosolids_generated:505,amount_of_biosolids_managed_land_applied:0,latitude:30.639333,longitude:-97.0025},{facility_name:"FLOYDS FORK WQTC MSD",city:"Louisville",state:"Ky.",amount_of_biosolids_generated:505,amount_of_biosolids_managed_land_applied:0,latitude:38.2367,longitude:-85.46671},{facility_name:"TOWN OF TRION",city:"Trion",state:"Ga.",amount_of_biosolids_generated:504,amount_of_biosolids_managed_land_applied:0,latitude:34.54029,longitude:-85.301404},{facility_name:"FLORENCE TOWNSHIP STP",city:"Florence",state:"Neb.",amount_of_biosolids_generated:504,amount_of_biosolids_managed_land_applied:0,latitude:40.118583,longitude:-74.824302},{facility_name:"ALBERT LEA",city:"Albert Lea",state:"Minn.",amount_of_biosolids_generated:503,amount_of_biosolids_managed_land_applied:503,latitude:43.65857,longitude:-93.37028644},{facility_name:"GALVESTON COUNTY WCID 1 WWTP",city:"Dickinson",state:"Texas",amount_of_biosolids_generated:502,amount_of_biosolids_managed_land_applied:0,latitude:29.45772,longitude:-95.04443},{facility_name:"BROADWATER WATER RECLAMATION",city:"Churchton",state:"Mass.",amount_of_biosolids_generated:501,amount_of_biosolids_managed_land_applied:500.92,latitude:38.812056,longitude:-76.524028},{facility_name:"VERO BEACH, CITY OF",city:"Vero Beach",state:"Fla.",amount_of_biosolids_generated:500,amount_of_biosolids_managed_land_applied:0,latitude:27.631389,longitude:-80.3775},{facility_name:"LIBERTYVILLE STP, VILLAGE OF",city:"Libertyville",state:"Iowa",amount_of_biosolids_generated:500,amount_of_biosolids_managed_land_applied:501.027,latitude:42.25765,longitude:-87.94561},{facility_name:"GULF COAST WAT.RECLM.CTR.-WWTP",city:"Groves",state:"Texas",amount_of_biosolids_generated:500,amount_of_biosolids_managed_land_applied:0,latitude:29.940989,longitude:-93.887922},{facility_name:"DONA ANA COUNTY UTILITIES DEPT",city:"La Mesa",state:"N.D.",amount_of_biosolids_generated:499,amount_of_biosolids_managed_land_applied:0,latitude:32.09115,longitude:-106.66949},{facility_name:"MILTON REGIONAL SEWER AUTHORITY",city:"Milton",state:"Pa.",amount_of_biosolids_generated:497,amount_of_biosolids_managed_land_applied:0,latitude:41.00634,longitude:-76.86178},{facility_name:"EPHRATA BOROUGH POTW",city:"Ephrata",state:"Pa.",amount_of_biosolids_generated:496,amount_of_biosolids_managed_land_applied:0,latitude:40.175181,longitude:-76.196726},{facility_name:"CITY OF KANSAS CITY",city:"Kansas City",state:"Mo.",amount_of_biosolids_generated:495,amount_of_biosolids_managed_land_applied:0,latitude:39.01323,longitude:-94.52917},{facility_name:"WILLIAMSPORT SAN AUTH (CENTRAL",city:"Williamsport",state:"Pa.",amount_of_biosolids_generated:493,amount_of_biosolids_managed_land_applied:0,latitude:41.244722,longitude:-76.989444},{facility_name:"BURLINGAME WWTF",city:"Burlingame",state:"Calif.",amount_of_biosolids_generated:493,amount_of_biosolids_managed_land_applied:543.09,latitude:37.591899,longitude:-122.358092},{facility_name:"REWA/DURBIN CREEK WWTP",city:"Fountain Inn",state:"S.C.",amount_of_biosolids_generated:491,amount_of_biosolids_managed_land_applied:0,latitude:34.708333,longitude:-82.167222},{facility_name:"CITY OF LOGANVILLE WPCP",city:"Loganville",state:"Ga.",amount_of_biosolids_generated:491,amount_of_biosolids_managed_land_applied:491.2,latitude:33.84525,longitude:-83.885583},{facility_name:"CITY OF ELIZABETH CITY",city:"Elizabeth City",state:"Mont.",amount_of_biosolids_generated:491,amount_of_biosolids_managed_land_applied:491.19,latitude:36.308751,longitude:-76.204407},{facility_name:"OJAI VALLEY WWTP",city:"Ojai",state:"Calif.",amount_of_biosolids_generated:490,amount_of_biosolids_managed_land_applied:0,latitude:34.43997209,longitude:-119.2706721},{facility_name:"SAGEMONT WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:490,amount_of_biosolids_managed_land_applied:0,latitude:29.59858,longitude:-95.207732},{facility_name:"STILL CREEK WWTP",city:"Bryan",state:"Texas",amount_of_biosolids_generated:488,amount_of_biosolids_managed_land_applied:0,latitude:30.668045,longitude:-96.413084},{facility_name:"CITY OF STATESVILLE",city:"Statesville",state:"Mont.",amount_of_biosolids_generated:488,amount_of_biosolids_managed_land_applied:488,latitude:35.773061,longitude:-80.788607},{facility_name:"WALLA WALLA WATER RECLAMATION FACILITY",city:"Walla Walla",state:"Wash.",amount_of_biosolids_generated:486,amount_of_biosolids_managed_land_applied:486,latitude:46.064194,longitude:-118.375175},{facility_name:"ALTOONA CITY AUTHORITY-EASTERL",city:"Ducansville",state:"Pa.",amount_of_biosolids_generated:486,amount_of_biosolids_managed_land_applied:213.17,latitude:40.453906,longitude:-78.426103},{facility_name:"MOBILE AREA WATER AND SEWER SYSTEM",city:"Mobile",state:"Alaska",amount_of_biosolids_generated:485,amount_of_biosolids_managed_land_applied:485.45,latitude:30.72,longitude:-88.0701},{facility_name:"UTILITIES BOARD OF THE CITY OF SYLACAUGA",city:"Sylacauga",state:"Alaska",amount_of_biosolids_generated:485,amount_of_biosolids_managed_land_applied:485.39,latitude:33.190263,longitude:-86.27153},{facility_name:"CITY OF UNIONTOWN",city:"Uniontown,",state:"Pa.",amount_of_biosolids_generated:485,amount_of_biosolids_managed_land_applied:0,latitude:39.90214,longitude:-79.72418},{facility_name:"COOPER CITY WEST WWTP",city:"Cooper City",state:"Fla.",amount_of_biosolids_generated:485,amount_of_biosolids_managed_land_applied:484.7,latitude:26.061389,longitude:-80.305},{facility_name:"BARRY ROSE WWTF",city:"Pearland",state:"Texas",amount_of_biosolids_generated:484,amount_of_biosolids_managed_land_applied:0,latitude:29.573056,longitude:-95.260833},{facility_name:"AVON (V)",city:"Avon",state:"N.D.",amount_of_biosolids_generated:484,amount_of_biosolids_managed_land_applied:0,latitude:42.91052,longitude:-77.74667},{facility_name:"CITY OF COMMERCE WWTF",city:"Commerce",state:"Texas",amount_of_biosolids_generated:483,amount_of_biosolids_managed_land_applied:0,latitude:33.217472,longitude:-95.885972},{facility_name:"CITY OF MACON",city:"Macon",state:"Mo.",amount_of_biosolids_generated:483,amount_of_biosolids_managed_land_applied:483,latitude:39.73596926,longitude:-92.46174441},{facility_name:"GREENFIELD WPC",city:"Greenfield",state:"Mass.",amount_of_biosolids_generated:482,amount_of_biosolids_managed_land_applied:0,latitude:42.58763,longitude:-72.60087},{facility_name:"REFLECTION BAY WATER RECLAMATION FACILITY",city:"Pearland",state:"Texas",amount_of_biosolids_generated:481,amount_of_biosolids_managed_land_applied:0,latitude:29.579944,longitude:-95.409917},{facility_name:"CITY OF LINCOLNTON",city:"Lincolnton",state:"Mont.",amount_of_biosolids_generated:481,amount_of_biosolids_managed_land_applied:481,latitude:35.451,longitude:-81.2606},{facility_name:"CITY OF EDEN",city:"Eden",state:"Mont.",amount_of_biosolids_generated:481,amount_of_biosolids_managed_land_applied:481,latitude:36.4758,longitude:-79.74385},{facility_name:"COPPERAS COVE SOUTH WWTF",city:"Copperas Cove",state:"Texas",amount_of_biosolids_generated:479,amount_of_biosolids_managed_land_applied:0,latitude:31.091029,longitude:-97.909063},{facility_name:"CITY OF KILGORE WWTP",city:"Kilgore",state:"Texas",amount_of_biosolids_generated:479,amount_of_biosolids_managed_land_applied:0,latitude:32.39761,longitude:-94.850397},{facility_name:"SCOTTSBORO WATER, SEWER, AND GAS BOARD",city:"Scottsboro",state:"Alaska",amount_of_biosolids_generated:478,amount_of_biosolids_managed_land_applied:0,latitude:34.6061,longitude:-86.0535},{facility_name:"RAINBOW CITY WWTP",city:"Rainbow City",state:"Alaska",amount_of_biosolids_generated:478,amount_of_biosolids_managed_land_applied:477.85,latitude:33.979167,longitude:-86.034444},{facility_name:"CITY OF CARBONDALE SOUTHEAST STP",city:"Carbondale",state:"Iowa",amount_of_biosolids_generated:478,amount_of_biosolids_managed_land_applied:477.74,latitude:37.73384,longitude:-89.16613},{facility_name:"TUPELO BAYOU WWTP",city:"Conway",state:"Alaska",amount_of_biosolids_generated:476,amount_of_biosolids_managed_land_applied:476.43,latitude:35.05524,longitude:-92.5347},{facility_name:"SUMMIT COUNTY LANDFILL",city:"Summit County",state:"Colo.",amount_of_biosolids_generated:476,amount_of_biosolids_managed_land_applied:476,latitude:39.609166,longitude:-106.000555},{facility_name:"VINCENNES WWTP, CITY OF",city:"Vincennes",state:"Iowa",amount_of_biosolids_generated:475,amount_of_biosolids_managed_land_applied:475.2941,latitude:38.676333,longitude:-87.541861},{facility_name:"ELKO WRF",city:"Elko",state:"N.D.",amount_of_biosolids_generated:474,amount_of_biosolids_managed_land_applied:0,latitude:40.843617,longitude:-115.752753},{facility_name:"CITY OF MEBANE",city:"Mebane",state:"Mont.",amount_of_biosolids_generated:474,amount_of_biosolids_managed_land_applied:0,latitude:36.088233,longitude:-79.285589},{facility_name:"ATASCOCITA REGIONAL WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:473,amount_of_biosolids_managed_land_applied:0,latitude:29.986444,longitude:-95.198139},{facility_name:"CITY OF DUBLIN",city:"Dublin",state:"Ga.",amount_of_biosolids_generated:472,amount_of_biosolids_managed_land_applied:0,latitude:32.518639,longitude:-82.886167},{facility_name:"OCALA WRF #3",city:"Ocala",state:"Fla.",amount_of_biosolids_generated:472,amount_of_biosolids_managed_land_applied:0,latitude:29.15835,longitude:-82.2314},{facility_name:"LAFAYETTE CONSOLIDATED GOVERNMENT - SOUTH WWTP",city:"Lafayette",state:"La.",amount_of_biosolids_generated:471,amount_of_biosolids_managed_land_applied:470.9,latitude:30.195039,longitude:-92.028118},{facility_name:"WEBSTER W W T F",city:"Webster",state:"Mass.",amount_of_biosolids_generated:470,amount_of_biosolids_managed_land_applied:0,latitude:42.038576,longitude:-71.888022},{facility_name:"SUGAR LAND NORTH WWTP",city:"Sugar Land",state:"Texas",amount_of_biosolids_generated:470,amount_of_biosolids_managed_land_applied:0,latitude:29.594764,longitude:-95.629578},{facility_name:"SHEPHERDSVILLE STP",city:"Shepherdsville",state:"Ky.",amount_of_biosolids_generated:469,amount_of_biosolids_managed_land_applied:0,latitude:37.9875,longitude:-85.720833},{facility_name:"ROCHELLE WATER RECLAMATION",city:"Rochelle",state:"Iowa",amount_of_biosolids_generated:468,amount_of_biosolids_managed_land_applied:289,latitude:41.912721,longitude:-89.069954},{facility_name:"ANDERSON/ROCKY RIVER",city:"Anderson",state:"S.C.",amount_of_biosolids_generated:467,amount_of_biosolids_managed_land_applied:467.45,latitude:34.491944,longitude:-82.625278},{facility_name:"GAFFNEY/BROAD RVR",city:"Gaffney",state:"S.C.",amount_of_biosolids_generated:465,amount_of_biosolids_managed_land_applied:465,latitude:35.0661,longitude:-81.5539},{facility_name:"ORANGEBURG WWTF",city:"Orangeburg",state:"S.C.",amount_of_biosolids_generated:465,amount_of_biosolids_managed_land_applied:464.1,latitude:33.437157,longitude:-80.849191},{facility_name:"CITY OF BOWIE STP",city:"Bowie",state:"Mass.",amount_of_biosolids_generated:464,amount_of_biosolids_managed_land_applied:466.44,latitude:38.993368,longitude:-76.719964},{facility_name:"PECAN BRANCH WWTP",city:"Georgetown",state:"Texas",amount_of_biosolids_generated:464,amount_of_biosolids_managed_land_applied:0,latitude:30.672944,longitude:-97.60975},{facility_name:"STONY POINT WWTP",city:"Bastrop",state:"Texas",amount_of_biosolids_generated:462,amount_of_biosolids_managed_land_applied:0,latitude:30.129492,longitude:-97.571589},{facility_name:"PONDEROSA JOIN POWERS AGENCY REGIONAL WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:462,amount_of_biosolids_managed_land_applied:416.76,latitude:30.027543,longitude:-95.466487},{facility_name:"SOUTH MONMOUTH REGIONAL STP",city:"W Belmar",state:"Neb.",amount_of_biosolids_generated:462,amount_of_biosolids_managed_land_applied:0,latitude:40.16883,longitude:-74.04492},{facility_name:"IL AMERICAN WTR CO-SANTA FE",city:"Lemont",state:"Iowa",amount_of_biosolids_generated:461,amount_of_biosolids_managed_land_applied:460.68,latitude:41.686667,longitude:-88.021667},{facility_name:"DOVER TWP. SEWAGE TMT. PLANT",city:"York County",state:"Pa.",amount_of_biosolids_generated:461,amount_of_biosolids_managed_land_applied:460.61,latitude:40.01431,longitude:-76.80278},{facility_name:"CITY OF BRECKENRIDGE WWTF",city:"Breckenridge",state:"Texas",amount_of_biosolids_generated:460,amount_of_biosolids_managed_land_applied:0,latitude:32.7715,longitude:-98.896444},{facility_name:"LICK CREEK WWTP",city:"College Station",state:"Texas",amount_of_biosolids_generated:459,amount_of_biosolids_managed_land_applied:0,latitude:30.571138,longitude:-96.217745},{facility_name:"LEESBURG/TURNPIKE WWTF",city:"Leesburg",state:"Fla.",amount_of_biosolids_generated:458,amount_of_biosolids_managed_land_applied:457.8,latitude:28.75529,longitude:-81.9286},{facility_name:"CAMBRIDGE WWTP",city:"Cambridge",state:"Mass.",amount_of_biosolids_generated:458,amount_of_biosolids_managed_land_applied:0,latitude:38.564167,longitude:-76.057222},{facility_name:"BROADWAY, TOWN OF REGIONAL WWTF",city:"Broadway",state:"Utah",amount_of_biosolids_generated:457,amount_of_biosolids_managed_land_applied:416,latitude:38.60377649,longitude:-78.80755236},{facility_name:"CONROE CENTRAL WWTP",city:"Conroe",state:"Texas",amount_of_biosolids_generated:457,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"CITY OF DOTHAN",city:"Dothan",state:"Alaska",amount_of_biosolids_generated:456,amount_of_biosolids_managed_land_applied:0,latitude:31.2542,longitude:-85.3722},{facility_name:"DINUBA WRF",city:"Dinuba",state:"Calif.",amount_of_biosolids_generated:456,amount_of_biosolids_managed_land_applied:456.03,latitude:36.54579,longitude:-119.39122},{facility_name:"CITY OF SPRINGTOWN WWTP",city:"Springtown",state:"Texas",amount_of_biosolids_generated:456,amount_of_biosolids_managed_land_applied:0,latitude:32.96925,longitude:-97.655222},{facility_name:"DURANGO CITY OF",city:"Durango",state:"Colo.",amount_of_biosolids_generated:456,amount_of_biosolids_managed_land_applied:0,latitude:37.27387,longitude:-107.87924},{facility_name:"BROWNSBURG WWTP",city:"Brownsburg",state:"Iowa",amount_of_biosolids_generated:455,amount_of_biosolids_managed_land_applied:454.69,latitude:39.844268,longitude:-86.397526},{facility_name:"IMPERIAL VALLEY WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:454,amount_of_biosolids_managed_land_applied:0,latitude:29.92777,longitude:-95.39374},{facility_name:"MAIN PLANT WWTF",city:"Port Neches",state:"Texas",amount_of_biosolids_generated:454,amount_of_biosolids_managed_land_applied:0,latitude:29.954319,longitude:-93.942518},{facility_name:"LANCASTER/CATAWBA RIVER",city:"Lancaster",state:"S.C.",amount_of_biosolids_generated:452,amount_of_biosolids_managed_land_applied:350,latitude:34.845,longitude:-80.857222},{facility_name:"CITY OF BUDA WWTF",city:"Buda",state:"Texas",amount_of_biosolids_generated:452,amount_of_biosolids_managed_land_applied:0,latitude:30.056861,longitude:-97.835833},{facility_name:"BATAVIA STP, CITY OF",city:"Batavia",state:"Iowa",amount_of_biosolids_generated:451,amount_of_biosolids_managed_land_applied:0,latitude:41.8471,longitude:-88.30816},{facility_name:"CITY OF ALAMOGORDO",city:"Otero",state:"N.D.",amount_of_biosolids_generated:451,amount_of_biosolids_managed_land_applied:0,latitude:32.843323,longitude:-105.997789},{facility_name:"BATESVILLE, CITY OF",city:"Batesville",state:"Alaska",amount_of_biosolids_generated:450,amount_of_biosolids_managed_land_applied:0,latitude:35.7525,longitude:-91.6311},{facility_name:"MT VERNON WWTP",city:"Mount Vernon",state:"Wash.",amount_of_biosolids_generated:449,amount_of_biosolids_managed_land_applied:449,latitude:48.411314,longitude:-122.34905},{facility_name:"NEW ULM",city:"New Ulm",state:"Minn.",amount_of_biosolids_generated:448,amount_of_biosolids_managed_land_applied:448,latitude:44.287037,longitude:-94.43237},{facility_name:"HARRIS COUNTY FWSD 61 WWTP 2",city:"Houston",state:"Texas",amount_of_biosolids_generated:447,amount_of_biosolids_managed_land_applied:0,latitude:29.925236,longitude:-95.609966},{facility_name:"CITY OF GAINESVILLE WWTP",city:"Gainesville",state:"Texas",amount_of_biosolids_generated:446,amount_of_biosolids_managed_land_applied:154.183,latitude:33.64205,longitude:-97.14799},{facility_name:"VAN BUREN, CITY OF-NORTH WWTP",city:"Van Buren",state:"Alaska",amount_of_biosolids_generated:445,amount_of_biosolids_managed_land_applied:0,latitude:35.469932,longitude:-94.396529},{facility_name:"SHELBYVILLE WATER RESOURCE RECOVERY FACILITY",city:"Shelbyville",state:"Iowa",amount_of_biosolids_generated:444,amount_of_biosolids_managed_land_applied:444.28,latitude:39.52444,longitude:-85.77874},{facility_name:"CHEROKEE METRO DISTRICT",city:"Colorado Springs",state:"Colo.",amount_of_biosolids_generated:444,amount_of_biosolids_managed_land_applied:0,latitude:38.857223,longitude:-104.712571},{facility_name:"HARNETT COUNTY",city:"Lillington",state:"Mont.",amount_of_biosolids_generated:444,amount_of_biosolids_managed_land_applied:0,latitude:35.396991,longitude:-78.801537},{facility_name:"GRAFTON WASTEWATER TREATMENT",city:"So. Grafton",state:"Mass.",amount_of_biosolids_generated:443,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"ADDISON SOUTH-A.J. LAROCCA STP",city:"Addison",state:"Iowa",amount_of_biosolids_generated:443,amount_of_biosolids_managed_land_applied:443.48,latitude:41.920908,longitude:-87.975131},{facility_name:"MOAB-CITY",city:"Moab",state:"Utah",amount_of_biosolids_generated:443,amount_of_biosolids_managed_land_applied:0,latitude:38.57327,longitude:-109.54796},{facility_name:"CENTRAL DISTRICT WWTP",city:"Baytown",state:"Texas",amount_of_biosolids_generated:442,amount_of_biosolids_managed_land_applied:0,latitude:29.72158,longitude:-94.986768},{facility_name:"QUAIL VALLEY UD WWTP",city:"Missouri City",state:"Texas",amount_of_biosolids_generated:442,amount_of_biosolids_managed_land_applied:409.7,latitude:29.570083,longitude:-95.552278},{facility_name:"RIDAUGHT LANDING WWTF",city:"Clay Count",state:"Fla.",amount_of_biosolids_generated:440,amount_of_biosolids_managed_land_applied:440.4,latitude:30.096729,longitude:-81.791589},{facility_name:"WINNIPESAUKEE RIVER BASIN",city:"Franklin",state:"Neb.",amount_of_biosolids_generated:440,amount_of_biosolids_managed_land_applied:440.01,latitude:43.44069,longitude:-71.64876},{facility_name:"TOWN OF SILER CITY",city:"Siler City",state:"Mont.",amount_of_biosolids_generated:440,amount_of_biosolids_managed_land_applied:147,latitude:35.760856,longitude:-79.462201},{facility_name:"MILLERSVILLE BORO",city:"Lancaster County",state:"Pa.",amount_of_biosolids_generated:439,amount_of_biosolids_managed_land_applied:439,latitude:40.00728,longitude:-76.35921},{facility_name:"AMESBURY W W T P",city:"Amesbury",state:"Mass.",amount_of_biosolids_generated:439,amount_of_biosolids_managed_land_applied:0,latitude:42.840133,longitude:-70.926486},{facility_name:"SOUTH KUEHLER WWTF",city:"New Braunfels",state:"Texas",amount_of_biosolids_generated:438,amount_of_biosolids_managed_land_applied:0,latitude:29.687167,longitude:-98.0975},{facility_name:"PRASA CAYEY RWWTP",city:"Bo.Rincon Of Cidra",state:"Pa.",amount_of_biosolids_generated:437,amount_of_biosolids_managed_land_applied:0,latitude:18.157548,longitude:-66.157999},{facility_name:"KINGS CREEK WWTF",city:"Terrell",state:"Texas",amount_of_biosolids_generated:437,amount_of_biosolids_managed_land_applied:0,latitude:32.688125,longitude:-96.27602},{facility_name:"MEDIA STP",city:"Media",state:"Pa.",amount_of_biosolids_generated:435,amount_of_biosolids_managed_land_applied:230,latitude:39.9136,longitude:-75.40005},{facility_name:"SAN GABRIEL WWTP",city:"Georgetown",state:"Texas",amount_of_biosolids_generated:435,amount_of_biosolids_managed_land_applied:0,latitude:30.649536,longitude:-97.662527},{facility_name:"NEW LENOX STP #1, VILLAGE OF",city:"New Lenox",state:"Iowa",amount_of_biosolids_generated:435,amount_of_biosolids_managed_land_applied:211.88,latitude:41.5144,longitude:-87.96643},{facility_name:"TOWN OF CLAYTON",city:"Clayton",state:"Mont.",amount_of_biosolids_generated:434,amount_of_biosolids_managed_land_applied:434.28,latitude:35.6413,longitude:-78.4644},{facility_name:"JACKSON STREET WWTP",city:"Orange",state:"Texas",amount_of_biosolids_generated:434,amount_of_biosolids_managed_land_applied:0,latitude:30.086068,longitude:-93.74158},{facility_name:"TOOELE CITY",city:"Tooele",state:"Utah",amount_of_biosolids_generated:434,amount_of_biosolids_managed_land_applied:0,latitude:40.594381,longitude:-112.328612},{facility_name:"CITY OF BURLINGTON",city:"Burlington",state:"Hawaii",amount_of_biosolids_generated:434,amount_of_biosolids_managed_land_applied:434.54,latitude:40.81104,longitude:-91.10353},{facility_name:"ONEIDA (C)",city:"Oneida",state:"N.D.",amount_of_biosolids_generated:432,amount_of_biosolids_managed_land_applied:0,latitude:43.09659,longitude:-75.65279},{facility_name:"CHALFONT NEW BRITAIN JOINT SEW",city:"Doylestown",state:"Pa.",amount_of_biosolids_generated:430,amount_of_biosolids_managed_land_applied:429.6,latitude:40.29013,longitude:-75.17797},{facility_name:"BRISTOL TOWN HALL",city:"Bristol",state:"R.I.",amount_of_biosolids_generated:430,amount_of_biosolids_managed_land_applied:0,latitude:41.66953,longitude:-71.27604},{facility_name:"DOSHIER FARM WWTP",city:"Temple",state:"Texas",amount_of_biosolids_generated:429,amount_of_biosolids_managed_land_applied:0,latitude:31.078267,longitude:-97.318673},{facility_name:"HOOD RIVER, CITY OF",city:"Hood River",state:"Ore.",amount_of_biosolids_generated:428,amount_of_biosolids_managed_land_applied:378,latitude:45.714008,longitude:-121.520296},{facility_name:"PRASA - JAYUYA (NEW) WWTP",city:"Jayuya",state:"Pa.",amount_of_biosolids_generated:428,amount_of_biosolids_managed_land_applied:0,latitude:18.21736752,longitude:-66.59780219},{facility_name:"GENEVA STP, CITY OF",city:"Geneva",state:"Iowa",amount_of_biosolids_generated:428,amount_of_biosolids_managed_land_applied:623,latitude:41.88247,longitude:-88.299255},{facility_name:"WILLINGBORO WATER PCF",city:"Willingboro",state:"Neb.",amount_of_biosolids_generated:427,amount_of_biosolids_managed_land_applied:0,latitude:40.027628,longitude:-74.91935},{facility_name:"MONTGOMERY TWP MUNI SEW AUTH MONTGOMERY CNTY",city:"Montgomeryville",state:"Pa.",amount_of_biosolids_generated:425,amount_of_biosolids_managed_land_applied:0,latitude:40.23682,longitude:-75.22316},{facility_name:"MONTROSE CITY OF",city:"Montrose",state:"Colo.",amount_of_biosolids_generated:425,amount_of_biosolids_managed_land_applied:0,latitude:38.477985,longitude:-107.8759501},{facility_name:"SUGAR LAND SOUTH WWTP",city:"Sugar Land",state:"Texas",amount_of_biosolids_generated:425,amount_of_biosolids_managed_land_applied:0,latitude:29.555,longitude:-95.593611},{facility_name:"PALMER W P C F",city:"Three Rivers",state:"Mass.",amount_of_biosolids_generated:424,amount_of_biosolids_managed_land_applied:0,latitude:42.18579,longitude:-72.36317},{facility_name:"SOUTH SANTA ROSA UTILITIES SYSTEM WWTF",city:"Gulf Breeze",state:"Fla.",amount_of_biosolids_generated:422,amount_of_biosolids_managed_land_applied:422.41,latitude:30.37886,longitude:-87.085731},{facility_name:"MARTIN COUNTY UTILITIES NORTH WWTF",city:"Stuart",state:"Fla.",amount_of_biosolids_generated:422,amount_of_biosolids_managed_land_applied:0,latitude:27.19243852,longitude:-80.25},{facility_name:"ANSONIA WPCA",city:"Ansonia",state:"Conn.",amount_of_biosolids_generated:419,amount_of_biosolids_managed_land_applied:0,latitude:41.34282,longitude:-73.07861},{facility_name:"NEW WINDSOR (T)",city:"New Windsor",state:"N.D.",amount_of_biosolids_generated:419,amount_of_biosolids_managed_land_applied:0,latitude:41.48316,longitude:-74.06277},{facility_name:"CITY OF PARIS WWTF",city:"Paris",state:"Texas",amount_of_biosolids_generated:418,amount_of_biosolids_managed_land_applied:370.36,latitude:33.661353,longitude:-95.556318},{facility_name:"CANBY, CITY OF",city:"Canby",state:"Ore.",amount_of_biosolids_generated:417,amount_of_biosolids_managed_land_applied:0,latitude:45.285123,longitude:-122.677693},{facility_name:"BEREA MUNICIPAL UTILITIES WWTP",city:"Berea",state:"Ky.",amount_of_biosolids_generated:417,amount_of_biosolids_managed_land_applied:0,latitude:37.608496,longitude:-84.287074},{facility_name:"BRIGHAM CITY CORPORATION",city:"Brigham City",state:"Utah",amount_of_biosolids_generated:417,amount_of_biosolids_managed_land_applied:417,latitude:41.53227,longitude:-112.02585},{facility_name:"PLAQUEMINES PAR (BURAS STP)",city:"Buras",state:"La.",amount_of_biosolids_generated:417,amount_of_biosolids_managed_land_applied:0,latitude:29.34155,longitude:-89.51669},{facility_name:"STILLHOUSE BRANCH WWTP",city:"Gatesville",state:"Texas",amount_of_biosolids_generated:417,amount_of_biosolids_managed_land_applied:416.64,latitude:31.445415,longitude:-97.750189},{facility_name:"GOLETA WWTP",city:"Goleta",state:"Calif.",amount_of_biosolids_generated:416,amount_of_biosolids_managed_land_applied:0,latitude:34.424611,longitude:-119.836083},{facility_name:"TOWN OF FOREST CITY",city:"Forest City",state:"Mont.",amount_of_biosolids_generated:415,amount_of_biosolids_managed_land_applied:415.18,latitude:35.327244,longitude:-81.841614},{facility_name:"EASTHAMPTON W W T P",city:"Easthampton",state:"Mass.",amount_of_biosolids_generated:415,amount_of_biosolids_managed_land_applied:0,latitude:42.277698,longitude:-72.648897},{facility_name:"CITY OF FULTON",city:"Fulton",state:"Mo.",amount_of_biosolids_generated:414,amount_of_biosolids_managed_land_applied:368,latitude:38.84825006,longitude:-91.97285825},{facility_name:"NORTHBRIDGE WWTP",city:"Northbridge",state:"Mass.",amount_of_biosolids_generated:414,amount_of_biosolids_managed_land_applied:0,latitude:42.1125,longitude:-71.6359},{facility_name:"BERLIN P C F",city:"Berlin",state:"Neb.",amount_of_biosolids_generated:414,amount_of_biosolids_managed_land_applied:0,latitude:44.455764,longitude:-71.184217},{facility_name:"GLENDALE HEIGHTS, VILLAGE OF",city:"Glendale Heights",state:"Iowa",amount_of_biosolids_generated:414,amount_of_biosolids_managed_land_applied:414.09,latitude:41.91104,longitude:-88.05452},{facility_name:"OXFORD WWTP",city:"Oxford",state:"Mont.",amount_of_biosolids_generated:414,amount_of_biosolids_managed_land_applied:414,latitude:36.2772,longitude:-78.5911},{facility_name:"ROCK SPRINGS, CITY OF",city:"Rock Springs",state:"Wyo.",amount_of_biosolids_generated:413,amount_of_biosolids_managed_land_applied:370,latitude:41.58569,longitude:-109.21899},{facility_name:"CRESTVIEW WWTP",city:"Crestview",state:"Fla.",amount_of_biosolids_generated:413,amount_of_biosolids_managed_land_applied:412.62,latitude:30.73621,longitude:-86.59625},{facility_name:"CITY OF DANVILLE NORTHSIDE WWT",city:"Danville",state:"Utah",amount_of_biosolids_generated:412,amount_of_biosolids_managed_land_applied:412,latitude:36.564695,longitude:-79.360352},{facility_name:"CITY OF MONETT",city:"Monett",state:"Mo.",amount_of_biosolids_generated:412,amount_of_biosolids_managed_land_applied:412,latitude:36.907831,longitude:-93.896375},{facility_name:"DELANO WWTP",city:"Delano",state:"Calif.",amount_of_biosolids_generated:411,amount_of_biosolids_managed_land_applied:411,latitude:35.768423,longitude:-119.303111},{facility_name:"BUTTERWORTH WATER POL CON UTIL",city:"Morristown",state:"Neb.",amount_of_biosolids_generated:410,amount_of_biosolids_managed_land_applied:0,latitude:40.812433,longitude:-74.494711},{facility_name:"FRANKLIN WWTP, CITY OF",city:"Franklin",state:"Iowa",amount_of_biosolids_generated:410,amount_of_biosolids_managed_land_applied:410.01,latitude:39.468389,longitude:-86.040694},{facility_name:"CITY OF WASHINGTON",city:"Washington",state:"Mo.",amount_of_biosolids_generated:410,amount_of_biosolids_managed_land_applied:409.7,latitude:38.540277,longitude:-90.973607},{facility_name:"CITY OF DUMAS WWTP",city:"Dumas",state:"Texas",amount_of_biosolids_generated:410,amount_of_biosolids_managed_land_applied:0,latitude:35.841388,longitude:-101.962222},{facility_name:"FORT MYERS BEACH STP",city:"Fort Myers",state:"Fla.",amount_of_biosolids_generated:409,amount_of_biosolids_managed_land_applied:0,latitude:26.491658,longitude:-81.93343},{facility_name:"CITY OF SEAFORD WWTF",city:"Seaford",state:"D.C.",amount_of_biosolids_generated:407,amount_of_biosolids_managed_land_applied:0,latitude:38.6345,longitude:-75.617139},{facility_name:"OTTAWA STP, CITY OF",city:"Ottawa",state:"Iowa",amount_of_biosolids_generated:407,amount_of_biosolids_managed_land_applied:0,latitude:41.33908,longitude:-88.847418},{facility_name:"HANOVER SEWERAGE AUTHORITY",city:"Whippany",state:"Neb.",amount_of_biosolids_generated:406,amount_of_biosolids_managed_land_applied:0,latitude:40.822285,longitude:-74.389945},{facility_name:"MAPLE SHADE TWP PARK AVE POTW",city:"Maple Shade",state:"Neb.",amount_of_biosolids_generated:406,amount_of_biosolids_managed_land_applied:405.62,latitude:39.958539,longitude:-75.014525},{facility_name:"CONNERSVILLE WWTP",city:"Connersville",state:"Iowa",amount_of_biosolids_generated:405,amount_of_biosolids_managed_land_applied:297.9,latitude:39.62778,longitude:-85.14473},{facility_name:"SHELTON STP",city:"Shelton",state:"Wash.",amount_of_biosolids_generated:405,amount_of_biosolids_managed_land_applied:0,latitude:47.205798,longitude:-123.078032},{facility_name:"CITY OF DOUGLAS",city:"Douglas",state:"Ga.",amount_of_biosolids_generated:404,amount_of_biosolids_managed_land_applied:0,latitude:31.500861,longitude:-82.823889},{facility_name:"CITY OF GASTONIA",city:"Gastonia",state:"Mont.",amount_of_biosolids_generated:403,amount_of_biosolids_managed_land_applied:403.2,latitude:35.166111,longitude:-81.199444},{facility_name:"NORTHGATE WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:403,amount_of_biosolids_managed_land_applied:0,latitude:29.944188,longitude:-95.399782},{facility_name:"KLAMATH FALLS WWTP - SPRING ST",city:"Klamath Falls",state:"Ore.",amount_of_biosolids_generated:403,amount_of_biosolids_managed_land_applied:403,latitude:42.216333,longitude:-121.776189},{facility_name:"WATER RECLAMATION WWTF",city:"Cedar Park",state:"Texas",amount_of_biosolids_generated:402,amount_of_biosolids_managed_land_applied:0,latitude:30.495215,longitude:-97.806697},{facility_name:"ESSEX JUNCTION WASTEWATER TREATMENT FACILITY",city:"Essex Junction",state:"Va.",amount_of_biosolids_generated:400,amount_of_biosolids_managed_land_applied:124.87,latitude:44.49053,longitude:-73.11119},{facility_name:"KINGSLAND MUD WWTP",city:"Kingsland",state:"Texas",amount_of_biosolids_generated:400,amount_of_biosolids_managed_land_applied:0,latitude:30.65755,longitude:-98.43413},{facility_name:"SULPHUR,CITY OF-WWTP",city:"Sulphur",state:"La.",amount_of_biosolids_generated:400,amount_of_biosolids_managed_land_applied:0,latitude:30.187222,longitude:-93.305194},{facility_name:"OAK HOLLOW WWTP",city:"Van Vleck",state:"Texas",amount_of_biosolids_generated:400,amount_of_biosolids_managed_land_applied:0,latitude:29.011917,longitude:-95.882444},{facility_name:"CENTRAL MUD 1 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:400,amount_of_biosolids_managed_land_applied:399.51,latitude:29.728,longitude:-95.761611},{facility_name:"BELLEFONTE BOROUGH",city:"Bellefonte",state:"Pa.",amount_of_biosolids_generated:399,amount_of_biosolids_managed_land_applied:398.21,latitude:40.92269,longitude:-77.78375},{facility_name:"MIDDLEBOROUGH WWTP - DEPT OF PUBLIC WORKS",city:"Middleborough",state:"Mass.",amount_of_biosolids_generated:398,amount_of_biosolids_managed_land_applied:0,latitude:41.89006,longitude:-70.90384},{facility_name:"PULLMAN WWTP",city:"Pullman",state:"Wash.",amount_of_biosolids_generated:398,amount_of_biosolids_managed_land_applied:385,latitude:46.738294,longitude:-117.189612},{facility_name:"COCOA, CITY OF - COCOA WRF",city:"Cocoa",state:"Fla.",amount_of_biosolids_generated:398,amount_of_biosolids_managed_land_applied:397.59,latitude:28.361816,longitude:-80.733983},{facility_name:"SCOTTSBLUFF WWTF",city:"Scottsbluff",state:"Neb.",amount_of_biosolids_generated:396,amount_of_biosolids_managed_land_applied:64.23,latitude:41.8378,longitude:-103.6067},{facility_name:"PRINCESS ANNE WWTP",city:"Princess Anne",state:"Mass.",amount_of_biosolids_generated:394,amount_of_biosolids_managed_land_applied:0,latitude:38.196706,longitude:-75.696581},{facility_name:"REDDING CLEAR CREEK WWTP",city:"Redding",state:"Calif.",amount_of_biosolids_generated:393,amount_of_biosolids_managed_land_applied:0,latitude:40.57366511,longitude:-122.3530771},{facility_name:"DERBY, CITY OF",city:"Derby",state:"Kan.",amount_of_biosolids_generated:393,amount_of_biosolids_managed_land_applied:392.99,latitude:37.54914,longitude:-97.24803},{facility_name:"CITY OF COVINGTON WWTF",city:"Covington",state:"Ga.",amount_of_biosolids_generated:393,amount_of_biosolids_managed_land_applied:0,latitude:33.58613904,longitude:-83.84484363},{facility_name:"PLAYERS CLUB SOUTH WWTF",city:"Ponte Vedra Beach",state:"Fla.",amount_of_biosolids_generated:393,amount_of_biosolids_managed_land_applied:392.67,latitude:30.186781,longitude:-81.393683},{facility_name:"LARAMIE WASTEWTR TRETMNT PLANT",city:"Laramie",state:"Wyo.",amount_of_biosolids_generated:391,amount_of_biosolids_managed_land_applied:391,latitude:41.3381,longitude:-105.599},{facility_name:"BOAZ WATER & SEWER BOARD",city:"Boaz",state:"Alaska",amount_of_biosolids_generated:391,amount_of_biosolids_managed_land_applied:391,latitude:34.1858,longitude:-86.1847},{facility_name:"BECKLEY, CITY OF",city:"Beckley",state:"Wis.",amount_of_biosolids_generated:390,amount_of_biosolids_managed_land_applied:0,latitude:37.771159,longitude:-81.15421},{facility_name:"KEWANEE STP",city:"Kewanee",state:"Iowa",amount_of_biosolids_generated:390,amount_of_biosolids_managed_land_applied:390.3,latitude:41.244408,longitude:-89.903251},{facility_name:"OJRSA/CONEROSS CREEK WWTP",city:"Seneca",state:"S.C.",amount_of_biosolids_generated:390,amount_of_biosolids_managed_land_applied:0,latitude:34.6475,longitude:-82.99},{facility_name:"PORTER MUD WWTP",city:"Porter",state:"Texas",amount_of_biosolids_generated:390,amount_of_biosolids_managed_land_applied:0,latitude:30.073528,longitude:-95.239361},{facility_name:"COCOA BEACH, CITY OF",city:"Cocoa Beach",state:"Fla.",amount_of_biosolids_generated:389,amount_of_biosolids_managed_land_applied:0,latitude:28.316083,longitude:-80.633917},{facility_name:"CITY OF HENDERSON",city:"Henderson",state:"Mont.",amount_of_biosolids_generated:388,amount_of_biosolids_managed_land_applied:388.45,latitude:36.349349,longitude:-78.411438},{facility_name:"TURKEY CREEK WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:388,amount_of_biosolids_managed_land_applied:0,latitude:29.767751,longitude:-95.620954},{facility_name:"NORTH PORT CITY OF WWTP",city:"North Port",state:"Fla.",amount_of_biosolids_generated:388,amount_of_biosolids_managed_land_applied:0,latitude:27.047464,longitude:-82.245222},{facility_name:"SLIDELL, CITY OF (PLANT #2)",city:"Slidell",state:"La.",amount_of_biosolids_generated:388,amount_of_biosolids_managed_land_applied:388,latitude:30.26257,longitude:-89.76963},{facility_name:"WHITE OAK WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:387,amount_of_biosolids_managed_land_applied:0,latitude:29.87899,longitude:-95.53616},{facility_name:"FOREST CREEK WWTP",city:"Sugarland",state:"Texas",amount_of_biosolids_generated:387,amount_of_biosolids_managed_land_applied:0,latitude:30.508806,longitude:-97.583889},{facility_name:"IPSWICH W W T F",city:"Ipswich",state:"Mass.",amount_of_biosolids_generated:386,amount_of_biosolids_managed_land_applied:386,latitude:42.699516,longitude:-70.870225},{facility_name:"LEESBURG, CITY OF",city:"Leesburg",state:"Fla.",amount_of_biosolids_generated:386,amount_of_biosolids_managed_land_applied:385.72,latitude:28.816222,longitude:-81.87225},{facility_name:"NORTHEAST PUBLIC SEWER DISTRICT",city:"Fenton",state:"Mo.",amount_of_biosolids_generated:385,amount_of_biosolids_managed_land_applied:385.109,latitude:38.49885,longitude:-90.46305},{facility_name:"WEST MELBOURNE/RAY BULLARD",city:"West Melbourne",state:"Fla.",amount_of_biosolids_generated:384,amount_of_biosolids_managed_land_applied:0,latitude:28.07159,longitude:-80.64462},{facility_name:"BERWICK MUN AUTH",city:"Berwick",state:"Pa.",amount_of_biosolids_generated:384,amount_of_biosolids_managed_land_applied:0,latitude:41.04243,longitude:-76.26222},{facility_name:"REED CREEK WPCP",city:"Martinez",state:"Ga.",amount_of_biosolids_generated:384,amount_of_biosolids_managed_land_applied:384.14,latitude:33.540139,longitude:-82.051444},{facility_name:"OLIVEHURST WWTP",city:"Olivehurst",state:"Calif.",amount_of_biosolids_generated:383,amount_of_biosolids_managed_land_applied:0,latitude:39.07707992,longitude:-121.5589546},{facility_name:"CORVALLIS, CITY OF",city:"Corvallis",state:"Ore.",amount_of_biosolids_generated:383,amount_of_biosolids_managed_land_applied:383,latitude:44.576071,longitude:-123.254392},{facility_name:"WILSONVILLE, CITY OF",city:"Wilsonville",state:"Ore.",amount_of_biosolids_generated:383,amount_of_biosolids_managed_land_applied:335.17,latitude:45.294943,longitude:-122.771814},{facility_name:"NORTHFIELD WWTF",city:"Northfield",state:"Va.",amount_of_biosolids_generated:382,amount_of_biosolids_managed_land_applied:0,latitude:44.16312,longitude:-72.657191},{facility_name:"PRASA CAROLINA RWWTP",city:"San Juan",state:"Pa.",amount_of_biosolids_generated:381,amount_of_biosolids_managed_land_applied:0,latitude:18.4064087,longitude:-66.0640039},{facility_name:"LOVES COUNTRY STORE 250",city:"Oklahoma City",state:"Okla.",amount_of_biosolids_generated:381,amount_of_biosolids_managed_land_applied:0,latitude:35.18965,longitude:-102.01109},{facility_name:"HENRY COUNTY WATER AUTHORITY (INDIAN CREEK WRF)",city:"Locust Grove",state:"Ga.",amount_of_biosolids_generated:381,amount_of_biosolids_managed_land_applied:173.6,latitude:33.326382,longitude:-84.132934},{facility_name:"WINDSOR WWTF",city:"Windsor",state:"Calif.",amount_of_biosolids_generated:381,amount_of_biosolids_managed_land_applied:376.82,latitude:38.54651776,longitude:-122.8107056},{facility_name:"MCCANDLESS TOWNSHIP SANITARY A",city:"Pittsburgh",state:"Pa.",amount_of_biosolids_generated:380,amount_of_biosolids_managed_land_applied:0,latitude:40.578627,longitude:-80.031317},{facility_name:"NORRISTOWN BOROUGH WASTEWATER",city:"Norristown",state:"Pa.",amount_of_biosolids_generated:380,amount_of_biosolids_managed_land_applied:0,latitude:40.10997,longitude:-75.33692},{facility_name:"MEADVILLE",city:"Meadville",state:"Pa.",amount_of_biosolids_generated:380,amount_of_biosolids_managed_land_applied:0,latitude:41.625842,longitude:-80.157544},{facility_name:"RICHMOND REGIONAL WWTP",city:"Richmond",state:"Texas",amount_of_biosolids_generated:379,amount_of_biosolids_managed_land_applied:379.46,latitude:29.569103,longitude:-95.754282},{facility_name:"WINDSOR TOWN OF",city:"Windsor",state:"Colo.",amount_of_biosolids_generated:379,amount_of_biosolids_managed_land_applied:275.97,latitude:40.47852,longitude:-104.90133},{facility_name:"HARRISON CO UTILITY AUTHORITY, EAST BILOXI POTW",city:"Biloxi",state:"Mo.",amount_of_biosolids_generated:379,amount_of_biosolids_managed_land_applied:379,latitude:30.405833,longitude:-88.897139},{facility_name:"HURON, CITY OF",city:"Huron, City Of",state:"S.D.",amount_of_biosolids_generated:379,amount_of_biosolids_managed_land_applied:0,latitude:44.360235,longitude:-98.15547},{facility_name:"MIDWAY SEWER DISTRICT WWTP",city:"Kent",state:"Wash.",amount_of_biosolids_generated:379,amount_of_biosolids_managed_land_applied:378.99,latitude:47.411213,longitude:-122.318256},{facility_name:"REDDING STILLWATER WWTP",city:"Anderson",state:"Calif.",amount_of_biosolids_generated:378,amount_of_biosolids_managed_land_applied:0,latitude:40.45970741,longitude:-122.2871596},{facility_name:"CITY OF KINSTON",city:"Kinston",state:"Mont.",amount_of_biosolids_generated:378,amount_of_biosolids_managed_land_applied:378,latitude:35.28924,longitude:-77.51528},{facility_name:"SOUTH SAN LUIS OBISPO WWTP",city:"Oceano",state:"Calif.",amount_of_biosolids_generated:378,amount_of_biosolids_managed_land_applied:377.84,latitude:35.06050098,longitude:-120.6027},{facility_name:"LAS GALLINAS VALLEY STP",city:"San Rafael",state:"Calif.",amount_of_biosolids_generated:376,amount_of_biosolids_managed_land_applied:238.96,latitude:38.025278,longitude:-122.52},{facility_name:"FAIRMONT WWTP, CITY OF",city:"Fairmont",state:"Wis.",amount_of_biosolids_generated:376,amount_of_biosolids_managed_land_applied:350.45,latitude:39.494432,longitude:-80.121973},{facility_name:"VICKSBURG POTW",city:"Vicksburg",state:"Mo.",amount_of_biosolids_generated:375,amount_of_biosolids_managed_land_applied:375.23,latitude:32.29563,longitude:-90.89917},{facility_name:"COOS BAY STP NO. 1",city:"Coos Bay",state:"Ore.",amount_of_biosolids_generated:375,amount_of_biosolids_managed_land_applied:326.4,latitude:43.378247,longitude:-124.219065},{facility_name:"DAPHNE UB CITY OF UTILITIES BD",city:"Daphne",state:"Alaska",amount_of_biosolids_generated:375,amount_of_biosolids_managed_land_applied:0,latitude:30.651203,longitude:-87.911622},{facility_name:"LCDPW - MILL CREEK WRF",city:"Old Mill Creek",state:"Iowa",amount_of_biosolids_generated:373,amount_of_biosolids_managed_land_applied:373,latitude:42.413716,longitude:-87.958671},{facility_name:"SOCWA 3A WWTP",city:"Laguna Niguel",state:"Calif.",amount_of_biosolids_generated:371,amount_of_biosolids_managed_land_applied:0,latitude:33.57669714,longitude:-117.7244287},{facility_name:"WARRENTON STP",city:"Warrenton",state:"Utah",amount_of_biosolids_generated:370,amount_of_biosolids_managed_land_applied:280.21,latitude:38.71584,longitude:-77.81612},{facility_name:"LAWRENCEBURG STP",city:"Lawrenceburg",state:"Ky.",amount_of_biosolids_generated:370,amount_of_biosolids_managed_land_applied:0,latitude:38.043333,longitude:-84.9225},{facility_name:"NEW CANAAN STP",city:"New Canaan",state:"Conn.",amount_of_biosolids_generated:369,amount_of_biosolids_managed_land_applied:0,latitude:41.148147,longitude:-73.492943},{facility_name:"SUFFERN (V)",city:"Suffern",state:"N.D.",amount_of_biosolids_generated:369,amount_of_biosolids_managed_land_applied:0,latitude:41.11409,longitude:-74.14964},{facility_name:"CHOCOLATE BAYOU WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:369,amount_of_biosolids_managed_land_applied:0,latitude:29.6458,longitude:-95.338291},{facility_name:"BROOKINGS MUNICIPAL UTILITIES",city:"Brookings, City Of",state:"S.D.",amount_of_biosolids_generated:368,amount_of_biosolids_managed_land_applied:296.55,latitude:44.244351,longitude:-96.806507},{facility_name:"FALLSBURG (T)",city:"South Fallsburg",state:"N.D.",amount_of_biosolids_generated:368,amount_of_biosolids_managed_land_applied:0,latitude:41.70866881,longitude:-74.62630095},{facility_name:"TREMONTON CITY",city:"Tremonton",state:"Utah",amount_of_biosolids_generated:368,amount_of_biosolids_managed_land_applied:744.5,latitude:41.699093,longitude:-112.160814},{facility_name:"LOWER ALLEN TOWNSHIP AUTHORITY",city:"New Cumberland",state:"Pa.",amount_of_biosolids_generated:367,amount_of_biosolids_managed_land_applied:367,latitude:40.226111,longitude:-76.858889},{facility_name:"HARRIS COUNTY WCID 111 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:367,amount_of_biosolids_managed_land_applied:0,latitude:29.687771,longitude:-95.302041},{facility_name:"WAYNESBORO DEPT OF UTILITIES-S",city:"Waynesboro",state:"Utah",amount_of_biosolids_generated:366,amount_of_biosolids_managed_land_applied:0,latitude:38.080536,longitude:-78.874625},{facility_name:"LOUISVILLE CITY OF",city:"Louisville",state:"Colo.",amount_of_biosolids_generated:366,amount_of_biosolids_managed_land_applied:0,latitude:39.97742,longitude:-105.13212},{facility_name:"LITITZ SEWAGE AUTHORITY",city:"Lititz-Lancaster County",state:"Pa.",amount_of_biosolids_generated:366,amount_of_biosolids_managed_land_applied:366.22,latitude:40.15321,longitude:-76.28419},{facility_name:"MOON TOWNSHIP MUNICIPAL AUTHOR",city:"Corapolis",state:"Pa.",amount_of_biosolids_generated:365,amount_of_biosolids_managed_land_applied:0,latitude:40.49659,longitude:-80.20141},{facility_name:"CITY OF AMERICUS",city:"Americus",state:"Ga.",amount_of_biosolids_generated:364,amount_of_biosolids_managed_land_applied:0,latitude:32.037472,longitude:-84.231667},{facility_name:"UXBRIDGE W W T F",city:"Uxbridge",state:"Mass.",amount_of_biosolids_generated:364,amount_of_biosolids_managed_land_applied:0,latitude:42.03692,longitude:-71.61378},{facility_name:"N LAREDO WWTP",city:"Laredo",state:"Texas",amount_of_biosolids_generated:362,amount_of_biosolids_managed_land_applied:0,latitude:27.596667,longitude:-99.468639},{facility_name:"KINGSTON (C)",city:"Kingston",state:"N.D.",amount_of_biosolids_generated:362,amount_of_biosolids_managed_land_applied:0,latitude:41.92672,longitude:-73.9965},{facility_name:"LEBANON, CITY OF",city:"Lebanon",state:"Ore.",amount_of_biosolids_generated:361,amount_of_biosolids_managed_land_applied:361,latitude:44.549989,longitude:-122.897701},{facility_name:"GSW&SA/CONWAY WWTP",city:"Conway",state:"S.C.",amount_of_biosolids_generated:361,amount_of_biosolids_managed_land_applied:361,latitude:33.819393,longitude:-79.065931},{facility_name:"BRAWLEY WWTP",city:"Brawley",state:"Calif.",amount_of_biosolids_generated:361,amount_of_biosolids_managed_land_applied:0,latitude:32.95636,longitude:-115.525392},{facility_name:"EUREKA ELK RIVER WWTP",city:"Eureka",state:"Calif.",amount_of_biosolids_generated:360,amount_of_biosolids_managed_land_applied:360.1,latitude:40.79477338,longitude:-124.1521118},{facility_name:"HUMACAO MONOFILL",city:"Humacao",state:"Pa.",amount_of_biosolids_generated:360,amount_of_biosolids_managed_land_applied:0,latitude:18.15672008,longitude:-65.81883351},{facility_name:"EAST CEDAR CREEK FWSD NORTH WWTP",city:"Maybank",state:"Texas",amount_of_biosolids_generated:359,amount_of_biosolids_managed_land_applied:0,latitude:32.320461,longitude:-96.129972},{facility_name:"HUTTO SOUTH WWTP",city:"Hutto",state:"Texas",amount_of_biosolids_generated:359,amount_of_biosolids_managed_land_applied:0,latitude:30.50267,longitude:-97.52372},{facility_name:"BULL HIDE CREEK WWTP",city:"Waco",state:"Texas",amount_of_biosolids_generated:358,amount_of_biosolids_managed_land_applied:0,latitude:31.40494,longitude:-97.18005},{facility_name:"CITY OF WILLIS WWTP",city:"Willis",state:"Texas",amount_of_biosolids_generated:357,amount_of_biosolids_managed_land_applied:0,latitude:30.395797,longitude:-95.474353},{facility_name:"JEFFERSON COUNTY COMMISSION ENVIRONMENTAL SERVICES DEPARTMENT",city:"Birmingham",state:"Alaska",amount_of_biosolids_generated:357,amount_of_biosolids_managed_land_applied:357,latitude:33.61976,longitude:-86.60356},{facility_name:"RIDGEWOOD VILLAGE OF WPCP",city:"Ridgewood",state:"Neb.",amount_of_biosolids_generated:356,amount_of_biosolids_managed_land_applied:356.41,latitude:40.962348,longitude:-74.105698},{facility_name:"CINNAMINSON SA",city:"Cinnaminson",state:"Neb.",amount_of_biosolids_generated:356,amount_of_biosolids_managed_land_applied:215.35,latitude:40.01453,longitude:-75.00622},{facility_name:"FLOYD BRANCH REGIONAL WWTP",city:"Wylie",state:"Texas",amount_of_biosolids_generated:355,amount_of_biosolids_managed_land_applied:0,latitude:32.937123,longitude:-96.738728},{facility_name:"SPEEDWAY WWTP",city:"Speedway",state:"Iowa",amount_of_biosolids_generated:355,amount_of_biosolids_managed_land_applied:0,latitude:39.770694,longitude:-86.232306},{facility_name:"EAGLE MOUNTAIN WWTP",city:"Eagle Mountain",state:"Utah",amount_of_biosolids_generated:355,amount_of_biosolids_managed_land_applied:0,latitude:40.35472,longitude:-111.99935},{facility_name:"NV REGIONAL WASTEWATER TREATMENT FACILITY",city:"Niceville",state:"Fla.",amount_of_biosolids_generated:355,amount_of_biosolids_managed_land_applied:354.66,latitude:30.53133,longitude:-86.49341},{facility_name:"ANDERSON/GENEROSTEE CREEK",city:"Anderson",state:"S.C.",amount_of_biosolids_generated:355,amount_of_biosolids_managed_land_applied:354.65,latitude:34.4725,longitude:-82.723611},{facility_name:"MONROE STP",city:"Monroe",state:"Wash.",amount_of_biosolids_generated:355,amount_of_biosolids_managed_land_applied:354.64,latitude:47.848656,longitude:-121.976137},{facility_name:"CASEYVILLE TOWNSHIP",city:"O'Fallon",state:"Iowa",amount_of_biosolids_generated:355,amount_of_biosolids_managed_land_applied:337.8,latitude:38.59744,longitude:-89.96216},{facility_name:"CITY OF GRANBURY WWTP",city:"Granbury",state:"Texas",amount_of_biosolids_generated:355,amount_of_biosolids_managed_land_applied:0,latitude:32.417639,longitude:-97.775307},{facility_name:"SUMNER STP",city:"Sumner",state:"Wash.",amount_of_biosolids_generated:354,amount_of_biosolids_managed_land_applied:493.1,latitude:47.200001,longitude:-122.255798},{facility_name:"UNIFIED GOVERNMENT OF ATHENS-CLARKE CO (CEDAR CR)",city:"Athens",state:"Ga.",amount_of_biosolids_generated:354,amount_of_biosolids_managed_land_applied:353.64,latitude:33.872306,longitude:-83.336139},{facility_name:"SEYMOUR WPCF, TOWN OF",city:"Seymour",state:"Conn.",amount_of_biosolids_generated:354,amount_of_biosolids_managed_land_applied:0,latitude:41.367783,longitude:-73.088606},{facility_name:"HARRISON BROOK STP",city:"Bernards Twp",state:"Neb.",amount_of_biosolids_generated:353,amount_of_biosolids_managed_land_applied:0,latitude:40.6561,longitude:-74.5744},{facility_name:"WINTER HAVEN WWTP #2",city:"Winter Haven",state:"Fla.",amount_of_biosolids_generated:353,amount_of_biosolids_managed_land_applied:0,latitude:27.951798,longitude:-81.7091},{facility_name:"CITY OF NIXA",city:"Nixa",state:"Mo.",amount_of_biosolids_generated:353,amount_of_biosolids_managed_land_applied:379.2,latitude:37.037066,longitude:-93.317792},{facility_name:"WOODSTOCK NORTH STP",city:"Woodstock",state:"Iowa",amount_of_biosolids_generated:352,amount_of_biosolids_managed_land_applied:387.21,latitude:42.33771,longitude:-88.44802},{facility_name:"COACHELLA AVENUE 54 WWTP",city:"Coachella",state:"Calif.",amount_of_biosolids_generated:352,amount_of_biosolids_managed_land_applied:0,latitude:33.685745,longitude:-116.1675911},{facility_name:"TOWN OF CAROLINA BEACH",city:"Carolina Beach",state:"Mont.",amount_of_biosolids_generated:352,amount_of_biosolids_managed_land_applied:0,latitude:34.032138,longitude:-77.912472},{facility_name:"BURLINGTON WWTP",city:"Burlington",state:"Wash.",amount_of_biosolids_generated:352,amount_of_biosolids_managed_land_applied:352,latitude:48.46748,longitude:-122.312867},{facility_name:"CARPINTERIA WWTP",city:"Carpinteria",state:"Calif.",amount_of_biosolids_generated:350,amount_of_biosolids_managed_land_applied:0,latitude:34.393168,longitude:-119.51585},{facility_name:"TOWN OF TARBORO",city:"Tarboro",state:"Mont.",amount_of_biosolids_generated:350,amount_of_biosolids_managed_land_applied:349.82,latitude:35.8832,longitude:-77.5383},{facility_name:"WOODCLIFF SEWERAGE TREATMENT",city:"North Bergen",state:"Neb.",amount_of_biosolids_generated:350,amount_of_biosolids_managed_land_applied:0,latitude:40.7916,longitude:-73.9986},{facility_name:"MARYLAND CORRECTIONAL INSTI",city:"Hagerstown",state:"Mass.",amount_of_biosolids_generated:349,amount_of_biosolids_managed_land_applied:347.39,latitude:39.555833,longitude:-77.708889},{facility_name:"WINDERMERE WWTP",city:"Sugar Land",state:"Texas",amount_of_biosolids_generated:347,amount_of_biosolids_managed_land_applied:0,latitude:30.456861,longitude:-97.640833},{facility_name:"BURLINGTON CITY STP",city:"Burlington",state:"Neb.",amount_of_biosolids_generated:347,amount_of_biosolids_managed_land_applied:346.51,latitude:40.079611,longitude:-74.871943},{facility_name:"CITY OF CARTHAGE",city:"Carthage",state:"Mo.",amount_of_biosolids_generated:347,amount_of_biosolids_managed_land_applied:346.5,latitude:37.176495,longitude:-94.309791},{facility_name:"SILVERTHORNE DILLON JOINT SEWER AUTHORITY",city:"Silverthorne",state:"Colo.",amount_of_biosolids_generated:346,amount_of_biosolids_managed_land_applied:55.76,latitude:39.6540115,longitude:-106.0924425},{facility_name:"PERU UTILITIES WWTP",city:"Peru",state:"Iowa",amount_of_biosolids_generated:344,amount_of_biosolids_managed_land_applied:344.3,latitude:40.755625,longitude:-86.057105},{facility_name:"ABERDEEN, CITY OF (BIOSOLIDS)",city:"Aberdeen, City Of",state:"S.D.",amount_of_biosolids_generated:344,amount_of_biosolids_managed_land_applied:0,latitude:45.428557,longitude:-98.478871},{facility_name:"JONESBORO, CITY WATER & LIGHT",city:"Jonesboro",state:"Alaska",amount_of_biosolids_generated:343,amount_of_biosolids_managed_land_applied:343,latitude:35.85924,longitude:-90.73015},{facility_name:"BOLINGBROOK WRF #2, VILLAGE OF",city:"Bolingbrook",state:"Iowa",amount_of_biosolids_generated:343,amount_of_biosolids_managed_land_applied:343,latitude:41.70433,longitude:-88.11443},{facility_name:"ROSEBURG URBAN SANITARY",city:"Roseburg",state:"Ore.",amount_of_biosolids_generated:343,amount_of_biosolids_managed_land_applied:342.75,latitude:43.208918,longitude:-123.396131},{facility_name:"MOKENA STP, VILLAGE OF",city:"Mokena",state:"Iowa",amount_of_biosolids_generated:343,amount_of_biosolids_managed_land_applied:342.98,latitude:41.54233,longitude:-87.8946},{facility_name:"CITY OF SEDALIA",city:"Sedalia",state:"Mo.",amount_of_biosolids_generated:343,amount_of_biosolids_managed_land_applied:0,latitude:38.70972,longitude:-93.22888},{facility_name:"PACIFICA CALERA CREEK WRF",city:"Pacifica",state:"Calif.",amount_of_biosolids_generated:342,amount_of_biosolids_managed_land_applied:342.3,latitude:37.635207,longitude:-122.490689},{facility_name:"UC DAVIS MAIN WWTP",city:"Davis",state:"Calif.",amount_of_biosolids_generated:342,amount_of_biosolids_managed_land_applied:0,latitude:38.54061,longitude:-121.74814},{facility_name:"FILLMORE WRP",city:"Fillmore",state:"Calif.",amount_of_biosolids_generated:341,amount_of_biosolids_managed_land_applied:0,latitude:34.39339237,longitude:-118.9317319},{facility_name:"HIGHLAND WATER RECLAMATION",city:"Highland",state:"Iowa",amount_of_biosolids_generated:341,amount_of_biosolids_managed_land_applied:324.4,latitude:38.72307,longitude:-89.65254},{facility_name:"HOGS BAYOU WWTP",city:"Carthage",state:"Texas",amount_of_biosolids_generated:341,amount_of_biosolids_managed_land_applied:340.842,latitude:32.158787,longitude:-94.293073},{facility_name:"CHESTERTON WWTP, TOWN OF",city:"Porter",state:"Iowa",amount_of_biosolids_generated:341,amount_of_biosolids_managed_land_applied:373.71,latitude:41.619079,longitude:-87.064105},{facility_name:"CORAL SPRINGS IMP DIST WWTF",city:"Coral Springs",state:"Fla.",amount_of_biosolids_generated:340,amount_of_biosolids_managed_land_applied:374.83,latitude:26.2451,longitude:-80.26218},{facility_name:"SOUTHWEST WWTP",city:"Humble",state:"Texas",amount_of_biosolids_generated:340,amount_of_biosolids_managed_land_applied:0,latitude:29.999003,longitude:-95.265123},{facility_name:"BLACK'S CREEK WTP",city:"Bordentown",state:"Neb.",amount_of_biosolids_generated:339,amount_of_biosolids_managed_land_applied:339.24,latitude:40.13642,longitude:-74.70424},{facility_name:"CITY OF BIG SPRING WATER RECLAMATION PLANT WWTP",city:"Big Spring",state:"Texas",amount_of_biosolids_generated:339,amount_of_biosolids_managed_land_applied:0,latitude:32.255156,longitude:-101.42842},{facility_name:"SANFORD/SOUTH WRF #2",city:"Sanford",state:"Fla.",amount_of_biosolids_generated:338,amount_of_biosolids_managed_land_applied:0,latitude:28.75979,longitude:-81.21427},{facility_name:"LYNDEN STP",city:"Lynden",state:"Wash.",amount_of_biosolids_generated:338,amount_of_biosolids_managed_land_applied:360,latitude:48.938274,longitude:-122.451376},{facility_name:"LINTON WWTP, CITY OF",city:"Linton",state:"Iowa",amount_of_biosolids_generated:337,amount_of_biosolids_managed_land_applied:260.94,latitude:39.03102,longitude:-87.15253},{facility_name:"TNSA SEWAGE TREATMENT PLT",city:"Neptune",state:"Neb.",amount_of_biosolids_generated:337,amount_of_biosolids_managed_land_applied:0,latitude:40.201151,longitude:-74.062998},{facility_name:"PORT ANGELES WWTP",city:"Port Angeles",state:"Wash.",amount_of_biosolids_generated:337,amount_of_biosolids_managed_land_applied:293.93,latitude:48.11164,longitude:-123.403035},{facility_name:"WALKER, TOWN OF",city:"Walker",state:"La.",amount_of_biosolids_generated:336,amount_of_biosolids_managed_land_applied:336.4,latitude:30.480782,longitude:-90.871776},{facility_name:"WESTERN WESTMORELAND STP",city:"North Huntingdon",state:"Pa.",amount_of_biosolids_generated:336,amount_of_biosolids_managed_land_applied:0,latitude:40.340854,longitude:-79.730035},{facility_name:"HAVRE DE GRACE WWTP",city:"Havre De Grace",state:"Mass.",amount_of_biosolids_generated:336,amount_of_biosolids_managed_land_applied:336.07,latitude:39.531389,longitude:-76.098611},{facility_name:"RIVERTON, CITY OF",city:"Riverton",state:"Wyo.",amount_of_biosolids_generated:336,amount_of_biosolids_managed_land_applied:306,latitude:43.03203,longitude:-108.38064},{facility_name:"FORT BEND COUNTY WCID 2",city:"Stafford",state:"Texas",amount_of_biosolids_generated:336,amount_of_biosolids_managed_land_applied:0,latitude:29.604352,longitude:-95.554741},{facility_name:"SEQUIM WATER RECLAMATION FACILITY",city:"Sequim",state:"Wash.",amount_of_biosolids_generated:334,amount_of_biosolids_managed_land_applied:333.93,latitude:48.084852,longitude:-123.063322},{facility_name:"LAFAYETTE CONSOLIDATED GOVERNMENT - EAST WWTP",city:"Lafayette",state:"La.",amount_of_biosolids_generated:334,amount_of_biosolids_managed_land_applied:333.9,latitude:30.218582,longitude:-92.002676},{facility_name:"GREAT NECK WPC DISTRICT",city:"Great Neck",state:"N.D.",amount_of_biosolids_generated:333,amount_of_biosolids_managed_land_applied:0,latitude:40.79524,longitude:-73.71284},{facility_name:"CITY OF LAKE JACKSON WWTF",city:"Lake Jackson",state:"Texas",amount_of_biosolids_generated:333,amount_of_biosolids_managed_land_applied:333.11,latitude:29.025556,longitude:-95.455735},{facility_name:"PITTSBURG, CITY OF",city:"Pittsburg",state:"Kan.",amount_of_biosolids_generated:333,amount_of_biosolids_managed_land_applied:333.06,latitude:37.417915,longitude:-94.70710034},{facility_name:"BLOOMINGTON-NORMAL WRD SE WWTP",city:"Heyworth",state:"Iowa",amount_of_biosolids_generated:333,amount_of_biosolids_managed_land_applied:267,latitude:40.494683,longitude:-88.959697},{facility_name:"REHOBOTH BEACH STP",city:"Rehoboth Beach",state:"D.C.",amount_of_biosolids_generated:333,amount_of_biosolids_managed_land_applied:29.31,latitude:38.700111,longitude:-75.093278},{facility_name:"CALEXICO, CITY OF",city:"Calexico",state:"Calif.",amount_of_biosolids_generated:331,amount_of_biosolids_managed_land_applied:0,latitude:32.671207,longitude:-115.49351},{facility_name:"BENTON, CITY OF",city:"Benton",state:"Alaska",amount_of_biosolids_generated:330,amount_of_biosolids_managed_land_applied:325,latitude:34.555,longitude:-92.593889},{facility_name:"OSWEGO (C)",city:"Oswego",state:"N.D.",amount_of_biosolids_generated:330,amount_of_biosolids_managed_land_applied:0,latitude:43.43439725,longitude:-76.46629528},{facility_name:"PRASA VEGA BAJA STP",city:"Vega Baja",state:"Pa.",amount_of_biosolids_generated:330,amount_of_biosolids_managed_land_applied:329.91,latitude:18.45305562,longitude:-66.41259214},{facility_name:"CITY OF CHATSWORTH",city:"Chatsworth",state:"Ga.",amount_of_biosolids_generated:329,amount_of_biosolids_managed_land_applied:0,latitude:34.758607,longitude:-84.764205},{facility_name:"CITY OF WEST PLAINS",city:"West Plains",state:"Mo.",amount_of_biosolids_generated:328,amount_of_biosolids_managed_land_applied:225.92,latitude:36.753547,longitude:-91.872167},{facility_name:"HARRIS COUNTY MUD 157 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:328,amount_of_biosolids_managed_land_applied:0,latitude:29.711951,longitude:-95.483449},{facility_name:"NORTH HAVEN WPCF",city:"North Haven",state:"Conn.",amount_of_biosolids_generated:327,amount_of_biosolids_managed_land_applied:0,latitude:41.364329,longitude:-72.871671},{facility_name:"NEW MILFORD WPCF, TOWN OF",city:"New Milford",state:"Conn.",amount_of_biosolids_generated:326,amount_of_biosolids_managed_land_applied:0,latitude:41.56931,longitude:-73.40915},{facility_name:"SOMERSET W P C F",city:"Somerset",state:"Mass.",amount_of_biosolids_generated:326,amount_of_biosolids_managed_land_applied:0,latitude:41.7175,longitude:-71.168889},{facility_name:"BENICIA WWTP",city:"Benicia",state:"Calif.",amount_of_biosolids_generated:325,amount_of_biosolids_managed_land_applied:0,latitude:38.045309,longitude:-122.150883},{facility_name:"OSWEGO (C)",city:"Oswego",state:"N.D.",amount_of_biosolids_generated:324,amount_of_biosolids_managed_land_applied:0,latitude:43.43439725,longitude:-76.46629528},{facility_name:"CHEMUNG COUNTY SEWER DISTRICTS",city:"Elmira",state:"N.D.",amount_of_biosolids_generated:323,amount_of_biosolids_managed_land_applied:0,latitude:42.07685,longitude:-76.77893},{facility_name:"WESLACO NORTH WWTP",city:"Weslaco",state:"Texas",amount_of_biosolids_generated:323,amount_of_biosolids_managed_land_applied:0,latitude:26.17575,longitude:-97.979944},{facility_name:"HAMMONTON WTPF",city:"Hammonton",state:"Neb.",amount_of_biosolids_generated:323,amount_of_biosolids_managed_land_applied:0,latitude:39.633173,longitude:-74.76719},{facility_name:"CITY OF OLDSMAR",city:"Oldsmar",state:"Fla.",amount_of_biosolids_generated:322,amount_of_biosolids_managed_land_applied:0,latitude:28.02925,longitude:-82.654111},{facility_name:"CITY OF HANNIBAL",city:"Hannibal",state:"Mo.",amount_of_biosolids_generated:322,amount_of_biosolids_managed_land_applied:0,latitude:39.709126,longitude:-91.357109},{facility_name:"MAYNARD W W T F",city:"Maynard",state:"Mass.",amount_of_biosolids_generated:322,amount_of_biosolids_managed_land_applied:0,latitude:42.44063,longitude:-71.44248},{facility_name:"JOINT BASE LEWIS-MCCHORD",city:"Jblm",state:"Wash.",amount_of_biosolids_generated:321,amount_of_biosolids_managed_land_applied:309,latitude:47.09033,longitude:-122.6088},{facility_name:"SELAH POTW",city:"Selah",state:"Wash.",amount_of_biosolids_generated:321,amount_of_biosolids_managed_land_applied:320.9,latitude:46.649444,longitude:-120.523657},{facility_name:"SCOTTSVILLE STP",city:"Scottsville",state:"Ky.",amount_of_biosolids_generated:321,amount_of_biosolids_managed_land_applied:0,latitude:36.751389,longitude:-86.200833},{facility_name:"CITY OF DURHAM",city:"Durham",state:"Mont.",amount_of_biosolids_generated:320,amount_of_biosolids_managed_land_applied:0,latitude:35.99597,longitude:-78.8996},{facility_name:"CITY OF KAUFMAN WWTP",city:"Kaufman",state:"Texas",amount_of_biosolids_generated:319,amount_of_biosolids_managed_land_applied:0,latitude:32.560389,longitude:-96.297194},{facility_name:"DYER WASTEWATER TREATMENT PLANT",city:"Dyer",state:"Iowa",amount_of_biosolids_generated:319,amount_of_biosolids_managed_land_applied:318.56,latitude:41.499611,longitude:-87.515861},{facility_name:"EAST HONOLULU WWTP",city:"Honolulu",state:"Hawaii",amount_of_biosolids_generated:319,amount_of_biosolids_managed_land_applied:0,latitude:21.287333,longitude:-157.671833},{facility_name:"PORT JERVIS STP",city:"Port Jervis",state:"N.D.",amount_of_biosolids_generated:318,amount_of_biosolids_managed_land_applied:0,latitude:41.36810234,longitude:-74.67454854},{facility_name:"DENISON MUNICIPAL UTILITIES",city:"Denison",state:"Hawaii",amount_of_biosolids_generated:318,amount_of_biosolids_managed_land_applied:317.96,latitude:42.01676,longitude:-95.36349},{facility_name:"WALTON (V)",city:"Walton",state:"N.D.",amount_of_biosolids_generated:318,amount_of_biosolids_managed_land_applied:0,latitude:42.16876,longitude:-75.12795},{facility_name:"FALLBROOK PUBLIC UTILITY DISTRICT WATER RECLAMATION PLANT",city:"Fallbrook",state:"Calif.",amount_of_biosolids_generated:317,amount_of_biosolids_managed_land_applied:223.3,latitude:33.382025,longitude:-117.1866255},{facility_name:"ATHOL W W T P",city:"Athol",state:"Mass.",amount_of_biosolids_generated:317,amount_of_biosolids_managed_land_applied:0,latitude:42.586234,longitude:-72.242982},{facility_name:"MILLBRAE WPCP",city:"Millbrae",state:"Calif.",amount_of_biosolids_generated:316,amount_of_biosolids_managed_land_applied:316.05,latitude:37.58166004,longitude:-122.4336851},{facility_name:"LAKE OF THE OZARKS REGION",city:"Lake Ozark",state:"Mo.",amount_of_biosolids_generated:316,amount_of_biosolids_managed_land_applied:316,latitude:38.18284,longitude:-92.59715},{facility_name:"CITY OF KEENE WWTP",city:"Keene",state:"Texas",amount_of_biosolids_generated:315,amount_of_biosolids_managed_land_applied:0,latitude:32.395139,longitude:-97.284167},{facility_name:"MWRDGC LEMONT WRP",city:"Lemont",state:"Iowa",amount_of_biosolids_generated:315,amount_of_biosolids_managed_land_applied:0,latitude:41.67699,longitude:-87.99996},{facility_name:"EAGLE PASS WWTF",city:"Eagle Pass",state:"Texas",amount_of_biosolids_generated:314,amount_of_biosolids_managed_land_applied:314.34,latitude:28.648891,longitude:-100.453502},{facility_name:"DOUGLAS COUNTY LAKE TAHOE SEWER AUTHORITY",city:"Zephyr Cove",state:"N.D.",amount_of_biosolids_generated:313,amount_of_biosolids_managed_land_applied:313,latitude:39.03540773,longitude:-119.9488866},{facility_name:"MILLER CREEK WWTP",city:"Normandy Park",state:"Wash.",amount_of_biosolids_generated:313,amount_of_biosolids_managed_land_applied:312.5,latitude:47.448261,longitude:-122.347575},{facility_name:"BRIDGEWATER W W T F",city:"Bridgewater",state:"Mass.",amount_of_biosolids_generated:312,amount_of_biosolids_managed_land_applied:312,latitude:41.9947,longitude:-70.9663},{facility_name:"PEMBERTON TOWNSHIP MUA STP",city:"Pemberton",state:"Neb.",amount_of_biosolids_generated:312,amount_of_biosolids_managed_land_applied:157.66,latitude:39.97342068,longitude:-74.68372376},{facility_name:"TROY CITY OF WALNUT CREEK WWTP",city:"Troy",state:"Alaska",amount_of_biosolids_generated:312,amount_of_biosolids_managed_land_applied:311.86,latitude:31.7692,longitude:-85.9261},{facility_name:"CITY OF LEBANON",city:"Lebanon",state:"Mo.",amount_of_biosolids_generated:311,amount_of_biosolids_managed_land_applied:311.164,latitude:37.68123667,longitude:-92.66027826},{facility_name:"CITY OF OZARK",city:"Ozark",state:"Mo.",amount_of_biosolids_generated:311,amount_of_biosolids_managed_land_applied:333.32,latitude:37.00068371,longitude:-93.22688555},{facility_name:"ERIE COUNTY SD#6",city:"Buffalo",state:"N.D.",amount_of_biosolids_generated:311,amount_of_biosolids_managed_land_applied:0,latitude:42.88376,longitude:-78.87736},{facility_name:"ARLINGTON STP",city:"Arlington",state:"Wash.",amount_of_biosolids_generated:311,amount_of_biosolids_managed_land_applied:310.83,latitude:48.201193,longitude:-122.128347},{facility_name:"TOWN OF LA PLATA",city:"La Plata",state:"Mass.",amount_of_biosolids_generated:311,amount_of_biosolids_managed_land_applied:0,latitude:38.529482,longitude:-76.985787},{facility_name:"CITY OF MASON CITY",city:"Mason City",state:"Hawaii",amount_of_biosolids_generated:311,amount_of_biosolids_managed_land_applied:310.8,latitude:43.15271,longitude:-93.20141},{facility_name:"CITY OF SUMMERVILLE",city:"Summerville",state:"Ga.",amount_of_biosolids_generated:310,amount_of_biosolids_managed_land_applied:310.257,latitude:34.459167,longitude:-85.344639},{facility_name:"BUFFALO",city:"Buffalo",state:"Minn.",amount_of_biosolids_generated:310,amount_of_biosolids_managed_land_applied:0,latitude:45.11536,longitude:-93.89093},{facility_name:"WOOD RIVER STP, CITY OF",city:"Wood River",state:"Iowa",amount_of_biosolids_generated:310,amount_of_biosolids_managed_land_applied:0,latitude:38.846946,longitude:-90.098519},{facility_name:"TERREBONNE PARISH CONS. GOVT.",city:"Houma",state:"La.",amount_of_biosolids_generated:309,amount_of_biosolids_managed_land_applied:0,latitude:29.62938,longitude:-90.736201},{facility_name:"IRON MOUNTAIN/KINGSFORD JOINT SEWAGE AUTHORITY",city:"Kingsford",state:"Mich.",amount_of_biosolids_generated:308,amount_of_biosolids_managed_land_applied:308.33,latitude:0,longitude:0},{facility_name:"DIXON STP, CITY OF",city:"Dixon",state:"Iowa",amount_of_biosolids_generated:308,amount_of_biosolids_managed_land_applied:0,latitude:41.8359,longitude:-89.5103},{facility_name:"BEMIDJI",city:"Bemidji",state:"Minn.",amount_of_biosolids_generated:308,amount_of_biosolids_managed_land_applied:308,latitude:47.46828,longitude:-94.879704},{facility_name:"HARRIS COUNTY MUD 221 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:308,amount_of_biosolids_managed_land_applied:0,latitude:30.000209,longitude:-95.402807},{facility_name:"ERIE NORTH WATER RECLAMATION FACILITY",city:"Erie",state:"Colo.",amount_of_biosolids_generated:308,amount_of_biosolids_managed_land_applied:307.79,latitude:40.06196435,longitude:-105.0180259},{facility_name:"EAST DISTRICT WWTP",city:"Baytown",state:"Texas",amount_of_biosolids_generated:307,amount_of_biosolids_managed_land_applied:0,latitude:29.75826,longitude:-94.919964},{facility_name:"HARRISON CO UTIL AUTH, LONG BEACH & PASS CHRISTIAN",city:"Pass Christian",state:"Mo.",amount_of_biosolids_generated:306,amount_of_biosolids_managed_land_applied:306,latitude:30.332246,longitude:-89.245298},{facility_name:"WILLIAMSPORT SAN AUTHORITY",city:"Williamsport",state:"Pa.",amount_of_biosolids_generated:306,amount_of_biosolids_managed_land_applied:0,latitude:41.244722,longitude:-76.989444},{facility_name:"EDGEWATER, CITY OF",city:"Edgewater",state:"Fla.",amount_of_biosolids_generated:305,amount_of_biosolids_managed_land_applied:305.25,latitude:28.985493,longitude:-80.911928},{facility_name:"SHELBYVILLE STP",city:"Shelbyville",state:"Tenn.",amount_of_biosolids_generated:305,amount_of_biosolids_managed_land_applied:305,latitude:35.484167,longitude:-86.466944},{facility_name:"TOWN OF WARREN",city:"Warren",state:"R.I.",amount_of_biosolids_generated:305,amount_of_biosolids_managed_land_applied:0,latitude:41.72906,longitude:-71.28224},{facility_name:"GREEN FOREST, CITY OF",city:"Green Forest",state:"Alaska",amount_of_biosolids_generated:304,amount_of_biosolids_managed_land_applied:0,latitude:36.316389,longitude:-93.42},{facility_name:"MATTOON STP, CITY OF",city:"Mattoon",state:"Iowa",amount_of_biosolids_generated:304,amount_of_biosolids_managed_land_applied:249,latitude:39.475228,longitude:-88.359424},{facility_name:"CITY OF CARROLL",city:"Carroll",state:"Hawaii",amount_of_biosolids_generated:304,amount_of_biosolids_managed_land_applied:303.74,latitude:42.06438,longitude:-94.86698},{facility_name:"BURRILLVILLE SEWER COMMISSION",city:"Harrisville",state:"R.I.",amount_of_biosolids_generated:304,amount_of_biosolids_managed_land_applied:0,latitude:41.97281,longitude:-71.66552055},{facility_name:"TOWN OF DAVIE",city:"Davie",state:"Fla.",amount_of_biosolids_generated:303,amount_of_biosolids_managed_land_applied:303.18,latitude:26.04059,longitude:-80.24093},{facility_name:"MUSTANG CREEK WWTP",city:"Taylor",state:"Texas",amount_of_biosolids_generated:303,amount_of_biosolids_managed_land_applied:0,latitude:30.558151,longitude:-97.385914},{facility_name:"WEST MEMORIAL MUD WWTP",city:"Katy",state:"Texas",amount_of_biosolids_generated:303,amount_of_biosolids_managed_land_applied:302.93,latitude:29.77461,longitude:-95.7541},{facility_name:"LOCKPORT STP, CITY OF",city:"Lockport",state:"Iowa",amount_of_biosolids_generated:303,amount_of_biosolids_managed_land_applied:302.74,latitude:41.58227,longitude:-88.06617},{facility_name:"EAST PENNSBORO SOUTH TREATMENT",city:"Cumberland County",state:"Pa.",amount_of_biosolids_generated:302,amount_of_biosolids_managed_land_applied:302.457,latitude:40.21559771,longitude:-76.89666495},{facility_name:"SOUTH WALTON UTILITY COMPANY",city:"Miramar Beach",state:"Fla.",amount_of_biosolids_generated:302,amount_of_biosolids_managed_land_applied:301.71,latitude:30.38028,longitude:-86.35852},{facility_name:"HACKETTSTOWN MUA WPCP",city:"Washington Twp",state:"Neb.",amount_of_biosolids_generated:302,amount_of_biosolids_managed_land_applied:0,latitude:40.81843,longitude:-74.83095},{facility_name:"BIG LAKE",city:"Big Lake",state:"Minn.",amount_of_biosolids_generated:302,amount_of_biosolids_managed_land_applied:0,latitude:45.30378,longitude:-93.74984},{facility_name:"JACKRABBIT RD PUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:301,amount_of_biosolids_managed_land_applied:207.35,latitude:29.831905,longitude:-95.656912},{facility_name:"MOBERLY CITY OF",city:"Moberly",state:"Mo.",amount_of_biosolids_generated:301,amount_of_biosolids_managed_land_applied:301,latitude:39.41968,longitude:-92.43702},{facility_name:"PATTERSON WQCF",city:"Patterson",state:"Calif.",amount_of_biosolids_generated:301,amount_of_biosolids_managed_land_applied:300.96,latitude:37.480433,longitude:-121.1209305},{facility_name:"AQUA ILLINOIS-UNIV PARK",city:"University Park",state:"Iowa",amount_of_biosolids_generated:301,amount_of_biosolids_managed_land_applied:379.76,latitude:41.443002,longitude:-87.670895},{facility_name:"CITY OF ESTHERVILLE",city:"Estherville",state:"Hawaii",amount_of_biosolids_generated:300,amount_of_biosolids_managed_land_applied:300.38,latitude:43.40197,longitude:-94.83534},{facility_name:"MWRA - CLINTON S T P",city:"Clinton",state:"Mass.",amount_of_biosolids_generated:300,amount_of_biosolids_managed_land_applied:0,latitude:42.43096,longitude:-71.680824},{facility_name:"WELLINGTON, CITY OF",city:"Wellington",state:"Kan.",amount_of_biosolids_generated:300,amount_of_biosolids_managed_land_applied:300,latitude:37.26295,longitude:-97.39789},{facility_name:"HARRISON CO UTIL AUTH, S20 D'IBERVILLE WWTF AND TRANSMISSION SYSTEM",city:"D'Iberville",state:"Mo.",amount_of_biosolids_generated:300,amount_of_biosolids_managed_land_applied:300,latitude:30.448204,longitude:-88.90157},{facility_name:"PISMO BEACH WWTF",city:"Pismo Beach",state:"Calif.",amount_of_biosolids_generated:300,amount_of_biosolids_managed_land_applied:0,latitude:35.15202593,longitude:-120.6363133},{facility_name:"BLYTHE RWRF",city:"Blythe",state:"Calif.",amount_of_biosolids_generated:300,amount_of_biosolids_managed_land_applied:0,latitude:33.604074,longitude:-114.599376},{facility_name:"HUNTLEY WEST STP, VILLAGE OF",city:"Huntley",state:"Iowa",amount_of_biosolids_generated:299,amount_of_biosolids_managed_land_applied:299.39,latitude:42.1625,longitude:-88.4417},{facility_name:"CALIFORNIA MEN'S COLONY WWTP",city:"San Luis Obispo",state:"Calif.",amount_of_biosolids_generated:298,amount_of_biosolids_managed_land_applied:0,latitude:35.31963,longitude:-120.69699},{facility_name:"PRASA DORADO",city:"Dorado",state:"Pa.",amount_of_biosolids_generated:298,amount_of_biosolids_managed_land_applied:298.1,latitude:18.456224,longitude:-66.259189},{facility_name:"CITY OF WASHINGTON",city:"Washington",state:"Mont.",amount_of_biosolids_generated:298,amount_of_biosolids_managed_land_applied:298,latitude:35.552078,longitude:-77.072847},{facility_name:"CITY OF NORTH LIBERTY",city:"North Liberty",state:"Hawaii",amount_of_biosolids_generated:297,amount_of_biosolids_managed_land_applied:297.34,latitude:41.74908478,longitude:-91.60964125},{facility_name:"SHERRILL (C) STP",city:"Sherrill",state:"N.D.",amount_of_biosolids_generated:297,amount_of_biosolids_managed_land_applied:0,latitude:43.070028,longitude:-75.615583},{facility_name:"WEST ALIQUIPPA SEWAGE TREATMEN",city:"Aliquippa",state:"Pa.",amount_of_biosolids_generated:296,amount_of_biosolids_managed_land_applied:0,latitude:40.62126,longitude:-80.24376},{facility_name:"SOUTH HARNETT REGIONAL WWTP",city:"Spring Lake",state:"Mont.",amount_of_biosolids_generated:296,amount_of_biosolids_managed_land_applied:0,latitude:35.2303,longitude:-78.8833},{facility_name:"HARRIS CO MUD 387 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:296,amount_of_biosolids_managed_land_applied:0,latitude:30.139414,longitude:-95.49923},{facility_name:"CITY OF PERRY",city:"Perry",state:"Hawaii",amount_of_biosolids_generated:296,amount_of_biosolids_managed_land_applied:295.76,latitude:41.7768408,longitude:-94.11497025},{facility_name:"MARIANNA CITY OF WWTP",city:"Marianna",state:"Fla.",amount_of_biosolids_generated:296,amount_of_biosolids_managed_land_applied:0,latitude:30.77089,longitude:-85.21972},{facility_name:"SALT CREEK SD STP",city:"Villa Park",state:"Iowa",amount_of_biosolids_generated:295,amount_of_biosolids_managed_land_applied:295.07,latitude:41.885,longitude:-87.9653},{facility_name:"CITY OF ITALY WWTF",city:"Italy",state:"Texas",amount_of_biosolids_generated:295,amount_of_biosolids_managed_land_applied:0,latitude:32.173226,longitude:-96.86912},{facility_name:"NORWICH WPCF",city:"Norwich",state:"Conn.",amount_of_biosolids_generated:295,amount_of_biosolids_managed_land_applied:0,latitude:41.52481,longitude:-72.08241},{facility_name:"CONTENTNEA METROPOLITAN SEWERAGE DISTRICT",city:"Grifton",state:"Mont.",amount_of_biosolids_generated:295,amount_of_biosolids_managed_land_applied:294.921,latitude:35.358949,longitude:-77.416506},{facility_name:"MILAN STP, VILLAGE OF",city:"Milan",state:"Iowa",amount_of_biosolids_generated:295,amount_of_biosolids_managed_land_applied:0,latitude:41.451373,longitude:-90.581747},{facility_name:"YANKTON, CITY OF (BIOSOLIDS)",city:"Yankton",state:"S.D.",amount_of_biosolids_generated:294,amount_of_biosolids_managed_land_applied:295.4,latitude:42.86935,longitude:-97.3824},{facility_name:"WASHOUGAL STP",city:"Washougal",state:"Wash.",amount_of_biosolids_generated:294,amount_of_biosolids_managed_land_applied:0,latitude:45.570576,longitude:-122.32446},{facility_name:"GWA HAGATNA WWTP",city:"Mangilao",state:"Ga.",amount_of_biosolids_generated:294,amount_of_biosolids_managed_land_applied:0,latitude:13.4382999,longitude:144.7729285},{facility_name:"NEW IBERIA, CITY OF - TETE BAYOU WWTP",city:"New Iberia",state:"La.",amount_of_biosolids_generated:293,amount_of_biosolids_managed_land_applied:861.96,latitude:29.99009,longitude:-91.76004},{facility_name:"CITY OF BAY CITY WWTP",city:"Bay City",state:"Texas",amount_of_biosolids_generated:293,amount_of_biosolids_managed_land_applied:0,latitude:28.95792,longitude:-95.95929},{facility_name:"THE UTILITIES BOARD OF THE CITY OF FOLEY",city:"Foley",state:"Alaska",amount_of_biosolids_generated:293,amount_of_biosolids_managed_land_applied:229.12,latitude:30.4014,longitude:-87.6617},{facility_name:"AUBURN WWTP",city:"Auburn",state:"Calif.",amount_of_biosolids_generated:291,amount_of_biosolids_managed_land_applied:0,latitude:38.90146994,longitude:-121.0666884},{facility_name:"CLINTON TOWN",city:"Clinton",state:"Neb.",amount_of_biosolids_generated:291,amount_of_biosolids_managed_land_applied:0,latitude:40.63611,longitude:-74.90943},{facility_name:"SOUTHWEST WATER RECLAMATION FACILITY",city:"League City",state:"Texas",amount_of_biosolids_generated:291,amount_of_biosolids_managed_land_applied:0,latitude:29.463626,longitude:-95.173337},{facility_name:"PLYMOUTH WWTP",city:"Plymouth",state:"Iowa",amount_of_biosolids_generated:290,amount_of_biosolids_managed_land_applied:0,latitude:41.33099,longitude:-86.32127},{facility_name:"NEWFANE (T)",city:"Newfane",state:"N.D.",amount_of_biosolids_generated:290,amount_of_biosolids_managed_land_applied:335,latitude:43.28229,longitude:-78.70804},{facility_name:"HENDERSON WWTF",city:"Lampasas",state:"Texas",amount_of_biosolids_generated:290,amount_of_biosolids_managed_land_applied:290,latitude:31.068809,longitude:-98.169487},{facility_name:"HARRIS COUNTY MUD 418",city:"Houston",state:"Texas",amount_of_biosolids_generated:290,amount_of_biosolids_managed_land_applied:144.96,latitude:29.95924,longitude:-95.7178},{facility_name:"CLIFTON SANITATION DISTRICT",city:"Clifton",state:"Colo.",amount_of_biosolids_generated:290,amount_of_biosolids_managed_land_applied:0,latitude:39.0628,longitude:-108.45589},{facility_name:"SOUTH GRANVILLE WATER & SEWER AUTHORITY",city:"Butner",state:"Mont.",amount_of_biosolids_generated:289,amount_of_biosolids_managed_land_applied:289.3,latitude:36.1348,longitude:-78.7797},{facility_name:"CITY OF WOODVILLE SOUTH PLANT",city:"Woodville",state:"Texas",amount_of_biosolids_generated:289,amount_of_biosolids_managed_land_applied:0,latitude:30.767417,longitude:-94.410194},{facility_name:"STURBRIDGE W P C F",city:"Sturbridge",state:"Mass.",amount_of_biosolids_generated:288,amount_of_biosolids_managed_land_applied:0,latitude:42.10095511,longitude:-72.08479348},{facility_name:"CITY OF UVALDE WWTF",city:"Uvalde",state:"Texas",amount_of_biosolids_generated:288,amount_of_biosolids_managed_land_applied:0,latitude:29.18675,longitude:-99.787278},{facility_name:"CARMEL WWTP",city:"Carmel",state:"Calif.",amount_of_biosolids_generated:288,amount_of_biosolids_managed_land_applied:0,latitude:36.5392689,longitude:-121.9060635},{facility_name:"PRASA PONCE STP",city:"Ponce",state:"Pa.",amount_of_biosolids_generated:288,amount_of_biosolids_managed_land_applied:0,latitude:18.09943642,longitude:-66.62900575},{facility_name:"CAMBRIDGE",city:"Cambridge",state:"Minn.",amount_of_biosolids_generated:287,amount_of_biosolids_managed_land_applied:286.9,latitude:45.56566,longitude:-93.24625039},{facility_name:"OYSTER CREEK WWTP",city:"Oyster Creek",state:"Texas",amount_of_biosolids_generated:287,amount_of_biosolids_managed_land_applied:286.69,latitude:28.970222,longitude:-95.309083},{facility_name:"MONTICELLO (V)",city:"Monticello",state:"N.D.",amount_of_biosolids_generated:286,amount_of_biosolids_managed_land_applied:0,latitude:41.65386,longitude:-74.68236},{facility_name:"RED WING",city:"Red Wing",state:"Minn.",amount_of_biosolids_generated:286,amount_of_biosolids_managed_land_applied:285.7,latitude:44.5704,longitude:-92.52},{facility_name:"AUGUSTA, CITY OF",city:"Augusta",state:"Kan.",amount_of_biosolids_generated:286,amount_of_biosolids_managed_land_applied:285.38,latitude:37.663817,longitude:-96.971487},{facility_name:"HORIZON REGIONAL MUD WWTP",city:"Horizon City",state:"Texas",amount_of_biosolids_generated:286,amount_of_biosolids_managed_land_applied:0,latitude:31.682463,longitude:-106.227713},{facility_name:"BRAINERD",city:"Baxter",state:"Minn.",amount_of_biosolids_generated:285,amount_of_biosolids_managed_land_applied:285,latitude:46.33987,longitude:-94.22739},{facility_name:"PENDLETON, CITY OF",city:"Pendleton",state:"Ore.",amount_of_biosolids_generated:284,amount_of_biosolids_managed_land_applied:283.94,latitude:45.66794,longitude:-118.836944},{facility_name:"BRATTLEBORO WASTEWATER TREATMENT FACILITY",city:"Brattleboro",state:"Va.",amount_of_biosolids_generated:283,amount_of_biosolids_managed_land_applied:0,latitude:42.841045,longitude:-72.549205},{facility_name:"OLEAN (C)",city:"Olean",state:"N.D.",amount_of_biosolids_generated:283,amount_of_biosolids_managed_land_applied:0,latitude:42.074291,longitude:-78.452272},{facility_name:"CROSS CREEK RANCH WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:282,amount_of_biosolids_managed_land_applied:0,latitude:29.6958,longitude:-95.8776},{facility_name:"SAINT PETER",city:"Saint Peter",state:"Minn.",amount_of_biosolids_generated:282,amount_of_biosolids_managed_land_applied:282,latitude:44.338986,longitude:-93.943175},{facility_name:"GREEN RIDGE WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:282,amount_of_biosolids_managed_land_applied:0,latitude:29.739432,longitude:-95.267198},{facility_name:"MARSHFIELD, TOWN OF",city:"Brant Rock",state:"Mass.",amount_of_biosolids_generated:282,amount_of_biosolids_managed_land_applied:0,latitude:42.08604,longitude:-70.6421},{facility_name:"DEERFIELD WRF, VILLAGE OF",city:"Deerfield",state:"Iowa",amount_of_biosolids_generated:282,amount_of_biosolids_managed_land_applied:289.2,latitude:42.16,longitude:-87.8547},{facility_name:"CITY OF SANDERSVILLE",city:"Sandersville",state:"Ga.",amount_of_biosolids_generated:282,amount_of_biosolids_managed_land_applied:281.54,latitude:32.990611,longitude:-82.842167},{facility_name:"BRUNSWICK COUNTY",city:"Bolivia",state:"Mont.",amount_of_biosolids_generated:281,amount_of_biosolids_managed_land_applied:281.44,latitude:34.027541,longitude:-78.280217},{facility_name:"CITY OF CLINTON",city:"Clinton",state:"Mo.",amount_of_biosolids_generated:281,amount_of_biosolids_managed_land_applied:281,latitude:38.394342,longitude:-93.791416},{facility_name:"CITY OF REIDSVILLE",city:"Reidsville",state:"Mont.",amount_of_biosolids_generated:281,amount_of_biosolids_managed_land_applied:281,latitude:36.323389,longitude:-79.658483},{facility_name:"ENUMCLAW STP",city:"Enumclaw",state:"Wash.",amount_of_biosolids_generated:281,amount_of_biosolids_managed_land_applied:280.72,latitude:47.188881,longitude:-122.004636},{facility_name:"FAIRMONT",city:"Fairmont",state:"Minn.",amount_of_biosolids_generated:280,amount_of_biosolids_managed_land_applied:157,latitude:43.67021,longitude:-94.45846},{facility_name:"INCLINE VILLAGE WRF",city:"Incline Village",state:"N.D.",amount_of_biosolids_generated:279,amount_of_biosolids_managed_land_applied:0,latitude:39.238783,longitude:-119.927834},{facility_name:"WATER RECLAMATION FACILITY",city:"Fredericksburg",state:"Texas",amount_of_biosolids_generated:279,amount_of_biosolids_managed_land_applied:0,latitude:30.253889,longitude:-98.846944},{facility_name:"WESTERN WATER RECYCLING FACILITY",city:"Riverside",state:"Calif.",amount_of_biosolids_generated:278,amount_of_biosolids_managed_land_applied:0,latitude:33.88567517,longitude:-117.2678916},{facility_name:"CITY OF FERNANDINA BEACH",city:"Fernandina Beach",state:"Fla.",amount_of_biosolids_generated:277,amount_of_biosolids_managed_land_applied:0,latitude:30.65765,longitude:-81.4633},{facility_name:"ROCK ISLAND MAIN STP, CITY OF",city:"Rock Island",state:"Iowa",amount_of_biosolids_generated:276,amount_of_biosolids_managed_land_applied:115.1,latitude:41.500139,longitude:-90.597167},{facility_name:"SIKESTON BOARD OF MUNICIPAL UTILITIES",city:"Sikeston",state:"Mo.",amount_of_biosolids_generated:275,amount_of_biosolids_managed_land_applied:215.718428,latitude:36.88199446,longitude:-89.70543651},{facility_name:"JUNCTION CITY, CITY OF",city:"Junction City",state:"Kan.",amount_of_biosolids_generated:275,amount_of_biosolids_managed_land_applied:275.22,latitude:38.9921,longitude:-96.8658},{facility_name:"PLAQUEMINES PAR (BOOTHVILLE)",city:"Venice",state:"La.",amount_of_biosolids_generated:275,amount_of_biosolids_managed_land_applied:0,latitude:29.315,longitude:-89.385556},{facility_name:"HARRIS CO MUD 105 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:274,amount_of_biosolids_managed_land_applied:274.28,latitude:29.860944,longitude:-95.729283},{facility_name:"COPPERFIELD PLANT WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:274,amount_of_biosolids_managed_land_applied:0,latitude:29.890848,longitude:-95.638903},{facility_name:"FLORHAM PARK WATER POLLUTION",city:"Florham Park",state:"Neb.",amount_of_biosolids_generated:274,amount_of_biosolids_managed_land_applied:0,latitude:40.783656,longitude:-74.368568},{facility_name:"INDIANA BORO STP",city:"Indiana",state:"Pa.",amount_of_biosolids_generated:273,amount_of_biosolids_managed_land_applied:0,latitude:40.582188,longitude:-79.161479},{facility_name:"CAMROSA WRF",city:"Camarillo",state:"Calif.",amount_of_biosolids_generated:273,amount_of_biosolids_managed_land_applied:0,latitude:34.237524,longitude:-118.966854},{facility_name:"HUNTINGBURG WWTP",city:"Huntingburg",state:"Iowa",amount_of_biosolids_generated:273,amount_of_biosolids_managed_land_applied:273,latitude:38.311972,longitude:-86.951528},{facility_name:"HEALDSBURG WRF",city:"Healdsburg",state:"Calif.",amount_of_biosolids_generated:273,amount_of_biosolids_managed_land_applied:127,latitude:38.624704,longitude:-122.87582},{facility_name:"LOUISVILLE (CITY OF) FORSTMANN WPCP",city:"Louisville",state:"Ga.",amount_of_biosolids_generated:273,amount_of_biosolids_managed_land_applied:0,latitude:33.003755,longitude:-82.461841},{facility_name:"CHARLEROI BOROUGH AUTH",city:"Charleroi",state:"Pa.",amount_of_biosolids_generated:272,amount_of_biosolids_managed_land_applied:0,latitude:40.136738,longitude:-79.895607},{facility_name:"REWA/PIEDMONT REGIONAL WWTP",city:"Piedmont",state:"S.C.",amount_of_biosolids_generated:272,amount_of_biosolids_managed_land_applied:0,latitude:34.68003,longitude:-82.46569},{facility_name:"HOLTVILLE WWTP",city:"Holtville",state:"Calif.",amount_of_biosolids_generated:271,amount_of_biosolids_managed_land_applied:271.03,latitude:32.810942,longitude:-115.380458},{facility_name:"CITY OF CORALVILLE",city:"Coralville",state:"Hawaii",amount_of_biosolids_generated:271,amount_of_biosolids_managed_land_applied:271,latitude:41.67846,longitude:-91.58365},{facility_name:"GRASS VALLEY WWTP",city:"Grass Valley",state:"Calif.",amount_of_biosolids_generated:270,amount_of_biosolids_managed_land_applied:270.39,latitude:39.204425,longitude:-120.9771389},{facility_name:"HANOVER PARK STP #1, VLLAGE OF",city:"Hanover Park",state:"Iowa",amount_of_biosolids_generated:270,amount_of_biosolids_managed_land_applied:270.152,latitude:41.9722,longitude:-88.1386},{facility_name:"CITY OF MOUNT HOLLY",city:"Mt Holly",state:"Mont.",amount_of_biosolids_generated:270,amount_of_biosolids_managed_land_applied:270,latitude:35.281681,longitude:-81.016193},{facility_name:"COMMISSIONERS OF ABERDEEN",city:"Aberdeen",state:"Mass.",amount_of_biosolids_generated:269,amount_of_biosolids_managed_land_applied:731.5,latitude:39.51003,longitude:-76.15004},{facility_name:"CENTRALIA STP, CITY OF",city:"Centralia",state:"Iowa",amount_of_biosolids_generated:269,amount_of_biosolids_managed_land_applied:268.51,latitude:38.51069,longitude:-89.15046},{facility_name:"CHIMNEY HILL WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:268,amount_of_biosolids_managed_land_applied:0,latitude:29.89141,longitude:-95.60846},{facility_name:"MACOMB STP, CITY OF",city:"Macomb",state:"Iowa",amount_of_biosolids_generated:268,amount_of_biosolids_managed_land_applied:268.31,latitude:40.4477,longitude:-90.68369},{facility_name:"SCITUATE_WWTP",city:"Scituate",state:"Mass.",amount_of_biosolids_generated:268,amount_of_biosolids_managed_land_applied:0,latitude:42.17623,longitude:-70.726866},{facility_name:"LOCK HAVEN, CITY OF",city:"Lock Haven",state:"Pa.",amount_of_biosolids_generated:268,amount_of_biosolids_managed_land_applied:0,latitude:41.13635,longitude:-77.44834},{facility_name:"NEW OXFORD MUNICIPAL AUTHORITY",city:"New Oxford",state:"Pa.",amount_of_biosolids_generated:267,amount_of_biosolids_managed_land_applied:267.381,latitude:39.86345,longitude:-77.06297},{facility_name:"DAMASCUS WWTP",city:"Damascus",state:"Mass.",amount_of_biosolids_generated:267,amount_of_biosolids_managed_land_applied:267.38,latitude:39.247049,longitude:-77.204983},{facility_name:"YUCCA VALLEY HDWD",city:"Yucca Valley",state:"Calif.",amount_of_biosolids_generated:267,amount_of_biosolids_managed_land_applied:180.48,latitude:34.14538884,longitude:-116.4123449},{facility_name:"VIRGINIA",city:"Virginia",state:"Minn.",amount_of_biosolids_generated:267,amount_of_biosolids_managed_land_applied:267,latitude:47.508632,longitude:-92.547315},{facility_name:"HARRISON CO UTILITY AUTHORITY, GULFPORT SOUTH POTW",city:"Gulfport",state:"Mo.",amount_of_biosolids_generated:267,amount_of_biosolids_managed_land_applied:267,latitude:30.418537,longitude:-89.061823},{facility_name:"HORSEPEN CREEK WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:267,amount_of_biosolids_managed_land_applied:21.34,latitude:29.912777,longitude:-95.696666},{facility_name:"KODIAK WWTP",city:"Kodiak",state:"Alaska",amount_of_biosolids_generated:267,amount_of_biosolids_managed_land_applied:220,latitude:57.805067,longitude:-152.355448},{facility_name:"ASPEN CONSOLIDATED SANITATION DISTRICT",city:"Aspen",state:"Colo.",amount_of_biosolids_generated:267,amount_of_biosolids_managed_land_applied:0,latitude:39.194214,longitude:-106.817393},{facility_name:"DOUBLE CREEK WWTP",city:"Jacksonville",state:"Texas",amount_of_biosolids_generated:267,amount_of_biosolids_managed_land_applied:0,latitude:31.93473,longitude:-95.20214},{facility_name:"ELIZABETHTON STP",city:"Elizabethton",state:"Tenn.",amount_of_biosolids_generated:265,amount_of_biosolids_managed_land_applied:0,latitude:36.352885,longitude:-82.248467},{facility_name:"TOWN CREEK WWTP",city:"Palestine",state:"Texas",amount_of_biosolids_generated:265,amount_of_biosolids_managed_land_applied:162.33,latitude:31.7544,longitude:-95.6088},{facility_name:"CITY OF GRAHAM WWTF",city:"Graham",state:"Texas",amount_of_biosolids_generated:264,amount_of_biosolids_managed_land_applied:0,latitude:33.086253,longitude:-98.593396},{facility_name:"CLARKS SUMMIT-SOUTH ABINGTON J",city:"Chinchilla",state:"Pa.",amount_of_biosolids_generated:264,amount_of_biosolids_managed_land_applied:0,latitude:40.726994,longitude:-75.53272},{facility_name:"SEWER AUTHORITY_MID COASTSIDE",city:"Half Moon Bay",state:"Calif.",amount_of_biosolids_generated:264,amount_of_biosolids_managed_land_applied:0,latitude:37.475318,longitude:-122.438855},{facility_name:"SALMON CREEK WWTP",city:"Burien",state:"Wash.",amount_of_biosolids_generated:264,amount_of_biosolids_managed_land_applied:263.6,latitude:47.490989,longitude:-122.361021},{facility_name:"FRANKLIN COUNTY",city:"Louisburg",state:"Mont.",amount_of_biosolids_generated:262,amount_of_biosolids_managed_land_applied:261.8,latitude:36.07054,longitude:-78.42661},{facility_name:"CITY OF LAUREL",city:"Laurel",state:"Mont.",amount_of_biosolids_generated:261,amount_of_biosolids_managed_land_applied:0,latitude:45.66534786,longitude:-108.7738835},{facility_name:"PRASA - FAJARDO WWTP",city:"Aguas Buenas",state:"Pa.",amount_of_biosolids_generated:260,amount_of_biosolids_managed_land_applied:0,latitude:18.25819,longitude:-66.10713},{facility_name:"CITY OF PRATTVILLE",city:"Prattville",state:"Alaska",amount_of_biosolids_generated:260,amount_of_biosolids_managed_land_applied:260.118,latitude:32.4295,longitude:-86.4054},{facility_name:"ANSON COUNTY",city:"Wadesboro",state:"Mont.",amount_of_biosolids_generated:260,amount_of_biosolids_managed_land_applied:260.11,latitude:34.899863,longitude:-80.00308},{facility_name:"AYER W W T P",city:"Ayer",state:"Mass.",amount_of_biosolids_generated:260,amount_of_biosolids_managed_land_applied:0,latitude:42.560413,longitude:-71.603265},{facility_name:"EL DORADO, CITY OF",city:"El Dorado",state:"Kan.",amount_of_biosolids_generated:260,amount_of_biosolids_managed_land_applied:0,latitude:37.798079,longitude:-96.849446},{facility_name:"SANTAQUIN WATER RECLAMATION FACILITY",city:"Santaquin",state:"Utah",amount_of_biosolids_generated:260,amount_of_biosolids_managed_land_applied:0,latitude:39.996111,longitude:-111.789444},{facility_name:"OWEGO (V)",city:"Owego",state:"N.D.",amount_of_biosolids_generated:259,amount_of_biosolids_managed_land_applied:259.03,latitude:42.1036,longitude:-76.26229},{facility_name:"SWEET HOME, CITY OF",city:"Sweet Home",state:"Ore.",amount_of_biosolids_generated:259,amount_of_biosolids_managed_land_applied:0,latitude:44.400019,longitude:-122.73797},{facility_name:"WEST DISTRICT WWTF",city:"Baytown",state:"Texas",amount_of_biosolids_generated:259,amount_of_biosolids_managed_land_applied:0,latitude:29.791518,longitude:-95.043481},{facility_name:"TOOL WWTP",city:"Tool",state:"Texas",amount_of_biosolids_generated:259,amount_of_biosolids_managed_land_applied:0,latitude:32.23875,longitude:-96.144694},{facility_name:"DOUGLAS CO SEWER DIST 1 EAST WENATCHEE",city:"East Wenatchee",state:"Wash.",amount_of_biosolids_generated:259,amount_of_biosolids_managed_land_applied:209.5,latitude:47.418545,longitude:-120.29716},{facility_name:"TROY STP, CITY OF",city:"Troy",state:"Iowa",amount_of_biosolids_generated:259,amount_of_biosolids_managed_land_applied:181.7,latitude:38.726944,longitude:-89.871389},{facility_name:"WILDERNESS SHORES",city:"Locust Grove",state:"Utah",amount_of_biosolids_generated:258,amount_of_biosolids_managed_land_applied:135,latitude:38.372065,longitude:-77.749208},{facility_name:"CITY OF ROCKPORT WWTP",city:"Rockport",state:"Texas",amount_of_biosolids_generated:257,amount_of_biosolids_managed_land_applied:257,latitude:28.03768,longitude:-97.05605},{facility_name:"PINERY WATER AND WASTEWATER DIST",city:"Parker",state:"Colo.",amount_of_biosolids_generated:257,amount_of_biosolids_managed_land_applied:0,latitude:39.43834,longitude:-104.76401},{facility_name:"WASCO WWTP",city:"Wasco",state:"Calif.",amount_of_biosolids_generated:255,amount_of_biosolids_managed_land_applied:0,latitude:35.58695172,longitude:-119.3655891},{facility_name:"TAOS, TOWN OF",city:"Rancho De Taos",state:"N.D.",amount_of_biosolids_generated:254,amount_of_biosolids_managed_land_applied:0,latitude:36.38614,longitude:-105.639899},{facility_name:"RCSD KIMMSWICK WWTP",city:"Kimmswick",state:"Mo.",amount_of_biosolids_generated:254,amount_of_biosolids_managed_land_applied:254,latitude:38.399363,longitude:-90.385717},{facility_name:"VERMILLION, CITY OF",city:"Vermillion, City Of",state:"S.D.",amount_of_biosolids_generated:254,amount_of_biosolids_managed_land_applied:118.43,latitude:42.762222,longitude:-96.916583},{facility_name:"ROCKLAND WWTP",city:"Rockland",state:"Mass.",amount_of_biosolids_generated:253,amount_of_biosolids_managed_land_applied:0,latitude:42.12951619,longitude:-70.9126},{facility_name:"FRANKLIN STP",city:"Franklin",state:"Ky.",amount_of_biosolids_generated:251,amount_of_biosolids_managed_land_applied:0,latitude:36.744167,longitude:-86.555},{facility_name:"CITY OF COMANCHE WWTP",city:"Comanche",state:"Texas",amount_of_biosolids_generated:251,amount_of_biosolids_managed_land_applied:0,latitude:31.8932,longitude:-98.5928},{facility_name:"MONTICELLO WWTP",city:"Monticello",state:"Iowa",amount_of_biosolids_generated:251,amount_of_biosolids_managed_land_applied:251,latitude:40.736,longitude:-86.755917},{facility_name:"AVENAL WWTP",city:"Avenal",state:"Calif.",amount_of_biosolids_generated:250,amount_of_biosolids_managed_land_applied:0,latitude:36.00050661,longitude:-120.124325},{facility_name:"ALEXANDRIA, CITY OF (HUDSON BL",city:"Alexandria",state:"La.",amount_of_biosolids_generated:250,amount_of_biosolids_managed_land_applied:0,latitude:31.2784,longitude:-92.41716},{facility_name:"TOWN OF LOUISBURG",city:"Louisburg",state:"Mont.",amount_of_biosolids_generated:250,amount_of_biosolids_managed_land_applied:249.82,latitude:36.0874,longitude:-78.2922},{facility_name:"WATER WORKS & SEWER BOARD OF THE CITY OF GADSDEN",city:"Gadsden",state:"Alaska",amount_of_biosolids_generated:250,amount_of_biosolids_managed_land_applied:249.73,latitude:33.990232,longitude:-86.035837},{facility_name:"ARTESIA, CITY OF",city:"Artesia",state:"N.D.",amount_of_biosolids_generated:250,amount_of_biosolids_managed_land_applied:249.7,latitude:32.858161,longitude:-104.360985},{facility_name:"MORONI FEED",city:"Moroni",state:"Utah",amount_of_biosolids_generated:249,amount_of_biosolids_managed_land_applied:0,latitude:39.517968,longitude:-111.591179},{facility_name:"MT. VIEW S.D. WWTP",city:"Martinez",state:"Calif.",amount_of_biosolids_generated:249,amount_of_biosolids_managed_land_applied:0,latitude:38.011211,longitude:-122.118401},{facility_name:"UPPER MARTINEZ CREEK WWTF",city:"San Antonio",state:"Texas",amount_of_biosolids_generated:248,amount_of_biosolids_managed_land_applied:0,latitude:32.763199,longitude:-93.969626},{facility_name:"PLAQUEMINES PAR (PORT SULPHUR)",city:"Port Sulphur",state:"La.",amount_of_biosolids_generated:248,amount_of_biosolids_managed_land_applied:0,latitude:29.48235,longitude:-89.70117},{facility_name:"LAGRANGE WWTP",city:"La Grange",state:"Iowa",amount_of_biosolids_generated:248,amount_of_biosolids_managed_land_applied:0,latitude:41.65182,longitude:-85.41391},{facility_name:"LOWER FOUNTAIN METRO SEWAGE DISPOSAL DIST",city:"Fountain",state:"Colo.",amount_of_biosolids_generated:248,amount_of_biosolids_managed_land_applied:0,latitude:38.667223,longitude:-104.703165},{facility_name:"CITY OF NEW BOSTON WWTP",city:"New Boston",state:"Texas",amount_of_biosolids_generated:246,amount_of_biosolids_managed_land_applied:0,latitude:33.435644,longitude:-94.409774},{facility_name:"GENEVA (C)",city:"Geneva",state:"N.D.",amount_of_biosolids_generated:246,amount_of_biosolids_managed_land_applied:763.5,latitude:42.86799,longitude:-76.98265},{facility_name:"COFFEYVILLE, CITY OF",city:"Coffeyville",state:"Kan.",amount_of_biosolids_generated:246,amount_of_biosolids_managed_land_applied:186.61,latitude:37.04533028,longitude:-95.4683046},{facility_name:"NW HARRIS COUNTY MUD 15 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:246,amount_of_biosolids_managed_land_applied:0,latitude:30.02589,longitude:-95.61713},{facility_name:"NORTHWEST REGIONAL",city:"Winter Haven",state:"Fla.",amount_of_biosolids_generated:245,amount_of_biosolids_managed_land_applied:0,latitude:28.011054,longitude:-81.8088},{facility_name:"GROVETON WWTP",city:"Groveton",state:"Texas",amount_of_biosolids_generated:245,amount_of_biosolids_managed_land_applied:0,latitude:31.041556,longitude:-95.119639},{facility_name:"PENNSVILLE SEWERAGE AUTHORITY",city:"Pennsville",state:"Neb.",amount_of_biosolids_generated:245,amount_of_biosolids_managed_land_applied:0,latitude:39.639085,longitude:-75.541673},{facility_name:"BOERNE WWT AND RECYCLING CENTER",city:"Boerne",state:"Texas",amount_of_biosolids_generated:244,amount_of_biosolids_managed_land_applied:0,latitude:29.77277,longitude:-98.7142},{facility_name:"TOWN OF NORTH WILKESBORO",city:"North Wilkesboro",state:"Mont.",amount_of_biosolids_generated:244,amount_of_biosolids_managed_land_applied:243.96,latitude:36.161333,longitude:-81.1345},{facility_name:"TIMBER LANE UD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:244,amount_of_biosolids_managed_land_applied:0,latitude:30.039417,longitude:-95.387361},{facility_name:"TIMBERHILLS PERMANENT WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:243,amount_of_biosolids_managed_land_applied:243.4,latitude:29.935915,longitude:-95.234856},{facility_name:"HANCOCK COUNTY UTILITY AUTHORITY, SOUTHERN REGIONAL WWTP",city:"Waveland",state:"Mo.",amount_of_biosolids_generated:243,amount_of_biosolids_managed_land_applied:243.21,latitude:30.29521,longitude:-89.38287},{facility_name:"TOWN OF EAST GREENWICH",city:"East Greenwich",state:"R.I.",amount_of_biosolids_generated:243,amount_of_biosolids_managed_land_applied:0,latitude:41.660818,longitude:-71.451068},{facility_name:"U.S. ARMY INSTALLATION MGMT COMMAND",city:"Fort Leonard Wood",state:"Mo.",amount_of_biosolids_generated:243,amount_of_biosolids_managed_land_applied:242.56,latitude:37.7624096,longitude:-92.10761613},{facility_name:"AJ BROWN PARKER CREEK WWTF",city:"Huntsville",state:"Texas",amount_of_biosolids_generated:242,amount_of_biosolids_managed_land_applied:0,latitude:30.772434,longitude:-95.512744},{facility_name:"DECATUR WWTP",city:"Decatur",state:"Iowa",amount_of_biosolids_generated:242,amount_of_biosolids_managed_land_applied:80.5,latitude:40.83125,longitude:-84.92501},{facility_name:"WOODLAND SEWAGE TREATMENT PLT",city:"Convent Station",state:"Neb.",amount_of_biosolids_generated:242,amount_of_biosolids_managed_land_applied:0,latitude:40.775629,longitude:-74.46346},{facility_name:"RUIDOSO-RUIDOSO DOWNS WWTP-LIN",city:"Ruidoso",state:"N.D.",amount_of_biosolids_generated:242,amount_of_biosolids_managed_land_applied:193,latitude:33.34944,longitude:-105.66196},{facility_name:"CITY OF ROCKMART",city:"Rockmart",state:"Ga.",amount_of_biosolids_generated:242,amount_of_biosolids_managed_land_applied:0,latitude:34.012199,longitude:-85.049933},{facility_name:"SAM C MCKENZIE JR WATER RECLAMATION FACILITY",city:"New Braunfels",state:"Texas",amount_of_biosolids_generated:242,amount_of_biosolids_managed_land_applied:0,latitude:29.653333,longitude:-98.058333},{facility_name:"SECURITY SANITATION DISTRICT",city:"Colorado Springs",state:"Colo.",amount_of_biosolids_generated:241,amount_of_biosolids_managed_land_applied:0,latitude:38.74619,longitude:-104.73842},{facility_name:"CAMAS STP",city:"Camas",state:"Wash.",amount_of_biosolids_generated:241,amount_of_biosolids_managed_land_applied:10.4,latitude:45.578439,longitude:-122.393398},{facility_name:"CELANESE WWTP",city:"Cumberland",state:"Mass.",amount_of_biosolids_generated:241,amount_of_biosolids_managed_land_applied:0,latitude:39.600267,longitude:-78.817457},{facility_name:"MEDFORD TOWNSHIP STP",city:"Medford",state:"Neb.",amount_of_biosolids_generated:240,amount_of_biosolids_managed_land_applied:0,latitude:39.91938,longitude:-74.80697},{facility_name:"CITY OF NEWTON",city:"Newton",state:"Hawaii",amount_of_biosolids_generated:240,amount_of_biosolids_managed_land_applied:239.6,latitude:41.72129972,longitude:-93.06755559},{facility_name:"BEDFORD WASTEWATER TREATMENT PLANT",city:"Bedford",state:"Iowa",amount_of_biosolids_generated:240,amount_of_biosolids_managed_land_applied:239.56,latitude:38.839111,longitude:-86.521889},{facility_name:"FORT BEND COUNTY MUD 182",city:"Houston",state:"Texas",amount_of_biosolids_generated:239,amount_of_biosolids_managed_land_applied:0,latitude:29.725659,longitude:-95.87164},{facility_name:"CITY OF SHELDON",city:"Sheldon",state:"Hawaii",amount_of_biosolids_generated:239,amount_of_biosolids_managed_land_applied:183.61,latitude:43.15625079,longitude:-95.8974258},{facility_name:"TOWN OF SPENCER SEWER COMMISSION",city:"Spencer",state:"Mass.",amount_of_biosolids_generated:239,amount_of_biosolids_managed_land_applied:0,latitude:42.24722,longitude:-72.00732},{facility_name:"PERU STP #1, CITY OF",city:"Peru",state:"Iowa",amount_of_biosolids_generated:238,amount_of_biosolids_managed_land_applied:238.33,latitude:41.32635,longitude:-89.11426},{facility_name:"JEFFERSON COUNTY COMMISSION ENVIRONMENTAL SERVICES DEPARTMENT",city:"Birmingham",state:"Alaska",amount_of_biosolids_generated:238,amount_of_biosolids_managed_land_applied:238,latitude:33.7142,longitude:-86.6989},{facility_name:"CITY OF STATESVILLE",city:"Statesville",state:"Mont.",amount_of_biosolids_generated:238,amount_of_biosolids_managed_land_applied:238,latitude:35.74181,longitude:-80.841124},{facility_name:"EPHRATA BOROUGH AUTHORITY",city:"Ephrata",state:"Pa.",amount_of_biosolids_generated:238,amount_of_biosolids_managed_land_applied:238,latitude:40.19715,longitude:-76.16088},{facility_name:"TWA/PARKWAY WWTF",city:"Kissimmee",state:"Fla.",amount_of_biosolids_generated:238,amount_of_biosolids_managed_land_applied:0,latitude:28.3043,longitude:-81.340777},{facility_name:"SEABROOK WWTP",city:"Seabrook",state:"Texas",amount_of_biosolids_generated:237,amount_of_biosolids_managed_land_applied:0,latitude:29.55744,longitude:-95.01684},{facility_name:"SOUTHERN MONTGOMERY CO MUD WWP",city:"Spring",state:"Texas",amount_of_biosolids_generated:236,amount_of_biosolids_managed_land_applied:0,latitude:30.125739,longitude:-95.429559},{facility_name:"EFFINGHAM STP, CITY OF",city:"Effingham",state:"Iowa",amount_of_biosolids_generated:236,amount_of_biosolids_managed_land_applied:224.9,latitude:39.10938,longitude:-88.53276},{facility_name:"SUNBURY CITY MUN AUTHORITY",city:"Sunbury",state:"Pa.",amount_of_biosolids_generated:236,amount_of_biosolids_managed_land_applied:0,latitude:40.85462,longitude:-76.79459},{facility_name:"BLAIR WWTF",city:"Blair",state:"Neb.",amount_of_biosolids_generated:236,amount_of_biosolids_managed_land_applied:236.1,latitude:41.551762,longitude:-96.102836},{facility_name:"TROUTDALE, CITY OF",city:"Troutdale",state:"Ore.",amount_of_biosolids_generated:236,amount_of_biosolids_managed_land_applied:158,latitude:45.553408,longitude:-122.387009},{facility_name:"CITY OF FARMINGTON",city:"Farmington",state:"Mo.",amount_of_biosolids_generated:236,amount_of_biosolids_managed_land_applied:235.6,latitude:37.78064,longitude:-90.42251},{facility_name:"GATEWAY SERVICES CDD",city:"Fort Myers",state:"Fla.",amount_of_biosolids_generated:235,amount_of_biosolids_managed_land_applied:0,latitude:26.57451,longitude:-81.73853},{facility_name:"CITY OF MOUNT VERNON WWTP",city:"Mount Vernon",state:"Texas",amount_of_biosolids_generated:235,amount_of_biosolids_managed_land_applied:0,latitude:33.194556,longitude:-95.2175},{facility_name:"HORNELL (C)",city:"Hornell",state:"N.D.",amount_of_biosolids_generated:235,amount_of_biosolids_managed_land_applied:234.9,latitude:42.32758,longitude:-77.66154},{facility_name:"TOMBALL SOUTH WWTP",city:"Tomball",state:"Texas",amount_of_biosolids_generated:234,amount_of_biosolids_managed_land_applied:234.1,latitude:30.0669,longitude:-95.6147},{facility_name:"PLANO STP, CITY OF",city:"Plano",state:"Iowa",amount_of_biosolids_generated:233,amount_of_biosolids_managed_land_applied:233.25,latitude:41.65383,longitude:-88.5316},{facility_name:"PRICE R WATER IMP DIST",city:"Wellington",state:"Utah",amount_of_biosolids_generated:233,amount_of_biosolids_managed_land_applied:233,latitude:39.534962,longitude:-110.716301},{facility_name:"SAN BENITO WWTP",city:"San Benito",state:"Texas",amount_of_biosolids_generated:232,amount_of_biosolids_managed_land_applied:232.4,latitude:26.174523,longitude:-97.625014},{facility_name:"QUONSET POINT WWTF",city:"North Kingstown",state:"R.I.",amount_of_biosolids_generated:232,amount_of_biosolids_managed_land_applied:0,latitude:41.59792,longitude:-71.42406},{facility_name:"CITY OF MANCHESTER",city:"Manchester",state:"Tenn.",amount_of_biosolids_generated:232,amount_of_biosolids_managed_land_applied:215.2,latitude:35.4833,longitude:-86.09716},{facility_name:"CITY OF CEDAR FALLS",city:"Cedar Falls",state:"Hawaii",amount_of_biosolids_generated:232,amount_of_biosolids_managed_land_applied:232.1,latitude:42.53639,longitude:-92.44816},{facility_name:"HOOKSETT W W T F",city:"Hooksett",state:"Neb.",amount_of_biosolids_generated:232,amount_of_biosolids_managed_land_applied:0,latitude:43.07531,longitude:-71.45823},{facility_name:"ACTON MUD WWTF",city:"Granbury",state:"Texas",amount_of_biosolids_generated:232,amount_of_biosolids_managed_land_applied:0,latitude:32.43599,longitude:-97.69764},{facility_name:"CITY OF JARRELL WWTF",city:"Jarrell",state:"Texas",amount_of_biosolids_generated:232,amount_of_biosolids_managed_land_applied:0,latitude:30.823762,longitude:-97.547025},{facility_name:"CITY OF KIRKSVILLE",city:"Kirksville",state:"Mo.",amount_of_biosolids_generated:232,amount_of_biosolids_managed_land_applied:231.6,latitude:40.19361,longitude:-92.58318},{facility_name:"PHENIX CITY DEPARTMENT OF PUBLIC UTILITIES",city:"Phenix City",state:"Alaska",amount_of_biosolids_generated:231,amount_of_biosolids_managed_land_applied:231.46,latitude:32.4323,longitude:-84.9711},{facility_name:"CITY OF REPUBLIC",city:"Republic",state:"Mo.",amount_of_biosolids_generated:231,amount_of_biosolids_managed_land_applied:117.361,latitude:37.1206,longitude:-93.48047},{facility_name:"CITY OF MCDONOUGH",city:"Mcdonough",state:"Ga.",amount_of_biosolids_generated:230,amount_of_biosolids_managed_land_applied:230.4,latitude:33.480275,longitude:-84.130223},{facility_name:"PECAN GROVE MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:230,amount_of_biosolids_managed_land_applied:0,latitude:29.617821,longitude:-95.607229},{facility_name:"CARBONDALE NORTHWEST WWTP",city:"Carbondale",state:"Iowa",amount_of_biosolids_generated:230,amount_of_biosolids_managed_land_applied:248.58,latitude:37.7461,longitude:-89.2417},{facility_name:"MELROSE",city:"Melrose",state:"Minn.",amount_of_biosolids_generated:230,amount_of_biosolids_managed_land_applied:230,latitude:45.67506,longitude:-94.80245},{facility_name:"BURLINGTON NORTH END WWTF",city:"Burlington",state:"Va.",amount_of_biosolids_generated:230,amount_of_biosolids_managed_land_applied:0,latitude:44.527927,longitude:-73.268766},{facility_name:"MAYSVILLE STP",city:"Maysville",state:"Ky.",amount_of_biosolids_generated:229,amount_of_biosolids_managed_land_applied:0,latitude:38.687222,longitude:-83.786667},{facility_name:"TOWN OF FARMVILLE",city:"Farmville",state:"Mont.",amount_of_biosolids_generated:229,amount_of_biosolids_managed_land_applied:229,latitude:35.588194,longitude:-77.546097},{facility_name:"GREAT BEND, CITY OF",city:"Great Bend",state:"Kan.",amount_of_biosolids_generated:229,amount_of_biosolids_managed_land_applied:185,latitude:38.37558458,longitude:-98.77106058},{facility_name:"OCEAN SHORES STP",city:"Ocean Shores",state:"Wash.",amount_of_biosolids_generated:229,amount_of_biosolids_managed_land_applied:88.39,latitude:46.931927,longitude:-124.156601},{facility_name:"PORT TOWNSEND STP",city:"Port Townsend",state:"Wash.",amount_of_biosolids_generated:229,amount_of_biosolids_managed_land_applied:228.65,latitude:48.138082,longitude:-122.781567},{facility_name:"SAN FELIPE WWTF",city:"Del Rio",state:"Texas",amount_of_biosolids_generated:228,amount_of_biosolids_managed_land_applied:0,latitude:29.308056,longitude:-100.886111},{facility_name:"DONALA WATER AND SANITATION DISTRICT",city:"Colorado Springs",state:"Colo.",amount_of_biosolids_generated:228,amount_of_biosolids_managed_land_applied:0,latitude:39.05566,longitude:-104.81471},{facility_name:"AURORA WWTF",city:"Aurora",state:"Neb.",amount_of_biosolids_generated:228,amount_of_biosolids_managed_land_applied:228,latitude:40.86913453,longitude:-98.00687312},{facility_name:"UNION COUNTY",city:"Monroe",state:"Mont.",amount_of_biosolids_generated:228,amount_of_biosolids_managed_land_applied:227.88,latitude:35.068753,longitude:-80.633831},{facility_name:"EAST HAMPTON WPCA",city:"East Hampton",state:"Conn.",amount_of_biosolids_generated:227,amount_of_biosolids_managed_land_applied:0,latitude:41.564191,longitude:-72.546421},{facility_name:"BARRINGTON STP, VILLAGE OF",city:"Barrington",state:"Iowa",amount_of_biosolids_generated:227,amount_of_biosolids_managed_land_applied:226.81,latitude:42.158008,longitude:-88.143852},{facility_name:"WAUCONDA WWTF",city:"Wauconda",state:"Iowa",amount_of_biosolids_generated:227,amount_of_biosolids_managed_land_applied:226.738,latitude:42.26088,longitude:-88.14934},{facility_name:"PONTIAC STP, CITY OF",city:"Pontiac",state:"Iowa",amount_of_biosolids_generated:227,amount_of_biosolids_managed_land_applied:0,latitude:40.881952,longitude:-88.63144},{facility_name:"PENN YAN (V) MUNICIPAL BOARD",city:"Penn Yan",state:"N.D.",amount_of_biosolids_generated:226,amount_of_biosolids_managed_land_applied:36.8,latitude:42.66083,longitude:-77.05419},{facility_name:"MUKILTEO WATER AND WASTEWATER DISTRICT WWTP",city:"Mukilteo",state:"Wash.",amount_of_biosolids_generated:226,amount_of_biosolids_managed_land_applied:225.6,latitude:47.910978,longitude:-122.319727},{facility_name:"PLAINFIELD WPCF",city:"Plainfield",state:"Conn.",amount_of_biosolids_generated:226,amount_of_biosolids_managed_land_applied:0,latitude:41.67742,longitude:-71.91801},{facility_name:"CITY OF PEVELY",city:"Pevely",state:"Mo.",amount_of_biosolids_generated:225,amount_of_biosolids_managed_land_applied:225,latitude:38.28664224,longitude:-90.40684042},{facility_name:"ELLENSBURG WWTP",city:"Ellensburg",state:"Wash.",amount_of_biosolids_generated:225,amount_of_biosolids_managed_land_applied:0,latitude:46.968591,longitude:-120.540876},{facility_name:"WATERTOWN, CITY OF",city:"Watertown, City Of",state:"S.D.",amount_of_biosolids_generated:225,amount_of_biosolids_managed_land_applied:0,latitude:44.885004,longitude:-97.099607},{facility_name:"MUSCLE SHOALS UTILITIES BOARD",city:"Muscle Shoals",state:"Alaska",amount_of_biosolids_generated:224,amount_of_biosolids_managed_land_applied:224,latitude:34.7582,longitude:-87.641},{facility_name:"CITY OF DEVINE WWTP",city:"Devine",state:"Texas",amount_of_biosolids_generated:223,amount_of_biosolids_managed_land_applied:0,latitude:29.127361,longitude:-98.912111},{facility_name:"GALT WWTP",city:"Galt",state:"Calif.",amount_of_biosolids_generated:223,amount_of_biosolids_managed_land_applied:223,latitude:38.2914,longitude:-121.2757},{facility_name:"GREENSBORO (CITY OF)",city:"Greensboro",state:"Ga.",amount_of_biosolids_generated:223,amount_of_biosolids_managed_land_applied:222.56,latitude:33.552306,longitude:-83.197944},{facility_name:"UPPER SAUCON TWP. WWTP",city:"Center Valley",state:"Pa.",amount_of_biosolids_generated:223,amount_of_biosolids_managed_land_applied:0,latitude:40.53473,longitude:-75.40339},{facility_name:"REDONDO WWTP",city:"Federal Way",state:"Wash.",amount_of_biosolids_generated:222,amount_of_biosolids_managed_land_applied:222,latitude:47.341287,longitude:-122.330283},{facility_name:"BOROUGH OF PHOENIXVILLE",city:"Phoenixville",state:"Pa.",amount_of_biosolids_generated:222,amount_of_biosolids_managed_land_applied:221.87,latitude:40.127883,longitude:-75.502412},{facility_name:"LEWISBURG STP",city:"Lewisburg",state:"Tenn.",amount_of_biosolids_generated:221,amount_of_biosolids_managed_land_applied:223.5,latitude:35.45094,longitude:-86.78791},{facility_name:"MOORE STREET WWTP",city:"Beeville",state:"Texas",amount_of_biosolids_generated:221,amount_of_biosolids_managed_land_applied:220.5,latitude:28.39139,longitude:-97.723077},{facility_name:"FESTUS-CRYSTAL CITY SEWAG",city:"Crystal City",state:"Mo.",amount_of_biosolids_generated:220,amount_of_biosolids_managed_land_applied:220,latitude:38.209939,longitude:-90.382593},{facility_name:"SALEM STP, CITY OF",city:"Salem",state:"Iowa",amount_of_biosolids_generated:220,amount_of_biosolids_managed_land_applied:196.5,latitude:38.6167,longitude:-88.9438},{facility_name:"MONROE (JACK'S CRK WPCP)",city:"Monroe",state:"Ga.",amount_of_biosolids_generated:220,amount_of_biosolids_managed_land_applied:0,latitude:33.801801,longitude:-83.636625},{facility_name:"SWEETWATER STP",city:"Sweetwater",state:"Tenn.",amount_of_biosolids_generated:220,amount_of_biosolids_managed_land_applied:0,latitude:35.611742,longitude:-84.458539},{facility_name:"TELLURIDE TOWN OF",city:"Telluride",state:"Colo.",amount_of_biosolids_generated:220,amount_of_biosolids_managed_land_applied:0,latitude:37.94504688,longitude:-107.8804825},{facility_name:"NORTHBELT WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:220,amount_of_biosolids_managed_land_applied:0,latitude:29.929404,longitude:-95.283013},{facility_name:"CITY OF CORSICANA - WWTP 2",city:"Corsicana",state:"Texas",amount_of_biosolids_generated:220,amount_of_biosolids_managed_land_applied:0,latitude:32.092823,longitude:-96.41073},{facility_name:"GLENWOOD SPRINGS CITY OF",city:"Glenwood Springs",state:"Colo.",amount_of_biosolids_generated:219,amount_of_biosolids_managed_land_applied:190.05,latitude:39.54676,longitude:-107.32742},{facility_name:"LUMBERTON MUD WWTP 2",city:"Lumberton",state:"Texas",amount_of_biosolids_generated:219,amount_of_biosolids_managed_land_applied:0,latitude:30.230472,longitude:-94.215889},{facility_name:"CHESAPEAKE BEACH WWTP",city:"Chesapeake Beach",state:"Mass.",amount_of_biosolids_generated:219,amount_of_biosolids_managed_land_applied:0,latitude:38.6686285,longitude:-76.54068},{facility_name:"CITY OF KINGSVILLE 3 MGD WASTEWATER TREATMENT FACILITY",city:"Kingsville",state:"Texas",amount_of_biosolids_generated:219,amount_of_biosolids_managed_land_applied:0,latitude:27.523086,longitude:-97.832245},{facility_name:"THE DALLES, CITY OF",city:"The Dalles",state:"Ore.",amount_of_biosolids_generated:219,amount_of_biosolids_managed_land_applied:219,latitude:45.601496,longitude:-121.179408},{facility_name:"APRA HARBOR WWTP",city:"Agat",state:"Ga.",amount_of_biosolids_generated:219,amount_of_biosolids_managed_land_applied:0,latitude:13.4382999,longitude:144.7729285},{facility_name:"PRASA BARCELONETA",city:"Barceloneta",state:"Pa.",amount_of_biosolids_generated:219,amount_of_biosolids_managed_land_applied:218.76,latitude:18.47939,longitude:-66.545172},{facility_name:"PORTLAND WWTP",city:"Portland",state:"Iowa",amount_of_biosolids_generated:219,amount_of_biosolids_managed_land_applied:0,latitude:40.43596,longitude:-84.97793},{facility_name:"EVANSTON, CITY OF",city:"Evanston",state:"Wyo.",amount_of_biosolids_generated:218,amount_of_biosolids_managed_land_applied:0,latitude:41.26916,longitude:-110.96801},{facility_name:"NORTHERN MORAINE WW REC DIST",city:"Island Lake",state:"Iowa",amount_of_biosolids_generated:218,amount_of_biosolids_managed_land_applied:217.54,latitude:42.2669,longitude:-88.202267},{facility_name:"CITY OF ALVIN WWTP",city:"Alvin",state:"Texas",amount_of_biosolids_generated:217,amount_of_biosolids_managed_land_applied:0,latitude:29.365531,longitude:-95.23412},{facility_name:"GETTYSBURG MUNICIPAL AUTH.",city:"Gettysburg",state:"Pa.",amount_of_biosolids_generated:217,amount_of_biosolids_managed_land_applied:162.55,latitude:39.827521,longitude:-77.155787},{facility_name:"SPRINGFIELD STP",city:"Springfield",state:"Ky.",amount_of_biosolids_generated:217,amount_of_biosolids_managed_land_applied:0,latitude:37.693889,longitude:-85.233611},{facility_name:"FORT LUPTON CITY OF",city:"Fort Lupton",state:"Colo.",amount_of_biosolids_generated:216,amount_of_biosolids_managed_land_applied:0,latitude:40.07962,longitude:-104.81291},{facility_name:"DORSEY RUN ADVANCED WWTP",city:"Annapolis",state:"Mass.",amount_of_biosolids_generated:216,amount_of_biosolids_managed_land_applied:215.64,latitude:39.133085,longitude:-76.781056},{facility_name:"FORT BEND COUNTY MUD 142 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:216,amount_of_biosolids_managed_land_applied:0,latitude:29.693833,longitude:-95.827028},{facility_name:"SIENNA PLANTATION MUD 1 REGIONAL WWTF",city:"Sugar Land",state:"Texas",amount_of_biosolids_generated:216,amount_of_biosolids_managed_land_applied:0,latitude:29.467028,longitude:-95.507379},{facility_name:"CITY OF NORTHPORT",city:"Northport",state:"Alaska",amount_of_biosolids_generated:215,amount_of_biosolids_managed_land_applied:215.34,latitude:33.2144,longitude:-87.5883},{facility_name:"SEWERAGE AGENCY OF SOUTHERN MARIN",city:"Mill Valley",state:"Calif.",amount_of_biosolids_generated:215,amount_of_biosolids_managed_land_applied:0,latitude:37.89226888,longitude:-122.53357},{facility_name:"NORTHEAST DISTRICT WWTF",city:"Baytown",state:"Texas",amount_of_biosolids_generated:215,amount_of_biosolids_managed_land_applied:0,latitude:29.806491,longitude:-94.92216},{facility_name:"WOOD DALE NORTH STP, CITY OF",city:"Wood Dale",state:"Iowa",amount_of_biosolids_generated:215,amount_of_biosolids_managed_land_applied:215.08,latitude:41.964678,longitude:-87.986618},{facility_name:"CARY STP, VILLAGE OF",city:"Cary",state:"Iowa",amount_of_biosolids_generated:215,amount_of_biosolids_managed_land_applied:574,latitude:42.20284,longitude:-88.24203},{facility_name:"IOWA GREAT LAKES SANITARY DISTRICT",city:"Milford",state:"Hawaii",amount_of_biosolids_generated:215,amount_of_biosolids_managed_land_applied:215,latitude:43.314722,longitude:-95.150556},{facility_name:"ANTIOCH STP, VILLAGE OF",city:"Antioch",state:"Iowa",amount_of_biosolids_generated:215,amount_of_biosolids_managed_land_applied:214.87,latitude:42.48015,longitude:-88.099358},{facility_name:"KENDALL COUNTY WCID 1 WWTP",city:"Comfort",state:"Texas",amount_of_biosolids_generated:214,amount_of_biosolids_managed_land_applied:0,latitude:29.974013,longitude:-98.894093},{facility_name:"PIKEVILLE WWTP",city:"Pikeville",state:"Ky.",amount_of_biosolids_generated:213,amount_of_biosolids_managed_land_applied:213.4,latitude:37.491857,longitude:-82.539703},{facility_name:"TAVARES/WOODLEA ROAD WWTF",city:"Tavares",state:"Fla.",amount_of_biosolids_generated:213,amount_of_biosolids_managed_land_applied:0,latitude:28.79188,longitude:-81.75719},{facility_name:"CITY OF BRIDGE CITY",city:"Bridge City",state:"Texas",amount_of_biosolids_generated:213,amount_of_biosolids_managed_land_applied:0,latitude:30.040236,longitude:-93.817693},{facility_name:"PLACERVILLE HANGTOWN CREEK WRF",city:"Placerville",state:"Calif.",amount_of_biosolids_generated:213,amount_of_biosolids_managed_land_applied:212.67,latitude:38.72037105,longitude:-120.8192031},{facility_name:"WEIRTON, CITY OF",city:"Weirton",state:"Wis.",amount_of_biosolids_generated:213,amount_of_biosolids_managed_land_applied:0,latitude:40.38183,longitude:-80.61114},{facility_name:"SEABROOK",city:"Seabrook",state:"Neb.",amount_of_biosolids_generated:213,amount_of_biosolids_managed_land_applied:0,latitude:42.8844901,longitude:-70.86812651},{facility_name:"ROSELLE-J.L. DEVLIN STP",city:"Roselle",state:"Iowa",amount_of_biosolids_generated:212,amount_of_biosolids_managed_land_applied:212.44,latitude:41.971553,longitude:-88.075107},{facility_name:"ATCHISON, CITY OF",city:"Atchison",state:"Kan.",amount_of_biosolids_generated:212,amount_of_biosolids_managed_land_applied:212.4,latitude:39.56297,longitude:-95.11996},{facility_name:"CITY OF WEST LIBERTY",city:"West Liberty",state:"Hawaii",amount_of_biosolids_generated:212,amount_of_biosolids_managed_land_applied:212,latitude:41.57139,longitude:-91.26337},{facility_name:"BETHEL PARK STP",city:"Library",state:"Pa.",amount_of_biosolids_generated:212,amount_of_biosolids_managed_land_applied:0,latitude:40.286667,longitude:-79.991111},{facility_name:"THE WATER WORKS & SEWER BOARD OF THE CITY OF GADSDEN",city:"Gadsden",state:"Alaska",amount_of_biosolids_generated:212,amount_of_biosolids_managed_land_applied:211.81,latitude:33.967945,longitude:-85.972499},{facility_name:"CITY OF SONORA WWTP",city:"Sonora",state:"Texas",amount_of_biosolids_generated:212,amount_of_biosolids_managed_land_applied:0,latitude:30.550972,longitude:-100.651583},{facility_name:"HARRIS COUNTY WCID 89 WWTP",city:"Bellaire",state:"Texas",amount_of_biosolids_generated:212,amount_of_biosolids_managed_land_applied:0,latitude:29.593358,longitude:-95.364765},{facility_name:"FERGUS FALLS",city:"Fergus Falls",state:"Minn.",amount_of_biosolids_generated:211,amount_of_biosolids_managed_land_applied:211,latitude:46.28188,longitude:-96.1126},{facility_name:"SAINT MARYS (CITY OF)",city:"St Marys",state:"Ga.",amount_of_biosolids_generated:211,amount_of_biosolids_managed_land_applied:0,latitude:30.757993,longitude:-81.53817},{facility_name:"CONCORD WWTP",city:"Concord",state:"Mass.",amount_of_biosolids_generated:211,amount_of_biosolids_managed_land_applied:0,latitude:42.462621,longitude:-71.353043},{facility_name:"COTTON BAYOU WWTP",city:"Mont Belvieu",state:"Texas",amount_of_biosolids_generated:210,amount_of_biosolids_managed_land_applied:0,latitude:29.841306,longitude:-94.846861},{facility_name:"DELTA CITY OF",city:"Delta",state:"Colo.",amount_of_biosolids_generated:210,amount_of_biosolids_managed_land_applied:205,latitude:38.742198,longitude:-108.070824},{facility_name:"STEPHENVILLE WWTP",city:"Stephenville",state:"Texas",amount_of_biosolids_generated:210,amount_of_biosolids_managed_land_applied:0,latitude:32.198489,longitude:-98.187606},{facility_name:"SAN LEON WWTF",city:"San Leon",state:"Texas",amount_of_biosolids_generated:210,amount_of_biosolids_managed_land_applied:0,latitude:29.481056,longitude:-94.959639},{facility_name:"FAYETTEVILLE STP",city:"Fayetteville",state:"Tenn.",amount_of_biosolids_generated:209,amount_of_biosolids_managed_land_applied:209.4,latitude:35.14564,longitude:-86.56483},{facility_name:"COTTAGE GROVE, CITY OF",city:"Cottage Grove",state:"Ore.",amount_of_biosolids_generated:209,amount_of_biosolids_managed_land_applied:0,latitude:43.80777,longitude:-123.05011},{facility_name:"CLEARFIELD MUN AUTH.",city:"Clearfield",state:"Pa.",amount_of_biosolids_generated:209,amount_of_biosolids_managed_land_applied:60.18,latitude:41.02207,longitude:-78.43941},{facility_name:"TOWN OF WARRENTON",city:"Warrenton",state:"Mont.",amount_of_biosolids_generated:209,amount_of_biosolids_managed_land_applied:209.02,latitude:36.379799,longitude:-78.168333},{facility_name:"CITY OF SWEETWATER WWTP",city:"Sweetwater",state:"Texas",amount_of_biosolids_generated:209,amount_of_biosolids_managed_land_applied:0,latitude:32.498167,longitude:-100.343972},{facility_name:"MARINE CORPS BASE, CAMP PENDLETON",city:"Camp Pendleton",state:"Calif.",amount_of_biosolids_generated:209,amount_of_biosolids_managed_land_applied:0,latitude:33.28786,longitude:-117.43731},{facility_name:"GAFFNEY/CLARY WWTF",city:"Gaffney",state:"S.C.",amount_of_biosolids_generated:208,amount_of_biosolids_managed_land_applied:208,latitude:35.05,longitude:-81.616666},{facility_name:"HORSHAM TOWNSHIP",city:"Horsham",state:"Pa.",amount_of_biosolids_generated:208,amount_of_biosolids_managed_land_applied:0,latitude:40.218758,longitude:-75.154813},{facility_name:"MONTEREY STP",city:"Monterey",state:"Tenn.",amount_of_biosolids_generated:208,amount_of_biosolids_managed_land_applied:207.9,latitude:36.15351,longitude:-85.29338},{facility_name:"HUDSON (C)",city:"Hudson",state:"N.D.",amount_of_biosolids_generated:208,amount_of_biosolids_managed_land_applied:0,latitude:42.2491,longitude:-73.78591},{facility_name:"MUSTANG BAYOU WWTF",city:"Missouri City",state:"Texas",amount_of_biosolids_generated:207,amount_of_biosolids_managed_land_applied:0,latitude:29.539667,longitude:-95.504639},{facility_name:"MADELIA WASTEWATER TREATMENT PLANT",city:"Madelia",state:"Minn.",amount_of_biosolids_generated:207,amount_of_biosolids_managed_land_applied:207,latitude:44.04328,longitude:-94.41952},{facility_name:"WESTWAY WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:207,amount_of_biosolids_managed_land_applied:0,latitude:29.8444,longitude:-95.54765},{facility_name:"WINDOM",city:"Windom",state:"Minn.",amount_of_biosolids_generated:206,amount_of_biosolids_managed_land_applied:206,latitude:43.86074,longitude:-95.10897},{facility_name:"LONDON STP",city:"London",state:"Ky.",amount_of_biosolids_generated:206,amount_of_biosolids_managed_land_applied:78,latitude:37.10638,longitude:-84.06683},{facility_name:"CITY OF HAVELOCK",city:"Havelock",state:"Mont.",amount_of_biosolids_generated:206,amount_of_biosolids_managed_land_applied:205.52,latitude:34.887658,longitude:-76.909441},{facility_name:"MEMORIAL VILLAGES WA WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:205,amount_of_biosolids_managed_land_applied:0,latitude:29.746806,longitude:-95.507167},{facility_name:"DISCOVERY BAY WWTP",city:"Discovery Bay",state:"Calif.",amount_of_biosolids_generated:205,amount_of_biosolids_managed_land_applied:0,latitude:37.90885809,longitude:-121.6054143},{facility_name:"FT. BEND CO. MUD 23 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:205,amount_of_biosolids_managed_land_applied:0,latitude:29.526306,longitude:-95.478083},{facility_name:"SCHOFIELD BARRACKS WWTP",city:"Wahiawa",state:"Hawaii",amount_of_biosolids_generated:205,amount_of_biosolids_managed_land_applied:0,latitude:21.49873211,longitude:-158.0336727},{facility_name:"BOONVILLE, CITY OF",city:"Boonville",state:"Mo.",amount_of_biosolids_generated:205,amount_of_biosolids_managed_land_applied:0,latitude:38.9757,longitude:-92.74277},{facility_name:"ALLIANCE WATER RESOURCES",city:"Cameron",state:"Mo.",amount_of_biosolids_generated:204,amount_of_biosolids_managed_land_applied:790.73,latitude:39.68159797,longitude:-94.26280879},{facility_name:"WHITE OAK BAYOU REGIONAL WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:204,amount_of_biosolids_managed_land_applied:0,latitude:29.88554,longitude:-95.55032},{facility_name:"HARVARD STP, CITY OF",city:"Harvard",state:"Iowa",amount_of_biosolids_generated:204,amount_of_biosolids_managed_land_applied:112,latitude:42.41483,longitude:-88.62527},{facility_name:"ROSAMOND WTF (PONDS)",city:"Rosamond",state:"Calif.",amount_of_biosolids_generated:203,amount_of_biosolids_managed_land_applied:202.62,latitude:34.86616,longitude:-118.19369},{facility_name:"JTI CONSTRUCTORS WWTP",city:"Magnolia",state:"Texas",amount_of_biosolids_generated:202,amount_of_biosolids_managed_land_applied:195.59,latitude:29.440833,longitude:-95.748888},{facility_name:"JACKSON, CITY OF",city:"Jackson",state:"Mo.",amount_of_biosolids_generated:202,amount_of_biosolids_managed_land_applied:201.81,latitude:37.38286,longitude:-89.66805},{facility_name:"TEHACHAPI WWTP",city:"Tehachapi",state:"Calif.",amount_of_biosolids_generated:202,amount_of_biosolids_managed_land_applied:0,latitude:35.13117,longitude:-118.4461},{facility_name:"PAYSON CITY CORP",city:"Payson",state:"Utah",amount_of_biosolids_generated:202,amount_of_biosolids_managed_land_applied:0,latitude:40.04363,longitude:-111.73844},{facility_name:"GREAT BARRINGTON W W T F",city:"Great Barrington",state:"Mass.",amount_of_biosolids_generated:201,amount_of_biosolids_managed_land_applied:0,latitude:42.18994,longitude:-73.35709},{facility_name:"MINDEN-GARDNERVILLE SD WWTP",city:"Minden",state:"N.D.",amount_of_biosolids_generated:201,amount_of_biosolids_managed_land_applied:201,latitude:38.95706757,longitude:-119.7712328},{facility_name:"LOS OSOS WATER RECYCLING FACILITY",city:"Los Osos",state:"Calif.",amount_of_biosolids_generated:201,amount_of_biosolids_managed_land_applied:0,latitude:35.305498,longitude:-120.800669},{facility_name:"VERANDA WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:200,amount_of_biosolids_managed_land_applied:0,latitude:29.808241,longitude:-94.839528},{facility_name:"CITY OF DALHART WWTP",city:"Dalhart",state:"Texas",amount_of_biosolids_generated:200,amount_of_biosolids_managed_land_applied:0,latitude:36.037806,longitude:-102.499167},{facility_name:"RIO VISTA, CITY OF",city:"Rio Vista",state:"Calif.",amount_of_biosolids_generated:200,amount_of_biosolids_managed_land_applied:0,latitude:38.186751,longitude:-121.703832},{facility_name:"LAUGHLIN WRF",city:"Laughlin",state:"N.D.",amount_of_biosolids_generated:200,amount_of_biosolids_managed_land_applied:0,latitude:35.15663,longitude:-114.58885},{facility_name:"JAMESTOWN CITY OF",city:"Jamestown",state:"Mont.",amount_of_biosolids_generated:200,amount_of_biosolids_managed_land_applied:199.78,latitude:46.90846,longitude:-98.70543},{facility_name:"POMPTON LAKES BORO MUA",city:"Pompton Lakes",state:"Neb.",amount_of_biosolids_generated:199,amount_of_biosolids_managed_land_applied:199.28,latitude:40.981747,longitude:-74.283051},{facility_name:"UTULEI STP",city:"Pago Pago",state:"Alaska",amount_of_biosolids_generated:199,amount_of_biosolids_managed_land_applied:0,latitude:-14.2812,longitude:-170.701},{facility_name:"LINDENHURST SD STP",city:"Lindenhurst",state:"Iowa",amount_of_biosolids_generated:199,amount_of_biosolids_managed_land_applied:198.69,latitude:42.430058,longitude:-88.032259},{facility_name:"BRAZORIA COUNTY MUD 3 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:198,amount_of_biosolids_managed_land_applied:0,latitude:29.542833,longitude:-95.344583},{facility_name:"FULTON COUNTY (LITTLE RIVER)",city:"Atlanta",state:"Ga.",amount_of_biosolids_generated:198,amount_of_biosolids_managed_land_applied:0,latitude:34.102683,longitude:-84.429545},{facility_name:"CITY OF BOONE",city:"Boone",state:"Hawaii",amount_of_biosolids_generated:198,amount_of_biosolids_managed_land_applied:108.28,latitude:42.05113,longitude:-93.88405948},{facility_name:"CHRISTIANSBURG TOWN OF",city:"Christiansburg",state:"Utah",amount_of_biosolids_generated:198,amount_of_biosolids_managed_land_applied:190.4,latitude:37.15688,longitude:-80.47159},{facility_name:"DYERSBURG STP",city:"Dyersburg",state:"Tenn.",amount_of_biosolids_generated:198,amount_of_biosolids_managed_land_applied:197.53,latitude:36.029238,longitude:-89.418128},{facility_name:"LAWRENCEBURG STP",city:"Lawrenceburg",state:"Tenn.",amount_of_biosolids_generated:197,amount_of_biosolids_managed_land_applied:177.36,latitude:35.241667,longitude:-87.353056},{facility_name:"BOLINGBROOK STP #1, VILLAGE OF",city:"Bolingbrook",state:"Iowa",amount_of_biosolids_generated:197,amount_of_biosolids_managed_land_applied:197,latitude:41.71847,longitude:-88.07181},{facility_name:"SOUTHSIDE WWTP",city:"Alice",state:"Texas",amount_of_biosolids_generated:197,amount_of_biosolids_managed_land_applied:0,latitude:27.723,longitude:-98.031028},{facility_name:"CITY OF MARSHALL SOUTHSIDE PLANT",city:"Marshall",state:"Texas",amount_of_biosolids_generated:197,amount_of_biosolids_managed_land_applied:0,latitude:32.488639,longitude:-94.324574},{facility_name:"OAK LODGE SANITARY DISTRICT",city:"Milwaukie",state:"Ore.",amount_of_biosolids_generated:196,amount_of_biosolids_managed_land_applied:195.34,latitude:45.423633,longitude:-122.652298},{facility_name:"MARTINEZ IV WWTP",city:"San Antonio",state:"Texas",amount_of_biosolids_generated:196,amount_of_biosolids_managed_land_applied:0,latitude:29.440844,longitude:-98.24998},{facility_name:"LEON PLANT WWTP",city:"Gatesville",state:"Texas",amount_of_biosolids_generated:196,amount_of_biosolids_managed_land_applied:195.83,latitude:31.426577,longitude:-97.74531},{facility_name:"SWANSEA STP, VILLAGE OF",city:"Swansea",state:"Iowa",amount_of_biosolids_generated:195,amount_of_biosolids_managed_land_applied:225.9,latitude:38.52955,longitude:-89.98065},{facility_name:"CITY OF ROXBORO",city:"Roxboro",state:"Mont.",amount_of_biosolids_generated:195,amount_of_biosolids_managed_land_applied:195,latitude:36.444475,longitude:-78.977889},{facility_name:"TAYLORVILLE SD STP",city:"Taylorville",state:"Iowa",amount_of_biosolids_generated:195,amount_of_biosolids_managed_land_applied:0,latitude:39.56013,longitude:-89.33373},{facility_name:"ODEM STREET WWTP",city:"Victoria",state:"Texas",amount_of_biosolids_generated:195,amount_of_biosolids_managed_land_applied:0,latitude:28.784786,longitude:-96.994649},{facility_name:"CITY OF BOERNE WWTP",city:"Boerne",state:"Texas",amount_of_biosolids_generated:195,amount_of_biosolids_managed_land_applied:0,latitude:29.7885,longitude:-98.715555},{facility_name:"CITY OF ALACHUA AWRF",city:"Alachua",state:"Fla.",amount_of_biosolids_generated:194,amount_of_biosolids_managed_land_applied:194.4,latitude:29.79908,longitude:-82.49426},{facility_name:"STONEGATE VILLAGE METRO DIST.",city:"Parker",state:"Colo.",amount_of_biosolids_generated:194,amount_of_biosolids_managed_land_applied:0,latitude:39.551402,longitude:-104.79351},{facility_name:"CITY OF DUNN",city:"Dunn",state:"Mont.",amount_of_biosolids_generated:194,amount_of_biosolids_managed_land_applied:194.25,latitude:35.292,longitude:-78.685541},{facility_name:"FORT BEND COUNTY MUD 122 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:194,amount_of_biosolids_managed_land_applied:0,latitude:29.699389,longitude:-95.7255},{facility_name:"PENINSULA REG WATER REC PLANT",city:"Lewisville",state:"Texas",amount_of_biosolids_generated:193,amount_of_biosolids_managed_land_applied:0,latitude:33.208417,longitude:-96.990583},{facility_name:"CITY OF COLEMAN WWTP",city:"Coleman",state:"Texas",amount_of_biosolids_generated:192,amount_of_biosolids_managed_land_applied:0,latitude:31.825139,longitude:-99.404778},{facility_name:"HARRIS COUNTY MUD 167 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:191,amount_of_biosolids_managed_land_applied:0,latitude:29.848698,longitude:-95.702392},{facility_name:"LONGWOOD WWTP",city:"Pearland",state:"Texas",amount_of_biosolids_generated:191,amount_of_biosolids_managed_land_applied:0,latitude:29.5569,longitude:-95.2164},{facility_name:"NORTH KUEHLER WWTP",city:"New Braunfels",state:"Texas",amount_of_biosolids_generated:190,amount_of_biosolids_managed_land_applied:0,latitude:29.6892,longitude:-98.0991},{facility_name:"WASHINGTON TWP MUN AUTHORITY",city:"Waynesboro",state:"Pa.",amount_of_biosolids_generated:190,amount_of_biosolids_managed_land_applied:189.5,latitude:39.725833,longitude:-77.593333},{facility_name:"WESTSIDE WWTP",city:"La Marque",state:"Texas",amount_of_biosolids_generated:189,amount_of_biosolids_managed_land_applied:0,latitude:29.35225,longitude:-94.983389},{facility_name:"BARNWELL WWTF",city:"Barnwell",state:"S.C.",amount_of_biosolids_generated:189,amount_of_biosolids_managed_land_applied:0,latitude:33.2186164,longitude:-81.35082299},{facility_name:"CITY OF TOLEDO",city:"Toledo",state:"Hawaii",amount_of_biosolids_generated:189,amount_of_biosolids_managed_land_applied:188.79,latitude:41.99516,longitude:-92.57689},{facility_name:"BURLINGTON RIVERSIDE WWTP",city:"Burlington",state:"Va.",amount_of_biosolids_generated:189,amount_of_biosolids_managed_land_applied:0,latitude:44.486896,longitude:-73.193622},{facility_name:"MAYDE CREEK MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:188,amount_of_biosolids_managed_land_applied:188.29,latitude:29.815079,longitude:-95.70406},{facility_name:"CITY OF SOUTH HOUSTON",city:"Houston",state:"Texas",amount_of_biosolids_generated:188,amount_of_biosolids_managed_land_applied:188.23,latitude:29.669861,longitude:-95.234889},{facility_name:"TELFORD BORO AUTH WWTP",city:"Telford",state:"Pa.",amount_of_biosolids_generated:188,amount_of_biosolids_managed_land_applied:0,latitude:40.32118,longitude:-75.33902},{facility_name:"EAST BASTROP WWTF",city:"Bastrop",state:"Texas",amount_of_biosolids_generated:188,amount_of_biosolids_managed_land_applied:0,latitude:30.10312,longitude:-97.31859},{facility_name:"TOWN OF HANOVER",city:"Hanover",state:"Neb.",amount_of_biosolids_generated:188,amount_of_biosolids_managed_land_applied:0,latitude:43.69194,longitude:-72.29076},{facility_name:"EASLEY/MIDDLE BRANCH WWTP",city:"Easley",state:"S.C.",amount_of_biosolids_generated:187,amount_of_biosolids_managed_land_applied:187,latitude:34.783611,longitude:-82.534444},{facility_name:"CANTON WEST STP, CITY OF",city:"Canton",state:"Iowa",amount_of_biosolids_generated:187,amount_of_biosolids_managed_land_applied:0,latitude:40.54837,longitude:-90.04191},{facility_name:"HARRIS COUNTY WCID 92 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:187,amount_of_biosolids_managed_land_applied:69.0127676,latitude:30.084043,longitude:-95.385817},{facility_name:"PRASA SAN GERMAN",city:"San German",state:"Pa.",amount_of_biosolids_generated:187,amount_of_biosolids_managed_land_applied:186.56,latitude:18.08331,longitude:-67.0462},{facility_name:"OYSTER CREEK WWTP",city:"Angleton",state:"Texas",amount_of_biosolids_generated:186,amount_of_biosolids_managed_land_applied:0,latitude:29.158593,longitude:-95.460294},{facility_name:"MIRALOMAS MUD WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:186,amount_of_biosolids_managed_land_applied:0,latitude:29.591752,longitude:-98.580356},{facility_name:"WOODLAND PARK CITY OF",city:"Woodland Park",state:"Colo.",amount_of_biosolids_generated:186,amount_of_biosolids_managed_land_applied:0,latitude:38.99590237,longitude:-105.055912},{facility_name:"HUNTLEY EAST STP, VILLAGE OF",city:"Huntley",state:"Iowa",amount_of_biosolids_generated:186,amount_of_biosolids_managed_land_applied:186.03,latitude:42.1664,longitude:-88.4164},{facility_name:"CITY OF HICO WWTP",city:"Hico",state:"Texas",amount_of_biosolids_generated:186,amount_of_biosolids_managed_land_applied:0,latitude:31.978194,longitude:-98.026},{facility_name:"HUTCHINSON",city:"Hutchinson",state:"Minn.",amount_of_biosolids_generated:186,amount_of_biosolids_managed_land_applied:185.85,latitude:44.87487,longitude:-94.35363},{facility_name:"HUNTSVILLE, CITY OF",city:"Huntsville",state:"Alaska",amount_of_biosolids_generated:186,amount_of_biosolids_managed_land_applied:0,latitude:36.1114,longitude:-93.7336},{facility_name:"PUNXSUTAWNEY BORO MUN AUTH",city:"Punxstawney",state:"Pa.",amount_of_biosolids_generated:185,amount_of_biosolids_managed_land_applied:0,latitude:40.941402,longitude:-79.001564},{facility_name:"CAMDEN WWTF",city:"Camden",state:"S.C.",amount_of_biosolids_generated:185,amount_of_biosolids_managed_land_applied:185.18,latitude:34.235278,longitude:-80.628333},{facility_name:"LEE WWTP, TOWN OF",city:"Lee",state:"Mass.",amount_of_biosolids_generated:185,amount_of_biosolids_managed_land_applied:0,latitude:42.286286,longitude:-73.241279},{facility_name:"CHATHAM TWP MAIN STP",city:"Chatham",state:"Neb.",amount_of_biosolids_generated:185,amount_of_biosolids_managed_land_applied:0,latitude:40.71808,longitude:-74.41776},{facility_name:"COEBURN-NORTON-WISE REGIONAL",city:"Coeburn",state:"Utah",amount_of_biosolids_generated:184,amount_of_biosolids_managed_land_applied:172.9,latitude:36.927381,longitude:-82.478246},{facility_name:"CITY OF MAYPEARL WWTP",city:"Maypearl",state:"Texas",amount_of_biosolids_generated:184,amount_of_biosolids_managed_land_applied:0,latitude:32.303722,longitude:-97.007667},{facility_name:"FARMVILLE WASTEWATER TREATMENT",city:"Farmville",state:"Utah",amount_of_biosolids_generated:184,amount_of_biosolids_managed_land_applied:178,latitude:37.30128,longitude:-78.38104},{facility_name:"FT BEND CO MUD 152 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:184,amount_of_biosolids_managed_land_applied:0,latitude:29.511917,longitude:-95.746806},{facility_name:"HULL W P C F",city:"Hull",state:"Mass.",amount_of_biosolids_generated:183,amount_of_biosolids_managed_land_applied:0,latitude:42.306011,longitude:-70.899405},{facility_name:"LAFAYETTE CONSOLIDATED GOVERNMENT - NORTHEAST WWTP",city:"Lafayette",state:"La.",amount_of_biosolids_generated:183,amount_of_biosolids_managed_land_applied:183.3,latitude:30.28134,longitude:-91.97596},{facility_name:"MONTAGUE WPCF",city:"Montague",state:"Mass.",amount_of_biosolids_generated:183,amount_of_biosolids_managed_land_applied:0,latitude:42.55134494,longitude:-72.53117977},{facility_name:"MON VALLEY SEWAGE AUTHORITY",city:"Donora",state:"Pa.",amount_of_biosolids_generated:182,amount_of_biosolids_managed_land_applied:0,latitude:40.16476,longitude:-79.86493},{facility_name:"CITY OF WHITEFISH",city:"Whitefish",state:"Mont.",amount_of_biosolids_generated:182,amount_of_biosolids_managed_land_applied:0,latitude:48.39769972,longitude:-114.3276421},{facility_name:"HARRIS COUNTY MUD 432 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:181,amount_of_biosolids_managed_land_applied:181.47,latitude:29.823711,longitude:-95.789638},{facility_name:"CITY OF MERIDIAN WWTF 2",city:"Meridian",state:"Texas",amount_of_biosolids_generated:181,amount_of_biosolids_managed_land_applied:141.5,latitude:31.919072,longitude:-97.653843},{facility_name:"UNION TWP WWTP",city:"Mt. Pleasant",state:"Mich.",amount_of_biosolids_generated:181,amount_of_biosolids_managed_land_applied:181.2,latitude:43.599492,longitude:-84.774788},{facility_name:"MURPHYSBORO STP, CITY OF",city:"Murphysboro",state:"Iowa",amount_of_biosolids_generated:181,amount_of_biosolids_managed_land_applied:0,latitude:37.75928,longitude:-89.3614},{facility_name:"CITY OF FAIRFIELD",city:"Fairfield",state:"Hawaii",amount_of_biosolids_generated:181,amount_of_biosolids_managed_land_applied:180.6,latitude:41.00606,longitude:-91.9638},{facility_name:"TRAIL OF THE LAKES WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:180,amount_of_biosolids_managed_land_applied:0,latitude:29.963888,longitude:-95.208055},{facility_name:"CLAIBORNE UTILITIES DISTRICT STP",city:"Tazewell",state:"Tenn.",amount_of_biosolids_generated:180,amount_of_biosolids_managed_land_applied:180,latitude:36.46327,longitude:-83.55972},{facility_name:"JOLIET AUX SABLE CREEK WWTP",city:"Joliet",state:"Iowa",amount_of_biosolids_generated:180,amount_of_biosolids_managed_land_applied:180,latitude:41.53523,longitude:-88.26855},{facility_name:"PINE MILL RANCH FT BEND MUD 57 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:180,amount_of_biosolids_managed_land_applied:0,latitude:29.721611,longitude:-95.829944},{facility_name:"BERKELEY HEIGHTS WPCF",city:"Berkeley Heights",state:"Neb.",amount_of_biosolids_generated:179,amount_of_biosolids_managed_land_applied:0,latitude:40.689407,longitude:-74.441069},{facility_name:"BROOKFIELD CITY",city:"Brookfield",state:"Mo.",amount_of_biosolids_generated:179,amount_of_biosolids_managed_land_applied:0,latitude:39.78646,longitude:-93.07542},{facility_name:"CITY OF JEFFERSON WWTP",city:"Jefferson",state:"Texas",amount_of_biosolids_generated:179,amount_of_biosolids_managed_land_applied:0,latitude:32.777444,longitude:-94.349306},{facility_name:"SCHUYLKILL CNTY MUNI AUTH",city:"Pottsville",state:"Pa.",amount_of_biosolids_generated:179,amount_of_biosolids_managed_land_applied:0,latitude:40.68334,longitude:-76.19381},{facility_name:"TOWN OF MOREHEAD CITY",city:"Morehead City",state:"Mont.",amount_of_biosolids_generated:178,amount_of_biosolids_managed_land_applied:177.67,latitude:34.734036,longitude:-76.736873},{facility_name:"HIGHWAY 181 SOUTH WWTP",city:"Elmendorf",state:"Texas",amount_of_biosolids_generated:178,amount_of_biosolids_managed_land_applied:0,latitude:29.276663,longitude:-98.336521},{facility_name:"GIG HARBOR STP",city:"Gig Harbor",state:"Wash.",amount_of_biosolids_generated:177,amount_of_biosolids_managed_land_applied:177.3,latitude:47.33726,longitude:-122.596563},{facility_name:"LOS ALAMOS COUNTY - BAYO WWTP",city:"Los Alamos",state:"N.D.",amount_of_biosolids_generated:177,amount_of_biosolids_managed_land_applied:177,latitude:35.88127,longitude:-106.29626},{facility_name:"SHREVEPORT, CITY OF (N HIGHLAN",city:"Shreveport",state:"La.",amount_of_biosolids_generated:177,amount_of_biosolids_managed_land_applied:155,latitude:32.550167,longitude:-93.765753},{facility_name:"EAST PEORIA STP #1, CITY OF",city:"East Peoria",state:"Iowa",amount_of_biosolids_generated:177,amount_of_biosolids_managed_land_applied:0,latitude:40.66601,longitude:-89.60366},{facility_name:"TOWN OF PURCELLVILLE STP",city:"Purcellville",state:"Utah",amount_of_biosolids_generated:177,amount_of_biosolids_managed_land_applied:64.28,latitude:39.13464,longitude:-77.71611},{facility_name:"GUNNISON CITY OF",city:"Gunnison",state:"Colo.",amount_of_biosolids_generated:177,amount_of_biosolids_managed_land_applied:176.8,latitude:38.58124601,longitude:-106.9191344},{facility_name:"KERN SA MT VERNON WWTP",city:"Bakersfield",state:"Calif.",amount_of_biosolids_generated:177,amount_of_biosolids_managed_land_applied:0,latitude:35.38371,longitude:-119.01523},{facility_name:"DETROIT LAKES",city:"Detroit Lakes",state:"Minn.",amount_of_biosolids_generated:177,amount_of_biosolids_managed_land_applied:176.54,latitude:46.81152,longitude:-95.86468},{facility_name:"HARRIS COUNTY MUD 150 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:176,amount_of_biosolids_managed_land_applied:0,latitude:29.954111,longitude:-95.4665},{facility_name:"CITY OF VERNON WWTF",city:"Vernon",state:"Texas",amount_of_biosolids_generated:175,amount_of_biosolids_managed_land_applied:0,latitude:34.163389,longitude:-99.269417},{facility_name:"SPEARFISH, CITY OF",city:"Spearfish, City Of",state:"S.D.",amount_of_biosolids_generated:175,amount_of_biosolids_managed_land_applied:0,latitude:44.48962,longitude:-103.86042},{facility_name:"ANDOVER, CITY OF",city:"Andover",state:"Kan.",amount_of_biosolids_generated:175,amount_of_biosolids_managed_land_applied:175.4,latitude:37.66487,longitude:-97.11143},{facility_name:"CITY OF SUGAR LAND NEW TERRITORY NORTH REGIONAL WWTF",city:"Sugar Land",state:"Texas",amount_of_biosolids_generated:175,amount_of_biosolids_managed_land_applied:0,latitude:29.578278,longitude:-95.696056},{facility_name:"MOUNT CARMEL STP, CITY OF",city:"Mount Carmel",state:"Iowa",amount_of_biosolids_generated:175,amount_of_biosolids_managed_land_applied:175.024,latitude:38.400566,longitude:-87.773971},{facility_name:"EL PORTAL WWTF",city:"El Portal",state:"Calif.",amount_of_biosolids_generated:175,amount_of_biosolids_managed_land_applied:0,latitude:37.6750267,longitude:-119.7938909},{facility_name:"RIDGEFIELD, TOWN OF (MAIN)",city:"Ridgefield",state:"Conn.",amount_of_biosolids_generated:174,amount_of_biosolids_managed_land_applied:0,latitude:41.290159,longitude:-73.490438},{facility_name:"TOWN OF WALLACE",city:"Wallace",state:"Mont.",amount_of_biosolids_generated:174,amount_of_biosolids_managed_land_applied:173.88,latitude:34.730915,longitude:-77.983318},{facility_name:"SEDRO WOOLLEY WWTP",city:"Sedro Woolley",state:"Wash.",amount_of_biosolids_generated:174,amount_of_biosolids_managed_land_applied:173.77,latitude:48.49555,longitude:-122.235317},{facility_name:"HONESDALE BOROUGH",city:"Honesdale",state:"Pa.",amount_of_biosolids_generated:174,amount_of_biosolids_managed_land_applied:0,latitude:41.55411,longitude:-75.24426},{facility_name:"OTTAWA WWTP PLANT",city:"Ottawa",state:"Kan.",amount_of_biosolids_generated:173,amount_of_biosolids_managed_land_applied:172.91,latitude:38.62171252,longitude:-95.26973766},{facility_name:"CITY OF JACKSBORO",city:"Jacksboro",state:"Texas",amount_of_biosolids_generated:172,amount_of_biosolids_managed_land_applied:0,latitude:33.23425,longitude:-98.179722},{facility_name:"HARTFORD CITY WWTP",city:"Hartford City",state:"Iowa",amount_of_biosolids_generated:172,amount_of_biosolids_managed_land_applied:0,latitude:40.421621,longitude:-85.38247837},{facility_name:"PRASA CAMUY",city:"Santurce",state:"Pa.",amount_of_biosolids_generated:172,amount_of_biosolids_managed_land_applied:172.21,latitude:18.488446,longitude:-66.875818},{facility_name:"CITY OF LA FERIA WWTP",city:"La Feria",state:"Texas",amount_of_biosolids_generated:172,amount_of_biosolids_managed_land_applied:0,latitude:26.144079,longitude:-97.836575},{facility_name:"CAMDEN, CITY OF",city:"Camden",state:"Alaska",amount_of_biosolids_generated:172,amount_of_biosolids_managed_land_applied:0,latitude:33.587175,longitude:-92.829008},{facility_name:"HARRIS COUNTY MUD 82 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:172,amount_of_biosolids_managed_land_applied:0,latitude:30.072454,longitude:-95.377182},{facility_name:"UPPER THOMPSON SANITATION DISTRICT",city:"Estes Park",state:"Colo.",amount_of_biosolids_generated:171,amount_of_biosolids_managed_land_applied:0,latitude:40.38028952,longitude:-105.5246375},{facility_name:"HONOLULU WAIANAE WWTP",city:"Kapolei",state:"Hawaii",amount_of_biosolids_generated:171,amount_of_biosolids_managed_land_applied:0,latitude:21.33003,longitude:-158.08158},{facility_name:"TOWN OF BENNINGTON",city:"Bennington",state:"Va.",amount_of_biosolids_generated:171,amount_of_biosolids_managed_land_applied:171,latitude:42.87735,longitude:-73.19719},{facility_name:"COLD SPRING",city:"Cold Spring",state:"Minn.",amount_of_biosolids_generated:171,amount_of_biosolids_managed_land_applied:171,latitude:45.45894,longitude:-94.41811},{facility_name:"COVINGTON SEW. TREAT. PLANT,CO",city:"Covington",state:"Utah",amount_of_biosolids_generated:171,amount_of_biosolids_managed_land_applied:0,latitude:37.759154,longitude:-79.995574},{facility_name:"SNOQUALMIE WWTP AND RECLAIM FACILITY",city:"Snoqualmie",state:"Wash.",amount_of_biosolids_generated:171,amount_of_biosolids_managed_land_applied:170.75,latitude:47.542621,longitude:-121.829782},{facility_name:"CITY OF PORTLAND",city:"Portland",state:"Tenn.",amount_of_biosolids_generated:170,amount_of_biosolids_managed_land_applied:170,latitude:36.58724,longitude:-86.52441},{facility_name:"CITY OF SIOUX CENTER",city:"Sioux Center",state:"Hawaii",amount_of_biosolids_generated:170,amount_of_biosolids_managed_land_applied:169.9,latitude:43.08056,longitude:-96.17704},{facility_name:"HARRIS COUNTY MUD 400 WWTP 2",city:"Houston",state:"Texas",amount_of_biosolids_generated:170,amount_of_biosolids_managed_land_applied:169.898937,latitude:29.945833,longitude:-95.219444},{facility_name:"EAST WINDSOR WPCF",city:"East Windsor",state:"Conn.",amount_of_biosolids_generated:170,amount_of_biosolids_managed_land_applied:0,latitude:41.919039,longitude:-72.619763},{facility_name:"NEWTON, CITY OF",city:"Newton",state:"Kan.",amount_of_biosolids_generated:170,amount_of_biosolids_managed_land_applied:169.65,latitude:38.21065424,longitude:-97.35441902},{facility_name:"ROCK CREEK WWTP",city:"Borger",state:"Texas",amount_of_biosolids_generated:170,amount_of_biosolids_managed_land_applied:0,latitude:35.668333,longitude:-101.404444},{facility_name:"SYCAMORE STP - NORTH PLANT",city:"Sycamore",state:"Iowa",amount_of_biosolids_generated:169,amount_of_biosolids_managed_land_applied:179.02,latitude:41.996043,longitude:-88.693241},{facility_name:"JEFFERSON COUNTY COMMISSION ENVIRONMENTAL SERVICES DEPARTMENT",city:"Birmingham",state:"Alaska",amount_of_biosolids_generated:169,amount_of_biosolids_managed_land_applied:169,latitude:33.5349,longitude:-86.5606},{facility_name:"LINCOLN COUNTY",city:"Lincolnton",state:"Mont.",amount_of_biosolids_generated:169,amount_of_biosolids_managed_land_applied:169,latitude:35.41842,longitude:-81.03468},{facility_name:"PLYMOUTH WPCF",city:"Pequabuck",state:"Conn.",amount_of_biosolids_generated:169,amount_of_biosolids_managed_land_applied:0,latitude:41.668987,longitude:-72.991771},{facility_name:"CITY OF WARRENTON",city:"Warrenton",state:"Mo.",amount_of_biosolids_generated:169,amount_of_biosolids_managed_land_applied:168.93,latitude:38.820678,longitude:-91.151743},{facility_name:"BOROUGH OF HUNTINGDON",city:"Huntingdon",state:"Pa.",amount_of_biosolids_generated:169,amount_of_biosolids_managed_land_applied:168.87,latitude:40.475907,longitude:-78.001114},{facility_name:"BENNETTSVILLE WWTF",city:"Bennettsville",state:"S.C.",amount_of_biosolids_generated:168,amount_of_biosolids_managed_land_applied:168,latitude:34.516667,longitude:-79.673333},{facility_name:"CITY OF NIXON WWTP",city:"Nixon",state:"Texas",amount_of_biosolids_generated:168,amount_of_biosolids_managed_land_applied:0,latitude:29.284241,longitude:-97.768972},{facility_name:"EASTERN SNYDER COUNTY REGIONAL",city:"Selinsgrove",state:"Pa.",amount_of_biosolids_generated:168,amount_of_biosolids_managed_land_applied:0,latitude:40.88715856,longitude:-76.82407072},{facility_name:"WOODSTREAM STP",city:"Marlton",state:"Neb.",amount_of_biosolids_generated:168,amount_of_biosolids_managed_land_applied:0,latitude:39.87960532,longitude:-74.90819647},{facility_name:"CITY OF STOCKBRIDGE",city:"Stockbridge",state:"Ga.",amount_of_biosolids_generated:167,amount_of_biosolids_managed_land_applied:94,latitude:33.550771,longitude:-84.226582},{facility_name:"HONDO WWTP",city:"Hondo",state:"Texas",amount_of_biosolids_generated:166,amount_of_biosolids_managed_land_applied:0,latitude:29.337716,longitude:-99.128837},{facility_name:"LINCOLN GREEN REGIONAL WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:166,amount_of_biosolids_managed_land_applied:0,latitude:29.941625,longitude:-95.466629},{facility_name:"CITY OF CUERO WWTP",city:"Cuero",state:"Texas",amount_of_biosolids_generated:166,amount_of_biosolids_managed_land_applied:0,latitude:29.068497,longitude:-97.29453},{facility_name:"CITY OF MUENSTER WWTP",city:"Muenster",state:"Texas",amount_of_biosolids_generated:166,amount_of_biosolids_managed_land_applied:0,latitude:33.643021,longitude:-97.372335},{facility_name:"CITY OF WHITEWRIGHT WWTP",city:"Whitewright",state:"Texas",amount_of_biosolids_generated:166,amount_of_biosolids_managed_land_applied:0,latitude:33.520858,longitude:-96.392039},{facility_name:"MOREHEAD STP",city:"Morehead",state:"Ky.",amount_of_biosolids_generated:165,amount_of_biosolids_managed_land_applied:165.13,latitude:38.151905,longitude:-83.513849},{facility_name:"FERDINAND WWTP",city:"Ferdinand",state:"Iowa",amount_of_biosolids_generated:164,amount_of_biosolids_managed_land_applied:0,latitude:38.221194,longitude:-86.868306},{facility_name:"TOPPENISH, CITY OF",city:"Toppenish",state:"Wash.",amount_of_biosolids_generated:164,amount_of_biosolids_managed_land_applied:0,latitude:46.368668,longitude:-120.284227},{facility_name:"RENN ROAD MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:163,amount_of_biosolids_managed_land_applied:0,latitude:29.67755,longitude:-95.63417},{facility_name:"NORTH BEND STP",city:"North Bend",state:"Wash.",amount_of_biosolids_generated:163,amount_of_biosolids_managed_land_applied:0,latitude:47.499118,longitude:-121.78581},{facility_name:"LYNN BAYOU WWTF",city:"Port Lavaca",state:"Texas",amount_of_biosolids_generated:163,amount_of_biosolids_managed_land_applied:0,latitude:28.624917,longitude:-96.629389},{facility_name:"CITY OF PERRYVILLE",city:"Perryville",state:"Mo.",amount_of_biosolids_generated:163,amount_of_biosolids_managed_land_applied:163,latitude:37.72742,longitude:-89.86481},{facility_name:"CRAWFORD CREEK WPCP",city:"Grovetown",state:"Ga.",amount_of_biosolids_generated:163,amount_of_biosolids_managed_land_applied:162.84,latitude:33.51,longitude:-82.163556},{facility_name:"KLEINWOOD CENTRAL WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:163,amount_of_biosolids_managed_land_applied:103.795,latitude:30.00338,longitude:-95.524308},{facility_name:"CITY OF KINGSVILLE 1 MGD WWTF",city:"Kingsville",state:"Texas",amount_of_biosolids_generated:162,amount_of_biosolids_managed_land_applied:0,latitude:27.467222,longitude:-97.83},{facility_name:"REID ROAD MUD 1 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:162,amount_of_biosolids_managed_land_applied:162.2,latitude:29.924701,longitude:-95.569269},{facility_name:"NEW PRAGUE",city:"New Prague",state:"Minn.",amount_of_biosolids_generated:162,amount_of_biosolids_managed_land_applied:162,latitude:44.5597,longitude:-93.566995},{facility_name:"PROSSER POTW",city:"Prosser",state:"Wash.",amount_of_biosolids_generated:162,amount_of_biosolids_managed_land_applied:0,latitude:46.213995,longitude:-119.763422},{facility_name:"WILLOWBROOK WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:162,amount_of_biosolids_managed_land_applied:0,latitude:29.954389,longitude:-95.531861},{facility_name:"NEW CANEY MUD WWTP",city:"New Caney",state:"Texas",amount_of_biosolids_generated:162,amount_of_biosolids_managed_land_applied:0,latitude:30.138306,longitude:-95.2035},{facility_name:"CLE ELUM POTW",city:"Cle Elum",state:"Wash.",amount_of_biosolids_generated:162,amount_of_biosolids_managed_land_applied:0,latitude:47.187707,longitude:-120.91027},{facility_name:"MOORESTOWN TOWNSHIP STP",city:"Moorestown",state:"Neb.",amount_of_biosolids_generated:161,amount_of_biosolids_managed_land_applied:161.13,latitude:39.96224,longitude:-74.98782},{facility_name:"MOUNTAIN HOME, CITY OF",city:"Mountain Home",state:"Alaska",amount_of_biosolids_generated:161,amount_of_biosolids_managed_land_applied:0,latitude:36.300634,longitude:-92.381545},{facility_name:"BROOKSVILLE CITY OF COBB ROAD WWTF",city:"Brooksville",state:"Fla.",amount_of_biosolids_generated:160,amount_of_biosolids_managed_land_applied:160,latitude:28.5621,longitude:-82.42081},{facility_name:"TOWN OF MAGGIE VALLEY",city:"Maggie Valley",state:"Mont.",amount_of_biosolids_generated:160,amount_of_biosolids_managed_land_applied:160,latitude:35.51781,longitude:-83.09481},{facility_name:"DUNLAP WWTF",city:"Seguin",state:"Texas",amount_of_biosolids_generated:160,amount_of_biosolids_managed_land_applied:156,latitude:29.662444,longitude:-98.071667},{facility_name:"LAKE CHARLES, CITY OF- STP",city:"Lake Charles",state:"La.",amount_of_biosolids_generated:160,amount_of_biosolids_managed_land_applied:0,latitude:30.125209,longitude:-93.289598},{facility_name:"NORTHWEST HARRIS COUNTY MUD 32 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:159,amount_of_biosolids_managed_land_applied:0,latitude:30.063288,longitude:-95.516575},{facility_name:"CITY OF CHARLES CITY",city:"Charles City",state:"Hawaii",amount_of_biosolids_generated:159,amount_of_biosolids_managed_land_applied:0,latitude:43.068636,longitude:-92.674704},{facility_name:"CITY OF SHENANDOAH WWTP",city:"Shenandoah",state:"Texas",amount_of_biosolids_generated:159,amount_of_biosolids_managed_land_applied:0,latitude:30.189821,longitude:-95.449386},{facility_name:"CITY OF PAMPA WWTP",city:"Pampa",state:"Texas",amount_of_biosolids_generated:158,amount_of_biosolids_managed_land_applied:0,latitude:35.572856,longitude:-100.929587},{facility_name:"MONTEVIDEO",city:"Montevideo",state:"Minn.",amount_of_biosolids_generated:158,amount_of_biosolids_managed_land_applied:158.19,latitude:44.95171,longitude:-95.72034},{facility_name:"UNIVERSITY OF CONNECTICUT",city:"Storrs",state:"Conn.",amount_of_biosolids_generated:158,amount_of_biosolids_managed_land_applied:0,latitude:41.809771,longitude:-72.261402},{facility_name:"LAKE GEORGE (V)",city:"Lake George",state:"N.D.",amount_of_biosolids_generated:157,amount_of_biosolids_managed_land_applied:0,latitude:43.4309,longitude:-73.716206},{facility_name:"FRISCO SANITATION DISTRICT",city:"Frisco",state:"Colo.",amount_of_biosolids_generated:156,amount_of_biosolids_managed_land_applied:156.17,latitude:39.5785896,longitude:-106.0911179},{facility_name:"HAMPSHIRE STP, VILLAGE OF",city:"Hampshire",state:"Iowa",amount_of_biosolids_generated:156,amount_of_biosolids_managed_land_applied:156.12,latitude:42.09973,longitude:-88.53505},{facility_name:"BEARDSTOWN SD STP",city:"Beardstown",state:"Iowa",amount_of_biosolids_generated:156,amount_of_biosolids_managed_land_applied:155.08,latitude:40.010673,longitude:-90.440743},{facility_name:"ROBSON RANCH WWTP",city:"Denton",state:"Texas",amount_of_biosolids_generated:156,amount_of_biosolids_managed_land_applied:156,latitude:33.145389,longitude:-97.265278},{facility_name:"DANVILLE MUN AUTH",city:"Danville",state:"Pa.",amount_of_biosolids_generated:156,amount_of_biosolids_managed_land_applied:156,latitude:40.962003,longitude:-76.617717},{facility_name:"EAST DUNDEE WWTP, VILLAGE OF",city:"East Dundee",state:"Iowa",amount_of_biosolids_generated:156,amount_of_biosolids_managed_land_applied:155.9,latitude:42.08983,longitude:-88.27323},{facility_name:"PEASE DEVELOPMENT AUTHORITY",city:"Portstmouth",state:"Neb.",amount_of_biosolids_generated:156,amount_of_biosolids_managed_land_applied:0,latitude:43.04657,longitude:-70.77497},{facility_name:"GOWANDA (V)",city:"Gowanda",state:"N.D.",amount_of_biosolids_generated:156,amount_of_biosolids_managed_land_applied:0,latitude:42.46403,longitude:-78.93386},{facility_name:"FORT SCOTT, CITY OF",city:"Fort Scott",state:"Kan.",amount_of_biosolids_generated:155,amount_of_biosolids_managed_land_applied:155,latitude:37.81329033,longitude:-94.71931341},{facility_name:"TWA-LAKE MARION",city:"Kissimmee",state:"Fla.",amount_of_biosolids_generated:155,amount_of_biosolids_managed_land_applied:0,latitude:28.062977,longitude:-81.50783},{facility_name:"PETERS TWP. WASHINGTON COUNTY",city:"Mcmurry",state:"Pa.",amount_of_biosolids_generated:155,amount_of_biosolids_managed_land_applied:0,latitude:40.289916,longitude:-80.11101},{facility_name:"HUTTO WWTP",city:"Hutto",state:"Texas",amount_of_biosolids_generated:154,amount_of_biosolids_managed_land_applied:0,latitude:30.54025,longitude:-97.539583},{facility_name:"CENTRAL IRON RANGE SANITARY SEWER DISTRICT WWTP",city:"Chisholm",state:"Minn.",amount_of_biosolids_generated:154,amount_of_biosolids_managed_land_applied:0,latitude:47.4915,longitude:-92.88536},{facility_name:"HARRIS COUNTY MUD 284 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:154,amount_of_biosolids_managed_land_applied:0,latitude:29.841174,longitude:-95.713347},{facility_name:"AIRPORT WWTF",city:"Galveston",state:"Texas",amount_of_biosolids_generated:154,amount_of_biosolids_managed_land_applied:0,latitude:29.270882,longitude:-94.848428},{facility_name:"WARE W W T P",city:"Ware",state:"Mass.",amount_of_biosolids_generated:154,amount_of_biosolids_managed_land_applied:0,latitude:42.250375,longitude:-72.250118},{facility_name:"CITY OF MAGNOLIA WWTP",city:"Magnolia",state:"Texas",amount_of_biosolids_generated:153,amount_of_biosolids_managed_land_applied:0,latitude:30.190472,longitude:-95.752444},{facility_name:"CITY OF DONNA WWTP",city:"Donna",state:"Texas",amount_of_biosolids_generated:153,amount_of_biosolids_managed_land_applied:153,latitude:26.148333,longitude:-98.053333},{facility_name:"CITY OF ELKINS, WWTP",city:"Elkins",state:"Wis.",amount_of_biosolids_generated:153,amount_of_biosolids_managed_land_applied:153,latitude:38.92697,longitude:-79.84945},{facility_name:"WILD HORSE RANCH WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:153,amount_of_biosolids_managed_land_applied:0,latitude:30.316,longitude:-97.569667},{facility_name:"TOWN OF SURF CITY",city:"Surf City",state:"Mont.",amount_of_biosolids_generated:153,amount_of_biosolids_managed_land_applied:152.8,latitude:34.48035,longitude:-77.55286},{facility_name:"ROCK FALLS, CITY OF",city:"Rock Falls",state:"Iowa",amount_of_biosolids_generated:153,amount_of_biosolids_managed_land_applied:0,latitude:41.780333,longitude:-89.706139},{facility_name:"GRANVILLE (V)",city:"Granville",state:"N.D.",amount_of_biosolids_generated:152,amount_of_biosolids_managed_land_applied:29.78,latitude:43.40214,longitude:-73.2658},{facility_name:"HARRIS COUNTY MUD 170 REGIONAL WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:152,amount_of_biosolids_managed_land_applied:152.38,latitude:29.917694,longitude:-95.587111},{facility_name:"A & M HEEP WWTP",city:"Dallas",state:"Texas",amount_of_biosolids_generated:152,amount_of_biosolids_managed_land_applied:0,latitude:30.082194,longitude:-97.796667},{facility_name:"MCPHERSON, CITY OF",city:"Mcpherson",state:"Kan.",amount_of_biosolids_generated:152,amount_of_biosolids_managed_land_applied:152,latitude:38.37354408,longitude:-97.65516622},{facility_name:"KIMBALL WWTF",city:"Kimball",state:"Neb.",amount_of_biosolids_generated:152,amount_of_biosolids_managed_land_applied:0,latitude:41.23624,longitude:-103.66299},{facility_name:"INTERCONTINENTAL AIRPORT WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:152,amount_of_biosolids_managed_land_applied:0,latitude:29.962417,longitude:-95.357139},{facility_name:"ANNANDALE/MAPLE LAKE",city:"Unknown",state:"Minn.",amount_of_biosolids_generated:152,amount_of_biosolids_managed_land_applied:151.9,latitude:46.3161343,longitude:-94.1994801},{facility_name:"NAZARETH BOROUGH MUNICIPAL AUT",city:"Nazareth",state:"Pa.",amount_of_biosolids_generated:152,amount_of_biosolids_managed_land_applied:151.8,latitude:40.75665368,longitude:-75.328109},{facility_name:"MECHANICSBURG BOROUGH MUNICIPA",city:"Mechanicsburg",state:"Pa.",amount_of_biosolids_generated:152,amount_of_biosolids_managed_land_applied:151.6,latitude:40.211224,longitude:-77.025962},{facility_name:"HARRIS COUNTY MUD 278 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:151,amount_of_biosolids_managed_land_applied:0,latitude:29.962,longitude:-95.249806},{facility_name:"DECKER HILLS WWTP",city:"Granbury",state:"Texas",amount_of_biosolids_generated:151,amount_of_biosolids_managed_land_applied:0,latitude:30.172806,longitude:-95.635556},{facility_name:"TROPHY CLUB MUD 1",city:"Trophy Club",state:"Texas",amount_of_biosolids_generated:151,amount_of_biosolids_managed_land_applied:0,latitude:32.99714,longitude:-97.18692},{facility_name:"METRO CENTRAL WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:151,amount_of_biosolids_managed_land_applied:0,latitude:29.590377,longitude:-95.156091},{facility_name:"CITY OF ELSA WWTP",city:"Elsa",state:"Texas",amount_of_biosolids_generated:151,amount_of_biosolids_managed_land_applied:151.03,latitude:26.304056,longitude:-97.999889},{facility_name:"CITY OF THOMSON",city:"Thomson",state:"Ga.",amount_of_biosolids_generated:151,amount_of_biosolids_managed_land_applied:151,latitude:33.452824,longitude:-82.506639},{facility_name:"SHEFFIELD UTILITIES",city:"Sheffield",state:"Alaska",amount_of_biosolids_generated:151,amount_of_biosolids_managed_land_applied:151,latitude:34.7583,longitude:-87.7176},{facility_name:"WATERFORD (T)",city:"Waterford",state:"N.D.",amount_of_biosolids_generated:151,amount_of_biosolids_managed_land_applied:128.51,latitude:42.79026,longitude:-73.67861},{facility_name:"CITY OF OSCEOLA",city:"Osceola",state:"Hawaii",amount_of_biosolids_generated:151,amount_of_biosolids_managed_land_applied:150.75,latitude:41.01811656,longitude:-93.77917876},{facility_name:"WILBARGER CREEK WWTP",city:"Manor",state:"Texas",amount_of_biosolids_generated:151,amount_of_biosolids_managed_land_applied:0,latitude:30.34937,longitude:-97.54003},{facility_name:"NORTHAMPTON MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:151,amount_of_biosolids_managed_land_applied:0,latitude:30.114917,longitude:-95.511028},{facility_name:"BISSONETT MUD",city:"Houston",state:"Texas",amount_of_biosolids_generated:151,amount_of_biosolids_managed_land_applied:0,latitude:29.680574,longitude:-95.61121},{facility_name:"WOODSVILLE W W T F",city:"Woodsville",state:"Neb.",amount_of_biosolids_generated:150,amount_of_biosolids_managed_land_applied:0,latitude:44.14646,longitude:-72.03642},{facility_name:"POLLARD CREEK WWTP",city:"Mineral Wells",state:"Texas",amount_of_biosolids_generated:150,amount_of_biosolids_managed_land_applied:0,latitude:32.78771,longitude:-98.13299},{facility_name:"VALLEY RANCH WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:150,amount_of_biosolids_managed_land_applied:0,latitude:30.126593,longitude:-95.245382},{facility_name:"PRASA HUMACAO WWTP",city:"Bo. Rio Abajo",state:"Pa.",amount_of_biosolids_generated:149,amount_of_biosolids_managed_land_applied:0,latitude:18.217648,longitude:-66.4107992},{facility_name:"GREENBRIER COUNTY PSD NO. 2",city:"Rainelle",state:"Wis.",amount_of_biosolids_generated:149,amount_of_biosolids_managed_land_applied:164.6,latitude:37.976817,longitude:-80.760912},{facility_name:"WYOMISSING VALLEY JOINT MUN AU",city:"Berks County",state:"Pa.",amount_of_biosolids_generated:149,amount_of_biosolids_managed_land_applied:149.25,latitude:40.32706,longitude:-75.94319},{facility_name:"BATESVILLE WWTP, CITY OF",city:"Batesville",state:"Iowa",amount_of_biosolids_generated:149,amount_of_biosolids_managed_land_applied:148.8,latitude:39.2972,longitude:-85.22346},{facility_name:"BAYOU LA BATRE UTILITY BOARD",city:"Bayou La Batre",state:"Alaska",amount_of_biosolids_generated:149,amount_of_biosolids_managed_land_applied:148.74,latitude:30.384945,longitude:-88.253264},{facility_name:"LAKE CITY",city:"Lake City",state:"Minn.",amount_of_biosolids_generated:149,amount_of_biosolids_managed_land_applied:0,latitude:44.43794,longitude:-92.26285},{facility_name:"RED BLUFF WWRP",city:"Red Bluff",state:"Calif.",amount_of_biosolids_generated:149,amount_of_biosolids_managed_land_applied:0,latitude:40.18078782,longitude:-122.2370883},{facility_name:"FORT BEND COUNTY MUD 30 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:148,amount_of_biosolids_managed_land_applied:0,latitude:29.689389,longitude:-95.679667},{facility_name:"CLEAR LAKE SANITARY DISTRICT",city:"Clear Lake",state:"Hawaii",amount_of_biosolids_generated:148,amount_of_biosolids_managed_land_applied:148,latitude:43.1025,longitude:-93.4075},{facility_name:"DANSVILLE (V)",city:"Dansville",state:"N.D.",amount_of_biosolids_generated:148,amount_of_biosolids_managed_land_applied:148,latitude:42.55924,longitude:-77.69544},{facility_name:"BERRYVILLE, CITY OF",city:"Berryville",state:"Alaska",amount_of_biosolids_generated:148,amount_of_biosolids_managed_land_applied:0,latitude:36.357222,longitude:-93.578889},{facility_name:"REMINGTON MUD 1 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:148,amount_of_biosolids_managed_land_applied:0,latitude:29.91801,longitude:-95.6685},{facility_name:"ROTTERDAM (T)",city:"Schenectady",state:"N.D.",amount_of_biosolids_generated:148,amount_of_biosolids_managed_land_applied:0,latitude:42.78615,longitude:-73.97401},{facility_name:"PLUM GROVE WWTP",city:"New Waverly",state:"Texas",amount_of_biosolids_generated:148,amount_of_biosolids_managed_land_applied:0,latitude:30.18716,longitude:-95.08018},{facility_name:"LEAD-DEADWOOD SANITARY DISTRICT",city:"Deadwood",state:"S.D.",amount_of_biosolids_generated:147,amount_of_biosolids_managed_land_applied:147.1,latitude:44.38649,longitude:-103.71246},{facility_name:"WINOOSKI SEWAGE TREATMENT PLANT",city:"Winooski",state:"Va.",amount_of_biosolids_generated:145,amount_of_biosolids_managed_land_applied:145.49,latitude:44.490788,longitude:-73.197733},{facility_name:"ADAMS W W T P",city:"Adams",state:"Mass.",amount_of_biosolids_generated:145,amount_of_biosolids_managed_land_applied:0,latitude:42.644677,longitude:-73.108628},{facility_name:"CITY OF WALLER WWTP",city:"Waller",state:"Texas",amount_of_biosolids_generated:145,amount_of_biosolids_managed_land_applied:145.34,latitude:30.0485,longitude:-95.924028},{facility_name:"CITY OF WEST UNIVERSITY PLACE WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:145,amount_of_biosolids_managed_land_applied:0,latitude:29.696699,longitude:-95.420278},{facility_name:"CITY OF CUBA",city:"Cuba",state:"Mo.",amount_of_biosolids_generated:145,amount_of_biosolids_managed_land_applied:144.5,latitude:38.062688,longitude:-91.407422},{facility_name:"ONTARIO (T)",city:"Ontario",state:"N.D.",amount_of_biosolids_generated:145,amount_of_biosolids_managed_land_applied:0,latitude:43.27589,longitude:-77.27657},{facility_name:"POTSDAM (V)",city:"Potsdam",state:"N.D.",amount_of_biosolids_generated:144,amount_of_biosolids_managed_land_applied:144.45,latitude:44.63675425,longitude:-74.8666111},{facility_name:"MANTENO WPCC, VILLAGE OF",city:"Manteno",state:"Iowa",amount_of_biosolids_generated:144,amount_of_biosolids_managed_land_applied:167.88,latitude:41.2417,longitude:-87.8383},{facility_name:"STONINGTON-PAWCATUCK WPCF",city:"Pawcatuck",state:"Conn.",amount_of_biosolids_generated:144,amount_of_biosolids_managed_land_applied:0,latitude:41.351929,longitude:-71.835051},{facility_name:"JEFFERSON CITY OF STP",city:"Jefferson",state:"Hawaii",amount_of_biosolids_generated:144,amount_of_biosolids_managed_land_applied:143.8,latitude:42.00807,longitude:-94.381052},{facility_name:"CITY OF TROY",city:"Troy",state:"Mo.",amount_of_biosolids_generated:144,amount_of_biosolids_managed_land_applied:122,latitude:38.97889,longitude:-90.97062},{facility_name:"CITY OF TROY",city:"Troy",state:"Mo.",amount_of_biosolids_generated:144,amount_of_biosolids_managed_land_applied:122,latitude:38.97889,longitude:-90.97062},{facility_name:"ORANGE COUNTY WWTF",city:"Vidor",state:"Texas",amount_of_biosolids_generated:143,amount_of_biosolids_managed_land_applied:0,latitude:30.130472,longitude:-94.031278},{facility_name:"MEADOWHILL REGIONAL MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:143,amount_of_biosolids_managed_land_applied:143.23,latitude:30.071361,longitude:-95.471722},{facility_name:"ABBEVILLE, CITY OF",city:"Abbeville",state:"La.",amount_of_biosolids_generated:143,amount_of_biosolids_managed_land_applied:143,latitude:29.969882,longitude:-92.117076},{facility_name:"CORTEZ SANITATION DISTRICT",city:"Cortez",state:"Colo.",amount_of_biosolids_generated:143,amount_of_biosolids_managed_land_applied:0,latitude:37.3497833,longitude:-108.576687},{facility_name:"NORTH BROOKFIELD W W T P",city:"North Brookfield",state:"Mass.",amount_of_biosolids_generated:143,amount_of_biosolids_managed_land_applied:0,latitude:42.248876,longitude:-72.074475},{facility_name:"JERSEYVILLE STP, CITY OF",city:"Jerseyville",state:"Iowa",amount_of_biosolids_generated:143,amount_of_biosolids_managed_land_applied:0,latitude:39.10857,longitude:-90.34163},{facility_name:"DELRAN TWP SEWER UTILITY",city:"Delran",state:"Neb.",amount_of_biosolids_generated:142,amount_of_biosolids_managed_land_applied:142.13,latitude:40.02518978,longitude:-74.94635171},{facility_name:"WICHITA FALLS NORTHSIDE WWTP",city:"Wichita Falls",state:"Texas",amount_of_biosolids_generated:142,amount_of_biosolids_managed_land_applied:0,latitude:33.995583,longitude:-98.517222},{facility_name:"WINCHESTER WPCF/WINSTED WPCF",city:"Winchester",state:"Conn.",amount_of_biosolids_generated:142,amount_of_biosolids_managed_land_applied:0,latitude:41.97774315,longitude:-73.02317},{facility_name:"SEASIDE, CITY OF",city:"Seaside",state:"Ore.",amount_of_biosolids_generated:142,amount_of_biosolids_managed_land_applied:10,latitude:46.005499,longitude:-123.923263},{facility_name:"PERRY / WILLARD REGIONAL WASTEWATER TREATMENT PLANT",city:"Willard",state:"Utah",amount_of_biosolids_generated:142,amount_of_biosolids_managed_land_applied:0,latitude:41.426667,longitude:-112.061944},{facility_name:"CITY OF DECORAH",city:"Decorah",state:"Hawaii",amount_of_biosolids_generated:141,amount_of_biosolids_managed_land_applied:141.32,latitude:43.40697547,longitude:-91.59050166},{facility_name:"PINE TRAILS WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:141,amount_of_biosolids_managed_land_applied:0,latitude:29.812389,longitude:-95.202556},{facility_name:"CITY OF ADAIRSVILLE (NORTH WPCP)",city:"Adairsville",state:"Ga.",amount_of_biosolids_generated:141,amount_of_biosolids_managed_land_applied:113.08,latitude:34.373874,longitude:-84.942255},{facility_name:"SUNNYSIDE POTW",city:"Sunnyside",state:"Wash.",amount_of_biosolids_generated:141,amount_of_biosolids_managed_land_applied:0,latitude:46.313889,longitude:-120.0175},{facility_name:"TICONDEROGA (T)",city:"Ticonderoga",state:"N.D.",amount_of_biosolids_generated:141,amount_of_biosolids_managed_land_applied:140.82,latitude:43.84873,longitude:-73.42225},{facility_name:"CITY OF COTULLA WWTP",city:"Cotulla",state:"Texas",amount_of_biosolids_generated:139,amount_of_biosolids_managed_land_applied:0,latitude:28.427361,longitude:-99.220056},{facility_name:"COLUMBIA CITY WWTP",city:"Columbia City",state:"Iowa",amount_of_biosolids_generated:139,amount_of_biosolids_managed_land_applied:0,latitude:41.144889,longitude:-85.490194},{facility_name:"GRAND LAKES REGIONAL WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:139,amount_of_biosolids_managed_land_applied:0,latitude:29.711611,longitude:-95.748833},{facility_name:"CREEDSIDE RANCH WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:138,amount_of_biosolids_managed_land_applied:44.2204736,latitude:29.676944,longitude:-95.829444},{facility_name:"WILMINGTON STP, CITY OF",city:"Wilmington",state:"Iowa",amount_of_biosolids_generated:138,amount_of_biosolids_managed_land_applied:0,latitude:41.32001,longitude:-88.14218},{facility_name:"GLENCOE",city:"Glencoe",state:"Minn.",amount_of_biosolids_generated:138,amount_of_biosolids_managed_land_applied:137.8,latitude:44.76571,longitude:-94.13426},{facility_name:"CITY OF GRAHAM",city:"Graham",state:"Mont.",amount_of_biosolids_generated:138,amount_of_biosolids_managed_land_applied:137.792,latitude:36.049554,longitude:-79.372942},{facility_name:"BURKBURNETT WWTF",city:"Burkburnett",state:"Texas",amount_of_biosolids_generated:138,amount_of_biosolids_managed_land_applied:0,latitude:34.100676,longitude:-98.562758},{facility_name:"THOMASTON WPCF",city:"Thomaston",state:"Conn.",amount_of_biosolids_generated:137,amount_of_biosolids_managed_land_applied:0,latitude:41.646386,longitude:-73.078758},{facility_name:"DALLAS, CITY OF",city:"Dallas",state:"Ore.",amount_of_biosolids_generated:137,amount_of_biosolids_managed_land_applied:0,latitude:44.918831,longitude:-123.254843},{facility_name:"CORNING WWTF",city:"Corning",state:"Calif.",amount_of_biosolids_generated:137,amount_of_biosolids_managed_land_applied:0,latitude:39.91513459,longitude:-122.160075},{facility_name:"CITY OF OSKALOOSA",city:"Oskaloosa",state:"Hawaii",amount_of_biosolids_generated:136,amount_of_biosolids_managed_land_applied:136.05,latitude:41.29381,longitude:-92.64506},{facility_name:"TOWN OF ORANGE PARK",city:"Orange Park",state:"Fla.",amount_of_biosolids_generated:136,amount_of_biosolids_managed_land_applied:135.97,latitude:30.18283,longitude:-81.70874},{facility_name:"DESSAU WWTF",city:"Austin",state:"Texas",amount_of_biosolids_generated:136,amount_of_biosolids_managed_land_applied:0,latitude:30.40637,longitude:-97.64126},{facility_name:"CORNING (C)",city:"Corning",state:"N.D.",amount_of_biosolids_generated:135,amount_of_biosolids_managed_land_applied:0,latitude:42.14234,longitude:-77.04642},{facility_name:"CITY OF OELWEIN",city:"Oelwein",state:"Hawaii",amount_of_biosolids_generated:135,amount_of_biosolids_managed_land_applied:288,latitude:42.691087,longitude:-91.93311704},{facility_name:"RIFLE REGIONAL WW RECLAMATION FACILITY",city:"Rifle",state:"Colo.",amount_of_biosolids_generated:135,amount_of_biosolids_managed_land_applied:0,latitude:39.55519594,longitude:-107.7715774},{facility_name:"HUNTER'S GLEN MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:135,amount_of_biosolids_managed_land_applied:134.53,latitude:29.81271,longitude:-95.20992},{facility_name:"PETERBOROUGH TOWN OF",city:"Peterborough",state:"Neb.",amount_of_biosolids_generated:134,amount_of_biosolids_managed_land_applied:0,latitude:42.909213,longitude:-71.933895},{facility_name:"VALLEY JOINT SEW AUTH",city:"Athens",state:"Pa.",amount_of_biosolids_generated:134,amount_of_biosolids_managed_land_applied:0,latitude:41.96623,longitude:-76.51659},{facility_name:"HARRIS COUNTY WCID 119 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:134,amount_of_biosolids_managed_land_applied:133.852313,latitude:30.025456,longitude:-95.553943},{facility_name:"KINGWOOD WEST WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:134,amount_of_biosolids_managed_land_applied:0,latitude:29.967114,longitude:-95.169899},{facility_name:"PLAQUEMINES PAR (BELLE CHAS",city:"Belle Chasse",state:"La.",amount_of_biosolids_generated:134,amount_of_biosolids_managed_land_applied:0,latitude:29.80456,longitude:-90.01405},{facility_name:"HARBOR POINT WWTP",city:"Pflugerville",state:"Texas",amount_of_biosolids_generated:133,amount_of_biosolids_managed_land_applied:0,latitude:30.915763,longitude:-95.254125},{facility_name:"YADKIN VALLEY SEWER AUTHORITY INC",city:"Elkin",state:"Mont.",amount_of_biosolids_generated:133,amount_of_biosolids_managed_land_applied:133.27,latitude:36.256801,longitude:-80.832757},{facility_name:"CHARLESTON STP, CITY OF",city:"Charleston",state:"Iowa",amount_of_biosolids_generated:133,amount_of_biosolids_managed_land_applied:179.09,latitude:39.496692,longitude:-88.190829},{facility_name:"FT BEND COUNTY MUD 151 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:133,amount_of_biosolids_managed_land_applied:0,latitude:29.761639,longitude:-95.86525},{facility_name:"WENATCHEE POTW",city:"Wenatchee",state:"Wash.",amount_of_biosolids_generated:133,amount_of_biosolids_managed_land_applied:132.9,latitude:47.428515,longitude:-120.310029},{facility_name:"CITY OF WETUMPKA WW AND S BOARD",city:"Wetumpka",state:"Alaska",amount_of_biosolids_generated:133,amount_of_biosolids_managed_land_applied:132.74,latitude:32.5227,longitude:-86.2209},{facility_name:"WELLSBORO MUN AUTH",city:"Wellsboro",state:"Pa.",amount_of_biosolids_generated:133,amount_of_biosolids_managed_land_applied:0,latitude:41.74724,longitude:-77.30003},{facility_name:"HARRIS CO MUD 358",city:"Houston",state:"Texas",amount_of_biosolids_generated:132,amount_of_biosolids_managed_land_applied:132.11,latitude:29.985778,longitude:-95.726611},{facility_name:"MIDDLETOWN WASTEWATER TREATMEN",city:"Dauphin County",state:"Pa.",amount_of_biosolids_generated:132,amount_of_biosolids_managed_land_applied:129.48,latitude:40.191291,longitude:-76.738591},{facility_name:"BANNING WWTP",city:"Banning",state:"Calif.",amount_of_biosolids_generated:132,amount_of_biosolids_managed_land_applied:0,latitude:33.917514,longitude:-116.843677},{facility_name:"BUENA VISTA SANITATION DISTRICT",city:"Buena Vista",state:"Colo.",amount_of_biosolids_generated:132,amount_of_biosolids_managed_land_applied:0,latitude:38.84897898,longitude:-106.1795175},{facility_name:"CITY OF TUSCUMBIA DEPARTMENT OF UTILITIES",city:"Tuscumbia",state:"Alaska",amount_of_biosolids_generated:132,amount_of_biosolids_managed_land_applied:131.7,latitude:34.7317,longitude:-87.7136},{facility_name:"WALKER COUNTY WATER & SEWERAGE AUTHORITY",city:"Chickamauga",state:"Ga.",amount_of_biosolids_generated:132,amount_of_biosolids_managed_land_applied:0,latitude:34.876511,longitude:-85.276336},{facility_name:"ERIE CO SD#8",city:"Buffalo",state:"N.D.",amount_of_biosolids_generated:132,amount_of_biosolids_managed_land_applied:0,latitude:42.88376,longitude:-78.87736},{facility_name:"CITY OF GRINNELL",city:"Grinnell",state:"Hawaii",amount_of_biosolids_generated:131,amount_of_biosolids_managed_land_applied:131.42,latitude:41.73738,longitude:-92.723202},{facility_name:"CITY OF CHILLICOTHE",city:"Chillicothe",state:"Mo.",amount_of_biosolids_generated:131,amount_of_biosolids_managed_land_applied:131.1,latitude:39.796249,longitude:-93.553698},{facility_name:"BLOOMFIELD, CITY OF",city:"Bloomfield",state:"N.D.",amount_of_biosolids_generated:131,amount_of_biosolids_managed_land_applied:0,latitude:36.70075,longitude:-107.992414},{facility_name:"TRENTON MUNICIPAL UTILITIES",city:"Trenton",state:"Mo.",amount_of_biosolids_generated:131,amount_of_biosolids_managed_land_applied:0,latitude:40.07551,longitude:-93.60062},{facility_name:"VILLAGE OF BOLINGBROOK STP #3",city:"Bolingbrook",state:"Iowa",amount_of_biosolids_generated:130,amount_of_biosolids_managed_land_applied:130,latitude:41.702363,longitude:-88.076058},{facility_name:"CITY OF MARION",city:"Marion",state:"Mont.",amount_of_biosolids_generated:130,amount_of_biosolids_managed_land_applied:129.79,latitude:35.652445,longitude:-81.95739},{facility_name:"CITY OF FULSHEAR WWTP",city:"Fulshear",state:"Texas",amount_of_biosolids_generated:129,amount_of_biosolids_managed_land_applied:0,latitude:29.68775,longitude:-95.905917},{facility_name:"FOUNTAIN SANITATION DISTRICT",city:"Fountain",state:"Colo.",amount_of_biosolids_generated:129,amount_of_biosolids_managed_land_applied:0,latitude:38.667223,longitude:-104.703165},{facility_name:"JOHN HARGROVE WATER RECLAMATION FACILITY",city:"Pearland",state:"Texas",amount_of_biosolids_generated:129,amount_of_biosolids_managed_land_applied:0,latitude:29.546333,longitude:-95.312972},{facility_name:"JOHNSON CITY MUNICIPAL WWTP",city:"Johnson City",state:"Texas",amount_of_biosolids_generated:129,amount_of_biosolids_managed_land_applied:128.99,latitude:30.285917,longitude:-98.402111},{facility_name:"CITY OF HITCHCOCK - WWTP",city:"Hitchcock",state:"Texas",amount_of_biosolids_generated:129,amount_of_biosolids_managed_land_applied:0,latitude:29.333,longitude:-95.02075},{facility_name:"BRAZORIA COUNTY MUD 21 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:129,amount_of_biosolids_managed_land_applied:0,latitude:29.496611,longitude:-95.431861},{facility_name:"CITY OF LOCKHART WWTF 1",city:"Lockhart",state:"Texas",amount_of_biosolids_generated:128,amount_of_biosolids_managed_land_applied:0,latitude:29.82748,longitude:-95.21676},{facility_name:"THOMPSONS CREEK WWTP",city:"Bryan",state:"Texas",amount_of_biosolids_generated:128,amount_of_biosolids_managed_land_applied:0,latitude:30.588645,longitude:-96.423465},{facility_name:"AUSTIN COLONY WWTP",city:"Sugar Land",state:"Texas",amount_of_biosolids_generated:128,amount_of_biosolids_managed_land_applied:0,latitude:30.22906,longitude:-97.59172},{facility_name:"FRASER TOWN OF",city:"Fraser",state:"Colo.",amount_of_biosolids_generated:127,amount_of_biosolids_managed_land_applied:0,latitude:39.94916056,longitude:-105.8171175},{facility_name:"TOWN OF SPRINGFIELD",city:"Springfield",state:"Va.",amount_of_biosolids_generated:127,amount_of_biosolids_managed_land_applied:126.85,latitude:43.29622,longitude:-72.48115},{facility_name:"CINCO SOUTHWEST WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:127,amount_of_biosolids_managed_land_applied:126.84,latitude:29.705139,longitude:-95.811306},{facility_name:"CLUTE-RICHWOOD WWTP",city:"Clute",state:"Texas",amount_of_biosolids_generated:127,amount_of_biosolids_managed_land_applied:0,latitude:29.015528,longitude:-95.390667},{facility_name:"WINSTON GREEN REGIONAL",city:"Roseburg",state:"Ore.",amount_of_biosolids_generated:126,amount_of_biosolids_managed_land_applied:126.44,latitude:43.137183,longitude:-123.401796},{facility_name:"PEMBROKE PINES, CITY OF WWTP",city:"Pembroke Pines",state:"Fla.",amount_of_biosolids_generated:126,amount_of_biosolids_managed_land_applied:277.22,latitude:25.9975,longitude:-80.252179},{facility_name:"FOX RIVER GROVE STP",city:"Fox River Grove",state:"Iowa",amount_of_biosolids_generated:126,amount_of_biosolids_managed_land_applied:77.9,latitude:42.191555,longitude:-88.233819},{facility_name:"CITY OF WHITE OAK WWTF",city:"White Oak",state:"Texas",amount_of_biosolids_generated:126,amount_of_biosolids_managed_land_applied:0,latitude:32.507388,longitude:-94.848006},{facility_name:"LAKE CHARLES, CITY OF (PLANT A",city:"Lake Charles",state:"La.",amount_of_biosolids_generated:126,amount_of_biosolids_managed_land_applied:0,latitude:30.23864,longitude:-93.21726},{facility_name:"HOLIDAY PARK STP",city:"Pittsburgh",state:"Pa.",amount_of_biosolids_generated:126,amount_of_biosolids_managed_land_applied:0,latitude:40.497595,longitude:-79.754224},{facility_name:"OLD EGYPT WWTF",city:"Austin",state:"Texas",amount_of_biosolids_generated:125,amount_of_biosolids_managed_land_applied:0,latitude:30.214056,longitude:-95.566194},{facility_name:"NORTH BEND, CITY OF",city:"North Bend",state:"Ore.",amount_of_biosolids_generated:125,amount_of_biosolids_managed_land_applied:125.34,latitude:43.415363,longitude:-124.254255},{facility_name:"JAFFREY TOWN OF",city:"Jaffrey",state:"Neb.",amount_of_biosolids_generated:125,amount_of_biosolids_managed_land_applied:125,latitude:42.820041,longitude:-71.99306},{facility_name:"WOODSTOCK SOUTH STP, CITY OF",city:"Woodstock",state:"Iowa",amount_of_biosolids_generated:125,amount_of_biosolids_managed_land_applied:0,latitude:42.28934,longitude:-88.43811},{facility_name:"FT BEND CO MUD WWTP 2",city:"Sugar Land",state:"Texas",amount_of_biosolids_generated:125,amount_of_biosolids_managed_land_applied:0,latitude:29.634639,longitude:-95.673194},{facility_name:"MOON TWP. MUN. AUTH.",city:"Corapolis",state:"Pa.",amount_of_biosolids_generated:125,amount_of_biosolids_managed_land_applied:0,latitude:40.497081,longitude:-80.201711},{facility_name:"MONTGOMERY COUNTY MUD 8 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:125,amount_of_biosolids_managed_land_applied:0,latitude:30.391334,longitude:-95.602745},{facility_name:"CITY OF SPENCER",city:"Spencer",state:"Hawaii",amount_of_biosolids_generated:124,amount_of_biosolids_managed_land_applied:124,latitude:43.1417,longitude:-95.14757},{facility_name:"CARBONDALE UTILITIES, TOWN OF",city:"Carbondale",state:"Colo.",amount_of_biosolids_generated:124,amount_of_biosolids_managed_land_applied:0,latitude:39.401696,longitude:-107.212945},{facility_name:"SELMA WATER WORKS & SEWER BOARD",city:"Selma",state:"Alaska",amount_of_biosolids_generated:124,amount_of_biosolids_managed_land_applied:123.71,latitude:32.399186,longitude:-87.040837},{facility_name:"MYERSTOWN STP",city:"Lebanon County",state:"Pa.",amount_of_biosolids_generated:123,amount_of_biosolids_managed_land_applied:0,latitude:40.42831,longitude:-76.31588},{facility_name:"WOODMARK WWTF",city:"Tyler",state:"Texas",amount_of_biosolids_generated:123,amount_of_biosolids_managed_land_applied:0,latitude:32.20259,longitude:-95.336186},{facility_name:"CANTON WWTP",city:"Canton",state:"Texas",amount_of_biosolids_generated:123,amount_of_biosolids_managed_land_applied:0,latitude:32.583378,longitude:-95.845578},{facility_name:"HAYSVILLE, CITY OF",city:"Haysville",state:"Kan.",amount_of_biosolids_generated:123,amount_of_biosolids_managed_land_applied:0,latitude:37.5419793,longitude:-97.33023924},{facility_name:"TOHOPEKALIGA WATER AUTHORITY",city:"Kissimmee",state:"Fla.",amount_of_biosolids_generated:123,amount_of_biosolids_managed_land_applied:0,latitude:28.14357,longitude:-81.45733},{facility_name:"MAHANOY CITY MUNICIPAL AUTHORI",city:"Mahanoy City",state:"Pa.",amount_of_biosolids_generated:123,amount_of_biosolids_managed_land_applied:0,latitude:40.808421,longitude:-76.156327},{facility_name:"YREKA WWTP",city:"Yreka",state:"Calif.",amount_of_biosolids_generated:123,amount_of_biosolids_managed_land_applied:0,latitude:41.743333,longitude:-122.630944},{facility_name:"EMPORIA, CITY OF",city:"Emporia",state:"Utah",amount_of_biosolids_generated:123,amount_of_biosolids_managed_land_applied:0,latitude:36.68048,longitude:-77.54162},{facility_name:"WHITEOAK SHORES WWTF",city:"Yantis",state:"Texas",amount_of_biosolids_generated:123,amount_of_biosolids_managed_land_applied:122.55,latitude:32.905277,longitude:-95.603888},{facility_name:"QUANAH WWTF",city:"Quanah",state:"Texas",amount_of_biosolids_generated:122,amount_of_biosolids_managed_land_applied:0,latitude:34.300139,longitude:-99.726222},{facility_name:"WASECA",city:"Waseca",state:"Minn.",amount_of_biosolids_generated:122,amount_of_biosolids_managed_land_applied:122.08,latitude:44.071759,longitude:-93.547038},{facility_name:"TWO HARBORS",city:"Two Harbors",state:"Minn.",amount_of_biosolids_generated:122,amount_of_biosolids_managed_land_applied:122,latitude:47.02776464,longitude:-91.68664823},{facility_name:"CITY OF MEXICO",city:"Mexico",state:"Mo.",amount_of_biosolids_generated:122,amount_of_biosolids_managed_land_applied:122,latitude:39.17421,longitude:-91.88147},{facility_name:"CLEMSON/COCHRAN ROAD WWTP",city:"Clemson",state:"S.C.",amount_of_biosolids_generated:122,amount_of_biosolids_managed_land_applied:122,latitude:34.685,longitude:-82.833333},{facility_name:"CITY OF PINEHURST - WWTP",city:"Pinehurst",state:"Texas",amount_of_biosolids_generated:122,amount_of_biosolids_managed_land_applied:0,latitude:30.100825,longitude:-93.764657},{facility_name:"SAUSALITO-MARIN CITY SANITARY DISTRICT",city:"Sausalito",state:"Calif.",amount_of_biosolids_generated:122,amount_of_biosolids_managed_land_applied:0,latitude:37.85466951,longitude:-122.4869723},{facility_name:"CITY OF RICHMOND SWTP",city:"Richmond",state:"Texas",amount_of_biosolids_generated:122,amount_of_biosolids_managed_land_applied:123.840456,latitude:29.576975,longitude:-95.77819},{facility_name:"LANGHAM CREEK UD - WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:122,amount_of_biosolids_managed_land_applied:0,latitude:29.75253,longitude:-95.46009},{facility_name:"MYRTLE CREEK, CITY OF",city:"Myrtle Creek",state:"Ore.",amount_of_biosolids_generated:122,amount_of_biosolids_managed_land_applied:121.563,latitude:43.02108,longitude:-123.296857},{facility_name:"CITY OF PEARSALL WWTP",city:"Pearsall",state:"Texas",amount_of_biosolids_generated:122,amount_of_biosolids_managed_land_applied:0,latitude:28.883,longitude:-99.112167},{facility_name:"LAS VEGAS, CITY OF (SOUTH EAST",city:"Las Vegas",state:"N.D.",amount_of_biosolids_generated:121,amount_of_biosolids_managed_land_applied:121.46,latitude:35.5387,longitude:-105.2103},{facility_name:"HYRUM CITY CORP",city:"Hyrum",state:"Utah",amount_of_biosolids_generated:121,amount_of_biosolids_managed_land_applied:121,latitude:41.63408,longitude:-111.85656},{facility_name:"EAST TEXAS MUD OF SMITH COUNTY WWTF",city:"Tyler",state:"Texas",amount_of_biosolids_generated:121,amount_of_biosolids_managed_land_applied:0,latitude:32.43653,longitude:-95.19539},{facility_name:"IL AMERICAN WTR COMPANY-CHICKSAW HILLS WRF",city:"Lockport",state:"Iowa",amount_of_biosolids_generated:121,amount_of_biosolids_managed_land_applied:120.96,latitude:41.6375,longitude:-87.95},{facility_name:"NORTH PARK PUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:121,amount_of_biosolids_managed_land_applied:120.88,latitude:30.029961,longitude:-95.421409},{facility_name:"GEORGETOWN TOWN OF",city:"Georgetown",state:"Colo.",amount_of_biosolids_generated:121,amount_of_biosolids_managed_land_applied:0,latitude:39.7171454,longitude:-105.695521},{facility_name:"PRASA LARES WWTP",city:"Lares",state:"Pa.",amount_of_biosolids_generated:120,amount_of_biosolids_managed_land_applied:0,latitude:18.304447,longitude:-66.87975},{facility_name:"WINCHESTER COUNTRY REGIONAL WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:120,amount_of_biosolids_managed_land_applied:0,latitude:29.910973,longitude:-95.57355},{facility_name:"DICKINSON CITY OF",city:"Dickinson",state:"Mont.",amount_of_biosolids_generated:120,amount_of_biosolids_managed_land_applied:112.3,latitude:46.869249,longitude:-102.753624},{facility_name:"ARANSAS PASS WWTP",city:"Aransas Pass",state:"Texas",amount_of_biosolids_generated:120,amount_of_biosolids_managed_land_applied:112.6,latitude:27.887586,longitude:-97.14881},{facility_name:"DOWDELL PUBLIC UD WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:119,amount_of_biosolids_managed_land_applied:0,latitude:30.092972,longitude:-95.554083},{facility_name:"STEWARTVILLE",city:"Stewartville",state:"Minn.",amount_of_biosolids_generated:119,amount_of_biosolids_managed_land_applied:119.2,latitude:43.83401738,longitude:-92.39126223},{facility_name:"SOUTH MIDDLETON TWP MUNI AUTH CUMBERLAND CNTY",city:"Boiling Springs",state:"Pa.",amount_of_biosolids_generated:119,amount_of_biosolids_managed_land_applied:119.12,latitude:40.13928677,longitude:-77.1235021},{facility_name:"LITTLE FALLS",city:"Little Falls",state:"Minn.",amount_of_biosolids_generated:119,amount_of_biosolids_managed_land_applied:119.07,latitude:45.96608,longitude:-94.36781},{facility_name:"CITY OF EMERSON",city:"Emerson",state:"Ga.",amount_of_biosolids_generated:119,amount_of_biosolids_managed_land_applied:0,latitude:34.110278,longitude:-84.754139},{facility_name:"YARMOUTH TOWN OF",city:"Yarmouth",state:"Mass.",amount_of_biosolids_generated:119,amount_of_biosolids_managed_land_applied:0,latitude:43.7903,longitude:-70.1656},{facility_name:"SNAKE RIVER WWTF",city:"Dillon",state:"Colo.",amount_of_biosolids_generated:118,amount_of_biosolids_managed_land_applied:0,latitude:39.60196,longitude:-106.01153},{facility_name:"FT BEND CO MUD 58 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:118,amount_of_biosolids_managed_land_applied:0,latitude:29.738528,longitude:-95.828833},{facility_name:"CITY OF ROME",city:"Rome",state:"Ga.",amount_of_biosolids_generated:118,amount_of_biosolids_managed_land_applied:0,latitude:34.22173,longitude:-85.307569},{facility_name:"OWEGO (T)",city:"Apalachin",state:"N.D.",amount_of_biosolids_generated:118,amount_of_biosolids_managed_land_applied:54.94,latitude:42.04513611,longitude:-76.15129184},{facility_name:"PEARL RIVER COUNTY UTILITY AUTHORITY, NEAL ROAD POTW",city:"Picayune",state:"Mo.",amount_of_biosolids_generated:118,amount_of_biosolids_managed_land_applied:117.69,latitude:30.535806,longitude:-89.705806},{facility_name:"AMERICAN WATER ENTERPRISES, INC.",city:"Fort Rucker",state:"Alaska",amount_of_biosolids_generated:117,amount_of_biosolids_managed_land_applied:0,latitude:30.957591,longitude:-88.012075},{facility_name:"ROBINSON CREEK WWTP",city:"Huntsville",state:"Texas",amount_of_biosolids_generated:117,amount_of_biosolids_managed_land_applied:0,latitude:30.646306,longitude:-95.5955},{facility_name:"SUGAR LAND GREATWOOD WWTP",city:"Sugar Land",state:"Texas",amount_of_biosolids_generated:117,amount_of_biosolids_managed_land_applied:0,latitude:29.547222,longitude:-95.687777},{facility_name:"FORT MORGAN CITY OF",city:"Fort Morgan",state:"Colo.",amount_of_biosolids_generated:117,amount_of_biosolids_managed_land_applied:117.22,latitude:40.23821666,longitude:-103.8149775},{facility_name:"SARANAC LAKE (V)",city:"Saranac Lake",state:"N.D.",amount_of_biosolids_generated:117,amount_of_biosolids_managed_land_applied:0,latitude:44.32536,longitude:-74.13178},{facility_name:"EAGLE TOWN OF",city:"Eagle",state:"Colo.",amount_of_biosolids_generated:117,amount_of_biosolids_managed_land_applied:0,latitude:39.66000699,longitude:-106.824228},{facility_name:"TOWN OF YADKINVILLE",city:"Yadkinville",state:"Mont.",amount_of_biosolids_generated:117,amount_of_biosolids_managed_land_applied:117,latitude:36.130887,longitude:-80.632511},{facility_name:"CITY OF EXCELSIOR SPRINGS",city:"Excelsior Springs",state:"Mo.",amount_of_biosolids_generated:117,amount_of_biosolids_managed_land_applied:117,latitude:39.3423,longitude:-94.22209},{facility_name:"EDINBORO BORO",city:"Edinboro",state:"Pa.",amount_of_biosolids_generated:117,amount_of_biosolids_managed_land_applied:0,latitude:41.87347,longitude:-80.13162},{facility_name:"CENTER CREEK WASTEWATER TREATMENT BOARD",city:"Webb City",state:"Mo.",amount_of_biosolids_generated:117,amount_of_biosolids_managed_land_applied:0,latitude:37.18369551,longitude:-94.48267206},{facility_name:"BEAR CREEK WWTP",city:"Lavon",state:"Texas",amount_of_biosolids_generated:117,amount_of_biosolids_managed_land_applied:0,latitude:33.013023,longitude:-96.448663},{facility_name:"LAKE FOREST REGIONAL WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:116,amount_of_biosolids_managed_land_applied:82.6975,latitude:29.986068,longitude:-95.578855},{facility_name:"LEBANON STP",city:"Lebanon",state:"Ky.",amount_of_biosolids_generated:116,amount_of_biosolids_managed_land_applied:91.4,latitude:37.5625,longitude:-85.272222},{facility_name:"SOUTH DAKOTA ELLSWORTH DEVELOPMENT AUTHORITY",city:"Box Elder",state:"S.D.",amount_of_biosolids_generated:116,amount_of_biosolids_managed_land_applied:0,latitude:44.105472,longitude:-102.998222},{facility_name:"SHAWNEE CO. PUBLIC WORKS",city:"Topeka",state:"Kan.",amount_of_biosolids_generated:116,amount_of_biosolids_managed_land_applied:82,latitude:39.07855,longitude:-95.71781},{facility_name:"HARRIS COUNTY MUD 285 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:116,amount_of_biosolids_managed_land_applied:0,latitude:29.800778,longitude:-95.169639},{facility_name:"CLEVELAND EAST WWTP",city:"Cleveland",state:"Texas",amount_of_biosolids_generated:116,amount_of_biosolids_managed_land_applied:0,latitude:30.333694,longitude:-95.052306},{facility_name:"JORDANELLE SPECIAL SERVICE DISTRICT WATER RECLAMATION FACILITY",city:"Heber",state:"Utah",amount_of_biosolids_generated:116,amount_of_biosolids_managed_land_applied:0,latitude:40.57741,longitude:-111.42786},{facility_name:"FORT BEND COUNTY MUD 133 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:115,amount_of_biosolids_managed_land_applied:0,latitude:29.689694,longitude:-95.780139},{facility_name:"HIBBING-SOUTH",city:"Hibbing",state:"Minn.",amount_of_biosolids_generated:115,amount_of_biosolids_managed_land_applied:115.3,latitude:47.37166,longitude:-92.91558},{facility_name:"BOROUGH OF SOUDERTON",city:"Souderton",state:"Pa.",amount_of_biosolids_generated:115,amount_of_biosolids_managed_land_applied:0,latitude:40.31308,longitude:-75.32938},{facility_name:"CITY OF NEVADA",city:"Nevada",state:"Mo.",amount_of_biosolids_generated:115,amount_of_biosolids_managed_land_applied:115,latitude:37.83808,longitude:-94.35929},{facility_name:"FRIENDSWOOD DEV WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:115,amount_of_biosolids_managed_land_applied:0,latitude:30.17289,longitude:-95.19252},{facility_name:"GRAND MISSION MUD 1 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:115,amount_of_biosolids_managed_land_applied:0,latitude:29.689944,longitude:-95.723833},{facility_name:"WASHINGTON COUNTY",city:"Fort Edward",state:"N.D.",amount_of_biosolids_generated:115,amount_of_biosolids_managed_land_applied:114.8,latitude:43.28712,longitude:-73.58661},{facility_name:"NORTH HUNTINGDON TWP MUNICIPAL",city:"North Huntingdon",state:"Pa.",amount_of_biosolids_generated:114,amount_of_biosolids_managed_land_applied:0,latitude:40.329898,longitude:-79.730557},{facility_name:"ACTON MUD WWTP",city:"Granbury",state:"Texas",amount_of_biosolids_generated:114,amount_of_biosolids_managed_land_applied:0,latitude:32.357917,longitude:-97.686389},{facility_name:"HARRIS COUNTY WCID 110 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:114,amount_of_biosolids_managed_land_applied:0,latitude:30.039313,longitude:-95.434684},{facility_name:"HARRISBURG, CITY OF (BIOSOLIDS)",city:"Harrisburg",state:"S.D.",amount_of_biosolids_generated:114,amount_of_biosolids_managed_land_applied:0,latitude:43.421389,longitude:-96.697722},{facility_name:"HARRIS CO MUD 216 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:114,amount_of_biosolids_managed_land_applied:0,latitude:29.782611,longitude:-95.67725},{facility_name:"ANGOLA WWTP",city:"Angola",state:"Iowa",amount_of_biosolids_generated:114,amount_of_biosolids_managed_land_applied:153.47,latitude:41.653446,longitude:-84.99957},{facility_name:"CINCO REGIONAL WWTF",city:"Sugar Land",state:"Texas",amount_of_biosolids_generated:113,amount_of_biosolids_managed_land_applied:0,latitude:29.741189,longitude:-95.727085},{facility_name:"HARRIS COUNTY MUD 433 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:113,amount_of_biosolids_managed_land_applied:106.23,latitude:29.9044,longitude:-95.7083},{facility_name:"HARRIS COUNTY UD 16 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:113,amount_of_biosolids_managed_land_applied:0,latitude:29.99147,longitude:-95.40071},{facility_name:"GENOA STP, CITY OF",city:"Genoa",state:"Iowa",amount_of_biosolids_generated:113,amount_of_biosolids_managed_land_applied:112.632,latitude:42.09645,longitude:-88.70377},{facility_name:"ESTES PARK SANITATION DISTRICT",city:"Estes Park",state:"Colo.",amount_of_biosolids_generated:113,amount_of_biosolids_managed_land_applied:0,latitude:40.3771167,longitude:-105.5255142},{facility_name:"MENDOTA STP, CITY OF",city:"Mendota",state:"Iowa",amount_of_biosolids_generated:113,amount_of_biosolids_managed_land_applied:139.95,latitude:41.5391,longitude:-89.1177},{facility_name:"CITY OF SHEPHERD",city:"Shepherd",state:"Texas",amount_of_biosolids_generated:112,amount_of_biosolids_managed_land_applied:0,latitude:30.496944,longitude:-94.986111},{facility_name:"CREVE COEUR WWTP, VILLAGE OF",city:"Creve Coeur",state:"Iowa",amount_of_biosolids_generated:112,amount_of_biosolids_managed_land_applied:0,latitude:40.632236,longitude:-89.620283},{facility_name:"HARRIS COUNTY MUD 449 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:112,amount_of_biosolids_managed_land_applied:112.0757,latitude:29.833696,longitude:-95.776534},{facility_name:"LONG PRAIRIE MUNICIPAL WWTF",city:"Unknown",state:"Minn.",amount_of_biosolids_generated:112,amount_of_biosolids_managed_land_applied:112,latitude:46.3161343,longitude:-94.1994801},{facility_name:"CITY OF NEOSHO",city:"Neosho",state:"Mo.",amount_of_biosolids_generated:112,amount_of_biosolids_managed_land_applied:112,latitude:36.868598,longitude:-94.367254},{facility_name:"MORGAN CITY, CITY OF",city:"Morgan City",state:"La.",amount_of_biosolids_generated:112,amount_of_biosolids_managed_land_applied:112,latitude:31.34999,longitude:-92.57633},{facility_name:"CITY OF ROSENBERG 1A WWTF",city:"Rosenberg",state:"Texas",amount_of_biosolids_generated:112,amount_of_biosolids_managed_land_applied:0,latitude:29.565556,longitude:-95.798611},{facility_name:"CITY OF GALENA PARK WWTP 1",city:"Galena Park",state:"Texas",amount_of_biosolids_generated:112,amount_of_biosolids_managed_land_applied:0,latitude:29.7361,longitude:-95.230478},{facility_name:"CITY OF PELLA",city:"Pella",state:"Hawaii",amount_of_biosolids_generated:112,amount_of_biosolids_managed_land_applied:111.66,latitude:41.407048,longitude:-92.918313},{facility_name:"ALLENS CREEK WWTF",city:"Sealy",state:"Texas",amount_of_biosolids_generated:111,amount_of_biosolids_managed_land_applied:111.43286,latitude:29.757462,longitude:-96.148036},{facility_name:"SAN JACINTO RIVER AUTHORITY",city:"The Woodland",state:"Texas",amount_of_biosolids_generated:111,amount_of_biosolids_managed_land_applied:0,latitude:30.215663,longitude:-95.450326},{facility_name:"MOSHANNON VALLEY JT. AUTH.",city:"Philipsburg",state:"Pa.",amount_of_biosolids_generated:111,amount_of_biosolids_managed_land_applied:26.16,latitude:40.9089,longitude:-78.224149},{facility_name:"BUCKHANNON, CITY OF",city:"Buckhannon",state:"Wis.",amount_of_biosolids_generated:111,amount_of_biosolids_managed_land_applied:111.2,latitude:38.97684238,longitude:-80.23405871},{facility_name:"SIDNEY WWTF",city:"Sidney",state:"Neb.",amount_of_biosolids_generated:111,amount_of_biosolids_managed_land_applied:111,latitude:41.13446,longitude:-102.94671},{facility_name:"FLORENCE STP",city:"Florence",state:"Ore.",amount_of_biosolids_generated:111,amount_of_biosolids_managed_land_applied:42.7,latitude:43.97011,longitude:-124.114751},{facility_name:"TAMU MAIN CAMPUS WWTP",city:"College Station",state:"Texas",amount_of_biosolids_generated:111,amount_of_biosolids_managed_land_applied:31.884,latitude:30.575576,longitude:-96.379262},{facility_name:"GONZALES WWTP",city:"Gonzales",state:"Texas",amount_of_biosolids_generated:111,amount_of_biosolids_managed_land_applied:110.95,latitude:29.490218,longitude:-97.436128},{facility_name:"HARRIS COUNTY MUD 189 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:111,amount_of_biosolids_managed_land_applied:0,latitude:29.98717,longitude:-95.43888},{facility_name:"GSW&SA/CITY OF MARION WWTP",city:"Marion",state:"S.C.",amount_of_biosolids_generated:110,amount_of_biosolids_managed_land_applied:110,latitude:34.164538,longitude:-79.387549},{facility_name:"THURMONT WASTEWATER TREAT.FAC.",city:"Thurmont",state:"Mass.",amount_of_biosolids_generated:110,amount_of_biosolids_managed_land_applied:0,latitude:39.610099,longitude:-77.411376},{facility_name:"NITRO, CITY OF,SANITARY BOARD",city:"Nitro",state:"Wis.",amount_of_biosolids_generated:110,amount_of_biosolids_managed_land_applied:0,latitude:38.42115,longitude:-81.848131},{facility_name:"SOCORRO, CITY OF",city:"Socorro",state:"N.D.",amount_of_biosolids_generated:110,amount_of_biosolids_managed_land_applied:0,latitude:34.053427,longitude:-106.888943},{facility_name:"CITY OF BELTON",city:"Belton",state:"Mo.",amount_of_biosolids_generated:110,amount_of_biosolids_managed_land_applied:0,latitude:38.805101,longitude:-94.539265},{facility_name:"TIADAGHTON VALLEY MUNI AUTH",city:"Jersey Shore",state:"Pa.",amount_of_biosolids_generated:110,amount_of_biosolids_managed_land_applied:0,latitude:41.23149532,longitude:-77.24009924},{facility_name:"CITY OF BONNE TERRE",city:"Bonne Terre",state:"Mo.",amount_of_biosolids_generated:110,amount_of_biosolids_managed_land_applied:109,latitude:37.92486,longitude:-90.55129},{facility_name:"UPPER LEON RIVER MWD WWTP",city:"Comanche",state:"Texas",amount_of_biosolids_generated:109,amount_of_biosolids_managed_land_applied:0,latitude:31.960694,longitude:-98.489194},{facility_name:"LITCHFIELD STP, CITY OF",city:"Litchfield",state:"Iowa",amount_of_biosolids_generated:109,amount_of_biosolids_managed_land_applied:0,latitude:39.174242,longitude:-89.63748},{facility_name:"HOLLIDAYSBURG REGIONAL WWTP",city:"Blair County",state:"Pa.",amount_of_biosolids_generated:109,amount_of_biosolids_managed_land_applied:0,latitude:40.430017,longitude:-78.361101},{facility_name:"CITY OF BONNE TERRE",city:"Bonne Terre",state:"Mo.",amount_of_biosolids_generated:109,amount_of_biosolids_managed_land_applied:108.8,latitude:37.92486,longitude:-90.55129},{facility_name:"CLINTON SD STP",city:"Clinton",state:"Iowa",amount_of_biosolids_generated:109,amount_of_biosolids_managed_land_applied:0,latitude:40.137222,longitude:-88.968056},{facility_name:"TOWN OF AHOSKIE",city:"Ahoskie",state:"Mont.",amount_of_biosolids_generated:109,amount_of_biosolids_managed_land_applied:108.76,latitude:36.2731,longitude:-76.9931},{facility_name:"HARRIS COUNTY MUD 400 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:109,amount_of_biosolids_managed_land_applied:108.604912,latitude:29.936611,longitude:-95.238},{facility_name:"MONTGOMERY COUNTY MUD 83 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:108,amount_of_biosolids_managed_land_applied:0,latitude:30.071694,longitude:-95.263028},{facility_name:"RUSHVILLE WWTP",city:"Rushville",state:"Iowa",amount_of_biosolids_generated:108,amount_of_biosolids_managed_land_applied:114.98,latitude:39.607547,longitude:-85.445267},{facility_name:"ULSTER (T)",city:"Lake Katrine",state:"N.D.",amount_of_biosolids_generated:108,amount_of_biosolids_managed_land_applied:0,latitude:41.97731,longitude:-74.00251},{facility_name:"HAMBURG BORO",city:"Hamburg",state:"Pa.",amount_of_biosolids_generated:108,amount_of_biosolids_managed_land_applied:0,latitude:40.55583,longitude:-75.98426},{facility_name:"CAMPBELLS RUN STP",city:"Pittsburgh",state:"Pa.",amount_of_biosolids_generated:107,amount_of_biosolids_managed_land_applied:0,latitude:40.425624,longitude:-80.111722},{facility_name:"CITY OF BONHAM WWTP",city:"Bonham",state:"Texas",amount_of_biosolids_generated:107,amount_of_biosolids_managed_land_applied:0,latitude:33.587247,longitude:-96.160641},{facility_name:"CITY OF INDEPENDENCE",city:"Independence",state:"Hawaii",amount_of_biosolids_generated:107,amount_of_biosolids_managed_land_applied:107.4,latitude:42.468714,longitude:-91.89133},{facility_name:"CITY OF FARMINGTON",city:"Farmington",state:"Mo.",amount_of_biosolids_generated:107,amount_of_biosolids_managed_land_applied:107.37,latitude:37.78064,longitude:-90.42251},{facility_name:"CITY OF BELMONT",city:"Belmont",state:"Mont.",amount_of_biosolids_generated:107,amount_of_biosolids_managed_land_applied:106.87,latitude:35.230955,longitude:-81.016555},{facility_name:"HARRIS COUNTY MUD 26 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:107,amount_of_biosolids_managed_land_applied:106.6,latitude:30.027044,longitude:-95.302246},{facility_name:"ROSELLE-J BOTTERMAN STP",city:"Roselle",state:"Iowa",amount_of_biosolids_generated:106,amount_of_biosolids_managed_land_applied:106.31,latitude:41.982567,longitude:-88.113572},{facility_name:"TOWN OF LIVINGSTON",city:"Livingston",state:"Tenn.",amount_of_biosolids_generated:106,amount_of_biosolids_managed_land_applied:106.3,latitude:36.359229,longitude:-85.344134},{facility_name:"US MCAS CHERRY POINT",city:"Cherry Point",state:"Mont.",amount_of_biosolids_generated:106,amount_of_biosolids_managed_land_applied:105.9,latitude:34.905641,longitude:-76.893355},{facility_name:"CITY OF RICHMOND SOUTH WWTP",city:"Richmond",state:"Texas",amount_of_biosolids_generated:106,amount_of_biosolids_managed_land_applied:0,latitude:29.545128,longitude:-95.719004},{facility_name:"CITY OF WAVERLY",city:"Waverly",state:"Hawaii",amount_of_biosolids_generated:106,amount_of_biosolids_managed_land_applied:105.72,latitude:42.82688267,longitude:-92.43617262},{facility_name:"HARRIS COUNTY MUD 368 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:105,amount_of_biosolids_managed_land_applied:0,latitude:30.051861,longitude:-95.596583},{facility_name:"TOWN OF MOCKSVILLE",city:"Mocksville",state:"Mont.",amount_of_biosolids_generated:105,amount_of_biosolids_managed_land_applied:105,latitude:35.88576,longitude:-80.50104},{facility_name:"WEST HARRIS COUNTY MUD 11 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:105,amount_of_biosolids_managed_land_applied:0,latitude:29.895778,longitude:-95.550472},{facility_name:"FT BEND CO MUD 134A WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:104,amount_of_biosolids_managed_land_applied:104.44,latitude:29.665397,longitude:-95.694933},{facility_name:"CITY OF WASHINGTON",city:"Washington",state:"Hawaii",amount_of_biosolids_generated:104,amount_of_biosolids_managed_land_applied:104.1,latitude:41.29,longitude:-91.683154},{facility_name:"ROY C. HESTER WWTP",city:"Big Spring",state:"Texas",amount_of_biosolids_generated:104,amount_of_biosolids_managed_land_applied:0,latitude:32.238833,longitude:-101.44925},{facility_name:"WHITECAP WWTP",city:"Corpus Christi",state:"Texas",amount_of_biosolids_generated:104,amount_of_biosolids_managed_land_applied:0,latitude:27.603083,longitude:-97.250944},{facility_name:"MONTGOMERY COUNTY WCID 1 WWTP",city:"The Woodlands",state:"Texas",amount_of_biosolids_generated:103,amount_of_biosolids_managed_land_applied:0,latitude:30.628,longitude:-90.88025},{facility_name:"SANDWICH STP, CITY OF",city:"Sandwich",state:"Iowa",amount_of_biosolids_generated:103,amount_of_biosolids_managed_land_applied:103,latitude:41.65675,longitude:-88.63739},{facility_name:"MANHATTAN STP, VILLAGE OF",city:"Manhattan",state:"Iowa",amount_of_biosolids_generated:103,amount_of_biosolids_managed_land_applied:102.84,latitude:41.42697,longitude:-87.99329},{facility_name:"CHURCH HILL STP.",city:"Church Hill",state:"Tenn.",amount_of_biosolids_generated:103,amount_of_biosolids_managed_land_applied:102.8,latitude:36.523432,longitude:-82.682102},{facility_name:"IL AMERICAN WTR CO-OAK VALLEY",city:"Lockport",state:"Iowa",amount_of_biosolids_generated:102,amount_of_biosolids_managed_land_applied:102.48,latitude:41.588333,longitude:-87.925},{facility_name:"WAGNER CREEK WWTP",city:"Texarkana",state:"Texas",amount_of_biosolids_generated:102,amount_of_biosolids_managed_land_applied:0,latitude:33.378528,longitude:-94.046484},{facility_name:"SOUTH DEERFIELD W W T P",city:"South Deerfield",state:"Mass.",amount_of_biosolids_generated:102,amount_of_biosolids_managed_land_applied:0,latitude:42.46829,longitude:-72.58914},{facility_name:"CNP UD - WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:101,amount_of_biosolids_managed_land_applied:0,latitude:30.03301,longitude:-95.438295},{facility_name:"CITY OF ALGONA",city:"Algona",state:"Hawaii",amount_of_biosolids_generated:101,amount_of_biosolids_managed_land_applied:101.02,latitude:43.06981,longitude:-94.238121},{facility_name:"CITY OF FREEPORT CENTRAL WWTF",city:"Freeport",state:"Texas",amount_of_biosolids_generated:101,amount_of_biosolids_managed_land_applied:0,latitude:28.943139,longitude:-95.377417},{facility_name:"SALAMANCA BOARD OF PUBLIC UTILITES",city:"Salamanca",state:"N.D.",amount_of_biosolids_generated:101,amount_of_biosolids_managed_land_applied:74.7,latitude:42.15679,longitude:-78.70777},{facility_name:"CITY OF PARK HILLS",city:"Park Hills",state:"Mo.",amount_of_biosolids_generated:101,amount_of_biosolids_managed_land_applied:100.8,latitude:37.85186,longitude:-90.52326},{facility_name:"HARTSELLE UTILITIES",city:"Hartselle",state:"Alaska",amount_of_biosolids_generated:101,amount_of_biosolids_managed_land_applied:100.57,latitude:34.4083,longitude:-86.9417},{facility_name:"CHIPLEY WWTP",city:"Chipley",state:"Fla.",amount_of_biosolids_generated:100,amount_of_biosolids_managed_land_applied:100.46,latitude:30.78036,longitude:-85.55012},{facility_name:"ELK-PINCH PUBLIC SERVIC DISTRI",city:"Elkview",state:"Wis.",amount_of_biosolids_generated:100,amount_of_biosolids_managed_land_applied:100.38,latitude:38.403589,longitude:-81.523713},{facility_name:"OMAK POTW",city:"Omak",state:"Wash.",amount_of_biosolids_generated:100,amount_of_biosolids_managed_land_applied:202.8595,latitude:48.400079,longitude:-119.535764},{facility_name:"CITY OF ROLLA",city:"Rolla",state:"Mo.",amount_of_biosolids_generated:100,amount_of_biosolids_managed_land_applied:214.32,latitude:37.94992108,longitude:-91.77424065},{facility_name:"SEWARD WWTF",city:"Seward",state:"Neb.",amount_of_biosolids_generated:100,amount_of_biosolids_managed_land_applied:100,latitude:40.899889,longitude:-97.0915},{facility_name:"WILLITS WQCP",city:"Willits",state:"Calif.",amount_of_biosolids_generated:100,amount_of_biosolids_managed_land_applied:98.79,latitude:39.41356137,longitude:-123.3587072},{facility_name:"SHAKOPEE MDEWAKANTON SIOUX WRF",city:"Prior Lake",state:"Minn.",amount_of_biosolids_generated:100,amount_of_biosolids_managed_land_applied:0,latitude:44.726394,longitude:-93.464692},{facility_name:"CITY OF ROLLA",city:"Rolla",state:"Mo.",amount_of_biosolids_generated:100,amount_of_biosolids_managed_land_applied:0,latitude:37.94992108,longitude:-91.77424065},{facility_name:"CITY OF ROLLA",city:"Rolla",state:"Mo.",amount_of_biosolids_generated:100,amount_of_biosolids_managed_land_applied:0,latitude:37.94992108,longitude:-91.77424065},{facility_name:"BROKEN BOW WWTF",city:"Broken Bow",state:"Neb.",amount_of_biosolids_generated:100,amount_of_biosolids_managed_land_applied:0,latitude:41.3861,longitude:-99.5944},{facility_name:"BEDFORD BOROUGH MUNICIPAL AUTH",city:"Bedford County",state:"Pa.",amount_of_biosolids_generated:100,amount_of_biosolids_managed_land_applied:91.9,latitude:40.01727,longitude:-78.50698},{facility_name:"BIG OAKS MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:100,amount_of_biosolids_managed_land_applied:139.08,latitude:29.701611,longitude:-95.701611},{facility_name:"FORT BEND COUNTY MUD 146 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:100,amount_of_biosolids_managed_land_applied:99.8009806,latitude:29.673083,longitude:-95.751917},{facility_name:"CITY OF SULLIVAN",city:"Sullivan",state:"Mo.",amount_of_biosolids_generated:100,amount_of_biosolids_managed_land_applied:99.55,latitude:38.208288,longitude:-91.160012},{facility_name:"FORT BEND COUNTY MUD 134A WWTP 2",city:"Houston",state:"Texas",amount_of_biosolids_generated:99,amount_of_biosolids_managed_land_applied:99.28,latitude:29.638888,longitude:-95.704166},{facility_name:"CITY OF BURNET WWTF",city:"Burnet",state:"Texas",amount_of_biosolids_generated:99,amount_of_biosolids_managed_land_applied:99.1,latitude:30.75668,longitude:-98.22657},{facility_name:"SILVER LAKE WWTF",city:"Del Rio",state:"Texas",amount_of_biosolids_generated:99,amount_of_biosolids_managed_land_applied:0,latitude:29.34375,longitude:-100.943778},{facility_name:"CITY OF KRUM WWTF",city:"Krum",state:"Texas",amount_of_biosolids_generated:99,amount_of_biosolids_managed_land_applied:0,latitude:33.257326,longitude:-97.246869},{facility_name:"BECKER",city:"Becker",state:"Minn.",amount_of_biosolids_generated:99,amount_of_biosolids_managed_land_applied:0,latitude:45.393692,longitude:-93.862648},{facility_name:"BUCKLEY STP",city:"Buckley",state:"Wash.",amount_of_biosolids_generated:99,amount_of_biosolids_managed_land_applied:98.6745,latitude:47.168535,longitude:-122.033917},{facility_name:"CLARKSVILLE, CITY OF",city:"Clarksville",state:"Alaska",amount_of_biosolids_generated:99,amount_of_biosolids_managed_land_applied:98.51,latitude:35.445657,longitude:-93.473862},{facility_name:"FT BEND MUD 162 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:99,amount_of_biosolids_managed_land_applied:0,latitude:29.497361,longitude:-95.751514},{facility_name:"HARRIS CO MUD 200 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:98,amount_of_biosolids_managed_land_applied:98.42,latitude:29.97395,longitude:-95.43224},{facility_name:"MONTGOMERY COUNTY MUD 99 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:98,amount_of_biosolids_managed_land_applied:98.23,latitude:29.746033,longitude:-95.4654},{facility_name:"CITY OF WARRENSBURG",city:"Warrensburg",state:"Mo.",amount_of_biosolids_generated:98,amount_of_biosolids_managed_land_applied:0,latitude:38.762602,longitude:-93.74039},{facility_name:"PLATTE CO REGIONAL SEWER",city:"Tracy",state:"Mo.",amount_of_biosolids_generated:98,amount_of_biosolids_managed_land_applied:0,latitude:39.31726751,longitude:-94.78185758},{facility_name:"HARRIS COUNTY MUD 5 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:98,amount_of_biosolids_managed_land_applied:0,latitude:29.9508,longitude:-95.44484},{facility_name:"WESTON MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:98,amount_of_biosolids_managed_land_applied:0,latitude:29.791965,longitude:-95.743425},{facility_name:"PLAINVIEW-ELGIN SD",city:"Plainview",state:"Minn.",amount_of_biosolids_generated:98,amount_of_biosolids_managed_land_applied:98,latitude:44.14425,longitude:-92.139361},{facility_name:"PRINCETON STP",city:"Princeton",state:"Ky.",amount_of_biosolids_generated:98,amount_of_biosolids_managed_land_applied:97.878,latitude:37.074444,longitude:-87.894444},{facility_name:"ANDERSON WPCP",city:"Anderson",state:"Calif.",amount_of_biosolids_generated:98,amount_of_biosolids_managed_land_applied:0,latitude:40.45970741,longitude:-122.2871596},{facility_name:"PRASA CIALES",city:"Ciales",state:"Pa.",amount_of_biosolids_generated:98,amount_of_biosolids_managed_land_applied:64.18,latitude:18.3459,longitude:-66.4681},{facility_name:"SILVERTON, CITY OF",city:"Silverton",state:"Ore.",amount_of_biosolids_generated:98,amount_of_biosolids_managed_land_applied:97.52,latitude:45.008957,longitude:-122.802011},{facility_name:"NORTHSIDE WWTF",city:"Lindale",state:"Texas",amount_of_biosolids_generated:98,amount_of_biosolids_managed_land_applied:0,latitude:32.465222,longitude:-95.403278},{facility_name:"HARRIS CO MUD 285 WWTF 2",city:"Houston",state:"Texas",amount_of_biosolids_generated:98,amount_of_biosolids_managed_land_applied:0,latitude:29.817001,longitude:-95.16448},{facility_name:"HIGHTSTOWN ADVANCED WTP",city:"Hightstown",state:"Neb.",amount_of_biosolids_generated:97,amount_of_biosolids_managed_land_applied:0,latitude:40.27259,longitude:-74.53384},{facility_name:"CITY OF HARLAN",city:"Harlan",state:"Hawaii",amount_of_biosolids_generated:97,amount_of_biosolids_managed_land_applied:96.8,latitude:41.65679,longitude:-95.31999},{facility_name:"CITY OF CHEROKEE",city:"Cherokee",state:"Hawaii",amount_of_biosolids_generated:97,amount_of_biosolids_managed_land_applied:96.76,latitude:42.74971,longitude:-95.55358},{facility_name:"CITY OF STORM LAKE",city:"Storm Lake",state:"Hawaii",amount_of_biosolids_generated:97,amount_of_biosolids_managed_land_applied:96.7,latitude:42.66920938,longitude:-95.2301},{facility_name:"EMERSON ESTATE WWFT",city:"Willis",state:"Texas",amount_of_biosolids_generated:97,amount_of_biosolids_managed_land_applied:0,latitude:30.32135,longitude:-95.304514},{facility_name:"CITY OF AURORA",city:"Aurora",state:"Mo.",amount_of_biosolids_generated:97,amount_of_biosolids_managed_land_applied:127.01,latitude:36.83119579,longitude:-93.69795577},{facility_name:"MALONE (V)",city:"Malone",state:"N.D.",amount_of_biosolids_generated:96,amount_of_biosolids_managed_land_applied:0,latitude:44.84946,longitude:-74.29126},{facility_name:"LEWISBURG AREA JT. SEWER AUTH",city:"Lewisburg",state:"Pa.",amount_of_biosolids_generated:96,amount_of_biosolids_managed_land_applied:96.29,latitude:40.9488,longitude:-76.8865},{facility_name:"CITY OF POTEET WWTF",city:"Poteet",state:"Texas",amount_of_biosolids_generated:96,amount_of_biosolids_managed_land_applied:0,latitude:29.0324,longitude:-98.5673},{facility_name:"SALIDA SD WWTP",city:"Salida",state:"Calif.",amount_of_biosolids_generated:96,amount_of_biosolids_managed_land_applied:96,latitude:37.70924784,longitude:-121.0879991},{facility_name:"MADISONVILLE WWTP",city:"Madisonville",state:"Texas",amount_of_biosolids_generated:96,amount_of_biosolids_managed_land_applied:0,latitude:30.93924,longitude:-95.92141},{facility_name:"MONTGOMERY CO UD 3 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:96,amount_of_biosolids_managed_land_applied:0,latitude:30.358582,longitude:-95.601858},{facility_name:"CITY OF HAMLET",city:"Hamlet",state:"Mont.",amount_of_biosolids_generated:96,amount_of_biosolids_managed_land_applied:95.85,latitude:34.855388,longitude:-79.724998},{facility_name:"LENOX W W T P",city:"Lenox",state:"Mass.",amount_of_biosolids_generated:96,amount_of_biosolids_managed_land_applied:0,latitude:42.37065,longitude:-73.27989},{facility_name:"MERIDIAN METROPOLITAN DISTRICT",city:"Englewood",state:"Colo.",amount_of_biosolids_generated:96,amount_of_biosolids_managed_land_applied:95.59,latitude:39.564444,longitude:-104.849444},{facility_name:"CITY OF WARRENSBURG",city:"Warrensburg",state:"Mo.",amount_of_biosolids_generated:95,amount_of_biosolids_managed_land_applied:0,latitude:38.762602,longitude:-93.74039},{facility_name:"LE ROY (V)",city:"Le Roy",state:"N.D.",amount_of_biosolids_generated:95,amount_of_biosolids_managed_land_applied:0,latitude:42.9777,longitude:-77.99265},{facility_name:"HARRIS COUNTY MUD 102 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:95,amount_of_biosolids_managed_land_applied:0,latitude:29.86364,longitude:-95.63912},{facility_name:"FORSYTH (CITY OF) NE",city:"Forsyth",state:"Ga.",amount_of_biosolids_generated:95,amount_of_biosolids_managed_land_applied:0,latitude:33.046222,longitude:-83.920472},{facility_name:"CITY OF FORT MADISON",city:"Fort Madison",state:"Hawaii",amount_of_biosolids_generated:95,amount_of_biosolids_managed_land_applied:0,latitude:40.633001,longitude:-91.311744},{facility_name:"MOODY GOVERNMENTAL UTILITY SERVICES CORPORATION",city:"Moody",state:"Alaska",amount_of_biosolids_generated:95,amount_of_biosolids_managed_land_applied:0,latitude:33.5772,longitude:-86.5122},{facility_name:"MOMENCE STP, CITY OF",city:"Momence",state:"Iowa",amount_of_biosolids_generated:95,amount_of_biosolids_managed_land_applied:94.53,latitude:41.1607,longitude:-87.6705},{facility_name:"HARRIS COUNTY MUD 180",city:"Bellaire",state:"Texas",amount_of_biosolids_generated:94,amount_of_biosolids_managed_land_applied:0,latitude:29.955877,longitude:-95.492883},{facility_name:"CENTER TWP SEW AUTH",city:"Aliquippa",state:"Pa.",amount_of_biosolids_generated:94,amount_of_biosolids_managed_land_applied:0,latitude:40.64869,longitude:-80.30011},{facility_name:"CRAIG CITY OF",city:"Craig",state:"Colo.",amount_of_biosolids_generated:94,amount_of_biosolids_managed_land_applied:204,latitude:40.51236,longitude:-107.55134},{facility_name:"CITY OF DYERSVILLE",city:"Dyersville",state:"Hawaii",amount_of_biosolids_generated:94,amount_of_biosolids_managed_land_applied:94,latitude:42.48459,longitude:-91.121032},{facility_name:"TALL TIMBERS WWTF",city:"Avondale",state:"Ark.",amount_of_biosolids_generated:94,amount_of_biosolids_managed_land_applied:0,latitude:32.246061,longitude:-95.329909},{facility_name:"HARRIS COUNTY MUD 249 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:94,amount_of_biosolids_managed_land_applied:0,latitude:30.062694,longitude:-95.422972},{facility_name:"CARYVILLE-JACKSBORO UC STP",city:"Caryville",state:"Tenn.",amount_of_biosolids_generated:94,amount_of_biosolids_managed_land_applied:83.45,latitude:36.307109,longitude:-84.199742},{facility_name:"PARK TEN WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:94,amount_of_biosolids_managed_land_applied:0,latitude:29.789312,longitude:-95.669279},{facility_name:"FRACKVILLE AREA MUN AUTH",city:"Butler, Township Of",state:"Pa.",amount_of_biosolids_generated:93,amount_of_biosolids_managed_land_applied:93.26,latitude:40.78604,longitude:-76.23147},{facility_name:"CANAJOHARIE (V)",city:"Canajoharie",state:"N.D.",amount_of_biosolids_generated:93,amount_of_biosolids_managed_land_applied:0,latitude:42.906588,longitude:-74.575183},{facility_name:"ROCKVILLE WWTP",city:"Rockville",state:"Iowa",amount_of_biosolids_generated:93,amount_of_biosolids_managed_land_applied:93,latitude:39.758611,longitude:-87.222861},{facility_name:"CITY OF DECATUR",city:"Decatur",state:"Texas",amount_of_biosolids_generated:93,amount_of_biosolids_managed_land_applied:0,latitude:33.2464,longitude:-97.562},{facility_name:"HERCULANEUM WASTEWATER TR",city:"Herculaneum",state:"Mo.",amount_of_biosolids_generated:93,amount_of_biosolids_managed_land_applied:0,latitude:38.255667,longitude:-90.376388},{facility_name:"CITY OF BOWIE WWTP",city:"Bowie",state:"Texas",amount_of_biosolids_generated:92,amount_of_biosolids_managed_land_applied:0,latitude:33.533017,longitude:-97.85203},{facility_name:"CITY OF MOUNT PLEASANT",city:"Mount Pleasant",state:"Hawaii",amount_of_biosolids_generated:92,amount_of_biosolids_managed_land_applied:92,latitude:40.96667,longitude:-91.55462},{facility_name:"PENDLETON-CLEMSON REG. WWTF",city:"Pendleton",state:"S.C.",amount_of_biosolids_generated:92,amount_of_biosolids_managed_land_applied:92,latitude:34.6356,longitude:-82.8014},{facility_name:"MILLERSBURG AREA AUTHORITY STP",city:"Millersburg",state:"Pa.",amount_of_biosolids_generated:92,amount_of_biosolids_managed_land_applied:33.3,latitude:40.5331,longitude:-76.968},{facility_name:"MCCANDLESS TOWNSHIP - STP",city:"Pittsburgh",state:"Pa.",amount_of_biosolids_generated:92,amount_of_biosolids_managed_land_applied:0,latitude:40.578627,longitude:-80.031317},{facility_name:"CITY OF ENTERPRISE",city:"Enterprise",state:"Alaska",amount_of_biosolids_generated:91,amount_of_biosolids_managed_land_applied:91.41,latitude:31.3397,longitude:-85.8111},{facility_name:"SCHUYLKILL HAVEN MUN AUTH-STP",city:"Schuykill",state:"Pa.",amount_of_biosolids_generated:91,amount_of_biosolids_managed_land_applied:91.04,latitude:40.623056,longitude:-76.17},{facility_name:"ABILENE, CITY OF WWTP",city:"Abilene",state:"Kan.",amount_of_biosolids_generated:91,amount_of_biosolids_managed_land_applied:91,latitude:38.90065,longitude:-97.20107},{facility_name:"4S RANCH WWTP",city:"San Antonio",state:"Texas",amount_of_biosolids_generated:91,amount_of_biosolids_managed_land_applied:0,latitude:29.765555,longitude:-98.391944},{facility_name:"HARRIS COUNTY WCID 116 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:91,amount_of_biosolids_managed_land_applied:0,latitude:29.996662,longitude:-95.521876},{facility_name:"MONTECITO S.D. WWTP",city:"Santa Barbara",state:"Calif.",amount_of_biosolids_generated:91,amount_of_biosolids_managed_land_applied:90.8,latitude:34.41333,longitude:-119.647631},{facility_name:"CHARTERWOOD MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:91,amount_of_biosolids_managed_land_applied:0,latitude:30.001415,longitude:-95.572053},{facility_name:"WOODBURN, CITY OF",city:"Woodburn",state:"Ore.",amount_of_biosolids_generated:90,amount_of_biosolids_managed_land_applied:90.39,latitude:45.155901,longitude:-122.805849},{facility_name:"BEDFORD STP.",city:"Bedford",state:"Utah",amount_of_biosolids_generated:90,amount_of_biosolids_managed_land_applied:0,latitude:37.333611,longitude:-79.506667},{facility_name:"CITY OF ELDRIDGE",city:"Eldridge",state:"Hawaii",amount_of_biosolids_generated:90,amount_of_biosolids_managed_land_applied:90,latitude:41.6603134,longitude:-90.57479851},{facility_name:"ROSEHILL RESERVE-HARRIS COUNTY MUD 542 WWTP 1",city:"Houston",state:"Texas",amount_of_biosolids_generated:90,amount_of_biosolids_managed_land_applied:0,latitude:30.066666,longitude:-95.714444},{facility_name:"HARRISON, CITY OF",city:"Harrison",state:"Alaska",amount_of_biosolids_generated:90,amount_of_biosolids_managed_land_applied:89.83,latitude:36.2408,longitude:-93.0808},{facility_name:"CITY OF LAFAYETTE",city:"Lafayette",state:"Ga.",amount_of_biosolids_generated:90,amount_of_biosolids_managed_land_applied:89.86,latitude:34.696093,longitude:-85.284967},{facility_name:"CITY OF GOLIAD WWTP",city:"Goliad",state:"Texas",amount_of_biosolids_generated:89,amount_of_biosolids_managed_land_applied:0,latitude:28.661583,longitude:-97.395889},{facility_name:"CITY OF CALIFORNIA",city:"California",state:"Mo.",amount_of_biosolids_generated:89,amount_of_biosolids_managed_land_applied:89.3,latitude:38.613833,longitude:-92.576389},{facility_name:"TRINIDAD CITY OF",city:"Trinidad",state:"Colo.",amount_of_biosolids_generated:89,amount_of_biosolids_managed_land_applied:0,latitude:37.1740569,longitude:-104.4909835},{facility_name:"HARRIS COUNTY MUD 230 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:89,amount_of_biosolids_managed_land_applied:0,latitude:29.974083,longitude:-95.572139},{facility_name:"BELEN, CITY OF",city:"Belen",state:"N.D.",amount_of_biosolids_generated:89,amount_of_biosolids_managed_land_applied:76,latitude:34.64287,longitude:-106.77644},{facility_name:"NORTH MISSION GLEN MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:89,amount_of_biosolids_managed_land_applied:0,latitude:29.679111,longitude:-95.665778},{facility_name:"PORTLAND WPCF",city:"Portland",state:"Conn.",amount_of_biosolids_generated:89,amount_of_biosolids_managed_land_applied:0,latitude:41.56951,longitude:-72.6443},{facility_name:"MARYSVILLE BOROUGH COUNCIL",city:"Marysville",state:"Pa.",amount_of_biosolids_generated:89,amount_of_biosolids_managed_land_applied:0,latitude:40.343056,longitude:-76.927333},{facility_name:"GREENWOOD/WEST ALEXANDER WWTF",city:"Greenwood",state:"S.C.",amount_of_biosolids_generated:89,amount_of_biosolids_managed_land_applied:0,latitude:34.193333,longitude:-82.158333},{facility_name:"CLINTON MUNICIPAL WWTP",city:"Clinton",state:"Iowa",amount_of_biosolids_generated:89,amount_of_biosolids_managed_land_applied:88.7,latitude:39.653944,longitude:-87.39775},{facility_name:"US NAVAL STATION MAYPORT",city:"Jacksonville",state:"Fla.",amount_of_biosolids_generated:89,amount_of_biosolids_managed_land_applied:88.596,latitude:30.391111,longitude:-81.4131},{facility_name:"JOHNSON RANCH WWTF",city:"Boerne",state:"Texas",amount_of_biosolids_generated:89,amount_of_biosolids_managed_land_applied:0,latitude:29.754722,longitude:-98.421666},{facility_name:"ATK LAUNCH SYSTEMS INC",city:"Brigham City",state:"Utah",amount_of_biosolids_generated:89,amount_of_biosolids_managed_land_applied:0,latitude:41.679,longitude:-112.432},{facility_name:"TOWN OF WILLIAMSTON",city:"Williamston",state:"Mont.",amount_of_biosolids_generated:88,amount_of_biosolids_managed_land_applied:88.45,latitude:35.853378,longitude:-77.030739},{facility_name:"FORT BEND COUNTY MUD 81 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:88,amount_of_biosolids_managed_land_applied:0,latitude:29.65691,longitude:-95.929141},{facility_name:"OSAGE WWTP",city:"Osage",state:"Hawaii",amount_of_biosolids_generated:88,amount_of_biosolids_managed_land_applied:88.38,latitude:43.27893,longitude:-92.83077},{facility_name:"HARRIS COUNTY MUD 344 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:88,amount_of_biosolids_managed_land_applied:0,latitude:29.859181,longitude:-95.581407},{facility_name:"KAUFMAN COUNTY FWSD 1A WWTP",city:"Dallas",state:"Texas",amount_of_biosolids_generated:88,amount_of_biosolids_managed_land_applied:0,latitude:32.732657,longitude:-96.393608},{facility_name:"DOUGLASVILLE-DOUGLAS COUNTY WATER & SEWER AUTHORITY (WSA)",city:"Douglasville",state:"Ga.",amount_of_biosolids_generated:88,amount_of_biosolids_managed_land_applied:0,latitude:33.784167,longitude:-84.760694},{facility_name:"OYSTER BAY SD",city:"Oyster Bay",state:"N.D.",amount_of_biosolids_generated:88,amount_of_biosolids_managed_land_applied:0,latitude:40.87527,longitude:-73.5279},{facility_name:"CITY OF HAMILTON",city:"Hamilton",state:"Alaska",amount_of_biosolids_generated:88,amount_of_biosolids_managed_land_applied:87.5,latitude:34.1083,longitude:-87.9972},{facility_name:"CLINTON PARK WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:87,amount_of_biosolids_managed_land_applied:0,latitude:29.739432,longitude:-95.267198},{facility_name:"CATSKILL (V)",city:"Catskill",state:"N.D.",amount_of_biosolids_generated:87,amount_of_biosolids_managed_land_applied:0,latitude:42.22045,longitude:-73.86597},{facility_name:"FITZGERALD WATER, LIGHT & BOND COMMISSION",city:"Unknown",state:"Ga.",amount_of_biosolids_generated:87,amount_of_biosolids_managed_land_applied:0,latitude:31.67975,longitude:-83.249528},{facility_name:"HARRIS COUNTY MUD 536",city:"Houston",state:"Texas",amount_of_biosolids_generated:86,amount_of_biosolids_managed_land_applied:0,latitude:29.82394,longitude:-95.799002},{facility_name:"FALLBROOK UD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:86,amount_of_biosolids_managed_land_applied:0,latitude:29.911775,longitude:-95.432839},{facility_name:"BROOKSHIRE MWD WWTF",city:"Brookshire",state:"Texas",amount_of_biosolids_generated:86,amount_of_biosolids_managed_land_applied:86.1,latitude:29.778111,longitude:-95.936},{facility_name:"CITY OF KANSAS CITY - WSD",city:"Kansas City",state:"Mo.",amount_of_biosolids_generated:86,amount_of_biosolids_managed_land_applied:0,latitude:39.01323,longitude:-94.52917},{facility_name:"PERU UTILITIES-GRISSOM DIVISION WWTP",city:"Peru",state:"Iowa",amount_of_biosolids_generated:86,amount_of_biosolids_managed_land_applied:85.61,latitude:40.755625,longitude:-86.057105},{facility_name:"ALBION (V)",city:"Albion",state:"N.D.",amount_of_biosolids_generated:86,amount_of_biosolids_managed_land_applied:85.5,latitude:43.247897,longitude:-78.192938},{facility_name:"BELCHERTOWN WWTP",city:"Belchertown",state:"Mass.",amount_of_biosolids_generated:86,amount_of_biosolids_managed_land_applied:0,latitude:42.281579,longitude:-72.42563},{facility_name:"CITY OF WAUKON",city:"Waukon",state:"Hawaii",amount_of_biosolids_generated:85,amount_of_biosolids_managed_land_applied:85.4,latitude:43.27014,longitude:-91.47558},{facility_name:"HOMESTEAD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:85,amount_of_biosolids_managed_land_applied:0,latitude:29.807185,longitude:-95.293568},{facility_name:"OGDENSBURG (C)",city:"Ogdensburg",state:"N.D.",amount_of_biosolids_generated:85,amount_of_biosolids_managed_land_applied:0,latitude:44.69795,longitude:-75.49194},{facility_name:"CITY OF TALLADEGA WATER AND SEWER",city:"Talladega",state:"Alaska",amount_of_biosolids_generated:85,amount_of_biosolids_managed_land_applied:0,latitude:33.4101,longitude:-86.1267},{facility_name:"BLAIRSVILLE WPCP",city:"Blairsville",state:"Ga.",amount_of_biosolids_generated:85,amount_of_biosolids_managed_land_applied:0,latitude:34.874167,longitude:-83.969667},{facility_name:"ROCKY MOUNT STP",city:"Rocky Mount",state:"Utah",amount_of_biosolids_generated:85,amount_of_biosolids_managed_land_applied:0,latitude:36.9969,longitude:-79.8533},{facility_name:"GLENWOOD MUNICIPAL UTILITIES",city:"Glenwood",state:"Hawaii",amount_of_biosolids_generated:84,amount_of_biosolids_managed_land_applied:84.38,latitude:41.046526,longitude:-95.741829},{facility_name:"HARRIS COUNTY MUD 23 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:84,amount_of_biosolids_managed_land_applied:84.33,latitude:29.877311,longitude:-95.517311},{facility_name:"CRYSTAL LAKE STP #3, CITY OF",city:"Crystal Lake",state:"Iowa",amount_of_biosolids_generated:84,amount_of_biosolids_managed_land_applied:84,latitude:42.25038,longitude:-88.30151},{facility_name:"WESLACO SOUTH WWTP",city:"Weslaco",state:"Texas",amount_of_biosolids_generated:84,amount_of_biosolids_managed_land_applied:0,latitude:26.116194,longitude:-98.021083},{facility_name:"GREEN TRAILS MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:84,amount_of_biosolids_managed_land_applied:83.67,latitude:29.757444,longitude:-95.714111},{facility_name:"FULTON (C)",city:"Fulton",state:"N.D.",amount_of_biosolids_generated:83,amount_of_biosolids_managed_land_applied:0,latitude:43.32073,longitude:-76.41614},{facility_name:"AZTEC, CITY OF - WWTP",city:"Aztec",state:"N.D.",amount_of_biosolids_generated:83,amount_of_biosolids_managed_land_applied:0,latitude:36.82275,longitude:-107.99622},{facility_name:"REGIONAL WWTF",city:"Rio Bravo",state:"Texas",amount_of_biosolids_generated:83,amount_of_biosolids_managed_land_applied:0,latitude:27.36687,longitude:-99.501728},{facility_name:"PRASA LAJAS",city:"Lajas",state:"Pa.",amount_of_biosolids_generated:83,amount_of_biosolids_managed_land_applied:82.72,latitude:18.04672464,longitude:-67.0601652},{facility_name:"NW HARRIS CO MUD#'S 21-23 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:83,amount_of_biosolids_managed_land_applied:0,latitude:29.972694,longitude:-95.47825},{facility_name:"HARRIS CO MUD 287 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:82,amount_of_biosolids_managed_land_applied:40.06,latitude:29.825111,longitude:-95.757611},{facility_name:"HARRIS CO MUD 149 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:82,amount_of_biosolids_managed_land_applied:82.19,latitude:29.881056,longitude:-95.656333},{facility_name:"KJC KENTUCKY STATE REFORMATORY",city:"La Grange",state:"Ky.",amount_of_biosolids_generated:82,amount_of_biosolids_managed_land_applied:0,latitude:38.391996,longitude:-85.416022},{facility_name:"NORTHWEST HARRIS COUNTY MUD 10 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:82,amount_of_biosolids_managed_land_applied:72.48,latitude:29.980357,longitude:-95.678026},{facility_name:"GALENA SOUTH STP, CITY OF",city:"Galena",state:"Iowa",amount_of_biosolids_generated:82,amount_of_biosolids_managed_land_applied:36.13,latitude:42.395538,longitude:-90.44103},{facility_name:"KENEDY WWTF",city:"Kenedy",state:"Texas",amount_of_biosolids_generated:81,amount_of_biosolids_managed_land_applied:0,latitude:28.821917,longitude:-97.841389},{facility_name:"RAYFORD ROAD MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:81,amount_of_biosolids_managed_land_applied:80.94,latitude:29.755844,longitude:-95.36659},{facility_name:"HARRIS COUNTY WCID 1 WWTP",city:"Highlands",state:"Texas",amount_of_biosolids_generated:81,amount_of_biosolids_managed_land_applied:0,latitude:29.800194,longitude:-95.05025},{facility_name:"CITY OF ATLANTIC",city:"Atlantic",state:"Hawaii",amount_of_biosolids_generated:81,amount_of_biosolids_managed_land_applied:80.8,latitude:41.39291154,longitude:-94.97882184},{facility_name:"GREENPORT (T)",city:"Hudson",state:"N.D.",amount_of_biosolids_generated:81,amount_of_biosolids_managed_land_applied:0,latitude:42.25639,longitude:-73.75894},{facility_name:"HARRIS CO MUD 412 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:81,amount_of_biosolids_managed_land_applied:0,latitude:29.956083,longitude:-95.213361},{facility_name:"HARRIS COUNTY FWSD 61 WWTP 1",city:"Houston",state:"Texas",amount_of_biosolids_generated:81,amount_of_biosolids_managed_land_applied:0,latitude:29.93932,longitude:-95.61979},{facility_name:"WOODLAND STP",city:"Woodland",state:"Wash.",amount_of_biosolids_generated:81,amount_of_biosolids_managed_land_applied:80.66,latitude:45.90384,longitude:-122.74039},{facility_name:"LUVERNE WASTEWATER TREATMENT FACILITY",city:"Luverne",state:"Minn.",amount_of_biosolids_generated:81,amount_of_biosolids_managed_land_applied:80.64,latitude:43.651378,longitude:-96.199683},{facility_name:"PRASA AIBONITO WWTP",city:"Aibonito",state:"Pa.",amount_of_biosolids_generated:80,amount_of_biosolids_managed_land_applied:0,latitude:18.148561,longitude:-66.278392},{facility_name:"NORTH KOOCHICHING AREA SAN DIS",city:"International Falls",state:"Minn.",amount_of_biosolids_generated:80,amount_of_biosolids_managed_land_applied:80.13,latitude:48.522363,longitude:-93.575209},{facility_name:"HARRIS COUNTY MUD 185 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:80,amount_of_biosolids_managed_land_applied:0,latitude:29.85262,longitude:-95.64008},{facility_name:"MINEOLA WWTF",city:"Mineola",state:"Texas",amount_of_biosolids_generated:80,amount_of_biosolids_managed_land_applied:0,latitude:32.634556,longitude:-95.482444},{facility_name:"INDEPENDENCE WASTEWATER PLANT",city:"Independence",state:"Kan.",amount_of_biosolids_generated:80,amount_of_biosolids_managed_land_applied:80,latitude:37.22884,longitude:-95.692941},{facility_name:"NTUA SHIPROCK WWTP",city:"Shiprock",state:"N.D.",amount_of_biosolids_generated:80,amount_of_biosolids_managed_land_applied:0,latitude:36.808635,longitude:-108.791075},{facility_name:"COHASSET W W T P*",city:"Cohasset",state:"Mass.",amount_of_biosolids_generated:80,amount_of_biosolids_managed_land_applied:0,latitude:42.23554194,longitude:-70.8186245},{facility_name:"PRASA RIO GRANDE ESTATES",city:"Rio Grande",state:"Pa.",amount_of_biosolids_generated:80,amount_of_biosolids_managed_land_applied:0,latitude:18.37242,longitude:-65.86587},{facility_name:"CITY OF JACINTO CITY WWTP",city:"Jacinto City",state:"Texas",amount_of_biosolids_generated:79,amount_of_biosolids_managed_land_applied:0,latitude:29.76746,longitude:-95.25115},{facility_name:"NW HARRIS COUNTY MUD 16 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:79,amount_of_biosolids_managed_land_applied:0,latitude:29.869587,longitude:-95.663968},{facility_name:"CITY OF LA COSTE WWTP",city:"La Coste",state:"Texas",amount_of_biosolids_generated:79,amount_of_biosolids_managed_land_applied:0,latitude:29.308724,longitude:-98.805888},{facility_name:"MILLEY'S CREEK WPCP",city:"Montgomery",state:"Alaska",amount_of_biosolids_generated:79,amount_of_biosolids_managed_land_applied:79,latitude:32.387661,longitude:-86.041448},{facility_name:"TOWASSA WWTP",city:"Montgomery",state:"Alaska",amount_of_biosolids_generated:79,amount_of_biosolids_managed_land_applied:79,latitude:32.39492,longitude:-86.36444},{facility_name:"CITY OF CLANTON",city:"Clanton",state:"Alaska",amount_of_biosolids_generated:79,amount_of_biosolids_managed_land_applied:67.37,latitude:32.847222,longitude:-86.606944},{facility_name:"MILLS ROAD MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:79,amount_of_biosolids_managed_land_applied:0,latitude:29.955722,longitude:-95.571694},{facility_name:"ASHERTON WWTP",city:"Asherton",state:"Texas",amount_of_biosolids_generated:79,amount_of_biosolids_managed_land_applied:0,latitude:28.460444,longitude:-99.750167},{facility_name:"CITY OF THORNDALE WWTP",city:"Thorndale",state:"Texas",amount_of_biosolids_generated:79,amount_of_biosolids_managed_land_applied:0,latitude:30.60575,longitude:-97.201917},{facility_name:"SARALAND CITY OF",city:"Saraland",state:"Alaska",amount_of_biosolids_generated:79,amount_of_biosolids_managed_land_applied:78.85,latitude:30.8138,longitude:-88.0681},{facility_name:"ABERDEEN PROVING GROUND, ABERDEEN AREA WWTP",city:"Aberdeen",state:"Mass.",amount_of_biosolids_generated:79,amount_of_biosolids_managed_land_applied:78.8,latitude:39.52147278,longitude:-76.19573922},{facility_name:"CITY OF ANAMOSA",city:"Anamosa",state:"Hawaii",amount_of_biosolids_generated:79,amount_of_biosolids_managed_land_applied:78.7,latitude:42.108136,longitude:-91.285581},{facility_name:"GAS CITY WWTP",city:"Gas City",state:"Iowa",amount_of_biosolids_generated:79,amount_of_biosolids_managed_land_applied:78.63,latitude:40.48789,longitude:-85.61246},{facility_name:"SPENCER ROAD WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:79,amount_of_biosolids_managed_land_applied:0,latitude:29.880611,longitude:-95.625917},{facility_name:"ADDICKS UD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:79,amount_of_biosolids_managed_land_applied:0,latitude:29.81205,longitude:-95.68392},{facility_name:"MARION W W T F",city:"Marion",state:"Mass.",amount_of_biosolids_generated:79,amount_of_biosolids_managed_land_applied:0,latitude:41.70305,longitude:-70.7786},{facility_name:"SHASTA LAKE WWTP",city:"Shasta Lake",state:"Calif.",amount_of_biosolids_generated:79,amount_of_biosolids_managed_land_applied:0,latitude:40.67347704,longitude:-122.3778198},{facility_name:"PEARL RIVER CO UTILITY AUTHORITY, POPLARVILLE POTW",city:"Poplarville",state:"Mo.",amount_of_biosolids_generated:79,amount_of_biosolids_managed_land_applied:78.54,latitude:30.8325,longitude:-89.541111},{facility_name:"CITY OF KNOXVILLE",city:"Knoxville",state:"Hawaii",amount_of_biosolids_generated:78,amount_of_biosolids_managed_land_applied:78.44,latitude:41.32174,longitude:-93.108105},{facility_name:"NW HARRIS COUNTY MUD 20 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:78,amount_of_biosolids_managed_land_applied:78.39,latitude:30.017222,longitude:-95.485555},{facility_name:"PRASA GUAYANILLA",city:"Guayanilla",state:"Pa.",amount_of_biosolids_generated:78,amount_of_biosolids_managed_land_applied:0,latitude:18.014129,longitude:-66.785022},{facility_name:"OAKWILDE WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:78,amount_of_biosolids_managed_land_applied:78.01,latitude:29.881996,longitude:-95.343803},{facility_name:"PICKENS CO/MIDDLE REG. WWTF",city:"Central",state:"S.C.",amount_of_biosolids_generated:78,amount_of_biosolids_managed_land_applied:78,latitude:34.69217,longitude:-82.76706},{facility_name:"CITY OF VINTON",city:"Vinton",state:"Hawaii",amount_of_biosolids_generated:78,amount_of_biosolids_managed_land_applied:77.8,latitude:42.17271569,longitude:-92.06563703},{facility_name:"CITY OF MARQUEZ WWTP",city:"Marquez",state:"Texas",amount_of_biosolids_generated:78,amount_of_biosolids_managed_land_applied:0,latitude:31.228222,longitude:-96.236333},{facility_name:"FAR HILLS UTILITY DISTRICT WWT",city:"Houston",state:"Texas",amount_of_biosolids_generated:78,amount_of_biosolids_managed_land_applied:0,latitude:30.40395,longitude:-95.55353},{facility_name:"UPPER MONTGOMERY JOINT SEWER A",city:"Pennsburg",state:"Pa.",amount_of_biosolids_generated:78,amount_of_biosolids_managed_land_applied:67.789,latitude:40.38713,longitude:-75.50173},{facility_name:"CITY OF HAMILTON",city:"Hamilton",state:"Mont.",amount_of_biosolids_generated:78,amount_of_biosolids_managed_land_applied:236.2,latitude:46.24534,longitude:-114.15689},{facility_name:"GENESEO (V)",city:"Geneseo",state:"N.D.",amount_of_biosolids_generated:78,amount_of_biosolids_managed_land_applied:0,latitude:42.79522,longitude:-77.81702},{facility_name:"FORT BEND COUNTY MUD 41 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:77,amount_of_biosolids_managed_land_applied:77.2,latitude:29.648055,longitude:-95.664722},{facility_name:"CASTLEWOOD REGIONAL WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:77,amount_of_biosolids_managed_land_applied:77.06,latitude:29.838282,longitude:-95.666778},{facility_name:"METROPOLIS STP, CITY OF",city:"Metropolis",state:"Iowa",amount_of_biosolids_generated:77,amount_of_biosolids_managed_land_applied:0,latitude:37.15367,longitude:-88.73889},{facility_name:"BRAZORIA COUNTY MUD 31 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:77,amount_of_biosolids_managed_land_applied:0,latitude:29.455806,longitude:-95.439639},{facility_name:"PICKENS CO/EIGHTEEN MILE CRK",city:"Liberty",state:"S.C.",amount_of_biosolids_generated:77,amount_of_biosolids_managed_land_applied:77,latitude:34.76083,longitude:-82.68579},{facility_name:"HEMPHILL WWTP",city:"Hemphill",state:"Texas",amount_of_biosolids_generated:77,amount_of_biosolids_managed_land_applied:0,latitude:31.332389,longitude:-93.853417},{facility_name:"EAST PEORIA #3 STP, CITY OF",city:"East Peoria",state:"Iowa",amount_of_biosolids_generated:77,amount_of_biosolids_managed_land_applied:0,latitude:40.70847,longitude:-89.53357},{facility_name:"RODEO PALMS WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:77,amount_of_biosolids_managed_land_applied:76.99,latitude:29.489389,longitude:-95.406861},{facility_name:"CITY OF LA GRANGE WWTP",city:"La Grange",state:"Texas",amount_of_biosolids_generated:77,amount_of_biosolids_managed_land_applied:0,latitude:29.89722,longitude:-96.88174},{facility_name:"CASTLETOP CAPITAL HAYS ABC WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:77,amount_of_biosolids_managed_land_applied:0,latitude:30.0375,longitude:-97.8125},{facility_name:"NORTH MIDDLETON AUTHORITY",city:"Carlisle",state:"Pa.",amount_of_biosolids_generated:76,amount_of_biosolids_managed_land_applied:76.38,latitude:40.239392,longitude:-77.176248},{facility_name:"HERON LAKE WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:76,amount_of_biosolids_managed_land_applied:0,latitude:29.93239,longitude:-95.545588},{facility_name:"CITY OF WEBSTER CITY",city:"Webster City",state:"Hawaii",amount_of_biosolids_generated:76,amount_of_biosolids_managed_land_applied:76.2,latitude:42.468655,longitude:-93.83660439},{facility_name:"LIVE OAK WWTF",city:"Live Oak",state:"Fla.",amount_of_biosolids_generated:76,amount_of_biosolids_managed_land_applied:75.89,latitude:30.30792,longitude:-82.99205},{facility_name:"TOWN OF PONDER WWTP",city:"Ponder",state:"Texas",amount_of_biosolids_generated:76,amount_of_biosolids_managed_land_applied:0,latitude:33.171453,longitude:-97.286351},{facility_name:"NARRAGANSETT TOWN HALL",city:"Narragansett",state:"R.I.",amount_of_biosolids_generated:75,amount_of_biosolids_managed_land_applied:0,latitude:41.43017,longitude:-71.46445},{facility_name:"STONY POINT (T)",city:"Stony Point",state:"N.D.",amount_of_biosolids_generated:75,amount_of_biosolids_managed_land_applied:85.35,latitude:41.22894,longitude:-73.98478},{facility_name:"ISABELLA RESERVATION WWTP",city:"Mount Pleasant",state:"Mich.",amount_of_biosolids_generated:75,amount_of_biosolids_managed_land_applied:57.2,latitude:43.604548,longitude:-84.7067},{facility_name:"FERNDALE STP",city:"Ferndale",state:"Wash.",amount_of_biosolids_generated:75,amount_of_biosolids_managed_land_applied:74.9,latitude:48.837747,longitude:-122.596554},{facility_name:"NW HARRIS COUNTY MUD 29 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:75,amount_of_biosolids_managed_land_applied:0,latitude:29.91054,longitude:-95.60554},{facility_name:"OIL CITY - STP",city:"Oil City",state:"Pa.",amount_of_biosolids_generated:74,amount_of_biosolids_managed_land_applied:0,latitude:41.433,longitude:-79.70823},{facility_name:"CITY OF SUNRISE UTILITIES DEPARTMENT - SOUTHWEST WWTF",city:"Davie",state:"Fla.",amount_of_biosolids_generated:74,amount_of_biosolids_managed_land_applied:0,latitude:26.05777173,longitude:-80.36996267},{facility_name:"WINFIELD, CITY OF",city:"Winfield",state:"Kan.",amount_of_biosolids_generated:74,amount_of_biosolids_managed_land_applied:73.63,latitude:37.25907685,longitude:-96.9107652},{facility_name:"CITY OF HAMILTON WWTP",city:"Hamilton",state:"Texas",amount_of_biosolids_generated:73,amount_of_biosolids_managed_land_applied:0,latitude:31.70868,longitude:-98.115072},{facility_name:"WOODLAND OAKS WWTP",city:"Conroe",state:"Texas",amount_of_biosolids_generated:73,amount_of_biosolids_managed_land_applied:0,latitude:30.235472,longitude:-95.574083},{facility_name:"LAURENS CO W&S/CLINTON-JOANNA",city:"Joanna",state:"S.C.",amount_of_biosolids_generated:73,amount_of_biosolids_managed_land_applied:73,latitude:34.391111,longitude:-81.810833},{facility_name:"CITY OF GASTONIA",city:"Gastonia",state:"Mont.",amount_of_biosolids_generated:73,amount_of_biosolids_managed_land_applied:72.95,latitude:35.236761,longitude:-81.061509},{facility_name:"HARVEST GREEN WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:73,amount_of_biosolids_managed_land_applied:0,latitude:29.629722,longitude:-95.71722},{facility_name:"ROUSES POINT (V)",city:"Rouses Point",state:"N.D.",amount_of_biosolids_generated:72,amount_of_biosolids_managed_land_applied:0,latitude:44.99043464,longitude:-73.37585035},{facility_name:"TINICUM TOWNSHIP WTP",city:"Lester",state:"Pa.",amount_of_biosolids_generated:72,amount_of_biosolids_managed_land_applied:0,latitude:39.8727,longitude:-75.29098},{facility_name:"CITY OF HEARNE WWTP 2",city:"Hearne",state:"Texas",amount_of_biosolids_generated:72,amount_of_biosolids_managed_land_applied:72.3,latitude:30.856583,longitude:-96.602278},{facility_name:"HELENDALE SILVERLAKES STP",city:"Helendale",state:"Calif.",amount_of_biosolids_generated:72,amount_of_biosolids_managed_land_applied:0,latitude:34.77537,longitude:-117.3285},{facility_name:"CELINA WWTP",city:"Celina",state:"Texas",amount_of_biosolids_generated:72,amount_of_biosolids_managed_land_applied:0,latitude:33.331972,longitude:-96.794028},{facility_name:"MCI NORFOLK-WALPOLE WWTF",city:"Norfolk",state:"Mass.",amount_of_biosolids_generated:72,amount_of_biosolids_managed_land_applied:0,latitude:42.129512,longitude:-71.309612},{facility_name:"GENERATION PARK MANAGEMENT DISTRICT WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:72,amount_of_biosolids_managed_land_applied:0,latitude:29.923431,longitude:-95.214344},{facility_name:"NW HARRIS COUNTY MUD 5 PLANT 2",city:"Houston",state:"Texas",amount_of_biosolids_generated:72,amount_of_biosolids_managed_land_applied:0,latitude:30.02222,longitude:-95.647777},{facility_name:"CITY OF GIDDINGS SOUTH WWTP",city:"Giddings",state:"Texas",amount_of_biosolids_generated:71,amount_of_biosolids_managed_land_applied:0,latitude:30.160194,longitude:-96.936361},{facility_name:"DEFUNIAK SPRINGS, CITY OF - WWTP",city:"Defuniak Springs",state:"Fla.",amount_of_biosolids_generated:71,amount_of_biosolids_managed_land_applied:71.46,latitude:30.72698,longitude:-86.1089},{facility_name:"HARRIS COUNTY MUD 371 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:71,amount_of_biosolids_managed_land_applied:0,latitude:29.92847,longitude:-95.8079},{facility_name:"HARRIS COUNTY MUD 11 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:71,amount_of_biosolids_managed_land_applied:0,latitude:29.934877,longitude:-95.459191},{facility_name:"NORTH GREEN MUD WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:71,amount_of_biosolids_managed_land_applied:0,latitude:29.952294,longitude:-95.38655},{facility_name:"STANLY COUNTY",city:"Albemarle",state:"Mont.",amount_of_biosolids_generated:71,amount_of_biosolids_managed_land_applied:71,latitude:35.235773,longitude:-80.268946},{facility_name:"VANPORT TOWNSHIP MUNICIPAL AUT",city:"Vanport",state:"Pa.",amount_of_biosolids_generated:71,amount_of_biosolids_managed_land_applied:71,latitude:40.685343,longitude:-80.322697},{facility_name:"WHARTON WWTP 1",city:"Wharton",state:"Texas",amount_of_biosolids_generated:71,amount_of_biosolids_managed_land_applied:0,latitude:29.301642,longitude:-96.098034},{facility_name:"PETERS TOWNSHIP SANITARY AUTHORITY",city:"Mcmurray",state:"Pa.",amount_of_biosolids_generated:71,amount_of_biosolids_managed_land_applied:0,latitude:40.28149,longitude:-80.07855},{facility_name:"CATASAUQUA BOROUGH AUTHORITY",city:"Catasauqua",state:"Pa.",amount_of_biosolids_generated:71,amount_of_biosolids_managed_land_applied:0,latitude:40.65367,longitude:-75.47423},{facility_name:"CITY OF CARRIZO SPRINGS WWTP",city:"Carrizo Springs",state:"Texas",amount_of_biosolids_generated:71,amount_of_biosolids_managed_land_applied:0,latitude:28.525271,longitude:-99.85036},{facility_name:"SPRING CREEK UD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:71,amount_of_biosolids_managed_land_applied:70.87,latitude:30.110365,longitude:-95.405316},{facility_name:"EMERALD FOREST UD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:71,amount_of_biosolids_managed_land_applied:0,latitude:29.951302,longitude:-95.3407},{facility_name:"CITY OF NASSAU BAY WWTP",city:"Nassau Bay",state:"Texas",amount_of_biosolids_generated:71,amount_of_biosolids_managed_land_applied:0,latitude:29.533582,longitude:-95.090506},{facility_name:"CENTRAL WWTF",city:"Bacliff",state:"Texas",amount_of_biosolids_generated:71,amount_of_biosolids_managed_land_applied:0,latitude:29.50603,longitude:-94.99056},{facility_name:"FT BEND COUNTY MUD 185 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:70,amount_of_biosolids_managed_land_applied:66.9261563,latitude:29.735881,longitude:-95.794749},{facility_name:"PRESTONWOOD FOREST UD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:70,amount_of_biosolids_managed_land_applied:70.3216745,latitude:29.985703,longitude:-95.56147},{facility_name:"BRIDGESTONE FACILITY",city:"Houston",state:"Texas",amount_of_biosolids_generated:70,amount_of_biosolids_managed_land_applied:0,latitude:30.058333,longitude:-95.486944},{facility_name:"CITY OF MILLBROOK",city:"Millbrook",state:"Alaska",amount_of_biosolids_generated:70,amount_of_biosolids_managed_land_applied:69.88,latitude:32.5259,longitude:-86.3648},{facility_name:"LAGUNA MADRE WWTP",city:"Corpus Christi",state:"Texas",amount_of_biosolids_generated:70,amount_of_biosolids_managed_land_applied:0,latitude:27.671722,longitude:-97.270036},{facility_name:"PANA STP, CITY OF",city:"Pana",state:"Iowa",amount_of_biosolids_generated:70,amount_of_biosolids_managed_land_applied:66.2,latitude:39.368889,longitude:-89.086389},{facility_name:"WILLOW CREEK FARMS MUD WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:70,amount_of_biosolids_managed_land_applied:69.629867,latitude:29.773851,longitude:-95.890669},{facility_name:"ROLLING CREEK UD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:70,amount_of_biosolids_managed_land_applied:0,latitude:29.836389,longitude:-95.689972},{facility_name:"NORTHWEST FREEWAY MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:70,amount_of_biosolids_managed_land_applied:0,latitude:30.026861,longitude:-95.803},{facility_name:"OROFINO, CITY OF",city:"Orofino",state:"Iowa",amount_of_biosolids_generated:69,amount_of_biosolids_managed_land_applied:0,latitude:46.487385,longitude:-116.267884},{facility_name:"TRESCHWIG CENTRAL WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:69,amount_of_biosolids_managed_land_applied:68.9570446,latitude:30.035114,longitude:-95.362508},{facility_name:"HARRIS COUNTY MUD 70 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:69,amount_of_biosolids_managed_land_applied:68.63,latitude:29.746033,longitude:-95.4654},{facility_name:"CYPRESS HILL MUD 1 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:68,amount_of_biosolids_managed_land_applied:0,latitude:29.981306,longitude:-95.700778},{facility_name:"CITY OF CASTROVILLE WWTF",city:"Castroville",state:"Texas",amount_of_biosolids_generated:68,amount_of_biosolids_managed_land_applied:0,latitude:29.343888,longitude:-98.884166},{facility_name:"FORT BEND CNTY MUD 34 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:68,amount_of_biosolids_managed_land_applied:68.08,latitude:29.701111,longitude:-95.793055},{facility_name:"HARRIS COUNTY MUD 391 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:68,amount_of_biosolids_managed_land_applied:67.83,latitude:29.990087,longitude:-95.721404},{facility_name:"WILBARGER CREEK MUD 2 WWTF",city:"Austin",state:"Texas",amount_of_biosolids_generated:68,amount_of_biosolids_managed_land_applied:0,latitude:30.343089,longitude:-97.54084},{facility_name:"HARRIS COUNTY ID 18 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:68,amount_of_biosolids_managed_land_applied:65.2702936,latitude:30.088303,longitude:-95.437744},{facility_name:"MULVANE, CITY OF",city:"Mulvane",state:"Kan.",amount_of_biosolids_generated:68,amount_of_biosolids_managed_land_applied:67.5,latitude:37.475751,longitude:-97.244749},{facility_name:"SPRING CYPRESS SHOPPING CENTER WWTP",city:"New Waverly",state:"Texas",amount_of_biosolids_generated:67,amount_of_biosolids_managed_land_applied:0,latitude:29.972722,longitude:-95.689111},{facility_name:"HARRIS COUNTY MUD 24 WWTP",city:"Bellaire",state:"Texas",amount_of_biosolids_generated:67,amount_of_biosolids_managed_land_applied:0,latitude:30.031806,longitude:-95.526694},{facility_name:"FORT BEND COUNTY MUD 190 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:67,amount_of_biosolids_managed_land_applied:0,latitude:29.7302,longitude:-95.42877},{facility_name:"FRUITA CITY OF",city:"Fruita",state:"Colo.",amount_of_biosolids_generated:67,amount_of_biosolids_managed_land_applied:0,latitude:39.158892,longitude:-108.731073},{facility_name:"CITY OF CENTERVILLE",city:"Centerville",state:"Hawaii",amount_of_biosolids_generated:67,amount_of_biosolids_managed_land_applied:67.2,latitude:40.73252,longitude:-92.871824},{facility_name:"FULSHEAR MUD 3B WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:67,amount_of_biosolids_managed_land_applied:0,latitude:29.756944,longitude:-95.911944},{facility_name:"GROESBECK WTP",city:"Groesbeck",state:"Texas",amount_of_biosolids_generated:67,amount_of_biosolids_managed_land_applied:0,latitude:31.574611,longitude:-96.520806},{facility_name:"CITY OF HUMBOLDT",city:"Humboldt",state:"Hawaii",amount_of_biosolids_generated:67,amount_of_biosolids_managed_land_applied:455.85,latitude:42.72028,longitude:-94.21448},{facility_name:"CAREY STATION URBAN WATER REUSE FACILITY",city:"Greensboro",state:"Ga.",amount_of_biosolids_generated:67,amount_of_biosolids_managed_land_applied:67,latitude:33.495879,longitude:-83.246859},{facility_name:"BROOKINGS, CITY OF",city:"Brookings",state:"Ore.",amount_of_biosolids_generated:67,amount_of_biosolids_managed_land_applied:67,latitude:42.04707,longitude:-124.287909},{facility_name:"CITY OF EMMETSBURG",city:"Emmetsburg",state:"Hawaii",amount_of_biosolids_generated:67,amount_of_biosolids_managed_land_applied:66.95,latitude:43.10917,longitude:-94.67953},{facility_name:"CITY OF JASPER",city:"Jasper",state:"Fla.",amount_of_biosolids_generated:67,amount_of_biosolids_managed_land_applied:66.89,latitude:30.505711,longitude:-82.949461},{facility_name:"FORT BEND COUNTY MUD 118 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:67,amount_of_biosolids_managed_land_applied:66.6376209,latitude:29.645486,longitude:-95.728329},{facility_name:"MINDEN, CITY OF",city:"Minden",state:"La.",amount_of_biosolids_generated:67,amount_of_biosolids_managed_land_applied:0,latitude:32.581278,longitude:-93.297405},{facility_name:"HARRIS COUNTY MUD 495 WWTP 2",city:"Houston",state:"Texas",amount_of_biosolids_generated:66,amount_of_biosolids_managed_land_applied:0,latitude:29.859166,longitude:-95.81888},{facility_name:"HERITAGE VILLAGE COMPANY",city:"Southbury",state:"Conn.",amount_of_biosolids_generated:66,amount_of_biosolids_managed_land_applied:0,latitude:41.48477,longitude:-73.22364},{facility_name:"WAVERLY WWTF",city:"Waverly",state:"Neb.",amount_of_biosolids_generated:66,amount_of_biosolids_managed_land_applied:66.01,latitude:40.935205,longitude:-96.521068},{facility_name:"EASLEY/GEORGES CREEK LAGOON",city:"Easley",state:"S.C.",amount_of_biosolids_generated:66,amount_of_biosolids_managed_land_applied:66,latitude:34.844722,longitude:-82.588611},{facility_name:"CITY OF WALCOTT",city:"Walcott",state:"Hawaii",amount_of_biosolids_generated:66,amount_of_biosolids_managed_land_applied:0,latitude:41.59292408,longitude:-90.77460135},{facility_name:"CENTERVILLE STP",city:"Centerville",state:"Tenn.",amount_of_biosolids_generated:66,amount_of_biosolids_managed_land_applied:38.7,latitude:35.8197,longitude:-87.6042},{facility_name:"JAMESTOWN STP",city:"Jamestown",state:"Tenn.",amount_of_biosolids_generated:65,amount_of_biosolids_managed_land_applied:65.46,latitude:36.42078,longitude:-84.94592},{facility_name:"BRAZORIA COUNTY MUD 25 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:65,amount_of_biosolids_managed_land_applied:65.27,latitude:29.530194,longitude:-95.388444},{facility_name:"MILLSTADT STP, VILLAGE OF",city:"Millstadt",state:"Iowa",amount_of_biosolids_generated:65,amount_of_biosolids_managed_land_applied:47.25,latitude:38.4586,longitude:-90.088},{facility_name:"GALVESTON COUNTY WCID 8",city:"Santa Fe",state:"Texas",amount_of_biosolids_generated:65,amount_of_biosolids_managed_land_applied:0,latitude:29.375809,longitude:-95.07495},{facility_name:"SPRING WEST MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:65,amount_of_biosolids_managed_land_applied:0,latitude:30.0705,longitude:-95.453694},{facility_name:"CITY OF MADISON",city:"Madison",state:"Ga.",amount_of_biosolids_generated:65,amount_of_biosolids_managed_land_applied:64.75,latitude:33.546,longitude:-83.49225},{facility_name:"HARRIS FORT BEND COUNTIES MUD 3 WW",city:"Houston",state:"Texas",amount_of_biosolids_generated:65,amount_of_biosolids_managed_land_applied:14.76,latitude:29.779184,longitude:-95.790638},{facility_name:"CARMI WWTP, CITY OF",city:"Carmi",state:"Iowa",amount_of_biosolids_generated:65,amount_of_biosolids_managed_land_applied:64.737,latitude:38.0647,longitude:-88.1706},{facility_name:"GE HYDRIL WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:65,amount_of_biosolids_managed_land_applied:0,latitude:29.93882,longitude:-95.33605},{facility_name:"TOMBALL NORTH WWTP",city:"Tomball",state:"Texas",amount_of_biosolids_generated:64,amount_of_biosolids_managed_land_applied:64.4,latitude:30.111389,longitude:-95.610278},{facility_name:"MOUNTAIN CITY STP",city:"Mountain City",state:"Tenn.",amount_of_biosolids_generated:64,amount_of_biosolids_managed_land_applied:0,latitude:36.43013,longitude:-81.80252},{facility_name:"CITY OF RED OAK",city:"Red Oak",state:"Hawaii",amount_of_biosolids_generated:64,amount_of_biosolids_managed_land_applied:95.87,latitude:41.007,longitude:-95.223327},{facility_name:"CITY OF CRYSTAL CITY",city:"Sabinal",state:"Texas",amount_of_biosolids_generated:64,amount_of_biosolids_managed_land_applied:0,latitude:28.6969,longitude:-99.8176},{facility_name:"SCAPPOOSE, CITY OF",city:"Scappoose",state:"Ore.",amount_of_biosolids_generated:64,amount_of_biosolids_managed_land_applied:70,latitude:45.752635,longitude:-122.856076},{facility_name:"BEECHNUT MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:63,amount_of_biosolids_managed_land_applied:0,latitude:29.68867,longitude:-95.62633},{facility_name:"WARTBURG STP",city:"Wartburg",state:"Tenn.",amount_of_biosolids_generated:63,amount_of_biosolids_managed_land_applied:63.2,latitude:36.083965,longitude:-84.555494},{facility_name:"CITY OF DIBOLL WWTP",city:"Diboll",state:"Texas",amount_of_biosolids_generated:63,amount_of_biosolids_managed_land_applied:0,latitude:31.16659,longitude:-94.797446},{facility_name:"CHEROKEE COUNTY WATER & SEWER AUTHORITY (RIVERBEND WWTP)",city:"Ball Ground",state:"Ga.",amount_of_biosolids_generated:63,amount_of_biosolids_managed_land_applied:0,latitude:34.29193,longitude:-84.38933},{facility_name:"GREENWOOD UD - WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:63,amount_of_biosolids_managed_land_applied:0,latitude:29.84986,longitude:-95.22642},{facility_name:"MONTGOMERY COUNTY MUD 19 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:63,amount_of_biosolids_managed_land_applied:0,latitude:30.126194,longitude:-95.443917},{facility_name:"SCOTT AIR FORCE BASE",city:"Scott Air Force Base",state:"Iowa",amount_of_biosolids_generated:63,amount_of_biosolids_managed_land_applied:58.3,latitude:38.551625,longitude:-89.848048},{facility_name:"CITY OF CADDO MILLS WWTF",city:"Caddo Mills",state:"Texas",amount_of_biosolids_generated:63,amount_of_biosolids_managed_land_applied:0,latitude:33.042312,longitude:-96.216144},{facility_name:"FARMERSVILLE WWTP 1",city:"Farmersville",state:"Texas",amount_of_biosolids_generated:63,amount_of_biosolids_managed_land_applied:0,latitude:33.155667,longitude:-96.374694},{facility_name:"BLUE RIDGE WEST MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:62,amount_of_biosolids_managed_land_applied:0,latitude:29.600355,longitude:-95.509987},{facility_name:"HARRIS COUNTY MUD 171 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:62,amount_of_biosolids_managed_land_applied:0,latitude:29.86,longitude:-95.783333},{facility_name:"MCCRAY MEADOWS WWTP 1",city:"Houston",state:"Texas",amount_of_biosolids_generated:62,amount_of_biosolids_managed_land_applied:62.064168,latitude:29.646388,longitude:-95.769166},{facility_name:"CITY OF OAKLAND",city:"Oakland",state:"Tenn.",amount_of_biosolids_generated:62,amount_of_biosolids_managed_land_applied:62,latitude:35.222975,longitude:-89.522953},{facility_name:"BRIAR CREEK WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:62,amount_of_biosolids_managed_land_applied:0,latitude:30.327222,longitude:-97.527583},{facility_name:"CITY OF ALEDO WWTP",city:"Aledo",state:"Texas",amount_of_biosolids_generated:62,amount_of_biosolids_managed_land_applied:0,latitude:32.68563,longitude:-97.60905},{facility_name:"SIDNEY (V)",city:"Sidney",state:"N.D.",amount_of_biosolids_generated:62,amount_of_biosolids_managed_land_applied:0,latitude:42.31673,longitude:-75.38999},{facility_name:"PAOLA, CITY OF",city:"Paola",state:"Kan.",amount_of_biosolids_generated:62,amount_of_biosolids_managed_land_applied:61.68,latitude:38.59251417,longitude:-94.85147678},{facility_name:"JACKSON POTW - TRAHON/BIG CREEK",city:"Jackson",state:"Mo.",amount_of_biosolids_generated:62,amount_of_biosolids_managed_land_applied:61.67,latitude:32.152167,longitude:-90.263889},{facility_name:"FORT BEND MUD 26 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:62,amount_of_biosolids_managed_land_applied:0,latitude:29.591189,longitude:-95.521027},{facility_name:"FONDREN ROAD WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:61,amount_of_biosolids_managed_land_applied:0,latitude:29.63151,longitude:-95.51565},{facility_name:"CITY OF WINNSBORO WWTP",city:"Winnsboro",state:"Texas",amount_of_biosolids_generated:61,amount_of_biosolids_managed_land_applied:2.45,latitude:32.930556,longitude:-95.298806},{facility_name:"CITY OF CLARINDA",city:"Clarinda",state:"Hawaii",amount_of_biosolids_generated:61,amount_of_biosolids_managed_land_applied:61.13,latitude:40.73813,longitude:-95.02616824},{facility_name:"CITY OF MANVEL WWTP",city:"Manvel",state:"Texas",amount_of_biosolids_generated:61,amount_of_biosolids_managed_land_applied:0,latitude:29.47372,longitude:-95.3703},{facility_name:"CLYDE WWTP",city:"Clyde",state:"Texas",amount_of_biosolids_generated:61,amount_of_biosolids_managed_land_applied:0,latitude:32.378624,longitude:-99.481188},{facility_name:"CITY OF RAYMONDVILLE WWTP",city:"Raymondville",state:"Texas",amount_of_biosolids_generated:61,amount_of_biosolids_managed_land_applied:0,latitude:26.489917,longitude:-97.772806},{facility_name:"BRUSH CITY OF",city:"Brush",state:"Colo.",amount_of_biosolids_generated:60,amount_of_biosolids_managed_land_applied:60.47,latitude:40.258598,longitude:-103.6323475},{facility_name:"LEO L. DUBOIS WPCF - BRIDGEWATER CORRECTION COMPLEX",city:"Bridgewater",state:"Mass.",amount_of_biosolids_generated:60,amount_of_biosolids_managed_land_applied:0,latitude:41.945123,longitude:-70.951715},{facility_name:"RIVERSIDE WATER RECLAMAT AUTH",city:"Riverside",state:"Neb.",amount_of_biosolids_generated:60,amount_of_biosolids_managed_land_applied:0,latitude:40.03901,longitude:-74.96548},{facility_name:"CITY OF BUTLER",city:"Butler",state:"Mo.",amount_of_biosolids_generated:60,amount_of_biosolids_managed_land_applied:60.12,latitude:38.258504,longitude:-94.332079},{facility_name:"DE SOTO, CITY OF (WWTP)",city:"De Soto",state:"Kan.",amount_of_biosolids_generated:60,amount_of_biosolids_managed_land_applied:60,latitude:38.98162,longitude:-94.99375},{facility_name:"WHITEWATER RIVER REGIONAL WWTF",city:"Saint Charles",state:"Minn.",amount_of_biosolids_generated:60,amount_of_biosolids_managed_land_applied:59.862,latitude:43.9776105,longitude:-92.06188892},{facility_name:"PRASA SAN SEBASTIAN WWTP",city:"San Sebastian",state:"Pa.",amount_of_biosolids_generated:60,amount_of_biosolids_managed_land_applied:0,latitude:18.345348,longitude:-67.01764},{facility_name:"ATTICA (V)",city:"Attica",state:"N.D.",amount_of_biosolids_generated:60,amount_of_biosolids_managed_land_applied:146.05,latitude:42.86447,longitude:-78.28306},{facility_name:"TOWN OF RAMSEUR",city:"Ramseur",state:"Mont.",amount_of_biosolids_generated:60,amount_of_biosolids_managed_land_applied:59.45,latitude:35.73288,longitude:-79.65353},{facility_name:"PALMER PLANTATION MUD 1 REGIONAL WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:60,amount_of_biosolids_managed_land_applied:0,latitude:29.551636,longitude:-95.539408},{facility_name:"CITY OF ROMA 2 WWTP",city:"Roma",state:"Texas",amount_of_biosolids_generated:59,amount_of_biosolids_managed_land_applied:59.47,latitude:26.394334,longitude:-99.00178},{facility_name:"HOGANSVILLE, CITY OF (HOGANSVILLE WPCP)",city:"Hogansville",state:"Ga.",amount_of_biosolids_generated:59,amount_of_biosolids_managed_land_applied:0,latitude:33.154316,longitude:-84.938434},{facility_name:"HIDALGO COUNTY MUD NO 1 WASTEWATER TREATMENT FACILITY",city:"Mission",state:"Texas",amount_of_biosolids_generated:59,amount_of_biosolids_managed_land_applied:0,latitude:26.250317,longitude:-98.395714},{facility_name:"WEST LAKE HOUSTON WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:59,amount_of_biosolids_managed_land_applied:0,latitude:29.971665,longitude:-95.165237},{facility_name:"ST CLAIR WWTF",city:"St. Clair",state:"Mo.",amount_of_biosolids_generated:59,amount_of_biosolids_managed_land_applied:59.05,latitude:38.3213,longitude:-90.998505},{facility_name:"MONTGOMERY COUNTY MUD 96",city:"Houston",state:"Texas",amount_of_biosolids_generated:59,amount_of_biosolids_managed_land_applied:0,latitude:30.0725,longitude:-95.263333},{facility_name:"FAIRGREEN WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:59,amount_of_biosolids_managed_land_applied:58.9059,latitude:29.919271,longitude:-95.326373},{facility_name:"CITY OF NEW HAMPTON",city:"New Hampton",state:"Hawaii",amount_of_biosolids_generated:59,amount_of_biosolids_managed_land_applied:58.89,latitude:43.058401,longitude:-92.314064},{facility_name:"CITY OF BLOUNTSTOWN",city:"Blountstown",state:"Fla.",amount_of_biosolids_generated:59,amount_of_biosolids_managed_land_applied:58.86,latitude:30.433683,longitude:-85.048897},{facility_name:"RUSSELL COUNTY REGIONAL STP",city:"Jamestown",state:"Ky.",amount_of_biosolids_generated:58,amount_of_biosolids_managed_land_applied:0,latitude:36.946111,longitude:-85.020833},{facility_name:"TOWN OF WELDON",city:"Weldon",state:"Mont.",amount_of_biosolids_generated:58,amount_of_biosolids_managed_land_applied:58,latitude:36.4235,longitude:-77.5775},{facility_name:"NEWPORT, CITY OF-HWY 14",city:"Newport",state:"Alaska",amount_of_biosolids_generated:58,amount_of_biosolids_managed_land_applied:57.98,latitude:35.60356,longitude:-91.28383},{facility_name:"MADISON, CITY OF (BIOSOLIDS)",city:"Madison, City Of",state:"S.D.",amount_of_biosolids_generated:58,amount_of_biosolids_managed_land_applied:0,latitude:43.990841,longitude:-97.092349},{facility_name:"CITY OF LIBERTY MAIN WWTP",city:"Liberty",state:"Texas",amount_of_biosolids_generated:58,amount_of_biosolids_managed_land_applied:0,latitude:30.050174,longitude:-94.801609},{facility_name:"CRANDALL WWTP",city:"Crandall",state:"Texas",amount_of_biosolids_generated:58,amount_of_biosolids_managed_land_applied:0,latitude:32.609306,longitude:-96.457111},{facility_name:"WALDEN (V)",city:"Walden",state:"N.D.",amount_of_biosolids_generated:57,amount_of_biosolids_managed_land_applied:0,latitude:41.56139478,longitude:-74.16928811},{facility_name:"JOHNSON COUNTY SUD WWTP",city:"Cleburne",state:"Texas",amount_of_biosolids_generated:57,amount_of_biosolids_managed_land_applied:0,latitude:32.497105,longitude:-97.351913},{facility_name:"TOWANDA MUN AUTH",city:"Towanda",state:"Pa.",amount_of_biosolids_generated:57,amount_of_biosolids_managed_land_applied:0,latitude:41.762503,longitude:-76.44303},{facility_name:"NOTTINGHAM COUNTRY MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:57,amount_of_biosolids_managed_land_applied:0,latitude:29.755844,longitude:-95.36659},{facility_name:"CITY OF CLIFTON WWTF",city:"Clifton",state:"Texas",amount_of_biosolids_generated:57,amount_of_biosolids_managed_land_applied:0,latitude:31.783694,longitude:-97.567417},{facility_name:"1ST SPECIAL OPERATIONS CIVIL ENGINEER SQUADRON",city:"Hurlburt Field",state:"Fla.",amount_of_biosolids_generated:57,amount_of_biosolids_managed_land_applied:56.866,latitude:30.417251,longitude:-86.695784},{facility_name:"ENCANTO REAL UD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:57,amount_of_biosolids_managed_land_applied:56.7660995,latitude:30.107647,longitude:-95.487783},{facility_name:"HARRIS COUNTY WCID 84 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:57,amount_of_biosolids_managed_land_applied:0,latitude:29.8015,longitude:-95.115167},{facility_name:"MONTGOMERY CO MUD 139 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:56,amount_of_biosolids_managed_land_applied:56.4843481,latitude:30.264066,longitude:-95.514505},{facility_name:"CENTRALIA STP",city:"Centralia",state:"Wash.",amount_of_biosolids_generated:56,amount_of_biosolids_managed_land_applied:0,latitude:46.759084,longitude:-123.019152},{facility_name:"GUAM WATERWORKS AUTHORITY",city:"Hagatna",state:"Ga.",amount_of_biosolids_generated:56,amount_of_biosolids_managed_land_applied:0,latitude:13.4382999,longitude:144.7729285},{facility_name:"WEST PARK MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:56,amount_of_biosolids_managed_land_applied:0,latitude:29.785583,longitude:-95.708067},{facility_name:"SIENNA PLANTATION WWTP",city:"Missouri City",state:"Texas",amount_of_biosolids_generated:56,amount_of_biosolids_managed_land_applied:0,latitude:29.536611,longitude:-95.550472},{facility_name:"MEADOWS WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:56,amount_of_biosolids_managed_land_applied:55.72,latitude:29.899028,longitude:-95.332222},{facility_name:"ALDINE VILLAGE WWTP",city:"New Waverly",state:"Texas",amount_of_biosolids_generated:56,amount_of_biosolids_managed_land_applied:0,latitude:29.91484,longitude:-95.38405},{facility_name:"CITY OF SMITHVILLE",city:"Smithville",state:"Mo.",amount_of_biosolids_generated:56,amount_of_biosolids_managed_land_applied:55.5,latitude:39.387143,longitude:-94.581722},{facility_name:"WAUCHULA CITY OF WWTF",city:"Wauchula",state:"Fla.",amount_of_biosolids_generated:55,amount_of_biosolids_managed_land_applied:55.3,latitude:27.54741,longitude:-81.80003},{facility_name:"WILLIAM H PORTER WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:55,amount_of_biosolids_managed_land_applied:0,latitude:29.854861,longitude:-95.615639},{facility_name:"CITY OF YOAKUM WWTP",city:"Yoakum",state:"Texas",amount_of_biosolids_generated:55,amount_of_biosolids_managed_land_applied:0,latitude:29.273,longitude:-97.157472},{facility_name:"BOOTHBAY HARBOR SEWER DISTRICT",city:"Boothbay Harbor",state:"Mass.",amount_of_biosolids_generated:55,amount_of_biosolids_managed_land_applied:0,latitude:43.85187,longitude:-69.63204},{facility_name:"SELBYVILLE STP",city:"Selbyville",state:"D.C.",amount_of_biosolids_generated:55,amount_of_biosolids_managed_land_applied:54.93,latitude:38.471333,longitude:-75.2185},{facility_name:"BYRON STP, CITY OF",city:"Byron",state:"Iowa",amount_of_biosolids_generated:55,amount_of_biosolids_managed_land_applied:54.75,latitude:42.123333,longitude:-89.253333},{facility_name:"MADISON (CITY OF) SOUTHSIDE WPCP",city:"Madison",state:"Ga.",amount_of_biosolids_generated:55,amount_of_biosolids_managed_land_applied:54.7,latitude:33.586556,longitude:-83.448833},{facility_name:"PRASA COMERIO WASTE WATER TREA",city:"Comerio",state:"Pa.",amount_of_biosolids_generated:55,amount_of_biosolids_managed_land_applied:0,latitude:18.2425,longitude:-66.206111},{facility_name:"BONNIE BRAE FOREST MANOR SD",city:"Lockport",state:"Iowa",amount_of_biosolids_generated:55,amount_of_biosolids_managed_land_applied:54.56,latitude:41.59846,longitude:-88.04059},{facility_name:"NEW CASTLE WWTF",city:"New Castle",state:"Colo.",amount_of_biosolids_generated:54,amount_of_biosolids_managed_land_applied:35.93,latitude:39.57013,longitude:-107.53869},{facility_name:"ALBION - STP",city:"Albion",state:"Pa.",amount_of_biosolids_generated:54,amount_of_biosolids_managed_land_applied:0,latitude:41.89141,longitude:-80.36506},{facility_name:"FORT BEND COUNTY MUD 5",city:"Houston",state:"Texas",amount_of_biosolids_generated:54,amount_of_biosolids_managed_land_applied:54.31,latitude:29.493348,longitude:-95.809264},{facility_name:"HARRIS COUNTY WCID 76 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:54,amount_of_biosolids_managed_land_applied:0,latitude:29.913516,longitude:-95.291457},{facility_name:"HCO MWD 71 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:54,amount_of_biosolids_managed_land_applied:0,latitude:29.818097,longitude:-95.743688},{facility_name:"SOUTHDOWN WASTEWATER TREATMENT FACILITY",city:"Pearland",state:"Texas",amount_of_biosolids_generated:54,amount_of_biosolids_managed_land_applied:0,latitude:29.578435,longitude:-95.362265},{facility_name:"FAIRBURY WWTF",city:"Fairbury",state:"Neb.",amount_of_biosolids_generated:54,amount_of_biosolids_managed_land_applied:54.04,latitude:40.13734,longitude:-97.18129},{facility_name:"FOREST COVE WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:54,amount_of_biosolids_managed_land_applied:0,latitude:30.030319,longitude:-95.246925},{facility_name:"CEDAR BAYOU WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:54,amount_of_biosolids_managed_land_applied:0,latitude:30.036452,longitude:-95.070072},{facility_name:"HARRIS COUNTY MUNICIPAL UTILITY DISTRICT NO 495 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:54,amount_of_biosolids_managed_land_applied:0,latitude:29.852741,longitude:-95.791144},{facility_name:"PERU STP #2",city:"Peru",state:"Iowa",amount_of_biosolids_generated:54,amount_of_biosolids_managed_land_applied:0,latitude:41.327951,longitude:-89.177137},{facility_name:"BIGFORK COUNTY WATER AND SEWER",city:"Bigfork",state:"Mont.",amount_of_biosolids_generated:54,amount_of_biosolids_managed_land_applied:53.54,latitude:48.10334089,longitude:-114.0401908},{facility_name:"CITY OF BUFFALO",city:"Buffalo",state:"Mo.",amount_of_biosolids_generated:53,amount_of_biosolids_managed_land_applied:53.6,latitude:37.47914064,longitude:-93.18581312},{facility_name:"LLANO WWTP",city:"Llano",state:"Texas",amount_of_biosolids_generated:53,amount_of_biosolids_managed_land_applied:53.11,latitude:30.75031,longitude:-98.67852},{facility_name:"EL DORADO UD - WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:53,amount_of_biosolids_managed_land_applied:53.11,latitude:29.953528,longitude:-95.262694},{facility_name:"CITY OF VIENNA",city:"Vienna",state:"Ga.",amount_of_biosolids_generated:53,amount_of_biosolids_managed_land_applied:53.09578,latitude:32.09865,longitude:-83.77713},{facility_name:"MONTGOMERY COUNTY MUD 112 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:53,amount_of_biosolids_managed_land_applied:53.05,latitude:30.2441,longitude:-95.492405},{facility_name:"CITY OF HIDALGO WWTP",city:"Hidalgo",state:"Texas",amount_of_biosolids_generated:53,amount_of_biosolids_managed_land_applied:0,latitude:26.182831,longitude:-97.996643},{facility_name:"MONTGOMERY COUNTY MUD 105 WASTEWATER TREATMENT PLANT 1",city:"Houston",state:"Texas",amount_of_biosolids_generated:53,amount_of_biosolids_managed_land_applied:0,latitude:30.107306,longitude:-95.34975},{facility_name:"CITY OF WHARTON WWTP 2",city:"Wharton",state:"Texas",amount_of_biosolids_generated:53,amount_of_biosolids_managed_land_applied:0,latitude:29.317167,longitude:-96.125417},{facility_name:"NORTHWEST HARRIS COUNTY MUD 5 WWT",city:"Houston",state:"Texas",amount_of_biosolids_generated:52,amount_of_biosolids_managed_land_applied:0,latitude:29.990676,longitude:-95.644594},{facility_name:"CITY OF GIDDINGS NORTH WWTF",city:"Giddings",state:"Texas",amount_of_biosolids_generated:52,amount_of_biosolids_managed_land_applied:0,latitude:30.194639,longitude:-96.950806},{facility_name:"CITY OF OZARK",city:"Ozark",state:"Mo.",amount_of_biosolids_generated:52,amount_of_biosolids_managed_land_applied:68.1,latitude:37.02139,longitude:-93.20509},{facility_name:"CITY OF COLUMBUS WWTP",city:"Columbus",state:"Texas",amount_of_biosolids_generated:51,amount_of_biosolids_managed_land_applied:0,latitude:29.697415,longitude:-96.534923},{facility_name:"RIVER PLANTATION MUD WWTP",city:"Conroe",state:"Texas",amount_of_biosolids_generated:51,amount_of_biosolids_managed_land_applied:51.36,latitude:30.239806,longitude:-95.435806},{facility_name:"CITY-WHITE SULPHUR SPRINGS",city:"White Sulphur Springs",state:"Wis.",amount_of_biosolids_generated:51,amount_of_biosolids_managed_land_applied:0,latitude:37.793085,longitude:-80.301527},{facility_name:"ROAMINGWOOD SEWER AND WATER ASSOCIATION",city:"Lake Ariel",state:"Pa.",amount_of_biosolids_generated:51,amount_of_biosolids_managed_land_applied:0,latitude:41.40175,longitude:-75.3716},{facility_name:"NW HARRIS COUNTY MUD 9 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:51,amount_of_biosolids_managed_land_applied:0,latitude:29.961944,longitude:-95.588888},{facility_name:"DILLEY WWTP",city:"Dilley",state:"Texas",amount_of_biosolids_generated:51,amount_of_biosolids_managed_land_applied:0,latitude:28.666111,longitude:-99.148333},{facility_name:"NORTHWEST HARRIS COUNTY MUD 19 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:51,amount_of_biosolids_managed_land_applied:0,latitude:30.132417,longitude:-95.532694},{facility_name:"HARRIS COUNTY MUD 202 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:51,amount_of_biosolids_managed_land_applied:0,latitude:29.954596,longitude:-95.503163},{facility_name:"BEAR CREEK WRF LAS",city:"Hampton",state:"Ga.",amount_of_biosolids_generated:51,amount_of_biosolids_managed_land_applied:0,latitude:33.358754,longitude:-84.344501},{facility_name:"LONDONDERRY WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:50,amount_of_biosolids_managed_land_applied:50.42,latitude:30.12125,longitude:-95.549556},{facility_name:"PIRATES BEACH WWTP",city:"Galveston",state:"Texas",amount_of_biosolids_generated:50,amount_of_biosolids_managed_land_applied:0,latitude:29.2097,longitude:-94.9478},{facility_name:"CITY OF NEVADA",city:"Nevada",state:"Hawaii",amount_of_biosolids_generated:50,amount_of_biosolids_managed_land_applied:0,latitude:42.02316,longitude:-93.45235},{facility_name:"SEYMOUR WWTP",city:"Seymour",state:"Texas",amount_of_biosolids_generated:50,amount_of_biosolids_managed_land_applied:0,latitude:33.57425,longitude:-99.246722},{facility_name:"CITY OF JACKSON",city:"Jackson",state:"Ga.",amount_of_biosolids_generated:50,amount_of_biosolids_managed_land_applied:49.93,latitude:33.311083,longitude:-83.968861},{facility_name:"CITY OF SPLENDORA WWTF",city:"Splendora",state:"Texas",amount_of_biosolids_generated:50,amount_of_biosolids_managed_land_applied:0,latitude:30.236929,longitude:-95.159635},{facility_name:"SUNBELT FWSD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:50,amount_of_biosolids_managed_land_applied:49.86,latitude:29.88896,longitude:-95.40283},{facility_name:"HARRIS COUNTY WCID 74 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:50,amount_of_biosolids_managed_land_applied:49.76,latitude:29.89915,longitude:-95.3219},{facility_name:"CITY OF DEWITT",city:"Dewitt",state:"Hawaii",amount_of_biosolids_generated:50,amount_of_biosolids_managed_land_applied:49.6,latitude:41.82425,longitude:-90.53762},{facility_name:"MONTICELLO STP",city:"Monticello",state:"Ky.",amount_of_biosolids_generated:50,amount_of_biosolids_managed_land_applied:49.5,latitude:36.814444,longitude:-84.875556},{facility_name:"ANDY BOWIE WWTP",city:"Port Isabel",state:"Texas",amount_of_biosolids_generated:50,amount_of_biosolids_managed_land_applied:0,latitude:26.137972,longitude:-97.175028},{facility_name:"CHUCKAWALLA VALLEY/ IRONWOOD STATE PRISON WWTF",city:"Blythe",state:"Calif.",amount_of_biosolids_generated:49,amount_of_biosolids_managed_land_applied:0,latitude:33.61217117,longitude:-114.5954576},{facility_name:"TULLAHOMA STP",city:"Tullahoma",state:"Tenn.",amount_of_biosolids_generated:49,amount_of_biosolids_managed_land_applied:49.09,latitude:35.35183,longitude:-86.20252},{facility_name:"HARRIS COUNTY MUD 203 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:49,amount_of_biosolids_managed_land_applied:0,latitude:29.945222,longitude:-95.436028},{facility_name:"CITY OF PENITAS WWTP",city:"Penitas",state:"Texas",amount_of_biosolids_generated:49,amount_of_biosolids_managed_land_applied:49.04,latitude:26.228055,longitude:-98.441111},{facility_name:"PRASA YABUCOA STP",city:"Yabucoa",state:"Pa.",amount_of_biosolids_generated:49,amount_of_biosolids_managed_land_applied:0,latitude:18.04394466,longitude:-65.89744777},{facility_name:"NORTHGATE CROSSING MUD 2 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:48,amount_of_biosolids_managed_land_applied:0,latitude:30.103899,longitude:-95.422905},{facility_name:"CITY OF ROSENBERG WWTP 3",city:"Rosenberg",state:"Texas",amount_of_biosolids_generated:48,amount_of_biosolids_managed_land_applied:0,latitude:29.529722,longitude:-95.852806},{facility_name:"HARRIMAN UTILITY BOARD",city:"Harriman",state:"Tenn.",amount_of_biosolids_generated:48,amount_of_biosolids_managed_land_applied:48.1,latitude:35.892752,longitude:-84.531959},{facility_name:"HARRIS COUNTY MUD 374 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:48,amount_of_biosolids_managed_land_applied:48.03,latitude:29.946111,longitude:-95.698},{facility_name:"CITY OF MEADOWS PLACE WWTP",city:"Meadows Place",state:"Texas",amount_of_biosolids_generated:48,amount_of_biosolids_managed_land_applied:0,latitude:29.654629,longitude:-95.587073},{facility_name:"FRY ROAD MUD",city:"Houston",state:"Texas",amount_of_biosolids_generated:48,amount_of_biosolids_managed_land_applied:47.86,latitude:29.802111,longitude:-95.722222},{facility_name:"UNITEC WWTP",city:"Laredo",state:"Texas",amount_of_biosolids_generated:48,amount_of_biosolids_managed_land_applied:0,latitude:27.514321,longitude:-99.499251},{facility_name:"BRIDGEWOOD WWTP",city:"San Antonio",state:"Texas",amount_of_biosolids_generated:48,amount_of_biosolids_managed_land_applied:0,latitude:29.636722,longitude:-98.612583},{facility_name:"DECKER OAKS WWTP",city:"Tomball",state:"Texas",amount_of_biosolids_generated:47,amount_of_biosolids_managed_land_applied:30.11,latitude:30.142694,longitude:-95.652722},{facility_name:"CAMINO REAL WWTP",city:"Magnolia",state:"Texas",amount_of_biosolids_generated:47,amount_of_biosolids_managed_land_applied:5.41,latitude:30.1975,longitude:-95.0875},{facility_name:"HARRIS COUNTY MUD 155 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:47,amount_of_biosolids_managed_land_applied:47.25,latitude:29.903055,longitude:-95.663333},{facility_name:"GALVESTON CO WCID 12 WWTP",city:"Kemah",state:"Texas",amount_of_biosolids_generated:47,amount_of_biosolids_managed_land_applied:0,latitude:29.534611,longitude:-95.008778},{facility_name:"HERINGTON, CITY OF",city:"Herington",state:"Kan.",amount_of_biosolids_generated:47,amount_of_biosolids_managed_land_applied:47,latitude:38.70223,longitude:-96.81268},{facility_name:"WALNUT COVE WWTF",city:"Willis",state:"Texas",amount_of_biosolids_generated:47,amount_of_biosolids_managed_land_applied:0,latitude:30.454953,longitude:-95.540253},{facility_name:"GSW&SA/MULLINS WWTP",city:"Mullins",state:"S.C.",amount_of_biosolids_generated:47,amount_of_biosolids_managed_land_applied:46.72,latitude:34.203333,longitude:-79.253333},{facility_name:"NORTHWEST HARRIS CO MUD WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:46,amount_of_biosolids_managed_land_applied:0,latitude:30.113667,longitude:-95.544722},{facility_name:"HARRIS COUNTY MUD 365 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:46,amount_of_biosolids_managed_land_applied:0,latitude:29.594501,longitude:-95.456971},{facility_name:"BRAZORIA COUNT MUD 55 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:46,amount_of_biosolids_managed_land_applied:0,latitude:29.437777,longitude:-95.40472},{facility_name:"GLASSPORT BORO",city:"Glassport",state:"Pa.",amount_of_biosolids_generated:46,amount_of_biosolids_managed_land_applied:0,latitude:40.33629,longitude:-79.88924},{facility_name:"CITY OF MOULTON WWTP",city:"Moulton",state:"Texas",amount_of_biosolids_generated:46,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"REMBERT TRACT WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:46,amount_of_biosolids_managed_land_applied:46,latitude:30.124037,longitude:-95.385432},{facility_name:"CITY OF ALEXANDER CITY",city:"Alexander City",state:"Alaska",amount_of_biosolids_generated:46,amount_of_biosolids_managed_land_applied:46,latitude:32.9014,longitude:-85.9514},{facility_name:"WILLOW CREEK WWTP",city:"Mineral Wells",state:"Texas",amount_of_biosolids_generated:46,amount_of_biosolids_managed_land_applied:0,latitude:32.811539,longitude:-98.048657},{facility_name:"TOWN OF DAVIE SYSTEM IV WATER RECLAMATION FACILITY",city:"Davie",state:"Fla.",amount_of_biosolids_generated:46,amount_of_biosolids_managed_land_applied:45.72,latitude:26.07368102,longitude:-80.22617577},{facility_name:"CITY OF THREE RIVERS WWTP",city:"Three Rivers",state:"Texas",amount_of_biosolids_generated:46,amount_of_biosolids_managed_land_applied:45.6,latitude:28.474444,longitude:-98.183333},{facility_name:"CORDELE WPCP",city:"Cordele",state:"Ga.",amount_of_biosolids_generated:46,amount_of_biosolids_managed_land_applied:0,latitude:31.977972,longitude:-83.806167},{facility_name:"HARRIS COUNTY MUD 434 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:46,amount_of_biosolids_managed_land_applied:45.52,latitude:29.996111,longitude:-95.784166},{facility_name:"KINGS POINT COVE WWTP",city:"Brownwood",state:"Texas",amount_of_biosolids_generated:46,amount_of_biosolids_managed_land_applied:0,latitude:31.792222,longitude:-99.043333},{facility_name:"FOREST HILLS MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:45,amount_of_biosolids_managed_land_applied:0,latitude:29.912974,longitude:-95.449573},{facility_name:"WOODLAND OAKS WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:45,amount_of_biosolids_managed_land_applied:45.34,latitude:29.876611,longitude:-95.512972},{facility_name:"FT BEND CO MUD 131",city:"Houston",state:"Texas",amount_of_biosolids_generated:45,amount_of_biosolids_managed_land_applied:0,latitude:29.46039,longitude:-95.471161},{facility_name:"GLENDALE LAKES SUBDIVISION WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:45,amount_of_biosolids_managed_land_applied:45.29,latitude:29.485555,longitude:-95.458611},{facility_name:"HARRIS-FT.BEND CO MUD 5 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:45,amount_of_biosolids_managed_land_applied:0,latitude:29.7532,longitude:-95.7807},{facility_name:"MINOA (V)",city:"Minoa",state:"N.D.",amount_of_biosolids_generated:45,amount_of_biosolids_managed_land_applied:45.04,latitude:43.07722,longitude:-76.0008},{facility_name:"HARRISON CO UTIL AUTH, SOUTH WOOLMARKET WATER RECLAMATION FACILITY",city:"Woolmarket",state:"Mo.",amount_of_biosolids_generated:45,amount_of_biosolids_managed_land_applied:45,latitude:30.45625,longitude:-89.00025},{facility_name:"CALIFORNIA CITY WTF",city:"California City",state:"Calif.",amount_of_biosolids_generated:45,amount_of_biosolids_managed_land_applied:0,latitude:35.126,longitude:-117.9599},{facility_name:"CHAMBERLAIN, CITY OF",city:"Chamberlain, City Of",state:"S.D.",amount_of_biosolids_generated:45,amount_of_biosolids_managed_land_applied:44.6,latitude:43.796897,longitude:-99.344671},{facility_name:"CHANUTE, CITY OF",city:"Chanute",state:"Kan.",amount_of_biosolids_generated:44,amount_of_biosolids_managed_land_applied:44.45,latitude:37.71997708,longitude:-95.57994},{facility_name:"CITY OF SEDALIA",city:"Sedalia",state:"Mo.",amount_of_biosolids_generated:44,amount_of_biosolids_managed_land_applied:0,latitude:38.70972,longitude:-93.22888},{facility_name:"STEWART CREEK WWTP",city:"Montgomery",state:"Texas",amount_of_biosolids_generated:44,amount_of_biosolids_managed_land_applied:0,latitude:30.386112,longitude:-95.681526},{facility_name:"CITY OF GLEN ROSE WWTP",city:"Glen Rose",state:"Texas",amount_of_biosolids_generated:44,amount_of_biosolids_managed_land_applied:0,latitude:32.247361,longitude:-97.737806},{facility_name:"CITY OF JASPER WWTP",city:"Jasper",state:"Texas",amount_of_biosolids_generated:44,amount_of_biosolids_managed_land_applied:43.6,latitude:30.914972,longitude:-94.01},{facility_name:"SHAMOKIN-COAL TWP JT SAN AUTH",city:"Shamokin",state:"Pa.",amount_of_biosolids_generated:44,amount_of_biosolids_managed_land_applied:0,latitude:40.81116,longitude:-76.58295},{facility_name:"CITY OF OLNEY WWTP",city:"Olney",state:"Texas",amount_of_biosolids_generated:43,amount_of_biosolids_managed_land_applied:0,latitude:33.358972,longitude:-98.746444},{facility_name:"PLUM CREEK UTILITY WWTP",city:"San Antonio",state:"Texas",amount_of_biosolids_generated:43,amount_of_biosolids_managed_land_applied:0,latitude:29.955116,longitude:-97.809953},{facility_name:"CITY OF SOUTHSIDE PLACE WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:43,amount_of_biosolids_managed_land_applied:0,latitude:29.70597,longitude:-95.43367},{facility_name:"ABBEVILLE/LONG CANE CREEK",city:"Abbeville",state:"S.C.",amount_of_biosolids_generated:43,amount_of_biosolids_managed_land_applied:43,latitude:34.155833,longitude:-82.345},{facility_name:"CITY OF GREENFIELD",city:"Greenfield",state:"Hawaii",amount_of_biosolids_generated:43,amount_of_biosolids_managed_land_applied:43,latitude:41.30387,longitude:-94.46105},{facility_name:"TOWN OF REFUGIO WWTP",city:"Refugio",state:"Texas",amount_of_biosolids_generated:43,amount_of_biosolids_managed_land_applied:0,latitude:28.283278,longitude:-97.262556},{facility_name:"CITY OF BLUE RIDGE WWTF",city:"Blue Ridge",state:"Texas",amount_of_biosolids_generated:43,amount_of_biosolids_managed_land_applied:0,latitude:33.295111,longitude:-96.416361},{facility_name:"WESTLAKE MUD 1 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:43,amount_of_biosolids_managed_land_applied:42.89,latitude:29.802312,longitude:-95.704056},{facility_name:"BLUE BELL MANOR WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:42,amount_of_biosolids_managed_land_applied:0,latitude:29.90428,longitude:-95.42708},{facility_name:"HARRIS CO MUD 148 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:42,amount_of_biosolids_managed_land_applied:0,latitude:29.888333,longitude:-95.22},{facility_name:"TOWN OF RUTHERFORDTON",city:"Rutherfordton",state:"Mont.",amount_of_biosolids_generated:42,amount_of_biosolids_managed_land_applied:42.19,latitude:35.3423,longitude:-81.9565},{facility_name:"CITY OF FLORENCE WWTP",city:"Florence",state:"Texas",amount_of_biosolids_generated:42,amount_of_biosolids_managed_land_applied:0,latitude:30.826,longitude:-97.778056},{facility_name:"CITY OF OGDEN",city:"Ogden",state:"Hawaii",amount_of_biosolids_generated:42,amount_of_biosolids_managed_land_applied:0,latitude:42.03888,longitude:-94.0477},{facility_name:"KEMMERER-DIAMONDVILLE JOINT POWERS BOARD",city:"Kemmerer",state:"Wyo.",amount_of_biosolids_generated:42,amount_of_biosolids_managed_land_applied:0,latitude:41.79681385,longitude:-110.5446921},{facility_name:"TOWN OF LURAY",city:"Luray",state:"Utah",amount_of_biosolids_generated:42,amount_of_biosolids_managed_land_applied:41.8,latitude:38.684558,longitude:-78.458819},{facility_name:"CURWENSVILLE MUNICIPAL AUTHORI",city:"Curwensville",state:"Pa.",amount_of_biosolids_generated:42,amount_of_biosolids_managed_land_applied:0,latitude:40.976679,longitude:-78.514715},{facility_name:"INDIAN CREEK WWTP - MSD",city:"Cincinnati",state:"Ohio",amount_of_biosolids_generated:42,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"CITY OF CRESCO",city:"Cresco",state:"Hawaii",amount_of_biosolids_generated:42,amount_of_biosolids_managed_land_applied:41.5,latitude:43.38561149,longitude:-92.14732857},{facility_name:"STANLEY LAKE MUD WWTP",city:"Montgomery",state:"Texas",amount_of_biosolids_generated:41,amount_of_biosolids_managed_land_applied:0,latitude:30.386861,longitude:-95.641056},{facility_name:"PRAIRIE VIEW A&AMP, M WWTF",city:"Prairie View",state:"Texas",amount_of_biosolids_generated:41,amount_of_biosolids_managed_land_applied:0,latitude:30.099361,longitude:-95.996056},{facility_name:"LUBECK PSD",city:"Washington",state:"Wis.",amount_of_biosolids_generated:41,amount_of_biosolids_managed_land_applied:0,latitude:39.222276,longitude:-81.688451},{facility_name:"MANCHESTER BY THE SEA",city:"Manchester",state:"Mass.",amount_of_biosolids_generated:41,amount_of_biosolids_managed_land_applied:0,latitude:42.57532,longitude:-70.77202},{facility_name:"CITY OF COLLINSVILLE WWTP",city:"Collinsville",state:"Texas",amount_of_biosolids_generated:41,amount_of_biosolids_managed_land_applied:0,latitude:33.551053,longitude:-96.907515},{facility_name:"SHELDON WOODS WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:41,amount_of_biosolids_managed_land_applied:0,latitude:29.854705,longitude:-95.12799},{facility_name:"WOOD DALE SOUTH STP",city:"Wood Dale",state:"Iowa",amount_of_biosolids_generated:41,amount_of_biosolids_managed_land_applied:40.75,latitude:41.9498,longitude:-87.9777},{facility_name:"CITY OF ROCKSPRINGS WWTP",city:"Rock Springs",state:"Texas",amount_of_biosolids_generated:41,amount_of_biosolids_managed_land_applied:0,latitude:30.02409,longitude:-100.21267},{facility_name:"HARRIS COUNTY MUD 360 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:41,amount_of_biosolids_managed_land_applied:0,latitude:29.979695,longitude:-95.632564},{facility_name:"CITY OF PINELAND WWTP",city:"Pineland",state:"Texas",amount_of_biosolids_generated:41,amount_of_biosolids_managed_land_applied:0,latitude:31.239889,longitude:-93.967389},{facility_name:"CHASE FIELD WWTP",city:"Beeville",state:"Texas",amount_of_biosolids_generated:41,amount_of_biosolids_managed_land_applied:40.5,latitude:28.363611,longitude:-97.655833},{facility_name:"TOWN OF JEFFERSON",city:"Jefferson",state:"Mont.",amount_of_biosolids_generated:40,amount_of_biosolids_managed_land_applied:40.4,latitude:36.40859,longitude:-81.42688},{facility_name:"ORANGE WWTF",city:"Orange",state:"Mass.",amount_of_biosolids_generated:40,amount_of_biosolids_managed_land_applied:0,latitude:42.59606,longitude:-72.33146},{facility_name:"STAMFORD WWTP",city:"Stamford",state:"Texas",amount_of_biosolids_generated:40,amount_of_biosolids_managed_land_applied:0,latitude:32.95944,longitude:-99.77648},{facility_name:"PRASA VEGA ALTA",city:"Vega Alta",state:"Pa.",amount_of_biosolids_generated:40,amount_of_biosolids_managed_land_applied:32.11,latitude:18.427468,longitude:-66.340464},{facility_name:"TOWN OF SPRING LAKE",city:"Spring Lake",state:"Mont.",amount_of_biosolids_generated:40,amount_of_biosolids_managed_land_applied:39.8,latitude:35.196072,longitude:-78.965508},{facility_name:"MONTGOMERY COUNTY MUD 15-WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:40,amount_of_biosolids_managed_land_applied:39.79,latitude:30.224078,longitude:-95.43377},{facility_name:"RHOME WWTF",city:"Rhome",state:"Texas",amount_of_biosolids_generated:40,amount_of_biosolids_managed_land_applied:0,latitude:33.051341,longitude:-97.467336},{facility_name:"KINGDOM HEIGHTS WWTP",city:"Sugar Land",state:"Texas",amount_of_biosolids_generated:39,amount_of_biosolids_managed_land_applied:0,latitude:29.59564,longitude:-95.81128},{facility_name:"POINT AQUARIUS MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:39,amount_of_biosolids_managed_land_applied:0,latitude:30.419917,longitude:-95.582694},{facility_name:"HARRIS COUNTY MUD 345 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:39,amount_of_biosolids_managed_land_applied:39,latitude:30.031881,longitude:-95.237843},{facility_name:"TOWN OF MAYODAN",city:"Mayodan",state:"Mont.",amount_of_biosolids_generated:39,amount_of_biosolids_managed_land_applied:39,latitude:36.4069,longitude:-79.9656},{facility_name:"CITY OF MOUNT VERNON",city:"Mt. Vernon",state:"Hawaii",amount_of_biosolids_generated:39,amount_of_biosolids_managed_land_applied:38.73,latitude:41.92581465,longitude:-91.42296506},{facility_name:"HARRIS COUNTY MUD 238 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:38,amount_of_biosolids_managed_land_applied:0,latitude:29.8149,longitude:-95.69974},{facility_name:"FLEMINGSBURG STP",city:"Flemingsburg",state:"Ky.",amount_of_biosolids_generated:38,amount_of_biosolids_managed_land_applied:0,latitude:38.421496,longitude:-83.734424},{facility_name:"CITY OF LYTLE WWTP",city:"Lytle",state:"Texas",amount_of_biosolids_generated:38,amount_of_biosolids_managed_land_applied:0,latitude:29.218068,longitude:-98.790138},{facility_name:"PRASA GUANICA",city:"Guanica",state:"Pa.",amount_of_biosolids_generated:38,amount_of_biosolids_managed_land_applied:0,latitude:17.9676,longitude:-66.910805},{facility_name:"MARSEILLES WWTP, CITY OF",city:"Marseilles",state:"Iowa",amount_of_biosolids_generated:38,amount_of_biosolids_managed_land_applied:70.91,latitude:41.329632,longitude:-88.722196},{facility_name:"HARRIS COUNTY MUD 401 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:38,amount_of_biosolids_managed_land_applied:38.4,latitude:30.074024,longitude:-95.570467},{facility_name:"MAGNOLIA, CITY OF",city:"Magnolia",state:"Alaska",amount_of_biosolids_generated:38,amount_of_biosolids_managed_land_applied:38,latitude:33.26661,longitude:-93.26479},{facility_name:"PRASA ISABELA",city:"Isabela",state:"Pa.",amount_of_biosolids_generated:38,amount_of_biosolids_managed_land_applied:37.96,latitude:18.47558,longitude:-66.98964},{facility_name:"VETERANS MEMORIAL HIGH SCHOOL WWTF",city:"Live Oak",state:"Texas",amount_of_biosolids_generated:38,amount_of_biosolids_managed_land_applied:0,latitude:29.606388,longitude:-98.340833},{facility_name:"MEMORIAL HILLS UD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:38,amount_of_biosolids_managed_land_applied:0,latitude:30.02462,longitude:-95.39243},{facility_name:"HARRIS COUNTY MUD 166 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:38,amount_of_biosolids_managed_land_applied:0,latitude:29.866173,longitude:-95.65831},{facility_name:"HANNAHVILLE INDIAN COMM. WWTP",city:"Wilson",state:"Mich.",amount_of_biosolids_generated:38,amount_of_biosolids_managed_land_applied:37.735,latitude:45.69703,longitude:-87.336472},{facility_name:"BAUER WWTP",city:"Tomball",state:"Texas",amount_of_biosolids_generated:37,amount_of_biosolids_managed_land_applied:35.0643092,latitude:30.046176,longitude:-95.778278},{facility_name:"BELLA VISTA WWTP",city:"Magnolia",state:"Texas",amount_of_biosolids_generated:37,amount_of_biosolids_managed_land_applied:17.22,latitude:30.25199,longitude:-95.05975},{facility_name:"CITY OF QUINLAN WWTF",city:"Quinlan",state:"Texas",amount_of_biosolids_generated:37,amount_of_biosolids_managed_land_applied:0,latitude:32.906222,longitude:-96.144139},{facility_name:"PLANTATION MUD",city:"Houston",state:"Texas",amount_of_biosolids_generated:37,amount_of_biosolids_managed_land_applied:0,latitude:29.546056,longitude:-95.687167},{facility_name:"WEST HARRIS COUNTY MUD 15 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:37,amount_of_biosolids_managed_land_applied:37.08,latitude:29.91619,longitude:-95.64394},{facility_name:"CITY OF ENTERPRISE",city:"Enterprise",state:"Alaska",amount_of_biosolids_generated:37,amount_of_biosolids_managed_land_applied:37.26,latitude:31.3008,longitude:-85.8811},{facility_name:"TOWN OF BEAUFORT",city:"Beaufort",state:"Mont.",amount_of_biosolids_generated:37,amount_of_biosolids_managed_land_applied:37,latitude:34.718063,longitude:-76.637963},{facility_name:"FLORA STP, CITY OF",city:"Flora",state:"Iowa",amount_of_biosolids_generated:37,amount_of_biosolids_managed_land_applied:36.9,latitude:38.655,longitude:-88.479167},{facility_name:"CITY OF ROGERSVILLE",city:"Rogersville",state:"Tenn.",amount_of_biosolids_generated:37,amount_of_biosolids_managed_land_applied:36.9,latitude:36.38004,longitude:-83.04624},{facility_name:"WELCH, CITY OF",city:"Welch",state:"Wis.",amount_of_biosolids_generated:37,amount_of_biosolids_managed_land_applied:0,latitude:37.44299,longitude:-81.59746},{facility_name:"CHOWCHILLA WWTP",city:"Chowchilla",state:"Calif.",amount_of_biosolids_generated:37,amount_of_biosolids_managed_land_applied:0,latitude:37.06638854,longitude:-120.346803},{facility_name:"MONTGOMERY COUNTY MUD 18 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:37,amount_of_biosolids_managed_land_applied:0,latitude:30.421583,longitude:-95.622722},{facility_name:"FORT BEND CNTY MUD 50 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:37,amount_of_biosolids_managed_land_applied:0,latitude:29.694158,longitude:-95.764166},{facility_name:"TIOGA WWTP",city:"Tioga",state:"Texas",amount_of_biosolids_generated:36,amount_of_biosolids_managed_land_applied:0,latitude:33.458527,longitude:-96.923237},{facility_name:"BRITTMOORE III WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:36,amount_of_biosolids_managed_land_applied:0,latitude:29.86332,longitude:-95.57934},{facility_name:"HARRIS CO MUD 86 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:36,amount_of_biosolids_managed_land_applied:0,latitude:30.007361,longitude:-95.452056},{facility_name:"ECW&SA/BROOKS STREET WWTP",city:"Edgefield",state:"S.C.",amount_of_biosolids_generated:36,amount_of_biosolids_managed_land_applied:36.38,latitude:33.7919,longitude:-81.9408},{facility_name:"CITY OF CRESSON WWTP 1",city:"Cresson",state:"Texas",amount_of_biosolids_generated:36,amount_of_biosolids_managed_land_applied:0,latitude:32.519722,longitude:-97.625555},{facility_name:"BLANKET WWTP",city:"Blanket",state:"Texas",amount_of_biosolids_generated:36,amount_of_biosolids_managed_land_applied:0,latitude:31.818231,longitude:-98.789925},{facility_name:"CASCADE CITY OF STP",city:"Cascade",state:"Hawaii",amount_of_biosolids_generated:36,amount_of_biosolids_managed_land_applied:36,latitude:42.29527,longitude:-91.00938},{facility_name:"FORT BEND COUNTY MUD 50 INTERIM WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:36,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"MONTGOMERY COUNTY MUD 88 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:36,amount_of_biosolids_managed_land_applied:35.61,latitude:30.126972,longitude:-95.372472},{facility_name:"ARKANSAS, CITY OF",city:"Arkansas City",state:"Kan.",amount_of_biosolids_generated:35,amount_of_biosolids_managed_land_applied:35.4,latitude:37.07810149,longitude:-96.97676694},{facility_name:"ROCKY FORK WASTEWATER PLANT",city:"Nitro",state:"Wis.",amount_of_biosolids_generated:35,amount_of_biosolids_managed_land_applied:35.32,latitude:38.432927,longitude:-81.739139},{facility_name:"HEATHER GLEN WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:35,amount_of_biosolids_managed_land_applied:35.21,latitude:29.89597,longitude:-95.43227},{facility_name:"E MONTGOMERY CNTY MUD 3 WWTP 1",city:"Houston",state:"Texas",amount_of_biosolids_generated:35,amount_of_biosolids_managed_land_applied:35.1460741,latitude:30.177278,longitude:-95.252472},{facility_name:"NAS JACKSONVILLE",city:"Jacksonville",state:"Fla.",amount_of_biosolids_generated:35,amount_of_biosolids_managed_land_applied:0,latitude:30.226387,longitude:-81.686372},{facility_name:"CITY OF LA VERNIA WWTP",city:"La Vernia",state:"Texas",amount_of_biosolids_generated:35,amount_of_biosolids_managed_land_applied:0,latitude:29.357722,longitude:-98.102222},{facility_name:"FORT BEND COUNTY MUD 37",city:"Houston",state:"Texas",amount_of_biosolids_generated:35,amount_of_biosolids_managed_land_applied:0,latitude:30.519054,longitude:-90.519419},{facility_name:"RANCHCREST WWTP",city:"New Waverly",state:"Texas",amount_of_biosolids_generated:35,amount_of_biosolids_managed_land_applied:0,latitude:30.189403,longitude:-95.799141},{facility_name:"COLUMBUS INDUSTRIAL PARK WWTP",city:"Columbus",state:"Texas",amount_of_biosolids_generated:34,amount_of_biosolids_managed_land_applied:0,latitude:29.72,longitude:-96.587444},{facility_name:"CITY OF VAN WWTF",city:"Van",state:"Texas",amount_of_biosolids_generated:34,amount_of_biosolids_managed_land_applied:0,latitude:32.509222,longitude:-95.632018},{facility_name:"NORTHWEST HARRIS COUNTY MUD 24 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:34,amount_of_biosolids_managed_land_applied:0,latitude:29.952097,longitude:-95.312581},{facility_name:"CANDLELIGHT HILLS WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:34,amount_of_biosolids_managed_land_applied:0,latitude:30.039294,longitude:-95.45313},{facility_name:"CHATEAU WOODS MUNICIPAL UTILITY",city:"Conroe",state:"Texas",amount_of_biosolids_generated:34,amount_of_biosolids_managed_land_applied:0,latitude:30.16881,longitude:-95.413825},{facility_name:"BRITTMOORE WEST BY NW WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:34,amount_of_biosolids_managed_land_applied:0,latitude:29.862167,longitude:-95.564639},{facility_name:"WOODTRACE INTERIM WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:34,amount_of_biosolids_managed_land_applied:33.8567614,latitude:30.151028,longitude:-95.665778},{facility_name:"BUCHANAN, CITY OF (BUCHANAN WPCP)",city:"Buchanan",state:"Ga.",amount_of_biosolids_generated:34,amount_of_biosolids_managed_land_applied:33.64,latitude:33.807722,longitude:-85.179111},{facility_name:"GRANDE SAN JACINTO",city:"Tomball",state:"Texas",amount_of_biosolids_generated:34,amount_of_biosolids_managed_land_applied:22.29,latitude:30.176666,longitude:-95.103333},{facility_name:"NB DAVIDSON WWTF",city:"Huntsville",state:"Texas",amount_of_biosolids_generated:34,amount_of_biosolids_managed_land_applied:0,latitude:30.645492,longitude:-95.552467},{facility_name:"HIDDEN VALLEY WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:33,amount_of_biosolids_managed_land_applied:0,latitude:29.900633,longitude:-95.415039},{facility_name:"TWIN ARROWS CASINO WATER AND WASTEWATER SYSTEMS",city:"Twin Arrows",state:"Ark.",amount_of_biosolids_generated:33,amount_of_biosolids_managed_land_applied:0,latitude:35.167266,longitude:-111.258888},{facility_name:"CITY OF FOREST CITY",city:"Forest City",state:"Hawaii",amount_of_biosolids_generated:33,amount_of_biosolids_managed_land_applied:33.35,latitude:43.220084,longitude:-93.63645704},{facility_name:"CITY OF GRUNDY CENTER",city:"Grundy Center",state:"Hawaii",amount_of_biosolids_generated:33,amount_of_biosolids_managed_land_applied:33.26,latitude:42.35031288,longitude:-92.76831276},{facility_name:"WOODLAND 50 MF WWTF",city:"Austin",state:"Texas",amount_of_biosolids_generated:33,amount_of_biosolids_managed_land_applied:0,latitude:30.175686,longitude:-95.600753},{facility_name:"BRITTMORE WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:33,amount_of_biosolids_managed_land_applied:0,latitude:29.862167,longitude:-95.564639},{facility_name:"COUNTRY TERRACE WWTP",city:"Highlands",state:"Texas",amount_of_biosolids_generated:33,amount_of_biosolids_managed_land_applied:0,latitude:29.822389,longitude:-95.022917},{facility_name:"LOOGOOTEE WASTEWATER TREATMENT PLANT",city:"Loogootee",state:"Iowa",amount_of_biosolids_generated:33,amount_of_biosolids_managed_land_applied:33.12,latitude:38.66476,longitude:-86.91435},{facility_name:"CITY OF LEONARD WWTP",city:"Leonard",state:"Texas",amount_of_biosolids_generated:33,amount_of_biosolids_managed_land_applied:0,latitude:33.370389,longitude:-96.239694},{facility_name:"HARRIS COUNTY MUD 58 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:33,amount_of_biosolids_managed_land_applied:32.73,latitude:30.003528,longitude:-95.470194},{facility_name:"CITY OF LAFAYETTE",city:"Lafayette",state:"Alaska",amount_of_biosolids_generated:33,amount_of_biosolids_managed_land_applied:0,latitude:32.907376,longitude:-85.433925},{facility_name:"CITY OF KIRBYVILLE WWTF",city:"Kirbyville",state:"Texas",amount_of_biosolids_generated:33,amount_of_biosolids_managed_land_applied:0,latitude:30.659071,longitude:-93.884105},{facility_name:"MOBRIDGE, CITY OF (BIOSOLIDS)",city:"Mobridge, City Of",state:"S.D.",amount_of_biosolids_generated:32,amount_of_biosolids_managed_land_applied:32.35,latitude:45.525192,longitude:-100.414082},{facility_name:"WOODCREEK MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:32,amount_of_biosolids_managed_land_applied:0,latitude:30.0115,longitude:-95.3775},{facility_name:"STOOKEY TOWNSHIP MAIN STP",city:"Belleville",state:"Iowa",amount_of_biosolids_generated:32,amount_of_biosolids_managed_land_applied:286.754,latitude:38.541297,longitude:-90.05987},{facility_name:"EDGERTON BIG BULL CREEK",city:"Edgerton",state:"Kan.",amount_of_biosolids_generated:32,amount_of_biosolids_managed_land_applied:32,latitude:38.755544,longitude:-94.968081},{facility_name:"SINTON MAIN WWTP",city:"Sinton",state:"Texas",amount_of_biosolids_generated:32,amount_of_biosolids_managed_land_applied:0,latitude:28.046306,longitude:-97.502028},{facility_name:"CITY OF WAYNSEVILLE",city:"Waynesville",state:"Mo.",amount_of_biosolids_generated:32,amount_of_biosolids_managed_land_applied:31.8,latitude:37.82267,longitude:-92.21194},{facility_name:"CITY OF DEER LODGE",city:"Deer Lodge",state:"Mont.",amount_of_biosolids_generated:32,amount_of_biosolids_managed_land_applied:0,latitude:46.39977,longitude:-112.73518},{facility_name:"BRAZORIA COUNTY MUD 40 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:32,amount_of_biosolids_managed_land_applied:0,latitude:29.520721,longitude:-95.395015},{facility_name:"AUBREY WWTF",city:"Aubrey",state:"Texas",amount_of_biosolids_generated:32,amount_of_biosolids_managed_land_applied:0,latitude:33.29858,longitude:-96.98833},{facility_name:"CITY OF CENTERVILLE",city:"Centerville",state:"Hawaii",amount_of_biosolids_generated:32,amount_of_biosolids_managed_land_applied:31.5,latitude:40.72967964,longitude:-92.87683077},{facility_name:"VICTORIA COUNTY WCID 1 WWTF",city:"Bloomington",state:"Texas",amount_of_biosolids_generated:31,amount_of_biosolids_managed_land_applied:0,latitude:28.654,longitude:-96.8875},{facility_name:"CITY OF ELDORA SEWER TREATMENT PLANT",city:"Eldora",state:"Hawaii",amount_of_biosolids_generated:31,amount_of_biosolids_managed_land_applied:31.05,latitude:42.355021,longitude:-93.081034},{facility_name:"HARRIS COUNTY MUD 6 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:31,amount_of_biosolids_managed_land_applied:0,latitude:29.900778,longitude:-95.504639},{facility_name:"CLASSIC PINES WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:31,amount_of_biosolids_managed_land_applied:0,latitude:29.953528,longitude:-95.255472},{facility_name:"CITY OF LOS FRESNOS WWTP",city:"Los Fresnos",state:"Texas",amount_of_biosolids_generated:31,amount_of_biosolids_managed_land_applied:30.9,latitude:26.062583,longitude:-97.483917},{facility_name:"CITY OF LECLAIRE WWTP",city:"Leclaire",state:"Hawaii",amount_of_biosolids_generated:31,amount_of_biosolids_managed_land_applied:0,latitude:41.59756,longitude:-90.34717},{facility_name:"GRANDVIEW WWTP",city:"Grandview",state:"Texas",amount_of_biosolids_generated:31,amount_of_biosolids_managed_land_applied:0,latitude:32.254333,longitude:-97.148194},{facility_name:"RAILYARD WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:31,amount_of_biosolids_managed_land_applied:0,latitude:29.995306,longitude:-97.80063},{facility_name:"SOUTHWOOD ESTATES WWTP",city:"Alvin",state:"Texas",amount_of_biosolids_generated:30,amount_of_biosolids_managed_land_applied:0,latitude:29.74082,longitude:-95.38153},{facility_name:"LEE COUNTY WWTP",city:"Coupland",state:"Texas",amount_of_biosolids_generated:30,amount_of_biosolids_managed_land_applied:0,latitude:30.450035,longitude:-97.168634},{facility_name:"WEST HARRIS CO. MUD 17 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:30,amount_of_biosolids_managed_land_applied:30.26,latitude:29.807834,longitude:-95.726817},{facility_name:"LAKE MUD WWTP 2",city:"Houston",state:"Texas",amount_of_biosolids_generated:30,amount_of_biosolids_managed_land_applied:0,latitude:29.793611,longitude:-95.045},{facility_name:"INLINE UTILITIES WWTP",city:"Spring",state:"Texas",amount_of_biosolids_generated:30,amount_of_biosolids_managed_land_applied:0,latitude:30.06367,longitude:-95.56895},{facility_name:"SPRING TRAILS WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:30,amount_of_biosolids_managed_land_applied:0,latitude:30.088815,longitude:-95.376127},{facility_name:"WEST HARRIS CO MUD 7 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:30,amount_of_biosolids_managed_land_applied:30.1283214,latitude:29.78455,longitude:-95.48516},{facility_name:"COALVILLE CITY CORPORATION WASTEWATER TREATMENT FACILITY",city:"Coalville",state:"Utah",amount_of_biosolids_generated:30,amount_of_biosolids_managed_land_applied:0,latitude:40.886944,longitude:-111.4025},{facility_name:"CITY OF LOTT WWTP",city:"Lott",state:"Texas",amount_of_biosolids_generated:30,amount_of_biosolids_managed_land_applied:0,latitude:31.2085,longitude:-97.041639},{facility_name:"TOWN OF WINDOM WWTP",city:"Windom",state:"Texas",amount_of_biosolids_generated:30,amount_of_biosolids_managed_land_applied:0,latitude:33.561778,longitude:-96.007222},{facility_name:"PORTALES, CITY OF - WWTP",city:"Portales",state:"N.D.",amount_of_biosolids_generated:30,amount_of_biosolids_managed_land_applied:0,latitude:34.18647,longitude:-103.33755},{facility_name:"NORTHWEST REGIONAL WASTEWATER RECLAMATION FACILITY",city:"Richlands",state:"Mont.",amount_of_biosolids_generated:30,amount_of_biosolids_managed_land_applied:29.73,latitude:34.880634,longitude:-77.531378},{facility_name:"CITY OF WASKOM WWTF",city:"Waskom",state:"Texas",amount_of_biosolids_generated:30,amount_of_biosolids_managed_land_applied:0,latitude:32.451167,longitude:-94.053472},{facility_name:"WEST HARRIS COUNTY MUD 6 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:30,amount_of_biosolids_managed_land_applied:0,latitude:29.72324,longitude:-95.63199},{facility_name:"CITY OF NATALIA WWTP",city:"Natalia",state:"Texas",amount_of_biosolids_generated:30,amount_of_biosolids_managed_land_applied:0,latitude:29.180389,longitude:-98.865806},{facility_name:"CITY OF IOWA FALLS",city:"Iowa Falls",state:"Hawaii",amount_of_biosolids_generated:30,amount_of_biosolids_managed_land_applied:29.5,latitude:42.5202,longitude:-93.26417},{facility_name:"SAN CLEMENTE ISLAND WWTP",city:"San Clemente",state:"Calif.",amount_of_biosolids_generated:30,amount_of_biosolids_managed_land_applied:0,latitude:33.447222,longitude:-117.611993},{facility_name:"TELGE AND JARVIS WWTP",city:"Tomball",state:"Texas",amount_of_biosolids_generated:29,amount_of_biosolids_managed_land_applied:0,latitude:29.958055,longitude:-95.654166},{facility_name:"HOT SPRINGS, CITY OF",city:"Hot Springs, City Of",state:"S.D.",amount_of_biosolids_generated:29,amount_of_biosolids_managed_land_applied:0,latitude:43.432669,longitude:-103.477839},{facility_name:"CANYON PARK ESTATES WWTP",city:"Seguin",state:"Texas",amount_of_biosolids_generated:29,amount_of_biosolids_managed_land_applied:29.4,latitude:29.909722,longitude:-98.213611},{facility_name:"CITY OF CASSVILLE",city:"Cassville",state:"Mo.",amount_of_biosolids_generated:29,amount_of_biosolids_managed_land_applied:29.3,latitude:36.672804,longitude:-93.871304},{facility_name:"BANQUETE WWTF",city:"Banquete",state:"Texas",amount_of_biosolids_generated:29,amount_of_biosolids_managed_land_applied:0,latitude:27.806253,longitude:-97.800993},{facility_name:"DELL RAPIDS, CITY OF",city:"Dell Rapids",state:"S.D.",amount_of_biosolids_generated:29,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"MANCHESTER-SHORTVILLE JNT SB",city:"Manchester",state:"N.D.",amount_of_biosolids_generated:29,amount_of_biosolids_managed_land_applied:0,latitude:42.970035,longitude:-77.23305046},{facility_name:"CIBOLO VALLEY WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:29,amount_of_biosolids_managed_land_applied:0,latitude:29.737222,longitude:-98.426388},{facility_name:"COUNTRY WEST WWTP",city:"Porter",state:"Texas",amount_of_biosolids_generated:29,amount_of_biosolids_managed_land_applied:0,latitude:30.224806,longitude:-95.291417},{facility_name:"HARRIS COUNTY MUD 191 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:29,amount_of_biosolids_managed_land_applied:0,latitude:29.961611,longitude:-95.535611},{facility_name:"BLOOMINGTON ISD",city:"Bloomington",state:"Texas",amount_of_biosolids_generated:29,amount_of_biosolids_managed_land_applied:0,latitude:28.673671,longitude:-96.852265},{facility_name:"HARRIS COUNTY MUD 304 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:29,amount_of_biosolids_managed_land_applied:0,latitude:29.975194,longitude:-95.46825},{facility_name:"CITY OF SILSBEE SOUTH WWTP",city:"Silsbee",state:"Texas",amount_of_biosolids_generated:29,amount_of_biosolids_managed_land_applied:0,latitude:30.333674,longitude:-94.181322},{facility_name:"CITY OF GOLDTHWAITE WWTP",city:"Goldthwaite",state:"Texas",amount_of_biosolids_generated:29,amount_of_biosolids_managed_land_applied:0,latitude:31.444111,longitude:-98.582472},{facility_name:"NORTH ALAMO WSC REGIONAL WWTP",city:"Edinburg",state:"Texas",amount_of_biosolids_generated:28,amount_of_biosolids_managed_land_applied:40.04,latitude:26.227376,longitude:-98.054119},{facility_name:"LAKE CONROE HILLS MUD WWTF",city:"Conroe",state:"Texas",amount_of_biosolids_generated:28,amount_of_biosolids_managed_land_applied:0,latitude:30.423278,longitude:-95.565244},{facility_name:"WILLOW POINT MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:28,amount_of_biosolids_managed_land_applied:0,latitude:29.769166,longitude:-95.861666},{facility_name:"INDUSTRIAL UTILITIES WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:28,amount_of_biosolids_managed_land_applied:0,latitude:29.76363,longitude:-95.1419},{facility_name:"SEDONA LAKES WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:28,amount_of_biosolids_managed_land_applied:0,latitude:29.517922,longitude:-95.370609},{facility_name:"PRASA - BARRANQUITAS WWTP",city:"Barranquitas",state:"Pa.",amount_of_biosolids_generated:28,amount_of_biosolids_managed_land_applied:0,latitude:18.179707,longitude:-66.300838},{facility_name:"FT BEND COUNTY MUD 34 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:28,amount_of_biosolids_managed_land_applied:27.64,latitude:29.75253,longitude:-95.46009},{facility_name:"WEST HARRIS COUNTY MUD 4 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:28,amount_of_biosolids_managed_land_applied:27.5880957,latitude:29.741614,longitude:-95.448472},{facility_name:"ROMAN FOREST MUD WWTF",city:"New Caney",state:"Texas",amount_of_biosolids_generated:28,amount_of_biosolids_managed_land_applied:0,latitude:30.169083,longitude:-95.177972},{facility_name:"TERRAMAR WWTP",city:"Galveston",state:"Texas",amount_of_biosolids_generated:28,amount_of_biosolids_managed_land_applied:0,latitude:29.138556,longitude:-95.059917},{facility_name:"WEST HARRIS COUNTY MUD 21 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:27,amount_of_biosolids_managed_land_applied:12.3026023,latitude:29.926403,longitude:-95.540134},{facility_name:"HARRIS COUNTY MUD NO 43",city:"Houston",state:"Texas",amount_of_biosolids_generated:27,amount_of_biosolids_managed_land_applied:27.21,latitude:30.053611,longitude:-95.363333},{facility_name:"HARRIS COUNTY FWSD 47 WWTP",city:"Channelview",state:"Texas",amount_of_biosolids_generated:27,amount_of_biosolids_managed_land_applied:0,latitude:29.774409,longitude:-95.157842},{facility_name:"HARRIS COUNTY MUD 531 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:27,amount_of_biosolids_managed_land_applied:0,latitude:30.020833,longitude:-95.731111},{facility_name:"PALMYRA STP",city:"Palmyra",state:"Neb.",amount_of_biosolids_generated:27,amount_of_biosolids_managed_land_applied:0,latitude:40.00674,longitude:-75.02871},{facility_name:"CAMERON WWTP",city:"Cameron",state:"Texas",amount_of_biosolids_generated:27,amount_of_biosolids_managed_land_applied:0,latitude:30.844333,longitude:-96.965528},{facility_name:"HARRIS COUNTY MUD 389 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:27,amount_of_biosolids_managed_land_applied:0,latitude:29.999722,longitude:-95.6625},{facility_name:"HARRIS COUNTY MUD 276 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:27,amount_of_biosolids_managed_land_applied:0,latitude:29.866556,longitude:-95.646139},{facility_name:"MONTGOMERY COUNTY MUD 24 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:27,amount_of_biosolids_managed_land_applied:26.85,latitude:30.09658,longitude:-95.19177},{facility_name:"ROBESONIA-WERNERSVILLE M/A OF",city:"Wernersville",state:"Pa.",amount_of_biosolids_generated:27,amount_of_biosolids_managed_land_applied:0,latitude:40.352631,longitude:-76.08346},{facility_name:"GRANT ROAD PUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:27,amount_of_biosolids_managed_land_applied:0,latitude:29.985277,longitude:-95.625277},{facility_name:"HARRIS COUNTY MUD 50 WWTP",city:"Crosby",state:"Texas",amount_of_biosolids_generated:27,amount_of_biosolids_managed_land_applied:0,latitude:29.868611,longitude:-95.077777},{facility_name:"PRASA PATILLAS",city:"San Juan",state:"Pa.",amount_of_biosolids_generated:27,amount_of_biosolids_managed_land_applied:0,latitude:18.01019,longitude:-66.62173},{facility_name:"CITY OF WINTERSET",city:"Winterset",state:"Hawaii",amount_of_biosolids_generated:27,amount_of_biosolids_managed_land_applied:22,latitude:41.33447,longitude:-94.01552},{facility_name:"CITY OF EDEN WWTP",city:"Eden",state:"Texas",amount_of_biosolids_generated:27,amount_of_biosolids_managed_land_applied:0,latitude:31.204694,longitude:-99.843583},{facility_name:"BIG SANDY WWTF",city:"Big Sandy",state:"Texas",amount_of_biosolids_generated:27,amount_of_biosolids_managed_land_applied:0,latitude:32.57766,longitude:-95.11088},{facility_name:"CHEROKEE SHORES WWTP",city:"Pflugerville",state:"Texas",amount_of_biosolids_generated:26,amount_of_biosolids_managed_land_applied:26.49,latitude:32.276127,longitude:-96.094335},{facility_name:"BILMA PUD - WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:26,amount_of_biosolids_managed_land_applied:0,latitude:30.035194,longitude:-95.506028},{facility_name:"ROCK ISLAND SW STP, CITY OF",city:"Rock Island",state:"Iowa",amount_of_biosolids_generated:26,amount_of_biosolids_managed_land_applied:0,latitude:41.44893,longitude:-90.61989},{facility_name:"GILLIAN CREEK WWTP",city:"Arab",state:"Alaska",amount_of_biosolids_generated:26,amount_of_biosolids_managed_land_applied:26,latitude:34.2919,longitude:-86.4944},{facility_name:"THOMPSON WATER",city:"Fairfield",state:"Texas",amount_of_biosolids_generated:26,amount_of_biosolids_managed_land_applied:0,latitude:31.724707,longitude:-96.120197},{facility_name:"MARIETTA - WCRSA",city:"Greenville",state:"S.C.",amount_of_biosolids_generated:26,amount_of_biosolids_managed_land_applied:0,latitude:34.79757,longitude:-82.35989},{facility_name:"TOWN OF NEWPORT",city:"Newport",state:"Mont.",amount_of_biosolids_generated:26,amount_of_biosolids_managed_land_applied:25.91,latitude:34.780961,longitude:-76.865762},{facility_name:"MARY ESTHER WWTP",city:"Mary Esther",state:"Fla.",amount_of_biosolids_generated:26,amount_of_biosolids_managed_land_applied:25.9,latitude:30.41232,longitude:-86.66338},{facility_name:"CITY OF BRIDGEPORT WWTP",city:"Bridgeport",state:"Texas",amount_of_biosolids_generated:26,amount_of_biosolids_managed_land_applied:0,latitude:33.194307,longitude:-97.756523},{facility_name:"CITY OF ARCOLA WWTP",city:"Arcola",state:"Texas",amount_of_biosolids_generated:26,amount_of_biosolids_managed_land_applied:25.77,latitude:29.497153,longitude:-95.462109},{facility_name:"MAYFAIR ADDITION WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:26,amount_of_biosolids_managed_land_applied:0,latitude:32.566778,longitude:-97.400833},{facility_name:"HARRIS COUNTY MUD 119 WWTP",city:"Bellaire",state:"Texas",amount_of_biosolids_generated:26,amount_of_biosolids_managed_land_applied:0,latitude:29.896364,longitude:-95.494019},{facility_name:"HARRIS COUNTY MUD 130 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:26,amount_of_biosolids_managed_land_applied:25.69,latitude:29.895327,longitude:-95.60612},{facility_name:"PRASA COROZAL",city:"Corozal",state:"Pa.",amount_of_biosolids_generated:26,amount_of_biosolids_managed_land_applied:0,latitude:18.3410252,longitude:-66.3124463},{facility_name:"CITY OF JOSEPHINE WWTP 2",city:"Josephine",state:"Texas",amount_of_biosolids_generated:26,amount_of_biosolids_managed_land_applied:0,latitude:33.048055,longitude:-96.2925},{facility_name:"US DOE/SAVANNAH RIVER SITE",city:"Aiken County",state:"S.C.",amount_of_biosolids_generated:25,amount_of_biosolids_managed_land_applied:0,latitude:33.291667,longitude:-81.641111},{facility_name:"FORT BEND COUNTY MUD 220 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:25,amount_of_biosolids_managed_land_applied:25.25,latitude:29.721941,longitude:-95.940842},{facility_name:"CITY OF CALDWELL WWTP",city:"Caldwell",state:"Texas",amount_of_biosolids_generated:25,amount_of_biosolids_managed_land_applied:0,latitude:30.531028,longitude:-96.68275},{facility_name:"CITY OF COMO WWTP",city:"Como",state:"Texas",amount_of_biosolids_generated:25,amount_of_biosolids_managed_land_applied:0,latitude:33.054417,longitude:-95.482639},{facility_name:"ANAHUAC WWTP",city:"Anahuac",state:"Texas",amount_of_biosolids_generated:25,amount_of_biosolids_managed_land_applied:0,latitude:29.7748,longitude:-94.6722},{facility_name:"PANORAMA VILLAGE WASTEWATER TREATMENT FACILITY",city:"Panorama Village",state:"Texas",amount_of_biosolids_generated:25,amount_of_biosolids_managed_land_applied:0,latitude:30.369695,longitude:-95.497465},{facility_name:"TEMPLETON W W T F",city:"Baldwinville",state:"Mass.",amount_of_biosolids_generated:25,amount_of_biosolids_managed_land_applied:0,latitude:42.60114,longitude:-72.07502},{facility_name:"FARMERSVILLE WWTP 2",city:"Farmersville",state:"Texas",amount_of_biosolids_generated:25,amount_of_biosolids_managed_land_applied:0,latitude:33.158816,longitude:-96.38547},{facility_name:"BOYD PRISON UNIT WWTP",city:"Fairfield",state:"Texas",amount_of_biosolids_generated:25,amount_of_biosolids_managed_land_applied:0,latitude:31.664056,longitude:-96.203556},{facility_name:"TDJC COFFIELD UNIT",city:"Huntsville",state:"Texas",amount_of_biosolids_generated:25,amount_of_biosolids_managed_land_applied:0,latitude:31.780722,longitude:-95.888556},{facility_name:"CITY OF SWEENY WWTP",city:"Sweeny",state:"Texas",amount_of_biosolids_generated:24,amount_of_biosolids_managed_land_applied:0,latitude:29.056639,longitude:-95.675778},{facility_name:"TRI COUNTY POINT PROPERTY OWNERS ASSOCIATION WWTP",city:"Palacios",state:"Texas",amount_of_biosolids_generated:24,amount_of_biosolids_managed_land_applied:0,latitude:28.693703,longitude:-96.37394},{facility_name:"LAKE MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:24,amount_of_biosolids_managed_land_applied:0,latitude:29.812944,longitude:-94.992778},{facility_name:"TIMBERCREST VILLAGE WWTP",city:"Vancouve",state:"Ark.",amount_of_biosolids_generated:24,amount_of_biosolids_managed_land_applied:0,latitude:30.133801,longitude:-95.551278},{facility_name:"TIMBERWILDE WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:24,amount_of_biosolids_managed_land_applied:0,latitude:30.11751,longitude:-95.54836},{facility_name:"WELLSVILLE, CITY OF",city:"Wellsville",state:"Kan.",amount_of_biosolids_generated:24,amount_of_biosolids_managed_land_applied:24,latitude:38.71271,longitude:-95.08478},{facility_name:"CITY OF CARROLLTON",city:"Carrollton",state:"Mo.",amount_of_biosolids_generated:24,amount_of_biosolids_managed_land_applied:23.91,latitude:39.357758,longitude:-93.497942},{facility_name:"HILLSVILLE WWTP",city:"Hillsville",state:"Utah",amount_of_biosolids_generated:24,amount_of_biosolids_managed_land_applied:0,latitude:36.74942,longitude:-80.75273},{facility_name:"ROLLING FORK PUD WWTP",city:"Bellaire",state:"Texas",amount_of_biosolids_generated:24,amount_of_biosolids_managed_land_applied:0,latitude:29.891154,longitude:-95.535133},{facility_name:"HILLSBORO STP, CITY OF",city:"Hillsboro",state:"Iowa",amount_of_biosolids_generated:24,amount_of_biosolids_managed_land_applied:0,latitude:39.16512,longitude:-89.490749},{facility_name:"HARRIS CNTY FWSD 6 WWTP",city:"Channelview",state:"Texas",amount_of_biosolids_generated:24,amount_of_biosolids_managed_land_applied:0,latitude:29.77356,longitude:-95.12201},{facility_name:"HATFIELD W W T P",city:"Hatfield",state:"Mass.",amount_of_biosolids_generated:24,amount_of_biosolids_managed_land_applied:0,latitude:42.394226,longitude:-72.592828},{facility_name:"CITY OF COLDSPRING WWTP",city:"Coldspring",state:"Texas",amount_of_biosolids_generated:23,amount_of_biosolids_managed_land_applied:0,latitude:30.571278,longitude:-95.118861},{facility_name:"HARRIS COUNTY WCID 70 WWTP",city:"Crosby",state:"Texas",amount_of_biosolids_generated:23,amount_of_biosolids_managed_land_applied:0,latitude:29.94831,longitude:-95.12091},{facility_name:"TOWN OF ENFIELD",city:"Enfield",state:"Mont.",amount_of_biosolids_generated:23,amount_of_biosolids_managed_land_applied:23.41,latitude:36.18962,longitude:-77.655528},{facility_name:"WEST ORANGE WWTP",city:"Orange",state:"Texas",amount_of_biosolids_generated:23,amount_of_biosolids_managed_land_applied:0,latitude:30.084806,longitude:-93.745194},{facility_name:"CYPRESS-KLEIN UD WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:23,amount_of_biosolids_managed_land_applied:0,latitude:30.01344,longitude:-95.50857},{facility_name:"WOMAN HOLLERING TREATMENT PLANT",city:"Schertz",state:"Texas",amount_of_biosolids_generated:23,amount_of_biosolids_managed_land_applied:0,latitude:29.513879,longitude:-98.256839},{facility_name:"WINNEBAGO",city:"Winnebago",state:"Minn.",amount_of_biosolids_generated:23,amount_of_biosolids_managed_land_applied:23,latitude:43.769182,longitude:-94.185183},{facility_name:"OLDE ATLANTA CLUB WPCP",city:"Suwanee",state:"Ga.",amount_of_biosolids_generated:23,amount_of_biosolids_managed_land_applied:0,latitude:34.078537,longitude:-84.125477},{facility_name:"PARADISE ISD WWTP",city:"Paradise",state:"Texas",amount_of_biosolids_generated:23,amount_of_biosolids_managed_land_applied:0,latitude:33.1447,longitude:-97.69181},{facility_name:"MAHAFFEY ROAD WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:23,amount_of_biosolids_managed_land_applied:0,latitude:30.085694,longitude:-95.585278},{facility_name:"FORT BEND COUNTY MUD NO. 130 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:23,amount_of_biosolids_managed_land_applied:0,latitude:29.753278,longitude:-95.817444},{facility_name:"MARKHAM MUD WWTP",city:"Markham",state:"Texas",amount_of_biosolids_generated:23,amount_of_biosolids_managed_land_applied:0,latitude:28.954444,longitude:-96.067222},{facility_name:"RANSOM CANYON WWTP",city:"Ransom Canyon",state:"Texas",amount_of_biosolids_generated:23,amount_of_biosolids_managed_land_applied:0,latitude:33.52425,longitude:-101.678194},{facility_name:"CITY OF ODESSA",city:"Odessa",state:"Mo.",amount_of_biosolids_generated:22,amount_of_biosolids_managed_land_applied:22.42,latitude:38.90873067,longitude:-93.9439606},{facility_name:"COTTONWOOD CREEK WWTP",city:"Manor",state:"Texas",amount_of_biosolids_generated:22,amount_of_biosolids_managed_land_applied:0,latitude:30.347777,longitude:-97.483055},{facility_name:"OWEGO (T)",city:"Apalachin",state:"N.D.",amount_of_biosolids_generated:22,amount_of_biosolids_managed_land_applied:0,latitude:42.04513611,longitude:-76.15129184},{facility_name:"OAKELY CITY",city:"Oakley",state:"Utah",amount_of_biosolids_generated:22,amount_of_biosolids_managed_land_applied:0,latitude:40.70922,longitude:-111.301026},{facility_name:"PRAIRIE ISLAND COMMUNITY WWSL",city:"Welch",state:"Minn.",amount_of_biosolids_generated:22,amount_of_biosolids_managed_land_applied:22.276,latitude:44.52489682,longitude:-92.72695611},{facility_name:"THORNBURG SEWAGE TREATMENT PLA",city:"Thornburg",state:"Utah",amount_of_biosolids_generated:22,amount_of_biosolids_managed_land_applied:22.27,latitude:38.135833,longitude:-77.516111},{facility_name:"DURKEE MANOR WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:22,amount_of_biosolids_managed_land_applied:22.26,latitude:29.87894,longitude:-95.39775},{facility_name:"AES-PIEDMONT WATER-OCONEE CROSSING URBAN WATER REUSE FACILITY",city:"Eatonton",state:"Ga.",amount_of_biosolids_generated:22,amount_of_biosolids_managed_land_applied:22.18,latitude:33.42268,longitude:-83.266},{facility_name:"LARNED WASTEWATER PLANT",city:"Larned",state:"Kan.",amount_of_biosolids_generated:22,amount_of_biosolids_managed_land_applied:27.11,latitude:38.170611,longitude:-99.08725},{facility_name:"INVERNESS FOREST IMPROVEMENT DISTRICT WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:22,amount_of_biosolids_managed_land_applied:0,latitude:30.033806,longitude:-95.40325},{facility_name:"ALCESTER- CITY OF",city:"Alcester, City Of",state:"S.D.",amount_of_biosolids_generated:22,amount_of_biosolids_managed_land_applied:0,latitude:43.032917,longitude:-96.6575},{facility_name:"AGUA DULCE WWTF",city:"Aqua Dulce",state:"Texas",amount_of_biosolids_generated:22,amount_of_biosolids_managed_land_applied:0,latitude:27.782,longitude:-97.899167},{facility_name:"HARRIS COUNTY MUD 104 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:22,amount_of_biosolids_managed_land_applied:21.74,latitude:30.045906,longitude:-95.448517},{facility_name:"CITY OF CHARITON",city:"Chariton",state:"Hawaii",amount_of_biosolids_generated:22,amount_of_biosolids_managed_land_applied:21.6,latitude:41.01379,longitude:-93.30841},{facility_name:"FAIRVIEW CITY",city:"Fairview",state:"Utah",amount_of_biosolids_generated:22,amount_of_biosolids_managed_land_applied:0,latitude:39.606345,longitude:-111.44799},{facility_name:"CITY OF MALAKOFF WWTP",city:"Malakoff",state:"Texas",amount_of_biosolids_generated:22,amount_of_biosolids_managed_land_applied:0,latitude:32.17047,longitude:-96.014126},{facility_name:"CITY OF GRANBY",city:"Granby",state:"Mo.",amount_of_biosolids_generated:22,amount_of_biosolids_managed_land_applied:0,latitude:36.91162158,longitude:-94.25709751},{facility_name:"SQUABBLE CREEK WWTF",city:"Wylie",state:"Texas",amount_of_biosolids_generated:21,amount_of_biosolids_managed_land_applied:0,latitude:32.9515,longitude:-96.468583},{facility_name:"PRASA MAUNABO WWTP",city:"Maunabo",state:"Pa.",amount_of_biosolids_generated:21,amount_of_biosolids_managed_land_applied:0,latitude:18.00601,longitude:-65.902723},{facility_name:"CITY OF RIO GRANDE CITY - WWTP",city:"Rio Grande City",state:"Texas",amount_of_biosolids_generated:21,amount_of_biosolids_managed_land_applied:21.43,latitude:26.367306,longitude:-98.804056},{facility_name:"SOUTHWEST HARRIS CO MUD 1 - WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:21,amount_of_biosolids_managed_land_applied:0,latitude:29.631418,longitude:-95.515107},{facility_name:"FORT BEND COUNTY MUD NO.206 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:21,amount_of_biosolids_managed_land_applied:0,latitude:29.67724,longitude:-95.64354},{facility_name:"SUGARTREE WWTP",city:"Cypress",state:"Texas",amount_of_biosolids_generated:21,amount_of_biosolids_managed_land_applied:0,latitude:32.6065,longitude:-97.926972},{facility_name:"CRANE DIV., NAVAL SURFACE WARFARE CTR",city:"Crane",state:"Iowa",amount_of_biosolids_generated:21,amount_of_biosolids_managed_land_applied:21.00512,latitude:38.841611,longitude:-86.848306},{facility_name:"PICKENS CO-LIBERTY/ROPER",city:"Liberty",state:"S.C.",amount_of_biosolids_generated:21,amount_of_biosolids_managed_land_applied:21,latitude:34.802778,longitude:-82.703611},{facility_name:"ROCKDALE COUNTY (BIG HAYNES CREEK WTP)",city:"Conyers",state:"Ga.",amount_of_biosolids_generated:21,amount_of_biosolids_managed_land_applied:0,latitude:33.66358,longitude:-83.94535},{facility_name:"WESTERN HOMES WWTP",city:"The Woodlands",state:"Texas",amount_of_biosolids_generated:21,amount_of_biosolids_managed_land_applied:0,latitude:29.895222,longitude:-95.354639},{facility_name:"CITY OF CRESTON",city:"Creston",state:"Hawaii",amount_of_biosolids_generated:21,amount_of_biosolids_managed_land_applied:20.57,latitude:41.058235,longitude:-94.37190534},{facility_name:"GOFORTH WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:21,amount_of_biosolids_managed_land_applied:0,latitude:30.31801,longitude:-97.70123},{facility_name:"HARRIS CO MUD 465 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:20,amount_of_biosolids_managed_land_applied:20.41,latitude:29.888358,longitude:-95.83995},{facility_name:"OAKMONT WASTWATER TREATMENT PLANT",city:"Houston",state:"Texas",amount_of_biosolids_generated:20,amount_of_biosolids_managed_land_applied:0,latitude:30.220833,longitude:-95.241944},{facility_name:"CITY OF MARYVILLE",city:"Maryville",state:"Mo.",amount_of_biosolids_generated:20,amount_of_biosolids_managed_land_applied:0,latitude:40.348926,longitude:-94.871724},{facility_name:"CITY OF QUITMAN WWTF",city:"Quitman",state:"Texas",amount_of_biosolids_generated:20,amount_of_biosolids_managed_land_applied:0,latitude:32.795791,longitude:-95.445063},{facility_name:"ORANGEFIELD WSC WWTF",city:"Orangefield",state:"Texas",amount_of_biosolids_generated:20,amount_of_biosolids_managed_land_applied:0,latitude:30.07469,longitude:-93.8555},{facility_name:"CITY OF WASHINGTON",city:"Washington",state:"Ga.",amount_of_biosolids_generated:20,amount_of_biosolids_managed_land_applied:20.22,latitude:33.711038,longitude:-82.740986},{facility_name:"CITY OF GRAPELAND WASTEWATER TREATMENT FACILITY",city:"Grapeland",state:"Texas",amount_of_biosolids_generated:20,amount_of_biosolids_managed_land_applied:0,latitude:31.490553,longitude:-95.475577},{facility_name:"FORSYTH, CITY OF (SOUTH WPCP)",city:"Forsyth",state:"Ga.",amount_of_biosolids_generated:20,amount_of_biosolids_managed_land_applied:0,latitude:33.010583,longitude:-83.934333},{facility_name:"CITY OF DOMINO WWTP",city:"Queen City",state:"Texas",amount_of_biosolids_generated:20,amount_of_biosolids_managed_land_applied:0,latitude:33.260833,longitude:-94.131388},{facility_name:"CITY OF RENO WWTF",city:"Reno",state:"Texas",amount_of_biosolids_generated:20,amount_of_biosolids_managed_land_applied:0,latitude:33.694107,longitude:-95.480779},{facility_name:"RAYBURN COUNTRY MUD WWTP",city:"Sam Rayburn",state:"Texas",amount_of_biosolids_generated:20,amount_of_biosolids_managed_land_applied:0,latitude:31.069678,longitude:-94.039369},{facility_name:"CITY OF ROSEBUD WWTP",city:"Rosebud",state:"Texas",amount_of_biosolids_generated:20,amount_of_biosolids_managed_land_applied:0,latitude:31.064889,longitude:-96.989417},{facility_name:"NAVAL AIRSTA WHIDBEY ISLAND -",city:"Oak Harbor",state:"Wash.",amount_of_biosolids_generated:20,amount_of_biosolids_managed_land_applied:0,latitude:48.348092,longitude:-122.661924},{facility_name:"HARDWICK WPC - GILBERTVILLE",city:"Gilbertville",state:"Mass.",amount_of_biosolids_generated:20,amount_of_biosolids_managed_land_applied:0,latitude:42.353306,longitude:-72.213111},{facility_name:"BEVERLY SEWERAGE AUTHORITY",city:"Beverly",state:"Neb.",amount_of_biosolids_generated:20,amount_of_biosolids_managed_land_applied:0,latitude:40.0678,longitude:-74.92367},{facility_name:"LAKES OF FAIRHAVEN WWTP",city:"Tomball",state:"Texas",amount_of_biosolids_generated:20,amount_of_biosolids_managed_land_applied:13,latitude:30.026306,longitude:-95.758194},{facility_name:"HARRIS COUNTY MUD 530 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:20,amount_of_biosolids_managed_land_applied:19.7481372,latitude:30.059166,longitude:-95.544166},{facility_name:"GALVESTON COUNTY MUD 12 WWTP",city:"Bayou Vista",state:"Texas",amount_of_biosolids_generated:20,amount_of_biosolids_managed_land_applied:0,latitude:29.330322,longitude:-94.938198},{facility_name:"GOODMAN WWTP",city:"Waller",state:"Texas",amount_of_biosolids_generated:20,amount_of_biosolids_managed_land_applied:0,latitude:30.044283,longitude:-95.866153},{facility_name:"MORTON ROAD WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:20,amount_of_biosolids_managed_land_applied:0,latitude:29.816333,longitude:-95.806333},{facility_name:"LONE STAR RANCH WWTF",city:"Tomball",state:"Texas",amount_of_biosolids_generated:20,amount_of_biosolids_managed_land_applied:11.81,latitude:30.21779,longitude:-95.3175},{facility_name:"HARRIS COUNTY MUD 127",city:"Bellaire",state:"Texas",amount_of_biosolids_generated:19,amount_of_biosolids_managed_land_applied:0,latitude:29.755844,longitude:-95.36659},{facility_name:"MONTGOMERY COUNT MUD 137 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:19,amount_of_biosolids_managed_land_applied:0,latitude:30.148333,longitude:-95.590277},{facility_name:"CITY OF TAMA",city:"Tama",state:"Hawaii",amount_of_biosolids_generated:19,amount_of_biosolids_managed_land_applied:19.37,latitude:41.96265,longitude:-92.57956},{facility_name:"PLACEDO WWTP",city:"Placedo",state:"Texas",amount_of_biosolids_generated:19,amount_of_biosolids_managed_land_applied:0,latitude:28.697333,longitude:-96.825472},{facility_name:"WALLER COUNTY MUD 9A WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:19,amount_of_biosolids_managed_land_applied:6.92,latitude:29.845494,longitude:-95.873933},{facility_name:"WESTSIDE WWTP",city:"Rhome",state:"Texas",amount_of_biosolids_generated:19,amount_of_biosolids_managed_land_applied:0,latitude:33.043123,longitude:-97.485605},{facility_name:"SPRINK CREEK REGIONAL WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:19,amount_of_biosolids_managed_land_applied:0,latitude:30.135277,longitude:-95.589722},{facility_name:"GAZLEY CREEK WWTP",city:"Smithville",state:"Texas",amount_of_biosolids_generated:19,amount_of_biosolids_managed_land_applied:0,latitude:30.009361,longitude:-97.165528},{facility_name:"HOLIDAY VILLAGES OF LAKE LIVINGSTON WWTP",city:"Pflugerville",state:"Texas",amount_of_biosolids_generated:19,amount_of_biosolids_managed_land_applied:0,latitude:30.799417,longitude:-95.172056},{facility_name:"TOWN PLANT WWTP",city:"Iredell",state:"Texas",amount_of_biosolids_generated:19,amount_of_biosolids_managed_land_applied:0,latitude:31.98581,longitude:-97.86689},{facility_name:"MONTGOMERY COUNTY MUD NO 56 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:19,amount_of_biosolids_managed_land_applied:18.5,latitude:30.129361,longitude:-95.297972},{facility_name:"PARK VILLAGE WWTP",city:"San Antonio",state:"Texas",amount_of_biosolids_generated:18,amount_of_biosolids_managed_land_applied:0,latitude:29.795753,longitude:-98.52394},{facility_name:"FORT BEND COUNTY MUD 184 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:18,amount_of_biosolids_managed_land_applied:0,latitude:29.505555,longitude:-95.725555},{facility_name:"KINGS MANOR MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:18,amount_of_biosolids_managed_land_applied:0,latitude:30.051611,longitude:-95.236611},{facility_name:"WHITE OAK BEND WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:18,amount_of_biosolids_managed_land_applied:0,latitude:29.92018,longitude:-95.57919},{facility_name:"MILITARY HIGHWAY WSC WWTF",city:"Progreso",state:"Texas",amount_of_biosolids_generated:18,amount_of_biosolids_managed_land_applied:0,latitude:26.13575,longitude:-98.119444},{facility_name:"JENA, TOWN OF",city:"Jena",state:"La.",amount_of_biosolids_generated:18,amount_of_biosolids_managed_land_applied:0,latitude:31.677692,longitude:-92.130425},{facility_name:"TUOLUMNE CITY SANITARY DISTRICT",city:"Tuolumne",state:"Calif.",amount_of_biosolids_generated:18,amount_of_biosolids_managed_land_applied:0,latitude:37.955522,longitude:-120.243475},{facility_name:"RICE CREEK WWTF",city:"New Boston",state:"Texas",amount_of_biosolids_generated:18,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"PINE TRACE WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:18,amount_of_biosolids_managed_land_applied:17.7157473,latitude:30.102509,longitude:-95.571383},{facility_name:"HIDDEN COVE PARK WWTP",city:"Southlake",state:"Texas",amount_of_biosolids_generated:18,amount_of_biosolids_managed_land_applied:0,latitude:33.133944,longitude:-96.945472},{facility_name:"CITY OF SEDALIA",city:"Sedalia",state:"Mo.",amount_of_biosolids_generated:18,amount_of_biosolids_managed_land_applied:0,latitude:38.70972,longitude:-93.22888},{facility_name:"OLD DEERFIELD W W T P",city:"Deerfield",state:"Mass.",amount_of_biosolids_generated:18,amount_of_biosolids_managed_land_applied:0,latitude:42.5485,longitude:-72.60894},{facility_name:"WEST MONTGOMERY WWTP",city:"The Woolands",state:"Texas",amount_of_biosolids_generated:17,amount_of_biosolids_managed_land_applied:0,latitude:29.884944,longitude:-95.460472},{facility_name:"HARRIS COUNTY MUD 36 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:17,amount_of_biosolids_managed_land_applied:17.46,latitude:29.991966,longitude:-95.405026},{facility_name:"CITY OF JACKSON",city:"Jackson",state:"Ga.",amount_of_biosolids_generated:17,amount_of_biosolids_managed_land_applied:17.46,latitude:33.271,longitude:-83.947139},{facility_name:"RANKIN ROAD WEST MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:17,amount_of_biosolids_managed_land_applied:0,latitude:29.972055,longitude:-95.452092},{facility_name:"ARAB SEWER BOARD",city:"Arab",state:"Alaska",amount_of_biosolids_generated:17,amount_of_biosolids_managed_land_applied:17.2,latitude:34.2919,longitude:-86.4944},{facility_name:"CITY OF GUSTINE WWTP",city:"Gustine",state:"Texas",amount_of_biosolids_generated:17,amount_of_biosolids_managed_land_applied:0,latitude:31.845012,longitude:-98.403328},{facility_name:"CITY OF HAMLIN WWTP",city:"Hamlin",state:"Texas",amount_of_biosolids_generated:17,amount_of_biosolids_managed_land_applied:0,latitude:32.881421,longitude:-100.121557},{facility_name:"HARRIS COUNTY WCID 50 WWTP",city:"El Lago",state:"Texas",amount_of_biosolids_generated:17,amount_of_biosolids_managed_land_applied:0,latitude:29.5716,longitude:-95.04015},{facility_name:"NORTH TEXS REGIONAL AIRPORT WWTF",city:"Denison",state:"Texas",amount_of_biosolids_generated:17,amount_of_biosolids_managed_land_applied:0,latitude:33.71718,longitude:-96.66382},{facility_name:"MILBANK WASTEWATER TRMT PLNT",city:"Milbank",state:"S.D.",amount_of_biosolids_generated:17,amount_of_biosolids_managed_land_applied:0,latitude:45.229428,longitude:-96.591168},{facility_name:"FOREST TRACE AKA WILLIS WAUKEGAN WWTP",city:"Porter",state:"Texas",amount_of_biosolids_generated:17,amount_of_biosolids_managed_land_applied:0,latitude:30.30977,longitude:-95.34006},{facility_name:"CITY OF GALVESTON MAIN WWTP",city:"Galveston",state:"Texas",amount_of_biosolids_generated:17,amount_of_biosolids_managed_land_applied:0,latitude:29.299155,longitude:-94.82871},{facility_name:"CITY OF CRANFILLS GAP WWTP",city:"Cranfills Gap",state:"Texas",amount_of_biosolids_generated:17,amount_of_biosolids_managed_land_applied:0,latitude:31.778698,longitude:-97.829828},{facility_name:"WHITE BLUFF WWTP",city:"Pflugerville",state:"Texas",amount_of_biosolids_generated:16,amount_of_biosolids_managed_land_applied:0,latitude:32.027889,longitude:-97.3985},{facility_name:"CREEKSIDE VILLAGE WWTP",city:"Tomball",state:"Texas",amount_of_biosolids_generated:16,amount_of_biosolids_managed_land_applied:16.47,latitude:30.130667,longitude:-95.378139},{facility_name:"TOWER TERRACE - WWTP",city:"Sugarland",state:"Texas",amount_of_biosolids_generated:16,amount_of_biosolids_managed_land_applied:0,latitude:29.781333,longitude:-94.88325},{facility_name:"SANTA CLARA CREEK 1 WWTP",city:"Marion",state:"Texas",amount_of_biosolids_generated:16,amount_of_biosolids_managed_land_applied:0,latitude:29.527304,longitude:-98.111036},{facility_name:"JOINES ROAD REG WWTF",city:"Progreso",state:"Texas",amount_of_biosolids_generated:16,amount_of_biosolids_managed_land_applied:0,latitude:26.072944,longitude:-97.64725},{facility_name:"CITY OF ODESSA",city:"Odessa",state:"Mo.",amount_of_biosolids_generated:16,amount_of_biosolids_managed_land_applied:16.16,latitude:39.017889,longitude:-93.981472},{facility_name:"NORTHLAKE WWTP",city:"Dallas",state:"Texas",amount_of_biosolids_generated:16,amount_of_biosolids_managed_land_applied:0,latitude:33.078055,longitude:-97.251388},{facility_name:"PORT ISABEL DETENTION CTR WWTF",city:"Los Fresnos",state:"Texas",amount_of_biosolids_generated:16,amount_of_biosolids_managed_land_applied:0,latitude:26.190505,longitude:-97.351777},{facility_name:"CITY OF TOLAR WWTP",city:"Tolar",state:"Texas",amount_of_biosolids_generated:16,amount_of_biosolids_managed_land_applied:0,latitude:32.385694,longitude:-97.916694},{facility_name:"COLONIAL HILLS WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:16,amount_of_biosolids_managed_land_applied:0,latitude:29.917096,longitude:-95.38666},{facility_name:"PINEWOOD PLACE MHP WWTP",city:"Vancouver",state:"Ark.",amount_of_biosolids_generated:16,amount_of_biosolids_managed_land_applied:0,latitude:30.08325,longitude:-95.560472},{facility_name:"GREENWOOD VILLAGE WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:16,amount_of_biosolids_managed_land_applied:0,latitude:29.87517,longitude:-95.34078},{facility_name:"HARRIS COUNTY MUD 319 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:16,amount_of_biosolids_managed_land_applied:0,latitude:30.00979,longitude:-95.79921},{facility_name:"WHARTON COUNTY WCID 2 WWTP",city:"East Bernard",state:"Texas",amount_of_biosolids_generated:16,amount_of_biosolids_managed_land_applied:0,latitude:29.529426,longitude:-96.057141},{facility_name:"FORT BEND COUNTY MUD 124 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:16,amount_of_biosolids_managed_land_applied:0,latitude:29.750519,longitude:-95.788639},{facility_name:"WILLOW CREEK WWTP",city:"Smithville",state:"Texas",amount_of_biosolids_generated:16,amount_of_biosolids_managed_land_applied:0,latitude:30.00844,longitude:-97.13494},{facility_name:"LOWER SIOUX INDIAN RESERVATION JACKPOT JUNCTION WWSL",city:"Redwood Falls",state:"Minn.",amount_of_biosolids_generated:16,amount_of_biosolids_managed_land_applied:0,latitude:44.514694,longitude:-94.985325},{facility_name:"WALLER COUNTY MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:15,amount_of_biosolids_managed_land_applied:15.3978942,latitude:29.77668,longitude:-95.9108},{facility_name:"MARE BRANCH WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:15,amount_of_biosolids_managed_land_applied:6.88945727,latitude:30.196861,longitude:-95.199361},{facility_name:"MORGANS POINT WWTP",city:"Morgans Point",state:"Texas",amount_of_biosolids_generated:15,amount_of_biosolids_managed_land_applied:0,latitude:29.671107,longitude:-95.005809},{facility_name:"SANTA CLAUS WWTP, TOWN OF",city:"Santa Claus",state:"Iowa",amount_of_biosolids_generated:15,amount_of_biosolids_managed_land_applied:0,latitude:38.105861,longitude:-86.904917},{facility_name:"OLD TOWN SPRING WWTP",city:"Tomball",state:"Texas",amount_of_biosolids_generated:15,amount_of_biosolids_managed_land_applied:0,latitude:29.784031,longitude:-95.580147},{facility_name:"CADDO VILLAGE WWTP",city:"Tomball",state:"Texas",amount_of_biosolids_generated:15,amount_of_biosolids_managed_land_applied:0,latitude:30.444972,longitude:-95.451639},{facility_name:"CITY OF TOM BEAN WWTP",city:"Tom Bean",state:"Texas",amount_of_biosolids_generated:15,amount_of_biosolids_managed_land_applied:0,latitude:33.515361,longitude:-96.478306},{facility_name:"PORT O'CONNOR IMPROVEMENT DISTRICT WWTP",city:"Port O'Connor",state:"Texas",amount_of_biosolids_generated:15,amount_of_biosolids_managed_land_applied:0,latitude:28.434167,longitude:-96.456917},{facility_name:"CITY OF RISING STAR WWTP",city:"Rising Star",state:"Texas",amount_of_biosolids_generated:15,amount_of_biosolids_managed_land_applied:0,latitude:32.099306,longitude:-98.944889},{facility_name:"GOUVERNEUR (V)",city:"Gouverneur",state:"N.D.",amount_of_biosolids_generated:15,amount_of_biosolids_managed_land_applied:0,latitude:44.33623,longitude:-75.46967},{facility_name:"PROGRESO WWTF",city:"Progreso",state:"Texas",amount_of_biosolids_generated:15,amount_of_biosolids_managed_land_applied:0,latitude:26.11525,longitude:-97.938694},{facility_name:"WESTERN PINES MHP WWTF",city:"Sugar Land",state:"Texas",amount_of_biosolids_generated:15,amount_of_biosolids_managed_land_applied:0,latitude:29.81786,longitude:-95.72566},{facility_name:"MIMS CREEK WWTP",city:"Fairfield",state:"Texas",amount_of_biosolids_generated:15,amount_of_biosolids_managed_land_applied:0,latitude:31.694889,longitude:-96.142167},{facility_name:"ISLA BLANCA WWTP",city:"Port Isabel",state:"Texas",amount_of_biosolids_generated:15,amount_of_biosolids_managed_land_applied:0,latitude:26.0633,longitude:-97.2211},{facility_name:"ROYAL LAKE ESTATES WWTP",city:"Sugar Land",state:"Texas",amount_of_biosolids_generated:14,amount_of_biosolids_managed_land_applied:0,latitude:29.523,longitude:-95.666056},{facility_name:"VILLAGE TRACE WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:14,amount_of_biosolids_managed_land_applied:0,latitude:29.4955,longitude:-95.280194},{facility_name:"CEDAR POINT WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:14,amount_of_biosolids_managed_land_applied:0,latitude:30.803778,longitude:-95.076583},{facility_name:"MARION WWTP",city:"Marion",state:"Texas",amount_of_biosolids_generated:14,amount_of_biosolids_managed_land_applied:0,latitude:29.564889,longitude:-98.143583},{facility_name:"DEL LAGO WWTF",city:"Atlanta",state:"Ga.",amount_of_biosolids_generated:14,amount_of_biosolids_managed_land_applied:0,latitude:30.39575,longitude:-95.639667},{facility_name:"CITY OF JAMAICA BEACH WWTP",city:"Jamaica Beach",state:"Texas",amount_of_biosolids_generated:14,amount_of_biosolids_managed_land_applied:0,latitude:29.199126,longitude:-94.988517},{facility_name:"SINGING HILLS WWTP",city:"Bulverde",state:"Texas",amount_of_biosolids_generated:14,amount_of_biosolids_managed_land_applied:0,latitude:29.807777,longitude:-98.420277},{facility_name:"METHODIST HOME BOY'S RANCH",city:"Waco",state:"Texas",amount_of_biosolids_generated:14,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"SHADY OAKS WWTP",city:"Richmond",state:"Utah",amount_of_biosolids_generated:14,amount_of_biosolids_managed_land_applied:0,latitude:32.239007,longitude:-98.167118},{facility_name:"COUNTRY SQUIRE WWTF",city:"Orange",state:"Texas",amount_of_biosolids_generated:14,amount_of_biosolids_managed_land_applied:0,latitude:30.186093,longitude:-93.763886},{facility_name:"LIBERTY CITY WSC WWTP",city:"Kilgore",state:"Texas",amount_of_biosolids_generated:14,amount_of_biosolids_managed_land_applied:0,latitude:32.450833,longitude:-94.935889},{facility_name:"DUPAGE COUNTY-NORDIC PARK STP",city:"Itasca",state:"Iowa",amount_of_biosolids_generated:14,amount_of_biosolids_managed_land_applied:0,latitude:41.963333,longitude:-88.025},{facility_name:"TAMU RESEARCH & EXT CTR BEAUMONT WWTP",city:"Beaumont",state:"Texas",amount_of_biosolids_generated:14,amount_of_biosolids_managed_land_applied:0,latitude:30.0643,longitude:-94.294521},{facility_name:"ROYALWOOD MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:14,amount_of_biosolids_managed_land_applied:13.61,latitude:29.826616,longitude:-95.183771},{facility_name:"CLEARWATER COVE WWTP",city:"Willis",state:"Texas",amount_of_biosolids_generated:14,amount_of_biosolids_managed_land_applied:0,latitude:30.41087,longitude:-95.57284},{facility_name:"MONTGOMERY COUNTY MUD 157 WWTP 1",city:"Houston",state:"Texas",amount_of_biosolids_generated:14,amount_of_biosolids_managed_land_applied:0,latitude:30.206388,longitude:-95.341388},{facility_name:"CITY OF DANBURY CENTRAL WWTP",city:"Danbury",state:"Texas",amount_of_biosolids_generated:14,amount_of_biosolids_managed_land_applied:0,latitude:29.22528,longitude:-95.35333},{facility_name:"TDCJ CLEMENS UNIT WWTP",city:"Huntsville",state:"Texas",amount_of_biosolids_generated:13,amount_of_biosolids_managed_land_applied:0,latitude:28.989444,longitude:-95.5175},{facility_name:"SMITHVILLE STP",city:"Smithville",state:"Tenn.",amount_of_biosolids_generated:13,amount_of_biosolids_managed_land_applied:13.16,latitude:35.960896,longitude:-85.793317},{facility_name:"MONTGOMERY COUNTY MUD 127 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:13,amount_of_biosolids_managed_land_applied:13.11,latitude:30.137838,longitude:-95.37304},{facility_name:"SEIS LAGOS WWTP",city:"Wylie",state:"Texas",amount_of_biosolids_generated:13,amount_of_biosolids_managed_land_applied:0,latitude:33.077285,longitude:-96.568891},{facility_name:"TUCUMCARI, CITY OF",city:"Tucumcari",state:"N.D.",amount_of_biosolids_generated:13,amount_of_biosolids_managed_land_applied:13,latitude:35.18642,longitude:-103.71962},{facility_name:"TDCJ ESTELLE UNIT",city:"Huntsville",state:"Texas",amount_of_biosolids_generated:13,amount_of_biosolids_managed_land_applied:0,latitude:30.881135,longitude:-95.501653},{facility_name:"ATASCOCITA VILLAGE MHP WWTP",city:"Humble",state:"Texas",amount_of_biosolids_generated:13,amount_of_biosolids_managed_land_applied:0,latitude:29.959025,longitude:-95.259807},{facility_name:"ROSEMEADOWS III - WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:13,amount_of_biosolids_managed_land_applied:0,latitude:29.388056,longitude:-95.776278},{facility_name:"MOUNT HOUSTON UTILITIES WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:13,amount_of_biosolids_managed_land_applied:0,latitude:29.893,longitude:-95.318806},{facility_name:"SKY RANCHES WETLANDS WWTP",city:"Van",state:"Texas",amount_of_biosolids_generated:13,amount_of_biosolids_managed_land_applied:0,latitude:32.566722,longitude:-95.579417},{facility_name:"SIERRA VISTA WEST WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:13,amount_of_biosolids_managed_land_applied:0,latitude:29.426388,longitude:-95.461111},{facility_name:"NORTH FOREST MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:13,amount_of_biosolids_managed_land_applied:0,latitude:30.00256,longitude:-95.44202},{facility_name:"PRASA TOA ALTA WWTP",city:"Toa Alta",state:"Pa.",amount_of_biosolids_generated:13,amount_of_biosolids_managed_land_applied:12.59,latitude:18.385526,longitude:-66.245186},{facility_name:"HARRIS CO MUD 1 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:12,amount_of_biosolids_managed_land_applied:12.38,latitude:29.846768,longitude:-95.164648},{facility_name:"LOVES TRAVEL STOP AT WINONA",city:"Oklahoma City",state:"Okla.",amount_of_biosolids_generated:12,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"RICARDO WWTP",city:"Kingsville",state:"Texas",amount_of_biosolids_generated:12,amount_of_biosolids_managed_land_applied:0,latitude:27.408806,longitude:-97.850139},{facility_name:"PORT ISABEL WWTP",city:"Port Isabel",state:"Texas",amount_of_biosolids_generated:12,amount_of_biosolids_managed_land_applied:0,latitude:26.06448,longitude:-97.22221},{facility_name:"PENITAS WWTP",city:"Laredo",state:"Texas",amount_of_biosolids_generated:12,amount_of_biosolids_managed_land_applied:0,latitude:27.523111,longitude:-99.524194},{facility_name:"DECATUR WTP",city:"Decatur",state:"Texas",amount_of_biosolids_generated:12,amount_of_biosolids_managed_land_applied:0,latitude:33.232094,longitude:-97.623029},{facility_name:"HAPPY HILL FARM CHILDRENS HOME WWTP",city:"Granbury",state:"Texas",amount_of_biosolids_generated:12,amount_of_biosolids_managed_land_applied:0,latitude:32.29387,longitude:-97.7341},{facility_name:"RAINTREE ACRES MHP WWTP",city:"Denver",state:"Colo.",amount_of_biosolids_generated:12,amount_of_biosolids_managed_land_applied:0,latitude:29.57783,longitude:-95.32103},{facility_name:"CITY OF KENDLETON WWTP",city:"Kendleton",state:"Texas",amount_of_biosolids_generated:12,amount_of_biosolids_managed_land_applied:0,latitude:29.447528,longitude:-95.993583},{facility_name:"CAVE SPRING, CITY OF (CAVE SPRING WPCP)",city:"Cave Spring",state:"Ga.",amount_of_biosolids_generated:12,amount_of_biosolids_managed_land_applied:12.06,latitude:34.119194,longitude:-85.335639},{facility_name:"GARDNER, CITY OF",city:"Gardner",state:"Kan.",amount_of_biosolids_generated:12,amount_of_biosolids_managed_land_applied:12,latitude:38.80255137,longitude:-94.92380983},{facility_name:"VALLEY VIEW WWTF",city:"Valley View",state:"Texas",amount_of_biosolids_generated:12,amount_of_biosolids_managed_land_applied:0,latitude:33.468167,longitude:-97.160833},{facility_name:"PRASA - CULEBRA WWTP",city:"Culebra",state:"Pa.",amount_of_biosolids_generated:12,amount_of_biosolids_managed_land_applied:0,latitude:18.32,longitude:-65.2808},{facility_name:"CITY OF CHINA WWTF",city:"China",state:"Texas",amount_of_biosolids_generated:12,amount_of_biosolids_managed_land_applied:0,latitude:30.0692,longitude:-94.338006},{facility_name:"HARRIS COUNTY MUD 565 WWTP",city:"Rosenberg",state:"Texas",amount_of_biosolids_generated:12,amount_of_biosolids_managed_land_applied:0,latitude:30.044166,longitude:-95.793333},{facility_name:"TDCJ JESTER 3 UNIT WWTP",city:"Huntsville",state:"Texas",amount_of_biosolids_generated:12,amount_of_biosolids_managed_land_applied:0,latitude:29.619944,longitude:-95.711722},{facility_name:"GRANGER PINES WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:12,amount_of_biosolids_managed_land_applied:0,latitude:30.2375,longitude:-95.321111},{facility_name:"CITY OF CHANDLER WWTP",city:"Chandler",state:"Texas",amount_of_biosolids_generated:12,amount_of_biosolids_managed_land_applied:0,latitude:32.294861,longitude:-95.469389},{facility_name:"CHULA VISTA WWTF",city:"Crystal City",state:"Texas",amount_of_biosolids_generated:11,amount_of_biosolids_managed_land_applied:0,latitude:28.656389,longitude:-99.834944},{facility_name:"HARRIS COUNTY WCID 113 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:11,amount_of_biosolids_managed_land_applied:11.34,latitude:29.9555,longitude:-95.641056},{facility_name:"ROSITA VALLEY WWTP",city:"Eagle Pass",state:"Texas",amount_of_biosolids_generated:11,amount_of_biosolids_managed_land_applied:11.34,latitude:28.606559,longitude:-100.433623},{facility_name:"CHAMBERS COUNTY DISTRICT NO 1 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:11,amount_of_biosolids_managed_land_applied:0,latitude:29.706666,longitude:-94.910277},{facility_name:"CITY OF CLARKSVILLE WWTP",city:"Clarksville",state:"Texas",amount_of_biosolids_generated:11,amount_of_biosolids_managed_land_applied:0,latitude:33.610303,longitude:-95.05523},{facility_name:"PRASA - UTUADO NEW WWTPT",city:"Utuado",state:"Pa.",amount_of_biosolids_generated:11,amount_of_biosolids_managed_land_applied:11.17,latitude:18.30925,longitude:-66.687694},{facility_name:"CITY OF HALLETTSVILLE",city:"Hallettsville",state:"Texas",amount_of_biosolids_generated:11,amount_of_biosolids_managed_land_applied:0,latitude:29.43906,longitude:-96.94382},{facility_name:"TIMBERLAKE WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:11,amount_of_biosolids_managed_land_applied:0,latitude:29.963278,longitude:-95.619389},{facility_name:"PRASA PARCELAS BORINQUEN WWTP",city:"Caguas",state:"Pa.",amount_of_biosolids_generated:11,amount_of_biosolids_managed_land_applied:0,latitude:18.186368,longitude:-66.047962},{facility_name:"MAGNOLIA RESERVE WWTF",city:"Tomball",state:"Texas",amount_of_biosolids_generated:11,amount_of_biosolids_managed_land_applied:10.89,latitude:30.265277,longitude:-95.696666},{facility_name:"MOSTYN MANOR WWTF",city:"Tomball",state:"Texas",amount_of_biosolids_generated:11,amount_of_biosolids_managed_land_applied:10.8,latitude:30.249905,longitude:-95.662917},{facility_name:"CITY OF ALPINE MUNICIPAL WWTF",city:"Alpine",state:"Texas",amount_of_biosolids_generated:11,amount_of_biosolids_managed_land_applied:0,latitude:30.398944,longitude:-103.644694},{facility_name:"PRASA NARANJITO",city:"Naranjito",state:"Pa.",amount_of_biosolids_generated:11,amount_of_biosolids_managed_land_applied:0,latitude:18.30086,longitude:-66.245543},{facility_name:"ROCKY POINT ESTATES MHP WWTP",city:"Glendale",state:"Colo.",amount_of_biosolids_generated:11,amount_of_biosolids_managed_land_applied:0,latitude:33.04831,longitude:-97.12906},{facility_name:"SOUTH PITTSBURG STP",city:"South Pittsburg",state:"Tenn.",amount_of_biosolids_generated:11,amount_of_biosolids_managed_land_applied:5.3,latitude:35.002893,longitude:-85.698289},{facility_name:"NW HARRIS COUNTY MUD 36 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:11,amount_of_biosolids_managed_land_applied:0,latitude:30.051306,longitude:-95.470472},{facility_name:"SAN JO COVE UTILITIES WWTP",city:"Willis",state:"Texas",amount_of_biosolids_generated:11,amount_of_biosolids_managed_land_applied:0,latitude:30.448889,longitude:-95.549194},{facility_name:"SANTA FE 2 WWTP",city:"New Wavery",state:"Texas",amount_of_biosolids_generated:11,amount_of_biosolids_managed_land_applied:0,latitude:30.153055,longitude:-95.014444},{facility_name:"SHADOW BAY WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:11,amount_of_biosolids_managed_land_applied:0,latitude:30.451,longitude:-95.564694},{facility_name:"REDWOOD WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:11,amount_of_biosolids_managed_land_applied:0,latitude:29.837444,longitude:-95.232972},{facility_name:"LAKE CONROE FOREST WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:11,amount_of_biosolids_managed_land_applied:0,latitude:30.35791,longitude:-95.60273},{facility_name:"CITY OF MENARD WWTP",city:"Menard",state:"Texas",amount_of_biosolids_generated:11,amount_of_biosolids_managed_land_applied:0,latitude:30.918778,longitude:-99.778667},{facility_name:"MENARD WTP",city:"Menard",state:"Texas",amount_of_biosolids_generated:11,amount_of_biosolids_managed_land_applied:0,latitude:30.91733,longitude:-99.78541},{facility_name:"TIDWELL TIMBERS WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:10,amount_of_biosolids_managed_land_applied:0,latitude:29.850528,longitude:-95.229807},{facility_name:"NORTH BELT FOREST UD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:10,amount_of_biosolids_managed_land_applied:0,latitude:29.949639,longitude:-95.247694},{facility_name:"CITY OF BUENA VISTA",city:"Buena Vista",state:"Utah",amount_of_biosolids_generated:10,amount_of_biosolids_managed_land_applied:0,latitude:37.72405,longitude:-79.3645},{facility_name:"FORT DAVIS WWTF",city:"Fort Davis",state:"Texas",amount_of_biosolids_generated:10,amount_of_biosolids_managed_land_applied:0,latitude:30.594528,longitude:-103.873167},{facility_name:"HARRIS COUNTY WCID 109 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:10,amount_of_biosolids_managed_land_applied:96.4298579,latitude:29.9717,longitude:-95.494902},{facility_name:"NORTHFIELD W W T F",city:"Northfield",state:"Mass.",amount_of_biosolids_generated:10,amount_of_biosolids_managed_land_applied:0,latitude:42.701976,longitude:-72.458138},{facility_name:"SOUTH WEST WWTP",city:"Henrietta",state:"Texas",amount_of_biosolids_generated:10,amount_of_biosolids_managed_land_applied:0,latitude:33.809959,longitude:-98.175387},{facility_name:"DOWDELL PUD WWTP 2",city:"Houston",state:"Texas",amount_of_biosolids_generated:10,amount_of_biosolids_managed_land_applied:0,latitude:30.079722,longitude:-95.5377},{facility_name:"JEFFERSON COUNTY COMMISSION ENVIRONMENTAL SERVICES DEPARTMENT",city:"Birmingham",state:"Alaska",amount_of_biosolids_generated:10,amount_of_biosolids_managed_land_applied:10,latitude:33.8081,longitude:-86.8319},{facility_name:"CITY OF HENRIETTA WTP",city:"Henrietta",state:"Texas",amount_of_biosolids_generated:10,amount_of_biosolids_managed_land_applied:0,latitude:33.830709,longitude:-98.195388},{facility_name:"TIMBERLAND WWTP",city:"Porter",state:"Texas",amount_of_biosolids_generated:10,amount_of_biosolids_managed_land_applied:0,latitude:30.13589,longitude:-95.259442},{facility_name:"HENRIETTA NORTH WWTP",city:"Henrietta",state:"Texas",amount_of_biosolids_generated:10,amount_of_biosolids_managed_land_applied:0,latitude:33.827194,longitude:-98.201389},{facility_name:"SAN SIMEON WWTP",city:"San Simeon",state:"Calif.",amount_of_biosolids_generated:10,amount_of_biosolids_managed_land_applied:0,latitude:35.611553,longitude:-121.146167},{facility_name:"JEKYLL ISLAND WPCP-STATE PARK AUTHORITY",city:"Jekyll Island",state:"Ga.",amount_of_biosolids_generated:10,amount_of_biosolids_managed_land_applied:0,latitude:31.044177,longitude:-81.421708},{facility_name:"SHERIDAN WWTP",city:"Sheridan",state:"Texas",amount_of_biosolids_generated:10,amount_of_biosolids_managed_land_applied:0,latitude:29.494944,longitude:-96.665528},{facility_name:"S.C. UTILITIES WWTP",city:"Spring",state:"Texas",amount_of_biosolids_generated:10,amount_of_biosolids_managed_land_applied:0,latitude:30.011861,longitude:-95.589083},{facility_name:"STAFFORD MHP WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:10,amount_of_biosolids_managed_land_applied:0,latitude:29.595833,longitude:-95.552667},{facility_name:"ASHLEY OAKS WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:10,amount_of_biosolids_managed_land_applied:0,latitude:29.38276,longitude:-95.243487},{facility_name:"HARRIS COUNTY MUD 286 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:10,amount_of_biosolids_managed_land_applied:0,latitude:29.987139,longitude:-95.583528},{facility_name:"TEXAS A&M UNIVERSITY AT GALVESTON",city:"Galveston",state:"Texas",amount_of_biosolids_generated:10,amount_of_biosolids_managed_land_applied:0,latitude:29.3168,longitude:-94.81984},{facility_name:"HARRIS COUNTY MUD 50 WWTP 2",city:"Crosby",state:"Texas",amount_of_biosolids_generated:10,amount_of_biosolids_managed_land_applied:0,latitude:29.877046,longitude:-95.06042},{facility_name:"HIGHLANDS OF SALADO WWTP",city:"Salado",state:"Texas",amount_of_biosolids_generated:10,amount_of_biosolids_managed_land_applied:0,latitude:30.937222,longitude:-97.521111},{facility_name:"SOMERSET WWTP",city:"Somerset",state:"Texas",amount_of_biosolids_generated:10,amount_of_biosolids_managed_land_applied:0,latitude:29.214583,longitude:-98.649417},{facility_name:"HARRIS COUNTY MUD 122 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:10,amount_of_biosolids_managed_land_applied:9.66,latitude:29.617411,longitude:-95.518621},{facility_name:"TDCJ ELLIS UNIT WWTP",city:"Huntsville",state:"Texas",amount_of_biosolids_generated:10,amount_of_biosolids_managed_land_applied:0,latitude:30.884916,longitude:-95.455087},{facility_name:"CITY OF YORKTOWN WWTP",city:"Yorktown",state:"Texas",amount_of_biosolids_generated:10,amount_of_biosolids_managed_land_applied:0,latitude:28.97175,longitude:-97.50075},{facility_name:"PRASA YAUCO STP",city:"Yauco",state:"Pa.",amount_of_biosolids_generated:9,amount_of_biosolids_managed_land_applied:0,latitude:18.025266,longitude:-66.841581},{facility_name:"HARDWICK W P C - WHEELWRIGHT",city:"Wheelwright",state:"Mass.",amount_of_biosolids_generated:9,amount_of_biosolids_managed_land_applied:0,latitude:42.350037,longitude:-72.139237},{facility_name:"COUNTRY VISTA WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:9,amount_of_biosolids_managed_land_applied:0,latitude:32.54559,longitude:-97.25771},{facility_name:"CITY OF LEESBURG",city:"Leesburg",state:"Ga.",amount_of_biosolids_generated:9,amount_of_biosolids_managed_land_applied:0,latitude:31.717167,longitude:-84.183361},{facility_name:"PLUM CREEK WWTP",city:"Albany",state:"Texas",amount_of_biosolids_generated:9,amount_of_biosolids_managed_land_applied:0,latitude:32.711222,longitude:-99.290056},{facility_name:"HINSDALE TOWN OF",city:"Hinsdale",state:"Neb.",amount_of_biosolids_generated:9,amount_of_biosolids_managed_land_applied:0,latitude:42.780338,longitude:-72.49205},{facility_name:"BIG CANOE WPCP",city:"Jasper",state:"Ga.",amount_of_biosolids_generated:9,amount_of_biosolids_managed_land_applied:0,latitude:34.427879,longitude:-84.279103},{facility_name:"CANEY CREEK MUD OF MATAGORDA COUNTY",city:"Sargent",state:"Texas",amount_of_biosolids_generated:9,amount_of_biosolids_managed_land_applied:0,latitude:28.767615,longitude:-95.625739},{facility_name:"CORINTHIAN POINT MUD 2 - WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:9,amount_of_biosolids_managed_land_applied:0,latitude:30.459167,longitude:-95.568306},{facility_name:"WINDMILL RANCH WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:9,amount_of_biosolids_managed_land_applied:0,latitude:30.156861,longitude:-97.44775},{facility_name:"TEXAS NATIONAL MUD",city:"Houston",state:"Texas",amount_of_biosolids_generated:9,amount_of_biosolids_managed_land_applied:0,latitude:30.415194,longitude:-95.430194},{facility_name:"PARK CREEK WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:9,amount_of_biosolids_managed_land_applied:0,latitude:30.009172,longitude:-95.675625},{facility_name:"INDIAN SHORES PLANT",city:"Bellaire",state:"Texas",amount_of_biosolids_generated:9,amount_of_biosolids_managed_land_applied:0,latitude:29.61475,longitude:-95.5099},{facility_name:"LUCE BAYOU PUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:9,amount_of_biosolids_managed_land_applied:0,latitude:30.061917,longitude:-95.077},{facility_name:"WHARTON COUNTY WCID 1 WWTP",city:"Louise",state:"Texas",amount_of_biosolids_generated:9,amount_of_biosolids_managed_land_applied:0,latitude:29.114139,longitude:-96.403278},{facility_name:"LENNOX, CITY OF",city:"Lennox, City Of",state:"S.D.",amount_of_biosolids_generated:9,amount_of_biosolids_managed_land_applied:0,latitude:43.343472,longitude:-96.907666},{facility_name:"PRASA MOROVIS",city:"Morovis",state:"Pa.",amount_of_biosolids_generated:9,amount_of_biosolids_managed_land_applied:0,latitude:18.34123498,longitude:-66.42603628},{facility_name:"VARCO W LITTLE YORK FACILITY",city:"Houston",state:"Texas",amount_of_biosolids_generated:9,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"HARRIS CO MUD 1 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:9,amount_of_biosolids_managed_land_applied:8.82,latitude:30.110724,longitude:-95.536643},{facility_name:"GALVESTON COUNTY FWSD 6 WWTP",city:"Tiki Island",state:"Texas",amount_of_biosolids_generated:9,amount_of_biosolids_managed_land_applied:8.6856372,latitude:29.300778,longitude:-94.905194},{facility_name:"WINDY HILL UTILITY WWTF",city:"San Antonio",state:"Texas",amount_of_biosolids_generated:9,amount_of_biosolids_managed_land_applied:0,latitude:30.045833,longitude:-97.80666},{facility_name:"CITY OF NEWTON WWTF",city:"Newton",state:"Texas",amount_of_biosolids_generated:9,amount_of_biosolids_managed_land_applied:0,latitude:30.833888,longitude:-93.737777},{facility_name:"DIXON CORRECTIONAL CENTER STP",city:"Dixon",state:"Iowa",amount_of_biosolids_generated:9,amount_of_biosolids_managed_land_applied:0,latitude:41.873652,longitude:-89.478705},{facility_name:"TDCJ BETO UNIT WWTP",city:"Huntsville",state:"Texas",amount_of_biosolids_generated:8,amount_of_biosolids_managed_land_applied:0,latitude:31.76088,longitude:-95.826977},{facility_name:"CEDRIC SMITH ELEMENTARY SCHOOL WWTP",city:"Magnolia",state:"Texas",amount_of_biosolids_generated:8,amount_of_biosolids_managed_land_applied:0,latitude:30.172617,longitude:-95.60702},{facility_name:"STABLE GATE WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:8,amount_of_biosolids_managed_land_applied:0,latitude:30.0012,longitude:-95.65977},{facility_name:"IMPERIAL VALLEY WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:8,amount_of_biosolids_managed_land_applied:0,latitude:30.012155,longitude:-95.409601},{facility_name:"GREENFIELD WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:8,amount_of_biosolids_managed_land_applied:0,latitude:30.217417,longitude:-95.551306},{facility_name:"CITY OF BELLEVUE WWTP",city:"Bellevue",state:"Texas",amount_of_biosolids_generated:8,amount_of_biosolids_managed_land_applied:0,latitude:33.643417,longitude:-98.018083},{facility_name:"CITY OF GRAND SALINE WWTF",city:"Grand Saline",state:"Texas",amount_of_biosolids_generated:8,amount_of_biosolids_managed_land_applied:0,latitude:32.671222,longitude:-95.701333},{facility_name:"PARADISE COVE WWTP",city:"Conroe",state:"Texas",amount_of_biosolids_generated:8,amount_of_biosolids_managed_land_applied:0,latitude:30.460689,longitude:-95.545945},{facility_name:"CITY OF SOUR LAKE WWTP",city:"Sour Lake",state:"Texas",amount_of_biosolids_generated:8,amount_of_biosolids_managed_land_applied:0,latitude:30.13878,longitude:-94.41261},{facility_name:"WESTMONT MHP WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:8,amount_of_biosolids_managed_land_applied:7.89,latitude:30.341917,longitude:-95.555444},{facility_name:"TABERNASH MEADOWS WSD",city:"Tabernash",state:"Colo.",amount_of_biosolids_generated:8,amount_of_biosolids_managed_land_applied:0,latitude:39.99314279,longitude:-105.846499},{facility_name:"ALOE FIELD WWTF",city:"Victoria",state:"Texas",amount_of_biosolids_generated:8,amount_of_biosolids_managed_land_applied:0,latitude:28.776972,longitude:-97.071306},{facility_name:"CITY OF KEMP WWTP",city:"Kemp",state:"Texas",amount_of_biosolids_generated:8,amount_of_biosolids_managed_land_applied:0,latitude:32.42875,longitude:-96.236361},{facility_name:"LAKE SOUTH WSC WWTF",city:"Conroe",state:"Texas",amount_of_biosolids_generated:8,amount_of_biosolids_managed_land_applied:0,latitude:30.355194,longitude:-95.57825},{facility_name:"WESTFIELD MHP WWTP",city:"San Jose",state:"Calif.",amount_of_biosolids_generated:8,amount_of_biosolids_managed_land_applied:0,latitude:29.887833,longitude:-95.384667},{facility_name:"BRUSHY CREEK WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:8,amount_of_biosolids_managed_land_applied:0,latitude:30.09825,longitude:-95.788833},{facility_name:"ROCK CREEK WWTF",city:"Dallas",state:"Texas",amount_of_biosolids_generated:7,amount_of_biosolids_managed_land_applied:0,latitude:33.831666,longitude:-96.898888},{facility_name:"LYNCHBURG WWTP",city:"Lynchburg",state:"Tenn.",amount_of_biosolids_generated:7,amount_of_biosolids_managed_land_applied:7.38,latitude:35.272332,longitude:-86.394964},{facility_name:"WATERVILLE VALLEY W W T P",city:"Waterville Valley",state:"Neb.",amount_of_biosolids_generated:7,amount_of_biosolids_managed_land_applied:0,latitude:43.944778,longitude:-71.510707},{facility_name:"COASTAL BEND DETENTION FACILITY WWTF",city:"San Antonio",state:"Texas",amount_of_biosolids_generated:7,amount_of_biosolids_managed_land_applied:0,latitude:27.73972,longitude:-97.75509},{facility_name:"ORCHARD CROSSING WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:7,amount_of_biosolids_managed_land_applied:0,latitude:29.831977,longitude:-95.055922},{facility_name:"MEXIA WWTF",city:"Mexia",state:"Texas",amount_of_biosolids_generated:7,amount_of_biosolids_managed_land_applied:0,latitude:31.66665,longitude:-96.47745},{facility_name:"CORCORAN WWTP",city:"Corcoran",state:"Calif.",amount_of_biosolids_generated:7,amount_of_biosolids_managed_land_applied:0,latitude:36.09836,longitude:-119.55783},{facility_name:"GUNTER CREEK WWTP",city:"Aubey",state:"Texas",amount_of_biosolids_generated:7,amount_of_biosolids_managed_land_applied:0,latitude:33.4508,longitude:-96.7494},{facility_name:"MONTGOMERY COUNTY UD 2 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:7,amount_of_biosolids_managed_land_applied:0,latitude:30.410425,longitude:-95.562055},{facility_name:"BIG SKY WWTF",city:"Dallas",state:"Texas",amount_of_biosolids_generated:7,amount_of_biosolids_managed_land_applied:0,latitude:33.25407,longitude:-97.37079},{facility_name:"TIMBERLOCH WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:7,amount_of_biosolids_managed_land_applied:0,latitude:30.0997,longitude:-95.7194},{facility_name:"TDCJ LUTHER UNIT WWTP",city:"Huntsville",state:"Texas",amount_of_biosolids_generated:7,amount_of_biosolids_managed_land_applied:0,latitude:30.256361,longitude:-96.053528},{facility_name:"CITY OF OMAHA WWTP",city:"Omaha",state:"Texas",amount_of_biosolids_generated:7,amount_of_biosolids_managed_land_applied:0,latitude:33.175391,longitude:-94.739556},{facility_name:"KENEDY COUNTY REST AREA WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:0,latitude:27.133055,longitude:-97.793611},{facility_name:"HARRIS CO MUD 250 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:6.37,latitude:29.872947,longitude:-95.628538},{facility_name:"CLOVER CREEK MUD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:6.20051154,latitude:30.175472,longitude:-95.752722},{facility_name:"LAGUNA VISTA WWTP",city:"Port Isabel",state:"Texas",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:0,latitude:26.117306,longitude:-97.316083},{facility_name:"COLONY REGIONAL WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:0,latitude:30.145781,longitude:-97.270848},{facility_name:"PONDEROSA PINES WWTP",city:"Porter",state:"Texas",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:0,latitude:30.329722,longitude:-95.290555},{facility_name:"CITY OF WOODBRANCH VILLAGE WWT",city:"New Caney",state:"Texas",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:0,latitude:30.172972,longitude:-95.177417},{facility_name:"ROLLING HILLS WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:0,latitude:29.87727,longitude:-95.13457},{facility_name:"MONTGOMERY COUNTY MUD 166 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:0,latitude:30.37,longitude:-95.662777},{facility_name:"MEADOWCREEK WWTP",city:"New Waverly",state:"Texas",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:0,latitude:30.51825,longitude:-96.304944},{facility_name:"ST. FRANCIS VILLAGE WWTP",city:"Crowley",state:"Texas",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:0,latitude:32.611806,longitude:-97.459528},{facility_name:"PEARCE LANE WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"WOODGATE MOBILE HOME VILLAGE",city:"Glendale",state:"Colo.",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:0,latitude:29.92313,longitude:-95.45253},{facility_name:"CITY OF BEASLEY WWTF",city:"Beasley",state:"Texas",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:0,latitude:29.491553,longitude:-95.91939},{facility_name:"VICTORIA COUNTY SRA",city:"Austin",state:"Texas",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:0,latitude:28.891,longitude:-96.823194},{facility_name:"TAYLOR LANE WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:0,latitude:30.267013,longitude:-97.554319},{facility_name:"MILL CREEK WWTP",city:"Tomball",state:"Texas",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:5.9,latitude:30.151388,longitude:-95.618611},{facility_name:"NORTHWEST PINES WWTP",city:"Denver",state:"Colo.",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:0,latitude:29.98696,longitude:-95.479125},{facility_name:"ABRAXAS WWTP",city:"North Richland Hills",state:"Texas",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:0,latitude:32.783195,longitude:-97.548148},{facility_name:"LOZANO WWTP",city:"Rio Hondo",state:"Texas",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:5.72,latitude:26.21335,longitude:-97.54384},{facility_name:"CRETE WWTF",city:"Crete",state:"Neb.",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:5.7,latitude:40.625289,longitude:-96.95680942},{facility_name:"GRAND TRAVERSE BAND OF OTTAWA",city:"Suttons Bay",state:"Mich.",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:5.7,latitude:45.032153,longitude:-85.607524},{facility_name:"NORTHLAKE VILLAGE MHP WWTP",city:"Northlake",state:"Texas",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:0,latitude:33.031926,longitude:-97.251051},{facility_name:"AMERICAN CANYON WWTF",city:"American Canyon",state:"Calif.",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:0,latitude:38.1879,longitude:-122.2782},{facility_name:"PINNACLE CLUB WWTP",city:"Pflugerville",state:"Texas",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:5.53,latitude:32.222083,longitude:-96.069111},{facility_name:"CANYON CREEK WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:0,latitude:32.400139,longitude:-97.730861},{facility_name:"LIBERTY STP",city:"Liberty",state:"Ky.",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:5.5,latitude:37.316796,longitude:-84.943457},{facility_name:"CITY OF SEADRIFT WWTP",city:"Seadrift",state:"Texas",amount_of_biosolids_generated:6,amount_of_biosolids_managed_land_applied:0,latitude:28.412444,longitude:-96.707},{facility_name:"LAREDO/COLUMBIA SOLIDARITY BRIDGE WWTF",city:"Laredo",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:27.694186,longitude:-99.737298},{facility_name:"TWINS OAKS MHP WWTP",city:"New Waverly",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:30.02447,longitude:-95.092443},{facility_name:"PRASA VIEQUES WWTP",city:"Fajardo",state:"Pa.",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:18.14239,longitude:-65.466381},{facility_name:"CITY OF MAUD WWTP",city:"Maud",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:33.333167,longitude:-94.329556},{facility_name:"ROLLING RIDGE WWTF",city:"College Station",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:5.362,latitude:30.558,longitude:-96.318528},{facility_name:"BENDERS LANDING WWTF",city:"Tomball",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:2.78,latitude:30.101944,longitude:-95.342222},{facility_name:"OAK CREST MHP WWTP",city:"Manvel",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:29.518556,longitude:-95.371306},{facility_name:"HARRIS COUNTY WCID 99 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:30.038813,longitude:-95.415541},{facility_name:"THE ESTATES WWTP",city:"Oak Brook",state:"Iowa",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"LAKES OF MISSION GROVE WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:29.642444,longitude:-95.780222},{facility_name:"RIVERWOOD FOREST WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:29.655083,longitude:-95.928389},{facility_name:"CAPE ROYALE PLANT",city:"Coldspring",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:30.657524,longitude:-95.127578},{facility_name:"CITY OF TALLADEGA W&SB",city:"Talladega",state:"Alaska",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:33.4725,longitude:-86.0617},{facility_name:"CITY OF LAKEPORT WWTP",city:"Lakeport",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:32.416666,longitude:-94.704444},{facility_name:"TUBOSCOPE SHELDON ROAD NORTH WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:29.86442,longitude:-95.12811},{facility_name:"THE RETREAT WWTP",city:"Pflugerville",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:32.21587,longitude:-97.51537},{facility_name:"HOPE, CITY OF-BOIS D'ARC WWTP",city:"Hope",state:"Alaska",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:33.6475,longitude:-93.636944},{facility_name:"LAKESIDE VILLAGE",city:"Livingston",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:30.666463,longitude:-94.946837},{facility_name:"USNPS-MT RUSHMORE NTL MEMORIAL",city:"Keystone",state:"S.D.",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:43.87971,longitude:-103.451858},{facility_name:"CITY OF RUNAWAY BAY WWTP",city:"Runaway Bay",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:33.172056,longitude:-97.88225},{facility_name:"TERRELL UNIT WWTP",city:"Huntsville",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:29.296785,longitude:-95.540419},{facility_name:"RANKIN PARK WWTP",city:"Spring",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:29.966319,longitude:-95.387905},{facility_name:"NORTH PLANT WWTP",city:"Silsbee",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:30.372779,longitude:-94.19823},{facility_name:"CITY OF ARCHER CITY WWTP",city:"Archer City",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:33.5881,longitude:-98.638},{facility_name:"CITY OF WINFIELD WWTF",city:"Winfield",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:33.160944,longitude:-95.10325},{facility_name:"SCURRY ROSSER ISD WWTP",city:"Scurry",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:32.509861,longitude:-96.38125},{facility_name:"CITY OF LULING NORTH WWTF",city:"Luling",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:29.685389,longitude:-97.627417},{facility_name:"TOWN OF ECLECTIC ALABAMA",city:"Eclectic",state:"Alaska",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:4.6,latitude:32.629094,longitude:-86.025844},{facility_name:"PRASA OROCOVIS",city:"Orocovis",state:"Pa.",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:18.07397097,longitude:-66.36949019},{facility_name:"BEACON BAY MARINA & RV PARK WWTP",city:"Livingston",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:30.689284,longitude:-95.035932},{facility_name:"HOUSE HAHL COA WWTP",city:"Cypress",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:29.960999,longitude:-95.71139},{facility_name:"WHITE OAK MANOR MHP WWTP",city:"Houston",state:"Ark.",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:29.87782,longitude:-95.5369},{facility_name:"CREEKSIDE ESTATES WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:29.87809,longitude:-95.52907},{facility_name:"LAKE LIVINGSTON VILLAGE WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:30.729658,longitude:-95.046063},{facility_name:"WILLOW OAKS WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:30.10325,longitude:-95.546306},{facility_name:"WHITE OAK RANCH WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:30.359917,longitude:-95.545194},{facility_name:"TOWN OF WOODLOCH WWTP",city:"Conroe",state:"Texas",amount_of_biosolids_generated:5,amount_of_biosolids_managed_land_applied:0,latitude:30.217417,longitude:-95.408806},{facility_name:"TDCJ WALLACE PACK UNIT WWTF",city:"Huntsville",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:30.32577,longitude:-96.09893},{facility_name:"CITY OF EDGEWOOD WWTF",city:"Edgewood",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:32.7,longitude:-95.883333},{facility_name:"CHISHOLM SPRINGS WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:32.991222,longitude:-97.439722},{facility_name:"PARKLAND ESTATES WWTP",city:"Pflugerville",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:29.9255,longitude:-95.298806},{facility_name:"CITY OF GARRISON WWTP",city:"Garrison",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:31.8235,longitude:-94.484083},{facility_name:"EAST CENTRAL HIGH SCHOOL WWTP",city:"San Antonio",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:29.36312,longitude:-98.35973},{facility_name:"NAVARRO SAFETY REST AREA WASTEWATER TREATMENT FACILITY",city:"Austin",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:31.909722,longitude:-96.390833},{facility_name:"BEACHWOOD ESTATES WWTP",city:"Pflugerville",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:4.14,latitude:32.237777,longitude:-96.127777},{facility_name:"BREMOND WWTP",city:"Bremond",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:31.157389,longitude:-96.673306},{facility_name:"TDCJ FERGUSON UNIT WWTP",city:"Hunstville",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:30.958382,longitude:-95.704388},{facility_name:"HENRY W. PIRKEY POWER PLANT",city:"Dallas",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:32.460267,longitude:-94.485225},{facility_name:"HARRIS COUNTY MUD 165 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:29.740311,longitude:-95.447598},{facility_name:"HUGHES SPRINGS WWTF",city:"Hughes Springs",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:32.993848,longitude:-94.613001},{facility_name:"CITY OF DE KALB WWTP",city:"De Kalb",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:33.479278,longitude:-94.618528},{facility_name:"LAKE HOUSTON PINES WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:29.81271,longitude:-95.20992},{facility_name:"HARDIN COUNTY WCID 1 WWTP",city:"Sour Lake",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:30.165754,longitude:-94.314649},{facility_name:"LAKEVIEW CAMP WWTP",city:"Waxahachie",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:32.32418,longitude:-96.97328},{facility_name:"ALLEYTON WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:29.709639,longitude:-96.481278},{facility_name:"NORTHWINDS WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:29.875694,longitude:-95.58175},{facility_name:"J L LYONS ELEMENTARY WWTP",city:"Magnolia",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:30.13942,longitude:-95.75288},{facility_name:"KINGMONT MHP WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:29.890247,longitude:-95.441341},{facility_name:"PINEDALE MHP WWTP",city:"Pinehurts",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:30.144361,longitude:-95.663278},{facility_name:"TIMKENSTEEL MATERIALS SERVICES WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:29.9306,longitude:-95.37576},{facility_name:"FOSTER BRISCOE SCHOOL WWTP",city:"Rosenberg",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:29.65467,longitude:-95.73827},{facility_name:"MAGNOLIA LAKES WWTP",city:"Tomball",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:30.189394,longitude:-95.73236},{facility_name:"WATERWOOD MUD 1 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:30.8185,longitude:-95.235194},{facility_name:"BRUBAKER WWTP",city:"Pattison",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:29.827433,longitude:-96.001922},{facility_name:"OAKWOOD VILLAGE WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:30.096611,longitude:-95.506889},{facility_name:"B&W GATHERING WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:30.589556,longitude:-98.403389},{facility_name:"KAUFER-HUBERT MEMORIAL PARK AND SEA WIND RV PARK WWTP",city:"Kingsville",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:3.7,latitude:27.316022,longitude:-97.681983},{facility_name:"SHELDON INSPECTION SOUTH WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:29.84684,longitude:-95.12783},{facility_name:"FOREST HILLS WWTP",city:"Jasper",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:31.063611,longitude:-94.074778},{facility_name:"BIG EDDY WWTP",city:"Tyler",state:"Texas",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:32.191666,longitude:-95.439444},{facility_name:"BIG OAK MHP",city:"West Hollywood",state:"Calif.",amount_of_biosolids_generated:4,amount_of_biosolids_managed_land_applied:0,latitude:32.463194,longitude:-94.624361},{facility_name:"WEIMAN MHP WWTF",city:"Huntington Beach",state:"Calif.",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:29.873833,longitude:-95.625222},{facility_name:"GRAND RANCH PHASE 2",city:"Houston",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:32.513194,longitude:-97.452215},{facility_name:"SHALE CREEK WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:33.040667,longitude:-97.391944},{facility_name:"BLUE WATER OAKS WWTP",city:"Alvarado",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:32.36418,longitude:-97.239827},{facility_name:"COWTOWN RV PARK WWTF",city:"Aledo",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:3.14,latitude:32.724737,longitude:-97.616394},{facility_name:"THOROUGHBRED FARMS WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:30.136861,longitude:-97.671944},{facility_name:"UNIVERSAL SERVICES FT HOOD WWTF",city:"Fort Hood",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:3.12,latitude:31.1135,longitude:-97.786667},{facility_name:"CITY OF DAINGERFIELD WWTP",city:"Daingerfield",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:33.017722,longitude:-94.712611},{facility_name:"HAMMOND MOUND UTILITIES WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:29.878445,longitude:-95.965322},{facility_name:"290 KICKPOO WWTP",city:"Spring",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:30.022079,longitude:-95.831699},{facility_name:"CEDAR CREEK FOREST MHP",city:"Houston",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:30.008806,longitude:-95.575472},{facility_name:"MYREX INDUSTRIES WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:29.92772,longitude:-95.3567},{facility_name:"YMCA CAMP CULLEN WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:30.921902,longitude:-95.299405},{facility_name:"MEMORIAL POINT UD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:30.702111,longitude:-95.083806},{facility_name:"WOODLAND ACRES WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:29.878806,longitude:-94.839917},{facility_name:"ASTRO WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:29.532167,longitude:-95.445472},{facility_name:"PALM CREST WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:29.366333,longitude:-95.426861},{facility_name:"NEEDVILLE ISD WWTP",city:"Needville",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:29.37201,longitude:-95.799128},{facility_name:"COUNTRYSIDE ESTATES - WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:29.951012,longitude:-94.032792},{facility_name:"MEADOWS AT CYPRESS CREEK",city:"Houston",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:29.95337,longitude:-95.6309},{facility_name:"MIDFIELD WWTP",city:"Midfield",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:28.935472,longitude:-96.210361},{facility_name:"TAYLOR LANDING WWTP",city:"Beaumont",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:29.87442,longitude:-94.143473},{facility_name:"CITY OF HILLCREST VILLAGE-WWTP",city:"Alvin",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:29.3972,longitude:-95.221916},{facility_name:"OAK MANOR MUD WWTP",city:"Alvin",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:29.326611,longitude:-95.29075},{facility_name:"BAYVIEW MUD WWTP",city:"Bacliff",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:3,latitude:29.511388,longitude:-95.006111},{facility_name:"CITY OF FAYETTEVILLE WWTP",city:"Fayetteville",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:3,latitude:29.905306,longitude:-96.666611},{facility_name:"CITY OF WORTHAM",city:"Wortham",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:31.79652,longitude:-96.454467},{facility_name:"CITY OF FROST WWTP",city:"Frost",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:32.084402,longitude:-96.812523},{facility_name:"CITY OF QUEEN CITY WWTP",city:"Queen City",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:33.155972,longitude:-94.135222},{facility_name:"WILDWOOD SHORES WWTF",city:"Cypress",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:30.551583,longitude:-95.614389},{facility_name:"EASTHAM UNIT WWTP",city:"Hunstville",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:30.973889,longitude:-95.635},{facility_name:"HARRIS COUNTY MUD 405 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:2.95262454,latitude:29.999609,longitude:-95.845225},{facility_name:"TEXAS RANCH RV RESORT WWTF",city:"Burleson",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:32.427777,longitude:-97.175555},{facility_name:"STAR ISLAND TREATMENT FACILITY",city:"Portsmouth",state:"Neb.",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:1.2,latitude:43.075388,longitude:-70.760605},{facility_name:"LITTLE RIVER WWTF",city:"Little River Academy",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:2.421,latitude:30.982783,longitude:-97.366837},{facility_name:"BEAUVIEW WWTP",city:"New Waverly",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:30.44858,longitude:-95.5335},{facility_name:"TN DOC-TURNEY CENTER",city:"Only",state:"Tenn.",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:2.78,latitude:35.8275,longitude:-87.69},{facility_name:"CITY OF TIMPSON WWTF",city:"Timpson",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:31.900155,longitude:-94.382881},{facility_name:"ST. PAUL WWTF",city:"Sinton",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:28.088389,longitude:-97.560472},{facility_name:"TOWER OAK BEND WSC WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:2.71,latitude:29.9555,longitude:-95.601028},{facility_name:"LULING SOUTH WWTP",city:"Luling",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:29.657667,longitude:-97.647861},{facility_name:"ALDINE FOREST WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:29.917444,longitude:-95.36575},{facility_name:"MILLER'S COVE WWTP",city:"Winfield",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:33.155306,longitude:-95.117667},{facility_name:"POTRANCO RANCH SUBDIVISON WWTP",city:"Helotes",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:29.424444,longitude:-98.836111},{facility_name:"TOWN OF OAK RIDGE WWTP",city:"Gainesville",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:33.645296,longitude:-97.041069},{facility_name:"KEYSTONE, TOWN OF",city:"Keystone",state:"S.D.",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:43.891321,longitude:-103.391309},{facility_name:"GE PACKAGED POWER JPORT",city:"Houston",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:29.75583,longitude:-95.11082},{facility_name:"WHITE OAK CONDOS WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:29.782167,longitude:-95.375194},{facility_name:"WEST AGUA WWTP",city:"Palmview",state:"Texas",amount_of_biosolids_generated:3,amount_of_biosolids_managed_land_applied:0,latitude:26.278246,longitude:-98.570437},{facility_name:"SABINE RIVER AUTHORITY FM 429 WWTP",city:"Point",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:1.97,latitude:32.852075,longitude:-96.070641},{facility_name:"CANE ISLAND WWTP",city:"Tomball",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:2.46,latitude:29.83112,longitude:-95.84017},{facility_name:"RIVER OAKS MHP WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:2.46,latitude:29.89174,longitude:-95.25605},{facility_name:"SUNDOWN MHP WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:2.46,latitude:29.89061,longitude:-95.35484},{facility_name:"LAKE TAWAKONI STATE PARK WWTF",city:"Point",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:1.66,latitude:32.843333,longitude:-95.990277},{facility_name:"BRENTWOOD MANOR WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:28.833389,longitude:-96.916814},{facility_name:"CRESTVIEW SUBDIVISION",city:"Seguin",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:28.598778,longitude:-96.701306},{facility_name:"PRASA ADJUNTAS",city:"Adjuntas",state:"Pa.",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:18.16106707,longitude:-66.72134759},{facility_name:"DAVIES MOBILE PARK LLC",city:"Fort Collins",state:"Colo.",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:40.55335,longitude:-105.04938},{facility_name:"TERRA VERDE WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:30.095231,longitude:-95.842169},{facility_name:"CORNERSTONE MHP WWTP",city:"Tomball",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:30.11854,longitude:-95.58266},{facility_name:"UFP-NEW WAVERLY WWTP",city:"Grand Rapids",state:"Mich.",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:30.574917,longitude:-95.473778},{facility_name:"DEER TRAIL WWTP",city:"Spring",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:29.90672,longitude:-95.42279},{facility_name:"SPRING OAKS MHP WWTP",city:"Navasota",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:30.08641,longitude:-95.48483},{facility_name:"BRAZORIA COUNTY FWSD 1 WWTP",city:"Damon",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:29.295083,longitude:-95.731111},{facility_name:"WEYBRIDGE WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:29.307361,longitude:-95.265917},{facility_name:"SAVANNAH PLANTATION WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:29.351889,longitude:-95.309917},{facility_name:"MAPLE LEAF GARDENS WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:29.91237,longitude:-95.54435},{facility_name:"LOLITA WWTF",city:"Lolita",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:28.83655,longitude:-96.537981},{facility_name:"BEACON ESTATES WWTP",city:"Brookshire",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:29.872222,longitude:-96.000277},{facility_name:"STONETOWN BENBROOK WWTP",city:"Glendale",state:"Colo.",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:32.6111,longitude:-97.53735},{facility_name:"COLE CREEK BUSINESS PARK WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:29.865989,longitude:-95.526596},{facility_name:"MATAGORDA WD & WSC WWTP",city:"Matagorda",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:28.692194,longitude:-95.964389},{facility_name:"BELLE OAKS WWTP",city:"Beaumont",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:29.872972,longitude:-94.125722},{facility_name:"GARDEN CITY WPCP",city:"Garden City",state:"Ga.",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:32.06391,longitude:-81.20555},{facility_name:"CONVENIENCE RV PARK WWTP",city:"Willis",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:30.484917,longitude:-95.492139},{facility_name:"BAY BLUFF WWTP",city:"Des Moines",state:"Hawaii",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:29.607777,longitude:-95.065833},{facility_name:"TDCJ POWLEDGE WWTP",city:"Hunstville",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:31.731278,longitude:-95.801611},{facility_name:"RUSSELLVILLE WATER AND SEWER BOARD",city:"Russellville",state:"Alaska",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:2,latitude:34.4689,longitude:-87.7283},{facility_name:"LILLIAN ELEMENTARY SCHOOL WWTF",city:"Alvarado",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:32.496556,longitude:-97.193372},{facility_name:"BEECHWOOD WWTP",city:"Cypress",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:29.217732,longitude:-95.445014},{facility_name:"CITY OF CAMPBELL WWTP",city:"Campbell",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:33.1415,longitude:-95.971333},{facility_name:"BIG CANOE UTILITIES COMPANY INC. (BLACKWELL CREEK WTP)",city:"Marble Hill",state:"Ga.",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:34.4277,longitude:-84.27945},{facility_name:"GALVESTON BAY RV PARK WWTF",city:"Dickinson",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:1.97,latitude:29.454111,longitude:-94.982389},{facility_name:"CHAPMAN MHP WWTP",city:"Crosby",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:29.92245,longitude:-95.04337},{facility_name:"ROSEWOOD MHP WWTP",city:"Humble",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:29.893,longitude:-95.37825},{facility_name:"CITY OF TALCO WWTF",city:"Talco",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:33.367722,longitude:-95.088639},{facility_name:"CHIRENO ISD",city:"Chireno",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:31.493611,longitude:-94.348055},{facility_name:"ALDINE ISD CHRISMAN RD WTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:29.90683,longitude:-95.36354},{facility_name:"TREATY OAKS WWTF",city:"Austin",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:32.367917,longitude:-97.718056},{facility_name:"ACADEMY WWTF",city:"Little River-Academy",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:1.816,latitude:30.976556,longitude:-97.338611},{facility_name:"BAYRIDGE WWTP",city:"Cypress",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:29.659111,longitude:-94.896861},{facility_name:"WODEN ISD WWTP",city:"Woden",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:31.50444,longitude:-94.523055},{facility_name:"PINEY SHORES WWTF",city:"Tyler",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:30.382889,longitude:-95.539944},{facility_name:"MOOREHEAD JR HIGH SCHOOL WWTP",city:"Conroe",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:30.252222,longitude:-95.310555},{facility_name:"CITY OF EMORY WWTP",city:"Emory",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:32.864556,longitude:-95.766889},{facility_name:"MEMPHIS WWTP",city:"Memphis",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:34.712028,longitude:-100.530528},{facility_name:"RIDGE WWTF",city:"Austin",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:32.384,longitude:-97.714556},{facility_name:"HARRIS COUNTY MUNICIPAL UTILITY DISTRICT NO 438 WWTP",city:"Katy",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:29.916388,longitude:-95.773888},{facility_name:"CAROLINA CREEK CHRISTIAN CAMPS",city:"Houston",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:30.841111,longitude:-95.339639},{facility_name:"POLK COUNTY SAFETY REST AREA WWTF",city:"Austin",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:30.840097,longitude:-94.860849},{facility_name:"MCKINNEY ROUGHS WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:30.139833,longitude:-97.463583},{facility_name:"KOPPERL ISD WWTP",city:"Kopperl",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:32.074583,longitude:-97.501583},{facility_name:"WHISPER MEADOWS WWTF",city:"Pflugerville",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:30.021614,longitude:-95.585911},{facility_name:"DRIL-QUIP WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:29.86877,longitude:-95.6084},{facility_name:"GRAND PARKWAY INDUSTRIAL PARK",city:"Houston",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:29.825277,longitude:-95.776388},{facility_name:"DEL LAGO ESTATES WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:30.392972,longitude:-95.651611},{facility_name:"LILLIPUT FARMS WWTP",city:"Porter",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:30.173717,longitude:-95.19242},{facility_name:"ED-LOU WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:30.01983,longitude:-95.64604},{facility_name:"CYPRESSWOOD MHP WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:30.455694,longitude:-90.933629},{facility_name:"CAMP OLYMPIA",city:"Trinity",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:30.944124,longitude:-95.255015},{facility_name:"WILLOW MANOR MHP WWTP",city:"Cost Mesa",state:"Calif.",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:29.53063,longitude:-95.41674},{facility_name:"LA WARD WWTF",city:"La Ward",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:28.844778,longitude:-96.460472},{facility_name:"THE RETREAT AT ARTESIAN LAKES WWTF",city:"Cleveland",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:30.451666,longitude:-94.827222},{facility_name:"SOUTHGATE WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:29.910273,longitude:-95.41393},{facility_name:"CONROE BAY WATER SEWER SUPPLY WWTP",city:"Willis",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:30.459111,longitude:-95.551611},{facility_name:"RIVERBEND RETREAT CENTER -WWTP",city:"Glen Rose",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:32.2077,longitude:-97.69447},{facility_name:"FRUITVALE WWTP",city:"Fruitvale",state:"Texas",amount_of_biosolids_generated:2,amount_of_biosolids_managed_land_applied:0,latitude:32.673,longitude:-95.801833},{facility_name:"CITY OF PALACIOS WWTP",city:"Palacios",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:28.703694,longitude:-96.233972},{facility_name:"COUNTRY OAKS ARBOR MHP WWTP",city:"Pearland",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:1.47631227,latitude:29.544667,longitude:-95.350472},{facility_name:"STEPHEN F AUSTIN HISTORICAL PARK",city:"Austin",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:29.821056,longitude:-96.107444},{facility_name:"EAST MOUNT HOUSTON MHP WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:1.476,latitude:29.89127,longitude:-95.294855},{facility_name:"PRASA MARICAO",city:"Maricao",state:"Pa.",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:1.4,latitude:18.187368,longitude:-66.994251},{facility_name:"WOLF CREEK SKI CORP",city:"Pagosa Springs",state:"Colo.",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:1.31,latitude:37.27685507,longitude:-107.0853062},{facility_name:"RED WARE ELEMENTARY WWTP",city:"Callisburg",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:33.606523,longitude:-97.007185},{facility_name:"PELICAN ISLE WWTP",city:"Dallas",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:31.994708,longitude:-96.17205},{facility_name:"LONGFORD PLACE WWTF",city:"Orange",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:30.16165,longitude:-93.7519},{facility_name:"KNOX LEE POWER PLANT",city:"Longview",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:32.37676,longitude:-94.63972},{facility_name:"CITY OF FRANKSTON WWTF",city:"Frankston",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:32.044902,longitude:-95.496715},{facility_name:"CITY OF ORANGE GROVE WWTP",city:"Orange Grove",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:27.942583,longitude:-97.935611},{facility_name:"MSEC WWTP 2",city:"Montgomery",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:30.353333,longitude:-95.662777},{facility_name:"TRINIDAD CITY OF",city:"Trinidad",state:"Colo.",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:37.1740569,longitude:-104.4909835},{facility_name:"UPPER SIOUX COMMUNITY",city:"Granite Falls",state:"Minn.",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:1.17,latitude:44.746755,longitude:-95.496637},{facility_name:"MCDONALD OBSERVATORY LOWER WWTF",city:"Austin",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:30.676778,longitude:-104.023111},{facility_name:"PARADISE RV RESORT WWTF",city:"Dallas",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:32.833045,longitude:-95.629697},{facility_name:"CITY OF WILLS POINT WWTP",city:"Wills Point",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:32.690944,longitude:-96.014667},{facility_name:"GREENS BAYOU FABRICATION YARD",city:"Cyrpess",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:29.74787,longitude:-95.17985},{facility_name:"HAWLEY WWTF",city:"Quitman",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:32.913444,longitude:-95.660222},{facility_name:"MEADOWLAND UTILITY WWTP",city:"Alvin",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:1.03,latitude:29.469389,longitude:-95.269639},{facility_name:"CITY OF KNOX CITY WWTP",city:"Knox City",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:33.423778,longitude:-99.823},{facility_name:"HOOKS JUNIOR HIGH WWTF",city:"Hooks",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:33.517,longitude:-94.285639},{facility_name:"INDIAN HILL HARBOR WWTP",city:"Livingston",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:30.74379,longitude:-95.09095},{facility_name:"WARREN W W T F",city:"West Warren",state:"Mass.",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:42.210084,longitude:-72.24737},{facility_name:"BAYOU FOREST VILLAGE WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:29.89823,longitude:-95.3549},{facility_name:"KOA HOUSTON CENTRAL WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:29.920434,longitude:-95.360225},{facility_name:"RICETEC WWTP",city:"Alvin",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:29.323799,longitude:-95.260829},{facility_name:"EAGLE MOUNTAIN RV PARK WWTP",city:"Fort Worth",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:32.9496,longitude:-97.50405},{facility_name:"D BAR B WWTP",city:"Dallas",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:32.65546,longitude:-96.67706},{facility_name:"CIRCLE T ARENA WWTP",city:"Hamilton",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:31.749151,longitude:-98.169907},{facility_name:"HOLIDAY HARBOR WWTP",city:"Point Blank",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:30.704056,longitude:-95.170194},{facility_name:"TROPICAL TRAILS RV RESORT WWTP",city:"Bryan",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:25.9878,longitude:-97.4384},{facility_name:"CITY OF MILFORD WWTP",city:"Milford",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:32.128639,longitude:-96.938556},{facility_name:"NEW WAVERLY WWTD",city:"New Waverly",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:30.539606,longitude:-95.49396},{facility_name:"SPLENDORA HIGH SCHOOL WWTF",city:"Splendora",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:30.249194,longitude:-95.200389},{facility_name:"SCRAP YARD SPORTS WWTP",city:"Conroe",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:30.14499,longitude:-95.41572},{facility_name:"CYPRESS LAKES WWTP",city:"Cleveland",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:30.294639,longitude:-94.800194},{facility_name:"BAYOU CLUB WWTP",city:"Spring",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:29.77325,longitude:-95.45288},{facility_name:"BENDER CREEK APARTMENT WWTP",city:"Humble",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:29.927304,longitude:-95.300642},{facility_name:"GREIF INDUSTRIAL HOUSTON SPECIALTY FACILITY",city:"La Porte",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:29.70216,longitude:-95.06427},{facility_name:"HOUSTON EAST RV RESORT WWTP",city:"Garland",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:29.820564,longitude:-94.87576},{facility_name:"WOODLOCH MHP WWTP",city:"Sugar Land",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:29.894331,longitude:-95.366728},{facility_name:"BENTWOOD ESTATES WWTP",city:"Midland",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:30.02925,longitude:-95.08023},{facility_name:"PLANTATION CROSSING WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:29.623444,longitude:-95.717806},{facility_name:"SPRING CYPRESS WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:30.076306,longitude:-95.432972},{facility_name:"EASTWOOD HILLS SUBDIVISION WWTF",city:"Southfield",state:"Mich.",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:30.150715,longitude:-95.430273},{facility_name:"DISTRICT 249 BAR AND GRILL",city:"Houston",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:30.022972,longitude:-95.59075},{facility_name:"SUNSET MHP 2 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:29.90866,longitude:-95.49015},{facility_name:"MATAGORDA BAY NATURE PARK AND PRESERVE WWTF",city:"Austin",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:28.601556,longitude:-95.978333},{facility_name:"RAYFORD CROSSING WWTP",city:"Spring",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:30.11506,longitude:-95.4167},{facility_name:"LIBERTY DANVILLE FWSD 2 WWTP",city:"Kilgore",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:32.42856,longitude:-94.81083},{facility_name:"QUAIL RUN WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:29.327306,longitude:-98.050479},{facility_name:"PINE COLONY WWTP",city:"Alvin",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:.7,latitude:29.473694,longitude:-95.262222},{facility_name:"RIVERCREST ISD WWTF",city:"Bogata",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:33.40506,longitude:-95.16738},{facility_name:"NATIONAL COIL WWTF",city:"Longview",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:32.414557,longitude:-94.770282},{facility_name:"ANGLE ACRES WWTP",city:"Cypress",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:29.157077,longitude:-95.396018},{facility_name:"WADSWORTH WWTP",city:"Wadsworth",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:29.895222,longitude:-95.354639},{facility_name:"UPPER LEON RIVER WWTP",city:"Comanche",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:31.96649,longitude:-98.516073},{facility_name:"KALITA POINT WWTP",city:"Livingston",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:30.739347,longitude:-95.062046},{facility_name:"WILLOW RIVER FARMS WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:29.835409,longitude:-96.08914},{facility_name:"CANEY CREEK UTILITIES WWTF",city:"Montgomery",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:.59052491,latitude:30.44575,longitude:-95.608833},{facility_name:"KENNECOTT UTAH COPPER, LLC",city:"Salt Lake City",state:"Utah",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:40.714389,longitude:-112.116609},{facility_name:"DOUGLASVILLE - DOUGLAS COUNTY WATER AND SEWER AUTHORITY",city:"Douglasville",state:"Ga.",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:33.694444,longitude:-84.692972},{facility_name:"ELLINGER SEWER & WSC WWTP",city:"Ellinger",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:29.839531,longitude:-96.707142},{facility_name:"BLUE WATER SHORES",city:"Austin",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:32.38831,longitude:-97.69647},{facility_name:"ANGELINA COUNTY FWSD NO 1 WWTP",city:"Lufkin",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:31.43884,longitude:-94.6501},{facility_name:"NEW ULM WSC WWTP",city:"New Ulm",state:"Texas",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:.5167093,latitude:29.885278,longitude:-96.477583},{facility_name:"HILL CITY, CITY OF (BIOSOLIDS)",city:"Hill City",state:"S.D.",amount_of_biosolids_generated:1,amount_of_biosolids_managed_land_applied:0,latitude:43.935444,longitude:-103.557278},{facility_name:"CARBY ROAD MHP WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:.4921,latitude:29.87811,longitude:-95.38155},{facility_name:"HICKORY HOLLOW INN WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.92541,longitude:-95.52179},{facility_name:"MONUMENT INN WWTP",city:"La Porte",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.761056,longitude:-95.079917},{facility_name:"RIVERBEND PARK & RESORT WWTP",city:"Richmond",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.54217,longitude:-95.64412},{facility_name:"MAIN PLANT WWTF",city:"Childress",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:34.413333,longitude:-100.17777},{facility_name:"JOHNSON COUNTY PIPE",city:"Alvarado",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"TYLER STATE PARK WWTF",city:"Austin",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.475528,longitude:-95.299611},{facility_name:"HOLLY LAKE RANCH WWTF",city:"Tyler",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.709493,longitude:-95.190128},{facility_name:"SIGMAPRO WWTP",city:"Fort Worth",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.941009,longitude:-97.322754},{facility_name:"PALO PINTO CO WCID 1",city:"Dallas",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.888722,longitude:-98.476139},{facility_name:"LAKE FORK ESTATES WWTF",city:"Pflugerville",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:.44,latitude:32.848722,longitude:-95.508278},{facility_name:"LAKE OAKS LANDING WWTP",city:"Point Blank",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.718722,longitude:-95.187889},{facility_name:"COUNTRY LIVING MHP WWTP",city:"Marshall",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.55664,longitude:-94.39828},{facility_name:"GRASSLANDS WWTP",city:"Rosharon",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.344016,longitude:-95.445504},{facility_name:"AFS GROUP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.89168,longitude:-95.39627},{facility_name:"TRINITY INDUSTRIES PLANT 19 WWTF",city:"Dalks",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.50186,longitude:-94.640056},{facility_name:"TYNAN WWTP",city:"Tynan",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:28.172667,longitude:-97.753028},{facility_name:"CITY OF CHICO",city:"Chico",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.299187,longitude:-97.790489},{facility_name:"CHISOS BASIN WWTP",city:"Big Bend National Park",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.278806,longitude:-103.307667},{facility_name:"FORT WORTH BOAT CLUB WWTP",city:"Fort Worth",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.89373,longitude:-97.48726},{facility_name:"VAM USA",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.83697,longitude:-95.13528},{facility_name:"FALL TREATMENT PLANT NO 1 WWTP",city:"New Ulm",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.845611,longitude:-96.511472},{facility_name:"NORTHSIDE WATER WWTP",city:"Stephenville",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.254665,longitude:-98.222549},{facility_name:"TIDEHAVEN JHS-HS WWTP",city:"El Maton",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:28.897222,longitude:-96.137222},{facility_name:"LIVE OAK COUNTY SAFETY REST AREA NORTHBOND WWTF",city:"Austin",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:.27,latitude:28.603333,longitude:-98.219166},{facility_name:"LIVE OAK COUNTY SAFETY REST AREA WWTF",city:"Austin",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:.27,latitude:28.650555,longitude:-98.24388},{facility_name:"BCFS DRISCOLL HEALTH & HUMAN SERVICES WWTF",city:"Harlingen",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"SAN FELIPE WWTP",city:"Fort Worth",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.82465,longitude:-96.13706},{facility_name:"BROOKELAND ISD WWTP",city:"Brookland",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.149115,longitude:-93.993362},{facility_name:"WEST HARDIN COUNTY CISD WWTF",city:"Saratoga",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.257917,longitude:-94.563861},{facility_name:"STONE HEDGE WASTEWATER TREATMENT PLANT",city:"Spring",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"BCFS DRISCOLL HEALTH & HUMAN SERVICES WWTP",city:"Harlingen",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:27.690833,longitude:-97.740277},{facility_name:"RED POTATO MARKET WWTF",city:"Simonton",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.683055,longitude:-95.982777},{facility_name:"POPLAR GROVE, VILLAGE OF",city:"Poplar Grove",state:"Iowa",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:42.36927,longitude:-88.8286},{facility_name:"CITY OF BARDWELL WWTP",city:"Bardwell",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.349843,longitude:-94.246876},{facility_name:"CITY OF ORE CITY WWTF",city:"Ore City",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.803972,longitude:-94.707139},{facility_name:"FOUNTAIN LAKE PLANT",city:"Livingston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.812944,longitude:-95.082694},{facility_name:"AZTEC COVE WWTP",city:"Trinity",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.917944,longitude:-95.27325},{facility_name:"CITY OF NEWARK WWTP",city:"Newark",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.99825,longitude:-97.49187},{facility_name:"EMORY WWTP",city:"Emory",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.864556,longitude:-95.766889},{facility_name:"FRONTIER PARK WWTP",city:"Orange",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.450733,longitude:-93.765894},{facility_name:"FAIRVIEW GARDENS DEVELOPMENTS WWTP",city:"Jersey Village",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.884667,longitude:-95.589083},{facility_name:"SUNSET SHORES WWTF",city:"Willis",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.436861,longitude:-95.584389},{facility_name:"COTTON BAYOU PARK",city:"League City",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.803935,longitude:-94.83821},{facility_name:"CITY OF LA VILLA WWTF",city:"La Villa",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:26.301111,longitude:-97.915833},{facility_name:"BLORA WWTP",city:"Camden",state:"Neb.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.135833,longitude:-97.547222},{facility_name:"HALLIBURTON GALVESTON PELICAN ISLAND WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.32187,longitude:-94.78717},{facility_name:"UNITED PENTECOSTAL CHURCH CAMPGROUND",city:"Wapella",state:"Iowa",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:40.256055,longitude:-88.977003},{facility_name:"HARBOR ISLAND WWTP",city:"Keithville",state:"La.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:27.847611,longitude:-97.061056},{facility_name:"ELGIN WWTP",city:"Elgin",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:162.4469,latitude:30.33667,longitude:-97.37584},{facility_name:"SUNRISE EAST APARTMENTS WWTP",city:"Orange",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.05087,longitude:-93.81375},{facility_name:"SUGAR PINES MHC WWTF",city:"Pasadena",state:"Calif.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.207488,longitude:-94.0314},{facility_name:"PURTIS CREEK STATE PARK WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.35375,longitude:-96.004389},{facility_name:"WEST MONROE WWTP",city:"West Monroe",state:"La.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.424013,longitude:-92.178376},{facility_name:"INDIANHEAD BIOMASS",city:"St. Augustine",state:"Fla.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:68930,latitude:29.872468,longitude:-81.367989},{facility_name:"CITY OF PORTLAND WWTF",city:"Portland",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:518.376,latitude:27.878498,longitude:-97.332088},{facility_name:"CLIMAX MOLYBDENUM COMPANY-CLIMAX MINE",city:"Climax",state:"Colo.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:6.49,latitude:39.24767,longitude:-106.29221},{facility_name:"CITY OF DAISETTA WWTP",city:"Daisetta",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.117111,longitude:-94.629528},{facility_name:"MARTIN DIES JR WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.844434,longitude:-94.165788},{facility_name:"FAYETTE WSC WATER WELL 4",city:"La Grange",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.811083,longitude:-96.918444},{facility_name:"RUTERSVILLE WTP",city:"La Grange",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.92979,longitude:-96.83663},{facility_name:"WESTPHALIA WASTEWATER WORKS WWTP",city:"Lott",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.121111,longitude:-97.112056},{facility_name:"CITY OF CUMBY WWTP",city:"Cumby",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.134556,longitude:-95.828},{facility_name:"KOUNTZE WWTP",city:"Kountze",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.376861,longitude:-94.299333},{facility_name:"CITY OF KERENS WWTP",city:"Kerens",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.116992,longitude:-96.232205},{facility_name:"CITY OF THORNTON WWTP",city:"Thornton",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.401833,longitude:-96.581361},{facility_name:"CITY OF TRINIDAD WWTP",city:"Trinidad",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.136806,longitude:-96.071333},{facility_name:"BRAZOS ISD WWTP",city:"Wallis",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.618076,longitude:-96.024836},{facility_name:"SABINE PASS WWTP",city:"Port Arthur",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.91313,longitude:-93.89485},{facility_name:"GROESBECK WWTP",city:"Groesbeck",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.526944,longitude:-96.519444},{facility_name:"CITY OF FRANKLIN WWTP",city:"Franklin",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.016556,longitude:-96.496333},{facility_name:"CITY OF LEXINGTON WWTF",city:"Lexington",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.407917,longitude:-97.014333},{facility_name:"PINE COVE CRIER CREEK WWTP",city:"Tyler",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.817224,longitude:-96.669487},{facility_name:"EVADALE WCID 1 WWTP",city:"Evadale",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.34206,longitude:-94.083201},{facility_name:"COLLIN PARK MARINA WWTP",city:"Wylie",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.048755,longitude:-96.533704},{facility_name:"CARTER LAKE WWTP",city:"College Station",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.594812,longitude:-96.249932},{facility_name:"CITY OF EVANT WWTP",city:"Evant",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.473041,longitude:-98.145559},{facility_name:"MSEC WWTP",city:"Montgomery",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.318697,longitude:-95.624135},{facility_name:"SLAYTER CREEK WWTP",city:"Anna",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.331559,longitude:-96.566588},{facility_name:"NEW SUMMERFIELD WWTF",city:"New Summerfield",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.9975,longitude:-95.0889},{facility_name:"CAYUGA ISD",city:"Cayuga",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.924306,longitude:-95.926611},{facility_name:"CITY OF HOOKS WWTF",city:"Hooks",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.477389,longitude:-94.252889},{facility_name:"OLMITO WSC WWTP",city:"Olmito",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:26.045472,longitude:-97.505972},{facility_name:"SKIDMORE WSC WWTP",city:"Skidmore",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:28.270034,longitude:-97.678021},{facility_name:"ROLOFF WWTF",city:"Corpus Christi",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:27.728611,longitude:-97.523055},{facility_name:"BIRKHEAD WELL WWTP",city:"Rockdale",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.592694,longitude:-96.966361},{facility_name:"MILANO WELL WWTP",city:"Rockdale",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.686556,longitude:-96.908389},{facility_name:"ANTHIS WELL WTP",city:"Rockdale",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.64225,longitude:-96.926861},{facility_name:"REFUGIO COUNTY WCID 1",city:"Tivoli",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.189403,longitude:-95.799141},{facility_name:"CITY OF ZAVALLA WWTF",city:"Zavalla",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.148286,longitude:-94.433685},{facility_name:"CITY OF ALAMO WWTP",city:"Alamo",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:26.141722,longitude:-98.118583},{facility_name:"LAKE FORK MARINA WWTP",city:"Alba",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.868389,longitude:-95.621889},{facility_name:"STEAMBOAT SHORES WWTF",city:"Emory",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.894194,longitude:-95.664917},{facility_name:"POPE'S LANDING WWTF",city:"Alba",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.850889,longitude:-95.624806},{facility_name:"LAKE FORK RESORT WWTF",city:"Alba",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.877028,longitude:-95.632972},{facility_name:"CITY OF ARCHER CITY WTP",city:"Archer City",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.587917,longitude:-98.639056},{facility_name:"GONZALES COUNTY WSC 794 WELL SITE",city:"Gonzales",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.630337,longitude:-97.489499},{facility_name:"GONZALES COUNTY WSC BEBE WELL SITE",city:"Gonzales",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.414166,longitude:-97.638333},{facility_name:"GONZALES COUNTY WSC 304 WELL",city:"Gonzales",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.616944,longitude:-97.415555},{facility_name:"CITY OF CRAWFORD WWTP",city:"Crawford",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.53125,longitude:-97.4325},{facility_name:"CITY OF VALLEY MILLS WWTP",city:"Valley Mills",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.664361,longitude:-97.463278},{facility_name:"CITY OF OGLESBY WWTP",city:"Oglesby",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.417083,longitude:-97.513333},{facility_name:"CAMP JOHN MARC WWTF",city:"Dallas",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.962833,longitude:-97.555444},{facility_name:"POLK STREET WWTP",city:"Beaumont",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.946778,longitude:-97.330389},{facility_name:"TEXAS CONFERENCE ASSOICATION SEVENTH DAY ADVENTISTS WWTP",city:"Alvarado",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.898888,longitude:-97.410833},{facility_name:"WINNIE - STOWELL WWTF",city:"Stowell",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.80601,longitude:-94.370959},{facility_name:"MAIN WWTF",city:"Ozona",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.673611,longitude:-101.213361},{facility_name:"FORRESTON WWTP",city:"Forreston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.251946,longitude:-96.861704},{facility_name:"RICE WSC WWTP",city:"Rice",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.238869,longitude:-96.506542},{facility_name:"CITY OF CELESTE WWTP",city:"Celeste",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.274556,longitude:-96.200806},{facility_name:"OAK ISLAND WWTP",city:"Stowell",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.664389,longitude:-94.686861},{facility_name:"SMITH POINT WWTP",city:"Stowell",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.69397,longitude:-94.62989},{facility_name:"HANKAMER WWTF",city:"Stowell",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.853611,longitude:-94.640833},{facility_name:"JASPER COUNTY WCID NO.1",city:"Jasper",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.436583,longitude:-93.969056},{facility_name:"SUNRAY WWTP",city:"Sunray",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:36.03862,longitude:-101.8207},{facility_name:"CITY OF WOLFE CITY WWTF",city:"Wolfe City",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.348787,longitude:-96.076103},{facility_name:"CITY OF PRESIDIO WWTF",city:"Presidio",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.532907,longitude:-104.317451},{facility_name:"BLAKETREE MUD NO 1 WWTP",city:"Dallas",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.306944,longitude:-95.772222},{facility_name:"CRANE WWTP",city:"Montgomery",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.316388,longitude:-95.616111},{facility_name:"SPRING CENTER WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.09448,longitude:-95.43493},{facility_name:"CITY OF MOUNT ENTERPRISE WWTF",city:"Mount Enterprise",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.895201,longitude:-94.686662},{facility_name:"LA SARA WWTP",city:"Edinburg",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:26.473028,longitude:-97.917972},{facility_name:"TPWD LAKE LIVINGSTON STATE PARK",city:"Austin",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.666022,longitude:-95.000535},{facility_name:"COLLIN COUNTY ADVENTURE CAMP WWTF",city:"Irving",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.373974,longitude:-96.471335},{facility_name:"CANUTILLO MIDDLE SCHOOL WWTP",city:"Canutillo",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.925019,longitude:-106.608748},{facility_name:"DALE PUMP STATION",city:"Lockhart",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.921222,longitude:-97.561778},{facility_name:"BROWNSBORO WTP",city:"Lockhart",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.817528,longitude:-97.63575},{facility_name:"CAMP SWIFT IRON REMOVAL WTP",city:"Bastrop",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.19985,longitude:-97.30529},{facility_name:"C IRON REMOVAL WTP",city:"Bastrop",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.320778,longitude:-97.313444},{facility_name:"MCDADE IRON REMOVAL WTP",city:"Bastrop",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.343787,longitude:-97.379394},{facility_name:"BLUE IRON REMOVAL PLANT WTP",city:"Bastrop",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.368611,longitude:-97.113972},{facility_name:"DALE WELL 2A WTF",city:"Lockhart",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.906388,longitude:-97.570833},{facility_name:"UNION GROVE ISD WWTP",city:"Gladewater",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.57047,longitude:-94.923814},{facility_name:"CITY OF ARP WWTP",city:"Arp",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.21659,longitude:-95.058678},{facility_name:"CITY OF ECTOR WWTP",city:"Ector",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.5895,longitude:-96.278556},{facility_name:"DIANA S.U.D. - WWTP",city:"Diana",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.690694,longitude:-94.74825},{facility_name:"CITY OF DEVERS WWTP",city:"Devers",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.021583,longitude:-94.589917},{facility_name:"HOLY TRINITY EPISCOPAL SCHOOL WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.89447,longitude:-95.21115},{facility_name:"SRALLA MHP WWTP",city:"Magnolia",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.88226,longitude:-95.03583},{facility_name:"MORGAN'S POINT RESORT WWTF",city:"Morgan'S Point Resort",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.14766,longitude:-97.47432},{facility_name:"PERRIN WHITT CISD WWTP",city:"Perrin",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.035512,longitude:-98.06941},{facility_name:"CUDDIHY AIRFIELD WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:27.715694,longitude:-97.510722},{facility_name:"BISHOP CISD WWTP",city:"Bishop",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:27.6729,longitude:-97.63568},{facility_name:"CAMP LONE STAR WWTP",city:"La Grange",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.895361,longitude:-96.845},{facility_name:"CITY OF GRUVER WWTP",city:"Gruver",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:36.251528,longitude:-101.396944},{facility_name:"WALNUT SPRINGS CITY OF WWTP",city:"Walnut Springs",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.05585,longitude:-97.7496},{facility_name:"CITY OF DETROIT WWTP",city:"Detroit",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.65775,longitude:-95.254583},{facility_name:"CITY OF MARLIN WWTP",city:"Marlin",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.30744,longitude:-96.89801},{facility_name:"LEON CREEK WATER RECYCLING CENTER",city:"San Antonio",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.276833,longitude:-98.514417},{facility_name:"MEDIO CREEK WATER RECYC. CTR.",city:"San Antonio",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.397417,longitude:-98.669556},{facility_name:"MITCHELL LAKE WWTF",city:"San Antonio",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.271194,longitude:-98.487944},{facility_name:"CITY OF TRENTON WWTP",city:"Trenton",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.425106,longitude:-96.346646},{facility_name:"WHITNEY LAKE POWERHOUSE WWTF",city:"Clifton",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.864028,longitude:-97.368611},{facility_name:"ROYSE CITY WWTF",city:"Royse City",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.957333,longitude:-96.318028},{facility_name:"WYLIE WWTP",city:"Wylie",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.997094,longitude:-96.551669},{facility_name:"CITY OF HOLLIDAY WWTP",city:"Holliday",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.823292,longitude:-98.68679},{facility_name:"CITY OF STOCKDALE WWTP",city:"Stockdale",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.232639,longitude:-97.979611},{facility_name:"CITY OF MOODY WWTP",city:"Moody",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.31027,longitude:-97.36513},{facility_name:"LADONIA WWTF",city:"Ladonia",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.412054,longitude:-95.938974},{facility_name:"IS ZEN CENTER WWTF",city:"Magnolia",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.15543,longitude:-95.6063},{facility_name:"REALITOS WWTP",city:"Benavides",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:27.442777,longitude:-98.529444},{facility_name:"CITY OF GORMAN WWTP",city:"Gorman",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.201778,longitude:-98.684194},{facility_name:"CITY OF TROUP WWTP",city:"Troup",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.133564,longitude:-95.115069},{facility_name:"CANYON LAKE WWTF",city:"Fort Sam Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.909722,longitude:-98.213611},{facility_name:"CAMP MAXEY WWTF",city:"Austin",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.770018,longitude:-95.538286},{facility_name:"CITY OF COLMESNEIL WWTP",city:"Colmesneil",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.914361,longitude:-94.432139},{facility_name:"CITY OF ROXTON WWTP",city:"Roxton",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.536354,longitude:-95.721917},{facility_name:"CITY OF LOVELADY WWTP",city:"Lovelady",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.123592,longitude:-95.45374},{facility_name:"CITY OF GOLDTHWAITE WTP",city:"Goldthwaite",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.439667,longitude:-98.589417},{facility_name:"CITY OF PALMER WWTP",city:"Palmer",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"CITY OF HIGGINS WWTP",city:"Higgins",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:36.134972,longitude:-100.029694},{facility_name:"COOPER LAKE ST PARK - S SULPHUR UNIT WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.287089,longitude:-95.666643},{facility_name:"CADDO LAKE STATE PARK WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.678444,longitude:-94.175222},{facility_name:"BLOOMING GROVE WWTP",city:"Blooming Grove",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.093812,longitude:-96.70706},{facility_name:"SLAUGHTER ROAD WWTP",city:"Freeport",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:28.968278,longitude:-95.396583},{facility_name:"GREENS PARKWAY MUD - WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.953278,longitude:-95.369639},{facility_name:"IOWA PARK WWTF",city:"Iowa Park",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.941788,longitude:-98.67868},{facility_name:"CITY OF NOCONA WEST WWTF",city:"Nocona",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.785083,longitude:-97.739194},{facility_name:"CITY OF NOCONA SOUTH WWTP",city:"Nocona",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.775083,longitude:-97.721694},{facility_name:"NEW DANVILLE COMMUNITY WWTP",city:"Willis",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.48134,longitude:-95.51906},{facility_name:"HAMSHIRE COMMUNITY WWTP",city:"Beaumont",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.875472,longitude:-94.309333},{facility_name:"CITY OF NEW LONDON SOUTH WWTP",city:"New London",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.286278,longitude:-94.91325},{facility_name:"RIVER HILLS OWNERS ASSOCIATION",city:"Denison",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.711167,longitude:-96.606444},{facility_name:"CENTERVILLE WWTP",city:"Centerville",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.257361,longitude:-95.972111},{facility_name:"SAN AUGUSTINE WWTF",city:"San Augustine",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.519333,longitude:-94.117694},{facility_name:"CITY OF HUNTINGTON WWTF",city:"Huntington",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.268799,longitude:-94.558205},{facility_name:"CITY OF BEDIAS WWTP",city:"Bedias",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.781111,longitude:-95.945833},{facility_name:"ACCELERATED PRODUCTION WWTF",city:"Tomball",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.034429,longitude:-95.602774},{facility_name:"BROADDUS WWTP",city:"Broaddus",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.300021,longitude:-94.275421},{facility_name:"CITY OF TENAHA WWTP",city:"Tenaha",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.94271,longitude:-94.231403},{facility_name:"CITY OF WELLS WWTP",city:"Wells",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.48845,longitude:-94.94025},{facility_name:"HARBORLIGHT RESORT WWTP",city:"Hemphill",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.408333,longitude:-93.781944},{facility_name:"LAKEVIEW RV PARK & AMP MOTEL WWTP",city:"Zavalla",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.203333,longitude:-94.336666},{facility_name:"CITY OF LONE OAK WWTP",city:"Lone Oak",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.985174,longitude:-95.938745},{facility_name:"BEACH ROAD MUD WWTP",city:"Matagorda",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:28.631306,longitude:-95.969306},{facility_name:"CITY OF WEIMAR WWTP",city:"Weimar",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.697917,longitude:-96.766111},{facility_name:"CITY OF AVERY WWTP",city:"Avery",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.561972,longitude:-94.776444},{facility_name:"NOONDAY WATER WELL 2 WWTF",city:"Tyler",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.201528,longitude:-95.376333},{facility_name:"CITY OF AVINGER WWTP",city:"Avinger",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.905079,longitude:-94.546882},{facility_name:"CITY OF BECKVILLE WWTP",city:"Beckville",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.232146,longitude:-94.449716},{facility_name:"TEASELVILLE WELL 1 WWTF",city:"Tyler",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.10588,longitude:-95.40915},{facility_name:"CITY OF BLOOMBURG WWTP",city:"Bloomburg",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.132917,longitude:-94.055111},{facility_name:"SOUTHSIDE WWTF",city:"Rio Hondo",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:26.077598,longitude:-97.546647},{facility_name:"CARLISLE ISD WWTP",city:"Price",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.12875,longitude:-94.941306},{facility_name:"CITY OF NAPLES WWTP",city:"Naples",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.200916,longitude:-94.663418},{facility_name:"WOLF CREEK PARK WWTP",city:"Livingston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.664366,longitude:-95.150851},{facility_name:"OAK HAVEN RECOVERY CENTER WWTP",city:"Longview",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.596806,longitude:-94.456583},{facility_name:"JESUS AWAKENING MOVEMENT FOR AMERICA WWTP",city:"Lindale",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.5325,longitude:-95.548333},{facility_name:"LEVERETT'S CHAPEL ISD WWTP",city:"Laird Hill",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.312667,longitude:-94.919639},{facility_name:"HORACE WHATELY WWTP",city:"Atlanta",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.11848,longitude:-94.16527},{facility_name:"ESTELLINE WWTP",city:"Wichita Falls",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:34.544694,longitude:-100.426722},{facility_name:"UNION HILL ISD WWTP",city:"Gilmer",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.805755,longitude:-94.979243},{facility_name:"ARROWHEAD RANCH ESTATES WWTP",city:"Wichita Falls",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.780889,longitude:-98.401639},{facility_name:"ALDINE ISD ANNE LOUISE EDUCATIONAL COMPLEX",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.91938,longitude:-95.465553},{facility_name:"HARRIS COUNTY LEADERSHIP ACADEMY WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.90388,longitude:-95.819999},{facility_name:"TRUCK STOP AT FM 565 AND I-10 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.830277,longitude:-94.805833},{facility_name:"WESTWOOD WSC WWTP",city:"Jasper",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.084606,longitude:-94.160581},{facility_name:"JACINTOPORT TERMINAL WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.74745,longitude:-95.11627},{facility_name:"DELTA COUNTY MUD WWTF",city:"Cooper",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.433913,longitude:-95.849075},{facility_name:"FOREST GLEN WWTF",city:"Huntsville",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.665228,longitude:-95.352073},{facility_name:"BEAR CREEK PARK WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.827167,longitude:-95.623},{facility_name:"REUION 20 TRAVEL VILLAGE WWTP",city:"Tyler",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.441167,longitude:-95.131598},{facility_name:"BEECHWOOD WWTF",city:"Hemphill",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.207759,longitude:-93.648052},{facility_name:"FIN &AMP; FEATHER WWTP",city:"Hemphill",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.279145,longitude:-93.722915},{facility_name:"MONTE ALTO WWTP",city:"Edinburg",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:26.375444,longitude:-97.988972},{facility_name:"NAWSC NORTH WESLACO WWTP",city:"Edinburg",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:26.235,longitude:-97.9675},{facility_name:"BRACKETTVILLE FT CLARK WWTP",city:"Bracketville",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.276788,longitude:-100.427866},{facility_name:"CITY OF ELKHART WWTP",city:"Elkhart",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.617667,longitude:-95.583556},{facility_name:"CRESTWOOD WWTF",city:"Austin",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.788102,longitude:-94.560023},{facility_name:"SHEPPARD AIR FORCE BASE REC AN",city:"Sheppard Afb",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.978526,longitude:-98.515734},{facility_name:"CITY OF JUNCTION WWTP",city:"Junction",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.498185,longitude:-99.730848},{facility_name:"CONROE FEEDER ZONE ELEMENTARY SCHOOL FLEX 21 WWTP",city:"Conroe",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.325663,longitude:-95.588098},{facility_name:"STEPHEN F AUSTIN WWTF",city:"Conroe",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.33306,longitude:-95.34408},{facility_name:"SAN JACINTO ELEMENTARY WWTP",city:"Conroe",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.19576,longitude:-95.3451},{facility_name:"CITY OF CROWELL WWTP",city:"Crowell",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.975917,longitude:-99.715639},{facility_name:"RICHARDS ISD WWTP",city:"Richards",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.5386,longitude:-95.84286},{facility_name:"CITY OF ANDERSON WWTF",city:"Anderson",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.47975,longitude:-95.98675},{facility_name:"CITY OF CALVERT WWTP",city:"Calvert",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.969611,longitude:-96.683583},{facility_name:"PORT TERMINAL RAILROAD WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.758,longitude:-95.289917},{facility_name:"BOYS AND GIRLS COUNTRY OF HOUSTON WWTP",city:"Hockley",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.04701,longitude:-95.81533},{facility_name:"DYNAMIC PRODUCTS WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.74617,longitude:-95.10713},{facility_name:"CYPRESS PARK WWTF",city:"Spring",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.947722,longitude:-95.556583},{facility_name:"AMC FACILITIES WWTF",city:"Torrence",state:"Calif.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.992222,longitude:-95.394978},{facility_name:"LOCHINVAR GOLF CLUB WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.98371,longitude:-95.38485},{facility_name:"HOOKS MOBILE HOME PARK WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.889,longitude:-95.3549},{facility_name:"BERRY CREEK WWTP",city:"Georgetown",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.702561,longitude:-97.657822},{facility_name:"CITY OF ROGERS WWTP",city:"Rogers",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.922389,longitude:-97.231083},{facility_name:"LOST RIVER RV PARK WWTP",city:"Baytown",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.832581,longitude:-94.801813},{facility_name:"HIGH ISLAND ISD WWTF",city:"High Island",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.560555,longitude:-94.387222},{facility_name:"COUNTY ROAD PARK",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.90606,longitude:-95.52808},{facility_name:"NORTHWEST WATER RECLAMATION PLANT",city:"Lubbock",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.67517,longitude:-101.87228},{facility_name:"CAMP SUMMIT",city:"Dallas",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.115111,longitude:-97.730861},{facility_name:"PEARSALL DEVELOPMENT WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.010833,longitude:-99.060277},{facility_name:"ALDINE OAKS MHC WWTP",city:"Irvine",state:"Calif.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.885889,longitude:-95.38},{facility_name:"GALVESTON 1 SANITARY WWTF",city:"Keithville",state:"La.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.322417,longitude:-94.783389},{facility_name:"MELROSE MHP WWTP",city:"Torrance",state:"Calif.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.87811,longitude:-95.38155},{facility_name:"OCEANEERING INTERNATIONAL WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.876225,longitude:-95.595322},{facility_name:"OIL STATES INDUSTRIES WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.756065,longitude:-95.102879},{facility_name:"PIN OAK MHP WWTF",city:"Irvine",state:"Calif.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.89217,longitude:-95.39657},{facility_name:"WILD PEACH ELEMENTARY WWTF",city:"West Columbia",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.075,longitude:-95.616861},{facility_name:"LAKE PFLUGERVILLE WWTF",city:"Pflugerville",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.43487,longitude:-97.56941},{facility_name:"POINT WEST WWTF",city:"Point",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"POINT EAST PLANT WWTF",city:"Point",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"THE HEAVNES MHP WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.89924,longitude:-95.35494},{facility_name:"RELLIS CAMPUS WWTP",city:"College Station",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.629083,longitude:-96.472167},{facility_name:"GBW RAILCAR SERVICES HOCKLEY",city:"Hockley",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.0256,longitude:-95.86559},{facility_name:"FIRST RESPONDERS ACADEMY WWTP",city:"San Antonio",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.267777,longitude:-98.695555},{facility_name:"GOREE WWTF",city:"Goree",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.468694,longitude:-99.514528},{facility_name:"MALLARD POINT WWTF",city:"Richardson",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.054984,longitude:-96.012402},{facility_name:"HARRIS COUNTY MUD 278 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.98075,longitude:-95.196028},{facility_name:"CITY OF COOPER - WWTP",city:"Cooper",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.3821,longitude:-95.6939},{facility_name:"PORT ADVENTURE",city:"Austin",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.911833,longitude:-95.227417},{facility_name:"MEXIA STATE SUPPORTED LIVING CENTER WWTP",city:"Mexia",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.693222,longitude:-96.53025},{facility_name:"VAM USA FACILITY",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.99488,longitude:-95.39565},{facility_name:"SANTE FE WWTP",city:"New Waverly",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.157222,longitude:-95.080555},{facility_name:"FORT HANCOCK WWTP",city:"Fort Hancock",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.28957,longitude:-105.83433},{facility_name:"GOSPEL FOR ASIA CAMPUS MINISTRY WWTP",city:"Wills Point",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.667777,longitude:-96.080555},{facility_name:"VALLOUREC STAR",city:"Channelview",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.83911,longitude:-95.12761},{facility_name:"CITY OF JOSEPHINE WWTF",city:"Josephine",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.065667,longitude:-96.299417},{facility_name:"CITY OF MORGAN WWTF",city:"Morgan",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.008472,longitude:-97.608056},{facility_name:"WEST POINT WWTP",city:"La Grange",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"WALLER CO MUD 19",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.779166,longitude:-95.934166},{facility_name:"TIFCO INDUSTRIES WWTP",city:"Cypress",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.9305,longitude:-95.634083},{facility_name:"WESTWOOD SHORES MUD WWTF",city:"Trinity",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.940179,longitude:-95.315766},{facility_name:"US RV PARK WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.558888,longitude:-95.689444},{facility_name:"CITY OF GOODRICH WWTP",city:"Goodrich",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.616766,longitude:-94.962455},{facility_name:"ER IRON REMOVAL WTP",city:"Bastrop",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"GONZALES WARM SPRINGS WWTF",city:"Luling",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.593222,longitude:-97.583222},{facility_name:"DELHI IRON REMOVAL PLANT",city:"Bastrop",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"MCMAHAN WTF",city:"Bastrop",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"WINDFERN MHP WWTP",city:"Navasota",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.9089,longitude:-95.53855},{facility_name:"SI ENTERPRISES WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.75602,longitude:-95.10531},{facility_name:"JACINTOPORT INDUSTRIAL DEV WWT",city:"Wilmington",state:"Mont.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.742722,longitude:-95.109639},{facility_name:"CHRISTIAN TABERNACLE OF HOUSTON WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.80675,longitude:-95.20775},{facility_name:"CHRISTIAN TABERNACLE WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.883377,longitude:-95.202622},{facility_name:"RICHMOND COMMUNITY ESTATES",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"SUMMER BREEZE RV PARK WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.782285,longitude:-95.995426},{facility_name:"CITY OF NEW LONDON WWTF",city:"New London",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.286278,longitude:-94.91325},{facility_name:"PETTY WWTF",city:"Petty",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.597304,longitude:-95.813677},{facility_name:"FANNETT CAMPUS WWTP",city:"Hamshire",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.919917,longitude:-94.252111},{facility_name:"S.CNTRL CALHOUN CO.WCID#1-WWTP",city:"Port Lavaca",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:28.56158,longitude:-96.540802},{facility_name:"CITY OF AUSTWELL WWTP",city:"Austwell",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:28.39425,longitude:-96.841694},{facility_name:"ONALASKA WWTP",city:"Onalaska",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.80569,longitude:-95.111548},{facility_name:"CAMBRIDGE MEADOWS WWTP",city:"Rowlett",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.2575,longitude:-96.534166},{facility_name:"KATY ISD MAYDE CREEK WWTP",city:"Katy",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.805778,longitude:-95.698556},{facility_name:"CINCO MUD",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.713833,longitude:-95.739111},{facility_name:"CROSBY MUD WWTF",city:"Crosby",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.907417,longitude:-95.073083},{facility_name:"CAMP ALLEN WWTP",city:"Navasota",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.349029,longitude:-95.987583},{facility_name:"MAURICEVILLE MUD WWTP",city:"Mauriceville",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.22793,longitude:-93.807393},{facility_name:"SUN ACRES MHP WWTF",city:"Kilgore",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.399944,longitude:-94.91625},{facility_name:"ST IVES RV RESORT WWTP",city:"Pearland",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"CITY OF MASON WWTP",city:"Mason",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.739193,longitude:-99.20817},{facility_name:"HARRIS CO IMPROVEMENT DISTRICT 13 WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.972222,longitude:-95.729166},{facility_name:"CITY OF ALVORD WWTP",city:"Alvord",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.352,longitude:-97.7036},{facility_name:"COMMODORE COVE IMPROVEMENT DISTRICT WWTP",city:"Freeport",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.009225,longitude:-95.300572},{facility_name:"GRAND OAKS BUSINESS PARK",city:"Richmond",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.657222,longitude:-95.810277},{facility_name:"ROYAL COACH TRAILS MHP WWTP",city:"Navasota",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.9184,longitude:-95.37708},{facility_name:"LA CASITA HOMES II WWTP",city:"Missouri City",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.92285,longitude:-95.47753},{facility_name:"SPLASTOWN WWTP",city:"Kansas City",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.073216,longitude:-95.435293},{facility_name:"RUSH GAS STATION WWTF",city:"Sugar Land",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.796944,longitude:-94.851388},{facility_name:"MONTGOMERY COUNTY MUD 16 WWTP",city:"Splendora",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.196583,longitude:-95.164639},{facility_name:"FOUNTAINVIEW WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.939487,longitude:-95.307718},{facility_name:"CITY OF DILLEY WWTF",city:"Dilley",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:28.654083,longitude:-99.198056},{facility_name:"KMTEX PORT ARTHUR",city:"Port Arthur",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.829276,longitude:-93.966729},{facility_name:"SEBASTIAN MUD WWTF",city:"Sebastian",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:26.316,longitude:-97.800639},{facility_name:"HARRIS COUNTY MUD 24 WWTP",city:"Bellaire",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.0305,longitude:-95.534278},{facility_name:"MATAGORDA COUNTY WCID 5 WWTP",city:"Blessing",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:28.864722,longitude:-96.225914},{facility_name:"MONTGOMERY COUNTY MUD 144 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.261944,longitude:-95.503888},{facility_name:"SCHLUMBERGER ROSHARON COMPLETIONS",city:"Rosharon",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.371472,longitude:-95.443028},{facility_name:"BAYSIDE WATER RECLAMATION FACILITY",city:"Bayside",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:28.095556,longitude:-97.231861},{facility_name:"CITY OF CORRIGAN WWTP",city:"Corrigan",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.999444,longitude:-94.821944},{facility_name:"BRAZORIA - FORT BEND COUNTIES MUD 3 WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.474839,longitude:-95.45422},{facility_name:"SLIDELL ISD WWTP",city:"Slidell",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.365222,longitude:-97.388112},{facility_name:"CITY OF MIDWAY WWTP",city:"Midway",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.026982,longitude:-95.742195},{facility_name:"CITY OF NORMANGEE WWTF",city:"Normangee",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.032944,longitude:-96.114111},{facility_name:"CITY OF SKELLYTOWN WWTP",city:"Skellytown",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:35.566388,longitude:-101.179722},{facility_name:"LONE STAR WWTP",city:"Lone Star",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.908684,longitude:-94.705559},{facility_name:"EAGLE CREEK RANCH WTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.490957,longitude:-94.815638},{facility_name:"CANAL WTP",city:"El Paso",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.751887,longitude:-106.492106},{facility_name:"MAGNOLIA SPRINGS WASTEWATER TREATMENT FACILITY",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.289644,longitude:-95.770486},{facility_name:"TOWN OF ROUND TOP WWTP",city:"Round Top",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.072779,longitude:-96.690278},{facility_name:"CITY OF INDUSTRY WWTP",city:"Industry",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.980834,longitude:-96.519586},{facility_name:"THE PARK",city:"Sugarland",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.711388,longitude:-102.673888},{facility_name:"CITY OF SOMERVILLE WWTF",city:"Sommerville",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.351067,longitude:-96.522811},{facility_name:"CAMP FOR ALL FOUNDATION WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.241028,longitude:-96.577722},{facility_name:"GLEN OAKS MHP WWTF",city:"Orlando",state:"Fla.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.64215,longitude:-96.25819},{facility_name:"CITY OF BURTON WWTP",city:"Burton",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.150318,longitude:-96.679278},{facility_name:"CITY OF SNOOK WWTP",city:"Snook",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.504083,longitude:-96.448},{facility_name:"D&L MHP WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.88942,longitude:-95.38885},{facility_name:"LAZY RIVER IMPROVEMENT DISTRICT WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.228612,longitude:-95.438803},{facility_name:"529 #35 LTD WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.88008,longitude:-95.58837},{facility_name:"RENE HINOJOSA WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.894444,longitude:-95.286333},{facility_name:"SAN PATRICIO COUNTY MUD 1",city:"Edroy",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:27.969889,longitude:-97.676972},{facility_name:"RIVERIA WCID WWTF",city:"Riviera",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:27.290778,longitude:-97.819444},{facility_name:"HARMONY ISD WWTP",city:"Big Sandy",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.746778,longitude:-95.107806},{facility_name:"THE CROSSING AT HAVENWOOD WWTP",city:"San Marcos",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.777222,longitude:-98.058333},{facility_name:"WARREN ISD-HIGH SCHOOL WWTF",city:"Warren",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.614145,longitude:-94.393765},{facility_name:"KIRBY CREEK WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.203528,longitude:-98.396722},{facility_name:"LOMETA REGIONAL WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.227639,longitude:-98.41775},{facility_name:"CITY OF JEWETT WWTP",city:"Jewett",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.353417,longitude:-96.133417},{facility_name:"LEON ISD WWTP",city:"Jewett",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.314124,longitude:-96.211807},{facility_name:"YELLOW ROSE TRAVEL PLAZA WTP",city:"Pasadena",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.093055,longitude:-95.963055},{facility_name:"CAMP SWIFT REGIONAL WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.16978,longitude:-97.30609},{facility_name:"SUNDOWN RANCH WWTP",city:"Irving",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.423888,longitude:-95.868055},{facility_name:"HOUSTON POLYMERS TERMINAL WWTP",city:"La Porte",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.695819,longitude:-95.06216},{facility_name:"CITY OF BOGATA RECLAMATION WWT",city:"Bogata",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.450333,longitude:-95.205778},{facility_name:"ZAPATA COUNTY WATERWORKS SEWER DIVISION WWTP",city:"Zapata",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:26.892806,longitude:-99.271694},{facility_name:"ZAPATA COUNTY CHIHUAHUA WWTF",city:"Zapata",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:26.78475,longitude:-99.118556},{facility_name:"HOLLY LAKE CONDOMINIUM ASSOCIATION WWTP",city:"Hawkins",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.71732,longitude:-95.20621},{facility_name:"SPORT HARBOUR MARINA WWTF",city:"Montgomery",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.372694,longitude:-95.631611},{facility_name:"DUCO JACINTOPORT WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.75508,longitude:-95.10363},{facility_name:"LAKE TAWAKONI RV CAMPGROUND WWTF",city:"Chicago",state:"Iowa",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.878722,longitude:-95.909389},{facility_name:"MHC TT LAKE WHITNEY PRESERVE",city:"Chicago",state:"Iowa",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.004583,longitude:-97.351111},{facility_name:"LOST CREEK WWTP",city:"Conroe",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.350833,longitude:-95.373055},{facility_name:"WILDWOOD WWTP",city:"Village Mills",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.506861,longitude:-94.43825},{facility_name:"CITY OF SEMINOLE WWTP",city:"Seminole",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.708139,longitude:-102.622944},{facility_name:"CITY OF MULLIN WWTF",city:"Mullin",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.550083,longitude:-98.663722},{facility_name:"CITY OF TRINITY WWTP",city:"Trinity",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.943222,longitude:-95.359917},{facility_name:"GBW RAILCAR SERVICES WWTP",city:"Pittsburg",state:"Kan.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.539028,longitude:-94.250444},{facility_name:"HELMS TRAIL WWTP",city:"Plano",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.697825,longitude:-96.427332},{facility_name:"PALO PINTO COUNTY WWTF",city:"Palo Pinto",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.770944,longitude:-98.305861},{facility_name:"WHITE ROCK WWTP",city:"Corsicana",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.000555,longitude:-96.216388},{facility_name:"PADRE ISLAND NATIONAL SEASHORE WWTF",city:"Corpus Christi",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:27.421639,longitude:-97.311278},{facility_name:"CITY OF MALONE WWTF",city:"Malone",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.909028,longitude:-96.888306},{facility_name:"CITY OF HILLSBORO WWTP",city:"Hillsboro",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.999806,longitude:-97.143806},{facility_name:"CITY OF HUBBARD WWTP",city:"Hubbard",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.835521,longitude:-96.792548},{facility_name:"CITY OF BYNUM WWTP",city:"Bynum",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.968333,longitude:-96.998611},{facility_name:"CITY OF LYFORD WWTP",city:"Lyfor",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:26.415444,longitude:-97.767917},{facility_name:"CRYSTAL PALACE WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.452444,longitude:-94.6485},{facility_name:"LOUIS VUITTON RANCHO 54",city:"San Dimas",state:"Calif.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.37493,longitude:-97.26876},{facility_name:"COUNTRY OAKS MHC",city:"Flower Mound",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.8397,longitude:-97.4978},{facility_name:"TDCJ DARRINGTON WWTP",city:"Huntsville",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.398333,longitude:-95.48972},{facility_name:"WHITE ROCK ESTATES",city:"Trinity",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.913222,longitude:-95.274917},{facility_name:"KING FUELS WWTF",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.79071,longitude:-95.09014},{facility_name:"PINE GULLY WWTP",city:"Seabrook",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.587777,longitude:-95.014444},{facility_name:"CITY OF ELECTRA WWTP",city:"Electra",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:34.009389,longitude:-98.875722},{facility_name:"CITY OF ELDORADO WWTP",city:"Eldorado",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.867417,longitude:-100.583611},{facility_name:"NORTH PARK BUSINESS CENTER WWTF",city:"Kingwood",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.06864,longitude:-95.229119},{facility_name:"HARTWICK GREEN MHP",city:"Trinity",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.885887,longitude:-95.358474},{facility_name:"ROVING MEADOWS UTILITIES WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.80098,longitude:-96.77444},{facility_name:"PETTUS MUD WWTP",city:"Pettus",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:28.60875,longitude:-97.806306},{facility_name:"SAVOY WWTP",city:"Savoy",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.606361,longitude:-96.367944},{facility_name:"VAN VLECK WWTP",city:"Van Vleck",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.01225,longitude:-95.884056},{facility_name:"BRUSHY WEST WWTP",city:"Austin",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.513548,longitude:-97.665861},{facility_name:"ROB AND BESSIE WELDER PARK",city:"Sinton",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:28.06625,longitude:-97.530833},{facility_name:"DRY CREEK WWTF",city:"Pittsburg",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.99472,longitude:-94.96737},{facility_name:"SPARKS BRANCH WWTP",city:"Pittsburg",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.995833,longitude:-94.940555},{facility_name:"CITY OF MERKEL WWTF",city:"Merkel",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.47096,longitude:-100.01264},{facility_name:"CAMP HOBITZELLE WWTP",city:"Midlothian",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.39597,longitude:-97.00815},{facility_name:"MANSFIELD ISD WWTP",city:"Mansfield",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.554722,longitude:-97.232777},{facility_name:"PLEASANT OAKS WWTP",city:"Glendale",state:"Colo.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.45036,longitude:-97.41898},{facility_name:"OAK CREEK WWTP",city:"Weatherford",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:0,longitude:0},{facility_name:"CITY OF WAELDER WWTP",city:"Waelder",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.684139,longitude:-97.292472},{facility_name:"CITY OF HALLSVILLE WWTP",city:"Hallsville",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.505694,longitude:-94.549109},{facility_name:"CITY OF FLATONIA WWTP",city:"Flatonia",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.69747,longitude:-97.10636},{facility_name:"CASS COUNTY REST AREA WWTF",city:"Austin",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.058139,longitude:-94.284528},{facility_name:"HIGH POINT ELEMENTARY WWTF",city:"Navasota",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.34848,longitude:-95.91422},{facility_name:"TAFT FEDERAL PRISON WWTF",city:"Bakersfield",state:"Calif.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:35.31323593,longitude:-118.9210295},{facility_name:"CERES WRF",city:"Ceres",state:"Calif.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:37.578026,longitude:-120.975309},{facility_name:"ROCKINGHAM COUNTY HOME",city:"Brentwood",state:"Neb.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:43.011597,longitude:-71.053187},{facility_name:"ST. HELENS STP/BOISE CASCADE",city:"St Helens",state:"Ore.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:45.853539,longitude:-122.800487},{facility_name:"IRWD LOS ALISOS WRP",city:"Irvine",state:"Calif.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.66742814,longitude:-117.768144},{facility_name:"GANADO WWTP",city:"Ganado",state:"Ark.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:35.72,longitude:-109.572806},{facility_name:"MANDAN CITY OF",city:"Mandan",state:"Mont.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:46.82741,longitude:-100.8931},{facility_name:"ROGERS",city:"Rogers",state:"Minn.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:45.20339,longitude:-93.55895},{facility_name:"BAKERSFIELD WWTP 2",city:"Bakersfield",state:"Calif.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:35.31323593,longitude:-118.9210295},{facility_name:"DIXON WWTF",city:"Dixon",state:"Calif.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:38.44552,longitude:-121.81613},{facility_name:"ASTORIA, CITY OF",city:"Astoria",state:"Ore.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:46.201551,longitude:-123.771506},{facility_name:"TERREBONNE PARISH CONS. GOVT.",city:"Houma",state:"La.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:29.60095,longitude:-90.72722},{facility_name:"NTUA TUBA CITY WWTP",city:"Tuba City",state:"Ark.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:36.12425441,longitude:-111.2206643},{facility_name:"MONTEZUMA COUNTY",city:"Cortez",state:"Colo.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:37.30122,longitude:-108.57504},{facility_name:"CITY OF WEST BURLINGTON",city:"West Burlington",state:"Hawaii",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:40.85241392,longitude:-91.22565075},{facility_name:"BOVAY SCOUT RANCH WWTP",city:"Houston",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:30.332472,longitude:-96.026917},{facility_name:"JERRY L RILEY STP",city:"Bardstown",state:"Ky.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:37.78076,longitude:-85.510741},{facility_name:"OCEAN ISLE BEACH WWTP",city:"Ocean Isle Beach",state:"Mont.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.93556073,longitude:-78.47856213},{facility_name:"NORTHERN EDGE CASINO WWTF",city:"Farmington",state:"N.D.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:36.716269,longitude:-108.255737},{facility_name:"CITY OF BIG WELLS WWTF",city:"Big Wells",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:28.566861,longitude:-99.580806},{facility_name:"SODUS POINT (V) WWTP",city:"Sodus Point",state:"N.D.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:43.27275,longitude:-76.997083},{facility_name:"LAKE COUNTY NW REGIONAL PLANT",city:"Lakeport",state:"Calif.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:39.02385263,longitude:-122.948426},{facility_name:"LAKE COUNTY SE REGIONAL PLANT",city:"Lakeport",state:"Calif.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:39.02385263,longitude:-122.948426},{facility_name:"PRASA UNIBON COMMUNITY WWTP",city:"Morovis",state:"Pa.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:18.33164,longitude:-66.374076},{facility_name:"PRASA SAN SEBASTIAN (OLD) WWTP",city:"San Sebastian",state:"Pa.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:18.20110101,longitude:-67.13494611},{facility_name:"UPPER BLUE SANITATION DIST",city:"Breckenridge",state:"Colo.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:39.5002267,longitude:-106.0430996},{facility_name:"PRASA - PENUELAS WWTP",city:"Penuelas",state:"Pa.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:18.048805,longitude:-66.721626},{facility_name:"PRASA LAS MARIAS",city:"Las Marias",state:"Pa.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:18.24772999,longitude:-66.99288111},{facility_name:"KREMMLING SANITATION DISTRICT",city:"Kremmling",state:"Colo.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:40.11947308,longitude:-106.5170757},{facility_name:"PRASA AGUAS BUENAS",city:"Aguas Buenas",state:"Pa.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:18.258864,longitude:-66.101851},{facility_name:"CITY OF ROCKWELL CITY",city:"Rockwell City",state:"Hawaii",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:42.39574,longitude:-94.63307},{facility_name:"CITY OF EVANSDALE",city:"Evansdale",state:"Hawaii",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:42.47791,longitude:-92.28808},{facility_name:"RIVERBANK WWTP",city:"Riverbank",state:"Calif.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:37.736079,longitude:-120.935741},{facility_name:"EVANS CITY OF",city:"Evans",state:"Colo.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:40.37739,longitude:-104.69687},{facility_name:"NEWMAN WWTP",city:"Newman",state:"Calif.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:37.33527216,longitude:-121.0458027},{facility_name:"TWENTYNINE PALMS USMC MAINSIDE WWTP",city:"Twentynine Palms",state:"Calif.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:34.47312,longitude:-116.1146472},{facility_name:"FALLON WWTP",city:"Reno",state:"N.D.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:39.52419,longitude:-119.83857},{facility_name:"PLAINS, CITY OF (PLAINS WPCP)",city:"Plains",state:"Ga.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.01675,longitude:-84.386306},{facility_name:"DAVIE COUNTY - PUBLIC UTILITIES",city:"Mocksville",state:"Mont.",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:35.81245,longitude:-80.55237},{facility_name:"WATER WORKS AND SEWER BOARD OF THE CITY OF ASHLAND",city:"Ashland",state:"Alaska",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:33.2742,longitude:-85.8101},{facility_name:"CITY OF KOSSE WWTP",city:"Kosse",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.330333,longitude:-96.626388},{facility_name:"CHILTON WATER SUPPLY & SEWER SERVICE WWTP",city:"Chilton",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:31.267389,longitude:-97.058861},{facility_name:"ALBA WWTF",city:"Alba",state:"Texas",amount_of_biosolids_generated:0,amount_of_biosolids_managed_land_applied:0,latitude:32.773071,longitude:-95.632543}];function DA(T){let I,L,F,G,te,ae,s,oe,he,ve,Ye,Ce,lt,Ke,Nt,Oe;return F=new DE({props:{rScale:T[1]}}),{c(){I=Ja("div"),L=Ja("div"),mh(F.$$.fragment),G=xn(),te=Ja("div"),ae=Ja("span"),ae.textContent="Size waste water treatment plants by",s=xn(),oe=Ja("div"),he=Ja("button"),he.textContent="Biosolids spread",ve=xn(),Ye=Ja("button"),Ye.textContent="Biosolids generated",Ce=xn(),lt=Ja("div"),ba(ae,"class","dek"),ba(he,"class","svelte-1s7umaw"),Fm(he,"active",T[0]=="Prop B"),z1(he,"--color",T[2][1]),ba(Ye,"class","svelte-1s7umaw"),Fm(Ye,"active",T[0]=="Prop A"),z1(Ye,"--color",T[2][0]),ba(oe,"class","buttons"),ba(te,"class","toggle"),ba(L,"class","controls svelte-1s7umaw"),ba(lt,"id","map"),ba(lt,"class","svelte-1s7umaw")},m(ut,bt){Bu(ut,I,bt),ra(I,L),Vm(F,L,null),ra(L,G),ra(L,te),ra(te,ae),ra(te,s),ra(te,oe),ra(oe,he),ra(oe,ve),ra(oe,Ye),ra(I,Ce),ra(I,lt),Ke=!0,Nt||(Oe=[dh(he,"click",T[4]),dh(Ye,"click",T[5])],Nt=!0)},p(ut,[bt]){(!Ke||bt&1)&&Fm(he,"active",ut[0]=="Prop B"),(!Ke||bt&1)&&Fm(Ye,"active",ut[0]=="Prop A")},i(ut){Ke||(Gm(F.$$.fragment,ut),Ke=!0)},o(ut){ch(F.$$.fragment,ut),Ke=!1},d(ut){ut&&Cd(I),jm(F),Nt=!1,Ld(Oe)}}}function FA(T,I,L){let F,G="Prop B",te=NE().domain([0,112530]).range([1,20]),ae=null,s=["#966139","#61AA04"];Du.accessToken="pk.eyJ1IjoiYWd3YXRlcmRlc2siLCJhIjoiY2x2dHBvcHZnMTJwajJsbGx4NDg1NzkzdiJ9.x-5N8xgT9tGsilVw5h5kjw";let oe={top:0,bottom:0,left:0,right:0};function he(Ke,Nt){return Ke.map(Oe=>({...Oe,radius_generated:te(Oe.amount_of_biosolids_generated),radius_applied:te(Oe.amount_of_biosolids_managed_land_applied)}))}Eb(()=>{F=new Du.Map({container:"map",style:"mapbox://styles/agwaterdesk/clvtpr8ms05ty01qlb9u95lj2/draft"}),F.fitBounds([-127.001953,24.335836,-67.060547,49.92912],{duration:0}),F.setMinZoom(F.getZoom());const Ke=new WA({accessToken:Du.accessToken,mapboxgl:Du,countries:"us",placeholder:"Zoom to location",marker:!1});F.addControl(Ke,"top-left");let Nt=he(MA);F.on("load",()=>{F.addSource("sites",{type:"geojson",data:{type:"FeatureCollection",features:Nt.map(Oe=>({type:"Feature",properties:{facility_name:Oe.facility_name,city:Oe.city,state:Oe.state,radius_generated:Oe.radius_generated,radius_applied:Oe.radius_applied,amount_of_biosolids_generated:Oe.amount_of_biosolids_generated,amount_of_biosolids_managed_land_applied:Oe.amount_of_biosolids_managed_land_applied},geometry:{type:"Point",coordinates:[Oe.longitude,Oe.latitude]}}))}}),F.addLayer({id:"circle-layer",type:"circle",source:"sites",paint:{"circle-radius":["get",G=="Prop A"?"radius_generated":"radius_applied"],"circle-color":G=="Prop A"?s[0]:s[1],"circle-opacity":.25,"circle-stroke-width":1,"circle-stroke-color":G=="Prop A"?s[0]:s[1]}}),ve(),ae=new Du.Popup({closeButton:!1,closeOnClick:!1,offset:25}),F.on("mousemove","circle-layer",Oe=>{if(Oe.features.length>0){F.getCanvas().style.cursor="pointer";const ut=Oe.features[0],bt=ut.properties;F.setPaintProperty("circle-layer","circle-stroke-width",["case",["==",["get","facility_name"],ut.properties.facility_name],2,1]),F.setPaintProperty("circle-layer","circle-stroke-color",["case",["==",["get","facility_name"],ut.properties.facility_name],"#000000",G=="Prop A"?s[0]:s[1]]),ae.setLngLat(Oe.lngLat).setHTML(`
            <strong>${bt.facility_name}</strong><br/>
            <em>${bt.city}, ${bt.state}</em>  <br/>
          
            <p><b>Biosolids generated:</b> ${bt.amount_of_biosolids_generated.toLocaleString()} dry tons</p>
            <p><b>Biosolids spread:</b> ${bt.amount_of_biosolids_managed_land_applied.toLocaleString()} dry tons</p>

            `).addTo(F)}}),F.on("mouseleave","circle-layer",()=>{F.getCanvas().style.cursor="",F.setPaintProperty("circle-layer","circle-stroke-width",1),F.setPaintProperty("circle-layer","circle-stroke-color",G=="Prop A"?s[0]:s[1]),ae.remove()})}),Ke.on("result",({result:Oe})=>{Oe.bbox?F.fitBounds(Oe.bbox,{padding:oe}):Oe.center&&F.flyTo({center:Oe.center,zoom:10,essential:!0})})});function ve(){F.setPaintProperty("circle-layer","circle-radius",["get",G=="Prop A"?"radius_generated":"radius_applied"]),F.setPaintProperty("circle-layer","circle-color",G=="Prop A"?s[0]:s[1]),F.setPaintProperty("circle-layer","circle-stroke-color",G=="Prop A"?s[0]:s[1]),F.setFilter("circle-layer",["!=",["get",G=="Prop A"?"amount_of_biosolids_generated":"amount_of_biosolids_managed_land_applied"],0])}function Ye(Ke){L(0,G=Ke),ve()}return[G,te,s,Ye,()=>Ye("Prop B"),()=>Ye("Prop A")]}let BA=class extends nf{constructor(I){super(),of(this,I,FA,DA,Yu,{})}};var TT={exports:{}};/*! pym.js - v1.3.2 - 2018-02-13 */(function(T){(function(I){T.exports?T.exports=I():window.pym=I.call(this)})(function(){var I="xPYMx",L={},F=function(Ce){var lt=document.createEvent("Event");lt.initEvent("pym:"+Ce,!0,!0),document.dispatchEvent(lt)},G=function(Ce){var lt=new RegExp("[\\?&]"+Ce.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]")+"=([^&#]*)"),Ke=lt.exec(location.search);return Ke===null?"":decodeURIComponent(Ke[1].replace(/\+/g," "))},te=function(Ce,lt){if(!(lt.xdomain!=="*"&&!Ce.origin.match(new RegExp(lt.xdomain+"$")))&&typeof Ce.data=="string")return!0},ae=function(Ce){var lt=/^(?:(?:https?|mailto|ftp):|[^&:/?#]*(?:[/?#]|$))/gi;if(Ce.match(lt))return!0},s=function(Ce,lt,Ke){var Nt=["pym",Ce,lt,Ke];return Nt.join(I)},oe=function(Ce){var lt=["pym",Ce,"(\\S+)","(.*)"];return new RegExp("^"+lt.join(I)+"$")},he=Date.now||function(){return new Date().getTime()},ve=function(Ce,lt,Ke){var Nt,Oe,ut,bt=null,Mt=0;Ke||(Ke={});var Fi=function(){Mt=Ke.leading===!1?0:he(),bt=null,ut=Ce.apply(Nt,Oe),bt||(Nt=Oe=null)};return function(){var ai=he();!Mt&&Ke.leading===!1&&(Mt=ai);var Oi=lt-(ai-Mt);return Nt=this,Oe=arguments,Oi<=0||Oi>lt?(bt&&(clearTimeout(bt),bt=null),Mt=ai,ut=Ce.apply(Nt,Oe),bt||(Nt=Oe=null)):!bt&&Ke.trailing!==!1&&(bt=setTimeout(Fi,Oi)),ut}},Ye=function(){for(var Ce=L.autoInitInstances.length,lt=Ce-1;lt>=0;lt--){var Ke=L.autoInitInstances[lt];Ke.el.getElementsByTagName("iframe").length&&Ke.el.getElementsByTagName("iframe")[0].contentWindow||L.autoInitInstances.splice(lt,1)}};return L.autoInitInstances=[],L.autoInit=function(Ce){var lt=document.querySelectorAll("[data-pym-src]:not([data-pym-auto-initialized])"),Ke=lt.length;Ye();for(var Nt=0;Nt<Ke;++Nt){var Oe=lt[Nt];Oe.setAttribute("data-pym-auto-initialized",""),Oe.id===""&&(Oe.id="pym-"+Nt+"-"+Math.random().toString(36).substr(2,5));var ut=Oe.getAttribute("data-pym-src"),bt={xdomain:"string",title:"string",name:"string",id:"string",sandbox:"string",allowfullscreen:"boolean",parenturlparam:"string",parenturlvalue:"string",optionalparams:"boolean",trackscroll:"boolean",scrollwait:"number"},Mt={};for(var Fi in bt)if(Oe.getAttribute("data-pym-"+Fi)!==null)switch(bt[Fi]){case"boolean":Mt[Fi]=Oe.getAttribute("data-pym-"+Fi)!=="false";break;case"string":Mt[Fi]=Oe.getAttribute("data-pym-"+Fi);break;case"number":var ai=Number(Oe.getAttribute("data-pym-"+Fi));isNaN(ai)||(Mt[Fi]=ai);break;default:console.err("unrecognized attribute type")}var Oi=new L.Parent(Oe.id,ut,Mt);L.autoInitInstances.push(Oi)}return Ce||F("pym-initialized"),L.autoInitInstances},L.Parent=function(Ce,lt,Ke){this.id=Ce,this.url=lt,this.el=document.getElementById(Ce),this.iframe=null,this.settings={xdomain:"*",optionalparams:!0,parenturlparam:"parentUrl",parenturlvalue:window.location.href,trackscroll:!1,scrollwait:100},this.messageRegex=oe(this.id),this.messageHandlers={},Ke=Ke||{},this._constructIframe=function(){var Oe=this.el.offsetWidth.toString();this.iframe=document.createElement("iframe");var ut="",bt=this.url.indexOf("#");for(bt>-1&&(ut=this.url.substring(bt,this.url.length),this.url=this.url.substring(0,bt)),this.url.indexOf("?")<0?this.url+="?":this.url+="&",this.iframe.src=this.url+"initialWidth="+Oe+"&childId="+this.id,this.settings.optionalparams&&(this.iframe.src+="&parentTitle="+encodeURIComponent(document.title),this.iframe.src+="&"+this.settings.parenturlparam+"="+encodeURIComponent(this.settings.parenturlvalue)),this.iframe.src+=ut,this.iframe.setAttribute("width","100%"),this.iframe.setAttribute("scrolling","no"),this.iframe.setAttribute("marginheight","0"),this.iframe.setAttribute("frameborder","0"),this.settings.title&&this.iframe.setAttribute("title",this.settings.title),this.settings.allowfullscreen!==void 0&&this.settings.allowfullscreen!==!1&&this.iframe.setAttribute("allowfullscreen",""),this.settings.sandbox!==void 0&&typeof this.settings.sandbox=="string"&&this.iframe.setAttribute("sandbox",this.settings.sandbox),this.settings.id&&(document.getElementById(this.settings.id)||this.iframe.setAttribute("id",this.settings.id)),this.settings.name&&this.iframe.setAttribute("name",this.settings.name);this.el.firstChild;)this.el.removeChild(this.el.firstChild);this.el.appendChild(this.iframe),window.addEventListener("resize",this._onResize),this.settings.trackscroll&&window.addEventListener("scroll",this._throttleOnScroll)},this._onResize=(function(){this.sendWidth(),this.settings.trackscroll&&this.sendViewportAndIFramePosition()}).bind(this),this._onScroll=(function(){this.sendViewportAndIFramePosition()}).bind(this),this._fire=function(Oe,ut){if(Oe in this.messageHandlers)for(var bt=0;bt<this.messageHandlers[Oe].length;bt++)this.messageHandlers[Oe][bt].call(this,ut)},this.remove=function(){window.removeEventListener("message",this._processMessage),window.removeEventListener("resize",this._onResize),this.el.removeChild(this.iframe),Ye()},this._processMessage=(function(Oe){if(te(Oe,this.settings)&&typeof Oe.data=="string"){var ut=Oe.data.match(this.messageRegex);if(!ut||ut.length!==3)return!1;var bt=ut[1],Mt=ut[2];this._fire(bt,Mt)}}).bind(this),this._onHeightMessage=function(Oe){var ut=parseInt(Oe);this.iframe.setAttribute("height",ut+"px")},this._onNavigateToMessage=function(Oe){ae(Oe)&&(document.location.href=Oe)},this._onScrollToChildPosMessage=function(Oe){var ut=document.getElementById(this.id).getBoundingClientRect().top+window.pageYOffset,bt=ut+parseInt(Oe);window.scrollTo(0,bt)},this.onMessage=function(Oe,ut){Oe in this.messageHandlers||(this.messageHandlers[Oe]=[]),this.messageHandlers[Oe].push(ut)},this.sendMessage=function(Oe,ut){this.el.getElementsByTagName("iframe").length&&(this.el.getElementsByTagName("iframe")[0].contentWindow?this.el.getElementsByTagName("iframe")[0].contentWindow.postMessage(s(this.id,Oe,ut),"*"):this.remove())},this.sendWidth=function(){var Oe=this.el.offsetWidth.toString();this.sendMessage("width",Oe)},this.sendViewportAndIFramePosition=function(){var Oe=this.iframe.getBoundingClientRect(),ut=window.innerWidth||document.documentElement.clientWidth,bt=window.innerHeight||document.documentElement.clientHeight,Mt=ut+" "+bt;Mt+=" "+Oe.top+" "+Oe.left,Mt+=" "+Oe.bottom+" "+Oe.right,this.sendMessage("viewport-iframe-position",Mt)};for(var Nt in Ke)this.settings[Nt]=Ke[Nt];return this._throttleOnScroll=ve(this._onScroll.bind(this),this.settings.scrollwait),this.onMessage("height",this._onHeightMessage),this.onMessage("navigateTo",this._onNavigateToMessage),this.onMessage("scrollToChildPos",this._onScrollToChildPosMessage),this.onMessage("parentPositionInfo",this.sendViewportAndIFramePosition),window.addEventListener("message",this._processMessage,!1),this._constructIframe(),this},L.Child=function(Ce){this.parentWidth=null,this.id=null,this.parentTitle=null,this.parentUrl=null,this.settings={renderCallback:null,xdomain:"*",polling:0,parenturlparam:"parentUrl"},this.timerId=null,this.messageRegex=null,this.messageHandlers={},Ce=Ce||{},this.onMessage=function(Oe,ut){Oe in this.messageHandlers||(this.messageHandlers[Oe]=[]),this.messageHandlers[Oe].push(ut)},this._fire=function(Oe,ut){if(Oe in this.messageHandlers)for(var bt=0;bt<this.messageHandlers[Oe].length;bt++)this.messageHandlers[Oe][bt].call(this,ut)},this._processMessage=(function(Oe){if(te(Oe,this.settings)&&typeof Oe.data=="string"){var ut=Oe.data.match(this.messageRegex);if(!(!ut||ut.length!==3)){var bt=ut[1],Mt=ut[2];this._fire(bt,Mt)}}}).bind(this),this._onWidthMessage=function(Oe){var ut=parseInt(Oe);ut!==this.parentWidth&&(this.parentWidth=ut,this.settings.renderCallback&&this.settings.renderCallback(ut),this.sendHeight())},this.sendMessage=function(Oe,ut){window.parent.postMessage(s(this.id,Oe,ut),"*")},this.sendHeight=(function(){var Oe=document.getElementsByTagName("body")[0].offsetHeight.toString();return this.sendMessage("height",Oe),Oe}).bind(this),this.getParentPositionInfo=function(){this.sendMessage("parentPositionInfo")},this.scrollParentTo=function(Oe){this.sendMessage("navigateTo","#"+Oe)},this.navigateParentTo=function(Oe){this.sendMessage("navigateTo",Oe)},this.scrollParentToChildEl=function(Oe){var ut=document.getElementById(Oe).getBoundingClientRect().top+window.pageYOffset;this.scrollParentToChildPos(ut)},this.scrollParentToChildPos=function(Oe){this.sendMessage("scrollToChildPos",Oe.toString())};var lt=function(Oe){var ut=document.getElementsByTagName("html")[0],bt,Mt=ut.className;try{window.self!==window.top?bt="embedded":bt="not-embedded"}catch{bt="embedded"}Mt.indexOf(bt)<0&&(ut.className=Mt?Mt+" "+bt:bt,Oe&&Oe(bt),F("marked-embedded"))};this.remove=function(){window.removeEventListener("message",this._processMessage),this.timerId&&clearInterval(this.timerId)};for(var Ke in Ce)this.settings[Ke]=Ce[Ke];this.id=G("childId")||Ce.id,this.messageRegex=new RegExp("^pym"+I+this.id+I+"(\\S+)"+I+"(.*)$");var Nt=parseInt(G("initialWidth"));return this.parentUrl=G(this.settings.parenturlparam),this.parentTitle=G("parentTitle"),this.onMessage("width",this._onWidthMessage),window.addEventListener("message",this._processMessage,!1),this.settings.renderCallback&&this.settings.renderCallback(Nt),this.sendHeight(),this.settings.polling&&(this.timerId=window.setInterval(this.sendHeight,this.settings.polling)),lt(Ce.onMarkedEmbeddedStatus),this},typeof document<"u"&&L.autoInit(!0),L})})(TT);var UA=TT.exports;const kA=sf(UA);function zA(T){let I,L,F,G,te,ae,s,oe,he,ve,Ye;return I=new wv({}),ve=new BA({}),{c(){mh(I.$$.fragment),L=xn(),F=Ja("div"),G=Ja("h1"),G.textContent=`Mapping sewage sludge generation and land application at wastewater
    treatment plants in 2023`,te=xn(),ae=Ja("p"),ae.textContent=`The EPA's ECHO database tracks the generation and land application of
    biosolids at wastewater treatment plants. Often referred to as sewage
    sludge, biosolids are spread on agricultural fields as fertilizer and poses
    environmental risks, including PFAS contamination.`,s=xn(),oe=Ja("p"),oe.textContent="[altText]",he=xn(),mh(ve.$$.fragment),ba(G,"class","headline"),ba(ae,"class","dek"),ba(oe,"class","sr-only"),ba(F,"class","chart-container svelte-11wizzl")},m(Ce,lt){Vm(I,Ce,lt),Bu(Ce,L,lt),Bu(Ce,F,lt),ra(F,G),ra(F,te),ra(F,ae),ra(F,s),ra(F,oe),ra(F,he),Vm(ve,F,null),Ye=!0},p:go,i(Ce){Ye||(Gm(I.$$.fragment,Ce),Gm(ve.$$.fragment,Ce),Ye=!0)},o(Ce){ch(I.$$.fragment,Ce),ch(ve.$$.fragment,Ce),Ye=!1},d(Ce){jm(I,Ce),Ce&&Cd(L),Ce&&Cd(F),jm(ve)}}}function HA(T){return new kA.Child({polling:500}),[]}class YA extends nf{constructor(I){super(),of(this,I,HA,zA,Yu,{})}}new YA({target:document.getElementById("app")});
